'use strict'; 
"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('powerbiportal.explore.bundle.min.js');var powerbi,__spreadArray=this&&this.__spreadArray||function(e,t){for(var r=0,i=t.length,a=e.length;r<i;r++,a++)e[a]=t[r];return e},__extends=this&&this.__extends||(function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,t,r,i){var a,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;0<=s;s--)(a=e[s])&&(n=(o<3?a(n):3<o?a(t,r,n):a(t,r))||n);return 3<o&&n&&Object.defineProperty(t,r,n),n},__awaiter=this&&this.__awaiter||function(e,n,s,l){return new(s=s||Promise)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function a(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,a)}o((l=l.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(i,a){var o,n,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,n&&(s=2&t[0]?n.return:t[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,t[1])).done)return s;switch(n=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,n=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=a.call(i,l)}catch(e){t=[6,e],n=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};!(function(t){var r=t.telemetry||(t.telemetry={}),e=jsCommon.Utility,i=t.telemetryEventFactory,a=t.telemetry.EventFactories;e?e.generateGuid:Function.prototype,(e=r.OpenExplorationSource||(r.OpenExplorationSource={})).Normal="Normal",e.EmailSubscription="EmailSubscription",e.ReportInvitation="ReportInvitation",e.SubscribeOthers="SubscribeOthers",e.Commenting="Commenting",e.Invalid="Invalid",r.EXRetrieveFromVisualContainerCacheEventName="PBI.EX.RetrieveFromVisualContainerCache",r.EXRetrieveFromVisualContainerCache=a[r.EXRetrieveFromVisualContainerCacheEventName]=function(e){return i({name:r.EXRetrieveFromVisualContainerCacheEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["warning"],loggers:r.EXRetrieveFromVisualContainerCacheLoggers})},r.EXRunQueryEventName="PBI.EX.RunQuery",r.EXRunQuery=a[r.EXRunQueryEventName]=function(e){return i({name:r.EXRunQueryEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXRunQueryLoggers,logRatio:0})},r.EXRunQueryImplEventName="PBI.EX.RunQueryImpl",r.EXRunQueryImpl=a[r.EXRunQueryImplEventName]=function(e){return i({name:r.EXRunQueryImplEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXRunQueryImplLoggers,logRatio:0})},r.EXGetCachedQueryOrGenerateEventName="PBI.EX.GetCachedQueryOrGenerate",r.EXGetCachedQueryOrGenerate=a[r.EXGetCachedQueryOrGenerateEventName]=function(e){return i({name:r.EXGetCachedQueryOrGenerateEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXGetCachedQueryOrGenerateLoggers,logRatio:0})},r.EXVisualFirstLoadEventName="PBI.EX.VisualFirstLoad",r.EXVisualFirstLoad=a[r.EXVisualFirstLoadEventName]=function(e){return i({name:r.EXVisualFirstLoadEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["isServerCacheEligible","staleCacheResultFromServer","cacheResultFromServer"],loggers:r.EXVisualFirstLoadLoggers})},r.EXToggleVisualDisplayEventName="PBI.EX.ToggleVisualDisplay",r.EXToggleVisualDisplay=a[r.EXToggleVisualDisplayEventName]=function(e){return i({name:r.EXToggleVisualDisplayEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXToggleVisualDisplayLoggers,logExpAssignment:!0})},r.EXGetExplorationEventName="PBI.EX.GetExploration",r.EXGetExploration=a[r.EXGetExplorationEventName]=function(e){return i({name:r.EXGetExplorationEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["transferSize","startTime","requestStart","responseEnd","responseStart","duration","timeToFirstByte","timeOrigin","connectEnd","connectStart","decodedBodySize","domainLookupEnd","domainLookupStart","encodedBodySize","fetchStart","redirectEnd","redirectStart","secureConnectionStart","workerStart"],loggers:r.EXGetExplorationLoggers})},r.EXDeserializeExplorationEventName="PBI.EX.DeserializeExploration",r.EXDeserializeExploration=a[r.EXDeserializeExplorationEventName]=function(e){return i({name:r.EXDeserializeExplorationEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["reportGuid"],loggers:r.EXDeserializeExplorationLoggers})},r.EXOpenExplorationEventName="PBI.EX.OpenExploration",r.EXOpenExploration=a[r.EXOpenExplorationEventName]=function(e){return i({name:r.EXOpenExplorationEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["reportGuid","isUsageMetrics","groupObjectId","tags","isReadonlyGroup","scrubUserInfo","isB2B","enterpriseCapacitySkuTier","bookmarkObjectId","useMaxParallelQueryData","synchronous","areAnySectionQuickExplore","creationSource"],loggers:r.EXOpenExplorationLoggers,shouldLogStartEnd:!0,logExpAssignment:!0})},r.EXExplorationStateApplyImpactEventName="PBI.EX.ExplorationStateApplyImpact",r.EXExplorationStateApplyImpact=a[r.EXExplorationStateApplyImpactEventName]=function(e){return i({name:r.EXExplorationStateApplyImpactEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXExplorationStateApplyImpactLoggers})},r.EXExplorationStateApplyImpactIssuesEventName="PBI.EX.ExplorationStateApplyImpactIssues",r.EXExplorationStateApplyImpactIssues=a[r.EXExplorationStateApplyImpactIssuesEventName]=function(e){return i({name:r.EXExplorationStateApplyImpactIssuesEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXExplorationStateApplyImpactIssuesLoggers})},r.EXSwitchSectionEventName="PBI.EX.SwitchSection",r.EXSwitchSection=a[r.EXSwitchSectionEventName]=function(e){return i({name:r.EXSwitchSectionEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXSwitchSectionLoggers})},r.EXSwitchToAdjacentSectionEventName="PBI.EX.SwitchToAdjacentSection",r.EXSwitchToAdjacentSection=a[r.EXSwitchToAdjacentSectionEventName]=function(e){return i({name:r.EXSwitchToAdjacentSectionEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXSwitchToAdjacentSectionLoggers})},r.EXNavigateBackEventName="PBI.EX.NavigateBack",r.EXNavigateBack=a[r.EXNavigateBackEventName]=function(e){return i({name:r.EXNavigateBackEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXNavigateBackLoggers,logExpAssignment:!0})},r.EXNavigationButtonClickedEventName="PBI.EX.NavigationButtonClicked",r.EXNavigationButtonClicked=a[r.EXNavigationButtonClickedEventName]=function(e){return i({name:r.EXNavigationButtonClickedEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXNavigationButtonClickedLoggers,logExpAssignment:!0})},r.EXVisualQueryGeneratorWarningEventName="PBI.EX.VisualQueryGeneratorWarning",r.EXVisualQueryGeneratorWarning=a[r.EXVisualQueryGeneratorWarningEventName]=function(e){return i({name:r.EXVisualQueryGeneratorWarningEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXVisualQueryGeneratorWarningLoggers})},r.EXVisualQueryGeneratorErrorEventName="PBI.EX.VisualQueryGeneratorError",r.EXVisualQueryGeneratorError=a[r.EXVisualQueryGeneratorErrorEventName]=function(e){return i({name:r.EXVisualQueryGeneratorErrorEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:r.EXVisualQueryGeneratorErrorLoggers})},r.EXGroupsGroupsActionEventName="PBI.EX.Groups.GroupsAction",r.EXGroupsGroupsAction=a[r.EXGroupsGroupsActionEventName]=function(e){return i({name:r.EXGroupsGroupsActionEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXGroupsGroupsActionLoggers})},r.EXGroupsBinBySizeActionEventName="PBI.EX.Groups.BinBySizeAction",r.EXGroupsBinBySizeAction=a[r.EXGroupsBinBySizeActionEventName]=function(e){return i({name:r.EXGroupsBinBySizeActionEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXGroupsBinBySizeActionLoggers})},r.EXGroupsBinByCountActionEventName="PBI.EX.Groups.BinByCountAction",r.EXGroupsBinByCountAction=a[r.EXGroupsBinByCountActionEventName]=function(e){return i({name:r.EXGroupsBinByCountActionEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXGroupsBinByCountActionLoggers})},r.EXGroupsUsageEventName="PBI.EX.Groups.Usage",r.EXGroupsUsage=a[r.EXGroupsUsageEventName]=function(e){return i({name:r.EXGroupsUsageEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXGroupsUsageLoggers})},r.EXGroupsErrorEventName="PBI.EX.Groups.Error",r.EXGroupsError=a[r.EXGroupsErrorEventName]=function(e){return i({name:r.EXGroupsErrorEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:r.EXGroupsErrorLoggers})},r.EXModelChangeEventName="PBI.EX.ModelChange",r.EXModelChange=a[r.EXModelChangeEventName]=function(e){return i({name:r.EXModelChangeEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXModelChangeLoggers})},r.EXMeasuresEventName="PBI.EX.Measures",r.EXMeasures=a[r.EXMeasuresEventName]=function(e){return i({name:r.EXMeasuresEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXMeasuresLoggers})},r.EXReportMeasureDataTypeChangeEventName="PBI.EX.ReportMeasureDataTypeChange",r.EXReportMeasureDataTypeChange=a[r.EXReportMeasureDataTypeChangeEventName]=function(e){return i({name:r.EXReportMeasureDataTypeChangeEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXReportMeasureDataTypeChangeLoggers})},r.EXReportMeasureDataCategoryChangeEventName="PBI.EX.ReportMeasureDataCategoryChange",r.EXReportMeasureDataCategoryChange=a[r.EXReportMeasureDataCategoryChangeEventName]=function(e){return i({name:r.EXReportMeasureDataCategoryChangeEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXReportMeasureDataCategoryChangeLoggers})},r.EXReportMeasureMoveRoleKindEventName="PBI.EX.ReportMeasureMoveRoleKind",r.EXReportMeasureMoveRoleKind=a[r.EXReportMeasureMoveRoleKindEventName]=function(e){return i({name:r.EXReportMeasureMoveRoleKindEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXReportMeasureMoveRoleKindLoggers})},r.EXQuickCalcMeasureEditedEventName="PBI.EX.QuickCalcMeasureEdited",r.EXQuickCalcMeasureEdited=a[r.EXQuickCalcMeasureEditedEventName]=function(e){return i({name:r.EXQuickCalcMeasureEditedEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXQuickCalcMeasureEditedLoggers})},r.EXQuickCalcMeasureDeletedEventName="PBI.EX.QuickCalcMeasureDeleted",r.EXQuickCalcMeasureDeleted=a[r.EXQuickCalcMeasureDeletedEventName]=function(e){return i({name:r.EXQuickCalcMeasureDeletedEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.EXQuickCalcMeasureDeletedLoggers})},r.EXVisualDrillableRoleActiveItemsFixedEventName="PBI.EX.VisualDrillableRoleActiveItemsFixed",r.EXVisualDrillableRoleActiveItemsFixed=a[r.EXVisualDrillableRoleActiveItemsFixedEventName]=function(e){return i({name:r.EXVisualDrillableRoleActiveItemsFixedEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXVisualDrillableRoleActiveItemsFixedLoggers})},r.PersistentStateSerializationErrorEventName="PBI.PersistentState.SerializationError",r.PersistentStateSerializationError=a[r.PersistentStateSerializationErrorEventName]=function(e){return i({name:r.PersistentStateSerializationErrorEventName,baseEvent:r.ErrorWithStackTrace(e),info:e,category:t.TelemetryCategory.CriticalError,loggers:r.PersistentStateSerializationErrorLoggers})},r.PodSerializationErrorFixedEventName="PBI.Pod.SerializationErrorFixed",r.PodSerializationErrorFixed=a[r.PodSerializationErrorFixedEventName]=function(e){return i({name:r.PodSerializationErrorFixedEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.PodSerializationErrorFixedLoggers})},r.SerializationErrorEventName="PBI.SerializationError",r.SerializationError=a[r.SerializationErrorEventName]=function(e){return i({name:r.SerializationErrorEventName,baseEvent:r.ErrorWithStackTrace(e),info:e,category:t.TelemetryCategory.CriticalError,loggers:r.SerializationErrorLoggers})},r.EXEmptyVisualContainerConfigEventName="PBI.EX.EmptyVisualContainerConfig",r.EXEmptyVisualContainerConfig=a[r.EXEmptyVisualContainerConfigEventName]=function(e){return i({name:r.EXEmptyVisualContainerConfigEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXEmptyVisualContainerConfigLoggers})},r.ClipboardServicePasteEventName="PBI.ClipboardService.Paste",r.ClipboardServicePaste=a[r.ClipboardServicePasteEventName]=function(e){return i({name:r.ClipboardServicePasteEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.ClipboardServicePasteLoggers})},r.ClipboardServiceUnsupportedVersionEventName="PBI.ClipboardService.UnsupportedVersion",r.ClipboardServiceUnsupportedVersion=a[r.ClipboardServiceUnsupportedVersionEventName]=function(e){return i({name:r.ClipboardServiceUnsupportedVersionEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.ClipboardServiceUnsupportedVersionLoggers})},r.DataPointLassoSelectPreviewSerializedEventName="PBI.DataPointLassoSelect.PreviewSerialized",r.DataPointLassoSelectPreviewSerialized=a[r.DataPointLassoSelectPreviewSerializedEventName]=function(e){return i({name:r.DataPointLassoSelectPreviewSerializedEventName,baseEvent:r.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:r.DataPointLassoSelectPreviewSerializedLoggers})},r.EXLoopingSQExprEventName="PBI.EX.LoopingSQExpr",r.EXLoopingSQExpr=a[r.EXLoopingSQExprEventName]=function(e){return i({name:r.EXLoopingSQExprEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXLoopingSQExprLoggers})},r.EXGetLinguisticSchemaEventName="PBI.EX.GetLinguisticSchema",r.EXGetLinguisticSchema=a[r.EXGetLinguisticSchemaEventName]=function(e){return i({name:r.EXGetLinguisticSchemaEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXGetLinguisticSchemaLoggers})},r.EXGetAutoRefreshAdminConfigEventName="PBI.EX.GetAutoRefreshAdminConfig",r.EXGetAutoRefreshAdminConfig=a[r.EXGetAutoRefreshAdminConfigEventName]=function(e){return i({name:r.EXGetAutoRefreshAdminConfigEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXGetAutoRefreshAdminConfigLoggers})},r.EXGetChangeDetectionAdminConfigEventName="PBI.EX.GetChangeDetectionAdminConfig",r.EXGetChangeDetectionAdminConfig=a[r.EXGetChangeDetectionAdminConfigEventName]=function(e){return i({name:r.EXGetChangeDetectionAdminConfigEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXGetChangeDetectionAdminConfigLoggers})},r.EXAnchorTimeUndefinedEventName="PBI.EX.AnchorTimeUndefined",r.EXAnchorTimeUndefined=a[r.EXAnchorTimeUndefinedEventName]=function(e){return i({name:r.EXAnchorTimeUndefinedEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:r.EXAnchorTimeUndefinedLoggers})},r.EXGetAPRConfigFailureEventName="PBI.EX.GetAPRConfigFailure",r.EXGetAPRConfigFailure=a[r.EXGetAPRConfigFailureEventName]=function(e){return i({name:r.EXGetAPRConfigFailureEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXGetAPRConfigFailureLoggers})},r.EXDefnsDuplicateSelectorEventName="PBI.EX.DefnsDuplicateSelector",r.EXDefnsDuplicateSelector=a[r.EXDefnsDuplicateSelectorEventName]=function(e){return i({name:r.EXDefnsDuplicateSelectorEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXDefnsDuplicateSelectorLoggers})},r.EXCertifiedTelemetryChildrenCountMismatchEventName="PBI.EX.CertifiedTelemetryChildrenCountMismatch",r.EXCertifiedTelemetryChildrenCountMismatch=a[r.EXCertifiedTelemetryChildrenCountMismatchEventName]=function(e){return i({name:r.EXCertifiedTelemetryChildrenCountMismatchEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXCertifiedTelemetryChildrenCountMismatchLoggers})},r.EXUndoEventTimeEventName="PBI.EX.UndoEventTime",r.EXUndoEventTime=a[r.EXUndoEventTimeEventName]=function(e){return i({name:r.EXUndoEventTimeEventName,baseEvent:r.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:r.EXUndoEventTimeLoggers})}})(powerbi=powerbi||{}),(function(e){(function(e){function t(){}t.isValidBookmark=function(e){return e&&(t.isBookmarkGroup(e)||t.isStateBookmark(e))},t.isBookmarkGroup=function(e){return void 0!==e.children},t.isStateBookmark=function(e){return!t.isBookmarkGroup(e)},t.isWebBookmark=function(e){return void 0!==e.type},e.BookmarkExtensions=t,(e=e.BookmarkActions||(e.BookmarkActions={})).Add="AddBookmark",e.Apply="ApplyBookmark",e.Remove="RemoveBookmark",e.Move="MoveBookmark",e.Update="UpdateBookmark",e.Rename="RenameBookmark",e.Group="GroupBookmarks",e.Ungroup="UngroupBookmarks"})((e=e.explore||(e.explore={})).contracts||(e.contracts={}))})(powerbi=powerbi||{}),(function(a){var o,e,t,i;function n(e){return _.includes(Object.keys(e),"extends")}function s(e){return _.map(e,(function(e){return e[i.readerType(e)]}))}o=a.explore||(a.explore={}),e=o.contracts||(o.contracts={}),t=jsCommon.ArrayExtensions,i=a.data.DataReaderUtils,e.createDataSourceArray=function(e){return t.extendWithName(t.extendWithId(e=void 0===e?[]:e))},e.dataSourceForModel=function(e){var t=o.constants.DefaultSchemaName,r=e.capacityObjectId&&void 0===e.queryCachingState?void 0:2===e.queryCachingState,i=e.datasetHost;return{type:a.common.constants.dsrDataReaderType,id:e.id,name:t,dsr:{schemaName:t,vsName:e.vsName,dbName:e.dbName,modelId:e.id,isQueryCachingEnabled:r,lastRefreshTime:e.lastRefreshTime,isLimitedParallelQueryModel:i===a.common.contracts.DatasetHost.ASOnPrem}}},(e=e.DataSource||(e.DataSource={})).isExtension=n,e.referenced=function(e,t){var r;if(!_.isEmpty(e))return r=i.findSchemas(t),s(t=_.isEmpty(r)?e:_.filter(e,(function(e){return _.includes(r,e.name)})))},e.queried=function(e,t){var r;if(!_.isEmpty(e))return r=i.findSchemas(t),_.isEmpty(r)?_.filter(e,(function(e){return!n(e)})):_.chain(e).filter((function(e){return _.includes(r,e.name)})).map((function(t){return n(t)?_.find(e,(function(e){return e.name===t.extends})):t})).uniq().value()},e.dataReaderDataSources=s})(powerbi=powerbi||{}),(function(e){var t;(t=(t=(t=e.explore||(e.explore={})).contracts||(t.contracts={})).AutoPageRefreshOption||(t.AutoPageRefreshOption={})).CDM="CDM",t.APR="APR",t.Type=e.createEnumType([{value:t.APR,displayName:function(e){return e.get("PageRefresh_APR")}},{value:t.CDM,displayName:function(e){return e.get("ChangeDetection")}}])})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),(r=t.SectionAlignmentOption||(t.SectionAlignmentOption={}))[r.Top=0]="Top",r[r.Middle=1]="Middle",(r=t.SectionAlignmentPosition||(t.SectionAlignmentPosition={})).top="Top",r.middle="Middle",r.Type=e.createEnumType([{value:r.top,displayName:function(e){return e.get("Top")}},{value:r.middle,displayName:function(e){return e.get("Middle")}}])})(powerbi=powerbi||{}),(function(e){var t;(t=(t=(t=e.explore||(e.explore={})).contracts||(t.contracts={})).SectionPageSizeTypes||(t.SectionPageSizeTypes={})).PageSizeTypes={Dynamic:"Dynamic",Standard:"Standard",Widescreen:"Widescreen",Cortana:"Cortana",Letter:"Letter",Tooltip:"Tooltip",Custom:"Custom"},t.Type=e.createEnumType([{value:t.PageSizeTypes.Widescreen,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Widescreen")}},{value:t.PageSizeTypes.Standard,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Standard")}},{value:t.PageSizeTypes.Letter,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Letter")}},{value:t.PageSizeTypes.Tooltip,displayName:function(e){return e.get("Tooltip")}},{value:t.PageSizeTypes.Custom,displayName:function(e){return e.get("Custom")}}])})(powerbi=powerbi||{}),(function(i){var d;(function(l){var e,p=jsCommon.ArrayExtensions,t=i.data.createDisplayNameGetter,u=i.data.DataViewObjectDefinitions,c=i.data.SQExprBuilder;function r(e){"string"==typeof e?this.originalExplorationJSON=e:this.originalExploration=e}(e=l.LinguisticSchemaSyncVersion||(l.LinguisticSchemaSyncVersion={}))[e.Unspecified=0]="Unspecified",e[e.QnaSuggestQuestions=1]="QnaSuggestQuestions",e[e.VisualColumnRenameTerms=2]="VisualColumnRenameTerms",l.createDefaultExploration=function(e,t,r,i,a){var o=d.constants,n={},s={useNewFilterPaneExperience:!0,allowChangeFilterTypes:!0,useStylableVisualContainerHeader:!0};return r.featureSwitches.enhancedTooltips&&(s.useEnhancedTooltips=!0),r.featureSwitches.exportDataMode&&(s.exportDataMode=1),r.featureSwitches.automatedInsights&&r.featureSwitches.automatedInsightsBackgroundRefresh&&r.featureSwitches.automatedInsightsEntryPointsEnabled&&r.featureSwitches.automatedInsightsTenantEnabled&&(s.allowAutomatedInsightsNotification=!0),r.featureSwitches.defaultAggrDisplayName&&(s.useDefaultAggregateDisplayName=!0),null!=i?u.setValue(n,{objectName:"section",propertyName:"verticalAlignment"},null,c.text(i)):u.setValue(n,{objectName:"section",propertyName:"verticalAlignment"},null,c.text(l.SectionAlignmentPosition.top)),{themeCollection:{baseTheme:d.util.ThemeUtils.getCurrentBaseThemeMetadata(r)},id:0,width:o.ExploreCanvasConstants.DefaultCanvasWidth,height:o.ExploreCanvasConstants.DefaultCanvasHeight,dataSources:l.createDataSourceArray(),sections:p.extendWithId([{id:0,name:"ReportSection",displayName:e,visualContainers:t,visualContainerGroups:__spreadArray([],t||[]),filters:[],size:{displayOption:1,width:o.ExploreCanvasConstants.DefaultWidescreenWidth,height:o.ExploreCanvasConstants.DefaultWidescreenHeight}}]),settings:_.isEmpty(s)?void 0:s,objects:n,creationSource:a}},l.ExplorationObjectDescriptors={outspacePane:{displayName:t("Exploration_FilterPane"),properties:{expanded:{type:{bool:!0}},visible:{type:{bool:!0}}}},section:{displayName:t("PagePropertyPane_PageAlignment"),properties:{verticalAlignment:{type:{enumeration:l.SectionAlignmentPosition.Type}}}}},r.prototype.value=function(){return!this.originalExploration&&this.originalExplorationJSON&&(this.originalExploration=jsCommon.JsonExtensions.tryParseJSON(this.originalExplorationJSON),this.originalExplorationJSON=void 0),this.originalExploration},r.Empty=new r,l.OriginalExploration=r})((d=i.explore||(i.explore={})).contracts||(d.contracts={}))})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).contracts||(e.contracts={}),(t=e.FilterContainer||(e.FilterContainer={})).ObjectType="filter",t.CommonObjectDescriptors={general:{properties:{requireSingleSelect:{type:{bool:!0}},isInvertedSelectionMode:{type:{bool:!0}}}}},(t=e.FilterType||(e.FilterType={}))[t.Categorical=0]="Categorical",t[t.Range=1]="Range",t[t.Advanced=2]="Advanced",t[t.Passthrough=3]="Passthrough",t[t.Visual=4]="Visual",t[t.TopN=5]="TopN",t[t.Include=6]="Include",t[t.Exclude=7]="Exclude",t[t.RelativeDate=8]="RelativeDate",t[t.Tuple=9]="Tuple",t[t.RelativeTime=10]="RelativeTime"})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).CollectedFilterSource||(e.CollectedFilterSource={}))[e.Self=1]="Self",e[e.Slicer=2]="Slicer"})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),e=e.data.createDisplayNameGetter,(r=t.Section||(t.Section={})).objectDescriptors={pageInformation:{displayName:e("PagePropertyPane_PageInformation"),properties:{pageInformationName:{displayName:e("Name"),type:{text:!0}},pageInformationQnaPodEnabled:{displayName:e("Generic_Qna"),type:{bool:!0}},pageInformationAltName:{displayName:e("PagePropertyPane_PageInformation_AltName_Placeholder"),type:{formatting:{altText:!0}}},pageInformationType:{displayName:e("Allow_As_Tooltip"),type:{bool:!0}}}},pageSize:{displayName:e("Canvas_Settings"),properties:{pageSizeTypes:{displayName:e("Type"),type:{enumeration:t.SectionPageSizeTypes.Type}},pageSizeWidth:{displayName:e("PagePropertyPane_PageSizeWidth"),type:{numeric:!0}},pageSizeHeight:{displayName:e("PagePropertyPane_PageSizeHeight"),type:{numeric:!0}}}},background:{displayName:e("PagePropertyPane_PageBackground"),properties:{color:{displayName:e("PagePropertyPane_PageBackgroundColor"),type:{fill:{solid:{color:!0}}}},image:{type:{image:{}}},transparency:{displayName:e("Transparency"),type:{numeric:!0}}}},displayArea:{displayName:e("PagePropertyPane_PageAlignment"),properties:{verticalAlignment:{displayName:e("Visual_Alignment_Vertical"),type:{enumeration:t.SectionAlignmentPosition.Type}}}},outspace:{displayName:e("PagePropertyPane_Outspace"),properties:{color:{displayName:e("PagePropertyPane_PageBackgroundColor"),type:{fill:{solid:{color:!0}}}},image:{type:{image:{}}},transparency:{displayName:e("Transparency"),type:{numeric:!0}}}},outspacePane:{displayName:e("Exploration_FilterPane"),properties:{backgroundColor:{displayName:e("PagePropertyPane_OutspacePane_BackgroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_BackgroundColorTooltip")},transparency:{displayName:e("Transparency"),type:{numeric:!0},description:e("PagePropertyPane_OutspacePane_BackgroundTransparencyTooltip")},foregroundColor:{displayName:e("PagePropertyPane_OutspacePane_ForegroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_ForegroundColorTooltip")},titleSize:{displayName:e("Visual_AxisTitleTextSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_TitleSizeTooltip")},searchTextSize:{displayName:e("PagePropertyPane_OutspacePane_SearchTextSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_SearchTextSizeTooltip")},headerSize:{displayName:e("PagePropertyPane_OutspacePane_HeaderSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_HeaderSizeTooltip")},fontFamily:{displayName:e("Visual_FontFamily"),type:{formatting:{fontFamily:!0}},description:e("PagePropertyPane_OutspacePane_FontFamilyTooltip")},border:{displayName:e("Visual_Border"),type:{bool:!0},description:e("PagePropertyPane_OutspacePane_LeftBorderTooltip")},borderColor:{displayName:e("PagePropertyPane_FilterCards_BorderColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_BorderColorTooltip")},checkboxAndApplyColor:{displayName:e("Checkbox_Apply_Color_Title"),type:{fill:{solid:{color:!0}}},description:e("Checkbox_Apply_Color_Description")},inputBoxColor:{displayName:e("PagePropertyPane_FilterCards_InputBoxColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_InputBoxColorTooltip")},width:{displayName:e("PagePropertyPane_PageSizeWidth"),type:{integer:!0}}}},filterCard:{displayName:e("PagePropertyPane_FilterCards"),properties:{backgroundColor:{displayName:e("PagePropertyPane_OutspacePane_BackgroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_BackgroundColorTooltip")},transparency:{displayName:e("Transparency"),type:{integer:!0},description:e("PagePropertyPane_FilterCards_BackgroundTransparencyTooltip")},border:{displayName:e("Visual_Border"),type:{bool:!0},description:e("PagePropertyPane_FilterCards_BorderTooltip")},borderColor:{displayName:e("PagePropertyPane_FilterCards_BorderColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_BorderColorTooltip")},foregroundColor:{displayName:e("PagePropertyPane_OutspacePane_ForegroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_ForegroundColorTooltip")},textSize:{displayName:e("Visual_TextSize"),type:{integer:!0},description:e("PagePropertyPane_FilterCards_TextSizeTooltip")},fontFamily:{displayName:e("Visual_FontFamily"),type:{formatting:{fontFamily:!0}},description:e("PagePropertyPane_FilterCards_FontFamilyTooltip")},inputBoxColor:{displayName:e("PagePropertyPane_FilterCards_InputBoxColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_InputBoxColorTooltip")}}},pageRefresh:{displayName:e("PageRefresh"),properties:{show:{displayName:e("Show"),type:{bool:!0}},refreshType:{displayName:e("AutoPageRefreshType"),type:{enumeration:t.AutoPageRefreshOption.Type}},duration:{displayName:e("AutoPageRefreshInterval"),type:{duration:!0}},dialogLauncher:{displayName:e("AutoPageRefreshInterval"),type:{}},measure:{displayName:e("NewMeasureName"),type:{readOnlyText:!0}},checkEvery:{displayName:e("CheckEvery"),type:{readOnlyText:!0}}}},personalizeVisual:{displayName:e("VisualHeader_ShowPersonalizeVisualButton"),properties:{show:{displayName:e("Show"),type:{bool:!0}},perspectiveRef:{displayName:e("PersonalizeVisual_PerspectivePropertyName"),type:{reference:{perspective:!0}}},applyToAllPages:{displayName:e("PagePropertyPane_ApplyToAllPages"),type:{applyToAllPages:!0}}}}},r.filterTransient=function(e){return _.filter(e,(function(e){return!e.transient}))},t.SectionProps={pageInformation:{pageInformationName:{objectName:"pageInformation",propertyName:"pageInformationName"},pageInformationQnaPodEnabled:{objectName:"pageInformation",propertyName:"pageInformationQnaPodEnabled"},pageInformationAltName:{objectName:"pageInformation",propertyName:"pageInformationAltName"},pageInformationType:{objectName:"pageInformation",propertyName:"pageInformationType"},pageInformationDrillthroughKeepAllFilters:{objectName:"pageInformation",propertyName:"pageInformationDrillthroughKeepAllFilters"},pageInformationDrillthroughCrossReportEnabled:{objectName:"pageInformation",propertyName:"pageInformationDrillthroughCrossReportEnabled"},pageInformationDrillthroughFields:{objectName:"pageInformation",propertyName:"pageInformationDrillthroughFields"},pageInformationDrillthroughLinkFieldsLinkTypes:{objectName:"pageInformation",propertyName:"pageInformationDrillthroughLinkFieldsLinkTypes"}},pageSize:{pageSizeTypes:{objectName:"pageSize",propertyName:"pageSizeTypes"},pageSizeWidth:{objectName:"pageSize",propertyName:"pageSizeWidth"},pageSizeHeight:{objectName:"pageSize",propertyName:"pageSizeHeight"}},background:{color:{objectName:"background",propertyName:"color"},image:{objectName:"background",propertyName:"image"},transparency:{objectName:"background",propertyName:"transparency"}},displayArea:{verticalAlignment:{objectName:"displayArea",propertyName:"verticalAlignment"}},outspace:{color:{objectName:"outspace",propertyName:"color"},image:{objectName:"outspace",propertyName:"image"},transparency:{objectName:"outspace",propertyName:"transparency"}},outspacePane:{backgroundColor:{objectName:"outspacePane",propertyName:"backgroundColor"},transparency:{objectName:"outspacePane",propertyName:"transparency"},foregroundColor:{objectName:"outspacePane",propertyName:"foregroundColor"},titleSize:{objectName:"outspacePane",propertyName:"titleSize"},searchTextSize:{objectName:"outspacePane",propertyName:"searchTextSize"},headerSize:{objectName:"outspacePane",propertyName:"headerSize"},fontFamily:{objectName:"outspacePane",propertyName:"fontFamily"},border:{objectName:"outspacePane",propertyName:"border"},borderColor:{objectName:"outspacePane",propertyName:"borderColor"},checkboxAndApplyColor:{objectName:"outspacePane",propertyName:"checkboxAndApplyColor"},inputBoxColor:{objectName:"outspacePane",propertyName:"inputBoxColor"},width:{objectName:"outspacePane",propertyName:"width"}},filterCard:{backgroundColor:{objectName:"filterCard",propertyName:"backgroundColor"},transparency:{objectName:"filterCard",propertyName:"transparency"},border:{objectName:"filterCard",propertyName:"border"},borderColor:{objectName:"filterCard",propertyName:"borderColor"},foregroundColor:{objectName:"filterCard",propertyName:"foregroundColor"},textSize:{objectName:"filterCard",propertyName:"textSize"},fontFamily:{objectName:"filterCard",propertyName:"fontFamily"},inputBoxColor:{objectName:"filterCard",propertyName:"inputBoxColor"}},pageRefresh:{show:{objectName:"pageRefresh",propertyName:"show"},refreshType:{objectName:"pageRefresh",propertyName:"refreshType"},duration:{objectName:"pageRefresh",propertyName:"duration"},dialogLauncher:{objectName:"pageRefresh",propertyName:"dialogLauncher"},measure:{objectName:"pageRefresh",propertyName:"measure"},checkEvery:{objectName:"pageRefresh",propertyName:"checkEvery"}},personalizeVisual:{show:{objectName:"personalizeVisual",propertyName:"show"},perspectiveRef:{objectName:"personalizeVisual",propertyName:"perspectiveRef"},applyToAllPages:{objectName:"personalizeVisual",propertyName:"applyToAllPages"}}}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).SnapshotReportType="Report",(e=e.EmbedType||(e.EmbedType={}))[e.Static=0]="Static",e[e.Interactive=1]="Interactive"})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),r=e.visuals.builder,e=e.data.createDisplayNameGetter,(t=t.VisualContainerGroup||(t.VisualContainerGroup={})).objectType="visualContainerGroup",t.objectDescriptors={background:{displayName:e("Visual_Background"),properties:{show:{displayName:e("Visual_Show"),type:{bool:!0}},color:{displayName:e("Visual_Background_Color"),description:e("VisualGroup_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e("Transparency"),description:e("Visual_Background_TransparencyDescription"),type:{numeric:!0}}}},lockAspect:{displayName:e("Visual_BasicShape_LockAspect"),properties:{show:{displayName:e("Visual_Show"),type:{bool:!0}}}},general:{displayName:e("Visual_General_Properties"),properties:{x:{displayName:e("Visual_General_Properties_X_Coordinate"),type:{numeric:!0}},y:{displayName:e("Visual_General_Properties_Y_Coordinate"),type:{numeric:!0}},width:{displayName:e("Visual_General_Properties_Width"),type:{numeric:!0}},height:{displayName:e("Visual_General_Properties_Height"),type:{numeric:!0}},altText:{displayName:e("Visual_General_Properties_Description"),placeHolderText:e("Visual_General_Properties_Description_Placeholder"),type:{formatting:{altText:!0}}}}}},t.ObjectProps=r.getPropertyIdentifiers(t.objectDescriptors),t.isHidden=function(e){return e.isHidden},t.setHidden=function(e,t){e.isHidden=t},t.setDisplayName=function(e,t){e.displayName=t}})(powerbi=powerbi||{}),(function(e){var t;function p(e){return!!e.children}function u(e){return p(e)?t.VisualContainerGroup.isHidden(e):t.VisualContainer.isHidden(e.config.singleVisual)}e=e.explore||(e.explore={}),(t=e.contracts||(e.contracts={})).traverseVisualContainerGroups=function(e,t,r){return (function e(t,r,i,a){for(var o=0,n=i;o<n.length;o++){var s=n[o],l=t||u(s);r&&l||(a(s,l),p(s)&&e(l,r,s.children,a))}})(!1,r&&r.visibleOnly,e,t)},t.isVisualContainerGroup=p,t.isVisualContainer=function(e){return!e.children}})(powerbi=powerbi||{}),(function(e){var t,r,a;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),a=e.data.DataViewObjectDefinitions,(r=t.VisualTooltip||(t.VisualTooltip={})).Default="Default",r.Canvas="Canvas",r.Type=e.createEnumType([{value:r.Default,displayName:function(e){return e.get("Default")}},{value:r.Canvas,displayName:function(e){return e.get("ReportPage")}}]),r.getType=function(e){return e.type},r.SectionAuto="___AUTO___",(t.VisualTitle||(t.VisualTitle={})).isHidden=function(e,t){return void 0===t&&(t=!1),!!e&&(!1===e.show||void 0===e.show&&t)},(r=t.SingleVisualConfig||(t.SingleVisualConfig={})).clone=function(e){var t,r,i;if(e)return t={visualType:e.visualType},e.syncGroup&&(t.syncGroup=_.cloneDeep(e.syncGroup)),e.columnProperties&&(t.columnProperties=_.cloneDeep(e.columnProperties)),e.query&&(t.query=e.query.clone()),e.queryOptions&&(t.queryOptions=_.cloneDeep(e.queryOptions)),e.objects&&(t.objects=a.clone(e.objects)),e.vcObjects&&(t.vcObjects=a.clone(e.vcObjects)),i=t,(r=e).mobileObjects&&(i.mobileObjects=a.clone(r.mobileObjects)),r.mobileVcObjects&&(i.mobileVcObjects=a.clone(r.mobileVcObjects)),e.hasDefaultSort&&(t.hasDefaultSort=e.hasDefaultSort),(i=e.conversionSourceContext)&&(t.conversionSourceContext={visualType:i.visualType,query:i.query&&i.query.clone(),syncGroup:i.syncGroup}),e.display&&(t.display=_.cloneDeep(e.display)),e.autoSelectVisualType&&(t.autoSelectVisualType=e.autoSelectVisualType),t.hasUsedSmallMultiples=e.hasUsedSmallMultiples,t},r.enumerateObjectRepetition=function(e,t){return(e=e&&e.getAdapter())?e.enumerateObjectRepetitionAsync?e.enumerateObjectRepetitionAsync():e.enumerateObjectRepetition?t.resolve(e.enumerateObjectRepetition()):t.resolve():t.resolve()}})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),(r=t.VisualHeaderTooltip||(t.VisualHeaderTooltip={})).Text=t.VisualTooltip.Default,r.Canvas=t.VisualTooltip.Canvas,r.Type=e.createEnumType([{value:t.VisualTooltip.Default,displayName:function(e){return e.get("Text")}},{value:r.Canvas,displayName:function(e){return e.get("ReportPage")}}])})(powerbi=powerbi||{}),(function(e){var t,r,i,a,o,n,s,l;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),s=e.visuals.builder,l=e.data.createDisplayNameGetter,(i=r=t.VisualLink||(t.VisualLink={})).Back="Back",i.Bookmark="Bookmark",i.Drillthrough="Drillthrough",i.PageNavigation="PageNavigation",i.Qna="Qna",i.WebUrl="WebUrl",i.Type=e.createEnumType([{value:i.Back,displayName:function(e){return e.get("Generic_Back")}},{value:i.Bookmark,displayName:function(e){return e.get("Generic_Bookmark")}},{value:i.Drillthrough,displayName:function(e){return e.get("Drillthrough")}},{value:i.PageNavigation,displayName:function(e){return e.get("PageNavigation")}},{value:i.Qna,displayName:function(e){return e.get("Generic_Qna")}},{value:i.WebUrl,displayName:function(e){return e.get("Web_Url")}}]),i.getType=function(e){return e.type||i.Back},i.BookmarkNone="",i.SectionNone="",(o=a=t.VisualDropShadow||(t.VisualDropShadow={})).CustomPreset="Custom",o.TopPreset="Top",o.TopLeftPreset="TopLeft",o.TopRightPreset="TopRight",o.CenterPreset="Center",o.CenterLeftPreset="CenterLeft",o.CenterRightPreset="CenterRight",o.BottomPreset="Bottom",o.BottomLeftPreset="BottomLeft",o.BottomRightPreset="BottomRight",o.OuterPosition="Outer",o.InnerPosition="Inner",o.Preset=e.createEnumType([{value:o.BottomRightPreset,displayName:function(e){return e.get("Visual_LabelPosition_BottomRight")}},{value:o.BottomPreset,displayName:function(e){return e.get("Bottom")}},{value:o.BottomLeftPreset,displayName:function(e){return e.get("Visual_LabelPosition_BottomLeft")}},{value:o.CenterRightPreset,displayName:function(e){return e.get("Visual_TextAlignment_Right")}},{value:o.CenterPreset,displayName:function(e){return e.get("Visual_TextAlignment_Center")}},{value:o.CenterLeftPreset,displayName:function(e){return e.get("Visual_TextAlignment_Left")}},{value:o.TopRightPreset,displayName:function(e){return e.get("Visual_LabelPosition_TopRight")}},{value:o.TopPreset,displayName:function(e){return e.get("Top")}},{value:o.TopLeftPreset,displayName:function(e){return e.get("Visual_LabelPosition_TopLeft")}},{value:o.CustomPreset,displayName:function(e){return e.get("Custom")}}]),o.Position=e.createEnumType([{value:o.OuterPosition,displayName:function(e){return e.get("Visual_DonutLabelPosition_Outside")}},{value:o.InnerPosition,displayName:function(e){return e.get("Visual_DonutLabelPosition_Inside")}}]),(n=o=t.VisualTitleHeading||(t.VisualTitleHeading={})).Normal="Normal",n.Heading2="Heading2",n.Heading3="Heading3",n.Heading4="Heading4",n.Heading5="Heading5",n.Heading6="Heading6",n.HeadingTypeAttribute=e.createEnumType([{value:n.Normal,displayName:function(e){return e.get("Normal")}},{value:n.Heading2,displayName:function(e){return e.get("Heading_2")}},{value:n.Heading3,displayName:function(e){return e.get("Heading_3")}},{value:n.Heading4,displayName:function(e){return e.get("Heading_4")}},{value:n.Heading5,displayName:function(e){return e.get("Heading_5")}},{value:n.Heading6,displayName:function(e){return e.get("Heading_6")}}]),n.DefaultHeadingAttribute=n.Heading3,(n=t.VisualHeaderTooltip||(t.VisualHeaderTooltip={})).NoSection="none",(e=t.VisualContainer||(t.VisualContainer={})).EmptyConfig={singleVisual:{visualType:"uninitializedVisual"}},jsCommon.FreezeUtility.deepFreeze(e.EmptyConfig),e.CommonObjectDescriptors={title:{displayName:l("Visual_Title"),description:l("Visual_TitleDescription"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},text:{displayName:l("Visual_Title_Text"),description:l("Visual_Title_TextDescription"),type:{text:!0},suppressFormatPainterCopy:!0},heading:{displayName:l("Visual_Title_Heading_Attribute"),description:l("Visual_Title_Heading_AttributeDescription"),type:{enumeration:o.HeadingTypeAttribute}},titleWrap:{displayName:l("Visual_Word_Wrap"),type:{bool:!0}},fontColor:{displayName:l("Visual_FontColor"),description:l("Visual_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},background:{displayName:l("Background_Color"),description:l("Visual_Title_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},alignment:{displayName:l("Visual_Title_Alignment"),description:l("Visual_Title_AlignmentDescription"),type:{formatting:{alignment:!0}}},fontSize:{displayName:l("Visual_TextSize"),description:l("Visual_Title_TextSizeDescription"),type:{formatting:{fontSize:!0}}},bold:{displayName:l("Bold"),type:{bool:!0}},italic:{displayName:l("Italic"),type:{bool:!0}},underline:{displayName:l("Underline"),type:{bool:!0}},fontFamily:{displayName:l("Visual_FontFamily"),type:{formatting:{fontFamily:!0}}},paddingTop:{displayName:l("Visual_PaddingTop"),type:{numeric:!0}},paddingBottom:{displayName:l("Visual_PaddingBottom"),type:{numeric:!0}},paddingLeft:{displayName:l("Visual_PaddingLeft"),type:{numeric:!0}},paddingRight:{displayName:l("Visual_PaddingRight"),type:{numeric:!0}}}},background:{displayName:l("Visual_Background"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},color:{displayName:l("Visual_Background_Color"),description:l("Visual_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:l("Transparency"),description:l("Visual_Background_TransparencyDescription"),type:{numeric:!0}}}},lockAspect:{displayName:l("Visual_BasicShape_LockAspect"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}}}},general:{displayName:l("Visual_General_Properties"),properties:{x:{displayName:l("Visual_General_Properties_X_Coordinate"),type:{numeric:!0}},y:{displayName:l("Visual_General_Properties_Y_Coordinate"),type:{numeric:!0}},width:{displayName:l("Visual_General_Properties_Width"),type:{numeric:!0}},height:{displayName:l("Visual_General_Properties_Height"),type:{numeric:!0}},altText:{displayName:l("Visual_General_Properties_Description"),placeHolderText:l("Visual_General_Properties_Description_Placeholder"),type:{formatting:{altText:!0}}},allowBinnedLineSample:{displayName:l("Visual_General_HighDensitySampling"),type:{bool:!0}},allowOverlappingPointsSample:{displayName:l("Visual_General_HighDensitySampling"),type:{bool:!0}},keepLayerOrder:{displayName:l("Visual_General_KeepLayerOrder"),description:l("Visual_General_KeepLayerOrderDescription"),type:{bool:!0}}}},border:{displayName:l("Visual_Border"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},color:{displayName:l("Visual_Border_Color"),type:{fill:{solid:{color:!0}}}},radius:{displayName:l("Visual_Radius"),type:{numeric:!0}},paddingTop:{displayName:l("Visual_PaddingTop"),type:{numeric:!0}},paddingBottom:{displayName:l("Visual_PaddingBottom"),type:{numeric:!0}},paddingLeft:{displayName:l("Visual_PaddingLeft"),type:{numeric:!0}},paddingRight:{displayName:l("Visual_PaddingRight"),type:{numeric:!0}}}},dropShadow:{displayName:l("Visual_DropShadow"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},preset:{displayName:l("Visual_DropShadow_Preset"),type:{enumeration:a.Preset}},position:{displayName:l("Visual_DropShadow_Position"),type:{enumeration:a.Position}},color:{displayName:l("Generic_Color"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:l("Transparency"),type:{numeric:!0}},shadowSpread:{displayName:l("Visual_BubbleSize"),type:{numeric:!0}},shadowBlur:{displayName:l("Visual_DropShadow_Blur"),type:{numeric:!0}},angle:{displayName:l("Visual_Angle"),type:{numeric:!0}},shadowDistance:{displayName:l("Distance"),type:{numeric:!0}}}},visualLink:{displayName:l("Visual_VisualLink"),suppressFormatPainterCopy:!0,properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},type:{displayName:l("Type"),description:l("Visual_VisualLink_Type_Description"),type:{enumeration:r.Type}},bookmark:{displayName:l("Generic_Bookmark"),description:l("Visual_VisualLink_Bookmark_Description"),type:{reference:{bookmark:!0}}},disabledTooltip:{displayName:l("Disabled_Tooltip"),type:{text:!0}},drillthroughSection:{displayName:l("Destination"),description:l("Visual_VisualLink_Destination_Description"),type:{reference:{section:!0}}},enabledTooltip:{displayName:l("Enabled_Tooltip"),type:{text:!0}},suppressDefaultTooltip:{displayName:l("Visual_SuppressDefaultTooltips"),type:{bool:!0}},showDefaultTooltip:{displayName:l("Visual_ShowTooltips"),type:{bool:!0}},navigationSection:{displayName:l("Destination"),description:l("Visual_VisualLink_Destination_Description"),type:{reference:{section:!0}}},tooltip:{displayName:l("Tooltip"),description:l("Visual_VisualLink_Tooltip_Description"),type:{text:!0}},webUrl:{displayName:l("Web_Url"),type:{misc:{webUrl:!0}}}}},visualTooltip:{displayName:l("Tooltip"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},type:{displayName:l("Type"),description:l("Visual_Tooltip_Type_Description"),type:{enumeration:t.VisualTooltip.Type}},section:{displayName:l("Page"),description:l("Visual_Tooltip_Section_Description"),type:{reference:{section:!0}}},titleFontColor:{displayName:l("Visual_Label_FontColor"),description:l("Visual_Tooltip_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},valueFontColor:{displayName:l("Visual_Value_FontColor"),description:l("Visual_Tooltip_Value_FontColorDescription"),type:{fill:{solid:{color:!0}}}},fontSize:{displayName:l("Visual_TextSize"),description:l("Visual_Tooltip_TextSizeDescription"),type:{formatting:{fontSize:!0}}},bold:{displayName:l("Bold"),type:{bool:!0}},italic:{displayName:l("Italic"),type:{bool:!0}},underline:{displayName:l("Underline"),type:{bool:!0}},fontFamily:{displayName:l("Visual_FontFamily"),description:l("Visual_Tooltip_FontFamilyDescription"),type:{formatting:{fontFamily:!0}}},background:{displayName:l("Background_Color"),description:l("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},transparency:{displayName:l("Transparency"),description:l("Visual_Tooltip_BackgroundTransparencyDescription"),type:{numeric:!0}},actionFontColor:{displayName:l("Visual_Action_FontColor"),description:l("Visual_Action_FontColor_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedTitleFontColor:{displayName:l("Visual_Label_FontColor"),description:l("Visual_Tooltip_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedBackground:{displayName:l("Background_Color"),description:l("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},themedValueFontColor:{displayName:l("Visual_Value_FontColor"),description:l("Visual_Tooltip_Value_FontColorDescription"),type:{fill:{solid:{color:!0}}}}}},stylePreset:{displayName:l("Visual_Table_StylePreset_SliceTitle"),properties:{name:{displayName:l("Visual_Table_StylePreset_SliceTitle"),type:{formatting:{stylePreset:!0}}}}},visualHeader:{displayName:l("Visual_Header"),description:l("VisualHeader_Toggle_Description"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},background:{displayName:l("Background_Color"),description:l("VisualHeader_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},border:{displayName:l("Visual_Border"),description:l("Visual_Border"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:l("Transparency"),description:l("VisualHeader_Background_TransparencyDescription"),type:{numeric:!0}},foreground:{displayName:l("VisualHeader_Foreground_Color"),description:l("VisualHeader_Foreground_ColorDescription"),type:{fill:{solid:{color:!0}}}},showVisualInformationButton:{displayName:l("VisualHeader_ShowVisualInformationButton"),description:l("VisualHeader_ShowVisualInformationButton_Description"),type:{bool:!0}},showVisualWarningButton:{displayName:l("VisualHeader_ShowVisualWarningButton"),description:l("VisualHeader_ShowVisualWarningButton_Description"),type:{bool:!0}},showVisualErrorButton:{displayName:l("VisualHeader_ShowVisualErrorButton"),description:l("VisualHeader_ShowVisualErrorButton_Description"),type:{bool:!0}},showDrillRoleSelector:{displayName:l("VisualHeader_ShowDrillRoleSelector"),description:l("VisualHeader_ShowDrillRoleSelector_Description"),type:{bool:!0}},showDrillUpButton:{displayName:l("VisualHeader_ShowDrillUpButton"),description:l("VisualHeader_ShowDrillUpButton_Description"),type:{bool:!0}},showDrillToggleButton:{displayName:l("VisualHeader_ShowDrillToggleButton"),description:l("VisualHeader_ShowDrillToggleButton_Description"),type:{bool:!0}},showDrillDownLevelButton:{displayName:l("VisualHeader_ShowDrillDownLevelButton"),description:l("VisualHeader_ShowDrillDownLevelButton_Description"),type:{bool:!0}},showDrillDownExpandButton:{displayName:l("VisualHeader_ShowDrillDownExpandButton"),description:l("VisualHeader_ShowDrillDownExpandButton_Description"),type:{bool:!0}},showPinButton:{displayName:l("VisualHeader_ShowPinButton"),description:l("VisualHeader_ShowPinButton_Description"),type:{bool:!0}},showFilterRestatementButton:{displayName:l("VisualHeader_ShowFilterRestatementButton"),description:l("VisualHeader_ShowFilterRestatementButton_Description"),type:{bool:!0}},showFocusModeButton:{displayName:l("VisualHeader_ShowFocusModeButton"),description:l("VisualHeader_ShowFocusModeButton_Description"),type:{bool:!0}},showCopyVisualImageButton:{displayName:l("VisualHeader_ShowCopyVisualImageButton"),description:l("VisualHeader_ShowCopyVisualImageButton_Description"),type:{bool:!0}},showSeeDataLayoutToggleButton:{displayName:l("VisualHeader_ShowSeeDataLayoutToggleButton"),description:l("VisualHeader_ShowSeeDataLayoutToggleButton_Description"),type:{bool:!0}},showOptionsMenu:{displayName:l("VisualHeader_ShowOptionsMenu"),description:l("VisualHeader_ShowOptionsMenu_Description"),type:{bool:!0}},showCommentButton:{displayName:l("VisualHeader_ShowCommentButton"),description:l("VisualHeader_ShowCommentButton_Description"),type:{bool:!0}},showTooltipButton:{displayName:l("VisualHeader_ShowVisualHeaderTooltip"),description:l("VisualHeader_ShowVisualHeaderTooltip_Description"),type:{bool:!0}},showPersonalizeVisualButton:{displayName:l("VisualHeader_ShowPersonalizeVisualButton"),description:l("VisualHeader_ShowPersonalizeVisualButton_Description"),type:{bool:!0}}}},visualHeaderTooltip:{displayName:l("VisualHeaderTooltip"),properties:{type:{displayName:l("Type"),type:{enumeration:n.Type}},section:{displayName:l("Page"),description:l("Visual_Tooltip_Section_Description"),type:{reference:{section:!0}}},text:{displayName:l("VisualHeaderTooltip_Text"),description:l("VisualHeaderTooltip_Text_Description"),type:{text:!0}},titleFontColor:{displayName:l("Generic_Color"),description:l("VisualHeaderTooltip_FontColorDescription"),type:{fill:{solid:{color:!0}}}},fontSize:{displayName:l("Visual_TextSize"),description:l("Visual_Tooltip_TextSizeDescription"),type:{formatting:{fontSize:!0}}},fontFamily:{displayName:l("Visual_FontFamily"),description:l("Visual_Tooltip_FontFamilyDescription"),type:{formatting:{fontFamily:!0}}},bold:{displayName:l("Bold"),type:{bool:!0}},italic:{displayName:l("Italic"),type:{bool:!0}},underline:{displayName:l("Underline"),type:{bool:!0}},background:{displayName:l("Background_Color"),description:l("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},transparency:{displayName:l("Transparency"),description:l("Visual_Tooltip_BackgroundTransparencyDescription"),type:{numeric:!0}},themedTitleFontColor:{displayName:l("Generic_Color"),description:l("VisualHeaderTooltip_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedBackground:{displayName:l("Background_Color"),description:l("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}}}}},e.ObjectProps=s.getPropertyIdentifiers(e.CommonObjectDescriptors),e.clone=function(e,t){if(e)return e=t.serializeVisualContainer(e),t.deserializeCanvasItem(e,!0)},e.isHidden=function(e){return!!e.display&&"hidden"===e.display.mode},e.setHidden=function(e,t){e.display=t?{mode:"hidden"}:void 0},(t.PinData||(t.PinData={})).getVisualType=function(e){if(e.visualContainer)return e.visualContainer.config.singleVisual.visualType}})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).VisualRelationshipFilterActionUtil||(e.VisualRelationshipFilterActionUtil={})).toString=function(e){switch(e){case 0:return"Default";case 1:return"DataFilter";case 2:return"HighlightFilter";case 3:return"NoFilter"}}})(powerbi=powerbi||{}),(function(i){var e;(function(e){var l=jsCommon.ArrayExtensions,C=i.data.ExpansionState,m=i.data.transforms.plugins,r=i.data.ProjectionUtils,u=i.data.QueryProjectionCollection,a=i.data.QueryProjectionsByRole,t=i.data.SemanticQuery,x=i.data.SQExpr,v=i.data.SQExprBuilder;function p(e,t,r){for(var i in this.defn=e,this.projections=t,this.expansionStates=r||[],t)_.isEmpty(t[i].activeProjectionRefs)||this.ensureActiveItems(i)}p.prototype.ensureExpansionState=function(e,t){var r,i=C.findExpansionState(this.expansionStates,e);return i||(i=new C(e,t),r=this.getRolesUniqueProjectionRefs(e),e=this.getRolesUniqueActiveProjectionsRefs(e,t.canCollapseRoot),i.updateLevels(r,e.length),this.expansionStates.push(i)),i.supportsMerge,t.supportsMerge,i},p.prototype.add=function(e,t,r){var i,a,o;r&&(i=r.exprName,a=r.fieldIndex,o=r.parameter,s=r.indexInParameter,n=r.nativeReferenceName);var n,s,l=(l=this.defn.selectNameOf(e))||this.addSelect(e,i,n),r=(this.getRoleProjections(t)||(this.projections[t]=new u([])),{queryRef:l}),p=0,e=this.projections[t];return o?(n=null!=s?s:null!=(i=o.length)?i:0,e.addProjection(r,{parameter:o,indexInParameter:n}),p=e.getParameterProjectionIndex(o,n),this.addNewQueryRefToActiveProjectionRefsIfNeeded(t,l,p)):(s=e.all(),null==a||a>s.length?(e.addProjection(r),p=s.length-1):(e.addProjection(r,{fieldIndex:a}),p=e.getColumnProjectionIndex(a),this.addNewQueryRefToActiveProjectionRefsIfNeeded(t,l,p))),this.updateExpansionStates(t,(function(e,t){return e.addLevel(l,t+p)})),p},p.prototype.addParameter=function(e,t,r){this.getRoleProjections(t)||(this.projections[t]=new u([]));t=this.projections[t],e={expr:e,index:r=null==r?t.getFieldCount():r,length:void 0};return t.addFieldParameter(e),r},p.prototype.removeParameterBySQExpr=function(e){var t,r=this.projections;for(t in r){var i=r[t],a=i.findParameterBySQExpr(e);_.isEmpty(a)||i.removeFieldParameters(a)}},p.prototype.removeParameter=function(e){var t,r=!1;for(t in this.projections)r=this.removeParameterByRoleName(e,t)||r;return r},p.prototype.removeParameterByRoleName=function(e,t){t=this.projections[t];return null==t?void 0:t.removeFieldParameters([e])},p.prototype.getParameterByFieldIndex=function(e,t){t=this.projections[t];return null==t?void 0:t.getParameterByFieldIndex(e)},p.prototype.getResolveParameterResultsByRole=function(){var t=this,e={},r=this.projections;if(r)for(var i in r){var a=this.getQueryFieldParametersByRole(i);if(!_.isEmpty(a))for(var o=e[i]=[],n=0,s=a;n<s.length;n++){var l=s[n],p=r[i].getParameterProjections(l).map((function(e){return{expr:t.defn.select().withName(e.queryRef).expr,alias:void 0}}));o.push({parameter:l,result:p})}}return e},p.prototype.removeExpr=function(e,t,r,i){if(t){for(var a=this.defn.select(),o=!1,n=a.length-1;0<=n;--n){var s=a[n].expr;if(p.areEqualIgnoringAggregate(s,e,r)){if(!this.removeAllProjectionsForExpr(s,i))return!1;o=!0}}return o}return this.removeAllProjectionsForExpr(e,i)},p.prototype.getQueryRefByProjectionIndex=function(e,t){e=this.projections[e];if(e){e=e.getQueryRefs();if(t<e.length)return e[t]}},p.prototype.getQueryRef=function(e,t){t&&void 0===t.fieldIndex&&void 0!==t.parameter&&t.indexInParameter;var r=t.fieldIndex,i=t.parameter,t=t.indexInParameter,e=a.getRole(this.projections,e);if(e)return i?e.getParameterProjections(i)[t].queryRef:r>=e.getFieldCount()?void 0:e.getColumnProjection(r).queryRef},p.prototype.removeProjection=function(e,t){t&&void 0===t.fieldIndex&&void 0!==t.parameter&&t.indexInParameter,this.projections[e];var r=t.fieldIndex,i=t.parameter,a=t.indexInParameter,t=this.getQueryRef(e,t);if(!t)return!1;var o=this.defn.select().withName(t);if(!o)return!1;var n,o=o.expr,s=this.projections[e],l=s.all(),p=i?(n={parameter:i,indexInParameter:a},s.getParameterProjectionIndex(i,a)):(n={fieldIndex:r},s.getColumnProjectionIndex(r)),i=(s.removeProjection(n),this.projections[e].activeProjectionRefs),a=(_.pull(i,t),_.isEmpty(l));return a&&_.isEmpty(s.getFieldParameters())?delete this.projections[e]:!a&&i&&0===i.length&&i.push(l[Math.max(0,p-1)].queryRef),this.updateExpansionStates(e,(function(e,t){return e.removeLevel(t+p)})),this.isUsed(t)||this.removeExpr(o,!1),!0},p.prototype.moveProjection=function(e,t,r,i){if(t===r)return!1;if(t<0||r<0)return!1;var a,o=this.projections[e],n=(o&&(a=o.all()),o.convertFieldIndexToProjectionIndex(r)),s=o.convertFieldIndexToProjectionIndex(t),l=o.convertFieldIndexToProjectionIndex(r+i);if(!a||l>a.length)return!1;var p=this.projections[e].activeProjectionRefs,u=o.moveFields(t,r,i);if(p)if((t<r?l:n)<p.length){t=_.take(a,o.convertFieldIndexToProjectionIndex(r+1));this.projections[e].activeProjectionRefs=_.map(t,(function(e){return e.queryRef}))}else if(s<p.length){for(var c=0,d=u;c<d.length;c++){var m=d[c];_.pull(p,m.queryRef)}0===p.length&&p.push(a[0].queryRef)}return this.updateExpansionStates(e,(function(e,t){return e.moveLevels(t+s,t+n,i)})),!0},p.prototype.setAggregate=function(e,t,r){return this.updateExpression(e,t,(function(e){return v.setAggregate(e,r)}))},p.prototype.removeAggregate=function(e,t,r){return this.updateExpression(e,t,(function(e){return v.removeAggregate(e,r)}))},p.prototype.setPercentOfGrandTotal=function(e,t){return this.updateExpression(e,t,(function(e){return v.setPercentOfGrandTotal(e)}))},p.prototype.removePercentOfGrandTotal=function(e,t){return this.updateExpression(e,t,(function(e){return v.removePercentOfGrandTotal(e)}))},p.prototype.setPercentOfRoleTotal=function(t,e,r){return this.updateExpression(e,r,(function(e){return v.setPercentOfRoleTotal(e,t)}))},p.prototype.removePercentOfRoleTotal=function(e,t){return this.updateExpression(e,t,(function(e){return v.removePercentOfRoleTotal(e)}))},p.prototype.updateVisualCalculation=function(e,t,r,i){var a=this.getQueryRef(t,{fieldIndex:e}),a=this.defn.select().withName(a);return!(!a||!x.isNativeVisualCalc(a.expr))&&this.updateExpression(t,e,(function(e){return v.setVisualCalcExpression(e,i,r)}))},p.prototype.orderBy=function(e){this.defn,this.defn=this.defn.orderBy(e)},p.prototype.removeOrderBy=function(e){this.defn,this.defn=this.defn.removeOrderBy(e)},p.prototype.removeUnusedOrderBy=function(){this.defn;for(var e=this.defn,t=0,r=e.orderBy();t<r.length;t++){var i=r[t].expr;e.selectNameOf(i)||(this.defn=e.removeOrderBy(i))}},p.prototype.addTransform=function(e,t,r){this.defn;for(var i={},a=this.defn.transforms(),o=0,n=a;o<n.length;o++)i[n[o].name]=!0;for(var s=jsCommon.StringExtensions.findUniqueName(i,e.name),t={algorithm:e.name,name:s,input:{parameters:t},output:void 0},l=(this.defn=this.defn.transforms(a.concat([t])),e.name===m.KMeansClustering.name&&r.grouping&&r.grouping.cluster),p=0,u=e.outputRoles;p<u.length;p++){var c=u[p],d=c.name;l&&(d=r.grouping.cluster.clusteringRole),this.add(v.transformOutputRoleRef(c.algorithmRole),d,{exprName:c.columnName||c.algorithmRole})}return s},p.prototype.removeTransform=function(e,t){this.defn;var r=_.find(this.defn.transforms(),(function(e){return e.name===t}));if(r){for(var i=0,a=e.outputRoles;i<a.length;i++){var o=a[i];this.removeExpr(v.transformOutputRoleRef(o.algorithmRole),!1)}this.defn=this.defn.removeTransform(r)}},p.prototype.updateTransform=function(t,e){this.defn;var r=_.find(this.defn.transforms(),(function(e){return e.name===t}));r&&(r.input.parameters=e)},p.prototype.clone=function(){return new p(this.defn,a.clone(this.projections),C.clone(this.expansionStates))},p.prototype.equals=function(e){return!!t.equals(this.defn,e.defn)&&(_.isEqual(this.projections,e.projections)&&_.isEqual(this.expansionStates,e.expansionStates))},p.prototype.ensureDrillableRoles=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];this.ensureActiveItems(a)&&t.push(a)}return t},p.prototype.ensureActiveItems=function(e){var t,e=this.projections[e];if(e)return t=e.all(),!_.isEmpty(t)&&_.isEmpty(e.activeProjectionRefs)?(e.activeProjectionRefs=[t[0].queryRef],!0):void 0},p.prototype.toggleShowAll=function(e){e=this.projections[e];e&&(e.showAll=!e.showAll)},p.prototype.hasShowAll=function(){return!_.isEmpty(this.projections)&&_.some(this.projections,(function(e){return e.showAll}))},p.prototype.roleContainsExpr=function(e,t){var e=this.projections[e],r=e&&e.all();if(!_.isEmpty(r))for(var i=0,a=this.defn.select();i<a.length;i++)for(var o=a[i],n=0,s=r;n<s.length;n++)if(s[n].queryRef===o.name&&x.equals(t,o.expr))return!0;return!1},p.prototype.getRoleNameForExpr=function(e){var t,r=this.projections;for(t in r){var i=this.tryGetExprs(t);if(i&&0<i.length)for(var a=0,o=i;a<o.length;a++){var n=o[a];if(x.equals(e,n))return t}i=r[t].getFieldParameters();if(!_.isEmpty(i))for(var s=0,l=i;s<l.length;s++){var p=l[s];if(x.equals(p.expr,e))return t}}},p.prototype.tryGetExpr=function(e,t){var e=this.getRoleProjections(e);if(e)return e=e[t],null==(t=r.tryGetExprByProjection(this.defn,e))?void 0:t.expr},p.prototype.tryGetExprs=function(e){e=r.tryGetExprs(this.defn,this.projections,e);if(void 0!==e)return _.map(e,(function(e){return e.expr}))},p.prototype.tryGetFieldExprs=function(e){return r.tryGetFieldExprs(this.defn,this.projections,e)},p.prototype.getUniqueQueryRefs=function(){var e=_.values(this.projections);return _.chain(e).map((function(e){return e.getQueryRefs()})).flatten(!0).uniq().value()},p.prototype.getUniqueQueryFields=function(){var t=this,e=_.keys(this.projections);return _.chain(e).map((function(e){return t.tryGetFieldExprs(e)})).flatten(!0).uniqWith(p.isEqualQueryFields).value()},p.prototype.hasProjections=function(){return _.values(this.projections).some((function(e){return 0<e.all().length}))},p.prototype.currentDrillMode=function(e){var t=this.getRoleProjections(e);if(!_.isEmpty(t)){e=this.projections[e];if(e){e=e.activeProjectionRefs;if(!_.isEmpty(e))return 1<e.length?2:e[0]!==t[0].queryRef?3:void 0}}},p.prototype.addSelect=function(e,t,r){var i=this.defn,t=(this.defn=i=i.addSelect(e,t,r),i.select()),r=t.length-1;return x.equals(e,t[r].expr),t[r].name},p.isEqualQueryFields=function(e,t){return e.isFieldParameter||t.isFieldParameter||void 0===e.queryName||void 0===t.queryName?e.isFieldParameter===t.isFieldParameter&&x.equals(e.expr,t.expr):e.queryName===t.queryName},p.prototype.updateExpansionStates=function(t,e){var r,i;_.isEmpty(this.expansionStates)||(_.remove(this.expansionStates,(function(e){return!e.supportsMerge})),(r=C.findExpansionStateForRole(this.expansionStates,t))&&(_.isEmpty(this.projections[t])||_.isEmpty(this.projections[t].all())?_.remove(this.expansionStates,(function(e){return e===r})):(i=_.takeWhile(r.roles,(function(e){return e!==t})),i=this.getRolesUniqueActiveProjectionsRefs(i,r.canCollapseRoot).length,e(r,i),e=r.getVisibleDescendentsDepth(r.root,-1),this.setActiveProjections(r.roles,e))))},p.prototype.removeAllProjectionsForExpr=function(e,v){var g,t=this.defn,h=t.selectNameOf(e);if(!h)return!1;_.remove(this.expansionStates,(function(e){return!e.supportsMerge}));var r,f=this.projections,y=this;for(r in f)!(function(t){var e=C.findExpansionStateForRole(y.expansionStates,t),r=f[t],i=r.all(),a=e&&_.takeWhile(e.roles,(function(e){return e!==t})),o=a&&y.getRolesUniqueActiveProjectionsRefs(a,e&&e.canCollapseRoot).length;if(v)for(var a=y.getQueryFieldParametersByRole(t),n=0,s=_.filter(a,(function(e){return x.equals(e.expr,v)}));n<s.length;n++)for(var l=s[n],p=l.length-1;0<=p;p--){var u={indexInParameter:p,parameter:l},c=r.getParameterProjectionIndex(l,p);(null==(g=i[c])?void 0:g.queryRef)===h&&(r.removeProjection(u),y.updateActiveProjectionRefAndExpansionState(t,h,o,c))}else for(c=i.length-1;0<=c;c--){var d=r.convertProjectionIndexToFieldIndex(c),m=r.getColumnProjection(d);(null==m?void 0:m.queryRef)===h&&(r.removeProjection(u={fieldIndex:d}),y.updateActiveProjectionRefAndExpansionState(t,h,o,c))}0!==i.length&&e&&(a=e.getVisibleDescendentsDepth(e.root,-1),y.setActiveProjections(e.roles,a))})(r);return this.isUsed(h)||(this.defn=t.removeSelect(e).removeOrderBy(e)),!0},p.prototype.updateActiveProjectionRefAndExpansionState=function(e,t,r,i){var a=this.projections[e],o=a.all(),e=C.findExpansionStateForRole(this.expansionStates,e),a=a.activeProjectionRefs;_.pull(a,t),a&&_.isEmpty(a)&&!_.isEmpty(o)&&a.push(o[Math.max(0,i-1)].queryRef),e&&e.removeLevel(r+i)},p.prototype.updateExpression=function(e,t,r){e=this.projections[e];if(!(a=e?e.all():a)||t>=a.length)return!1;var i=this.defn,a=a[t].queryRef,o=i.select(),n=l.indexWithName(o,a),o=o[n].expr,r=r(o),s=i.selectNameOf(r);return s?(e.updateQueryRef(t,s),this.isUsed(a)||(this.defn=i.removeSelect(o))):1<this.getUsageCount(a)?e.updateQueryRef(t,this.addSelect(r)):this.defn=i.setSelectAt(n,r),!0},p.prototype.isUsed=function(e){return 0<this.getUsageCount(e)},p.prototype.getUsageCount=function(t){var e,r=0,i=this.projections;for(e in i){var a=i[e].all();r+=_.filter(a,(function(e){return e.queryRef===t})).length}return r},p.prototype.getRoleProjections=function(e){e=a.getRole(this.projections,e);if(e)return e.all()},p.prototype.addNewQueryRefToActiveProjectionRefsIfNeeded=function(e,t,r){var i=this.getRoleProjections(e),e=this.projections[e].activeProjectionRefs;e&&(1<e.length&&r<e.length?e.splice(r,0,t):1===e.length&&0===r&&1<i.length&&i[1].queryRef===e[0]&&e.splice(0,1,t))},p.prototype.getRolesProjectionRefs=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r],a=this.projections[a];a&&(a=_.map(a.all(),(function(e){return e.queryRef})),t.push.apply(t,a||[]))}return t},p.prototype.getRolesUniqueProjectionRefs=function(e){return _.uniq(this.getRolesProjectionRefs(e))},p.prototype.getQueryFieldParametersByRole=function(e){if(!_.isEmpty(this.projections))return e=this.projections[e],e?e.getFieldParameters():[]},p.prototype.getParameterProjectionExprs=function(e){var t,r=this,i=[],a=this.projections;for(t in a)for(var o=a[t],n=0,s=o.findParameterBySQExpr(e);n<s.length;n++){var l=s[n],p=o.getParameterProjections(l).map((function(e){return r.defn.select().withName(e.queryRef).expr}));i.push({exprs:p,parameter:l})}return i},p.prototype.getQueryFieldParameters=function(){if(_.isEmpty(this.projections))return[];var e,t=[];for(e in this.projections){var r=this.projections[e];r&&t.push.apply(t,r.getFieldParameters())}return t},p.prototype.hasQueryFieldParameters=function(){return!_.isEmpty(this.getQueryFieldParameters())},p.prototype.hasVisualCalcExpressions=function(){return this.defn.select().some((function(e){return x.isNativeVisualCalc(e.expr)}))},p.prototype.resetExpansionStates=function(){this.expansionStates=[]},p.prototype.getRolesActiveProjectionsRefs=function(e,t){for(var r=this,i=[],a=t||_.some(e,(function(e){return r.projections[e]&&!_.isEmpty(r.projections[e].activeProjectionRefs)})),o=0,n=e;o<n.length;o++){var s=n[o],s=this.projections[s],l=s&&s.all(),s=l&&(s.activeProjectionRefs||!a&&_.map(l,(function(e){return e.queryRef})));if(s&&(i.push.apply(i,s||[]),l.length!==s.length&&_.uniqBy(l,(function(e){return e.queryRef})).length!==_.uniq(s).length))break}return i},p.prototype.getRolesUniqueActiveProjectionsRefs=function(e,t){return _.uniq(this.getRolesActiveProjectionsRefs(e,t))},p.areEqualIgnoringAggregate=function(e,t,r){return x.equals(v.removeAggregate(e,r),v.removeAggregate(t,r))},p.prototype.setActiveProjections=function(e,t){var r=this.projections,i=C.findExpansionState(this.expansionStates,e);i&&i.pinLevels(t);for(var a=0,o=e;a<o.length;a++){var n,s,l=o[a];0<t?(n=r[l]&&r[l].all(),s=void 0,s=(n=_.uniqBy(n,(function(e){return e.queryRef}))).length<=t?n:_.take(n,t),r[l].activeProjectionRefs=_.map(s,(function(e){return e.queryRef})),t-=s.length):r[l]&&(r[l].activeProjectionRefs=[])}},p.prototype.setNativeReferenceNameAt=function(e,t){this.defn.setNativeReferencNameAt(e,t)},e.VisualQuery=p})((e=i.explore||(i.explore={})).contracts||(e.contracts={}))})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={})).CurrentExplorationVersion="5.40"})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=e.upgrade||(e.upgrade={})).CurrentExplorationStateVersion="1.17",t.setCurrentExplorationStateVersion=function(e){t.CurrentExplorationStateVersion=e}})(powerbi=powerbi||{}),(function(e){var t,o,i;function r(e,t){return e.modelExtensions&&e.modelExtensions.withName(t)}function a(e,t){e=r(e,t);if(e)return e;throw new Error("Unable to find expected model extension: "+t)}function n(e,t,r){e.modelExtensions||(e.modelExtensions=o.createWithName());var i=e.modelExtensions.withName(t);return i||(i=s(t,r),e.modelExtensions.push(i)),i.extends,i}function s(e,t){return{name:e,extends:t,entities:o.createWithName()}}function l(e,t){return e.entities.withName(t)}function p(e,t,r){e=l(a(e,t),r);if(e)return e;throw new Error("Unable to find expected entity: "+r)}function u(e,t){e.entities||(e.entities=o.createWithName());var r=e.entities.withName(t);return r||(r={name:t,extends:t,measures:o.createWithName()},e.entities.push(r)),r.extends,r}function c(e,t){return e.measures.withName(t)}function d(e,t){e=c(e,t);if(e)return e;throw new Error("Unable to find expected measure:"+t)}function m(t){var e=Object.keys(t),e=_.chain(e).filter((function(e){return"name"!==e&&"extends"!==e})).filter((function(e){return!(_.isArray(t[e])&&_.isEmpty(t[e]))})).value();return _.some(e)}t=(t=e.explore||(e.explore={})).util||(t.util={}),o=jsCommon.ArrayExtensions,i=e.data.dsr,(t=t.ModelExtensionUtils||(t.ModelExtensionUtils={})).getOptionalModelExtension=r,t.getExpectedModelExtension=a,t.getOrCreateModelExtension=n,t.createModelExtension=s,t.ensureEntityExists=function(e,t,r){return u(n(e,t,i.DefaultSchemaName),r)},t.findEntity=l,t.getExpectedEntity=p,t.getOrCreateExtendingEntity=u,t.addMeasure=function(e,t){if(e.measures||(e.measures=o.createWithName()),e.measures.withName(t.name))throw new Error("Measure "+t.name+" already exists and cannot be added");e.measures.push(t)},t.getExpectedMeasure=function(e,t,r,i){return d(p(e,t,r),i)},t.findMeasureFromEntity=c,t.removeMeasure=function(e,t,r,i){var i=d(r=p(e,t,r),i),i=r.measures.indexOf(i);r.measures.splice(i,1),0===r.measures.length&&(delete r.measures,i=e,e=t,m(t=r)||(e=a(i,e),t=e.entities.indexOf(t),e.entities.splice(t,1),0===e.entities.length&&(delete e.entities,r=i,m(t=e)||(t=r.modelExtensions.indexOf(t),r.modelExtensions.splice(t,1),0===r.modelExtensions.length&&delete r.modelExtensions))))},t.setAnnotation=function(e,t,r){var i=null==r;if(i){var i=e,a=t;(a=i.annotations&&i.annotations.withName(a))&&(a=i.annotations.indexOf(a),i.annotations.splice(a,1),i.annotations&&0===i.annotations.length&&delete i.annotations)}else a=t,i=r,(t=e).annotations||(t.annotations=o.createWithName()),(r=t.annotations.withName(a))?r.value=i:(r={name:a,value:i},t.annotations.push(r))},t.getAnnotationValue=function(e,t){if(e=e.annotations&&e.annotations.withName(t))return e.value},t.toQueryExtensionSchema=function(e){var t;if(e)return t={Version:0,Name:e.name,Extends:e.extends},e.entities&&(t.Entities=_.map(e.entities,(function(e){var t={Extends:e.extends,Name:e.name};return e.measures&&(t.Measures=_.map(e.measures,(function(e){var t=e.dataType;return 6!==t&&9!==t||(t=7),{Name:e.name,Expression:e.expression,DataType:t}}))),t}))),t}})(powerbi=powerbi||{}),(function(e){(function(n){function e(e){this.modelExtension=e,this.visited={}}e.prototype.visitReference=function(e){if(e.schema===this.modelExtension.name){var t=n.ModelExtensionUtils.findEntity(this.modelExtension,e.entity);if(t){var r=n.ModelExtensionUtils.findMeasureFromEntity(t,e.name);if(r){e=this.toVisitedKey(e);if(!this.visited[e]){this.visitMeasure(this.modelExtension,t,r),this.visited[e]=!0;for(var i=0,a=r.references.measures;i<a.length;i++){var o=a[i];this.visitReference(o)}}}}}},e.prototype.visitMeasure=function(e,t,r){},e.prototype.toVisitedKey=function(e){return JSON.stringify(e)},n.ModelExtensionDependencyVisitor=e})((e=e.explore||(e.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(e){var t,u;function i(e){var t=e.resourcePackages;return t||(e.resourcePackages=t=[]),t}t=(t=e.explore||(e.explore={})).util||(t.util={}),u=e.visualHost.utils.ResourcePackageUtils,(t=t.ResourcePackageUtils||(t.ResourcePackageUtils={})).newSharedResourceItem=function(e,t,r){return u.newSharedResourceItem(e,t,r)},t.ensureResourcePackageType=function(e,t,r){return e=i(e),u.ensureResourcePackage(e,t,r)},t.ensurePublicCustomVisuals=function(e){var t=e.publicCustomVisuals;return t||(e.publicCustomVisuals=t=[]),t},t.ensureResourcePackages=i,t.synchronizePackageIds=function(e,t){if(!_.isEmpty(t)&&!_.isEmpty(e))for(var r=0,i=t;r<i.length;r++){var a=i[r],o=u.findResourcePackage(e,a.type,a.name);if(o){o.id,3===a.type&&(a.id,o.id),a.id=o.id;for(var n=0,s=a.items;n<s.length;n++){var l=s[n],p=u.findItemInPackage(o,l.name);p&&(p.id,3===a.type&&(l.id,p.id),l.id=p.id)}}}}})(powerbi=powerbi||{}),(function(e){var i;e=e.explore||(e.explore={}),(i=e.dataReaderPlugins||(e.dataReaderPlugins={})).ExplorationDataReaderType="exploration",i.registerExplorationDataReaderExtension=function(e,t,r){e[i.ExplorationDataReaderType],e[i.ExplorationDataReaderType]={name:"exploration",extends:"dsr",queryExtensionProvider:i.createExplorationQueryExtensionProvider(),schemaReader:function(){return i.createConceptualSchemaReader(t,r)}}},i.getExplorationDataReaderDataSource=function(e){if(e=_.find(e,(function(e){return"exploration"===e.type})))return e.exploration}})(powerbi=powerbi||{}),(function(e){var t,s,r,i,a,o,n,l;function p(n){return function(e,t,r){var i={query:e,extensions:void 0,queryRewrites:t};if(1!==n.length)return r?r(e,t):i;var a=n[0],o=a.getModelExtensions();if(_.isEmpty(o))return r?r(e,t):i;i=s.toQueryExtensionSchema(l.build(e,o.withName(a.schemaName)));return r?r(e,t,i):{query:e,queryRewrites:t,extensions:i}}}function u(e){var t=a.call(this)||this;return t.dependencyVisitor=e,t}function c(e){return n.call(this,e)||this}t=(t=e.explore||(e.explore={})).dataReaderPlugins||(t.dataReaderPlugins={}),s=e.explore.util.ModelExtensionUtils,r=e.explore.util.ModelExtensionDependencyVisitor,i=e.data.SQExpr,e=e.data.SQExprRewriter,t.createExplorationQueryExtensionProvider=function(){return p},__extends(u,a=e),u.prototype.visitMeasureRef=function(e){return i.isEntity(e.source)&&this.dependencyVisitor.visitReference({schema:e.source.schema,entity:e.source.entity,name:e.ref}),e},o=u,__extends(c,n=r),c.build=function(e,t){t=new c(t);return e.rewrite(new o(t)),t.result},c.prototype.visitMeasure=function(e,t,r){this.result=this.result||s.createModelExtension(e.name,e.extends);e=s.getOrCreateExtendingEntity(this.result,t.name);s.findMeasureFromEntity(e,r.name)||s.addMeasure(e,r)},l=c})(powerbi=powerbi||{}),(function(f){var e,y,a;function C(e,t,r){var i=new a;return i.name=e,i.extends=t,i.capabilities={canEdit:r,discourageQueryAggregateUsage:!1,isExtendable:!1,isQnaEnabled:!1,normalizedFiveStateKpiRange:!1,supportsMedian:!1,supportsPercentile:!1,supportsScopedEval:!1,supportsStringMinMax:!1,supportsMultiTableTupleFilters:!1,supportsTimeIntelligenceQuickMeasures:!1,supportsCalculatedColumns:!1,supportsGrouping:!1,limitMultiColumnFiltersToQueryGroupColumns:!1,supportsBinnedLineSample:!1,supportsOverlappingPointsSample:!1,supportsQna:!1,insights:{},supportsFastRefresh:!1,supportsSubqueryRegrouping:!1,supportsTopNPerLevel:!1,supportsExtensionColumns:!1,canEditChangeDetectionMeasure:!1,supportsGroupSynchronization:!1,supportsScopedDataReduction:!1,transformCapabilities:{supportedTransforms:[]},supportChangeDetectionMeasureRefresh:!1,supportsSparklineData:!1},i.entities=y.createWithName(),i}e=(e=f.explore||(f.explore={})).dataReaderPlugins||(e.dataReaderPlugins={}),y=jsCommon.ArrayExtensions,a=f.data.ConceptualSchema,(e=e.ExplorationConceptualSchemaFactory||(e.ExplorationConceptualSchemaFactory={})).createExtensionSchema=C,e.convertModelExtension=function(e,t){var r=C(e.name,e.extends,t);if(e.entities)for(var i=0,a=e.entities;i<a.length;i++){var o=a[i],n={name:o.name,extends:o.extends,displayName:o.name,properties:y.createWithName(),hierarchies:y.createWithName(),displayFolders:y.createWithName(),capabilities:{canRefresh:!1,canEditSource:!1,canRename:!1,canDelete:!1,canEditStorageMode:!1,supportsClustering:!1,supportsBinByCount:!1,limitOnNumberOfGroups:null,dataView:null},source:{}};if(r.entities.push(n),o.measures)for(var s=0,l=o.measures;s<l.length;s++){var p=l[s],u={name:p.name,displayName:p.name,type:f.ValueType.fromPrimitiveTypeAndCategory(p.dataType,p.dataCategory),kind:1,hidden:p.hidden,errorMessage:p.errorMessage,queryable:p.errorMessage?1:0,format:p.formatInformation&&p.formatInformation.formatString,measure:{},canDelete:r.capabilities.canEdit,description:p.description},c=(h=g=v=c=m=d=c=void 0,p),d=n,m=u;if(c.displayFolder)for(var c=c.displayFolder.split(";"),v=0,g=c;v<g.length;v++){var h=g[v].split("\\");!(function e(t,r,i,a){var o;i.withName(t)?o=i.withName(t):(o={displayName:t,name:t,properties:y.createWithName(),displayFolders:y.createWithName(),hierarchies:y.createWithName()},i.push(o));Array.isArray(r)&&r.length?e(r.shift(),r,o.displayFolders,a):o.properties.push(a)})(h.shift(),h,d.displayFolders,m)}p.measureTemplate&&(u.measure.template={name:p.measureTemplate.daxTemplateName}),n.properties.push(u)}}return r}})(powerbi=powerbi||{}),(function(e){var t,n,o,r;function i(e,t){this.promiseFactory=e,this.canEditSchemas=t}t=e.explore||(e.explore={}),n=t.dataReaderPlugins||(t.dataReaderPlugins={}),o=e.data.FederatedConceptualSchema,n.createConceptualSchemaReader=function(e,t){return new r(e,t=void 0===t?!1:t)},i.prototype.execute=function(e){e=e.dataSources;if(!e||1<e.length)return this.promiseFactory.reject(null);var e=e[0],t=e.exploration;if(!t)return this.promiseFactory.reject(null);var r=[],t=t.getModelExtensions();if(_.isEmpty(t))r.push(n.ExplorationConceptualSchemaFactory.createExtensionSchema(e.name,e.extends,this.canEditSchemas));else for(var i=0,a=t;i<a.length;i++){var o=a[i];r.push(n.ExplorationConceptualSchemaFactory.convertModelExtension(o,this.canEditSchemas))}return this.promiseFactory.resolve({data:{extensionSchemas:r}})},i.prototype.transform=function(e){for(var t={schemas:{}},r=0,i=e.data.extensionSchemas;r<i.length;r++){var a=i[r];t.schemas[a.name]=a}return{schema:new o(t)}},r=i})(powerbi=powerbi||{}),(function(e){function u(e,t){var r=(function(e,t){for(var r=[],i=[],a=e.visualContainers.slice(),o=0,n=t.visualContainers;o<n.length;o++){var s,l,p=n[o];void 0!==p.id&&(s=jsCommon.ArrayExtensions.findWithId(a,p.id))?(l=a.indexOf(s),a.splice(l,1),jsCommon.JsonComparer.equals(s,p)||i.push(p)):r.push(p)}return{added:r,updated:i,removed:a}})(e,t);return{added:r.added,updated:r.updated,removed:r.removed,page:t,originalPage:e}}((e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).ExplorationDiffer||(e.ExplorationDiffer={})).diff=function(e,t){return{pages:(function(e,t){for(var r=[],i=[],a=e.slice(),o=0,n=t.length;o<n;o++){var s,l,p=t[o];void 0!==p.id&&(s=jsCommon.ArrayExtensions.findWithId(a,p.id))?(l=a.indexOf(s),a.splice(l,1),l=u(s,p),i.push(l)):r.push(p)}return{added:r,updated:i,removed:a}})(e.sections,t.sections),pods:(function(e,t){for(var r=[],i=[],t=t||[],a=e?e.slice():[],o=0,n=t;o<n.length;o++){var s,l,p=n[o];void 0===p.id?r.push(p):(s=p.id,0<=(l=_.findIndex(a,(function(e){return e.id===s})))?(i.push({updatedPod:p,originalPod:a[l]}),a.splice(l,1)):r.push(p))}return{added:r,removed:a,updated:i}})(e.pods,t.pods)}}})(powerbi=powerbi||{}),(function(g){var x,h,d,f,y,e,S,r,l;function C(e,t,r,i,a,o,n,s){this.promiseFactory=e,this.httpService=t,this.serializer=r,this.telemetryService=i,this.featureSwitchService=a,this.cache={},this.resourcePackageCopyService=o,this.uriPrefix=n||"explore/",this.preloadExplorationsService=s}x=g.explore||(g.explore={}),h=x.proxies||(x.proxies={}),d=g.telemetry.EXDeserializeExplorationEventName,f=g.telemetry.EXGetExplorationEventName,y=g.fillTelemetryEvent,e=g.MonitorWith,S=g.explore.util.ResourcePackageUtils,r=jsCommon.HttpUtils.attachPerformanceTimingByUrl,h.createExplorationProxy=function(e,t,r,i,a,o,n,s){return new l(e,t,r,i,a,o,n,s)},h.saveExplorationSerializationOptions={withData:!0,excludeHighContrastTheme:!0,forSave:!0},C.prototype.get=function(e){var r,i=this,t=this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.telemetryV2,a=this.telemetryService,o=e.parentActivity?a.startChildEvent(e.parentActivity.event,g.telemetry.EXGetExploration,{fromCache:!1}):a.startEvent(g.telemetry.EXGetExploration,{fromCache:!1}),a=(e.parentContextActivity&&(r=e.parentContextActivity.createChildActivity({name:"Get Exploration"})),e.sectionId),n=e.id,s=e.model,l=e.bookmarkGuid;if(e.allowResultFromClientCache){e=this.getExplorationFromCache(n,a,s,l);if(e)return t&&y(f,{fromCache:!0}),o.event.info.fromCache=!0,o.resolve(),r&&r.resolve(),e}var p,u,c=t?new g.PbiDeferred:this.promiseFactory.defer(),d=this.uriPrefix+"reports/"+n+"/exploration",m=(_.isNumber(a)&&(d+="/sections/"+a),_.isEmpty(l)||(d+="?bookmarkGuid="+l),C.getCacheKey(n,a,l)),v=(this.cache[m.fullKey]={promise:c.promise},this.httpService.powerbiRequestOptions(o.event,"GetExploration"));return v.responseType="text",this.preloadExplorationsService&&(p=this.preloadExplorationsService.getPreloadedExplorations(),u=this.preloadExplorationsService.getPreloadExplorationsUrl()),u===d&&p?(p.then((function(e){i.attachPerfTimingToTelemetry(o.event.info,d);var t=jsCommon.JsonExtensions.tryParseJSON(e);i.onSuccess(t,c,e,r,s,m)}),(function(e){i.onError(__assign(__assign({},e),{data:void 0}),n,c,m,!0),i.httpGet(d,v,o,c,n,s,m,r)})),this.preloadExplorationsService.clear()):this.httpGet(d,v,o,c,n,s,m,r),c.promise},C.prototype.httpGet=function(r,e,i,a,t,o,n,s){var l=this;this.httpService.get(r,e).then((function(e){l.attachPerfTimingToTelemetry(i.event.info,r);var e=e.data,t=jsCommon.JsonExtensions.tryParseJSON(e);l.onSuccess(t,a,e,s,o,n),i.resolve()}),(function(e){l.attachPerfTimingToTelemetry(i.event.info,r),i.reject(g.errorDetailsHelper.getTelemetryErrorDetails(e.error,e.status)),l.onError(__assign(__assign({},e),{data:void 0}),t,a,n),s&&s.reject()}))},C.prototype.attachPerfTimingToTelemetry=function(e,t){r(t,e)},C.prototype.save=function(e,t,r,i){return this.saveInternal(e,t,r,!1,i)},C.prototype.saveWithoutGroupIdHeader=function(e,t,r){return this.saveInternal(e,t,r,!0)},C.prototype.saveInternal=function(o,n,s,l,p){var u=this,c=this.promiseFactory.defer();return this.copyResourcePackages(n).then((function(){var e,t=C.getCacheKey(s),r=u.serializer.serializeExploration(n,h.saveExplorationSerializationOptions),i=u.serializer.stringifyExplorationConfigs(r),a=u.cloneExplorationShallowForSave(i);null==n.id?(e=u.uriPrefix+"explorations/?reportid="+s,u.httpService.put(e,i,u.httpService.powerbiRequestOptions(null,"SaveExploration")).then((function(e){return u.onSuccess(e.data,c,JSON.stringify(e.data),void 0,null,t)}),(function(e){return u.onError(e,s,c,t)}))):(e=h.ExplorationDiffer.diff(o,i),n.id,u.explorationUpdateDiff(e,n.id,n,a,i,l,p).then((function(){c.resolve({wireContractJSON:JSON.stringify(i),exploration:n,isMobileOptimized:r.layoutOptimization}),u.updateExplorationCache(t,r)}),(function(e){c.reject(e)})))})),c.promise},C.prototype.copyResourcePackages=function(r){var i=[];if(r.resourcePackages)for(var a=r.report&&r.report.folderId,o=this,e=0,t=r.resourcePackages.length;e<t;e++)!(function(e){var t=e;i.push(o.resourcePackageCopyService.copyResourcePackageIfNeeded(r.resourcePackages[t].id,a,null).then((function(e){null!=e&&(r.resourcePackages[t]=e)})))})(e);return this.promiseFactory.all(i)},C.prototype.getModelsAndExploration=function(e,t,r){var i=this,a=this.promiseFactory.defer(),e=this.uriPrefix+"reports/"+e+"/modelsAndExploration?preferReadOnlySession="+t;return r&&(e+="&bookmarkGuid="+r),this.httpService.get(e,this.httpService.powerbiRequestOptions(null,"GetModelsAndExploration")).then((function(t){var r=t.data.models;i.featureSwitchService.registerFeatureSwitches(t.data.featureSwitches),i.serializer.ensureInitialized().then((function(){var e=i.serializer.deserializeExploration(i.serializer.parseExplorationConfigs(t.data.exploration),[],!0,r);a.resolve({exploration:e,models:r,featureSwitches:t.data.featureSwitches})}))}),(function(e){a.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{})})),a.promise},C.prototype.cloneExplorationShallowForSave=function(e){return{id:e.id,reportId:e.reportId,config:e.config,filters:e.filters,layoutOptimization:e.layoutOptimization,sections:void 0,resourcePackages:_.cloneDeep(e.resourcePackages),publicCustomVisuals:e.publicCustomVisuals}},C.prototype.explorationUpdateDiff=function(e,t,m,r,v,i,a){var g=this,h=this.promiseFactory.defer(),o={},n=(o.exploration=r,-1),s=-1,l=-1,f={},y={},C={},r=(o.addedPods=e.pods.added.map((function(e){return e.id=s--,C[e.name]=e.id,e})),o.deletedPods=e.pods.removed.map((function(e){return e.id})),o.updatedPods=e.pods.updated.reduce((function(e,t){return jsCommon.JsonComparer.equals(t.originalPod,t.updatedPod)||e.push(t.updatedPod),e}),[]),o.addedPages=e.pages.added.map((function(e){if(e.id=n--,f[e.name]=e.id,e.visualContainers)for(var t=0,r=e.visualContainers;t<r.length;t++){var i=r[t],a=(i.id=l--,JSON.parse(i.config));y[g.concatenatePageAndVisualContainerNames(e.name,a.name)]=i.id}return e})),o.deletedPages=e.pages.removed.map((function(e){return e.id})),o.updatedPages=e.pages.updated.reduce((function(e,t){for(var r=0,i=t.added;r<i.length;r++){var a=i[r],o=(a.id=l--,JSON.parse(a.config));y[g.concatenatePageAndVisualContainerNames(t.page.name,o.name)]=a.id}var n=g.getUpdatedPageProperty(t);return _.isEmpty(n.addedVisualContainers)&&_.isEmpty(n.updatedVisualContainers)&&_.isEmpty(n.deletedVisualContainers)&&_.isEmpty(n.pageProperty)||e.push(n),e}),[]),this.uriPrefix+"explorations/savereport/"+t);return e=i?this.httpService.powerbiRequestOptions(null,"explorationUpdateDiff",{dismissGroupObjectId:!0}):this.getRequestOptionsWithGroupId(a),this.httpService.post(r,o,e).then((function(e){var e=e&&e.data,t=e&&e.addedPodIds,r=e&&e.addedSectionIds,i=e&&e.addedVisualContainerIds,e=e&&e.exploration&&e.exploration.resourcePackages;if(e&&S.synchronizePackageIds(g.serializer.deserializeResourcePackages(e),S.ensureResourcePackages(m)),m.pods&&t)for(var a=0,o=m.pods.length;a<o;a++){var n,s=m.pods[a];(u=_.find(t,{oldId:C[s.name]}))&&(n=v.pods[a],s.id=n.id=u.id)}var l=x.contracts.Section.filterTransient(m.sections),p=v.sections;if(l){l.length,p.length;for(a=0,o=l.length;a<o;a++){var u,c=l[a],d=p[a],d=((u=_.find(r,{oldId:f[c.name]}))&&(c.id=d.id=u.id),d.visualContainers);i&&g.updateDiffForContainerIds(c,d,i,y)}}h.resolve(m)}),(function(e){return h.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{})})),h.promise},C.prototype.updateDiffForContainerIds=function(e,t,r,i){for(var a=0,o=t;a<o.length;a++){var n=o[a],s=JSON.parse(n.config),l=_.find(r,{oldId:i[this.concatenatePageAndVisualContainerNames(e.name,s.name)]});l&&(g.ItemGroupingManager.find(s.name,e.visualContainerGroups).id=n.id=l.id)}},C.prototype.concatenatePageAndVisualContainerNames=function(e,t){return e+"/"+t},C.prototype.getRequestOptionsWithGroupId=function(e,t,r){return e?this.httpService.powerbiRequestOptions(t,r,{groupObjectIdOverride:e}):this.httpService.powerbiRequestOptions(t,r)},C.prototype.saveAs=function(i,a,o,n,s,l,p,u,c,d){var m=this;if(s&&u)throw Error("Save As request should not be sent with both the folder id and the folder object id.");var v=this.promiseFactory.defer();return this.copyResourcePackages(i).then((function(){var e=m.serializer.stringifyExplorationConfigs(m.serializer.serializeExploration(i,h.saveExplorationSerializationOptions)),t=i.reportId,e=(e.reportId=void 0,e.report=void 0,{modelIds:[o],exploration:e,packageId:l?0:n,folderId:s,sourceReportId:t,folderObjectId:u,sensitivityLabelId:c}),t=(a=encodeURIComponent(a),m.uriPrefix+"explorations/"+(d||"")+"?name="+a),r=(l&&(t+="&personalizedreport=true"),m.getRequestOptionsWithGroupId(p,void 0,"saveExplorationAs"));m.httpService.put(t,e,r).then((function(e){return m.onSuccess(e.data,v,JSON.stringify(e.data),void 0,void 0)}),(function(e){return m.onError(e,o,v)}))})),v.promise},C.prototype.saveVisualContainerQueries=function(e,t){e=this.uriPrefix+"explorations/"+e+"/cache";return this.httpService.post(e,t,this.httpService.powerbiRequestOptions(null,"SaveVisualContainerQueries"))},C.prototype.getUpdatedPageProperty=function(e){var t={pageId:e.page.id},r=(t.addedVisualContainers=e.added,t.updatedVisualContainers=e.updated,t.deletedVisualContainers=e.removed.map((function(e){return e.id})),this.shallowCloneSection(e.originalPage)),e=this.shallowCloneSection(e.page);return jsCommon.JsonComparer.equals(r,e)||(t.pageProperty=e),t},C.prototype.shallowCloneSection=function(e){return{config:e.config,displayName:e.displayName,displayOption:e.displayOption,filters:e.filters,height:e.height,id:e.id,name:e.name,objectId:e.objectId,ordinal:e.ordinal,transient:e.transient,visualContainers:void 0,width:e.width}},C.prototype.getExplorationFromCache=function(e,t,r,i){e=this.findMatch(e,t,i);if(e){i=e.result;if(i.promise)return i.promise;if(i.data)if(null==t||_.some(i.data.sections,(function(e){return e.id===t})))return e=this.promiseFactory.defer(),e.resolve({wireContractJSON:JSON.stringify(this.serializer.stringifyExplorationConfigs(i.data)),exploration:this.serializer.deserializeExploration(i.data,[],!0,r)}),e.promise}},C.prototype.findMatch=function(e,t,r){var t=C.getCacheKey(e,t,r),i=this.cache[t.fullKey];if(i||null!=r||(t=C.getCacheKey(e),i=this.cache[t.fullKey]),i)return{key:t,result:i}},C.prototype.updateExplorationCache=function(r,e){var t,i=this;r&&(e?((t=this.cache[r.fullKey])?(t.promise&&delete t.promise,t.data=e):this.cache[r.fullKey]={data:e,promise:null},r.part&&!this.cache[r.part.reportKey]&&((t=_.clone(e)).activeWebBookmark&&delete t.activeWebBookmark,this.cache[r.part.reportKey]={data:t,promise:null}),r.allSectionKey&&_.forOwn(this.cache,(function(e,t){t!==r.fullKey&&null!=t.match(new RegExp("^"+r.fullKey))&&delete i.cache[t]})),this.cacheExpirationTimerId&&clearTimeout(this.cacheExpirationTimerId),this.cacheExpirationTimerId=setTimeout((function(){i.clearCache()}),18e5)):delete this.cache[r.fullKey])},C.prototype.clearCache=function(){this.cache={}},C.prototype.logDeserializationErrorsTelemetryEvents=function(e,t){_.find(t,(function(e){return 0===e.errorType}))&&((t=e.config).version,this.telemetryService.logEvent(g.telemetry.NewerExplorationVersion,{explorationVersion:t.version.toString(),supportedVersion:x.services.upgrade.CurrentExplorationVersion.toString()}))},C.prototype.onSuccess=function(e,t,r,i,a,o){try{var n=[],s=this.deserializeExploration(e,r,n,i,a),l=s&&s.explorationWireContract,p=s&&s.explorationContract,u=(i&&i.setProperty("deserializationDuration",null==s?void 0:s.duration),{wireContractJSON:r,exploration:p,isMobileOptimized:l.layoutOptimization});e.report&&(u.modelId=e.report.modelId,u.reportGuid=e.report.objectId),t.resolve(u),this.logDeserializationErrorsTelemetryEvents(l,n),this.updateExplorationCache(o,l),i&&i.resolve()}catch(e){i&&i.reject(e),t.reject(e)}},C.prototype.deserializeExploration=function(e,t,r,i,a){var o,n=this,s=this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.telemetryV2,l=(e&&e.sections&&(c=e.sections.length),this.telemetryService.startEvent(g.telemetry.EXDeserializeExploration,{length:t.length,upgraderCount:0,sectionCount:c,reportGuid:null==(c=null==e?void 0:e.report)?void 0:c.objectId})),p=this.serializer.parseExplorationConfigs(e),u=(i&&(i.setProperty("explorationJSONStringLength",t.length),i.setProperty("explorationVersion",p.config.version)),{upgraderCount:0}),c=jsCommon.PerfTimer.logTime((function(){l.event.info.explorationVersion=p.config.version,s&&y(d,{explorationVersion:p.config.version,length:t.length}),o=n.serializer.deserializeExploration(p,r,!0,a,u,i),l.event.info.upgraderCount=u.upgraderCount}));return l.resolve(),s&&y(d,{upgraderCount:u.upgraderCount}),{explorationContract:o,explorationWireContract:p,duration:c}},C.prototype.onError=function(e,t,r,i,a){a||r.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{}),this.updateExplorationCache(i,null)},C.getCacheKey=function(e,t,r){var i,e=null!=t?e+"_"+t:e+"_[0-9]+";return r?(_.size(r),i=_.cloneDeep(e),{fullKey:e+="_"+r,allSectionKey:null==t,part:{reportKey:i}}):{fullKey:e,allSectionKey:null==t}},__decorate([e(f)],C.prototype,"get",null),__decorate([e(d)],C.prototype,"deserializeExploration",null),l=C})(powerbi=powerbi||{}),(function(e){(e=(e=(e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).wireContracts||(e.wireContracts={})).VisualLink||(e.VisualLink={})).Bookmark="Bookmark",e.Back="Back",e.Qna="Qna"})(powerbi=powerbi||{}),(function(e){(e=(e=(e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).wireContracts||(e.wireContracts={})).VisualTooltip||(e.VisualTooltip={})).Canvas="Canvas",e.Default="Default"})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).util||(e.util={})).DisplayNameServiceUtils||(e.DisplayNameServiceUtils={})).concatStrings=function(e,t,r){if(_.isEmpty(e))return null;if(1===e.length)return e[0];var i=e.pop();return StringExtensions.format(r.stringResourceProvider.get(t),1<e.length?e.join(r.stringResourceProvider.get("ListJoin_Separator")):e[0],i)}})(powerbi=powerbi||{}),(function(e){function x(e,t,r){e=e.defn.select().withName(t);return e?{expr:e.expr,roleName:r}:void 0}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).DrillUtils||(e.DrillUtils={})).getDrillableRoles=function(e){return null!=(e=e.drilldown)&&e.roles?e.roles:[]},e.getDrillFilterRemovalInfoList=function(e,t,r){if(t){var i,a;switch(r){case 1:o=(function(e,t){var r=[],i=e.projections,a=t.sourceCount,o=t.sourceIndex,n=t.sourceRole,s=t.targetRole;if(i[s]){var l=(g=i[s]).all(),t=t.targetIndex;o<=t&&n===s&&(t+=a);for(var p=g.convertFieldIndexToProjectionIndex(t),u=l.length;p<u;p++){for(var c=g.getProjectionsByProjectionIndex(p),d=0,m=c;d<m.length;d++){var v=m[d];r.push(x(e,v.queryRef,s))}p+=c.length-1}}if(i[n])for(var g=i[n],h=a-1;0<=h;h--)for(var f=g.getProjectionsByFieldIndex(o+h),y=0,C=f;y<C.length;y++){v=C[y];r.push(x(e,v.queryRef,n))}return r})(e,t);break;case 0:if(t.expr)for(var o=[],n=0,s=jsCommon.ArrayExtensions.ensureArray(t.expr);n<s.length;n++){var l=s[n];o.push((l=l,a=void 0,a=(i=e).defn.selectNameOf(l),i=(function(e,t){for(var r in e){var i=e[r].all();if(0<=_.findIndex(i,(function(e){return e.queryRef===t})))return r}})(i.projections,a),{expr:l,roleName:i}))}else o=(function(e,t){for(var r=[],i=null!=(i=t.count)?i:1,a=t.role,o=e.projections[a],n=t.projOptions.fieldIndex+i-1,s=i-1;0<=s;s--,n--)for(var l=o.getProjectionsByFieldIndex(n),p=0,u=l;p<u.length;p++){var c=u[p];r.push(x(e,c.queryRef,a))}return r})(e,t);break;default:return}return _.compact(o)}}})(powerbi=powerbi||{}),(function(e){var s,f,E;function N(e,a,o,n){e&&(y(e.filters,n),_.forOwn(e.sections,(function(e,t){var v,r,g,h,i=_.find(a,(function(e){return e.name===t}));i=i,v=o,r=n,(e=e)&&i&&(r.visitSectionState(e),y(e.filters,r),(g=r.visualContainerStateVisitor)&&(h=i.visualContainers,_.forOwn(e.visualContainers,(function(e,t){var r=_.find(h,(function(e){return e.name===t})),i=v,a=g;if(e&&r){a.visitVisualContainerState(e),y(e.filters,a);var o=e.highlight,n=a;if(o){if(!_.isEmpty(o.selection))for(var s=0,l=o.selection;s<l.length;s++){var p=l[s];n.visitSelectorsByColumn(p)}o.filterExpressionMetadata&&n.visitFilterExpressionMetadata(o.filterExpressionMetadata)}var o=e&&e.singleVisual,e=r,r=i,u=a;if(o){u.visitSingleVisualState(o);i=o.orderBy,i=(i&&u.visitOrderByStates(i),o.objects);if(i){e=f.VisualContainerUtils.getVisualCapabilities(e,r),e=(!e||(r=e.objects)&&u.visitDataViewObjectDefinitionUpdates(i,r),i.merge),r=(e&&C(e,u),i.remove);if(!_.isEmpty(r))for(var c=0,d=r;c<d.length;c++){var m=d[c].selector;m&&u.visitSelector(m)}}e=o.activeProjections;e&&u.visitActiveProjectionStates(e)}}}))))})))}function V(e,r,t){var i,a,o,n;r.visitVisualContainer(e),e.config&&(i=e.config.singleVisual)&&(r.visitSingleVisualConfig(i),(a=i.query)&&r.visitQuery(a),a=function(e,t){t&&r.visitDataViewObjects(e,t),C(e,r)},(n=i.objects)&&(o=void 0,a(n,o=(n=f.VisualContainerUtils.getVisualCapabilities(e,t))?n.objects:o)),(t=i.vcObjects)&&(a(t,o=s.contracts.VisualContainer.CommonObjectDescriptors),(n=i.vcObjects.visualLink)&&r.visitVisualLinks(n))),P(e.filters,r)}function P(e,t){if(!_.isEmpty(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];null!=a&&t.visitFilterContainer(a)}}function y(e,t){if(e){var r=e.nameIdentifiedMerges,r=(_.forOwn(r,(function(e){t.visitFilterContainer(e)})),e.exprIdentifiedMerges);if(!_.isEmpty(r))for(var i=0,a=r;i<a.length;i++){var o=a[i];t.visitFilterContainer(o)}}}function C(e,a){_.forOwn(e,(function(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t].selector;i&&a.visitSelector(i)}}))}s=e.explore||(e.explore={}),f=s.util||(s.util={}),E=e.explore.contracts.BookmarkExtensions,f.traverseExploration=function(e,t,r){t.visitExploration(e),P(e.filters,t);var i=e.bookmarks;if(!_.isEmpty(i))for(var a=0,o=i;a<o.length;a++)!(function e(t,r,i,a){a.visitBookmark(t);if(E.isBookmarkGroup(t))for(var o=0,n=t.children;o<n.length;o++){var s=n[o];e(s,r,i,a)}else N(t.explorationState,r,i,a.explorationStateVisitor)})(o[a],e.sections,r,t);if(i=e.sections,!_.isEmpty(i))for(var n=0,s=i;n<s.length;n++){var l=s[n],p=(y=f=h=c=u=p=void 0,l),u=t,c=r,l=(u.visitSection(p),P(p.filters,u),g=v=m=d=l=void 0,p.linkFields),d=u;if(!_.isEmpty(l))for(var m=0,v=l;m<v.length;m++){var g=v[m];d.visitLinkField(g)}var h=p.visualContainers;if(!_.isEmpty(h))for(var f=0,y=h.length;f<y;f++)V(h[f],u.visualContainerVisitor,c)}var i=e.pods,C=t;if(!_.isEmpty(i))for(var x=0,S=i;x<S.length;x++){var b=S[x];C.visitPod(b)}},f.traverseExplorationState=N,f.traverseVisualContainer=V})(powerbi=powerbi||{}),(function(e){!(function(e){var a=e.util||(e.util={}),e=(t.prototype.visitVisualContainer=function(e){},t.prototype.visitSingleVisualConfig=function(e){},t.prototype.visitQuery=function(e){},t.prototype.visitDataViewObjects=function(e,t){},t.prototype.visitSelector=function(e){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitVisualLinks=function(e){},t);function t(){}a.DefaultVisualContainerVisitor=e,__extends(i,r=e),i.prototype.visitSingleVisualConfig=function(e){e.cachedFilterDisplayItems&&a.rewriteDisplayNameIdentityPairs(e.cachedFilterDisplayItems,this.rewriters)},i.prototype.visitQuery=function(e){if(e.defn)for(var t=0,r=this.rewriters;t<r.length;t++)e=r[t].rewriteQuery(e)},i.prototype.visitDataViewObjects=function(e,t){a.rewriteFilterOutput(e,t,this.rewriters),a.rewriteDataBoundPropertyDefinitions(e,t,this.rewriters)},i.prototype.visitFilterContainer=function(e){a.rewriteFilterContainer(e,this.rewriters)},i.prototype.visitVisualLinks=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];a.rewriteVisualLink(i,this.rewriters)}},i.prototype.visitSelector=function(e){var t=a.rewriteDataRepetitionSelectors(e.data,this.rewriters);t!==e.data&&(e.data=t)};var r,e=i;function i(e){var t=r.call(this)||this;return t.rewriters=e,t}a.VisualContainerRewriter=i})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(e){!(function(e){var a=e.util||(e.util={}),i=jsCommon.DictionaryExtensions,e=(t.prototype.visitActiveProjectionStates=function(e){},t.prototype.visitDataViewObjectDefinitionUpdates=function(e,t){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitOrderByStates=function(e){},t.prototype.visitSelector=function(e){},t.prototype.visitSelectorsByColumn=function(e){},t.prototype.visitSingleVisualState=function(e){},t.prototype.visitVisualContainerState=function(e){},t.prototype.visitFilterExpressionMetadata=function(e){},t);function t(){}a.DefaultVisualContainerStateVisitor=e,__extends(o,r=e),o.prototype.visitActiveProjectionStates=function(r){var i=this;_.forOwn(r,(function(e,t){e=e.map((function(e){return a.rewriteExpr(e,i.rewriters)}));r[t]=e}))},o.prototype.visitFilterContainer=function(e){a.rewriteFilterContainerState(e,this.rewriters)},o.prototype.visitDataViewObjectDefinitionUpdates=function(e,t){e=e.merge;e&&(a.rewriteFilterOutput(e,t,this.rewriters),a.rewriteDataBoundPropertyDefinitions(e,t,this.rewriters))},o.prototype.visitOrderByStates=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];i.expr=a.rewriteExpr(i.expr,this.rewriters)}},o.prototype.visitSelector=function(e){var t=a.rewriteDataRepetitionSelectors(e.data,this.rewriters);t!==e.data&&(e.data=t)},o.prototype.visitSelectorsByColumn=function(e){var r=this,t=i.rewriteDictionary(e.dataMap,(function(e,t){return a.rewriteDataRepetitionSelectors(t,r.rewriters)}));t!==e.dataMap&&(e.dataMap=t)},o.prototype.visitFilterExpressionMetadata=function(e){a.rewriteFilterExpressionMetadata(e,this.rewriters)};var r,e=o;function o(e){var t=r.call(this)||this;return t.rewriters=e,t}a.VisualContainerStateRewriter=o})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).util||(e.util={})).VisualPerformanceActivityUtil||(e.VisualPerformanceActivityUtil={})).updateParentWithNewLinkingActivity=function(e,t,r){if(e&&e.getProperty("telemetryActivityId")){var i=r.getOpenActivityById(e&&e.getProperty("telemetryActivityId"));if(i&&i.isActive(),i&&i.isActive())return r=r.startChildActivity(i.event,t),e.setProperty("telemetryActivityId",r.event.id),r}}})(powerbi=powerbi||{}),(function(e){function p(e,t){var r={},i=e.defn.select();if(i)for(var a in e.projections){var o=e.projections[a];if(o){r[a]=[];for(var n=o.all(),s=0;s<n.length;s++){var l=o.convertProjectionIndexToFieldIndex(s);o.doesParameterExist(l)||t?r[a].push(i.withName(n[s].queryRef).expr):r[a].push(null)}}}return r}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).PresentationUtils||(e.PresentationUtils={})).explorationToPresentationState=function(e){for(var t={},r=0,i=e.sections;r<i.length;r++){var a=i[r];t[a.name]={};for(var o=0,n=a.visualContainers;o<n.length;o++){var s,l=n[o];l.config.singleVisual&&(s=l.config.singleVisual,t[a.name][l.name]={visualType:s.visualType,autoSelectVisualType:s.autoSelectVisualType,projections:s.query?p(s.query,!0):void 0})}}return t},e.captureProjections=p,e.captureParameters=function(e){var t;if(e.defn.select())for(var r in e.projections){var i=e.projections[r];if(i){i=_.sortBy(i.getFieldParameters(),(function(e){return e.index}));if(!_.isEmpty(i)){(t=t||{})[r]=[];for(var a=0,o=i;a<o.length;a++){var n=o[a],s=n.expr,l=n.index,n=n.length;t[r].push({expr:s,index:l,length:n})}}}}return t}})(powerbi=powerbi||{}),(function(e){(function(e){function t(e){this.container=e,this.context={pendingGeocodingCount:0}}t.prototype.newQuery=function(e){var t=0!==this.context.pendingGeocodingCount,r=this.context.geocodingActivity;this.context={pendingGeocodingCount:0,rootActivity:e},t&&(r&&r.reject(),this.container.onStopGeocoding())},t.prototype.hasPendingGeocoding=function(){return 0<this.context.pendingGeocodingCount},t.prototype.wrapGeocoder=function(n){return{geocode:this.wrapAsyncGeocoderMethod(n,n.geocode),geocodeBoundary:this.wrapAsyncGeocoderMethod(n,n.geocodeBoundary),geocodePoint:this.wrapAsyncGeocoderMethod(n,n.geocodePoint),tryGeocodeImmediate:function(e){return n.tryGeocodeImmediate(e)},tryGeocodeBoundaryImmediate:function(e,t,r,i,a,o){return n.tryGeocodeBoundaryImmediate(e,t,r,i,a,o)}}},t.prototype.wrapAsyncGeocoderMethod=function(o,n){var s=this;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];function r(){i===s.context&&--i.pendingGeocodingCount<=0&&(i.pendingGeocodingCount,s.context.geocodingActivity&&s.context.geocodingActivity.resolve(),s.container.onStopGeocoding())}var i=s.context,a=n.apply(o,e);1==++i.pendingGeocodingCount&&(s.context.rootActivity&&(s.context.geocodingActivity=s.context.rootActivity.createChildActivity({name:"Geocoding"})),s.container.onStartGeocoding());return a.then(r,r),a}},e.QueryGeocodingTracker=t})((e=e.explore||(e.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(e){(function(e){function t(e,t){this.explorationStateVisitor=e,this.visualContainerVisitor=t}t.prototype.visitBookmark=function(e){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitExploration=function(e){},t.prototype.visitSection=function(e){},t.prototype.visitLinkField=function(e){},t.prototype.visitPod=function(e){},e.DefaultExplorationVisitor=t})((e=e.explore||(e.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(e){!(function(e){var t=e.util||(e.util={}),e=(r.prototype.visitFilterContainer=function(e){},r.prototype.visitSectionState=function(e){},r);function r(e){this.visualContainerStateVisitor=e}t.DefaultExplorationStateVisitor=e,__extends(a,i=e),a.prototype.visitFilterContainer=function(e){t.rewriteFilterContainerState(e,this.rewriters)};var i,e=a;function a(e,t){t=i.call(this,t)||this;return t.rewriters=e,t}t.ExplorationStateRewriter=a})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(E){!(function(l){var o=E.common.utils.ColorUtility,i=E.visualHost.CustomVisualsFilterPropertyIdentifier,n=E.data.DataViewObjectDefinitions,a=E.data.DataViewObjectDescriptors,p=E.data.FieldExprPattern,u=E.data.FilterKindDetector,s=l.contracts.FilterType,c=E.common.utils.IdUtility,d=E.data.ScopeIdentityExtractor.ScopeIdKeysAndValuesExtractorImpl,m=E.data.SemanticFilter,v=E.data.services.SemanticQuerySerializer,g=E.data.SQExpr,h=E.data.SQExprConverter,f=E.data.SQExprUtils,r=E.visuals.valueFormatter;function e(){}e.getFormatter=function(e,t){e=e.getMetadata(t);if(e)return t=e.format,r.create({format:t,allowFormatBeautification:!0})},e.getDefaultFilterType=function(e,t,r,i){t=e.getMetadata(t);if(t){if(5===r)return l.contracts.FilterType.Categorical;r=t.type,r=r&&(r.text||r.bool||r.dateTime),t=t.idOnEntityKey&&i&&g.equals(e,i);return!r||f.isMeasure(e)||t?l.contracts.FilterType.Advanced:l.contracts.FilterType.Categorical}},e.getFilterType=function(e,t){return f.isMeasure(e)||!t?l.contracts.FilterType.Advanced:l.contracts.FilterType.Categorical},e.canAdd=function(e,t,r,i,a,o){if(!t||!r)return!1;if(!this.supportsMeasureFilters(e,o)&&f.isMeasure(t))return!1;e=h.asFieldPattern(t,r),t=p.toFieldExprEntityItemPattern(e),r=r.schema(t.schema);if(!r)return!1;var n,s=r.findProperty(t.entity,p.getPropertyName(e));if(s||(e.hierarchyLevel?(l=r.findHierarchy(t.entity,e.hierarchyLevel.name))&&(n=l.levels.withName(e.hierarchyLevel.level)):e.columnHierarchyLevelVariation&&(l=r.findHierarchy(e.columnHierarchyLevelVariation.level.entity,e.columnHierarchyLevelVariation.level.name))&&(n=l.levels.withName(e.columnHierarchyLevelVariation.level.level))),!s&&!n||!i||!i.container)return!1;if(s&&1===s.kind&&(0!==i.scopeType||r.capabilities.limitMultiColumnFiltersToQueryGroupColumns)&&!a)return!1;if(a){t=s&&s.kind;if(!(!!n||0===t||1===t))return!1;var l=!1;if(1!==i.scopeType||(e=i.container)&&!e.transient&&(l=!0),!l)return!1}if(0===i.scopeType){r=i.container;if(!r||!this.supportsVisualFilters(r,o))return!1}return!0},e.supportsVisualFilters=function(e,t){e=l.util.VisualContainerUtils.getVisualType(e);return t.isQueryVisual(e)},e.supportsFilterOutput=function(e){return null!=this.tryGetFilterPropertyIdentifier(e,null,null)},e.tryGetFilterPropertyIdentifier=function(e,t,r){return t&&r&&r.isCustomVisual(t)?i:e?a.findFilterOutput(e.objects):void 0},e.tryGetFilterProperty=function(e,t,r,i){e=this.tryGetFilterPropertyIdentifier(e,t,r);if(e)return n.getValue(i,e,void 0)},e.add=function(e,t){e.filters||(e.filters=[]),e.filters.push(t)},e.getFiltersContainer=function(e,t,r){switch(e){case 0:return l.services.selectionUtils.getSelectedVisual(t);case 1:return r.getCurrentSection();case 2:return r.getCurrentExploration()}},e.convertFilterData=function(e,t,r){if(e){t={filter:e.filter,name:this.getNextFilterName(t),type:e.type,restatement:e.restatement,howCreated:r};if(e.type===l.contracts.FilterType.Categorical||e.filterExpressionMetadata&&1===e.filterExpressionMetadata.expressions.length){t.expression=e.filterExpressionMetadata.expressions[0];var i=[];if(!_.isEmpty(e.filterExpressionMetadata.cachedValueItems)){for(var a=0,o=e.filterExpressionMetadata.cachedValueItems;a<o.length;a++){var n=o[a];1===n.identities.length&&i.push({identity:n.identities[0],displayName:n.valueMap[0]})}t.cachedValueItems=i}}else e.filterExpressionMetadata&&(t.filterExpressionMetadata=e.filterExpressionMetadata);return t}},e.shouldDisableFilter=function(e,t,r,i,a){if(r){var o=e.expression;if(o){var n=E.data.SQExprUtils.isMeasure(o),e=!_.isEmpty(this.validate(e,t,i)),i=l.util.VisualContainerUtils.hasGrouping(r,t);if(n){if(!i&&!e)return!0;n=o.getTargetEntity();if(!n)return!0;i=n.schema;if(t.schema(i).capabilities.limitMultiColumnFiltersToQueryGroupColumns)return!0;if(l.util.VisualContainerUtils.hasFilterMappingWithNonAggregatableColumns(r,t,a))return!0;if(l.util.VisualContainerUtils.hasGroupByItemsInQuery(r))return!0}}}return!1},e.getValueType=function(e,t){e=e.getMetadata(t);if(e)return e.type},e.getDefaultRetainedValue=function(e,t){t=E.data.SQExprUtils.getDefaultValues(e,t);if(!_.isEmpty(t))return{isNot:!1,scopeIds:[[E.data.createDataViewScopeIdentity(E.data.SQExprUtils.getDataViewScopeIdentityComparisonExpr(e,t))]]}},e.validate=function(e,t,r){var i=e.expression,e=e.filter,i=f.validate(i,t,r);if(e&&(i=e.validate(t,r,i)),!_.isEmpty(i))return i},e.getNextFilterName=function(e){for(var t={},r=0,i=e=null==e?[]:e;r<i.length;r++){var a=i[r];null!=a&&(t[a.name]=!0)}return c.generateUniqueId(t,"Filter")},e.isCategoricalFilter=function(e){return e===l.contracts.FilterType.Categorical||e===l.contracts.FilterType.Visual},e.getQueryRefsForSingleItemDrillFilters=function(e,t,r){var i=e.filters,a=[];if(i)for(var o=0,n=i;o<n.length;o++){var s=n[o],l=s&&s.filter;l&&_.isEmpty(l.validate(t,r))&&2===s.howCreated&&this.areDrillFiltersSingleValue(l.where())&&(l=this.getQueryRefFromFilter(e,s.expression))&&a.push(l)}return a},e.areDrillFiltersSingleValue=function(e){return!_.isEmpty(e)&&_.every(e,(function(e){if(null==e)return!1;e=e.condition;return g.isIn(e)?e.values&&1===e.values.length:!!g.isCompareRef(e)&&0===e.comparison}))},e.getQueryRefFromFilter=function(e,t){e=l.util.VisualContainerUtils.getVisualQuery(e);if(e)return e.defn.selectNameOf(t)},e.getFilterValuesForColumn=function(e,t){if(t)return t=t.condition,e=new S(e),t.accept(e),e.values},e.deriveFromSQFilters=function(e,t,r){var i=[],a=r&&r.Filters&&0!==r.Filters.length?r.Filters:null;a&&a.length!==t.length&&(a=null);for(var o=0,n=t.length;o<n;o++){var s=t[o],l=a&&a[o],p=l&&l.expression&&v.deserializeExpr(l.expression);i.push({name:this.getNextFilterName(i),filter:new E.data.SemanticFilter(e,[s]),restatement:l&&l.Restatement,expression:p,howCreated:0,type:l&&l.type})}return i},e.extractParameterFilters=function(e,t){var r=_.filter(e.From,(function(e){return 1!==e.Type})),r={Version:e.Version,From:r,Where:e.Where},i={RemovedIndexes:[]},e=v.deserializeFilter(r,i);if(t&&!_.isEmpty(i.RemovedIndexes)&&(t.Filters=_.filter(t.Filters,(function(e,t){return!_.includes(i.RemovedIndexes,t)}))),e)return this.deriveFromSQFilters(e.from(),e.where(),t)},e.mergeExplorationSectionFilters=function(e,t){_.isEmpty(e.filters)||(t.filters=this.mergeFilters(t.filters,e.filters,"explore"),e.filters=[])},e.isFilterModified=function(e){var t=!0===e.isHiddenInViewMode,r=!0===e.isLockedInViewMode,i=!!e.displayName,a=void 0!==e.ordinal,t=t||r||i||a;return!!e.filter||!n.isEmpty(e.objects)||t},e.ensureFilterHasName=function(e,t){null==e.name&&this.isFilterModified(e)&&(e.name=this.getNextFilterName(t.container&&t.container.filters))},e.applySectionParameterFilters=function(e,t,r,i,a){if(e.filters=this.getSectionParameterFiltersToApply(t,e.filters,r,i),a=_.isEmpty(i)&&_.isEmpty(r)?a:!0)for(var o=0,n=e.visualContainers;o<n.length;o++)n[o].cachedData=null},e.getFiltersToApplyFromVisualQueryFilterContext=function(e){if(e){for(var t=e.dataFilters?e.dataFilters.slice():[],r=[],i=[],a=0,o=t=e.highlightFiltersUnmerged?t.concat(e.highlightFiltersUnmerged):t;a<o.length;a++){var n=o[a],s=n.filter.where();if(!_.isEmpty(s)){var l=_.filter(s,(function(e){return 1===u.runDetector(e.condition)}));if(i.push.apply(i,l||[]),!_.isEmpty(l)){l=_.filter(s,(function(e){return 1!==u.runDetector(e.condition)}));if(_.isEmpty(l))continue;n={filter:m.fromSQFromAndSQFilters(n.filter.from(),l)}}r.push(n)}}return _.isEmpty(i)||(t=m.fromMeasureFilters(e.query,i))&&r.push({filter:t}),r}},e.findValuesInFilterCache=function(e,t,r){if(e.length,t.length,r&&!_.isEmpty(r.cachedValueItems)){var i=this.findIdentityMapInFilterCache(e,t,r);if(i){var a,o=[],n=[];for(a in i.valueMap)o.push(i.valueMap[a]),n.push(r.expressions[a]);return{values:o,columns:n}}}},e.removeEntryFromFilterCache=function(e,t,r){var i;e.length,t.length,r&&!_.isEmpty(r.cachedValueItems)&&(i=this.findIdentityMapInFilterCache(e,t,r))&&_.remove(r.cachedValueItems,(function(e){return e===i}))},e.findIdentityMapInFilterCache=function(r,i,e){if(r.length,i.length,e&&!_.isEmpty(e.cachedValueItems))for(var t=0,a=e.cachedValueItems;t<a.length;t++){for(var o=a[t],n=new d,s=0,l=o.identities;s<l.length;s++)l[s].expr.accept(n);if(n.keys.length===r.length){for(var p=!0,u=0;u<n.keys.length;u++)if("break"===(function(e){var t=n.keys[e];if(_.findIndex(r,(function(e){return g.equals(e,t)}))<0||i[e].value!==n.values[e].value)return p=!1,"break"})(u))break;if(p)return o}}},e.getSectionParameterFiltersToApply=function(e,t,r,i){t=__spreadArray([],t||[]);return _.isEmpty(i)||e&&!_.isEmpty(e.parameters)&&_.remove(t,(function(t){return _.some(e.parameters,(function(e){return e.boundFilter===t.name}))})),_.isEmpty(i)&&_.isEmpty(r)?t:(i=this.getUnOverriddenAndMergedFilters(i,r),this.getUnOverriddenAndMergedFilters(i,t))},e.getUnOverriddenAndMergedFilters=function(e,t){if(_.isEmpty(e))return t;if(_.isEmpty(t))return e;t=this.getNonoverriddenFilters(e,t);return this.mergeFilters(t||[],e||[],"param")},e.getNonoverriddenFilters=function(e,t){var r=this;if(_.isEmpty(e)||_.isEmpty(t))return t;var i=this.extractAllReferencedFields(e);return _.filter(t,(function(e){e=r.extractReferencedFields(e);return!_.some(e,(function(t){return _.some(i,(function(e){return g.equals(e,t,!1,!0)}))}))}))},e.extractParameterFiltersFromSection=function(e,t){e=e||[];for(var r={},i=[],a=0,o=t=t||[];a<o.length;a++)r[(l=o[a]).name]=l;for(var n=0,s=e;n<s.length;n++){var l,p=r[(l=s[n]).name];p&&_.isEqual(p,l)||i.push(l)}return i},e.mergeFilters=function(e,t,r){for(var i={},a=0,o=e=e||[];a<o.length;a++)i[(n=o[a]).name]=!0;for(var n,s=0,l=t;s<l.length;s++)(n=l[s]).name=r+"_"+n.name,i[n.name]?n.name:i[n.name]=!0;return e.concat(t)},e.canExpandManually=function(e,t,r,i){return 6!==e&&(!(5===e&&!t&&g.isMeasure(r))&&!!i)},e.hasMeasureOrAsAggregationLinkField=function(e){return _.some(e.filters,(function(e){return 5===e.howCreated&&!e.isTransient&&(e.isLinkedAsAggregation||e.expression&&g.isMeasure(e.expression))}))},e.notifyFilterContainerChangedByUser=function(e,t){e.publishToChannel(l.services.events.userActionTriggered,{source:"UserAction_ChangeFilter"}),e.publishToChannel(l.services.events.filterContainerChanged,t)},e.createChangeFilterActivity=function(e,t){return e.createActivity({name:"Change Filter",operationType:t})},e.notifyBufferedFilterChanges=function(e,t,r,i,a,o){e.publishToChannel(l.services.events.applyAllBufferedFilterCardChanged,{filterScopeType:t,filterType:r,id:i,canApply:a,wasDeleted:o})},e.isApplyAllEnabled=function(e,t){t=t.getCurrentExploration();return!!(e&&t&&t.slowDataSourceSettings)&&t.slowDataSourceSettings.isApplyAllButtonEnabled},e.getFilterCardStyle=function(e,t,r,i){var a,o,n=e&&e.filterCard,n=t?(a=n&&n.$instances&&n.$instances[l.constants.ExploreCanvasConstants.Applied],o=r.colorPalette.backgroundLight.value,l.constants.ExploreCanvasConstants.DefaultAppliedFilterCardTransparency):(a=n&&n.$instances&&n.$instances[l.constants.ExploreCanvasConstants.Available],o=r.colorPalette.background.value,l.constants.ExploreCanvasConstants.DefaultAvailableFilterCardTransparency),s=null!=(s=null==i?void 0:i.defaultStyleOverride)?s:{checkboxAndApplyColor:l.constants.ExploreCanvasConstants.DefaultOutspacePaneCheckboxAndApplyColor,borderColor:l.constants.ExploreCanvasConstants.DefaultFilterCardBorderColor,backgroundColor:o,foregroundColor:r.colorPalette.foreground.value,inputBoxBorderColor:l.constants.ExploreCanvasConstants.DefaultFilterCardBorderColor,inputBoxBackgroundColor:l.constants.ExploreCanvasConstants.DefaultControlBackgroundColor,inputBoxForegroundColor:l.constants.ExploreCanvasConstants.DefaultControlForegroundColor,fontSize:this.getFontSize(a),fontFamily:this.getFontFamily(a)};return{checkboxAndApplyColor:this.getCheckboxAndApplyColor(e&&e.outspacePane,s.checkboxAndApplyColor),borderColor:this.getBorderColor(a,s.borderColor,null==i?void 0:i.alwaysEnableBorder),backgroundColor:this.getBackgroundColor(a,s.backgroundColor,n,t,s.backgroundColorApplied),foregroundColor:this.getColor(a,"foregroundColor",s.foregroundColor),inputBoxBorderColor:this.getBorderColor(a,s.inputBoxBorderColor,!0),inputBoxBackgroundColor:this.getColor(a,"inputBoxColor",s.inputBoxBackgroundColor),inputBoxForegroundColor:this.getColor(a,"foregroundColor",s.inputBoxForegroundColor),fontSize:null!=i&&i.ignoreFontSizeAndFamily?null:s.fontSize,fontFamily:null!=i&&i.ignoreFontSizeAndFamily?null:s.fontFamily}},e.determineIsLinkedAsAggregation=function(e,t,r){if(5===e.howCreated)return null!=r.defaultAggregate(e.expression,t)},e.getDisplayNameForIncludeExcludeFilters=function(e,t,r){return(t===s.Include?e.get("Include_Label"):e.get("FilterPane_Exclude"))+" ("+r+")"},e.getCheckboxAndApplyColor=function(e,t){void 0===t&&(t=l.constants.ExploreCanvasConstants.DefaultOutspacePaneCheckboxAndApplyColor);e=E.DataViewObject.getFillColorByPropertyName(e,"checkboxAndApplyColor",t);return o.hexToRGBString(e)},e.getBorderColor=function(e,t,r){t=E.DataViewObject.getFillColorByPropertyName(e,"borderColor",t),e=!0===E.DataViewObject.getValue(e,"border",l.constants.ExploreCanvasConstants.DefaultFilterCardBorder)||r?1:0;return o.hexToRGBString(t,e)},e.getBackgroundColor=function(e,t,r,i,a){i=E.DataViewObject.getFillColorByPropertyName(e,"backgroundColor",i&&a?a:t),a=o.convertTransparencyToOpacity(E.DataViewObject.getValue(e,"transparency",r));return o.hexToRGBString(i,a)},e.getColor=function(e,t,r){e=E.DataViewObject.getFillColorByPropertyName(e,t,r);return o.hexToRGBString(e)},e.getFontSize=function(e){return E.DataViewObject.getValue(e,"textSize",l.constants.ExploreCanvasConstants.DefaultFilterCardTextSizePt)+"pt"},e.getFontFamily=function(e){return E.DataViewObject.getValue(e,"fontFamily",l.constants.ExploreCanvasConstants.DefaultOutspacePaneFontFamily)},e.extractAllReferencedFields=function(e){var t=this;return _.flatten(_.map(e,(function(e){return t.extractReferencedFields(e)})))},e.extractReferencedFields=function(e){var t=[];if(e.expression&&t.push(e.expression),e.filter)for(var r=0,i=e.filter.conditions();r<i.length;r++){var a=i[r],o=new y;a.accept(o),t=t.concat(o.fields)}return t},e.supportsMeasureFilters=function(e,t){e=l.util.VisualContainerUtils.getVisualType(e);return!t.isAnalysisVisual(e)},e.getFilterCapabilities=function(e){return{canClear:this.canClearManually(e),canDelete:this.canDeleteManually(e),canEdit:this.canEditManually(e),canHide:this.canHideManually(e),canLock:this.canLockManually(e),canRename:this.canRenameManually(e),canSort:this.canSortManually(e)}},e.canClearManually=function(e){var t=5===e.howCreated&&(e.type===s.Exclude||e.type===s.Include);return(0===e.howCreated||1===e.howCreated||2===e.howCreated||5===e.howCreated||7===e.howCreated)&&e.type!==s.Passthrough&&!t},e.canDeleteManually=function(e){return 1===e.howCreated||5===e.howCreated||7===e.howCreated||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},e.canEditManually=function(e){return(0===e.howCreated||1===e.howCreated||2===e.howCreated||5===e.howCreated||7===e.howCreated||3===e.howCreated||4===e.howCreated)&&e.type!==s.Passthrough},e.canHideManually=function(e){return 0===e.howCreated||1===e.howCreated||5===e.howCreated&&!e.isTransient||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},e.canLockManually=function(e){return(0===e.howCreated||1===e.howCreated||5===e.howCreated&&!e.isTransient||3===e.howCreated||4===e.howCreated)&&e.type!==s.Passthrough},e.canRenameManually=function(e){return(0===e.howCreated||1===e.howCreated)&&e.type!==s.Passthrough},e.canSortManually=function(e){return 0===e.howCreated||1===e.howCreated||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},l.FilterUtils=e;t=E.data.DefaultSQExprVisitorWithTraversal,__extends(C,t),C.prototype.visitColumnRef=function(e){this.fields.push(e)},C.prototype.visitHierarchyLevel=function(e){this.fields.push(e)},C.prototype.visitMeasureRef=function(e){this.fields.push(e)},C.prototype.visitEntity=function(e){this.fields.push(e)},C.prototype.visitAggr=function(){};var t,y=C;function C(){var e=null!==t&&t.apply(this,arguments)||this;return e.fields=[],e}x=E.data.DefaultSQExprVisitor,__extends(b,x),b.prototype.visitCompare=function(e){0===e.comparison&&g.isConstant(e.right)&&g.equals(e.left,this.comparisonColumn)&&this.values.push(e.right)},b.prototype.visitIn=function(e){var t=this;if(!_.isEmpty(e.values)){var r=e.args,i=_.findIndex(r,(function(e){return g.equals(e,t.comparisonColumn,void 0,!0)}));if(!(i<0))for(var a=0,o=e.values;a<o.length;a++){var n=o[a];this.values.push(n[i])}}};var x,S=b;function b(e){var t=x.call(this)||this;return t.comparisonColumn=e,t.values=[],t}})(E.explore||(E.explore={}))})(powerbi=powerbi||{}),(function(n){var e,m,s,i,v,g;function t(e,t){return e.displayName.localeCompare(t.displayName,void 0,{sensitivity:"base"})}e=(e=n.explore||(n.explore={})).util||(e.util={}),m=n.data.SQExpr,s=n.data.SQExprBuilder,i=n.data.SQExprConverter,v=n.data.SQExprGroupUtils,g=n.data.SQHierarchyExprUtils,(e=e.HierarchyUtils||(e.HierarchyUtils={})).getOptionsToAddHierarchyLevelToExistingHierarchies=function(s,e,l,t){if(l&&e&&m.isHierarchyLevel(t)){for(var p=t,u=p.arg,c=g.expandExpr(s,u),d=[],r=0,i=e.dataRoles;r<i.length;r++)!(function(e){var t=l.tryGetExprs(e.name);if(!t)return;for(var r,i=0,a=m.isHierarchy(u)&&m.isPropertyVariationSource(u.arg)?(r=u.arg,_(v.groupExprs(s,t,{})).filter((function(e){return e.isHierarchyLevelsGroup&&m.isColumn(e.expr)&&m.equals(e.expr.source,r.arg)&&e.expr.ref===r.property})).reverse().value()):_(v.groupExprs(s,t,{})).filter((function(e){return m.equals(e.expr,u)})).reverse().value();i<a.length;i++){var o=a[i],n=g.getInsertionIndex(c,o.children,p);d.push({expr:p,schema:s,targetRole:e.name,projOptions:{fieldIndex:o.selectQueryIndex+n}})}})(i[r]);return d}},e.getHierarchyReplacementExpressions=function(e,t,r,i,a,o){if(e=(e.singleVisual.query.tryGetExprs(t)||[]).slice(r,r+i),!_.isEmpty(e)){t=(_.isEmpty(o)?e:o)[0];if(m.isHierarchyLevel(t)){r=(function(e,t){if(e&&e.kind===n.VisualDataRoleKind.Measure){e=g.getHierarchySourceAsVariationSource(t);if(e)return s.columnRef(e.arg,e.property)}})(a,t);if(r)return[r]}return _.isEmpty(o)?e:o}},e.hierarchyLevelComparer=function(e,t){return m.isHierarchyLevel(e)&&m.isHierarchyLevel(t)&&m.equals(e.arg,t.arg)},e.findHierarchyLevelIndex=function(e,t){var r=i.asFieldPattern(t).hierarchyLevel;if(r)return(t=e.findHierarchy(r.entity,r.name))?_.findIndex(t.levels,(function(e){return e.name===r.level})):void 0},e.sortHierarchies=function(e){_.isEmpty(e)||e.sort(t)}})(powerbi=powerbi||{}),(function(t){var e;(function(e){var f=t.data.DataViewMatrixUtils,p=t.data.DataViewSelectTransform,y=t.visuals.matrixRoleNames,o=t.data.SQExprUtils;function c(){}c.generate=function(e,t,r,i,a,o){if(e.matrix){for(var n=[],s=[],l=[],p=[],u=e.matrix,c=0,d=t;c<d.length;c++){var m=d[c],m=__assign({},m);m.roles={},n.push(m)}var v=function(e){if(o&&o.featureSwitches.showGeneratedColumnsInDetailView)return!0;e=t[e.index];return!e||!_.isEmpty(e.roles)||!_.isEmpty(e.relatedSelects)},g=null==o?void 0:o.featureSwitches.comboMultiples,r=this.getSelectsGroupedByRowHierarchy(r,t,e.matrix,v),h=this.tryProcessDataViewHierarchy(u.rows,n,s,y.rows,r)&&this.tryProcessDataViewHierarchy(u.columns,n,l,y.columns,r,(function(e){return!e.isMeasure}))&&this.tryUpdateReferencedSelects(u.valueSources,n,p,y.values,r,v);if(!g||(u=_.last(u.rows.levels))&&(h=h&&this.tryUpdateReferencedSelects(f.getScopedValueSources(u),n,p,y.values,r,v)),h)return u=e,this.sortMatrixRoleProjectionOrders(i,a,s,l,p,n),_.isEmpty(r)||(u=this.fixMeasuresGroupedByRowHierarchy(e,g,r)),v={},0<s.length&&(v[y.rows]=s),0<l.length&&(v[y.columns]=l),0<p.length&&(v[y.values]=p),{transformActions:{selects:n,roles:{ordering:v}},dataView:u}}},c.getSelectsGroupedByRowHierarchyFromMatrix=function(e,t){var r={},e=null==(e=null==e?void 0:e.rows)?void 0:e.levels;if(!_.isEmpty(e)){e=_.last(e),e=f.getScopedValueSources(e);if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var o=a[i];_.isNumber(o.index)&&t(o)&&(r[o.index]=!0)}}return r},c.tryProcessDataViewHierarchy=function(e,t,r,i,a,o){if(e&&!_.isEmpty(e.levels))for(var n=0,s=e.levels;n<s.length;n++){var l=s[n];if(!this.tryUpdateReferencedSelects(l.sources,t,r,i,a,o))return!1}return!0},c.tryUpdateReferencedSelects=function(i,a,o,n,s,l){if(!_.isEmpty(i))for(var e=function(r){if(!l||l(r)){if(null==r.index&&_.some(i,(function(e){return e.formatSource&&e.formatSource.formatString===r})))return"continue";if(s[r.index]){if(!_.isEmpty(a[r.index].relatedSelects))for(var e=0,t=a[r.index].relatedSelects;e<t.length;e++)!(function(t){var e=_.findIndex(a,(function(e){return e.queryName===t.queryName}));s[e]||o.push(r.index)})(t[e])}else o.push(r.index);if(!a[r.index])return{value:!1};a[r.index].roles[n]=!0}},t=0,r=i;t<r.length;t++){var p=e(r[t]);if("object"==typeof p)return p.value}return!0},c.sortMatrixRoleProjectionOrders=function(e,t,r,i,a,o){var n,s,l;!_.isEmpty(e)&&t&&(n=2<=r.length,s=2<=i.length,l=2<=a.length,(n||s||l)&&(e=this.createSelectIndexToSortOrderMappings(e,t))&&(n&&this.applySortOrder(r,e),s&&this.applySortOrder(i,e),l&&(this.applySortOrder(a,e),(t={})[y.values]=a,p.reorderDependentSelects(o,t))))},c.createSelectIndexToSortOrderMappings=function(e,t){e=_.chain(e).map((function(e){return t[e]})).flatten().filter((function(e){return _.isNumber(e)})).value(),e=_.reduce(e,(function(e,t,r){return void 0===e[t]&&(e[t]=r),e}),{});return 2<=Object.keys(e).length?e:void 0},c.applySortOrder=function(e,r){var i=this;e.sort((function(e,t){return i.getSortOrderOrDefault(e,r)-i.getSortOrderOrDefault(t,r)}))},c.getSortOrderOrDefault=function(e,t,r){return void 0===r&&(r=Number.MAX_VALUE),_.isNumber(t[e])?t[e]:r},c.fixMeasuresGroupedByRowHierarchy=function(e,t,r){e.matrix,e.matrix.columns;var i=e.matrix;if(this.nothingToFix(r,i))return e;i=_.cloneDeep(e);return t?this.addMeasureValuesGroupedByRowHierarchy(i,r):(e.categorical,this.removeMeasuresGroupedByRowHierarchy(i.matrix,r),this.addMeasureValuesGroupedByRowHierarchyLegacy(i,r)),i},c.nothingToFix=function(e,t){return _.isEmpty(Object.keys(e))||_.isEmpty(t.columns.root.children)||_.isEmpty(t.rows.root.children)},c.getSelectsGroupedByRowHierarchy=function(e,t,r,i){if(e&&1<e.length){(null==(a=e[0])?void 0:a.selects)&&null!=(a=e[1])&&a.selects;var a=this.categorizeSplitSelects(e[0],t);if(_.isEmpty(a.measureSelectIndices))return{};var o=this.categorizeSplitSelects(e[1],t);if(_.isEqual(a.groupingSelectIndices,o.groupingSelectIndices))return{};if(!_.isEmpty(o.measureSelectIndices))for(var n=_.map(_.keys(o.measureSelectIndices),(function(e){return t[parseInt(e,10)].queryName})),s=0;s<t.length;s++){var l=t[s];if(!_.isEmpty(l.relatedSelects))for(var p=0,u=l.relatedSelects;p<u.length;p++)!(function(t){null!=_.find(n,(function(e){return t.queryName===e}))&&(o.measureSelectIndices[s]=!0)})(u[p])}return o.measureSelectIndices}return c.getSelectsGroupedByRowHierarchyFromMatrix(r,i)},c.categorizeSplitSelects=function(e,t){var r,i={groupingSelectIndices:{},measureSelectIndices:{}};for(r in e.selects){var a=t[r];a.expr&&(o.isMeasure(a.expr)?i.measureSelectIndices[r]=!0:i.groupingSelectIndices[r]=!0)}return i},c.addMeasureValuesGroupedByRowHierarchy=function(e,t){e.matrix.columns.root.children;var r=e.matrix,i=r.columns.levels[0],o=[],a=_.last(r.rows.levels),n=r.valueSources.length,s=(a.valueSources,f.getScopedValueSources(a));if(s){for(var l=r.columns.root,p=this.getColumnLeavesCount(l),u=0;u<s.length;u++){var c=s[u];t[c.index]&&(c.formatSource&&delete c.formatSource,r.valueSources.push(c),this.addStaticMeasureColumnHeader(i,c,l),o.push(u))}f.forEachLeafNode(e.matrix.rows.root,(function(e){var t=p,r=f.getNodeScopedValues(e);if(!_.isEmpty(r))for(var i=0;i<o.length;i++){var a=o[i];e.values[t++]={value:r[a].value,valueSourceIndex:n+i}}}))}},c.addMeasureValuesGroupedByRowHierarchyLegacy=function(e,t){e.matrix.columns.root.children;for(var r=e.matrix,i=r.columns.root,a=this.getColumnLeavesCount(i),o=r.columns.levels[0],n=0,s=r.valueSources;n<s.length;n++){var l=s[n];t[l.index]&&this.addStaticMeasureColumnHeader(o,l,i)}var p=this.getValuesForMeasuresGroupedByRowHierarchy(e,t),u=0;f.forEachLeafNode(e.matrix.rows.root,(function(e){var t,r=a;for(t in p){var i=p[t];e.values[r]={value:i[u],valueSourceIndex:parseInt(t,10)},r++}u++}))},c.getColumnLeavesCount=function(e){var t=0;return f.forEachLeafNode(e,(function(){return t++})),t},c.addStaticMeasureColumnHeader=function(e,t,r){e.sources.push(t);t={level:0,levelSourceIndex:e.sources.length-1};r.children.push(t)},c.getValuesForMeasuresGroupedByRowHierarchy=function(r,i){for(var a={},e=0,t=r.categorical.values;e<t.length;e++)!(function(t){var e;t.source&&i[t.source.index]&&(t.identity,e=_.findIndex(r.matrix.valueSources,(function(e){return e.index===t.source.index})),a[e]=t.values)})(t[e]);return a},c.removeMeasuresGroupedByRowHierarchy=function(e,t){for(var r={},i=[],a=0;a<e.valueSources.length;a++){var o,n=e.valueSources[a];t[n.index]&&(r[a]=!0,i.push(n),n&&n.formatSource&&n.formatSource.formatString&&(o=n.formatSource.formatString,r[e.valueSources.indexOf(o)]=!0,i.push(o),delete n.formatSource))}this.removeColumnHeaders(e.columns,r),e.valueSources=this.adjustIntersections(e.rows,r,e.valueSources);var s=_.last(e.columns.levels);s.sources=s.sources.filter((function(t){return!_.find(i,(function(e){return e===t}))}))},c.removeColumnHeaders=function(e,t){for(var r=0,i=f.getLeafNodesPath(e.root);r<i.length;r++){var a=i[r],a=a[a.length-2];a.children=_.filter(a.children,(function(e){return!t[e.levelSourceIndex||0]})),a.children&&null!=a.level&&1===a.children.length&&delete a.children}},c.adjustIntersections=function(e,n,t){var r,s;if(!_.isEmpty(e.root.children))return r=t.filter((function(e,t){return e&&!n[t]})),s=r.length,r.push.apply(r,t.filter((function(e,t){return e&&null!=e.index&&n[t]}))),f.forEachLeafNode(e.root,(function(e){var t,r={},i=0;for(t in e.values){var a,o=e.values[t];n[o.valueSourceIndex||0]||(0==(a=i%s)?delete o.valueSourceIndex:o.valueSourceIndex=a,r[i]=o,i++)}e.values=r})),r},e.MatrixVisualDataViewConverter=c})((e=t.explore||(t.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(e){var c,t,r;function d(e,t){this.federatedConceptualSchema=e,this.localizationService=t,this.MaximumNameLength=512}e=(e=e.explore||(e.explore={})).util||(e.util={}),(t=c=e.NameValidationError||(e.NameValidationError={}))[t.None=0]="None",t[t.DuplicatedName=1]="DuplicatedName",t[t.EmptyName=2]="EmptyName",t[t.NameTooLong=3]="NameTooLong",e.createNameValidator=function(e,t){return new r(e,t)},d.prototype.validateMeasureName=function(e,t){if(!e||0===e.trim().length)return{error:c.EmptyName,reason:this.localizationService.get("NameValidationFailedEmptyName")};if(e.length>this.MaximumNameLength)return{error:c.NameTooLong,reason:this.localizationService.format("NameValidationFailedLongName",[e,this.MaximumNameLength])};e=d.normalizeModelItemName(e);return t&&d.normalizeModelItemName(t)===e?{error:c.None}:this.validateColumnAndMeasureNameUniqueness(e)},d.prototype.validateExistingMeasureName=function(r){var e=d.normalizeModelItemName(r.name);return this.validateColumnAndMeasureNameUniqueness(e,(function(e,t){return t!==r}))},d.prototype.makeValidMeasureName=function(e){var t=this;return this.makeValidName(e,(function(e){return t.validateMeasureName(e).error}))},d.prototype.makeValidName=function(e,t){t(e),c.EmptyName;var r,i=e;if((a=t(i))===c.DuplicatedName)r=2;else{if(a===c.None)return e;r=0}for(;;){i.length;var a,o=void 0;switch(a=t(o=r?i+" "+r:i)){case c.None:return o;case c.DuplicatedName:1===++r&&(r=2);continue;case c.NameTooLong:i=i.slice(0,Math.min(this.MaximumNameLength,i.length-1)),r=0;continue;default:throw new Error("MakeValidName encountered a problem it can't fix.")}}},d.prototype.validateColumnAndMeasureNameUniqueness=function(e,t){for(var r=0,i=this.federatedConceptualSchema.schemas;r<i.length;r++)for(var a=0,o=i[r].entities;a<o.length;a++)for(var n=o[a],s=0,l=n.properties;s<l.length;s++){var p,u=l[s];if(!t||t(n,u))if(d.normalizeModelItemName(u.name)===e)return p=u.measure?"NameValidationFailedCollisionMeasure":"NameValidationFailedCollisionColumn",{error:c.DuplicatedName,reason:this.localizationService.format(p,[u.name,n.name])}}return{error:c.None}},d.normalizeModelItemName=function(e){return jsCommon.StringExtensions.normalizeCase(e)},r=d})(powerbi=powerbi||{}),(function(e){var t,i,a,o,n,s;function r(e,t,r){e.capabilities,this.plugin=e,this.initialize(t,r)}function l(e,t,r,i){e=n.call(this,e,r,i)||this;return e.dataRoles=t,e}t=(t=e.explore||(e.explore={})).QueryProjectionBuilderCoreUtils||(t.QueryProjectionBuilderCoreUtils={}),i=e.data.QueryProjectionCollection,a=e.data.QueryProjectionsByRole,Object.defineProperty(r,"ValuesRoleName",{get:function(){return r.ValuesRole},enumerable:!1,configurable:!0}),r.getProjectionCollection=function(e,t){var r=a.getRole(e,t);return r||(e[t]=r=new i([])),r},r.addCategoryRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.CategoryRole).addProjection(t.projection)},r.addValuesRole=function(e,t){r.getProjectionCollection(e,r.ValuesRole).addProjection(t.projection)},r.addSeriesRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.SeriesRole).addProjection(t.projection)},r.addBreakdownRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.BreakdownRole).addProjection(t.projection)},r.addGroupRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.GroupRole).addProjection(t.projection)},r.addDetailsRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.DetailsRole).addProjection(t.projection)},r.addYRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.YRole).addProjection(t.projection)},r.addTargetValueRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.TargetValueRole).addProjection(t.projection)},r.addMinValueRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.MinValueRole).addProjection(t.projection)},r.addMaxValueRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.MaxValueRole).addProjection(t.projection)},r.addXRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.XRole).addProjection(t.projection)},r.addSizeRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.SizeRole).addProjection(t.projection)},r.addGradientRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.GradientRole).addProjection(t.projection)},r.addTooltipRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.TooltipRole).addProjection(t.projection)},r.addRowsRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.RowsRole).addProjection(t.projection)},r.addColumnsRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.ColumnsRole).addProjection(t.projection)},r.prototype.initialize=function(e,t){var r=e.select();this.projectionsInfo=[];for(var i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.push({projection:{queryRef:o.name},metadata:o.expr.getMetadata(t)})}},r.ValuesRole="Values",r.SeriesRole="Series",r.BreakdownRole="Breakdown",r.CategoryRole="Category",r.GroupRole="Group",r.DetailsRole="Details",r.YRole="Y",r.Y2Role="Y2",r.XRole="X",r.SizeRole="Size",r.GradientRole="Gradient",r.PlayRole="Play",r.RowsRole="Rows",r.ColumnsRole="Columns",r.MinValueRole="MinValue",r.MaxValueRole="MaxValue",r.TargetValueRole="TargetValue",r.TooltipRole="Tooltips",o=r,t.QueryProjectionBuilder=o,__extends(l,n=o),l.prototype.validatePlugin=function(){return!0},l.prototype.build=function(){for(var e={},t=0,r=this.dataRoles.length;t<r;t++){var i=this.dataRoles[t],a=this.projectionsInfo[i.Projection];a&&(o.getProjectionCollection(e,i.Name).addProjection(a.projection),i.isActive&&e[i.Name].addActiveQueryReference(a.projection.queryRef))}return e},s=l,t.DataRolesQueryProjectionBuilder=s,t.createProjectionBuilderFromDataRoles=function(e,t,r,i){return new s(e,t,r,i)}})(powerbi=powerbi||{}),(function(e){var t,r,i,a,o;t=(t=e.explore||(e.explore={})).utils||(t.utils={}),a=jsCommon.Lazy,o=e.visuals.plugins,t=t.visualUtil||(t.visualUtil={}),r=new a(function(){var e={};return e[3]=o.card,e[13]=o.lineClusteredColumnComboChart,e[29]=o.multiRowCard,e[7]=o.clusteredBarChart,e[10]=o.clusteredColumnChart,e[20]=o.donutChart,e[16]=o.funnel,e[30]=o.gauge,e[22]=o.heatMap,e[9]=o.hundredPercentStackedBarChart,e[12]=o.hundredPercentStackedColumnChart,e[4]=o.lineChart,e[1]=o.map,e[19]=o.filledMap,e[2]=o.pivotTable,e[5]=o.pieChart,e[6]=o.scatterChart,e[8]=o.barChart,e[11]=o.columnChart,e[0]=o.tableEx,e[17]=o.treemap,e[23]=o.waterfallChart,e[26]=o.stackedAreaChart,e[32]=o.areaChart,e[33]=o.ribbonChart,e[34]=o.kpi,e[35]=o.decompositionTreeVisual,e}),i=new a(function(){var e={};return e[o.card.name]=3,e[o.lineClusteredColumnComboChart.name]=13,e[o.multiRowCard.name]=29,e[o.clusteredBarChart.name]=7,e[o.clusteredColumnChart.name]=10,e[o.donutChart.name]=20,e[o.funnel.name]=16,e[o.gauge.name]=30,e[o.heatMap.name]=22,e[o.hundredPercentStackedBarChart.name]=9,e[o.hundredPercentStackedColumnChart.name]=12,e[o.lineChart.name]=4,e[o.map.name]=1,e[o.filledMap.name]=19,e[o.matrix.name]=2,e[o.pivotTable.name]=2,e[o.pieChart.name]=5,e[o.scatterChart.name]=6,e[o.barChart.name]=8,e[o.columnChart.name]=11,e[o.table.name]=0,e[o.tableEx.name]=0,e[o.treemap.name]=17,e[o.waterfallChart.name]=23,e[o.stackedAreaChart.name]=26,e[o.areaChart.name]=32,e[o.ribbonChart.name]=33,e[o.kpi.name]=34,e[o.decompositionTreeVisual.name]=35,e}),t.getPlugin=function(e){return r.getValue()[e]},t.getType=function(e){return i.getValue()[e]}})(powerbi=powerbi||{}),(function(o){var e,i,t,l,n,a,s,p,u,c,d,m,v,g,h,f,y,C,x,S,b,E,N;function r(e,t,r){return i.call(this,e,t,r)||this}function V(e,t,r){return a.call(this,e,t,r)||this}function _(e,t,r){return p.call(this,e,t,r)||this}function P(e,t,r){return c.call(this,e,t,r)||this}function w(e,t,r){return m.call(this,e,t,r)||this}function T(e,t,r){return g.call(this,e,t,r)||this}function F(e,t,r){return f.call(this,e,t,r)||this}function j(e,t,r){return C.call(this,e,t,r)||this}function R(e,t,r){return S.call(this,e,t,r)||this}function D(e,t,r){return E.call(this,e,t,r)||this}e=(e=o.explore||(o.explore={})).utils||(e.utils={}),t=o.visuals.plugins,l=o.explore.QueryProjectionBuilderCoreUtils.QueryProjectionBuilder,(e.QueryProjectionBuilderUtils||(e.QueryProjectionBuilderUtils={})).createProjectionBuilder=function(e,t,r){var i,a=o.explore.utils.visualUtil.getPlugin(e);if(null!=a){switch(e){case 3:case 29:case 0:i=new n(a,t,r);break;case 2:i=new N(a,t,r);break;case 20:case 16:case 4:case 26:case 32:case 5:i=new s(a,t,r);break;case 23:i=new u(a,t,r);break;case 7:case 10:case 9:case 12:case 8:case 11:case 33:case 13:i=new d(a,t,r);break;case 1:case 22:i=new y(a,t,r);break;case 19:i=new x(a,t,r);break;case 17:i=new b(a,t,r);break;case 6:i=new h(a,t,r);break;case 30:i=new v(a,t,r);break;default:return}return i}},__extends(r,i=l),r.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 1===e.length&&e[0].name===l.ValuesRole},r.prototype.build=function(e){var t={};if(1===this.projectionsInfo.length)return l.addValuesRole(t,this.projectionsInfo[0]),t;var e=e.Primary.Groupings,r=(e.length,e[0].Projections);r.length,this.projectionsInfo.length;for(var i=0,a=r.length;i<a;i++)l.addValuesRole(t,this.projectionsInfo[r[i]]);return t},n=r,__extends(V,a=l),V.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===t.funnel.name?4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.YRole&&e[2].name===l.GradientRole&&e[3].name===l.TooltipRole:this.plugin.name===t.lineChart.name?5===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.Y2Role&&e[4].name===l.TooltipRole:4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.TooltipRole},V.prototype.build=function(e){var t=e.Primary.Groupings,r=(t.length,{});return this.processPrimaryGroup(t[0],r),e.Secondary&&((t=e.Secondary.Groupings).length,1===t.length&&this.processSecondaryGroup(t[0],r)),r},V.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=r[i],o=(this.projectionsInfo.length,this.projectionsInfo[o]);0===o.metadata.kind?(l.addCategoryRole(t,o),t[l.CategoryRole].addActiveQueryReference(o.projection.queryRef)):1===o.metadata.kind&&l.addYRole(t,o)}},V.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.length,l.addSeriesRole(t,this.projectionsInfo[o])}},__extends(_,p=s=V),_.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.length,l.addBreakdownRole(t,this.projectionsInfo[o])}},u=_,__extends(P,c=s),P.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===t.ribbonChart.name?4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.TooltipRole:5===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.GradientRole&&e[4].name===l.TooltipRole},d=P,__extends(w,m=s),w.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===l.YRole&&e[1].name===l.MinValueRole&&e[2].name===l.MaxValueRole&&e[3].name===l.TargetValueRole&&e[4].name===l.TooltipRole},w.prototype.processPrimaryGroup=function(e,t){for(var r=0,i=0,a=e.Projections;i<a.length;i++){var o=a[i],n=(this.projectionsInfo.length,this.projectionsInfo[o]);if(1===n.metadata.kind){switch(r){case 0:l.addYRole(t,n);break;case 1:l.addTargetValueRole(t,n);break;case 2:l.addMaxValueRole(t,n);break;case 3:l.addMinValueRole(t,n);break;case 4:l.addTooltipRole(t,n)}r++}}},v=w,__extends(T,g=s),T.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 8===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.XRole&&e[3].name===l.YRole&&e[4].name===l.SizeRole&&e[5].name===l.GradientRole&&e[6].name===l.PlayRole&&e[7].name===l.TooltipRole},T.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=0,o=r.length;a<o;a++){var n=r[a],s=(this.projectionsInfo.length,this.projectionsInfo[n]);if(0===s.metadata.kind)l.addCategoryRole(t,s);else if(1===s.metadata.kind){switch(i){case 0:l.addXRole(t,s);break;case 1:l.addYRole(t,s);break;case 2:l.addSizeRole(t,s);break;case 3:l.addGradientRole(t,s);break;case 4:l.addTooltipRole(t,s)}i++}}},h=T,__extends(F,f=s),F.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 7===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.XRole&&e[4].name===l.SizeRole&&e[5].name===l.GradientRole&&e[6].name===l.TooltipRole},F.prototype.processPrimaryGroup=function(e,t){for(var e=e.Projections,r=(0<e.length&&e.length,0),i=0,a=e;i<a.length;i++){var o=a[i],n=(this.projectionsInfo.length,this.projectionsInfo[o]);if(0===n.metadata.kind)l.addCategoryRole(t,n);else if(1===n.metadata.kind){switch(r){case 0:l.addSizeRole(t,n);break;case 1:l.addXRole(t,n);break;case 2:l.addYRole(t,n);break;case 3:l.addGradientRole(t,n);break;case 4:l.addTooltipRole(t,n)}r++}}},y=F,__extends(j,C=s),j.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 6===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.XRole&&e[4].name===l.SizeRole&&e[5].name===l.TooltipRole},j.prototype.processPrimaryGroup=function(e,t){for(var e=e.Projections,r=(0<e.length&&e.length,0),i=0,a=e;i<a.length;i++){var o=a[i],n=(this.projectionsInfo.length,this.projectionsInfo[o]);if(0===n.metadata.kind)l.addCategoryRole(t,n);else if(1===n.metadata.kind){switch(r){case 0:l.addSizeRole(t,n);break;case 1:l.addXRole(t,n);break;case 2:l.addYRole(t,n);break;case 3:l.addTooltipRole(t,n)}r++}}},x=j,__extends(R,S=s),R.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===l.GroupRole&&e[1].name===l.DetailsRole&&e[2].name===l.ValuesRole&&e[3].name===l.GradientRole&&e[4].name===l.TooltipRole},R.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=r[i],o=(this.projectionsInfo.length,this.projectionsInfo[o]);0===o.metadata.kind?(l.addGroupRole(t,o),t[l.GroupRole].addActiveQueryReference(o.projection.queryRef)):1===o.metadata.kind&&l.addValuesRole(t,o)}},R.prototype.processSecondaryGroup=function(e,t){var r=e.Projections;r.length;for(var i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.length,l.addDetailsRole(t,this.projectionsInfo[o])}},b=R,__extends(D,E=l),D.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 3===e.length&&e[0].name===l.RowsRole&&e[1].name===l.ColumnsRole&&e[2].name===l.ValuesRole},D.prototype.build=function(e){var t=e.Primary.Groupings,r={};return this.processPrimaryGroups(t,r),e.Secondary&&(t=e.Secondary.Groupings,this.processSecondaryGroups(t,r)),r},D.prototype.processPrimaryGroups=function(e,t){if(e)for(var r=0,i=e.length;r<i;r++)this.processPrimaryGroup(e[r],t)},D.prototype.processSecondaryGroups=function(e,t){if(e)for(var r=0,i=e.length;r<i;r++)this.processSecondaryGroup(e[r],t)},D.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){r[i];this.projectionsInfo.length;var o=this.projectionsInfo[r[i]];0===o.metadata.kind?(l.addRowsRole(t,o),t[l.RowsRole].addActiveQueryReference(o.projection.queryRef)):1===o.metadata.kind&&l.addValuesRole(t,o)}},D.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=this.projectionsInfo[r[i]];o.metadata.kind,l.addColumnsRole(t,o),t[l.ColumnsRole].addActiveQueryReference(o.projection.queryRef)}},N=D})(powerbi=powerbi||{}),(function(e){var r,t,o,n;function a(i,a,o,n,s){return __awaiter(this,void 0,e.Promise,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return(t=s?u(i,a,0,0):l(i,a),s||t)?[4,n.get(i.reportId,t.name)]:[2];case 1:return r=e.sent(),r=r&&r.words,_.isEmpty(r)?r=[o]:r[0]=o,[4,n.set(i.reportId,t.name,r)];case 2:return e.sent(),[2]}}))}))}function p(e,t){return e&&e.pods?_.findIndex(e.pods,(function(e){return e.boundSection===t})):-1}function l(e,t){t=p(e,t);if(-1!==t)return e.pods[t]}function s(e,t){return e&&e.parameters?_.findIndex(e.parameters,(function(e){return e.boundFilter===t})):-1}function u(e,t,r,i){var a=l(e,t);return a||c(e,t,r,i)}function c(e,t,r,i){e.pods||(e.pods=[]);t={name:(function(e){for(var t={},r=0,i=e;r<i.length;r++){var a=i[r];t[a.name]=!0}return o.findUniqueName(t,n)})(e.pods),boundSection:t,parameters:[],type:0,referenceScope:r,config:{acceptsFilterContext:i}};return e.pods.push(t),jsCommon.ArrayExtensions.hasUniqueNames(e.pods),t}function d(t,r,e,i){var a=t.pods[r];_.isEmpty(a.parameters)&&(a.type=0),!a.cortanaEnabled&&_.isEmpty(a.parameters)&&0===a.config.acceptsFilterContext&&0===a.referenceScope&&(i?e.get(t.reportId,a.name).then((function(e){e&&!_.isEmpty(e.words)||m(t,r)})):m(t,r))}function m(e,t){e.pods.splice(t,1),0===e.pods.length&&(e.pods=void 0)}r=e.explore||(e.explore={}),t=r.PodUtils||(r.PodUtils={}),o=jsCommon.StringExtensions,n="Pod",t.getLinguisticMetadata=function(e,t,r,i){var a=i.defer();return-1===(i=p(e,t))?a.resolve(void 0):r.get(e.reportId,e.pods[i].name).then((function(e){e=e&&e.words.slice();_.isEmpty(e)?a.resolve(void 0):(e.shift(),a.resolve({altNames:e}))})),a.promise},t.deleteLinguisticEntity=function(r,i,a){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return-1<(t=p(r,i))?[4,a.set(r.reportId,r.pods[t].name,[])]:[3,2];case 1:e.sent(),d(r,t,a,!1),e.label=2;case 2:return[2]}}))}))},t.deletePod=function(r,i,a){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return-1<(t=p(r,i))?[4,a.set(r.reportId,r.pods[t].name,[])]:[3,2];case 1:e.sent(),m(r,t),e.label=2;case 2:return[2]}}))}))},t.ensurePod=function(t,r,i){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,a(t,r.name,r.displayName,i,!0)];case 1:return e.sent(),[2]}}))}))},t.updateLinguisticPrimaryName=a,t.updateLinguisticAltNames=function(r,i,a,o){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=u(r,i.name,0,0),a.unshift(i.displayName),[4,o.set(r.reportId,t.name,a)];case 1:return e.sent(),[2]}}))}))},t.addParameter=function(e,t,r,i,a,o,n){(e=u(e,t,0,0)).parameters||(e.parameters=[]),t={name:"Param_"+r,boundFilter:r,fieldExpr:i,asAggregation:a,isLegacySingleSelection:o},e.parameters.push(t),null!=e.type&&0!==e.type||0===n||(e.type=n)},t.deleteParameter=function(e,t,r,i){var a;-1<(t=p(e,t))&&(-1<(r=s(a=e.pods[t],r))&&(a.parameters.splice(r,1),d(e,t,i,!0)))},t.updateParameter=function(e,t,r,i){-1<(t=p(e,t))&&(-1<(t=s(e=e.pods[t],r))&&(e.parameters[t].asAggregation=i))},t.hasParameter=function(e,t,r){return-1!==(t=p(e,t))&&-1!==s(e.pods[t],r)},t.setCortanaEnabled=function(e,t,r,i){var a,o=p(e,t);-1===o&&!r||(-1===o?(a=c(e,t,0,0),o=e.pods.length-1):a=e.pods[o],a.cortanaEnabled=r,d(e,o,i,!0))},t.findPodIndexForPodName=function(e,t){if(e&&e.pods)return e=e.pods,-1!==(e=_.findIndex(e,(function(e){return e.name===t})))?e:void 0},t.duplicatePod=function(e,t,r,i,a){if(e.sections.length,-1===(r=p(e,e.sections[r].name)))return a.resolve();var o,n,s,l,r=void 0!==(a=e.pods[r]).config?a.config.acceptsFilterContext:0;return(r=c(e,t.name,a.referenceScope,r)).cortanaEnabled=a.cortanaEnabled,r.parameters=_.cloneDeep(a.parameters),r.type=a.type,o=e.reportId,n=t,s=r,(l=i).get(o,a.name).then((function(e){e=e&&e.words.slice();_.isEmpty(e)||(e.shift(),e.unshift(n.displayName),l.set(o,s.name,e))}))},t.findPodIndexForSectionName=p,t.findPodForSectionName=l,t.updateConfig=function(e,t,r){var i=l(e,t);(i=i||0===r?i:c(e,t,0,r))&&(null==i.config?i.config={acceptsFilterContext:r}:i.config.acceptsFilterContext!==r&&(i.config.acceptsFilterContext=r))},t.updateReferenceScope=function(e,t,r){var i=l(e,t);(i=i||0===r?i:c(e,t,r,0))&&null!=r&&i.referenceScope!==r&&(i.referenceScope=r)},t.acceptsAllFiltersWhenLinked=function(e,t){return!e||!t||(!(e=l(e,t.name))||!e.config||0===e.config.acceptsFilterContext)},t.hasMeasureOrAsAggregation=function(e,t){return!(!e||!t)&&(!(!(e=l(e,t.name))||!e.config)&&r.DrillthroughUtils.hasMeasureOrAsAggregationPodParameter(e.type,e.parameters))},t.acceptsCrossReportDrillthrough=function(e,t){return!(!e||!t)&&(!!(e=l(e,t.name))&&1===e.referenceScope)},t.determineReferenceScope=function(e){return e?1:0},t.determineAcceptsFilterContextKind=function(e){return e?0:1},t.determineType=function(e,t){return!(t||0!==e.type&&null!=e.type)||t&&2===e.type?1:1===e.type?2:0},t.isLinkedAsAggregation=function(e,t,r){return!(!e||!t)&&(!(!(e=l(e,t.name))||_.isEmpty(e.parameters))&&(-1!==(t=s(e,r.name))&&e.parameters[t].asAggregation))},t.isPodEnabled=function(e,t){return t&&1===t.scopeType&&r.FilterUtils.isCategoricalFilter(e.type)&&!e.isTransient},t.updateType=function(e,t,r){-1!==(t=p(e,t))&&(e=e.pods[t],_.isEmpty(e.parameters)&&(e.type=0),e.type=r)}})(powerbi=powerbi||{}),(function(a){var e,t,r,o,i,n,s,l,p,u;function c(e,t){e=i.asFieldPattern(e);return e.columnHierarchyLevelVariation&&e.columnHierarchyLevelVariation.source.entity===t.entity&&e.columnHierarchyLevelVariation.source.schema===t.schema&&e.columnHierarchyLevelVariation.source.name===t.property&&e.columnHierarchyLevelVariation.variationName===t.name}function d(e){var t=this;return(t=s.call(this)||this).change=e,t}function m(e){this.exprRewriter=e}function v(e,t){this.exprRewriter=e,this.change=t}e=(e=a.explore||(a.explore={})).schemaRewriterUtils||(e.schemaRewriterUtils={}),t=a.data.SQColumnRefExpr,r=a.data.SQEntityExpr,o=a.data.SQExpr,i=a.data.SQExprConverter,n=a.data.SQExprRewriter,e.createSchemaChangeRewriters=function(e){for(var r=[],t=0,i=e;t<i.length;t++)!(function(t){t.measureMove&&r.push(new p(a.data.createMoveMeasureRewriter(t.measureMove))),t.entityRename&&r.push(new p(a.data.createEntityRenameRewriter(t.entityRename))),t.propertyRename&&r.push(new p(a.data.createPropertyRenameRewriter(t.propertyRename))),t.hierarchyLevelRename&&r.push(new p(a.data.createHierarchyLevelRenameRewriter(t.hierarchyLevelRename))),t.removeVariation&&r.push(new u(new l(t.removeVariation),t.removeVariation)),t.newMeasureCreated&&_.find(e,(function(e){return e.itemDelete&&e.itemDelete.property===t.newMeasureCreated.name&&e.itemDelete.entity===t.newMeasureCreated.entity&&e.itemDelete.schema!==t.newMeasureCreated.schema}))&&r.push(new p(a.data.createSetSchemaMeasureRewriter(t.newMeasureCreated)))})(i[t]);return r},__extends(d,s=n),d.prototype.visitHierarchyLevel=function(e){return c(e,this.change)?new t(new r(this.change.schema,this.change.entity),this.change.property):e},l=d,m.prototype.rewriteQuery=function(e){var t=this,r=(r=e.defn).rewrite(this.exprRewriter),r=(e.defn=r,e.expansionStates=_.map(e.expansionStates,(function(e){return e.rewrite(t.exprRewriter)})),e.getQueryFieldParameters());if(!_.isEmpty(r))for(var i=0,a=r;i<a.length;i++){var o=a[i];o.expr=o.expr.accept(this.exprRewriter)}return e},m.prototype.rewriteFilter=function(e){return e.rewrite(this.exprRewriter)},m.prototype.rewriteExpr=function(e){return e.accept(this.exprRewriter)},p=m,e.VisualQueryExprRewriter=p,v.prototype.rewriteQuery=function(e){var t=this;this.removeDuplicateSQHierarchyLevelExpr(e);var r=(r=e.defn).rewrite(this.exprRewriter);return e.defn=r,e.expansionStates=_.map(e.expansionStates,(function(e){return e.rewrite(t.exprRewriter)})),e},v.prototype.rewriteFilter=function(e){return e.rewrite(this.exprRewriter)},v.prototype.rewriteExpr=function(e){return e.accept(this.exprRewriter)},v.prototype.removeDuplicateSQHierarchyLevelExpr=function(e){for(var t=e.defn.select(),r=0;r<t.length;){var i=t[r];if(r++,o.isHierarchyLevel(i.expr)&&c(i.expr,this.change))for(;r<t.length&&o.isHierarchyLevel(t[r].expr)&&o.equals(i.expr.arg,t[r].expr.arg);)e.removeExpr(t[r].expr,!1),r++}},u=v})(powerbi=powerbi||{}),(function(e){function p(e,t){var r=[];if(e&&e.visualContainers)for(var i=0,a=e.visualContainers;i<a.length;i++){var o=a[i];t.addScriptVisualInfo(o,r)}return r}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ScriptVisualsUtil||(e.ScriptVisualsUtil={})).defaultScript="##############################",e.getScriptVisualIdsInSection=p,e.getVisualStatsInExploration=function(e,t){var r={totalVisualsCount:0,info:[]};if(e&&e.sections)for(var i=0,a=e.sections;i<a.length;i++){var o,n=a[i];n.visualContainers&&(o=p(n,t),r.info=r.info.concat(o),r.totalVisualsCount+=n.visualContainers.length)}return r},e.getScriptVisualIds=function(e,t,r,i,a){var o=[];switch(e){case 0:if(!i)return o;a.addScriptVisualInfo(i,o);break;case 1:o=p(r,a);break;case 2:if(!t)return o;for(var n=0,s=t.sections;n<s.length;n++)var l=p(s[n],a),o=o.concat(l);break;default:return o}return o},e.visualContainerHasScriptVisuals=function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&a.config&&a.config.singleVisual){a=a.config.singleVisual.visualType;if(a&&t.isScriptVisual(a))return!0}}return!1},e.confirmRefreshForRDataSource=function(e,t,r,i,a,o){var n=e.control(),e=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_OkButton"),s=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_CancelButton"),e=[new InJs.ModalDialogAction(e,function(){n.hideDialog(),a()}),new InJs.ModalDialogAction(s,function(){n.hideDialog(),o()})],s=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_Title"),l=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_WarningMessage"),t="<div><span>"+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart1")+' </span><a href= "https://go.microsoft.com/fwlink/?LinkId=821887" target= "_blank">'+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessageLink1")+"</a><span> "+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart2")+"</span><br/><span>"+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart3")+' </span><a href= "https://go.microsoft.com/fwlink/?LinkId=821886" target= "_blank">'+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessageLink2")+"</a></div>",s=(i.message=l,{dialogName:s,isDismissable:!1,scope:i,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"customModalDialog",dialogActions:e,notificationType:jsCommon.ModalDialogNotificationType.SecurityWarning,notificationText:l,htmlMessageText:t,focusOnFirstButton:!1,noActiveButtons:!0,flipContentAndNotificationOrder:!0});r.showLegacyWebModalDialog(s)},e.getScriptVisualType=function(e){switch(e){case"scriptVisual":return 0;case"pythonVisual":return 1;default:return null}},e.getScriptVisualTypeName=function(e){switch(e){case 0:return"scriptVisual";case 1:return"pythonVisual";default:return null}}})(powerbi=powerbi||{}),(function(e){(function(e){Object.defineProperty(r.prototype,"position",{get:function(){},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"max",{get:function(){},enumerable:!1,configurable:!0}),r.prototype.scrollItemIntoView=function(e,t,r){var i,a=this.getContainer(),a=this.getRange(a),o=this.getItems(),n=o[e];n&&(i=0===e,e=e===o.length-1,o=this.getRange($(n),!0),i?t=0:e?t=r||0:null==t&&(t=this.getDefaultOverscroll()),a&&o&&(n=this.calculatePositionDelta(a,o,t),this.position=this.position+n))},r.prototype.getPageDownItemIndex=function(e){var t=this.getRange(this.getContainer());if(t){var r=this.getItems();if(0===r.length)return-1;for(var i=0,a=e;a<r.length-1;a++)if((i+=this.getRange(r.eq(a)).size)>t.size)return a;return r.length-1}return-1},r.prototype.getPageUpItemIndex=function(e){var t=this.getRange(this.getContainer());if(t){var r=this.getItems();if(0===r.length)return-1;for(var i=0,a=e;0<a;a--)if((i+=this.getRange(r.eq(a)).size)>t.size)return a;return 0}return-1},r.prototype.retainPosition=function(e){var t=this.position;try{e()}finally{this.position=t}},r.prototype.handleKeyDown=function(e,t,r){var i=!0,a=e,o=this.getItems().length-1;switch(t.keyCode){case $.ui.keyCode.PAGE_UP:var n=this.getPageUpItemIndex(e),a=Math.max(n,0);break;case $.ui.keyCode.PAGE_DOWN:n=this.getPageDownItemIndex(e);a=Math.min(n,o);break;case $.ui.keyCode.END:a=o;break;case $.ui.keyCode.HOME:a=0;break;default:i=void 0!==(a=this.getNewIndexOnKeyDown(e,o,t))}return void 0!==a&&a!==e&&(r(a),this.scrollItemIntoView(a)),i},r.prototype.onScroll=function(t){var r=this;this.getContainer().scroll((function(){var e=r.position/r.max;t(e)}))},r.prototype.getNewIndexOnKeyDown=function(e,t,r){},r.prototype.getRange=function(e,t){void 0===t&&(t=!1)},r.prototype.getDefaultOverscroll=function(){},r.prototype.getContainer=function(){return $(this.containerSelector)},r.prototype.getItems=function(){return this.retrieveItems()},r.prototype.retrieveItems=function(){return this.includeDescendants?this.getContainer().find(this.itemsSelector):this.getContainer().children(this.itemsSelector)},r.prototype.calculatePositionDelta=function(e,t,r){return t.min<e.min?-(e.min-t.min+r):t.max>e.max?t.max-e.max+r:0};var t=r;function r(e,t,r){void 0===r&&(r=!0),this.containerSelector=e,this.itemsSelector=t,this.includeDescendants=r}e.BaseScrollHelper=t;__extends(o,i=t),Object.defineProperty(o.prototype,"position",{get:function(){return this.getContainer().scrollTop()},set:function(e){var t=this.getContainer();t.scrollTop()!==e&&t.scrollTop(e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"max",{get:function(){var e=this.getContainer()[0];return e?e.scrollHeight:void 0},enumerable:!1,configurable:!0}),o.prototype.getNewIndexOnKeyDown=function(e,t,r){switch(r.keyCode){case $.ui.keyCode.UP:return r.scrollHandled=!0,Math.min(Math.max(e-1,0),t);case $.ui.keyCode.DOWN:return Math.min(e+1,t)}},o.prototype.getRange=function(e,t){void 0===t&&(t=!1);var r=e.offset();return r?(t=t?e.outerHeight():e.innerHeight(),{min:r.top,max:r.top+t,size:t}):null},o.prototype.getDefaultOverscroll=function(){return 0};var i,a=o;function o(){return null!==i&&i.apply(this,arguments)||this}e.VerticalScrollHelper=a;__extends(s,n=t),Object.defineProperty(s.prototype,"position",{get:function(){return this.getContainer().scrollLeft()},set:function(e){var t=this.getContainer();t.scrollLeft()!==e&&t.scrollLeft(e)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"max",{get:function(){var e=this.getContainer()[0];return e?e.scrollWidth:void 0},enumerable:!1,configurable:!0}),s.prototype.getNewIndexOnKeyDown=function(e,t,r){var i=0;switch(r.keyCode){case $.ui.keyCode.LEFT:i=-1;break;case $.ui.keyCode.RIGHT:i=1}if(0!==(i=this.isRtl?-i:i))return e=t<(e=(e+=i)<0?0:e)?t:e},s.prototype.getRange=function(e,t){void 0===t&&(t=!1);var r=e.offset();return r?(t=t?e.outerWidth():e.innerWidth(),{min:r.left,max:r.left+t,size:t}):null},s.prototype.getDefaultOverscroll=function(){return 16},s.prototype.calculatePositionDelta=function(e,t,r){e=n.prototype.calculatePositionDelta.call(this,e,t,r);return this.isRtl?-e:e};var n,a=s;function s(e,t,r,i){void 0===r&&(r=!1);e=n.call(this,e,t,i=void 0===i?!0:i)||this;return e.isRtl=r,e}function l(e,t,r){var i=this;this.lastScrollLeft=0,this.lastScrollTop=0,this.scrollPanel=e,this.syncedPanel=t,this.syncOptions=r,this.onScroll=this.onScroll.bind(this),jsCommon.Zone.runOutsideAngular((function(){i.scrollPanel.addEventListener("scroll",i.onScroll)}))}e.HorizontalScrollHelper=a,l.prototype.dispose=function(){this.scrollPanel.removeEventListener("scroll",this.onScroll)},l.prototype.onScroll=function(){var e=this;this.syncOptions.syncDelay?(clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){e.syncScrollPositions()}),this.syncOptions.syncDelay)):this.syncScrollPositions()},l.prototype.syncScrollPositions=function(){var e;this.syncOptions.syncX&&(e=this.scrollPanel.scrollLeft)!==this.lastScrollLeft&&(this.syncedPanel.scrollLeft=e,this.lastScrollLeft=e),this.syncOptions.syncY&&(e=this.scrollPanel.scrollTop)!==this.lastScrollTop&&(this.syncedPanel.scrollTop=e,this.lastScrollTop=e)},e.ScrollSyncHelper=l})((e=e.explore||(e.explore={})).utils||(e.utils={}))})(powerbi=powerbi||{}),(function(e){(function(s){var l=jsCommon.BrowserUtils;function e(e,t,r,i,a,o,n){void 0===i&&(i=!0),this._hasFocus=!1,this.selection=s.createTreeSelectionManager(e,a),this.scrollHelper=null!=n?n:new s.VerticalScrollHelper(t,r,!0),this.getVisibleNodes=e,this.allowMultiSelect=i,this.onFocusedItemChanged=null!=o?o:_.noop}e.prototype.hasFocus=function(){return this._hasFocus},e.prototype.onNodeClick=function(e,t){var r=t.shiftKey,i=l.isCtrlOrMeta(t);r&&i?this.shiftSelect(e):r?(this.selection.clear(),this.shiftSelect(e)):i?this.selection.toggle(e):_.isEqual(this.selection.getSelectedItems(),[e])||(this.selection.clear(),this.selection.select(e)),r||(this.shiftSelectionStartNode=e),this.focus(e),t.preventDefault(),t.stopPropagation()},e.prototype.onBackgroundClick=function(e){this.selection.clear(),e.stopPropagation()},e.prototype.onFocus=function(){this.focus(this.getFocusedNode()||this.getVisibleNodes()[0]),this._hasFocus=!0},e.prototype.onBlur=function(){this.getVisibleNodes().map((function(e){return e.isFocused=!1})),this._hasFocus=!1,this.onFocusedItemChanged(void 0)},e.prototype.onKeyDown=function(e){var t,r,i=this,a=e.shiftKey,o=l.isCtrlOrMeta(e),n=!1,s=this.lastFocusedNode;o&&"KeyA"===e.code&&this.allowMultiSelect?(this.selection.selectAll(),n=!0):"Escape"===e.code?(this.selection.clear(),n=!0):"Space"===e.code&&s?(o&&a?this.shiftSelectionStartNode&&(r=this.getVisibleNodes(),r=this.getNodesInRange(r,this.shiftSelectionStartNode,s),this.selection.selectRange(r)):o?this.selection.toggle(s):this.selection.select(s),n=!0):"ArrowLeft"===e.code&&s?(s.isExpanded?this.setExpandValue(s,!1):s.parent&&(r=s.parent,this.selectAndScrollTo([r]),this.focus(r)),n=!0):"ArrowRight"===e.code&&s?(_.isEmpty(s.children)||(s.isExpanded?(r=s.children[0],this.selectAndScrollTo([r]),this.focus(r)):this.setExpandValue(s,!0)),n=!0):s&&(n=!0,0<=(r=(t=this.getVisibleNodes()).indexOf(s))&&(n=this.scrollHelper.handleKeyDown(r,e,(function(e){e=t[e];i.allowMultiSelect?a&&o?i.shiftSelect(e):a?(i.selection.clear(),i.shiftSelect(e)):o||(i.selection.clear(),i.selection.select(e)):(i.selection.clear(),i.selection.select(e)),a||(i.shiftSelectionStartNode=e),i.focus(e)})))),n&&(e.stopPropagation(),e.preventDefault())},e.prototype.toggleExpandCollapse=function(e,t){this.setExpandValue(e,!e.isExpanded),t&&t.stopPropagation()},e.prototype.selectAndScrollTo=function(t){var r=this;this.selection.clear(),this.selection.selectRange(t),requestAnimationFrame((function(){var e=r.getVisibleNodes().indexOf(t[0]);r.scrollHelper.scrollItemIntoView(e,30)}))},e.prototype.syncManagedNodes=function(e){var t=this,r=(this.hasNode(e,this.shiftSelectionStartNode)||(this.shiftSelectionStartNode=void 0),this.hasNode(e,this.lastFocusedNode)||(this.lastFocusedNode=void 0),this.selection.clear(),[]);_.forEach(e,(function(e){t.collectSelectedNodes(e,r)})),_.forEach(r,(function(e){e.isSelected=!1})),this.selection.selectRange(r)},e.prototype.shiftSelect=function(e){var t=this.getVisibleNodes(),r=null!=(r=this.shiftSelectionStartNode)?r:_.first(t);this.selection.selectRange(this.getNodesInRange(t,r,e))},e.prototype.collectSelectedNodes=function(e,t){var r=this;e&&(e.isSelected&&t.push(e),_.forEach(e.children,(function(e){r.collectSelectedNodes(e,t)})))},e.prototype.hasNode=function(e,t){for(var r=0,i=null!=e?e:[];r<i.length;r++){var a=i[r];if(a===t)return!0;if(this.hasNode(a.children,t))return!0}return!1},e.prototype.getNodesInRange=function(e,t,r){var t=e.indexOf(t),r=e.indexOf(r),i=Math.min(t,r),a=Math.max(t,r);if(-1<i)for(var o=[],n=i;n<=a;n++)o.push(e[n]);return o},e.prototype.focus=function(e){e&&(this.getVisibleNodes().map((function(e){return e.isFocused=!1})),e.isFocused=!0,this.lastFocusedNode=e,this.onFocusedItemChanged(e))},e.prototype.getFocusedNode=function(){var e=this.getVisibleNodes(),t=_.find(e,(function(e){return e.isSelected}));return null!=t?t:_.find(e,(function(e){return e.isFocused}))},e.prototype.setExpandValue=function(e,t){e.isExpanded!==t&&(e.isExpanded=t,e.isExpanded||(null==(t=this.shiftSelectionStartNode)?void 0:t.parent)!==e||(this.shiftSelectionStartNode=e))},s.TreeHelper=e})((e=e.explore||(e.explore={})).utils||(e.utils={}))})(powerbi=powerbi||{}),(function(e){var r;function t(e,t){this.selectedItems=[],this.getItems=e,this.onSelectionChanged=null!=t?t:_.noop}((e=e.explore||(e.explore={})).utils||(e.utils={})).createTreeSelectionManager=function(e,t){return new r(e,t)},Object.defineProperty(t.prototype,"lastSelected",{get:function(){return _.last(this.selectedItems)},enumerable:!1,configurable:!0}),t.prototype.getSelectedItems=function(){return __spreadArray([],this.selectedItems||[])},t.prototype.select=function(e){this.selectInternal(e)&&this.onSelectionChanged(this.selectedItems)},t.prototype.selectRange=function(e){for(var t=!1,r=0,i=e;r<i.length;r++)var a=i[r],t=this.selectInternal(a)||t;t&&this.onSelectionChanged(this.selectedItems)},t.prototype.selectAll=function(){this.selectRange(this.getItems())},t.prototype.toggle=function(e){e.isSelected?(e.isSelected=!1,this.selectedItems.splice(this.selectedItems.indexOf(e),1)):(e.isSelected=!0,this.selectedItems.push(e)),this.onSelectionChanged(this.selectedItems)},t.prototype.clear=function(){for(var e=!_.isEmpty(this.selectedItems),t=0,r=this.selectedItems;t<r.length;t++)r[t].isSelected=!1;this.selectedItems.splice(0),e&&this.onSelectionChanged([])},t.prototype.selectInternal=function(e){return!e.isSelected&&(e.isSelected=!0,this.selectedItems.push(e),!0)},r=t})(powerbi=powerbi||{}),(function(E){var e,n,r,N,s,l,p,u,V;function c(e,t){t=m(e.expr,t);return t!==e.expr?r(t):e}function P(e,t){if(e instanceof V)for(var r=e,i=0,a=t;i<a.length;i++)if((r=a[i].rewriteExpr(r))!==e)return 1}function w(e,t){for(var r=0,i=e.textRuns;r<i.length;r++)if(P(i[r].value,t))return 1}function i(e,t){var r=e.expression,i=e.filter,a=e.cachedValueItems;r&&(e.expression=m(r,t)),i&&(e.filter=d(i,t)),a&&o(a,t)}function o(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r],o=c(a.identity,t);o!==a.identity&&(a.identity=o)}}function d(e,t){return _.reduce(t,(function(e,t){return t.rewriteFilter(e)}),e)}function m(e,t){return _.reduce(t,(function(e,t){return t.rewriteExpr(e)}),e)}e=(e=E.explore||(E.explore={})).util||(e.util={}),n=jsCommon.ArrayExtensions,r=E.data.createDataViewScopeIdentity,N=E.data.DataViewObjectDefinitions,s=E.data.DataViewObjectDescriptors,l=E.data.DataViewScopeTotal,p=E.data.DataViewScopeWildcard,u=E.data.Selector,V=E.data.SQExpr,e.rewriteDataRepetitionSelectors=function(e,o){return _.isEmpty(e)?e:n.rewriteArray(e,(function(e){return u.isScopeIdentity(e)?c(e,o):u.isScopeWildcard(e)?(r=e,i=o,(a=n.rewriteArray(r.exprs,(function(e){return m(e,i)})))!==r.exprs?p.fromExprs(a):r):!u.isRoleWildcard(e)&&!u.isWildcard(e)&&u.isScopeTotal(e)?(a=e,t=o,(r=n.rewriteArray(a.exprs,(function(e){return m(e,t)})))!==a.exprs?l.fromExprs(r):a):e;var t,r,i,a}))},e.rewriteVisualLink=function(e,t){},e.rewriteFilterContainer=function(e,t){i(e,t)},e.rewriteFilterContainerState=function(e,t){i(e,t)},e.rewriteFilterOutput=function(e,t,r){if(t=s.findFilterOutput(t)){e=E.data.DataViewObjectDefinitions.getPropertyContainer(e,t,null);if(e){t=t.propertyName;if(o=e[t]){for(var i=0,a=r;i<a.length;i++)var o=a[i].rewriteFilter(o);e[t]=o}}}},e.rewriteDataBoundPropertyDefinitions=function(e,t,y){function C(e){var t=x(e.value);return{textStyle:e.textStyle,url:e.url,value:t,mentionEmail:e.mentionEmail}}function x(e){return e=e instanceof V?b(e,y):e}function S(e){return{textRuns:_.map(e.textRuns,C)}}function b(e,t){for(var r=0,i=t;r<i.length;r++)e=i[r].rewriteExpr(e);return e}e&&t&&(_.isEmpty(y)||N.visitPropertyDefinitions(e,t,(function(e,t,r,i,a){var o,a=a&&a.properties[t];if((l=e[t])instanceof V)for(var n=0,s=y;n<s.length;n++)var l=(c=s[n]).rewriteExpr(l);else if(N.isObjectPropertySQExprWithContext(l))for(var p=0,u=y;p<u.length;p++){var c=u[p];if(!_.isEmpty(null==(o=l.context)?void 0:o.filterContext))for(var d=0,m=l.context.filterContext;d<m.length;d++){var v=m[d];v.filter=c.rewriteFilter(v.filter)}l.value=c.rewriteExpr(l.value)}else{a=a.type;if(a.fill&&a.fill.solid&&a.fill.solid.color){if(!E.StructuralObjectDefinition.isFillDefinition(l))return;var g=l.solid.color;if(!g)return;var h=g;(g=b(g,y))!==h&&(l={solid:{color:g}})}else if(a.paragraphs){if(!E.StructuralObjectDefinition.isParagraphsDefinition(l))return;if(!(function(e,t){for(var r=0,i=e;r<i.length;r++)for(var a=i[r].textRuns,o=0,n=a;o<n.length;o++){var s=n[o];if(E.ParagraphsDefinition.isTextRunDefinition(s)){if(P(s.value,t))return 1}else if(E.ParagraphsDefinition.isTextRunConditionalDefinition(s)){for(var l=0,p=s.cases;l<p.length;l++)if(function(e,t){if(w(e,t))return 1;if(P(e.pattern,t))return 1}(p[l],t))return 1;if(w(s.defaultCase,t))return 1;if(P(s.expression,t))return 1}}return})(l,y))return;l=_.map(l,(function(e){return{horizontalTextAlignment:e.horizontalTextAlignment,textRuns:_.map(e.textRuns,(function(e){return E.ParagraphsDefinition.isTextRunDefinition(e)?C(e):E.ParagraphsDefinition.isTextRunConditionalDefinition(e)?{cases:_.map(e.cases,(function(e){var t=e.pattern;return t instanceof V&&(t=b(t,y)),__assign({pattern:t},S(e))})),defaultCase:S(e.defaultCase),expression:x(e.expression)}:void 0}))}}))}else if(a.icon){if(!E.StructuralObjectDefinition.isIconDefinition(l))return;h={kind:"Icon",value:l.value&&b(l.value,y),layout:l.layout&&b(l.layout,y),verticalAlignment:l.verticalAlignment&&b(l.verticalAlignment,y)};l.value===h.value&&l.layout===h.layout&&l.layout===h.layout||(l=h)}else if(a.errorRange){if(!E.StructuralObjectDefinition.isErrorRangeDefinition(l))return;var f,g={kind:"ErrorRange"};l.explicit?(f=l.explicit,h=g.explicit={isRelative:b(f.isRelative,y)},f.lowerBound&&(h.lowerBound=b(f.lowerBound,y)),f.upperBound&&(h.upperBound=b(f.upperBound,y))):l.symmetricalExplicit?g.symmetricalExplicit={delta:b(l.symmetricalExplicit.delta,y)}:l.standardDeviation?(f=l.standardDeviation,g.standardDeviation={value:b(f.value,y),multiplier:b(f.multiplier,y)}):l.percentage?(f=l.percentage,g.percentage={lowerBoundDelta:b(f.lowerBoundDelta,y),upperBoundDelta:b(f.upperBoundDelta,y)}):l.percentile&&(f=l.percentile,g.percentile={lowerBound:b(f.lowerBound,y),upperBound:b(f.upperBound,y)}),l=g}}e[t]=l})))},e.rewriteDisplayNameIdentityPairs=o,e.rewriteSemanticFilter=d,e.rewriteExpr=m,e.rewriteLinkField=function(e,t){var r=e.fieldExpr;e.fieldExpr=m(r,t)},e.rewritePod=function(e,t){if(!_.isEmpty(e.parameters))for(var r=0,i=e.parameters;r<i.length;r++){var a=i[r];a.fieldExpr&&(a.fieldExpr=m(a.fieldExpr,t))}},e.rewriteFilterExpressionMetadata=function(e,t){if(e.expressions=n.rewriteArray(e.expressions,(function(e){return m(e,t)})),e.cachedValueItems)for(var e=e.cachedValueItems,r=t,i=0,a=e;i<a.length;i++){var o=a[i];o.identities=n.rewriteArray(o.identities,(function(e){return c(e,r)}))}}})(powerbi=powerbi||{}),(function(e){var t,o,n;function r(e){var e=e===n.InnerPosition,t=e?15:10,r=e?0:3,i=o.DefaultTransparency,a={};return a[n.BottomRightPreset]={angle:e?225:45,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[n.BottomPreset]={angle:e?270:90,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[n.BottomLeftPreset]={angle:e?315:135,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[n.CenterRightPreset]={angle:e?180:0,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[n.CenterPreset]={angle:0,shadowDistance:0,shadowBlur:e?20:15,shadowSpread:r,transparency:i},a[n.CenterLeftPreset]={angle:e?0:180,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[n.TopRightPreset]={angle:e?135:315,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[n.TopPreset]={angle:e?90:270,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[n.TopLeftPreset]={angle:e?45:225,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a}function a(e,t){t=r(t||o.DefaultPosition);return t.hasOwnProperty(e)?t[e]:null}e=e.explore||(e.explore={}),t=e.util||(e.util={}),n=e.contracts.VisualDropShadow,(o=t.VisualDropShadowUtil||(t.VisualDropShadowUtil={})).DefaultShow=!1,o.DefaultPreset=n.BottomRightPreset,o.DefaultPosition=n.OuterPosition,o.DefaultTransparency=70,o.DefaultShadowSpread=3,o.DefaultShadowBlur=10,o.DefaultAngle=45,o.DefaultShadowDistance=10,o.DefaultColor="#000",o.getDefaultValues=function(e,t){var r=e&&e.preset?e.preset:o.DefaultPreset,e=e&&e.position?e.position:o.DefaultPosition,i=a(r,e),t=t?t.colorPalette.foreground.value:o.DefaultColor;return{show:o.DefaultShow,preset:r,position:e,color:{solid:{color:t}},shadowSpread:i?i.shadowSpread:o.DefaultShadowSpread,shadowBlur:i?i.shadowBlur:o.DefaultShadowBlur,angle:i?i.angle:o.DefaultAngle,shadowDistance:i?i.shadowDistance:o.DefaultShadowDistance,transparency:i?i.transparency:o.DefaultTransparency}},o.presetSettings=r,o.getPresetSettings=a})(powerbi=powerbi||{}),(function(w){var p,e,u,T,l,c,d,m,t,r,i,a,F,j,n,o;function v(e){return e&&e.config&&e.config.singleVisual?e.config.singleVisual.query:null}function s(e){return e&&e.config&&e.config.singleVisual}function g(e){e=e.config;if(e){e=e.singleVisual;if(e&&e.query)return e.query.defn.select()}}function h(e,t){if(e&&t){t=t.getPlugin(e);if(t)return t.capabilities}}function f(e,t){return h(u.getVisualType(e),t)}function y(e,t){if(e.role)t.push(e.role);else{var r=e;if(r.bind)r.bind.to&&t.push(r.bind.to);else if(e.for)e.for.in&&t.push(e.for.in);else{r=e;if(r.group){if(r.group.by&&t.push(r.group.by),r.group.select)for(var i=0,a=r.group.select;i<a.length;i++)y(a[i],t)}else{r=e;if(r.composite)for(var o=0,n=r.composite;o<n.length;o++)y(n[o],t);else if(e.select)for(var s=0,l=e.select;s<l.length;s++)y(l[s],t)}}}}function R(e){var t=[];return e&&(e.categorical&&(e.categorical.categories&&y(e.categorical.categories,t),e.categorical.values&&y(e.categorical.values,t)),e.table&&e.table.rows&&y(e.table.rows,t),e.single&&y(e.single,t),e.tree&&(e.tree.nodes&&y(e.tree.nodes,t),e.tree.values&&y(e.tree.values,t)),e.matrix&&(e.matrix.columns&&y(e.matrix.columns,t),e.matrix.rows&&y(e.matrix.rows,t),e.matrix.values&&y(e.matrix.values,t))),t=_.uniq(t)}function D(e){switch(e.extendedType){case 66048:return 67;case 131584:return 35}switch(e.primitiveType){case 1:return 2048;case 2:case 3:return 1;case 4:return 3;case 5:return 4096;case 6:return 20;case 7:return 4;case 9:return 8}}function A(e){return w.data.conceptualDataCategoryFromString(e.categoryString)}function C(e){return r.generateUniqueId(e)}function x(e){return e&&null!=e.size?a.fromPoint(e.size.pt):a.toString(u.DefaultTitleFontSizeInPixel)}function S(e){return!(!e||!e.defn)&&(e=e.defn.groupBy(),!_.isEmpty(e))}function I(e){for(var t={},r=0,i=e.defn.select();r<i.length;r++){var a=i[r],o=void 0,o=j.isMeasure(a.expr)?w.VisualDataRoleKind.Measure:w.VisualDataRoleKind.Grouping;t[a.name]=o}return t}function b(e){for(var t=0,r=e.visualContainers;t<r.length;t++){var i=r[t];delete i.cachedData,i.disableCacheOnServerForInitialLoad=!0}}function E(e){e=s(e);return e&&e.columnProperties}p=w.explore||(w.explore={}),e=p.util||(p.util={}),l=jsCommon.CssConstants,c=w.data.DataViewObjectDefinitions,d=w.data.services.DataViewObjectSerializer,m=w.data.DataViewTransform,t=w.visuals.Units.FontSize,r=w.common.utils.IdUtility,i=w.data.InteractiveQueryCachingSettings,a=jsCommon.PixelConverter,F=w.data.SQExpr,j=w.data.SQExprUtils,n=p.contracts.VisualContainer,o=p.contracts.VisualTitleHeading,u=e.VisualContainerUtils||(e.VisualContainerUtils={}),T=jsCommon.ArrayExtensions,u.DefaultTitleFontSizeInPixel=12,u.DefaultTitleFontFamily="'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",u.DefaultTitleFontColor="#C8C8C8",u.DefaultTitleTextClass="largeTitle",u.DefaultTitleThemeColor="foreground",u.DefaultTitleFontSizeInPoints=jsCommon.PixelConverter.toPoint(u.DefaultTitleFontSizeInPixel),u.DefaultTitleFontProperties={size:t.createFromPt(u.DefaultTitleFontSizeInPoints),family:u.DefaultTitleFontFamily,color:u.DefaultTitleFontColor},u.DefaultTitleHeading=o.DefaultHeadingAttribute,u.getVisualType=function(e){if(e)return p.contracts.isVisualContainerGroup(e)?p.constants.GroupComponentType:e.config&&e.config.singleVisual?e.config.singleVisual.visualType:void 0},u.getVisualQuery=v,u.getSingleVisualConfig=s,u.isVisualTypeAutoSelect=function(e){return null==(e=null==(e=null==e?void 0:e.config)?void 0:e.singleVisual)?void 0:e.autoSelectVisualType},u.getSelectExprs=g,u.getFilterCapabilities=function(e,t){return h(e&&e.config&&e.config.singleVisual?e.config.singleVisual.visualType:null,t)},u.getVisualCapabilities=f,u.getDataRolesForVisual=function(e,t){if((e=f(e,t))&&!_.isEmpty(e.dataRoles))return e.dataRoles},u.getVisualQueryCachingSettings=function(e,t,r){if(e)return r||"UserAction_ChangeModel"===t||"UserAction_Refresh"===t?i.BypassCache:i.Default},u.setQueryKeepProjectionOrder=function(e){e.config&&e.config.singleVisual&&((e=e.config.singleVisual)&&e.query&&e.query.hasShowAll()&&(e.queryOptions=e.queryOptions||{},e.queryOptions.keepProjectionOrder=!0))},u.getDataRolesForVisualPlugin=function(e){if(e){e=e.capabilities;if(e&&!_.isEmpty(e.dataRoles))return e.dataRoles}},u.getNumberRangesForRoles=function(e,t,r){if(t=f(e,t)){e=v(e);if(e)return w.visualCapabilitiesHelperModuleFactory().create(t,r).getNumberRangesForRoles(e)}},u.isScriptVisual=function(e,t){return e=u.getVisualType(e),t&&t.isScriptVisual(e)},u.isSmallMultiplesVisual=function(e){if(0<=[w.visuals.plugins.lineChart.name,w.visuals.plugins.areaChart.name,w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name].indexOf(e.visualType)){e=null==(e=e.query)?void 0:e.projections;if(e&&e[w.visuals.cartesianRoleNames.rows]&&0<e[w.visuals.cartesianRoleNames.rows].all().length)return!0}return!1},u.getObjectDefinitions=function(e){return null==(e=null==(e=e.config)?void 0:e.singleVisual)?void 0:e.objects},u.getContainerObjectDefinitions=function(e){return e.config&&e.config.singleVisual&&e.config.singleVisual.vcObjects},u.getQueryName=function(e,t,r){return(e=e.config.singleVisual.query.projections[t].all()[r]).queryRef},u.describeForPinning=function(e,t,r,i,a,o,n){if(r){var s=r.defn.select(),l=r.projections,p=[],u=[],c=I(r),d=w.DataViewAnalysis.chooseDataViewMappings(r.projections,a.dataViewMappings,c,o).supportedMappings;if(d){for(var m=0,v=d;m<v.length;m++){var g,h=v[m],f=1<d.length?R(h):null,y=[];for(g in l)if(null==f||_.includes(f,g))for(var C=l[g],x=0,S=C.all();x<S.length;x++){var b,E,N=S[x],V=T.indexWithName(s,N.queryRef),P=s[V];F.isTransformOutputRoleRef(P.expr)||(b=P.expr.getMetadata(t,j.buildExprEvaluationContext(r.defn.from())),E={Restatement:e.getDisplayName(P.expr,t,a,P.name,i),Name:N.queryRef,Type:D(b.type)},(P=j.getKpiMetadata(P.expr,t))&&(E.kpi=P),(P=N.format||b.format)&&(E.Format=P),(P=A(b.type))&&(E.DataCategory=P),p[V]=E,y.push({Name:g,Projection:V,isActive:_.includes(C.activeProjectionRefs,N.queryRef)}))}u.push({DataRoles:y})}return{queryMetadata:{Select:p,Filters:n},visualElements:u}}}},u.getRolesForDataViewMapping=R,u.toSemanticType=D,u.toConceptualDataCategory=A,u.hasGrouping=function(e,t){if(e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query&&e.config.singleVisual.query.defn){var r=e.config.singleVisual.query.projections,i=e.config.singleVisual.query.defn.select();if(r&&0<i.length)for(var a in r)for(var o=0,n=r[a].all();o<n.length;o++){var s=n[o],s=jsCommon.ArrayExtensions.findItemWithName(i,s.queryRef);if(s){s=s.expr.getMetadata(t);if(s&&0===s.kind&&null==s.aggregate)return!0}}return!1}},u.contractEqualityComparator=function(t){return function(e){return t===e}},u.contractUnEqualityComparator=function(t){return function(e){return t!==e}},u.filterAffects=function(t,r,i,a){return function(e){return t===e||3!==(i&&i.relationshipFilterAction(r,t,e,a))}},u.clearDataSelection=function(e,t){e.publishToChannel(w.explore.services.events.dataSelectionChanged,{affectContainer:function(e){return e===t}})},u.createCacheEntry=function(e,t,r,i,a,o,n,s,l){var p;if(o)return(e=e.capabilities(o.visualType))&&(t=u.describeForPinning(t,a,o.query,o.columnProperties,e,n,s))&&(a=d.serializeObjects(o.objects,e.objects,n.serializeSpaceOptimization),(p=i.transforms&&e&&e.objects?w.data.services.DataViewTransformActionsSerializer.serializeDataViewTransformActions(i.transforms,e.objects):{objects:a}).objects=p.objects||a,p.visualElements=t.visualElements,p.queryMetadata=t.queryMetadata),{queryObject:i.options.query.command,dataObject:r,transformsObject:p,dataUpdatedTime:l}},u.uniqueName=function(e){var t={};return p.contracts.traverseVisualContainerGroups(e,(function(e){e.name,t[e.name]=!0})),C(t)},u.nextUniqueName=C,u.getVisualContainerGroups=function(e){var t=[];return p.contracts.traverseVisualContainerGroups(e,(function(e){p.contracts.isVisualContainerGroup(e)&&t.push(e)})),t},u.isInHiddenGroup=function(e){for(var t=e.parentGroup;t;){if(p.contracts.VisualContainerGroup.isHidden(t))return!0;t=t.parentGroup}return!1},u.isVisualHiddenOrInHiddenGroup=function(e){return n.isHidden(e.config.singleVisual)||u.isInHiddenGroup(e)},u.getAbsoluteVisualContainerPosition=function(e,t,r){void 0===t&&(t=0);var i=_.cloneDeep(e),a=r;if(1!==t)for(;a;){if(!a.layouts.withId(t))return i;var o=a.layouts.withId(t).position;i.x+=o.x,i.y+=o.y,a=a.parentGroup}return i},u.getGroupRelativeVisualContainerPosition=function(e,t,r){void 0===r&&(r=0);for(var i=_.cloneDeep(e),a=t.parentGroup;a;){var o=a.layouts.withId(r).position;i.x-=o.x,i.y-=o.y,a=a.parentGroup}return i},u.notifyVisualContainersExceptSource=function(e,t,r,i,a){e.publishToChannel(w.explore.services.events.visualContainerChanged,{affectContainer:function(e){return e!==t},sourceLabelKey:r,parentActivity:i,parentContextActivity:a})},u.notifyVisualContainers=function(e,t,r,i,a){_.isEmpty(t)||e.publishToChannel(w.explore.services.events.visualContainerChanged,{affectContainer:function(e){return _.includes(t,e)},sourceLabelKey:r,parentActivity:i,parentContextActivity:a})},u.createCrossHighlightActivity=function(e,t){return e.createActivity({name:"Cross Highlight",operationType:t})},u.createChangeSlicerActivity=function(e){return e.createActivity({name:"Change Slicer"})},u.hasOnPremDataSource=function(e){return _.some(e,(function(e){return e.dsr&&e.dsr.vsName===w.common.constants.onPremiseVSName}))},u.getTitleFontSize=x,u.getTitleHeight=function(e){var t=x(e),e={fontFamily:e&&e.family||u.DefaultTitleFontFamily,fontSize:t};return w.TextMeasurementService.estimateSvgTextHeight(e)},u.evaluateObjectDefinitions=function(e,t,r,i,a,o,n){var s=r.config.singleVisual.visualType,r=r.config.singleVisual.vcObjects,l=c.getValue(r,{objectName:"stylePreset",propertyName:"name"},void 0),l=((s=t.getVisualObjects(e,s,l&&F.isConstant(l)&&l.value,p.contracts.VisualContainer.CommonObjectDescriptors))&&(r=c.clone(r||{}),c.extend(r,s,!0)),t.getVisualStyle(e)),s=m.evaluateMetadataOnceDataViewObjectDefinitions(r,p.contracts.VisualContainer.CommonObjectDescriptors,l,i,a,o,n);return(t=c.getObjectDefinition(r,"visualLink",void 0))&&t.properties&&t.properties.qna&&(((e=s.dataViewObjects=s.dataViewObjects||{}).visualLink=e.visualLink||{}).qna=t.properties.qna),s},u.setHoverClass=function(e,t){t.toggleClass("showHover",e)},u.notifyContainerHoverEvent=function(e,t,r){e=e?w.common.events.canvasItemContainerShowHover:w.common.events.canvasItemContainerHideHover,r.publishToChannel(e,{containerName:t})},u.getVisualStyleAttributes=function(e,t,r,i,a,o,n){var s={};return s[l.transformProperty]=null!=t?"scale("+t+")":"",s[l.widthProperty]=e.width,s[l.heightProperty]=e.height,s[l.borderProperty]=i||"",s[l.paddingProperty]=o||"",s[l.borderRadiusProperty]=a||"",s[l.backgroundColorProperty]=r||"",s[l.boxShadowProperty]=n||"",s},u.getVisualBackgroundColor=function(e){var t;if(e&&e.show)return t=w.visuals.visualBackgroundHelper.getDefaultValues(),!e.transparency&&0!==e.transparency||(t.transparency=e.transparency),e.color&&e.color.solid.color&&(t.color=e.color),w.common.utils.ColorUtility.applyTransparency(t.color.solid.color,(100-t.transparency)/100)},u.getVisualBorder=function(e,t){return{show:(e||t).show,color:(e&&e.color&&e.color.solid&&e.color.solid.color?e:t).color,radius:e&&e.radius||t.radius}},u.getVisualDropShadow=function(e,t){return{show:(e||t).show,preset:(e&&e.preset?e:t).preset,position:(e&&e.position?e:t).position,color:(e&&e.color&&e.color.solid&&e.color.solid.color?e:t).color,transparency:(e&&void 0!==e.transparency?e:t).transparency,shadowBlur:(e&&void 0!==e.shadowBlur?e:t).shadowBlur,shadowSpread:(e&&void 0!==e.shadowSpread?e:t).shadowSpread,angle:(e&&void 0!==e.angle?e:t).angle,shadowDistance:(e&&void 0!==e.shadowDistance?e:t).shadowDistance}},u.isSegment=function(e){return null!=e&&null!=e.metadata&&null!=e.metadata.segment},u.hasGroupByItems=S,u.hasGroupByItemsInQuery=function(e){return S(u.getVisualQuery(e))},u.containSearchableField=function(e,t,r){var t=u.getDataRolesForVisual(e,t),e=v(e);if(e&&!_.isEmpty(t))return t=t[0].name,e=e.tryGetExprs(t),!_.isEmpty(e)&&!_.some(e,(function(e){e=e.getMetadata(r);if(e)return!e.type.text}))},u.hasFilterMappingWithNonAggregatableColumns=function(e,t,r){if(e=(function(e,t){var r=v(e);if(r){t=f(e,t);if(t&&t.filterMappings&&t.filterMappings.measureFilter&&t.filterMappings.measureFilter.targetRoles){for(var i=t.filterMappings.measureFilter.targetRoles,t=_.chain(t.dataRoles).filter((function(e){return e.kind===w.VisualDataRoleKind.Grouping})).map((function(e){return e.name})).difference(i).value(),a=[],o=0,n=t;o<n.length;o++){var s=n[o];r.projections[s]&&a.push.apply(a,r.projections[s].all())}i=g(e);if(!_.isEmpty(a))return _.chain(i).filter((function(t){return _.some(a,(function(e){return e.queryRef===t.name}))})).map((function(e){return e.expr})).value()}}})(e,r),!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var o=a[i];if(1===j.getAggregateBehavior(o,t))return!0}return!1},u.createRoleKindByQueryRef=I,u.clearExplorationQueryCaches=function(e){for(var t=0,r=e.sections;t<r.length;t++)b(r[t])},u.clearSectionQueryCaches=b,u.markInitialLoadQueriesDirty=function(e){for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++)a[i].disableCacheOnServerForInitialLoad=!0},u.getVisualTypesAndCountsFromSection=function(a){function o(e,t){t=t.config.singleVisual.visualType;e[t]||(e[t]=0),e[t]++}function t(){for(var e=a&&a.visualContainers||[],t={},r=0,i=_.reject(e,(function(e){return n.isHidden(e.config.singleVisual)}));r<i.length;r++)o(t,i[r]);return t}try{var e=a&&a.visualContainerGroups;if(_.isEmpty(e))return t();var r={},i={__hidden:r};return p.contracts.traverseVisualContainerGroups(a.visualContainerGroups,(function(e,t){p.contracts.isVisualContainer(e)&&o(t?r:i,e)})),i}catch(e){return jsCommon.Trace.error("Error getting visuals from groups "+(e&&e.message)+": "+(e&&e.stack)),t()}},u.getAutoVisualFilterContainers=function(e,t,r,i,a){if(void 0===a&&(a=!1),p.FilterUtils.supportsVisualFilters(e,t))return t=p.FilterUtils.supportsMeasureFilters(e,t),e=u.getSelectExprs(e),t||(e=_.filter(e,(function(e){return!j.isMeasure(e.expr)}))),(e=_.filter(e,(function(e){return!F.isNativeVisualCalc(e.expr)})))?_.chain(e).map((function(e){return e.expr})).filter((function(e){return j.isExprValidForFiltering(e)&&_.isEmpty(e.validate(r,i))})).map((function(e){return{name:void 0,expression:e,expanded:!1,howCreated:0,type:p.FilterUtils.getDefaultFilterType(e,r,0),isHiddenInViewMode:a}})).value():void 0},u.getAutoCrossDrillVisualFilterContainers=function(e,t,r,i){return r=r.getDrillCrossFiltersToApply(e,t,i),_.map(r,(function(e){return{name:void 0,type:e.type,filter:e.filter,expression:e.expression,expanded:!1,howCreated:6,precedence:e.precedence}}))},u.getVisualContainerCount=function(e,t){for(var r=0,i=0,a=e.sections;i<a.length;i++)for(var o=0,n=a[i].visualContainers;o<n.length;o++)n[o].config.singleVisual.visualType===t.name&&++r;return r},u.containsCustomVisuals=function(e){var t=e.resourcePackages;if(t)for(var r=0,i=e.sections;r<i.length;r++){var a=i[r];if(a.visualContainers)for(var o=a.visualContainers,n=0,s=t;n<s.length;n++)for(var l=s[n],p=0,u=o;p<u.length;p++){var c=u[p];if(c.config&&c.config.singleVisual&&c.config.singleVisual.visualType){c=c.config.singleVisual.visualType;if(l.name===c)return!0}}}return!1},u.getImprovedFilterExperienceTelemetry=function(e,t){var t={usingImprovedFilterExperience:!0,viewMode:0===t},r=(function(e){if((e=e.objects)&&e.outspacePane)return(e=c.getValue(e,{objectName:"outspacePane",propertyName:"expanded"},null))&&e.value})(e),r=(_.isUndefined(r)||(t.isOutspacePaneExpanded=r),(function(e){if((e=e.objects)&&e.outspacePane)return(e=c.getValue(e,{objectName:"outspacePane",propertyName:"visible"},null))&&e.value})(e));return _.isUndefined(r)||(t.isOutspacePaneVisible=r),t},u.shouldUseQueryCache=function(e,t){return e.id&&!t},u.getExecutionMetricsKind=function(e){return e?3:1},u.wrapContextActivity=function(e,t,r){t&&(i=t.createChildActivity(e));var i,t=r();return i&&i.resolve(),t},u.wrapContextActivityAsync=function(i,a,o){return __awaiter(this,void 0,w.Promise,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return a&&(t=a.createChildActivity(i)),[4,o()];case 1:return r=e.sent(),t&&t.resolve(),[2,r]}}))}))},u.getColumnProperties=E,u.hasVisualColumnRename=function(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];if(p.contracts.isVisualContainer(i)){var a=E(i);if(a)for(var o in a)if(a[o].displayName)return!0}}return!1},u.doesVisualSupportPersonalizeVisuals=function(e,t){return t=u.getVisualType(t),e.isQnaVisual(t)||e.isQueryVisual(t)}})(powerbi=powerbi||{}),(function(u){var r,e,p,a,i,c;function o(e,t,r){if(!t||!t.column||!t.column.groupingMetadata)return 0;if(r){r=r.getGroupingDesignState(e,t.name);if(!r)return 1;if(r.partitionTable)return 3;if(r.binItem)return 2}return 1}function n(e,t,r){if(!t||!t.column||!t.column.groupingMetadata)return!1;r=r.getGroupingDesignState(e,t.name);return!(!r||!r.groupItems&&!r.partitionTable)}function s(e,t){return m(e,t).capabilities.canEdit}function l(e){return e&&!!(e.type.dateTime||e.type.integer||e.type.numeric||e.type.text)}function d(e,t){return _.map(e.groupedColumns,(function(e){if(0===e.kind)return u.data.SQExprBuilder.columnRef(t,e.name)}))}function m(e,t){t=u.data.FieldExprPattern.getSchema(a.asFieldPattern(t));return e.schema(t)}function v(e,t){return p.isGroupRef(e)&&p.isColumn(t)&&g(e,t)?e:p.isGroupRef(t)&&p.isColumn(e)&&g(t,e)?t:p.isGroupRef(e)&&p.isGroupRef(t)?g(e,t)?e:g(t,e)?t:void 0:void 0}function g(e,t){return u.data.SQExprUtils.sequenceEqual(e.groupedExprs,[t])}r=u.explore||(u.explore={}),e=r.utils||(r.utils={}),p=u.data.SQExpr,a=u.data.SQExprConverter,i=jsCommon.StringExtensions,c=u.explore.util.VisualContainerUtils,(e=e.GroupUtils||(e.GroupUtils={})).getGroupMode=o,e.isGroupOrBinColumn=function(e,t,r){return 1===(e=o(e,t,r))||2===e},e.isClusteringColumn=function(e,t,r){return 3===o(e,t,r)},e.isGroupOrClusteringColumn=n,e.canExprBeGrouped=function(e,t){return!(!t||!s(e,t)||!p.isColumn(t)&&!p.isGroupRef(t))&&l(t.getConceptualProperty(e))},e.canEditSchema=s,e.canPropertyBeGrouped=l,e.generateGroupDisplayName=function(e,t){return i.constructNameFromList(e,t.get("GroupDefinition_And"),50)},e.hasGroupOnKeys=function(e){var t;return!!(e&&e.column&&e.column.keys)&&(1===(t=e.column.keys).length&&t[0].name!==e.name||1<t.length)},e.findGroupingColumn=function(e,t){var r=t&&t.defn.select();if(r&&0<r.length&&e)for(var i=0,a=e;i<a.length;i++){var o=a[i];if(!o||!o.dataMap)return;o=Object.keys(o.dataMap);if(2===_.size(o)){var n=r.withName(o[0]),o=r.withName(o[1]);if(n&&o)return v(n.expr,o.expr)}}},e.ensureBlankDefaultPlaceholder=function(e,t){_.some(e,(function(e){return e.blankDefaultPlaceholder}))||e.splice(0,0,{name:t.get("NullValue"),blankDefaultPlaceholder:!0})},e.filterOutBlankDefaultPlaceholder=function(e){return _.filter(e,(function(e){return!e.blankDefaultPlaceholder}))},e.getValidGroupingRules=function(e,t,r){var i=[];if((t=c.getVisualCapabilities(e,t))&&t.grouping){e=c.getVisualQuery(e);if(!e)return i;for(var a=e.projections,o=c.createRoleKindByQueryRef(e),n=0,s=_.filter(t.grouping.groupingRules,(function(e){return e.kind===r}));n<s.length;n++){var l=s[n],p=u.DataViewAnalysis.checkForConditionErrors(a,l.condition,o,!1);_.isEmpty(p)&&i.push(l)}}return i},e.getGroupedColumns=function(e,t,r){var i=a.asFieldPattern(e);if(i.groupingColumn)return _.map(i.groupingColumn.groupedColumns,(function(e){return u.data.SQExprBuilder.fieldExpr(e)}));if(i.column){t=t.schema(i.column.schema).findProperty(i.column.entity,i.column.name);if(n(i.column.entity,t,r))return i=e.getTargetEntity(),d(t.column.groupingMetadata,i)}},e.getGroupedColumnsFromMetadata=d,e.getConceptualSchema=m,e.canGroup=function(e,t){var r=t&&t.defn.select();if(_.isEmpty(r)||_.isEmpty(e))return!1;for(var i=0,a=e;i<a.length;i++){var o=a[i];if(!o||!o.dataMap)return!1;var n=Object.keys(o.dataMap),o=_.size(o.dataMap);if(2<o)return!1;if(2===o){var s=r.withName(n[0]),l=r.withName(n[1]);if(s&&l&&(s=s.expr,l=l.expr,!v(s,l)))return!1}else if(1===o){s=r.withName(n[0]);if(s&&!p.isColumn(s.expr)&&!p.isGroupRef(s.expr))return!1}}return!0},e.getGroupDataType=function(e){return e.dateTime?2:e.numeric?1:0},e.convertToTimeUnit=function(e){switch(e){case 4:return 3;case 6:return 2;case 8:return 0;case 9:return 7;case 10:return 6;case 11:return 5}},e.convertToBinUnit=function(e){switch(e){case 3:return 4;case 2:return 6;case 0:return 8;case 7:return 9;case 6:return 10;case 5:return 11}},e.ensureDataSources=function(e){var t;e.get()||(t=r.contracts.createDataSourceArray([{type:"dsr",id:1,name:void 0,dsr:{schemaName:void 0,vsName:"vsName",dbName:"dbName"}}]),e.set(t))},e.showQueryError=function(e,t){null!=t&&t.getDetails&&(t=t.getDetails(u.common.getLocalize()),e.error(t.message,"GroupDialog",{debugErrorInfo:t.debugErrorInfo,displayableErrorInfo:t.displayableErrorInfo,helpLink:t.helpLink}))}})(powerbi=powerbi||{}),(function(i){var e;(function(e){var r=i.data.SQExpr;function t(e){this.key=[],this.value=[],this.comparer=e}t.prototype.add=function(e,t){this.key.push(e),this.value.push(t)},t.prototype.get=function(e){if(r.isHierarchyLevel(e))for(var t=0;t<this.key.length;t++)if(this.comparer(this.key[t],e))return this.value[t]},e.SQExprToRoleDictionary=t})((e=i.explore||(i.explore={})).utils||(e.utils={}))})(powerbi=powerbi||{}),(function(e){var l,t,r;function i(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=l=e.CanvasListOrderingConstants||(e.CanvasListOrderingConstants={})).negMinOrder=-1,t.posMinOrder=0,t.negMaxOrder=-1e7,t.posMaxOrder=1e7,t.defaultGap=1e3,t.minGap=5,e.createCanvasListOrderNormalizeService=function(){return new r},i.prototype.getContainerListOrders=function(e,t){for(var r={},i=0,a=e;i<a.length;i++){var o=a[i];r[o.name]=t(o)}return r},i.prototype.getSortedContainerNames=function(t,e){e=e?"asc":"desc";return _.chain(t).keys().orderBy((function(e){return t[e]}),e).value()},i.prototype.settingListOrder=function(e,t,r,i){for(var a=0,o=t;a<o.length;a++)e[o[a]]=r,r+=i;return r},i.prototype.checkIfExtremitiesSurpassed=function(e,t,r){var i,a,o,r=r?(i=l.posMinOrder,a=l.posMaxOrder,o=t[_.head(e)]<i,t[_.last(e)]>a):(i=l.negMinOrder,a=l.negMaxOrder,o=t[_.head(e)]>i,t[_.last(e)]<a);return!(!o&&!r)},i.prototype.shouldNormalizeListOrder=function(e,t){var r,i=this.getSortedContainerNames(e,t);if(this.checkIfExtremitiesSurpassed(i,e,t))return!0;if(_.some(e,(function(e){return void 0===e})))return!0;for(var a=0,o=i;a<o.length;a++){var n=e[o[a]];if(null!=r){var s=0<=n==0<=r;if(Math.abs(n-r)<l.minGap&&s)return!0}r=n}return!1},i.prototype.normalizeListOrder=function(e,t){var e=this.getSortedContainerNames(e,t),r=t?l.posMaxOrder-l.posMinOrder:l.negMaxOrder-l.negMinOrder,r=t?Math.min(r/e.length,l.defaultGap):Math.max(r/e.length,-l.defaultGap),t=(Math.abs(r),l.minGap,t?l.posMinOrder:l.negMinOrder),i={};this.settingListOrder(i,e,t,r);return i},r=i,e.CanvasListOrderNormalizeService=r})(powerbi=powerbi||{}),(function(v){var l,p,d,m,u,c,g,h,f,y,s,a,o,r;function C(e,t,r,i,a,o,n){this.aggrOps=e,this.visualPluginService=t,this.visualTimeSynchronizationService=r,this.localizationService=i,this.networkAvailabilityService=a,this.filterOverlayRestatementVisitorFactoryService=o,this.locOptions=null!=n?n:{aggregateDisplayNames:{Sum:this.localizationService.get("DisplayName_Sum"),Avg:this.localizationService.get("DisplayName_Avg"),Count:this.localizationService.get("DisplayName_Count"),Min:this.localizationService.get("DisplayName_Min"),Max:this.localizationService.get("DisplayName_Max"),CountNonNull:this.localizationService.get("DisplayName_CountNonNull"),Median:this.localizationService.get("DisplayName_Median"),StandardDeviation:this.localizationService.get("DisplayName_StandardDeviation"),Variance:this.localizationService.get("DisplayName_Variance"),DateMin:this.localizationService.get("DisplayName_DateMin"),DateMax:this.localizationService.get("DisplayName_DateMax"),StringMin:this.localizationService.get("DisplayName_StringMin"),StringMax:this.localizationService.get("DisplayName_StringMax")},showValueAsDisplayNames:{PercentOfGrandTotal:this.localizationService.get("DisplayName_QuickCalc_PercentOfGrandTotal"),PercentOfGrandTotalTooltip:this.localizationService.get("DisplayName_QuickCalc_PercentOfGrandTotalTooltip"),PercentileExclusive:this.localizationService.get("DisplayName_QuickCalc_PercentileExclusive"),PercentileInclusive:this.localizationService.get("DisplayName_QuickCalc_PercentileInclusive")},qualifiedDisplayNameTemplate:this.localizationService.get("Field_Tooltip"),stringResourceProvider:this.localizationService}}function x(e,t,r,i,a,o,n){this.schema=e,this.locOptions=t,this.aggrOps=r,this.visualCapabilities=i,this.visualTimeSynchronizationService=a,this.networkAvailabilityService=o,this.displayOptions=n}function S(e,t,r,i,a,o,n){this.schema=e,this.locOptions=t,this.aggrOps=r,this.visualCapabilities=i,this.visualTimeSynchronizationService=a,this.networkAvailabilityService=o,this.displayOptions=n}function i(e){this.schema=e}function b(e,t,r,i){return(!r||!r.includeDefaultAggregate)&&i.defaultAggregate(e,t,!1)===e.func}function E(e,t,r,i){t=n(t,r),r=i.aggregateDisplayNames[t];return g.format(r,[e])}function n(e,t){var r=v.data.aggregateFunctionName(e);return(3===e||4===e)&&t&&t.type&&(t.type.dateTime?r="Date"+r:t.type.text&&(r="String"+r)),r}function t(e,t,r,i){e=r.left.arithmetic?i.stringResourceProvider.format("BracketedValue",e):e,t=r.right.arithmetic?i.stringResourceProvider.format("BracketedValue",t):t,r=(function(e){switch(e){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/"}})(r.operator);return i.stringResourceProvider.format("DisplayName_Arithmetic_Format",e,r,t)}l=v.explore||(v.explore={}),p=l.services||(l.services={}),d=v.data.DataViewObjectDefinitions,m=v.explore.util.DisplayNameServiceUtils,u=v.data.FieldExprPattern,c=v.data.FilterPattern,g=v.formattingService,h=v.data.SQExpr,f=v.data.SQExprBuilder,y=jsCommon.StringExtensions,p.createDisplayNameService=function(e,t,r,i,a,o,n){return new s(e,t,r,i,a,o,n)},C.prototype.getOriginalDisplayName=function(e,t,r,i){if(v.data.SQExprConverter.asFieldPattern(e,t))return u.visit(e,new a(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),t)},C.prototype.getDisplayName=function(e,t,r,i,a,o){if(a&&i){a=a[i];if(a&&a.displayName)return a.displayName}return this.getOriginalDisplayName(e,t,r,o)},C.prototype.getQualifiedDisplayName=function(e,t,r,i){if(v.data.SQExprConverter.asFieldPattern(e,t))return o.run(e,t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i)},C.prototype.getFilterRestatement=function(e,t,r,i){e=v.data.SQFilterConverter.asFilterPattern(e,t);if(e&&e[0])return e.length,c.visit(e[0],new p.FilterRestatementVisitor(t,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new a(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),i))},C.prototype.getFilterRestatementForOverlay=function(r,i,a,o,n){var s=this,l=v.data.SQFilterConverter.asFilterPattern(r.filter,i);return l&&l[0]?_.without(_.flatten(l.map((function(e){if(e.condition&&e.condition.complex&&r.restatement)return l.length,{fieldName:"",restatements:[r.restatement],fieldNameToolTip:""};var t=s.filterOverlayRestatementVisitorFactoryService.create(i,s.locOptions,a,s,r,o,n);return c.visit(e,t)}))),void 0):[]},C.prototype.getQualifiedFilterRestatement=function(e,t,r,i){e=v.data.SQFilterConverter.asFilterPattern(e,t);if(e&&e[0])return c.visit(e[0],new p.FilterRestatementVisitor(t,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new o(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),i))},C.prototype.getVisualTitle=function(e,t,r,i,a,o){var n=!!o||!(!r||r.suppressDefaultTitle),s=v.Prototype.inherit(null!=i?i:{show:n});return l.contracts.VisualTitle.isHidden(s)?i:(null==s.show&&(s.show=n),void 0===s.text&&(r?(i=s.titleComponents=this.getRawTitleComponents(e,t,r,a),!(n=this.getTitleText(i))&&o&&(n=this.generateNonQueryTitle(e.visualType)),s.text=n,this.formatTitleComponents(i)):s.text=this.generateNonQueryTitle(e.visualType)),s)},C.prototype.getTitleText=function(e){return e.subtitle?y.format(this.locOptions.stringResourceProvider.get("VisualTitle_By_Template"),e.title,e.subtitle):e.title},C.prototype.generateNonQueryTitle=function(e){var t=this.visualPluginService.getPlugin(e);return t&&t.titleKey?v.data.getDisplayName(t.titleKey,this.locOptions.stringResourceProvider):t&&t.custom?t.displayName||t.name.match(/([A-z\s]+)/g)[0]:t&&t.displayName?t.displayName:e},C.prototype.formatTitleComponents=function(e){e.subtitle&&(e.subtitle=y.format(this.locOptions.stringResourceProvider.get("VisualTitle_By_Template"),"",e.subtitle).trim())},C.prototype.getRawTitleComponents=function(e,t,r,i){var a=d.getValue(e.vcObjects,{objectName:"title",propertyName:"text"},void 0);if(a){if(h.isConstantText(a))return{title:a.value};if(e.evaluatedObjects){a=e.evaluatedObjects.title;if(a&&a.text)return{title:a.text.toString()}}return{title:null}}var o=[],n=[];if(e&&e.query){var s=e.query;if(s.projections&&r&&!r.suppressDefaultTitle&&r.dataRoles)for(var l=0,p=r.dataRoles;l<p.length;l++){var u=p[l];this.populateDisplayNamesByDataRole(u,s,t,r,e.columnProperties,o,n,i)}}var a={},c="AndConjunction";return 0<o.length?(a.title=m.concatStrings(o,c,this.locOptions),0<n.length&&(a.subtitle=m.concatStrings(n,c,this.locOptions))):0<n.length&&(a.title=m.concatStrings(n,c,this.locOptions)),a},C.prototype.getDescription=function(e,t){return r.run(e,t)},C.prototype.populateDisplayNamesByDataRole=function(e,t,r,i,a,o,n,s){var l=t.defn.select(),p=t.projections[e.name];if(p)for(var u=0,c=_.isEmpty(p.activeProjectionRefs)?_.map(p.all(),(function(e){return e.queryRef})):p.activeProjectionRefs;u<c.length;u++){var d=c[u],m=l.withName(d);m&&m.expr&&(m=this.getDisplayName(m.expr,r,i,d,a,s),(e.kind===v.VisualDataRoleKind.Grouping||e.kind!==v.VisualDataRoleKind.Measure&&C.isRoleUsedAsGroup(e,t,r)?n:o).push(m))}},C.isRoleUsedAsGroup=function(e,t,r){e.kind,v.VisualDataRoleKind.GroupingOrMeasure;e=t.projections[e.name];if(e){e=_.head(e.all()),t=t.defn.select().withName(e.queryRef).expr.getMetadata(r);if(t)return 0===t.kind}return!1},s=C,x.prototype.visitColumn=function(e){return x.getDisplayNameForProperty(e,this.schema)},x.prototype.visitColumnAggr=function(e){return x.getDisplayNameForSQAggregate(e,f.fromColumnAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},x.prototype.visitGroupingColumn=function(e){return x.getDisplayNameForProperty(e,this.schema)},x.prototype.visitGroupingColumnAggr=function(e){return x.getDisplayNameForSQAggregate(e,f.fromGroupingColumnAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},x.prototype.visitColumnHierarchyVariation=function(e){return x.getVariationHierarchyName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},x.prototype.visitColumnHierarchyLevelVariation=function(e){return x.getVariationLevelName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},x.prototype.visitColumnSubquery=function(e){},x.prototype.visitColumnAggrSubquery=function(e){},x.prototype.visitColumnTransformRef=function(e){},x.prototype.visitEntity=function(e){return x.getDisplayNameForEntity(e,this.schema)},x.prototype.visitEntityAggr=function(e){return x.getDisplayNameForSQAggregate(e,f.fromEntityAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},x.prototype.visitHierarchy=function(e){return x.getDisplayNameForHierarchy(e,this.schema)},x.prototype.visitHierarchyLevel=function(e){return x.getDisplayNameForHierarchyLevel(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},x.prototype.visitHierarchyLevelAggr=function(e){return x.getDisplayNameForSQAggregate(e,f.fromHierarchyLevelAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},x.prototype.visitMeasure=function(e){return x.getDisplayNameForProperty(e,this.schema)},x.prototype.visitSelectRef=function(e){},x.prototype.visitPercentile=function(e){var t=this.locOptions.showValueAsDisplayNames;return g.format(e.exclusive?t.PercentileExclusive:t.PercentileInclusive,[u.visit(e.arg,this),e.k])},x.prototype.visitPercentOfGrandTotal=function(e){return g.format(this.locOptions.showValueAsDisplayNames.PercentOfGrandTotal,[u.visit(e.baseExpr,this)])},x.prototype.visitPercentOfRoleTotal=function(t){if(this.visualCapabilities,this.visualCapabilities.dataRoleTotals,this.visualCapabilities&&this.visualCapabilities.dataRoleTotals){var e=this.visualCapabilities.dataRoleTotals,e=_.find(e,(function(e){return _.isEqual(t.roles,e.roles)}));if(e)return e=v.data.getDisplayName(e.shortDisplayName,this.locOptions.stringResourceProvider),g.format(e,[u.visit(t.baseExpr,this)])}},x.prototype.visitTransformOutputRoleRef=function(e){return e.expressionName},x.prototype.visitFilteredEval=function(e){for(var t=this.locOptions.stringResourceProvider.get("VisualTitle_For_Template"),r=u.visit(e.baseExpr,this),i=new p.FilterRestatementVisitor(this.schema,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new x(this.schema,this.locOptions,this.aggrOps,this.visualCapabilities,this.visualTimeSynchronizationService,this.networkAvailabilityService,this.displayOptions),this.displayOptions),a=[],o=0,n=e.filters;o<n.length;o++){var s=n[o],s=c.visit(s,i);null!=s&&a.push(s)}if(!_.isEmpty(a))return e=m.concatStrings(a,"FilterRestatement_CompoundAnd",this.locOptions),g.format(t,[r,e])},x.prototype.visitArithmetic=function(e){return t(u.visit(e.left,this),u.visit(e.right,this),e,this.locOptions)},x.prototype.visitConstant=function(e){return v.visuals.valueFormatter.format(e.value,void 0)},x.prototype.visitSparklineData=function(e){return _.size(e.grouping),this.locOptions.stringResourceProvider.format("VisualTitle_By_Template",u.visit(e.measure,this),u.visit(e.grouping[0],this))},x.prototype.visitNativeVisualCalc=function(e){return e.name},x.getDisplayNameForEntity=function(e,t){t=t.schema(e.schema).entities.withName(e.entity);if(t)return t.displayName},x.getDisplayNameForProperty=function(e,t){t=t.schema(e.schema).findProperty(e.entity,e.name);if(t)return t.displayName},x.getDisplayNameForHierarchyLevel=function(e,t,r,i){t=t.schema(e.schema).findHierarchy(e.entity,e.name);if(t){var e=t.levels.withName(e.level);if(e)return e=e.displayName||e.column.displayName,r&&r.includeHierarchyName&&i&&(r=t.displayName,e=y.format(i.get("IncludeVariationSourceDisplayName"),r,e)),e}},x.getDisplayNameForHierarchy=function(e,t){t=t.schema(e.schema).findHierarchy(e.entity,e.name);if(t)return t.displayName},x.getVariationHierarchyName=function(e,t,r,i){var a=t.schema(e.source.schema).findProperty(e.source.entity,e.source.name);if(a)for(var o=0,n=a.column.variations;o<n.length;o++){var s=n[o],l=s.defaultHierarchy;if(s.name===e.variationName&&l&&l.name===e.hierarchy.name)return s=l.displayName,r&&r.includeVariationSource&&i?y.format(i.get("IncludeVariationSourceDisplayName"),a.displayName,s):s}},x.getVariationLevelName=function(e,t,r,i){var a=t.schema(e.source.schema).findProperty(e.source.entity,e.source.name);if(a)for(var o=0,n=a.column.variations;o<n.length;o++){var s=n[o];if(s.name===e.variationName)for(var l=0,p=s.defaultHierarchy.levels;l<p.length;l++){var u=p[l];if(u.name===e.level.level)return u=u.column.displayName,r&&r.includeVariationSource&&i?y.format(i.get("IncludeVariationSourceDisplayName"),a.displayName,u):u}}},x.getDisplayNameForSQAggregate=function(e,t,r,i,a,o,n,s,l){e=r.schema(e.schema).entities.withName(e.entity);if(e)return a=u.visit(t.arg,new x(r,i,n,a,o,l,s)),a?b(t,r,s,n)?a:E(a,t.func,t.arg.getMetadata(r),i):E(e.displayName,t.func,t.arg.getMetadata(r),i)},a=x,p.DisplayNameServiceVisitor=a,S.run=function(e,t,r,i,a,o,n,s){return new S(t,r,i,a,o,n,s).accept(e,t)},S.prototype.accept=function(e,t){var r,i=e;return h.isAggregation(i)?(r=u.visit(i.arg,this),b(i,this.schema,this.displayOptions,this.aggrOps)?r:E(r,i.func,i.arg.getMetadata(this.schema),this.locOptions)):u.visit(e,this,t)},S.prototype.visitEntity=function(e){var t=a.getDisplayNameForEntity(e,this.schema);return this.formatWithEntity(t,e)},S.prototype.visitColumn=function(e){var t=a.getDisplayNameForProperty(e,this.schema);return this.formatWithEntity(t,e)},S.prototype.visitColumnAggr=function(e){},S.prototype.visitGroupingColumn=function(e){var t=a.getDisplayNameForProperty(e,this.schema);return this.formatWithEntity(t,e)},S.prototype.visitGroupingColumnAggr=function(e){},S.prototype.visitColumnHierarchyVariation=function(e){var t=a.getVariationHierarchyName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e.source)},S.prototype.visitColumnHierarchyLevelVariation=function(e){var t=a.getVariationLevelName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e.source)},S.prototype.visitColumnSubquery=function(e){},S.prototype.visitColumnAggrSubquery=function(e){},S.prototype.visitColumnTransformRef=function(e){},S.prototype.visitEntityAggr=function(e){var t=a.getDisplayNameForSQAggregate(e,f.fromEntityAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService);return this.formatWithEntity(t,e)},S.prototype.visitHierarchy=function(e){var t=a.getDisplayNameForHierarchy(e,this.schema);return this.formatWithEntity(t,e)},S.prototype.visitHierarchyLevel=function(e){var t=a.getDisplayNameForHierarchyLevel(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e)},S.prototype.visitHierarchyLevelAggr=function(e){},S.prototype.visitMeasure=function(e){var t=this.locOptions.qualifiedDisplayNameTemplate,r=a.getDisplayNameForProperty(e,this.schema),e=a.getDisplayNameForEntity(e,this.schema);return e?y.format(t,e,r):r},S.prototype.visitSelectRef=function(e){},S.prototype.visitPercentile=function(e){var t=this.locOptions.showValueAsDisplayNames;return g.format(e.exclusive?t.PercentileExclusive:t.PercentileInclusive,[this.accept(f.fieldExpr(e.arg)),e.k])},S.prototype.visitPercentOfGrandTotal=function(e){return g.format(this.locOptions.showValueAsDisplayNames.PercentOfGrandTotalTooltip,[this.accept(f.fieldExpr(e.baseExpr))])},S.prototype.visitPercentOfRoleTotal=function(t){if(this.visualCapabilities,this.visualCapabilities.dataRoleTotals,this.visualCapabilities&&this.visualCapabilities.dataRoleTotals){var e=this.visualCapabilities.dataRoleTotals,e=_.find(e,(function(e){return _.isEqual(t.roles,e.roles)}));if(e)return e=v.data.getDisplayName(e.tooltip,this.locOptions.stringResourceProvider),g.format(e,[this.accept(f.fieldExpr(t.baseExpr))])}},S.prototype.visitTransformOutputRoleRef=function(e){return e.expressionName},S.prototype.visitFilteredEval=function(e){for(var t=this.locOptions.stringResourceProvider.get("VisualTitle_For_Template"),r=this.accept(f.fieldExpr(e.baseExpr)),i=[],a=new p.FilterRestatementVisitor(this.schema,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new S(this.schema,this.locOptions,this.aggrOps,this.visualCapabilities,this.visualTimeSynchronizationService,this.networkAvailabilityService,this.displayOptions),this.displayOptions),o=0,n=e.filters;o<n.length;o++){var s=n[o],s=c.visit(s,a);null!=s&&i.push(s)}if(!_.isEmpty(i))return e=m.concatStrings(i,"FilterRestatement_CompoundAnd",this.locOptions),g.format(t,[r,e])},S.prototype.visitArithmetic=function(e){return t(this.accept(f.fieldExpr(e.left)),this.accept(f.fieldExpr(e.right)),e,this.locOptions)},S.prototype.visitConstant=function(e){return v.visuals.valueFormatter.format(e.value,void 0)},S.prototype.visitSparklineData=function(e){return _.size(e.grouping),this.locOptions.stringResourceProvider.format("VisualTitle_By_Template",this.accept(f.fieldExpr(e.measure)),this.accept(f.fieldExpr(e.grouping[0])))},S.prototype.visitNativeVisualCalc=function(e){return e.name},S.prototype.formatWithEntity=function(e,t){var r=this.locOptions.qualifiedDisplayNameTemplate,t=a.getDisplayNameForEntity(t,this.schema);return t?y.format(r,t,e):e},o=S,p.QualifiedDisplayNameVisitor=o,i.run=function(e,t){t=new i(t);return u.visit(e,t)},i.prototype.visitColumn=function(e){return this.getPropertyDescription(e)},i.prototype.visitColumnAggr=function(e){return this.getPropertyDescription(e)},i.prototype.visitGroupingColumn=function(e){return this.getPropertyDescription(e)},i.prototype.visitGroupingColumnAggr=function(e){return this.getPropertyDescription(e)},i.prototype.visitColumnHierarchyVariation=function(e){e=e.hierarchy,e=this.findHierarchy(e);if(e)return e.description},i.prototype.visitColumnHierarchyLevelVariation=function(e){return this.getHierarchyLevelDescription(e.level)},i.prototype.visitColumnSubquery=function(e){},i.prototype.visitColumnAggrSubquery=function(e){},i.prototype.visitColumnTransformRef=function(e){},i.prototype.visitEntity=function(e){return this.getEntityDescription(e)},i.prototype.visitEntityAggr=function(e){return this.getEntityDescription(e)},i.prototype.visitHierarchy=function(e){e=this.findHierarchy(e);if(e)return e.description},i.prototype.visitHierarchyLevel=function(e){return this.getHierarchyLevelDescription(e)},i.prototype.visitHierarchyLevelAggr=function(e){return this.getHierarchyLevelDescription(e)},i.prototype.visitMeasure=function(e){return this.getPropertyDescription(e)},i.prototype.visitPercentile=function(e){return u.visit(e.arg,this)},i.prototype.visitPercentOfGrandTotal=function(e){return u.visit(e.baseExpr,this)},i.prototype.visitPercentOfRoleTotal=function(e){return u.visit(e.baseExpr,this)},i.prototype.visitSelectRef=function(e){},i.prototype.visitTransformOutputRoleRef=function(e){},i.prototype.visitFilteredEval=function(e){},i.prototype.visitArithmetic=function(e){},i.prototype.visitConstant=function(e){},i.prototype.visitSparklineData=function(e){},i.prototype.visitNativeVisualCalc=function(e){},i.prototype.getPropertyDescription=function(e){var t=this.schema.schema(e.schema);if(t)return t=t.findProperty(e.entity,e.name),t&&t.description},i.prototype.getEntityDescription=function(e){var t=this.schema.schema(e.schema);if(t)return t=t.entities.withName(e.entity),t&&t.description},i.prototype.getHierarchyLevelDescription=function(e){var t=this.findHierarchy(e);if(t)return t=t.levels.withName(e.level),t&&t.description},i.prototype.findHierarchy=function(e){var t=this.schema.schema(e.schema);if(t)return t.findHierarchy(e.entity,e.name)},r=i,p.getAggregateKey=n})(powerbi=powerbi||{}),(function(e){var i;e=(e=e.explore||(e.explore={})).util||(e.util={}),(i=e.DetailVisualUtils||(e.DetailVisualUtils={})).DetailVisualBorder=10,i.supportsVisualDetails=function(e,t,r){return!(!(t=t.capabilities(e))||!r.isQueryVisual(e)||r.isAnalysisVisual(e))&&(!t.disableVisualDetails&&_.some(t.dataViewMappings,(function(e){return e.categorical||e.matrix||e.table||e.tree})))},i.getDetailVisualViewport=function(e,t){var r,t=1===(t||1)?(r=e.width-2*i.DetailVisualBorder,e.height-i.DetailVisualBorder):(r=e.width-i.DetailVisualBorder,e.height-2*i.DetailVisualBorder);return{width:Math.max(r,0),height:Math.max(t,0),scale:e.scale}},i.takeOutSpaceFromViewport=function(e,t,r){return{width:Math.max(e.width-r,0),height:Math.max(e.height-t,0),scale:e.scale}}})(powerbi=powerbi||{}),(function(u){var e,r,i,d,a,p,c,o;function t(e,t,r,i){this.eventBridge=e,this.visualPlugin=t,this.visualPluginOps=r,this.runningVisualService=i}e=u.explore||(u.explore={}),r=e.services||(e.services={}),i=u.explore.util.DetailVisualUtils,d=u.explore.util.DrillUtils,a=jsCommon.EnumExtensions,p=u.visuals.plugins,c=e.util.VisualContainerUtils,r.createDrillService=function(e,t,r,i){return new o(e,t,r,i)},t.prototype.getSupportedDrillDirections=function(e,t){var r=this.getProjections(e);if(!r)return 0;t=t?[t]:[];if(_.isEmpty(t)){var i=e.config.singleVisual,i=this.visualPlugin.capabilities(i.visualType);if(!i||i.drilldown&&i.drilldown.suppresDrillOperations)return 0;t=d.getDrillableRoles(i)}for(var a=0,o=0,n=t;o<n.length;o++){var s,l,p,u=n[o],c=r[u];c&&c.activeProjectionRefs&&1!==(s=c.all()).length&&(l=c.activeProjectionRefs,p=this.findActiveProjectionIndexInQueryCollection(s,l),_.isEmpty(l)||p+l.length===s.length||(this.canDrillDownLevel(e,2,u)&&(a|=2),this.canDrillDownLevel(e,3,u)&&(a|=4)),!_.isEmpty(c.activeProjectionRefs)&&(0!==p||1<l.length)&&(a|=1))}return a},t.prototype.setDrillMode=function(e,t){e&&e.drillMode!==t&&(e.drillMode=t,this.raiseDrillModeChanged(e,t))},t.prototype.canSeeData=function(e){if(!(e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query))return!1;var t=c.getVisualType(e),e=this.runningVisualService.getVisual(e);return!(e&&!!e.getErrorInfo())&&i.supportsVisualDetails(t,this.visualPlugin,this.visualPluginOps)},t.prototype.canDrillToDetails=function(e,t){if(!e)return!1;var r=c.getVisualQuery(e);if(!r)return!1;var i=c.getVisualType(e);if(i===p.lineChart.name||i===p.areaChart.name||i===p.stackedAreaChart.name)return!1;i=c.getVisualCapabilities(e,this.visualPlugin);if(!i||!1===i.supportsSelection)return!1;var a=_(c.getSelectExprs(e)).filter((function(e){return u.data.SQExpr.isAggregation(e.expr)})).map((function(e){return e.name})).value();if(_.isEmpty(a))return!1;if(!_.isEmpty(t)&&!_.includes(a,_.head(_.head(t).metadata)))return!1;e=i.dataRoles;if(_.isEmpty(e))return!1;for(var o=0,n=0,s=_(e).filter((function(e){return e.kind===u.VisualDataRoleKind.Measure&&0!==e.joinPredicate})).map((function(e){return e.name})).value();n<s.length;n++){var l=s[n],l=r.projections[l];if(!_.isEmpty(l)){if(1<++o)return!1;l=l.all();if(_.some(l,(function(e){return!_.includes(a,e.queryRef)})))return!1}}return 0!==o},t.prototype.canDrillByDirection=function(e,t,r){if(!e)return!1;var i=this.runningVisualService.getVisual(e);if(i&&!!i.getErrorInfo())return!1;i=this.getSupportedDrillDirections(e,r);return!!i&&a.hasFlag(i,t)},t.prototype.canDrillthrough=function(e){return!!e},t.prototype.isDrillModeEnabled=function(e,t){return!!e&&e.drillMode===t},t.prototype.canDrillDownLevel=function(r,i,a){var o=c.getVisualQuery(r);if(!o)return!1;var e=c.getVisualCapabilities(r,this.visualPlugin);if(!e)return!1;if(e.drilldown&&e.drilldown.suppresDrillOperations)return!1;if(!a)return!1;var n=o.projections[a],t=n.getLastActiveQueryReference();if(!t)return!1;for(var s=_.findIndex(n.all(),(function(e){return e.queryRef===t})),l=0;l<s;l++){var p=(function(e){var e=n.all()[e],t=o.defn.select().withName(e.queryRef).expr;if(0===_.filter(r.filters,(function(e){return r.name,null!=e&&2===e.howCreated&&u.data.SQExpr.equals(t,e.expression)})).length)return{value:o.currentDrillMode(a)===i}})(l);if("object"==typeof p)return p.value}return 3!==i||!_.find(o.expansionStates,(function(e){return _.find(e.roles,(function(e){return e===a}))&&e.isStateModified()}))},t.prototype.getProjections=function(e){return e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query&&e.config.singleVisual.query.projections},t.prototype.findActiveProjectionIndexInQueryCollection=function(e,t){if(!_.isEmpty(t))for(var r=0;r<e.length;r++){for(var i=r,a=0;a<t.length&&i<e.length&&t[a]===e[i].queryRef;)a++,i++;if(a===t.length)return r}return-1},t.prototype.raiseDrillModeChanged=function(e,t){this.eventBridge.publishToChannel(r.events.drillModeChanged,{visualContainer:e})},o=t})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=e.SectionNavigationAction||(e.SectionNavigationAction={}))[t.Unknown=0]="Unknown",t[t.Swipe=1]="Swipe",(t=e.events||(e.events={})).modelChangeApplyingUpdate={type:4,name:"modelChangeApplyingUpdate"},t.explorationLoaded={type:1,name:"explorationLoaded"},t.explorationUnloaded={type:1,name:"explorationUnloaded"},t.explorationContainerReady={type:3,name:"explorationContainerReady"},t.explorationSlowDataSourceSettingsLoaded={type:1,name:"explorationSlowDataSourceSettingsLoaded"},t.explorationSettingsLoaded={type:1,name:"explorationSettingsLoaded"},t.updateNavButtonEvent={type:1,name:"updateNavButtonEvent"},t.userActionTriggered={type:2,name:"userActionTriggered"},t.filterContainerChanged={type:2,name:"filterContainerChanged"},t.applyAllBufferedFilterCardChanged={type:1,name:"applyAllBufferedFilterCardChange"},t.applyAllClicked={type:1,name:"applyAllClicked"},t.explorationFiltersContainerChanged={type:1,name:"explorationFiltersContainerChanged"},t.sectionFiltersContainerChanged={type:1,name:"sectionFiltersContainerChanged"},t.sectionDrillthroughLinkChanged={type:1,name:"sectionDrillthroughLinkChanged"},t.formFactorChanged={type:1,name:"formFactorChanged"},t.canvasLayoutChanged={type:1,name:"canvasLayoutChanged"},t.modelChanging={type:0,name:"modelChanging"},t.modelChanged={type:0,name:"modelChanged"},t.visualRelationshipsModeChanged={type:2,name:"visualRelationshipsModeChanged"},t.schemaItemActivationChanged={type:0,name:"schemaItemActivationChanged"},t.selectionChanged={type:2,name:"selectionChanged"},t.visualTypeChanged={type:2,name:"visualTypeChanged"},t.visualLinkButtonClicked={type:2,name:"visualLinkButtonClicked"},t.dataPointsSelected={type:2,name:"dataPointsSelected"},t.dataHyperlinkClicked={type:2,name:"dataHyperlinkClicked"},t.visualClicked={type:2,name:"visualClicked"},t.undoRedoStackUpdated={type:1,name:"undoRedoStackUpdated"},t.undoRedoStackCleared={type:1,name:"undoRedoStackCleared"},t.onReportChanged={type:1,name:"onReportChanged"},t.onReportChangedGlobal={type:4,name:"onReportChanged"},t.clipboardDataUpdated={type:1,name:"clipboardDataUpdated"},t.dataSelectionChanged={type:2,name:"dataSelectionChanged"},t.drillModeChanged={type:2,name:"drillModeChanged"},t.refreshExploration={type:2,name:"refreshExploration"},t.clearAnnotations={type:2,name:"clearAnnotations"},t.saveReportCompleted={type:0,name:"saveReportCompleted"},t.customSaveAsTriggered={type:0,name:"customSaveAsTriggered"},t.sectionLayoutRemoved={type:1,name:"sectionLayoutRemoved"},t.canvasChanged={type:1,name:"canvasChanged"},t.visualContainerParentActivityLinkingDone={type:2,name:"visualContainerParentActivityLinkingDone"},t.fieldWellFieldRemovedEvent={type:2,name:"fieldWellFieldRemoved"},t.visualContainerChanged={type:2,name:"visualContainerChanged"},t.visualContainerAdded={type:2,name:"visualContainerAdded"},t.cancelVisualQuery={type:2,name:"cancelVisualQuery"},t.dataRefreshTriggered={type:2,name:"triggerDataRefresh"},t.visualContainerGroupChanged={type:2,name:"visualContainerGroupChanged"},t.visualContainerGroupRendered={type:2,name:"visualContainerGroupRendered"},t.visualContainerDataRenderingStarted={type:2,name:"visualContainerDataRenderingStarted"},t.visualContainerDataRendered={type:2,name:"visualContainerDataRendered"},t.canvasItemContainerPositionChanged={type:2,name:"canvasItemContainerPositionChanged"},t.visualContainerLoadingStarted={type:2,name:"visualContainerLoadingStarted"},t.visualContainerLoadingStopped={type:2,name:"visualContainerLoadingStopped"},t.visualConversion={type:2,name:"visualConversion"},t.focusExplorationEvent={type:3,name:"focusExplorationEvent"},t.focusVisualContainerEvent={type:2,name:"focusVisualContainerEvent"},t.canvasSizeChangedEvent={type:2,name:"canvasSizeChanged"},t.visualPluginsChanged={type:2,name:"visualPluginsChanged"},t.addCustomVisual={type:2,name:"addCustomVisual"},t.deleteCustomVisual={type:2,name:"deleteCustomVisual"},t.modelingContextChanged={type:0,name:"modelingContextChanged"},t.changeViewMode={type:2,name:"changeViewMode"},t.requestViewModeChange={type:2,name:"requestViewModeChange"},t.editModeChanged={type:2,name:"editModeChanged"},t.getClusters={type:2,name:"getClusters"},t.toggleSortVisualContainer={type:2,name:"toggleSortVisualContainer"},t.toggleSortDirectionVisualContainer={type:2,name:"toggleSortDirectionVisualContainer"},t.saveKeyPressedEvent={type:1,name:"saveEventViaCtrlS"},t.highContrastModeChanged={type:1,name:"highContrastModeChanged"},t.canvasDisplayChanged={type:1,name:"canvasDisplayChanged"},t.canvasZoomChanged={type:1,name:"canvasZoomChanged"},t.canvasZoomScaleUpdated={type:1,name:"canvasZoomScaleUpdated"},t.canvasDimensionChanged={type:1,name:"canvasDimensionChanged"},t.explorationObjectsLoaded={type:3,name:"explorationObjectsLoaded"},t.explorationObjectsChanged={type:3,name:"explorationObjectsChanged"},t.sectionObjectsEvaluated={type:1,name:"sectionObjectsEvaluated"},t.sectionObjectsChanged={type:1,name:"sectionObjectsChanged"},t.datasourceVariablesEditClicked={type:3,name:"showDataSourceVariablesDialog"},t.themeDialogButtonClicked={type:3,name:"showThemeDialog"},t.visibilityChanged={type:2,name:"visibilityChanged"},t.editVisualCalculation={type:2,name:"editVisualCalculation"},t.canvasItemHiddenChanged={type:2,name:"canvasItemHiddenChanged"},t.align={type:1,name:"align"},t.deleteSectionInitiated={type:1,name:"deleteSectionInitiated"},t.sectionNameChanged={type:1,name:"sectionNameChanged"},t.sectionDeleted={type:1,name:"sectionDeleted"},t.renameSection={type:1,name:"renameSection"},t.sectionChanged={type:1,name:"sectionChanged"},t.podParameterChanged={type:1,name:"podParameterChanged"},t.missingTableRelationship={type:2,name:"missingTableRelationship"},t.addVisualContainer={type:1,name:"addVisualContainer"},t.addCustomVisualToCanvas={type:3,name:"addCustomVisualToCanvas"},t.deleteVisualContainer={type:2,name:"deleteVisualContainer"},t.addInsightContainer={type:1,name:"addInsightContainer"},t.addQnaContainer={type:1,name:"addQnaContainer"},t.showQnaPopout={type:1,name:"showQnaPopoutEventArgs"},t.canvasPinched={name:"canvasPinched",type:1},t.changeFormFactor={name:"changeFormFactor",type:1},t.arrangeVisualsOrder={type:1,name:"arrangeVisualsOrder"},t.createImage={type:1,name:"createImage"},t.createBasicShape={type:1,name:"createBasicShape"},t.createShape={type:1,name:"createShape"},t.createActionButton={type:1,name:"createActionButton"},t.createNavigator={type:1,name:"createPageNavigator"},t.createTextbox={type:1,name:"createTextbox"},t.importVisual={type:1,name:"importVisual"},t.addManagedCustomVisual={type:4,name:"addManagedCustomVisual"},t.installVisual={type:1,name:"installVisual"},t.downloadVisual={type:1,name:"downloadVisual"},t.newQueryCacheResultAvailable={type:2,name:"newQueryCacheResultAvailable"},t.exportVisualData={type:2,name:"exportVisualData"},t.exportVisualDataFromPane={type:1,name:"exportVisualDataFromPane"},t.addCommentVisual={type:2,name:"addCommentVisual"},t.shareToTeamsVisual={type:2,name:"shareToTeamsVisual"},t.reportSlidesChanged={type:1,name:"reportSlidesChanged"},t.createSection={type:1,name:"createSection"},t.deleteSection={type:1,name:"deleteSection"},t.duplicateSection={type:1,name:"duplicateSection"},t.insertSection={type:1,name:"insertSection"},t.reorderSection={type:1,name:"reorderSection"},t.switchSection={type:1,name:"switchSection"},t.explorationNextPage={type:3,name:"explorationNextPage"},t.explorationPreviousPage={type:3,name:"explorationPreviousPage"},t.startExplorationContainerLoading={type:3,name:"startExplorationContainerLoading"},t.stopExplorationContainerLoading={type:3,name:"stopExplorationContainerLoading"},t.copyTable={type:1,name:"copyDataTable"},t.showEnableScriptVisualsDialog={type:2,name:"showEnableScriptVisualsDialog"},t.CanvasResized={type:1,name:"canvasResized"},t.openReportFinished={type:4,name:"openReportFinished"},t.openReportLoadingScreenHidden={type:4,name:"openReportLoadingScreenHidden"},t.visualQueryThrottled={type:4,name:"visualQueryThrottled"},t.datasetNotFound={type:4,name:"datasetNotFound"},t.ShowVisuals={type:4,name:"ShowVisuals"},t.bookmarkApplied={type:1,name:"bookmarkApplied"},t.exploreCanvasVisualRendered={type:1,name:"exploreCanvasVisualRendered"},t.reportVisualError={type:2,name:"ReportVisualError"},t.reportVisualErrorGlobal={type:4,name:"ReportVisualError"},t.visualThumbnailDoubleClicked={type:3,name:"visualThumbnailDoubleClicked"},t.removeVisualContainerFromLayout={type:2,name:"removeVisualContainerFromLayout"},t.pauseQueriesChanged={type:1,name:"pauseQueriesChanged"},t.deleteVisual={type:2,name:"deleteVisual"},t.deleteCustomVisuals={type:2,name:"deleteCustomVisuals"},t.resetPersistentUserState={type:4,name:"resetPersistentUserState"},t.resetUserStateKeyPressedEvent={type:1,name:"resetUserStateKeyPressedEvent"},t.resetUserStateEvent={type:4,name:"resetUserStateEvent"},t.reloadPersistenState={type:3,name:"reloadPersistenState"},t.togglePaneVisibility={type:1,name:"togglePaneVisibility"},t.visualDrillFilterOtherVisualsSettingChanged={type:2,name:"visualDrillFilterOtherVisualsSettingChanged"},t.emulationChanged={type:0,name:"emulationChanged"},t.showOtherBookmarks={type:3,name:"showOtherBookmarks"},t.parentExpandCollapseAction={type:2,name:"parentExpandCollapseAction"},t.bookmarkViewStateChanged={type:3,name:"bookmarkViewStateChanged"},t.exportDataStarted={type:0,name:"exportDataStarted"},t.exportDataEnded={type:0,name:"exportDataEnded"},t.visualContainerControllerLinked={type:2,name:"visualContainerControllerLinked"},t.insightsInFocusPaneClose={type:4,name:"insightsInFocusPaneClose"},t.pinInsightContainer={type:4,name:"pinInsightContainer"},t.insightSelected={type:4,name:"insightSelected"},t.getRelatedInsights={type:4,name:"getRelatedInsights"},t.viewInsightInFocus={type:4,name:"viewInsightInFocus"},t.autoPageRefreshTriggered={type:0,name:"autoPageRefreshTriggered"},t.drillthroughActionTriggered={type:2,name:"drillthroughActionTriggered"},t.anchorTimeUpdated={type:4,name:"anchorTimeUpdated"},t.visualCancelLoadEvent={type:4,name:"visualCancelLoadEvent"},t.shareVisual={type:2,name:"shareVisual"},t.saveAsExploration={name:"saveAsExploration"},t.generateReportQR={name:"generateReportQR"},t.saveExploration={name:"saveExploration"},t.saveReportFromPinDialogEvent={type:4,name:"saveReportFromPinDialog"},t.findAnomalies={type:2,name:"findAnomalies"},t.forecast={type:2,name:"forecast"},t.toggleDataTable={type:2,name:"toggleDataTable"},t.affectsVisualContainer=function(e,t){return e.visualContainer===t}})(powerbi=powerbi||{}),(function(i){var e,t,l,p,u,r;function a(e){this.visualPlugin=e}e=i.explore||(i.explore={}),t=e.services||(e.services={}),l=i.data.ExpansionState,p=i.data.Selector,u=e.util.VisualContainerUtils,t.createExpandCollapseService=function(e,t){return new r(e)},a.prototype.getExpandCollapseRoles=function(e){i.contract.checkValue(e,"visual should have a value");e=this.visualPlugin.capabilities(u.getVisualType(e));if(e&&e.expandCollapse&&!_.isEmpty(e.expandCollapse.roles))return e.expandCollapse.roles},a.prototype.isSupported=function(e,t,r){if(!t||!e||!e.supportsInstanceFilters)return!1;var i=u.getVisualQuery(t);return!!i&&!(!_.isEmpty(r)&&_.some(r,(function(e){return 3===i.currentDrillMode(e)})))},a.prototype.isEnabled=function(e,t){if(i.contract.checkValue(e,"visual should have a value"),_.isEmpty(t))return!1;var r=this.getExpandCollapseRoles(e);return!_.isEmpty(r)&&!_.some(t,(function(e){return-1===_.indexOf(r,e)}))},a.prototype.getMaximumExpansionDepth=function(e,t){if(this.isEnabled(e,t)){e=u.getVisualQuery(e);if(e)return e.getRolesProjectionRefs(t).length}},a.prototype.getAllowedActions=function(e,t,r){var i=u.getVisualQuery(e);if(i&&this.isEnabled(e,t)&&!_.isEmpty(r)&&1===r.length){r=r[0];if(r&&r.dataMap&&!_.isEmpty(r.dataMap)){var a=p.toScopeIdentities(p.convertSelectorsByColumnToSelector(r));if(!_.isEmpty(a)){var o=i.getRolesUniqueProjectionRefs(t),n=i.getRolesUniqueActiveProjectionsRefs(t,this.canCollapseRoot(e)),e=n.length===o.length,s=_.some(t,(function(e){return 3===i.currentDrillMode(e)}));if(1===o.length||s)return{};var s=this.getSelectorRefs(r);return _.some(s,(function(e){return!_.includes(n,e)}))?void 0:(s=(r=a.length)===o.length,o=r===n.length,(r=l.findExpansionState(i.expansionStates,t))?(t=r.getNodeLevelState(a,r.root,0),{expandNode:!s&&!!t.isNodeCollapsed,collapseNode:!o&&!t.isNodeCollapsed,expandLevel:!s&&(t.levelHasToggledNodes||!!t.isNodeCollapsed),collapseLevel:!o&&(t.levelHasToggledNodes||!t.isNodeCollapsed),expandHierarchy:!e||!r.isHierarchyExpanded(),collapseHierarchy:!r.isWholeLevelCollapsed(0)}):{expandNode:!s&&o,collapseNode:!o,expandLevel:!s&&o,collapseLevel:!o,expandHierarchy:!e,collapseHierarchy:1<n.length})}}}},a.prototype.getSelectorRefs=function(e){if(!e||!e.dataMap||_.isEmpty(e.dataMap))return[];var t,r=[];for(t in e.dataMap)r.push(t);return r},a.prototype.expandNode=function(e,t,r){var i,a=this.setNodeState(e,t,r,!1);a&&(i=this.ensureExpansionState(e,t),r=this.getSelectorRefs(r),this.canCollapseRoot(e)||_.isEmpty(r),r=r.length-1,i=i.getVisibleDescendentsDepth(a,r),(a=u.getVisualQuery(e))&&a.getRolesUniqueActiveProjectionsRefs(t,this.canCollapseRoot(e)).length<i&&this.setActiveProjections(e,t,i))},a.prototype.collapseNode=function(e,t,r){this.setNodeState(e,t,r,!0);r=this.ensureExpansionState(e,t),r=r.getVisibleDescendentsDepth(r.root,-1);this.setActiveProjections(e,t,r)},a.prototype.expandLevel=function(e,t,r,i){void 0===i&&(i=!1);var a=this.ensureExpansionState(e,t),r=(this.setLevelState(e,t,r,!1,i),a.getVisibleDescendentsDepth(a.root,-1));this.setActiveProjections(e,t,r)},a.prototype.collapseLevel=function(e,t,r,i){this.setLevelState(e,t,r,!0,i=void 0===i?!1:i),this.setActiveProjections(e,t,r+1)},a.prototype.expandAll=function(e,t){this.setAllLevelsState(e,t,!1);var r=this.ensureExpansionState(e,t).levels.length;this.setActiveProjections(e,t,r)},a.prototype.collapseAll=function(e,t){this.setAllLevelsState(e,t,!0),this.setActiveProjections(e,t,this.canCollapseRoot(e)?0:1)},a.prototype.pinLevels=function(e,t,r){this.ensureExpansionState(e,t).pinLevels(r)},a.prototype.unpinLevels=function(e,t,r){this.ensureExpansionState(e,t).unpinLevels(r)},a.prototype.lockLevels=function(e,t,r){this.ensureExpansionState(e,t).lockLevels(r)},a.prototype.unlockLevels=function(e,t,r){this.ensureExpansionState(e,t).unlockLevels(r)},a.prototype.setAILevelInformation=function(e,t,r,i,a){e=this.ensureExpansionState(e,t);_.isEqual(e.levels[r].queryRefs,i),e.setAILevelInformation(r,a)},a.prototype.getAILevelInformation=function(e,t,r){e=u.getVisualQuery(e);return l.getAILevelInformation(e.expansionStates,t,r)},a.prototype.clearAILevelsInformation=function(e,t){for(var r=this.ensureExpansionState(e,t),i=0;i<_.size(r.levels);i++)r.setAILevelInformation(i,void 0)},a.prototype.setNodeState=function(e,t,r,i){var t=this.ensureExpansionState(e,t),a=this.getSelectorRefs(r);if(!_.isEmpty(a)||this.canCollapseRoot(e))return a.length,t.levels.length,t.setNodeState(p.convertSelectorsByColumnToSelector(r),i)},a.prototype.setLevelState=function(e,t,r,i,a){var o=this.ensureExpansionState(e,t);if(o.levels,a)for(var n=0;n<r;n++)o.levels[n],o.setLevelState(n,!1);o.setLevelState(r,i)},a.prototype.setAllLevelsState=function(e,t,r){for(var i=this.ensureExpansionState(e,t),a=(i.levels,this.canCollapseRoot(e)&&i.setLevelState(-1,r),i.levels),o=0;o<a.length-1;o++)i.setLevelState(o,r)},a.prototype.ensureExpansionState=function(e,t){this.isEnabled(e,t);var r=u.getVisualQuery(e),i=this.visualPlugin.capabilities(u.getVisualType(e)),a=i&&i.expandCollapse&&i.expandCollapse.supportsMerge,i=i&&i.expandCollapse&&i.expandCollapse.collapseParentAfterRemovingChildLevel,e=this.canCollapseRoot(e),r=r.ensureExpansionState(t,{supportsMerge:a,canCollapseRoot:e,collapseParentAfterRemovingChildLevel:i});return r.levels,r},a.prototype.canCollapseRoot=function(e){e=this.visualPlugin.capabilities(u.getVisualType(e));return!(!e||!e.noDefaultProjections)},a.prototype.setActiveProjections=function(e,t,r){this.canCollapseRoot(e);e=u.getVisualQuery(e);e.setActiveProjections(t,r)},r=a})(powerbi=powerbi||{}),(function(p){var u,e;function c(e,t,r){t&&(e.usageReportSection=r&&r.isNewUsageMetrics?t.displayName:void 0),r&&(e.isNewUsageMetrics=r.isNewUsageMetrics,e.isUsageMetrics=r.isUsageMetrics)}u=p.explore||(p.explore={}),((e=u.util||(u.util={})).ExplorationTelemetryUtil||(e.ExplorationTelemetryUtil={})).addExplorationInfoToEvent=function(e,t){var r,i,a,o={},n=t.getCurrentSection(),s=t.getCurrentExploration(),l=t.getExplorationTelemetryData();switch(n&&(o={activeSectionId:n.id,sectionGuid:n.objectId,sectionIndex:s&&s.activeSectionIndex},e.name!==p.telemetry.EXOpenExplorationEventName&&e.name!==p.telemetry.EXSwitchSectionEventName&&e.name!==p.telemetry.EXSwitchToAdjacentSectionEventName&&e.name!==p.telemetry.EXNavigateBackEventName&&e.name!==p.telemetry.EXNavigationButtonClickedEventName||(o.visualTypesAndCounts=JSON.stringify(u.util.VisualContainerUtils.getVisualTypesAndCountsFromSection(n)))),l&&(o.modelId=l.modelId,o.reportGuid=l.reportGuid,o.dataCacheMode=l.dataCacheMode,o.datasetHost=l.datasetHost,o.dbName=l.dbName,o.enterpriseCapacitySkuTier=l.enterpriseCapacitySkuTier,o.isDirectQuery=l.isDirectQuery,o.isOnPrem=l.isOnPrem,o.exid=l.exid,o.exsid=l.exsid),e.name){case p.telemetry.EXOpenExplorationEventName:r=o,(i=s)&&!_.isEmpty(i.sections)&&(r.areAnySectionQuickExplore=u.SectionUtils.areAnySectionQuickExplore(i.sections),r.creationSource=i.creationSource),c(o,n,l);break;case p.telemetry.EXSwitchSectionEventName:c(o,n,l)}_.isEmpty(o)||(a=e.formatted||function(){return{}},e.formatted=function(){return p.extendFormatted(a.apply(e),o)})}})(powerbi=powerbi||{}),(function(e){var v,t;function r(e){this.localization=e}((v=e.explore||(e.explore={})).services||(v.services={})).createFederatedSchemaValidator=function(e){return new t(e)},r.prototype.validate=function(e){if(e)for(var t=v.util.createNameValidator(e,this.localization),r=0,i=e.schemas;r<i.length;r++){var a=i[r];if(a.isExtensionSchema)for(var o=e.schema(a.extends),n=0,s=a.entities;n<s.length;n++){var l=s[n],p=!1;o.entities.withName(l.name)||(p=!0,l.errorMessage=this.localization.get("ReportMeasuresMissingTableErrorMessage"),l.queryable=1,l.isAbandoned=!0);for(var u=0,c=l.properties;u<c.length;u++){var d,m=c[u];1===m.kind&&((d=t.validateExistingMeasureName(m)).error===v.util.NameValidationError.DuplicatedName?(m.errorMessage=d.reason,m.queryable=1):p&&(m.errorMessage=this.localization.get("ReportMeasuresMissingTableMeasureErrorMessage"),m.queryable=1))}}}},t=r})(powerbi=powerbi||{}),(function(f){var s,m,l,t,p,v,a,y,n,o,u,C,c;function e(e,t,r,i,a,o,n,s){this.eventBridge=e,this.visualPlugins=t,this.aggrOps=r,this.relationshipService=i,this.hostFilters=a,this.telemetryService=o,this.scriptVisuals=n,this.featureSwitchService=s,this.eventBridge,this.visualPlugins,this.aggrOps,this.relationshipService,this.hostFilters,this.telemetryService,this.scriptVisuals}s=f.explore||(f.explore={}),m=s.services||(s.services={}),l=f.explore.contracts.CollectedFilterSource,t=f.data.DataViewObjectDescriptors,p=f.data.FilterKindDetector,v=f.visuals.plugins,a=f.explore.util.ScriptVisualsUtil,y=f.data.Selector,n=f.data.SemanticFilter,o=f.data.SemanticQuery,u=f.data.SQExprUtils,C=f.explore.util.VisualContainerUtils,m.createFilterGenerator=function(e,t,r,i,a,o,n,s,l){return new c(e,t,r,i,a,o,n,s)},e.prototype.collectVisualContainerFilters=function(e,t,r){var i=new m.FilterCollector(this.visualPlugins),t=(i.collectFilters(r.filters,0,r),t&&(i.collectFilters(t.filters,1),this.collectCrossFilter(i,t,r)),this.collectSelfFilter(i,r,null),e&&i.collectFilters(e.filters,2),this.hostFilters.getSelectedHostFilters());return t&&i.collectFilters(t.filters,1),i.getCollectedFilters()},e.prototype.collectVisualContainerDrillFilters=function(t){var e=new m.FilterCollector(this.visualPlugins),r=_.filter(t.filters,(function(e){return t.name,null!=e&&2===e.howCreated}));return e.collectFilters(r,0,t),e.getCollectedFilters()},e.prototype.addVisualContainerFilters=function(e,t,r,i,a,o){void 0===o&&(o=!1),e.addCollectedFilters(this.collectVisualContainerFilters(t,r,i),!0,this.getShouldApplyFilter(i,a,r,o)),r&&(this.addHighlightFilter(e,r,i,a),this.addCrossDrillFilters(e,r,i,a))},e.prototype.calculateVisualContainerFilter=function(e,t,r,i,a,o){void 0===a&&(a=!1),void 0===o&&(o=!1);var n=new m.FilterBuilder(r),e=(this.addVisualContainerFilters(n,e,t,r,i,a),n.getFilters(o));return e.queryRefsForSingleItemDrillFilters=s.FilterUtils.getQueryRefsForSingleItemDrillFilters(r,i,this.aggrOps),e},e.prototype.calculateDetailVisualFilter=function(e,t,r,i,a){var o=new m.FilterBuilder(r),e=(this.addVisualContainerFilters(o,e,t,r,i),0===a&&(a=1),o.getHighlightFilters()),t=(e&&(o.clearHighlightFilters(),o.mergeHighlightFiltersBasedOnRelationship(e,a)),o.getFilters());return t.queryRefsForSingleItemDrillFilters=s.FilterUtils.getQueryRefsForSingleItemDrillFilters(r,i,this.aggrOps),t},e.prototype.clearCrossHighlight=function(e,t,r){e=this.clearCrossHighlightOperation(e);C.notifyVisualContainers(this.eventBridge,e,"UserAction_CrossHighlight",t,r)},e.prototype.clearCrossHighlightForVisualContainers=function(e,t,r,i){e=this.clearCrossHighlightForVisualContainersOperation(e,t);C.notifyVisualContainers(this.eventBridge,e,"UserAction_CrossHighlight",r,i)},e.prototype.clearCrossHighlightForVisualContainersOperation=function(e,t){var r=e.crossFilterSource&&e.crossFilterSource.highlight;if(!_.isEmpty(r)){for(var i=[],a=0,o=_.chain(r).map((function(e){return e.sourceVisualContainer})).filter((function(e){return _.includes(t,e)})).valueOf();a<o.length;a++){var n=o[a],n=this.setCrossHighlightOperation(null,null,e,3,n);i.push.apply(i,n||[])}return _.uniq(i)}},e.prototype.clearFiltersFromVisualContainers=function(e,t,r){var i=this,a=e&&e.crossFilterSource,o=a&&a.drill,n=a&&a.highlight,a=[];!_.isEmpty(n)&&_.some(t,(function(t){return _.some(n,(function(e){return t===e.sourceVisualContainer}))}))&&(a=this.clearCrossHighlightOperation(e)),_.isEmpty(o)||(o=this.clearCrossDrillFromVisualContainersOperation(e,t),a=_.union(a,o)),_.some(t,(function(e){return i.supportsFilterOutput(e)}))?C.notifyVisualContainers(this.eventBridge,e.visualContainers,r):_.isEmpty(a)||C.notifyVisualContainers(this.eventBridge,a,r)},e.prototype.updateCrossHighlightCollectedFilters=function(e,t,r){var i=e&&e.crossFilterSource&&e.crossFilterSource.highlight;!i||(i=_.find(i,(function(e){return e.sourceVisualContainer===r})))&&!_.isEmpty(i.selection)&&(i.collectedFilters=this.collectVisualContainerFilters(t,e,r),C.notifyVisualContainersExceptSource(this.eventBridge,r))},e.prototype.calculateFilterContainerInputFilter=function(e,t,r,i,a){var o,n;if(r&&t&&a)return 0===a.scopeType&&(o=a.container),n=new m.FilterCollector(this.visualPlugins),e&&n.collectFiltersForFilterContainer(e.filters,2,r),1===a.scopeType?(e=5===r.howCreated?_.filter(t.filters,(function(e){return null!=e&&5===e.howCreated})):t.filters,n.collectFiltersForFilterContainer(e,1,r)):2!==a.scopeType&&n.collectFiltersForFilterContainer(t.filters,1,r),this.collectSelfFilter(n,null,r),o&&(n.collectFiltersForFilterContainer(o.filters,0,r,o),this.collectCrossFilter(n,t,o)),e=new m.FilterBuilder(o,r),e.addCollectedFilters(n.getCollectedFilters(),!1,this.getShouldApplyFilterContainerInputFilter(r,o,i,t)),e.getFilters()},e.prototype.getVisualContainerCrossFilters=function(e,t,r){var i=new m.FilterCollector(this.visualPlugins),a=(this.collectCrossFilter(i,e,t),new m.FilterBuilder(t));return a.addCollectedFilters(i.getCollectedFilters(),!1,this.getShouldApplyFilter(t,r,e)),this.addHighlightFilter(a,e,t,r),this.addCrossDrillFilters(a,e,t,r),{dataFilters:a.getCrossFilters()||[],highlightFilters:a.getHighlightFilters()}},e.prototype.checkSelectionLimit=function(e,t,r,i){e=this.countSelectedDataPoints(e,t,i),t=r.length;return{existingSelectionLength:e,newSelectionLength:t,allowed:!(this.featureSwitchService.featureSwitches.dataPointLassoSelect&&e+t>f.visuals.PlotAreaLassoSelectionLimit)}},e.prototype.logRFilterTelemetry=function(e,t,r,i){t=a.getScriptVisualIdsInSection(t,this.scriptVisuals);_.isEmpty(t)||this.telemetryService.logChildEvent(i&&i.event,e,{filterType:r,visualIds:JSON.stringify(t)})},e.prototype.setCrossHighlightOperation=function(e,t,r,i,a,o,n){var s,l,p=r.crossFilterSource&&r.crossFilterSource.highlight,u=!1;if(a?(u=!0,r.crossFilterSource||(r.crossFilterSource={highlight:[]}),r.crossFilterSource.highlight||(r.crossFilterSource.highlight=[]),s=r.crossFilterSource.highlight,l=void 0,3!==i&&1!==i||!this.newAndPreviousSelectionsSupportMultiVisualSelection(a,s)?(r.crossFilterSource.highlight=s=[],l=0):-1===(l=_.findIndex(s,(function(e){return e.sourceVisualContainer===a})))&&(l=s.length),null==t?(_.isEmpty(s)||((s=__spreadArray([],s||[])).splice(l,1),r.crossFilterSource.highlight=s),a=null):s[l]={sourceVisualContainer:a,selection:t,selectorFilter:y.filterFromSelectorsByColumn(t),collectedFilters:_.isEmpty(t)?[]:this.collectVisualContainerFilters(e,r,a),filterExpressionMetadata:o},this.logRFilterTelemetry(f.telemetry.EXCrossFilterScriptVisual,r,"Highlight",n)):p&&(u=!0,r.crossFilterSource.highlight=void 0),u){var c=r.crossFilterSource&&r.crossFilterSource.highlight;if(!_.isEmpty(p)){for(var d=this,m=0,v=p;m<v.length;m++)!(function(t){-1===_.findIndex(c,(function(e){return e.sourceVisualContainer===t.sourceVisualContainer}))&&C.clearDataSelection(d.eventBridge,t.sourceVisualContainer)})(v[m]);for(var g=0,h=p;g<h.length;g++)if("break"===(function(t){if(t.sourceVisualContainer!==a&&!(-1!==_.findIndex(c,(function(e){return e.sourceVisualContainer===t.sourceVisualContainer}))))return a=null,"break"})(h[g]))break}return _.filter(r.visualContainers,(function(e){return e!==a}))}},e.prototype.newAndPreviousSelectionsSupportMultiVisualSelection=function(e,t){return!!this.supportsMultiVisualSelection(e)&&!(1===t.length&&!this.supportsMultiVisualSelection(t[0].sourceVisualContainer))},e.prototype.supportsMultiVisualSelection=function(e){e=C.getVisualCapabilities(e,this.visualPlugins);return e&&e.supportsMultiVisualSelection},e.prototype.clearCrossHighlightOperation=function(e){if(e.crossFilterSource&&e.crossFilterSource.highlight)return this.setCrossHighlightOperation(null,null,e)},e.prototype.clearCrossDrillFromVisualContainersOperation=function(e,t){if(!_.isEmpty(t)){for(var r=[],i=0,a=t;i<a.length;i++)var o=a[i],o=this.updateCrossDrillFromVisualContainerOperation(e,o,!0),r=_.union(r,o);return r}},e.prototype.updateCrossDrillFromVisualContainerOperation=function(e,t,r){r||_.includes(e.visualContainers,t);var i,a=e.crossFilterSource&&e.crossFilterSource.drill,o=!1,r=(r||(r=this.collectVisualContainerDrillFilters(t),_.isEmpty(r)||(i={sourceVisualContainer:t,collectedFilters:r})),_.findIndex(a,(function(e){return e.sourceVisualContainer===t})));if(0<=r?(o=!0,i?a[r]=i:a.splice(r,1)):i&&(o=!0,e.crossFilterSource||(e.crossFilterSource={}),(e.crossFilterSource.drill||(e.crossFilterSource.drill=[])).push(i)),o)return _.filter(e.visualContainers,(function(e){return e!==t}))},e.prototype.collectSelfFilter=function(e,t,r){var i,a,o=this;!!t?(i=this.getFilterFromFilterPropertyInVisualContainer(t,(function(e){return o.tryGetSelfFilterProperty(e)})))&&((a=n.clone(i)).setIgnoreMParameter(),e.collectFilter(a,null,t,0,l.Self)):(i=this.getFilterFromFilterPropertyInFilterContainer(r,(function(e){return o.tryGetSelfFilterProperty(e)})))&&((a=n.clone(i)).setIgnoreMParameter(),e.collectFilter(a,r,null,0,l.Self))},e.prototype.collectCrossFilter=function(e,t,r){for(var i=this,a=0,o=t.visualContainers;a<o.length;a++){var n,s=o[a];s!==r&&((n=this.getFilterFromFilterPropertyInVisualContainer(s,(function(e,t){return i.tryGetFilterPropertyIdentifier(e,t)})))&&e.collectFilter(n,null,s,0,l.Slicer))}},e.prototype.getFilterFromFilterPropertyUtil=function(e,t,r){r=r(e,t&&t.visualType);if(r){e=t.objects;if(e)return f.data.DataViewObjectDefinitions.getValue(e,r,null)}},e.prototype.getFilterFromFilterPropertyInVisualContainer=function(e,t){var r=C.getVisualCapabilities(e,this.visualPlugins),e=e.config&&e.config.singleVisual;return this.getFilterFromFilterPropertyUtil(r,e,t)},e.prototype.getFilterFromFilterPropertyInFilterContainer=function(e,t){var r=C.getFilterCapabilities(e,this.visualPlugins),e=e.config&&e.config.singleVisual;return this.getFilterFromFilterPropertyUtil(r,e,t)},e.prototype.addHighlightFilter=function(e,t,r,i){var a=t.crossFilterSource&&t.crossFilterSource.highlight;if(!_.isEmpty(a)&&C.getVisualType(r)!==v.slicer.name)for(var o=0,n=a;o<n.length;o++){var s=n[o];if(s.sourceVisualContainer!==r){var l=this.buildHighlightFiltersForRelatedTargets(s,i,t);if(!_.isEmpty(l)){var p=this.relationshipService.relationshipFilterAction(t,s.sourceVisualContainer,r,i);if(this.featureSwitchService.featureSwitches.visualCalculations&&this.hasVisualCalcExpression(r)){if(3!==p)for(var u=0,c=l;u<c.length;u++){var d=c[u];e.addSectionFilter(d)}}else{var m=C.getVisualCapabilities(r,this.visualPlugins);0===p&&(p=this.relationshipService.defaultFilterAction(s.sourceVisualContainer,r)),e.mergeHighlightFiltersBasedOnRelationship(l,p,!m.supportsHighlight)}}}}},e.prototype.hasVisualCalcExpression=function(e){e=e.config.singleVisual.query;return!!e&&e.hasVisualCalcExpressions()},e.prototype.addCrossDrillFilters=function(r,e,t,i){var a=e.crossFilterSource&&e.crossFilterSource.drill;if(!_.isEmpty(a)){for(var o=[],n=0,s=a;n<s.length;n++){var l=s[n],p=l.sourceVisualContainer;if(this.relationshipService.shouldApplyCrossDrill(e,p,t,i)){var u=new m.FilterBuilder(p),p=(u.addCollectedFilters(l.collectedFilters,!1,this.getShouldApplyDrillCrossFilter(p,i,e)),u.getUnmergedDrillCrossFilter());if(p)for(var c=0,d=p;c<d.length;c++)!(function(t){r.addCrossFilter(t);var e=_.find(l.collectedFilters,(function(e){return e.filter===t.filter}));e&&o.push(e.filterContainer)})(d[c])}}return o}},e.prototype.buildHighlightFiltersForRelatedTargets=function(e,t,r){var i=new m.FilterBuilder(e.sourceVisualContainer);return e.selectorFilter&&i.setSelectorFilter({filter:e.selectorFilter,filterExpressionMetadata:e.filterExpressionMetadata,type:s.contracts.FilterType.Include}),i.addCollectedFilters(e.collectedFilters,!1,this.getShouldApplyHighlightFilter(e.sourceVisualContainer,t,r)),i.getCrossHighlightFilters()},e.prototype.getShouldApplyFilterContainerInputFilter=function(i,a,o,n){var s=this;return function(e,t,r){return s.shouldApplyFilterContainerInputFilter(e,t,r,i,a,o,n)}},e.prototype.shouldApplyFilterContainerInputFilter=function(e,t,r,i,a,o,n){if(t===i)return!0;if(!this.shouldApplyFilter(e,t,r,a,o,n))return!1;i=t&&t.expression;return(!i||!u.isMeasure(i))&&!_.some(e.conditions(),(function(e){return 3===p.runDetector(e)}))},e.prototype.getShouldApplyHighlightFilter=function(i,a,o){var n=this;return function(e,t,r){return n.shouldApplyHighlightFilter(e,t,r,i,a,o)}},e.prototype.getShouldApplyDrillCrossFilter=function(i,a,o){var n=this;return function(e,t,r){return n.shouldApplyDrillCrossFilter(e,t,r,i,a,o)}},e.prototype.shouldApplyHighlightFilter=function(e,t,r,i,a,o){return!!this.shouldApplyFilter(e,t,r,i,a,o)&&!_.some(e.conditions(),(function(e){return 1===p.runDetector(e)}))},e.prototype.shouldApplyDrillCrossFilter=function(e,t,r,i,a,o){return!!this.shouldApplyFilterForCrossDrill(e,t,r,i,a,o)&&!_.some(e.conditions(),(function(e){return 1===p.runDetector(e)}))},e.prototype.getShouldApplyFilter=function(i,a,o,n){var s=this;return void 0===n&&(n=!1),function(e,t,r){return s.shouldApplyFilter(e,t,r,i,a,o,n)}},e.prototype.shouldApplyFilter=function(e,t,r,i,a,o,n){var s=this,n=(n=void 0===n?!1:n)?function(){return 1}:function(e,t,r,i){return s.relationshipService.relationshipFilterAction(e,t,r,i)};return this.shouldApplyFilterInternal(e,t,r,i,a,o,n)},e.prototype.shouldApplyFilterForCrossDrill=function(e,t,r,i,a,o){var n=this;return this.shouldApplyFilterInternal(e,t,r,i,a,o,(function(e,t,r,i){return n.relationshipService.drillRelationshipFilterAction(e,t,r,i)}))},e.prototype.shouldApplyFilterInternal=function(e,t,r,i,a,o,n){if(t&&s.FilterUtils.shouldDisableFilter(t,a,r,this.aggrOps,this.visualPlugins))return!1;if(!(_.isEmpty(e.validate(a,this.aggrOps))||r&&r===i))return!1;if(r&&i&&r!==i){if(3===n(o,r,i,a))return!1;t=r.config.singleVisual.syncGroup,e=i.config.singleVisual.syncGroup;if(t&&e&&t.groupName===e.groupName)return!1}return!0},e.prototype.countSelectedDataPoints=function(r,e,t){e=null==(e=e.crossFilterSource)?void 0:e.highlight;return t?_.chain(e).reduce((function(e,t){return e+(t.sourceVisualContainer!==r?t.selection.length:0)}),0).value():0},e.prototype.setMultipleFiltersOnSelectData=function(e,t,r,i,a){for(var o=this.clearCrossHighlightOperation(t),n=0,s=r;n<s.length;n++)var l=s[n],o=_.union(o,this.setCrossHighlightOperation(e,l.selection,t,3,l.sourceVisualContainer,l.filterExpressionMetadata));C.notifyVisualContainers(this.eventBridge,o,"UserAction_CrossHighlight",i,a)},e.prototype.setFilterOnSelectData=function(e,t,r,i,a,o,n,s){this.supportsFilterOutput(i)?this.logRFilterTelemetry(f.telemetry.EXCrossFilterScriptVisual,r,"Data",a):(e=this.setCrossHighlightOperation(e,t,r,n,i,s,a),C.notifyVisualContainers(this.eventBridge,e,"UserAction_CrossHighlight",a,o))},e.prototype.updateCrossFilterOnDrill=function(e,t){e=this.updateCrossDrillFromVisualContainerOperation(e,t,!1);C.notifyVisualContainers(this.eventBridge,e)},e.prototype.updateCrossDrillFromVisualContainers=function(e,t){e=this.updateCrossDrillFromVisualContainersOperation(e,t);C.notifyVisualContainers(this.eventBridge,e)},e.prototype.updateCrossDrillFromVisualContainersOperation=function(e,t){if(!_.isEmpty(t)){for(var r=[],i=0,a=t;i<a.length;i++)var o=a[i],o=this.updateCrossDrillFromVisualContainerOperation(e,o,!1),r=_.union(r,o);return r}},e.prototype.updateCrossDrillOfSection=function(e){e=this.updateCrossDrillOfSectionOperation(e);C.notifyVisualContainers(this.eventBridge,e)},e.prototype.updateCrossDrillOfSectionOperation=function(e){return this.updateCrossDrillFromVisualContainersOperation(e,e.visualContainers)},e.prototype.getDrillCrossFiltersToApply=function(e,t,r){var i=new m.FilterBuilder(t);return this.addCrossDrillFilters(i,e,t,r)},e.prototype.supportsFilterOutput=function(e){return s.FilterUtils.supportsFilterOutput(C.getVisualCapabilities(e,this.visualPlugins))},e.prototype.tryGetFilterPropertyIdentifier=function(e,t){return s.FilterUtils.tryGetFilterPropertyIdentifier(e,t,this.visualPlugins)},e.prototype.tryGetSelfFilterEnabledProperty=function(e){if(e)return t.findSelfFilterEnabled(e.objects)},e.prototype.tryGetSelfFilterProperty=function(e){if(e)return t.findSelfFilter(e.objects)},e.prototype.resolveFilterTargets=function(e,t,r,i,a){if(!o.willFiltersAffectQuery(t.defn))return t.defn;r={dataRoles:r,mappings:i,queryProjections:t.projections,select:t.defn.select(),schema:e},i=new m.VisualFilterMappingResolver(r),e=t.defn;return a&&(e=e.addSemanticFilter(a)),i.resolveSemanticQuery(e)},e.prototype.applyFilterOutput=function(e){this.supportsFilterOutput(e)&&C.notifyVisualContainersExceptSource(this.eventBridge,e)},c=e})(powerbi=powerbi||{}),(function(e){var n,s,t,a,o,f,y,l,r;function p(e){return"visualContainer"===e.canvasItemType}function u(e){return"group"===e.canvasItemType}function c(e,t,r){var r=r.config.singleVisual,i=e.capabilities(r.visualType),e=e.capabilities(t.visualType);i&&e&&(r.objects=d(i.objects,e.objects,t.objects,r.objects)),r.vcObjects=d(a,a,t.vcObjects,r.vcObjects)}function d(e,t,r,i){if(r===i)return i;for(var a in i=i||{},e){var o=e[a],n=t[a];if(n&&!o.suppressFormatPainterCopy&&!n.suppressFormatPainterCopy){var s,l=r&&r[a],p=i&&i[a];for(s in o.properties){var u=o.properties[s],c=n.properties[s];if(c&&!u.suppressFormatPainterCopy&&!c.suppressFormatPainterCopy&&_.isEqual(u.type,c.type)){if(p)for(var d=0,m=p;d<m.length;d++){var v=m[d];f.deleteSingleProperty(v,s)}if(l)for(var g=0,h=l;g<h.length;g++)(v=h[g]).properties[s]&&(y.ensure(i,a,v.selector).properties[s]=v.properties[s])}}}}return y.reduce(i)}n=e.explore||(e.explore={}),s=n.services||(n.services={}),f=e.data.DataViewObjectDefinition,y=e.data.DataViewObjectDefinitions,l=e.data.SQExpr,r=e.explore.contracts.VisualContainer,e=e.explore.contracts.VisualContainerGroup,(t=s.FormatPainter||(s.FormatPainter={})).isVisualContainerFormat=p,t.isGroupFormat=u,t.copyFormatCanvasItem=function(e,t,r,i){if(e=s.selectionUtils.getSelectedCanvasItem(e)){if(!n.contracts.isVisualContainer(e))return{canvasItemType:"group",objects:e.objects};var a,o=e.config.singleVisual.visualType;return t.isCustomVisual(o)?void 0:(e=(t=e.config.singleVisual).vcObjects,a=y.getValue(e,{objectName:"stylePreset",propertyName:"name"},void 0),(i=i.getVisualObjects(r,o,a&&l.isConstant(a)&&a.value,n.contracts.VisualContainer.CommonObjectDescriptors))&&(e=y.clone(e||{}),y.extend(e,i,!0)),{canvasItemType:"visualContainer",visualType:t.visualType,objects:t.objects,vcObjects:e})}},a=r.CommonObjectDescriptors,o=e.objectDescriptors,t.pasteFormatCanvasItem=function(e,t,r){var i;if((e=s.selectionUtils.getSelectedCanvasItem(e))&&r)return n.contracts.isVisualContainer(e)?p(r)?c(t,r,e):u(r)&&((i=e.config.singleVisual).vcObjects=d(a,o,r.objects,i.objects)):p(r)?n.contracts.traverseVisualContainerGroups([e],(function(e){n.contracts.isVisualContainer(e)&&c(t,r,e)})):u(r)&&(e.objects=d(o,o,r.objects,e.objects)),e},t.copyFormatObjects=d})(powerbi=powerbi||{}),(function(e){var t;function r(){this.runningVisuals={}}((e=e.explore||(e.explore={})).services||(e.services={})).createRunningVisualService=function(){return new t},r.prototype.getVisual=function(e){e&&e.name;var t=this.runningVisuals[e.name];if(null!=t&&t.contract===e)return t.visual},r.prototype.setVisual=function(e,t){e&&e.name,this.runningVisuals[e.name]={contract:e,visual:t}},r.prototype.removeVisual=function(e){e&&e.name,delete this.runningVisuals[e.name]},t=r})(powerbi=powerbi||{}),(function(e){var t;function r(){this.isPaused=!1}((e=e.explore||(e.explore={})).services||(e.services={})).createServicePauser=function(){return new t},r.prototype.register=function(e){e=jQuery.extend(!0,{},e);return this.updateService(e),e},r.prototype.pause=function(){this.isPaused=!0},r.prototype.resume=function(){this.isPaused=!1},r.prototype.updateService=function(i){var e,a=this;for(e in i)!(function(e){var t,r;_.isFunction(i[e])&&(t=i[e],r=a,i[e]=function(){if(!r.isPaused)return t.apply(i,arguments)})})(e)},t=r})(powerbi=powerbi||{}),(function(e){var t,u,a,p,l,o,i,n;function s(e,t,r){return e[t]||(e[t]={items:{},name:t,type:r}),e[t]}function c(e,t,r,i,a){e=s(e,t,r).items;return e[i]=e[i]||{name:i,type:a}}function r(e,t,r,i,a){this.promiseFactory=e,this.resourceLoader=t,this.explorationNavigation=r,this.explorationSerializer=i,this.resourceRegistration=a,this.restorableReferenceSources=[],this.preservedReferences={}}t=(t=e.explore||(e.explore={})).services||(t.services={}),a=e.data.DataViewObjectDefinitions,p=e.visualHost.ResourcePackageReferenceResolver,l=e.visualHost.utils.ResourcePackageUtils,o=e.data.SQExpr,i=jsCommon.UrlUtils,t.createStaticResourceReferenceService=function(e,t,r,i,a){return new n(e,t,r,i,a)},(t=u=t.StaticResourceReferences||(t.StaticResourceReferences={})).addObjectsReferences=function(e,t,r,i){e&&a.visitPropertyExprs({definitions:e,descriptors:t,visitor:function(e){var t;o.isResourcePackageItem(e)&&(t=l.findResourcePackage(r,e.packageType,e.packageName),(e=l.findItemInPackage(t,e.itemName))&&c(i,t.name,t.type,e.name,e.type))}})},t.ensurePackageReference=s,t.addItemReference=c,t.findItem=function(e,t,r){return(e=e[t])&&e.items&&e.items[r]},t.eraseItem=function(e,t,r){var i=e[t];i&&(delete(i=i.items)[r],0===_.size(i)&&delete e[t])},t.visitItemReferences=function(e,t){for(var r in e){var i,a=e[r];for(i in a.items)t(a,a.items[i])}},r.prototype.addReferenceSource=function(e){this.restorableReferenceSources.push(e)},r.prototype.removeReferenceSource=function(e){_.pull(this.restorableReferenceSources,e)},r.prototype.garbageCollectUnreferencedStaticResources=function(){var e=this.explorationNavigation.getCurrentExploration(),t=e&&e.resourcePackages;if(t){for(var r=this.explorationSerializer.getReferencedStaticResources(e),i=this.getRestorableReferences(),a=[],o=t.length-1;0<=o;o--){var n=t[o];l.isStaticResource(n)&&(this.garbageCollectItems(n,r,this.preservedReferences,i,a),_.isEmpty(n.items)&&_.pull(t,n))}return _.isEmpty(t)&&delete e.resourcePackages,this.cleanPreservedReferences(r,i),a}},r.prototype.cleanPreservedReferences=function(r,i){var a=this;u.visitItemReferences(this.preservedReferences,(function(e,t){!u.findItem(r,e.name,t.name)&&u.findItem(i,e.name,t.name)||u.eraseItem(a.preservedReferences,e.name,t.name)}))},r.prototype.getRestorableReferences=function(){for(var r={},e=0,t=this.restorableReferenceSources;e<t.length;e++){var i=t[e];u.visitItemReferences(i.getReferences(),(function(e,t){u.addItemReference(r,e.name,e.type,t.name,t.type)}))}return r},r.prototype.garbageCollectItems=function(e,t,r,i,a){for(var o=e.items,n=e.name,s=_.size(o)-1;0<=s;s--){var l=o[s],p=l.name;u.findItem(t,n,p)||(u.findItem(i,n,p)&&this.preserveItem(e,p,l.type),a.push(n+"/"+l.path),_.pull(o,l))}},r.prototype.preserveItem=function(e,t,r){r=u.addItemReference(this.preservedReferences,e.name,e.type,t,r);r.uri||(r.uri=p.loadAndResolveContent(e,t,this.resourceLoader,this.promiseFactory).then((function(e){return e=i.isDataUri(e)?e:i.makeJsonDataUri(e)})))},r.prototype.loadItemsContent=function(e){var t,r=[],i=this.explorationNavigation.getCurrentExploration(),a=i&&i.resourcePackages;for(t in e){var o=e[t];if(1===o.type){var n,s=o.items,l=this;for(n in s)!(function(e){var t=s[e];r.push(p.loadRegisteredResourceAsDataUri(l.promiseFactory,l.resourceLoader,a,t.name).then((function(e){t.content=e})))})(n)}}return this.promiseFactory.all(r).then((function(){}))},r.prototype.addItemsContent=function(e){var t,r=this.explorationNavigation.getCurrentExploration();for(t in e){var i,a=e[t],o=a.items;for(i in o){var n=o[i];this.addResource(r.resourcePackages,t,a.type,n.name,n.type,n.content)}}},r.prototype.needingRestore=function(e){var o=this;if(!_.isEmpty(e)){var t=this.explorationNavigation.getCurrentExploration();if(t){var n,s=t&&t.resourcePackages;if(!_.isEmpty(s))return n={},u.visitItemReferences(e,(function(e,t){var r=e.name,i=t.name,a=u.findItem(o.preservedReferences,r,i);a&&!l.findItemInPackages(s,e.type,t.name,r)&&(u.ensurePackageReference(n,r,e.type).items[i]=a)})),n}}},r.prototype.addResource=function(e,t,r,i,a,o){l.findItemInPackages(e,r,i,t)||this.resourceRegistration.add(i,r,a,{content:o,skipUniqueName:!0})},r.prototype.restoreReferences=function(e){var i=this,e=this.needingRestore(e),a=[];return u.visitItemReferences(e,(function(t,r){a.push(r.uri.then((function(e){i.resourceRegistration.restore(r.name,t.type,r.type,e)})))})),this.promiseFactory.all(a).then((function(){}))},n=r})(powerbi=powerbi||{}),(function(e){var t,o,n,s,l,p,u,a;function r(e,t,r,i){this.explorationNavigationService=e,this.promiseFactory=t,this.resourceLoader=r,this.resourcePublishingService=i}t=(t=e.explore||(e.explore={})).services||(t.services={}),o=jsCommon.FileUtils,n=e.visualHost.ResourcePackageReferenceResolver,s=e.explore.util.ResourcePackageUtils,l=e.visualHost.utils.ResourcePackageUtils,p=e.data.SQExprBuilder,u=jsCommon.UrlUtils,t.createResourceRegistrationService=function(e,t,r,i){return new a(e,t,r,i)},r.prototype.addResource=function(t,e,r,i){var a,o=this;return 1===t.type?(l.findItemInPackage(t,e),a={type:r,path:e,name:e,content:i}):2!==t.type||l.findItemInPackage(t,e)||(a=s.newSharedResourceItem(e,r,i)),a&&(t.items.push(a),(_.isEmpty(i)?(t.type,n.loadAndResolveContent(t,e,this.resourceLoader,this.promiseFactory).then((function(e){return e=u.isDataUri(e)?e:u.utoa(e)}))):this.promiseFactory.resolve(u.getBase64ContentFromDataUri(i))).then((function(e){o.resourcePublishingService.publish(t.name,a.path,e)}))),p.resourcePackageItem(t.name,t.type,e)},r.prototype.restore=function(t,e,r,i){t.length;e=this.ensureResourcePackageExists(e);_.find(e.items,(function(e){return e.name===t}))||this.addResource(e,t,r,i)},r.prototype.add=function(e,t,r,i){e.length;var a=this.ensureResourcePackageExists(t);return 1!==t||i&&i.skipUniqueName||(e=this.getUniqueName(e,a)),this.addResource(a,e,r,i&&i.content)},r.prototype.getUniqueName=function(e,t){var e=e.replace(/[^a-zA-Z0-9:@\-._~!$&'()*+,;=]/g,"_"),r=o.getFileWithoutExtension(e),i=(i=o.getFileExtension(e))&&"."+i,r=r.substr(0,30);for(i=i.substr(0,11);;){var a=r+Math.random().toString().substr(2)+i;if(!_.find(t.items,(function(e){return e&&e.name&&e.name.toUpperCase()===a.toUpperCase()})))break}return a},r.prototype.ensureResourcePackageExists=function(e){var t=this.explorationNavigationService.getCurrentExploration();return s.ensureResourcePackageType(t,e)},a=r})(powerbi=powerbi||{}),(function(p){var e,n,t,r,s,i;function u(e){return Math.round(100*jsCommon.PixelConverter.toPoint(e))/100}function l(e,t){var r,e=c(e,t.objectName);e&&(r=e[t.propertyName])&&(d(r)?e[t.propertyName]=v(r):(r=s.deserializeExpr(r.expr),e[t.propertyName]=m(v(r))))}function c(e,t){if(e){e=e[t];if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r];if(null==a.selector)return a.properties}}}function d(e){return e instanceof p.data.SQExpr&&p.data.SQExpr.isConstant(e)}function m(e){return{expr:s.serializeExpr(e)}}function v(e){e=u(e.value);return i.decimal(e)}function a(e){return Math.round(100*jsCommon.PixelConverter.fromPointToPixel(e))/100}e=(e=(e=p.explore||(p.explore={})).services||(e.services={})).upgrade||(e.upgrade={}),n=e.UpgradeUtils||(e.UpgradeUtils={}),t=p.visuals.fillStyle,r=p.visuals.outline,s=p.data.services.SemanticQuerySerializer,i=p.data.SQExprBuilder,n.pxToPt=u,n.convertAxisScaleProperty=function(e){return void 0!==e&&"log"===e},n.convertAxisPositionProperty=function(e){return void 0!==e&&"Right"===e},n.convertScatterChartFillPoint=function(e){return e?t.fillOnly:t.borderOnly},n.convertSuppressDefaultTooltip=function(e){return!e},n.convertOutlineValue=function(e){switch(e){case r.none:return 0;case r.topOnly:return 1;case r.bottomOnly:return 4;case r.leftOnly:return 8;case r.rightOnly:return 2;case r.topBottom:return 5;case r.leftRight:return 10;case r.frame:return 15;default:return 0}},n.pxToPtUpgrader=function(e){switch(typeof e){case"string":e=+e;case"number":return isNaN(e),u(e);default:return e}},n.updateSingleVisualConfigPxToPt=function(e){if(e){if(e.objects){var t=e.objects;if(t)for(var r=0,i=n.visualPropertiesToUpdate;r<i.length;r++){var a=i[r];l(t,a)}}e.vcObjects&&(e=e.vcObjects)&&(e=e.visualTooltip&&e.visualTooltip[0]&&e.visualTooltip[0].properties)&&(o=e.fontSize)&&(d(o)?e.fontSize=v(o):(o=s.deserializeExpr(o.expr),e.fontSize=m(v(o))))}var o},n.updateSingleVisualConfigTextboxPxToPt=function(e){if(e&&e.objects&&e.visualType===p.visuals.plugins.textbox.name&&(e=e.objects)){e=c(e,"general");if(e)for(var e=e.paragraphs,t=0,r=e;t<r.length;t++)for(var i=r[t],a=0,o=i.textRuns;a<o.length;a++){var n,s,l=o[a];p.ParagraphsDefinition.isTextRunDefinition(l)&&l.textStyle&&l.textStyle.fontSize&&(s=l.textStyle.fontSize,-1!==(n=s.indexOf("px"))&&(s=+s.substr(0,n),l.textStyle.fontSize=u(s)+"pt"))}}},n.visualPropertiesToUpdate=[{objectName:"valueAxis",propertyName:"fontSize"},{objectName:"valueAxis",propertyName:"titleFontSize"},{objectName:"valueAxis",propertyName:"secFontSize"},{objectName:"valueAxis",propertyName:"secTitleFontSize"},{objectName:"categoryAxis",propertyName:"fontSize"},{objectName:"categoryAxis",propertyName:"titleFontSize"}],n.visualContainerPropertiesToUpdate=[{objectName:"visualTooltip",propertyName:"fontSize"}],n.upgradePropertyFromPxToPt=l,n.toExpr=m,n.pxToPtExpr=v,n.ptToPxWireExpr=function(e){return e=a(+s.deserializeExpr(e.expr).value),{expr:s.serializeExpr(i.decimal(e))}},n.ptToPx=a})(powerbi=powerbi||{}),(function(e){var t,r,i;e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={}),(r=t=e.ExplorationStateVersions||(e.ExplorationStateVersions={})).v1_0="1.0",r.v1_1="1.1",r.v1_2="1.2",r.v1_3="1.3",r.v1_4="1.4",r.v1_5="1.5",r.v1_6="1.6",r.v1_7="1.7",r.v1_8="1.8",r.v1_9="1.9",r.v1_10="1.10",r.v1_11="1.11",r.v1_12="1.12",r.v1_13="1.13",r.v1_14="1.14",r.v1_15="1.15",r.v1_16="1.16",r.v1_17="1.17",(i=e.ExplorationStateFeatureVersions||(e.ExplorationStateFeatureVersions={})).AllowMobileVisualFormatting=t.v1_8,i.FieldParameters=t.v1_11,i.OnObject=t.v1_15,i.setAllowMobileVisualFormatting=function(e){i.AllowMobileVisualFormatting=e}})(powerbi=powerbi||{}),(function(w){var T,e;T=w.explore||(w.explore={}),(function(u){var r,c,e=w.visuals.AnomalyDetectionObjectConstants,t=w.visuals.AnomalyDetectionVisualPlugin,d=w.data.DataViewObjectDefinitions,i=w.visuals.legendPosition,l=w.data.ObjectPropertyVersionWildcard,a=w.visuals.plugins,o=w.data.Selector,n=w.data.SQConstantExpr,s=w.data.SQExpr,p=w.visuals.standardGeoJson,m=jsCommon.Version,v=T.contracts.VisualLink,g=T.contracts.VisualTooltip,h=(u.ExplorationVersions={v1_0:"1.0",v2_0:"2.0",v2_2:"2.2",v2_3:"2.3",v2_5:"2.5",v3_0:"3.0",v3_1:"3.1",v3_2:"3.2",v3_3:"3.3",v3_4:"3.4",v3_5:"3.5",v3_6:"3.6",v3_6_1:"3.6.1",v3_7:"3.7",v3_8:"3.8",v3_9:"3.9",v3_10:"3.10",v3_11:"3.11",v3_12:"3.12",v3_12_1:"3.12.1",v3_13:"3.13",v3_14:"3.14",v3_14_1:"3.14.1",v3_15:"3.15",v3_16:"3.16",v3_17:"3.17",v3_18:"3.18",v3_19:"3.19",v3_20:"3.20",v3_21:"3.21",v3_22:"3.22",v3_23:"3.23",v3_24:"3.24",v4_0:"4.0",v4_1:"4.1",v4_2:"4.2",v5_0:"5.0",v5_1:"5.1",v5_2:"5.2",v5_3:"5.3",v5_4:"5.4",v5_5:"5.5",v5_6:"5.6",v5_7:"5.7",v5_8:"5.8",v5_9:"5.9",v5_10:"5.10",v5_11:"5.11",v5_12:"5.12",v5_13:"5.13",v5_14:"5.14",v5_15:"5.15",v5_16:"5.16",v5_17:"5.17",v5_18:"5.18",v5_19:"5.19",v5_20:"5.20",v5_21:"5.21",v5_22:"5.22",v5_23:"5.23",v5_24:"5.24",v5_25:"5.25",v5_26:"5.26",v5_27:"5.27",v5_28:"5.28",v5_29:"5.29",v5_30:"5.30",v5_31:"5.31",v5_32:"5.32",v5_33:"5.33",v5_34:"5.34",v5_35:"5.35",v5_36:"5.36",v5_37:"5.37",v5_38:"5.38",v5_39:"5.39",v5_40:"5.40"},u.SQExprVersions={},u.SQExprVersions[41]=u.ExplorationVersions.v3_5,u.SQExprVersions[42]=u.ExplorationVersions.v3_7,u.SQExprVersions[33]=u.ExplorationVersions.v3_8,r=w.data.DefaultSQExprVisitorWithTraversal,__extends(f,r),f.prototype.visitAllRolesRef=function(e){this.highestVersion=m.max(this.highestVersion,u.ExplorationVersions.v5_1),r.prototype.visitAllRolesRef.call(this,e)},f.prototype.visitRangePercent=function(e){this.highestVersion=m.max(this.highestVersion,u.ExplorationVersions.v5_1),r.prototype.visitRangePercent.call(this,e)},f.prototype.visitArithmetic=function(e){s.isScopedEval(e.right)||(this.highestVersion=m.max(this.highestVersion,u.ExplorationVersions.v5_15)),r.prototype.visitArithmetic.call(this,e)},f.prototype.visitSparklineData=function(e){this.highestVersion=m.max(this.highestVersion,c.Sparklines),r.prototype.visitSparklineData.call(this,e)},f);function f(e){var t=r.call(this)||this;return t.highestVersion=e,t}function y(){}y.getVersionForSQExpr=function(e){var t=u.SQExprVersions[e.kind]||m.ZeroStr,t=new h(t);return e.accept(t),t.highestVersion},y.getVersionForSQExprWithDescriptor=function(e,t){var r=this.getVersionForSQExpr(e);return r=t&&t.fill&&t.fill.solid&&t.fill.solid.color?m.max(r,this.getVersionForFillDefinition(e)):r},y.getVersionForFillDefinition=function(e){if(s.isFillRule(e)&&e.input&&!s.isSelectRef(e.input))return c.ConditionalFormattingSource;if(s.isConditional(e)){var t=function(e){return s.isCompare(e)&&!s.isSelectRef(e.left)};if(_.some(e.cases,(function(e){return e=e.condition,!!t(e)||!(!s.isAnd(e)||!t(e.left)&&!t(e.right))})))return c.ConditionalFormattingSource}return s.isMeasure(e)||s.isAggregation(e)?c.ConditionalFormattingByValue:m.ZeroStr},y.getVersionForSortDefinitions=function(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];if(s.isScopedEval(i.expr))return u.ExplorationVersions.v5_23}return m.ZeroStr},y.getVersionForVisualContainerGroup=function(e){return e.objects&&void 0!==e.objects.lockAspect?c.VisualContainerGroupLockAspect:c.VisualContainerGrouping},u.ExplorationVersionHelper=y,(C=c=u.ExplorationFeatureVersions||(u.ExplorationFeatureVersions={})).bookmarks=u.ExplorationVersions.v3_6,C.visualHidden=u.ExplorationVersions.v3_6,C.slowDataSource=u.ExplorationVersions.v3_7,C.ExplorationState_v1_1=u.ExplorationVersions.v3_8,C.description=u.ExplorationVersions.v3_8,C.BookmarkOptions=u.ExplorationVersions.v3_8,C.SectionCrossDrill=u.ExplorationVersions.v3_8,C.SectionVisibility=u.ExplorationVersions.v3_9,C.ExplorationState_v1_2=u.ExplorationVersions.v3_10,C.VisualSyncGroup=u.ExplorationVersions.v3_11,C.ExplorationSettings=u.ExplorationVersions.v3_11,C.CanvasTooltips=u.ExplorationVersions.v3_12,C.ActionButton=u.ExplorationVersions.v3_13,C.QnaLink=u.ExplorationVersions.v3_13,C.ConditionalFormattingSource=u.ExplorationVersions.v3_14,C.MeasureDrillthrough=u.ExplorationVersions.v3_14,C.OutspaceFormatting=u.ExplorationVersions.v3_15,C.StylableVisualContainerHeader=u.ExplorationVersions.v3_15,C.BookmarkGroup=u.ExplorationVersions.v3_17,C.ConditionalFormattingByValue=u.ExplorationVersions.v3_17,C.BuiltInThemes=u.ExplorationVersions.v3_18,C.DotPlotVisual=u.ExplorationVersions.v3_18,C.ExportDataMode=u.ExplorationVersions.v3_19,C.ExpandCollapse=u.ExplorationVersions.v3_20,C.CartesianConditionalFormatting=u.ExplorationVersions.v3_20,C.FilterContainerVisibilityControl=u.ExplorationVersions.v3_20,C.OutspacePaneFormatting=u.ExplorationVersions.v3_20,C.ExplorationState_v1_3=u.ExplorationVersions.v3_20,C.NewFilterPaneExperience=u.ExplorationVersions.v3_20,C.VisualTabOrders=u.ExplorationVersions.v3_21,C.VisualLinkTooltip=u.ExplorationVersions.v3_21,C.FilterRequireSingleSelect=u.ExplorationVersions.v3_21,C.DefaultFilterAction=u.ExplorationVersions.v3_22,C.KeyDriversVisual=u.ExplorationVersions.v3_22,C.TitleWordWrap=u.ExplorationVersions.v3_22,C.VisualBorderRadius=u.ExplorationVersions.v3_22,C.WebUrlAction=u.ExplorationVersions.v3_23,C.StrictSingleSelect=u.ExplorationVersions.v3_23,C.DefaultTooltipFormatting=u.ExplorationVersions.v3_23,C.DisplayAreaVerticalAlignment=u.ExplorationVersions.v3_23,C.FilterContainerFilterMetadata=u.ExplorationVersions.v3_23,C.FiltersSort=u.ExplorationVersions.v3_23,C.CrossReportDrillthrough=u.ExplorationVersions.v3_24,C.AllowChangeFilterTypes=u.ExplorationVersions.v3_24,C.RenameFilters=u.ExplorationVersions.v3_24,C.ExpressionBoundVisualTitles=u.ExplorationVersions.v4_0,C.ColorConditionalFormatting=u.ExplorationVersions.v4_2,C.VisualLevelSlicerFilters=u.ExplorationVersions.v4_2,C.GaugeConditionalFormatting=u.ExplorationVersions.v4_2,C.VisualHeaderTooltip=u.ExplorationVersions.v4_2,C.ExplorationState_v1_4=u.ExplorationVersions.v4_2,C.ReportAnnotations=u.ExplorationVersions.v4_2,C.ExpressionBoundVisualBackground=u.ExplorationVersions.v5_0,C.KeyDriversCounting=u.ExplorationVersions.v5_1,C.KeyDriversDetails=u.ExplorationVersions.v5_2,C.MigrateFilterPaneExperience=u.ExplorationVersions.v5_2,C.VisualContainerGrouping=u.ExplorationVersions.v5_2,C.ExpressionBoundBorderColor=u.ExplorationVersions.v5_3,C.ExpressionBoundAltText=u.ExplorationVersions.v5_3,C.ExpressionBoundGaugeColors=u.ExplorationVersions.v5_3,C.AutomaticPageRefresh=u.ExplorationVersions.v5_4,C.ExpressionBoundActions=u.ExplorationVersions.v5_5,C.AdditionalKPISettings=u.ExplorationVersions.v5_6,C.FilterPaneSearchBoxFormatting=u.ExplorationVersions.v5_7,C.VisualFilterExpressionMetadata=u.ExplorationVersions.v5_8,C.DisableFilterPaneSearch=u.ExplorationVersions.v5_8,C.DecompTreeBarsPerLevel=u.ExplorationVersions.v5_8,C.HierarchicalSlicer=u.ExplorationVersions.v5_8,C.LineChartDualAxis=u.ExplorationVersions.v5_8,C.ChangeDetectionRefresh=u.ExplorationVersions.v5_9,C.FilterPaneHiddenInEditMode=u.ExplorationVersions.v5_9,C.AllowInlineExploration=u.ExplorationVersions.v5_9,C.RelativeTimeFilter=u.ExplorationVersions.v5_9,C.LinguisticSchemaSyncVersion=u.ExplorationVersions.v5_9,C.FilterSelectAll=u.ExplorationVersions.v5_9,C.ApplyAll=u.ExplorationVersions.v5_10,C.KpiScalingIndicatorIcon=u.ExplorationVersions.v5_10,C.LineChartExplicitDots=u.ExplorationVersions.v5_11,C.BingMapStyling=u.ExplorationVersions.v5_11,C.ConditionalParagraphs=u.ExplorationVersions.v5_12,C.DecompositionTreeVisual=u.ExplorationVersions.v5_12,C.GradientLegend=u.ExplorationVersions.v5_13,C.QnaWarningUnderlineColor=u.ExplorationVersions.v5_13,C.SlicerHeaderText=u.ExplorationVersions.v5_13,C.QnaActionButtonsColor=u.ExplorationVersions.v5_14,C.DropShadow=u.ExplorationVersions.v5_14,C.PersonalizeVisualPerspective=u.ExplorationVersions.v5_14,C.GeneralizedArithmetic=u.ExplorationVersions.v5_15,C.PersonalizeVisualPerspectiveToggle=u.ExplorationVersions.v5_15,C.KeepLayerOrder=u.ExplorationVersions.v5_15,C.PagesPosition=u.ExplorationVersions.v5_15,C.NarrativeVisual=u.ExplorationVersions.v5_15,C.StackedTotalDataLabels=u.ExplorationVersions.v5_15,C.SerializationOptimization=u.ExplorationVersions.v5_16,C.FilterPaneCheckboxAndApplyColor=u.ExplorationVersions.v5_16,C.AnomalyDetection=u.ExplorationVersions.v5_16,C.CartesianSmallMultiples=u.ExplorationVersions.v5_16,C.AxisZoom=u.ExplorationVersions.v5_16,C.DecompositionInsights=u.ExplorationVersions.v5_16,C.AzureMapConditionalColor=u.ExplorationVersions.v5_16,C.QuickExplore=u.ExplorationVersions.v5_17,C.IsEmptyFilterOperator=u.ExplorationVersions.v5_18,C.CartesianSmallMultiplesGridlines=u.ExplorationVersions.v5_18,C.MapGeocodingCulture=u.ExplorationVersions.v5_18,C.CartesianSmallMultiplesSubheaderFormatting=u.ExplorationVersions.v5_19,C.AzureMapSelectionControl=u.ExplorationVersions.v5_19,C.VisualContainerGroupLockAspect=u.ExplorationVersions.v5_19,C.lineChartVerticalReferenceLine=u.ExplorationVersions.v5_19,C.CartesianSmallMultiplesPadding=u.ExplorationVersions.v5_20,C.CartesianSmallMultiplesCombo=u.ExplorationVersions.v5_20,C.ShapeVisual=u.ExplorationVersions.v5_20,C.InvertAxis=u.ExplorationVersions.v5_20,C.EnhancedTooltips=u.ExplorationVersions.v5_21,C.ShowLassoButton=u.ExplorationVersions.v5_21,C.RdlVisual=u.ExplorationVersions.v5_22,C.ShapeMapFranceUpdatedRegions=u.ExplorationVersions.v5_22,C.LineChartExplicitDotsDefault=u.ExplorationVersions.v5_22,C.SmallMultiplesResponsive=u.ExplorationVersions.v5_22,C.EnhancedTooltipsForVisualHeaderTooltip=u.ExplorationVersions.v5_22,C.AreaChartTransparency=u.ExplorationVersions.v5_22,C.QuickExploreLayout=u.ExplorationVersions.v5_23,C.ConditionalFormattingUpdates=u.ExplorationVersions.v5_23,C.SuppressDefaultTooltip=u.ExplorationVersions.v5_23,C.ShapeFormattingFeatures=u.ExplorationVersions.v5_24,C.XAxisRefLineImprovements=u.ExplorationVersions.v5_24,C.AccessibilityTopLevelNav=u.ExplorationVersions.v5_24,C.GokSupportForCV=u.ExplorationVersions.v5_24,C.ButtonTileFormatting=u.ExplorationVersions.v5_25,C.LineChartSeriesLabels=u.ExplorationVersions.v5_25,C.WaterfallChartTotals=u.ExplorationVersions.v5_25,C.AzureMapHeatmapLayer=u.ExplorationVersions.v5_26,C.AllowAutomatedInsightsNotification=u.ExplorationVersions.v5_26,C.NavigatorVisuals=u.ExplorationVersions.v5_27,C.PieChartMarginBetweenSlices=u.ExplorationVersions.v5_27,C.TextboxSuperSubScriptBulletedList=u.ExplorationVersions.v5_27,C.BoldItalicUnderlineComponent=u.ExplorationVersions.v5_27,C.DonutChartStartAngle=u.ExplorationVersions.v5_27,C.ScorecardVisual=u.ExplorationVersions.v5_27,C.AzureMapHeatmapOpacityToTransparency=u.ExplorationVersions.v5_28,C.RdlVisualToolbarConfig=u.ExplorationVersions.v5_28,C.ScorecardCommandBarToggle=u.ExplorationVersions.v5_28,C.Sparklines=u.ExplorationVersions.v5_28,C.AllowMobileVisualFormatting=u.ExplorationVersions.v5_29,C.AzureMapsGeocoding=u.ExplorationVersions.v5_30,C.SlicerAccessibility=u.ExplorationVersions.v5_30,C.AxisScaleToLogAxisScale=u.ExplorationVersions.v5_31,C.PositionToSwitchAxisPosition=u.ExplorationVersions.v5_31,C.LegendPositionNewFormatPane=u.ExplorationVersions.v5_31,C.FillPointShowToStyle=u.ExplorationVersions.v5_31,C.ShowDefaultTooltip=u.ExplorationVersions.v5_31,C.RemoveDefaultToCircleToggle=u.ExplorationVersions.v5_31,C.OutlineDropdownToCheckboxes=u.ExplorationVersions.v5_31,C.SplitHelpTooltip=u.ExplorationVersions.v5_31,C.splitGrandTotals=u.ExplorationVersions.v5_31,C.splitSubTotals=u.ExplorationVersions.v5_31,C.UpgradeOutlineProperties=u.ExplorationVersions.v5_31,C.QueryFieldParameters=u.ExplorationVersions.v5_32,C.RemainingCategoryLogAxisScale=u.ExplorationVersions.v5_33,C.NewAlternatingRowsStyle=u.ExplorationVersions.v5_33,C.AltTextColumns=u.ExplorationVersions.v5_33,C.RowWithReferenceText=u.ExplorationVersions.v5_33,C.ErrorBars=u.ExplorationVersions.v5_34,C.GaugeChartCalloutTextFormatting=u.ExplorationVersions.v5_34,C.SlicerSliderColors=u.ExplorationVersions.v5_34,C.ShapeButtonTextFormatting=u.ExplorationVersions.v5_34,C.HelpTooltipBIU=u.ExplorationVersions.v5_34,C.AzureMapsFilledMap=u.ExplorationVersions.v5_34,C.CartesianBiuFontProperties=u.ExplorationVersions.v5_35,C.OnObject=u.ExplorationVersions.v5_36,C.DefaultAggregateDisplayName=u.ExplorationVersions.v5_36,C.ConditionalFormattingDataLabels=u.ExplorationVersions.v5_37,C.DrillthroughSectionType=u.ExplorationVersions.v5_38,C.ReverseStackOrder=u.ExplorationVersions.v5_39,C.ShapeMapIrelandLaoisSpelling=u.ExplorationVersions.v5_39,C.AzureMapsCategoryLabels=u.ExplorationVersions.v5_40,C.AzureMapsShowLabels=u.ExplorationVersions.v5_40,C.SmallMultiplesUnsharedAxes=u.ExplorationVersions.v5_40,C.VisualTitleContainerPadding=u.CurrentExplorationVersion,C.TotalDataBars=u.CurrentExplorationVersion,C.TextboxAtMention=u.CurrentExplorationVersion,C.VisualCalculations=u.CurrentExplorationVersion,C.GoalVisual=u.CurrentExplorationVersion,C.PauseVisualQueries=u.CurrentExplorationVersion,C.OnObjectShowByDefault=u.CurrentExplorationVersion,u.ExplorationStateVersionToExplorationVersion=((C={})[u.ExplorationStateVersions.v1_8]=u.ExplorationVersions.v5_29,C[u.ExplorationStateVersions.v1_9]=u.ExplorationVersions.v5_30,C[u.ExplorationStateVersions.v1_10]=u.ExplorationVersions.v5_31,C[u.ExplorationStateVersions.v1_11]=u.ExplorationVersions.v5_32,C[u.ExplorationStateVersions.v1_12]=u.ExplorationVersions.v5_33,C[u.ExplorationStateVersions.v1_13]=u.ExplorationVersions.v5_34,C[u.ExplorationStateVersions.v1_14]=u.ExplorationVersions.v5_35,C[u.ExplorationStateVersions.v1_15]=u.ExplorationVersions.v5_36,C[u.ExplorationStateVersions.v1_15]=u.ExplorationVersions.v5_37,C[u.ExplorationStateVersions.v1_16]=u.ExplorationVersions.v5_39,C[u.ExplorationStateVersions.v1_17]=u.ExplorationVersions.v5_40,C),u.setExplorationStateVersionToExplorationVersion=function(e){u.ExplorationStateVersionToExplorationVersion=e},u.DefaultCategoryColorVisualsToUpgrade=["barChart","clusteredBarChart","clusteredColumnChart","columnChart","comboChart","dataDotClusteredColumnComboChart","dataDotStackedColumnComboChart","funnel","hundredPercentStackedBarChart","hundredPercentStackedColumnChart","lineStackedColumnComboChart","lineClusteredColumnComboChart","map","filledMap","shapeMap","scatterChart"],u.ComboSmallMultipleFormattingVisualTypes=[a.lineClusteredColumnComboChart.name,a.lineStackedColumnComboChart.name];var C=[a.areaChart.name,a.barChart.name,a.clusteredBarChart.name,a.clusteredColumnChart.name,a.columnChart.name,a.hundredPercentStackedBarChart.name,a.hundredPercentStackedColumnChart.name,a.lineChart.name,a.stackedAreaChart.name,a.ribbonChart.name],x=__spreadArray(__spreadArray([],C),u.ComboSmallMultipleFormattingVisualTypes);function S(e){if(e&&!_.isEmpty(e.data)&&1===e.data.length&&o.isWildcard(e.data[0]))return e.data[0].matchingOption}u.CartesianExpressionBasedFormattingVisualTypes=[a.areaChart.name,a.lineChart.name,a.stackedAreaChart.name,a.realTimeLineChart.name,a.scatterChart.name,a.waterfallChart.name,a.dataDotChart.name,a.columnChart.name,a.clusteredColumnChart.name,a.hundredPercentStackedColumnChart.name,a.barChart.name,a.clusteredBarChart.name,a.hundredPercentStackedBarChart.name,a.ribbonChart.name,a.comboChart.name,a.lineClusteredColumnComboChart.name,a.lineStackedColumnComboChart.name,a.dataDotClusteredColumnComboChart.name,a.dataDotStackedColumnComboChart.name,a.histogram.name],u.CartesianExpressionBasedFormattingLabelVisualTypes=_.without(u.CartesianExpressionBasedFormattingVisualTypes,a.realTimeLineChart.name,a.scatterChart.name,a.histogram.name),u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes=_.without(u.CartesianExpressionBasedFormattingVisualTypes,a.realTimeLineChart.name),u.CartesianExpressionBasedFormattingTotalsVisualTypes=[w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.dataDotClusteredColumnComboChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name],u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes=[w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.dataDotClusteredColumnComboChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name],u.ErrorBarsVisualTypes=[w.visuals.plugins.lineChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name],u.AddedObjectPropertyVersions=[{property:{objectName:"general",propertyName:"altText"},version:u.ExplorationVersions.v3_1},{property:{objectName:"visualLink",propertyName:"type"},version:u.ExplorationVersions.v3_5},{property:{objectName:"visualLink",propertyName:"type",matchByContents:function(e){return e.value===v.Bookmark}},version:c.bookmarks},{property:{objectName:"labels",propertyName:"enableBackground"},version:u.ExplorationVersions.v3_9},{property:{objectName:"labels",propertyName:"backgroundColor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"labels",propertyName:"backgroundTransparency"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelEnableBackground"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelBackgroundColor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelBackgroundTransparency"},version:u.ExplorationVersions.v3_9},{property:{objectName:"dateRange",propertyName:"anchorDate"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryAxis",propertyName:"maxMarginFactor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryAxis",propertyName:"innerPadding"},version:u.ExplorationVersions.v3_9},{property:{objectName:"columnFormatting",propertyName:"labelDisplayUnits"},version:u.ExplorationVersions.v3_12},{property:{objectName:"columnFormatting",propertyName:"labelPrecision"},version:u.ExplorationVersions.v3_12},{property:{objectName:"visualTooltip",propertyName:"type",matchByContents:function(e){return e.value===g.Canvas}},version:c.CanvasTooltips},{property:{objectName:"lineStyles",propertyName:"lineStyle"},version:u.ExplorationVersions.v3_13,types:[w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"legendMarkerRendering"},version:u.ExplorationVersions.v3_13,types:[w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"defaultToCircle"},version:u.ExplorationVersions.v3_13,types:[w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"matchLineColor"},version:u.ExplorationVersions.v3_13,types:[w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"visualLink",propertyName:"type",matchByContents:function(e){return e.value===v.Qna}},version:c.QnaLink},{property:{objectName:"labels",propertyName:"funnelLabelStyle"},version:u.ExplorationVersions.v3_14,types:[w.visuals.plugins.funnel.name]},{property:{objectName:"dataPoint",propertyName:"fillRule",matchByContents:N},version:u.ExplorationVersions.v3_15},{property:{objectName:"values",propertyName:"backColor",matchByContents:N},version:u.ExplorationVersions.v3_15},{property:{objectName:"values",propertyName:"fontColor",matchByContents:N},version:u.ExplorationVersions.v3_15},{property:{objectName:"outspace",propertyName:l},version:c.OutspaceFormatting,types:["page"]},{property:{objectName:"visualHeader",propertyName:l},version:c.StylableVisualContainerHeader},{property:{objectName:"visualTooltip",propertyName:"show"},version:u.ExplorationVersions.v3_16},{property:{objectName:"categoryAxis",propertyName:"axisType",matchByContents:function(e){return e.value===w.visuals.axisType.categorical}},version:c.DotPlotVisual,types:[w.visuals.plugins.scatterChart.name]},{property:{objectName:"searchBox",propertyName:l},version:u.ExplorationVersions.v3_19,types:[w.visuals.plugins.slicer.name]},{property:{objectName:"rowHeaders",propertyName:"showExpandCollapseButtons"},version:c.ExpandCollapse,types:[w.visuals.plugins.pivotTable.name]},{property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return t&&t.data&&1===t.data.length&&o.isWildcard(t.data[0])}},version:c.CartesianConditionalFormatting,types:u.DefaultCategoryColorVisualsToUpgrade},{property:{objectName:"filterCard",propertyName:l},version:c.OutspacePaneFormatting,types:["page"]},{property:{objectName:"outspacePane",propertyName:l},version:c.OutspacePaneFormatting,types:["page"]},{property:{objectName:"outspacePane",propertyName:"expanded"},version:c.OutspacePaneFormatting,types:["report"]},{property:{objectName:"outspacePane",propertyName:"visible"},version:c.OutspacePaneFormatting,types:["report"]},{property:{objectName:"visualLink",propertyName:"tooltip"},version:c.VisualLinkTooltip},{property:{objectName:"general",propertyName:"requireSingleSelect"},version:c.FilterRequireSingleSelect,types:["filter"]},{property:{objectName:"title",propertyName:"titleWrap"},version:c.TitleWordWrap},{property:{objectName:"border",propertyName:"radius"},version:c.VisualBorderRadius},{property:{objectName:"visualLink",propertyName:"webUrl"},version:c.WebUrlAction},{property:{objectName:"selection",propertyName:"strictSingleSelect"},version:c.StrictSingleSelect,types:[w.visuals.plugins.slicer.name]},{property:{objectName:"visualTooltip",propertyName:"fontColor"},version:c.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"fontSize"},version:c.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"fontFamily"},version:c.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"background"},version:c.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"transparency"},version:c.DefaultTooltipFormatting},{property:{objectName:"displayArea",propertyName:"verticalAlignment"},version:c.DisplayAreaVerticalAlignment,types:["page"]},{property:{objectName:"section",propertyName:"verticalAlignment"},version:c.DisplayAreaVerticalAlignment,types:["report"]},{property:{objectName:"title",propertyName:"text",isExprBound:!0},version:c.ExpressionBoundVisualTitles},{property:{objectName:"indicator",propertyName:"fontSize"},version:u.ExplorationVersions.v4_1,types:[w.visuals.plugins.kpi.name]},{property:{objectName:"labels",propertyName:"labelPosition"},version:u.ExplorationVersions.v4_1,types:[w.visuals.plugins.lineChart.name]},{property:{objectName:"title",propertyName:"fontColor",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(s.isConstant(e)||s.isThemeDataColor(e))}},version:c.ColorConditionalFormatting},{property:{objectName:"title",propertyName:"background",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(s.isConstant(e)||s.isThemeDataColor(e))}},version:c.ColorConditionalFormatting},{property:{objectName:"labels",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(s.isConstant(e)||s.isThemeDataColor(e))}},version:c.ColorConditionalFormatting,types:[w.visuals.plugins.card.name]},{property:{objectName:"categoryLabels",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(s.isConstant(e)||s.isThemeDataColor(e))}},version:c.ColorConditionalFormatting,types:[w.visuals.plugins.card.name]},{property:{objectName:"subTotals",propertyName:"rowSubtotalsLabel"},types:[w.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"subTotals",propertyName:"columnSubtotalsLabel"},types:[w.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"subTotals",propertyName:"levelSubtotalLabel"},types:[w.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"total",propertyName:"label"},types:[w.visuals.plugins.tableEx.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"visualHeader",propertyName:"showTooltipButton"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"section"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"text"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"titleFontColor"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"fontSize"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"fontFamily"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"background"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"transparency"},version:c.VisualHeaderTooltip},{property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return!s.isConstant(e&&e.solid&&e.solid.color)}},version:c.GaugeConditionalFormatting,types:[w.visuals.plugins.gauge.name]},{property:{objectName:"background",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(s.isConstant(e)||s.isThemeDataColor(e))}},version:c.ExpressionBoundVisualBackground},{property:{objectName:"keyDrivers",propertyName:"allowKeyDriversCounting",matchByContents:function(e){return!0===e.value}},version:c.KeyDriversCounting},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"icon"},version:u.ExplorationVersions.v5_1},{property:{objectName:"text",propertyName:"fontFamily"},types:[w.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"text",propertyName:"fontSize"},types:[w.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"text",propertyName:"color"},types:[w.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"general",propertyName:"altText",isExprBound:!0},version:c.ExpressionBoundAltText},{property:{objectName:"border",propertyName:"color",isExprBound:!0},version:c.ExpressionBoundBorderColor},{property:{objectName:"dataPoint",propertyName:"target",isExprBound:!0},version:c.ExpressionBoundGaugeColors,types:[w.visuals.plugins.gauge.name]},{property:{objectName:"labels",propertyName:"color",isExprBound:!0},version:c.ExpressionBoundGaugeColors,types:[w.visuals.plugins.gauge.name]},{property:{objectName:"target",propertyName:"color",isExprBound:!0},version:c.ExpressionBoundGaugeColors,types:[w.visuals.plugins.gauge.name]},{property:{objectName:"calloutValue",propertyName:"color",isExprBound:!0},version:c.ExpressionBoundGaugeColors,types:[w.visuals.plugins.gauge.name]},{property:{objectName:"pageRefresh",propertyName:"show"},version:c.AutomaticPageRefresh,types:["page"]},{property:{objectName:"pageRefresh",propertyName:"duration"},version:c.AutomaticPageRefresh,types:["page"]},{property:{objectName:"text",propertyName:"text",isExprBound:!0},version:c.ExpressionBoundActions,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"fontColor",isExprBound:!0},version:c.ExpressionBoundActions,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"lineColor",isExprBound:!0},version:c.ExpressionBoundActions,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"outline",propertyName:"lineColor",isExprBound:!0},version:c.ExpressionBoundActions,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"fill",propertyName:"fillColor",isExprBound:!0},version:c.ExpressionBoundActions,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"visualLink",propertyName:"tooltip",isExprBound:!0},version:c.ExpressionBoundActions},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"fontFamily"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"fontColor"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"verticalAlignment"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"horizontalAlignment"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"trendline",propertyName:"transparency"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalText"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"fontSize"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalFontFamily"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalFontColor"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceLabel"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"percentageLabelPrecision"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleFontSize"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceFontFamily"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceFontColor"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"direction"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"show"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"fontSize"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"periodFontFamily"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"periodFontColor"},version:c.AdditionalKPISettings},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"webURL"},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:w.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontColor},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:w.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontFamily},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:w.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontSize},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataLabels,propertyName:w.visuals.decompositionTreeObjectPropertyNames.dataLabelFontColor},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataLabels,propertyName:w.visuals.decompositionTreeObjectPropertyNames.dataLabelFontFamily},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataLabels,propertyName:w.visuals.decompositionTreeObjectPropertyNames.dataLabelFontSize},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataLabels,propertyName:w.visuals.decompositionTreeObjectPropertyNames.dataLabelDisplayUnits},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataLabels,propertyName:w.visuals.decompositionTreeObjectPropertyNames.dataLabelPrecision},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataBars,propertyName:w.visuals.decompositionTreeObjectPropertyNames.dataBarBackgroundColor},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataBars,propertyName:w.visuals.decompositionTreeObjectPropertyNames.dataBarWidthPercent},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.levelHeader,propertyName:w.visuals.decompositionTreeObjectPropertyNames.levelHeaderBackgroundColor},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.levelHeader,propertyName:w.visuals.decompositionTreeObjectPropertyNames.levelTitleFontColor},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.levelHeader,propertyName:w.visuals.decompositionTreeObjectPropertyNames.levelTitleFontFamily},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.levelHeader,propertyName:w.visuals.decompositionTreeObjectPropertyNames.levelTitleFontSize},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.levelHeader,propertyName:w.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontColor},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.levelHeader,propertyName:w.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontFamily},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.levelHeader,propertyName:w.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontSize},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.levelHeader,propertyName:w.visuals.decompositionTreeObjectPropertyNames.showSubtitles},version:u.ExplorationVersions.v5_6},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.tree,propertyName:w.visuals.decompositionTreeObjectPropertyNames.connectorDefaultColor},version:u.ExplorationVersions.v5_6},{types:["page"],property:{objectName:"outspacePane",propertyName:"inputBoxColor"},version:c.FilterPaneSearchBoxFormatting},{types:["page"],property:{objectName:"outspacePane",propertyName:"searchTextSize"},version:c.FilterPaneSearchBoxFormatting},{types:[w.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"navigationSection"},version:u.ExplorationVersions.v5_8},{types:[w.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"drillthroughSection"},version:u.ExplorationVersions.v5_8},{property:{objectName:"y2Axis",propertyName:"show"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secAxisLabel"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLogAxisScale"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secStart"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secEnd"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secShowAxisTitle"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secAxisStyle"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelColor"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secFontFamily"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secFontSize"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelDisplayUnits"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelPrecision"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleColor"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleFontFamily"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleFontSize"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleText"},version:c.LineChartDualAxis},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.tree,propertyName:w.visuals.decompositionTreeObjectPropertyNames.barsPerLevel},version:c.DecompTreeBarsPerLevel},{types:["page"],property:{objectName:"pageRefresh",propertyName:"refreshType"},version:c.ChangeDetectionRefresh},{property:{objectName:"visualHeader",propertyName:"showPersonalizeVisualButton"},version:c.AllowInlineExploration},{property:{objectName:"general",propertyName:"isInvertedSelectionMode"},version:c.FilterSelectAll,types:["filter"]},{types:[w.visuals.plugins.slicer.name],property:{objectName:"data",propertyName:"mode",matchByContents:function(e){return e.value===w.visuals.slicerMode.relativeTime}},version:c.RelativeTimeFilter},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"backColor",matchByContents:function(e,t){return void 0!==S(t)}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"fontColor",matchByContents:function(e,t){return void 0!==S(t)}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"icon",matchByContents:function(e,t){t=S(t);return void 0!==t&&1!==t}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"webURL",matchByContents:function(e,t){t=S(t);return void 0!==t&&1!==t}},version:u.ExplorationVersions.v5_9},{types:[w.visuals.plugins.actionButton.name],property:{objectName:"fill",propertyName:"image"},version:u.ExplorationVersions.v5_10},{types:[w.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"enabledTooltip",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[w.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"disabledTooltip",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[w.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"drillthroughSection",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[w.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"navigationSection",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[w.visuals.plugins.image.name,w.visuals.plugins.basicShape.name],property:{objectName:"visualLink",propertyName:"navigationSection"},version:u.ExplorationVersions.v5_10},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"steppedLayoutIndentation"},version:u.ExplorationVersions.v5_10},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"expandCollapseToggleType"},version:u.ExplorationVersions.v5_10},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"iconSize"},version:c.KpiScalingIndicatorIcon},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"showIcon"},version:c.KpiScalingIndicatorIcon},{types:[w.visuals.plugins.lineChart.name,w.visuals.plugins.areaChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"showAllDataPoints"},version:c.LineChartExplicitDots},{types:[w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.heatMap.name],property:{objectName:"dataPoint",propertyName:"transparency"},version:c.BingMapStyling},{types:[w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"minZoom"},version:c.BingMapStyling},{types:[w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"maxZoom"},version:c.BingMapStyling},{types:[w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.heatMap.name],property:{objectName:"mapStyles",propertyName:"showLabels"},version:c.BingMapStyling},{types:[w.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"show"},version:c.BingMapStyling},{types:[w.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"strokeColor"},version:c.BingMapStyling},{types:[w.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"strokeWidth"},version:c.BingMapStyling},{types:[w.visuals.plugins.textbox.name],property:__assign(__assign({},w.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(w.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.textRuns))for(var o=0,n=a.textRuns;o<n.length;o++){var s=n[o];if(w.ParagraphsDefinition.isTextRunConditionalDefinition(s))return!0}}return!1}}),version:c.ConditionalParagraphs},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.tree,propertyName:w.visuals.decompositionTreeObjectPropertyNames.defaultClickAction},version:c.DecompositionTreeVisual},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.tree,propertyName:w.visuals.decompositionTreeObjectPropertyNames.responsiveLayout},version:c.DecompositionTreeVisual},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.tree,propertyName:w.visuals.decompositionTreeObjectPropertyNames.effectiveBarsPerLevel},version:c.DecompositionTreeVisual},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataBars,propertyName:w.visuals.decompositionTreeObjectPropertyNames.dataBarColor},version:c.DecompositionTreeVisual},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataBars,propertyName:w.visuals.decompositionTreeObjectPropertyNames.axisStart},version:c.DecompositionTreeVisual},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.dataBars,propertyName:w.visuals.decompositionTreeObjectPropertyNames.axisEnd},version:c.DecompositionTreeVisual},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"general",propertyName:"formatString"},version:c.DecompositionTreeVisual},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"warningColor"},version:c.QnaWarningUnderlineColor},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"text"},version:c.SlicerHeaderText},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.scatterChart.name],property:{objectName:"legend",propertyName:"showGradientLegend"},version:c.GradientLegend},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"commitButtonBackgroundColor"},version:c.QnaActionButtonsColor},{property:{objectName:"dropShadow",propertyName:"*"},version:c.DropShadow},{types:["page"],property:{objectName:"personalizeVisual",propertyName:"perspectiveRef"},version:c.PersonalizeVisualPerspective},{types:["page"],property:{objectName:"personalizeVisual",propertyName:"show"},version:c.PersonalizeVisualPerspectiveToggle},{property:{objectName:"general",propertyName:"keepLayerOrder"},version:c.KeepLayerOrder},{property:w.visuals.textboxProps.values.expr,types:[w.visuals.plugins.textbox.name],version:c.NarrativeVisual},{property:w.visuals.textboxProps.values.formatString,types:[w.visuals.plugins.textbox.name],version:c.NarrativeVisual},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"show"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"color"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"labelDisplayUnits"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"labelPrecision"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"enableBackground"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"backgroundColor"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"backgroundTransparency"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"fontSize"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"fontFamily"},version:c.StackedTotalDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name],property:{objectName:"totals",propertyName:"showPositiveAndNegative"},version:c.StackedTotalDataLabels},{property:{objectName:"outspacePane",propertyName:"checkboxAndApplyColor"},types:["page"],version:c.FilterPaneCheckboxAndApplyColor},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.show},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.transform},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:e.sensitivitySliceName},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.displayName},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.markerShape},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.markerShapeSize},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.markerColor},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.confidenceBandStyle},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.transparency},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.confidenceBandColor},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:w.visuals.AnomalyDetectionColumns.CategoryValue},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:w.visuals.AnomalyDetectionColumns.Value},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:w.visuals.AnomalyDetectionColumns.ExpectedValue},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:w.visuals.AnomalyDetectionColumns.ExpectedLow},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:w.visuals.AnomalyDetectionColumns.ExpectedHigh},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:w.visuals.AnomalyDetectionColumns.BatchStart},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:w.visuals.AnomalyDetectionColumns.BatchEnd},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:e.explainByPropertyName},version:c.AnomalyDetection},{types:[w.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:e.isAnomalyHighlighted},version:c.AnomalyDetection},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:w.visuals.decompositionTreeObjectNames.insights,propertyName:w.visuals.decompositionTreeObjectPropertyNames.isAINode},version:c.DecompositionInsights},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.comboChart.name,w.visuals.plugins.dataDotClusteredColumnComboChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"zoom",propertyName:"*"},version:c.AxisZoom},{types:C,property:{objectName:"subheader",propertyName:"fontFamily"},version:c.CartesianSmallMultiples},{types:C,property:{objectName:"subheader",propertyName:"fontSize"},version:c.CartesianSmallMultiples},{types:C,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!1},version:c.CartesianSmallMultiples},{types:C,property:{objectName:"subheader",propertyName:"alignment"},version:c.CartesianSmallMultiples},{types:C,property:{objectName:"subheader",propertyName:"position"},version:c.CartesianSmallMultiples},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"layoutType"},version:c.CartesianSmallMultiples},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"rowCount"},version:c.CartesianSmallMultiples},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"columnCount"},version:c.CartesianSmallMultiples},{property:{objectName:"dataPoint",propertyName:"fill",isExprBound:!0},version:c.AzureMapConditionalColor,types:[w.visuals.plugins.azureMap.name]},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!1},version:c.CartesianSmallMultiplesGridlines},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundTransparency"},version:c.CartesianSmallMultiplesGridlines},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineType"},version:c.CartesianSmallMultiplesGridlines},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineColor"},version:c.CartesianSmallMultiplesGridlines},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineWidth"},version:c.CartesianSmallMultiplesGridlines},{types:C,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineStyle"},version:c.CartesianSmallMultiplesGridlines},{types:[a.map.name,a.filledMap.name,a.heatMap.name],property:{objectName:"mapControls",propertyName:"geocodingCulture"},version:c.MapGeocodingCulture},{types:[w.visuals.plugins.azureMap.name],property:{objectName:"mapControls",propertyName:"showSelectionControl"},version:c.AzureMapSelectionControl},{types:C,property:{objectName:"subheader",propertyName:"titleWrap"},version:c.CartesianSmallMultiplesSubheaderFormatting},{types:["group"],property:{objectName:"lockAspect",propertyName:"show"},version:c.VisualContainerGroupLockAspect},{types:[w.visuals.plugins.lineChart.name],property:{objectName:"xAxisReferenceLine",propertyName:"*"},version:c.lineChartVerticalReferenceLine},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"gridPadding"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"advancedPaddingOptions"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"columnPaddingInner"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"columnPaddingOuter"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"rowPaddingInner"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"rowPaddingOuter"},version:c.CartesianSmallMultiplesPadding},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontFamily"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontSize"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!1},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"alignment"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"position"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"layoutType"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"rowCount"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"columnCount"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!1},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundTransparency"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineType"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineColor"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineWidth"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineStyle"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"titleWrap"},version:c.CartesianSmallMultiplesCombo},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.comboChart.name,w.visuals.plugins.dataDotClusteredColumnComboChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"categoryAxis",propertyName:"invertAxis"},version:c.InvertAxis},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.comboChart.name,w.visuals.plugins.dataDotClusteredColumnComboChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"invertAxis"},version:c.InvertAxis},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.comboChart.name,w.visuals.plugins.dataDotClusteredColumnComboChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"y2Axis",propertyName:"secInvertAxis"},version:c.InvertAxis},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.comboChart.name,w.visuals.plugins.dataDotClusteredColumnComboChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"valueAxis",propertyName:"secInvertAxis"},version:c.InvertAxis},{property:{objectName:"visualTooltip",propertyName:"actionFontColor"},version:c.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedTitleFontColor"},version:c.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedValueFontColor"},version:c.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedBackground"},version:c.EnhancedTooltips},{property:{objectName:"fill",propertyName:"fillColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[w.visuals.plugins.shape.name]},{property:{objectName:"outline",propertyName:"lineColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[w.visuals.plugins.shape.name]},{property:{objectName:"text",propertyName:"text",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[w.visuals.plugins.shape.name]},{property:{objectName:"text",propertyName:"fontColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[w.visuals.plugins.shape.name]},{property:{objectName:"shadow",propertyName:"color",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[w.visuals.plugins.shape.name]},{property:{objectName:"glow",propertyName:"color",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[w.visuals.plugins.shape.name]},{types:[a.map.name,a.filledMap.name,w.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"showLassoButton"},version:c.ShowLassoButton},{types:[w.visuals.plugins.lineChart.name,w.visuals.plugins.areaChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return!t||t.data&&1===t.data.length&&o.isWildcard(t.data[0])}},version:c.LineChartExplicitDotsDefault},{types:[a.shapeMap.name],property:{objectName:"shape",propertyName:"map",matchByContents:function(e){if(e){e=e.name;if(e)return e.value===p.franceRegionsV2}return!1}},version:c.ShapeMapFranceUpdatedRegions},{property:{objectName:"visualHeaderTooltip",propertyName:"themedTitleFontColor"},version:c.EnhancedTooltipsForVisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"themedBackground"},version:c.EnhancedTooltipsForVisualHeaderTooltip},{types:[w.visuals.plugins.lineChart.name,w.visuals.plugins.areaChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"transparency"},version:c.AreaChartTransparency},{types:x,property:{objectName:"subheader",propertyName:"show"},version:c.SmallMultiplesResponsive},{types:x,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!0},version:u.ExplorationVersions.v5_22},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!0},version:u.ExplorationVersions.v5_22},{types:__spreadArray([w.visuals.plugins.azureMap.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"legend",propertyName:"labelColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:__spreadArray([w.visuals.plugins.azureMap.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.funnel.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name],u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes),property:{objectName:"dataPoint",propertyName:"fill",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:__spreadArray([w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.funnel.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.sunburst.name,w.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingLabelVisualTypes),property:{objectName:"labels",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingTotalsVisualTypes,property:{objectName:"totals",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.funnel.name],property:{objectName:"categoryAxis",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"start",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"end",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"titleColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"gridlineColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingVisualTypes,property:{objectName:"categoryAxis",propertyName:"labelColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"start",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"end",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"titleColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"gridlineColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingVisualTypes,property:{objectName:"valueAxis",propertyName:"labelColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes,property:{objectName:"valueAxis",propertyName:"secStart",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes,property:{objectName:"valueAxis",propertyName:"secEnd",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.lineChart.name],property:{objectName:"y2Axis",propertyName:"secStart",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.lineChart.name],property:{objectName:"y2Axis",propertyName:"secEnd",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.multiRowCard.name,w.visuals.plugins.treemap.name],property:{objectName:"categoryLabels",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"min",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"max",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"target",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.slicer.name],property:{objectName:"slider",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.slicer.name],property:{objectName:"header",propertyName:"fontColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[w.visuals.plugins.slicer.name],property:{objectName:"header",propertyName:"background",isExprBound:!0},version:c.ConditionalFormattingUpdates},{property:{objectName:"visualLink",propertyName:"showDefaultTooltip"},version:c.SuppressDefaultTooltip},{property:{objectName:"shape",propertyName:"arrowheadSize"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"arrowStemWidth"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"chevronAngle"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"isocelesTriangleTipPosition"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"parallelogramSlant"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"trapezoidSlant"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"hexagonSlant"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"octagonSnipSize"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleHeight"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleTailPosition"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleTailAngle"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"rectangleRoundedCurve"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeTopRight"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeTop"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeBottom"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerTopRight"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerTop"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerBottom"},version:c.ShapeFormattingFeatures,types:[w.visuals.plugins.shape.name,w.visuals.plugins.actionButton.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"*"},version:c.XAxisRefLineImprovements,types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.comboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.stackedAreaChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"value",isExprBound:!0},version:c.XAxisRefLineImprovements,types:[w.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeRegion"},version:c.XAxisRefLineImprovements,types:[w.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeColor"},version:c.XAxisRefLineImprovements,types:[w.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeTransparency"},version:c.XAxisRefLineImprovements,types:[w.visuals.plugins.lineChart.name]},{property:{objectName:"title",propertyName:"heading"},version:c.AccessibilityTopLevelNav},{property:{objectName:"text",propertyName:"leftMargin"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"rightMargin"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"topMargin"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"bottomMargin"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"image"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"leftMargin"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"rightMargin"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"topMargin"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"bottomMargin"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"placement"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"iconSize"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"*"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"shadow",propertyName:"*"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"glow",propertyName:"*"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"rotation",propertyName:"*"},version:c.ButtonTileFormatting,types:[w.visuals.plugins.actionButton.name]},{property:{objectName:"seriesLabels",propertyName:"*"},version:c.LineChartSeriesLabels,types:[w.visuals.plugins.comboChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.areaChart.name,w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name]},{types:[w.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"totalsEnabled"},version:c.WaterfallChartTotals},{types:[w.visuals.plugins.azureMap.name],property:{objectName:"heatMapLayer",propertyName:"*"},version:c.AzureMapHeatmapLayer},{types:[w.visuals.plugins.pageNavigator.name,w.visuals.plugins.bookmarkNavigator.name],property:{objectName:"background",propertyName:"show"},version:c.NavigatorVisuals},{types:[w.visuals.plugins.pageNavigator.name,w.visuals.plugins.bookmarkNavigator.name],property:{objectName:"visualHeader",propertyName:"show"},version:c.NavigatorVisuals},{property:{objectName:"slices",propertyName:"startAngle"},version:c.DonutChartStartAngle,types:[w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name]},{types:[w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"borderWidth"},version:c.PieChartMarginBetweenSlices},{types:[w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"borderColor"},version:c.PieChartMarginBetweenSlices},{types:[w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"explode"},version:c.PieChartMarginBetweenSlices},{types:[w.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"innerRadiusRatio"},version:c.PieChartMarginBetweenSlices},{types:__spreadArray([w.visuals.plugins.azureMap.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name,w.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"legend",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.azureMap.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name,w.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"legend",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.azureMap.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name,w.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"legend",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.funnel.name,w.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.funnel.name,w.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.funnel.name,w.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"titleBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"titleItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"titleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"titleBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"titleItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"titleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secTitleBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secTitleItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secTitleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secTitleBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secTitleItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secTitleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.azureMap.name,w.visuals.plugins.card.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.funnel.name,w.visuals.plugins.gauge.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"labels",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.azureMap.name,w.visuals.plugins.card.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.funnel.name,w.visuals.plugins.gauge.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"labels",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([w.visuals.plugins.azureMap.name,w.visuals.plugins.card.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.funnel.name,w.visuals.plugins.gauge.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"labels",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"seriesLabels",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"seriesLabels",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"seriesLabels",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.azureMap.name,w.visuals.plugins.card.name,w.visuals.plugins.multiRowCard.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name,w.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.azureMap.name,w.visuals.plugins.card.name,w.visuals.plugins.multiRowCard.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name,w.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.azureMap.name,w.visuals.plugins.card.name,w.visuals.plugins.multiRowCard.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.map.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.treemap.name,w.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleBold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleItalic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleUnderline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelBold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelItalic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelUnderline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelBold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelItalic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelUnderline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleBold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleItalic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleUnderline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleBold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleItalic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"subheader",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"subheader",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"subheader",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionBold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionItalic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionUnderline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerBold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerItalic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerUnderline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardBold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardItalic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardUnderline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[w.visuals.plugins.textbox.name],property:__assign(__assign({},w.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(w.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.listType))return!0}return!1}}),version:c.TextboxSuperSubScriptBulletedList},{types:[a.rdlVisual.name],property:{objectName:"toolbar",propertyName:"pageNavigation"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"toolbar",propertyName:"useFloatingToolbar"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"toolbar",propertyName:"openReportButton"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"toolbar",propertyName:"position"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"show"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"exportExcel"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"exportPDF"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"exportAccessiblePDF"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"exportCSV"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"exportPPTX"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"exportWord"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"exportMHTML"},version:c.RdlVisualToolbarConfig},{types:[a.rdlVisual.name],property:{objectName:"export",propertyName:"exportXML"},version:c.RdlVisualToolbarConfig},{property:w.visuals.scorecardProps.scorecard.showCommandBar,types:[a.scorecard.name],version:c.ScorecardCommandBarToggle},{types:[w.visuals.plugins.azureMap.name],property:{objectName:"heatMapLayer",propertyName:"mapTransparency"},version:c.AzureMapHeatmapOpacityToTransparency},{types:[w.visuals.plugins.tableEx.name,w.visuals.plugins.pivotTable.name],property:{objectName:"sparklines",propertyName:"*"},version:c.Sparklines},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"hideDatePickerButton"},version:c.SlicerAccessibility},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"padding"},version:c.SlicerAccessibility},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"accessibilityContrastProperties"},version:c.SlicerAccessibility},{types:[w.visuals.plugins.azureMap.name],property:{objectName:"mapControls",propertyName:"geocodingCulture"},version:c.AzureMapsGeocoding},{types:[w.visuals.plugins.comboChart.name,w.visuals.plugins.dataDotClusteredColumnComboChart.name,w.visuals.plugins.dataDotStackedColumnComboChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name],property:{objectName:"legend",propertyName:"legendMarkerRendering"},version:c.RemoveDefaultToCircleToggle},{types:[w.visuals.plugins.tableEx.name,w.visuals.plugins.pivotTable.name],property:{objectName:"grid",propertyName:"outlineStyle"},version:c.UpgradeOutlineProperties},{types:[w.visuals.plugins.tableEx.name,w.visuals.plugins.pivotTable.name],property:{objectName:"columnHeaders",propertyName:"outlineWeight"},version:c.UpgradeOutlineProperties},{types:[w.visuals.plugins.tableEx.name,w.visuals.plugins.pivotTable.name],property:{objectName:"columnHeaders",propertyName:"outlineColor"},version:c.UpgradeOutlineProperties},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"outlineWeight"},version:c.UpgradeOutlineProperties},{types:[w.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"outlineColor"},version:c.UpgradeOutlineProperties},{types:[w.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"outlineWeight"},version:c.UpgradeOutlineProperties},{types:[w.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"outlineColor"},version:c.UpgradeOutlineProperties},{types:[w.visuals.plugins.tableEx.name,w.visuals.plugins.pivotTable.name],property:{objectName:"values",propertyName:"outlineWeight"},version:c.UpgradeOutlineProperties},{types:[w.visuals.plugins.tableEx.name,w.visuals.plugins.pivotTable.name],property:{objectName:"values",propertyName:"outlineColor"},version:c.UpgradeOutlineProperties},{property:{objectName:"visualHeaderTooltip",propertyName:"type"},version:c.SplitHelpTooltip},{property:{objectName:"legend",propertyName:"position",matchByContents:function(e,t){e=e&&e.value;return e===i.topRight||e===i.bottomRight}},version:c.LegendPositionNewFormatPane,types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.azureMap.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.filledMap.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.map.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.shapeMap.name,w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.treemap.name,w.visuals.plugins.waterfallChart.name]},{types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],property:{objectName:"stylePreset",propertyName:"name",matchByContents:function(e){return e.value===w.visuals.stylePresets.TablixStylePresetsName.AlternatingRowsNew}},version:c.NewAlternatingRowsStyle},{types:[w.visuals.plugins.tableEx.name],property:{objectName:"accessibility",propertyName:"altTextColumns"},version:c.AltTextColumns},{types:[w.visuals.plugins.tableEx.name],property:{objectName:"accessibility",propertyName:"rowWithReferenceText"},version:c.RowWithReferenceText},{types:[w.visuals.plugins.lineChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.ribbonChart.name],property:{objectName:"error",propertyName:"*"},version:c.ErrorBars},{types:[w.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"fontFamily"},version:c.GaugeChartCalloutTextFormatting},{types:[w.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"bold"},version:c.GaugeChartCalloutTextFormatting},{types:[w.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"italic"},version:c.GaugeChartCalloutTextFormatting},{types:[w.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"underline"},version:c.GaugeChartCalloutTextFormatting},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"handleBorderColor",isExprBound:!0},version:c.SlicerSliderColors},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"handleFillColor",isExprBound:!0},version:c.SlicerSliderColors},{types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"secondaryLineColor",isExprBound:!0},version:c.SlicerSliderColors},{types:[w.visuals.plugins.actionButton.name,w.visuals.plugins.shape.name,w.visuals.plugins.pageNavigator.name,w.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"italic"},version:c.ShapeButtonTextFormatting},{types:[w.visuals.plugins.actionButton.name,w.visuals.plugins.shape.name,w.visuals.plugins.pageNavigator.name,w.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"bold"},version:c.ShapeButtonTextFormatting},{types:[w.visuals.plugins.actionButton.name,w.visuals.plugins.shape.name,w.visuals.plugins.pageNavigator.name,w.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"underline"},version:c.ShapeButtonTextFormatting},{property:{objectName:"visualHeaderTooltip",propertyName:"bold"},version:c.HelpTooltipBIU},{property:{objectName:"visualHeaderTooltip",propertyName:"italic"},version:c.HelpTooltipBIU},{property:{objectName:"visualHeaderTooltip",propertyName:"underline"},version:c.HelpTooltipBIU},{types:[w.visuals.plugins.azureMap.name],property:{objectName:"filledMap",propertyName:"*"},version:c.AzureMapsFilledMap},{types:[w.visuals.plugins.scatterChart.name,w.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleItalic"},version:c.CartesianBiuFontProperties},{types:[w.visuals.plugins.scatterChart.name,w.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleBold"},version:c.CartesianBiuFontProperties},{types:[w.visuals.plugins.scatterChart.name,w.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleUnderline"},version:c.CartesianBiuFontProperties},{types:[w.visuals.plugins.scatterChart.name,w.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleItalic"},version:c.CartesianBiuFontProperties},{types:[w.visuals.plugins.scatterChart.name,w.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleBold"},version:c.CartesianBiuFontProperties},{types:[w.visuals.plugins.scatterChart.name,w.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleUnderline"},version:c.CartesianBiuFontProperties},{types:[w.visuals.plugins.waterfallChart.name,w.visuals.plugins.treemap.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.areaChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.pieChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.comboChart.name,w.visuals.plugins.donutChart.name,w.visuals.plugins.funnel.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"labels",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:c.ConditionalFormattingDataLabels},{types:[w.visuals.plugins.treemap.name],property:{objectName:"categoryLabels",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:c.ConditionalFormattingDataLabels},{types:[w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name],property:{objectName:"totals",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:c.ConditionalFormattingDataLabels},{types:[w.visuals.plugins.barChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"categoryAxis",propertyName:"reverseStackOrder"},version:c.ReverseStackOrder},{types:[a.shapeMap.name],property:{objectName:"shape",propertyName:"map",matchByContents:function(e){if(e){e=e.name;if(e)return e.value===p.irelandCountiesV2}return!1}},version:c.ShapeMapIrelandLaoisSpelling},{types:[w.visuals.plugins.azureMap.name],property:{objectName:"categoryLabels",propertyName:"*"},version:c.AzureMapsCategoryLabels},{types:[w.visuals.plugins.azureMap.name],property:{objectName:"mapControls",propertyName:"showLabels"},version:c.AzureMapsShowLabels},{types:x,property:{objectName:"valueAxis",propertyName:"sharedAxis"},version:c.SmallMultiplesUnsharedAxes},{types:x,property:{objectName:"valueAxis",propertyName:"scaleToFit"},version:c.SmallMultiplesUnsharedAxes},{property:{objectName:"title",propertyName:"paddingTop"},version:c.VisualTitleContainerPadding},{property:{objectName:"title",propertyName:"paddingBottom"},version:c.VisualTitleContainerPadding},{property:{objectName:"title",propertyName:"paddingLeft"},version:c.VisualTitleContainerPadding},{property:{objectName:"title",propertyName:"paddingRight"},version:c.VisualTitleContainerPadding},{property:{objectName:"border",propertyName:"paddingTop"},version:c.VisualTitleContainerPadding},{property:{objectName:"border",propertyName:"paddingBottom"},version:c.VisualTitleContainerPadding},{property:{objectName:"border",propertyName:"paddingLeft"},version:c.VisualTitleContainerPadding},{property:{objectName:"border",propertyName:"paddingRight"},version:c.VisualTitleContainerPadding},{types:[w.visuals.plugins.textbox.name],property:__assign(__assign({},w.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(w.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.textRuns))for(var o=0,n=a.textRuns;o<n.length;o++){var s=n[o];if(w.ParagraphsDefinition.isTextRunDefinition(s)&&s.mentionEmail)return!0}}return!1}}),version:c.TextboxAtMention},{types:[a.scorecard.name],property:{objectName:"scorecard",propertyName:"displayMode"},version:c.GoalVisual},{types:[a.scorecard.name],property:{objectName:"scorecard",propertyName:"goalIds"},version:c.GoalVisual},{types:[a.scorecard.name],property:{objectName:"visualization",propertyName:l},version:c.GoalVisual},{types:x,property:{objectName:"valueAxis",propertyName:"sharedAxis"},version:c.SmallMultiplesUnsharedAxes},{types:x,property:{objectName:"valueAxis",propertyName:"scaleToFit"},version:c.SmallMultiplesUnsharedAxes},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"labels",propertyName:"showByDefault"},version:c.OnObjectShowByDefault},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"seriesLabels",propertyName:"showByDefault"},version:c.OnObjectShowByDefault},{types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.stackedAreaChart.name],property:{objectName:"lineStyles",propertyName:"showMarkerByDefault"},version:c.OnObjectShowByDefault},{types:[w.visuals.plugins.lineChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name],property:{objectName:"error",propertyName:"showMarkerByDefault"},version:c.OnObjectShowByDefault}];var b,E=["minColor","midColor","maxColor","nullColor"];function N(t){if(t instanceof n)return!!_.find(E,(function(e){return e===t.value}));if(t instanceof Object&&!(t instanceof Function))for(var e=0,r=Object.keys(t);e<r.length;e++){var i=r[e];if(N(t[i]))return!0}return!1}function V(e,t,r){function i(e,t){return(e=e&&e[t.objectName])&&e[t.propertyName]}var a=r[e],e=(r[e]||(a=r[e]={}),t.currentId.objectName),o=(o=a[e])||(a[e]={}),e=t.previousId,a=i(a,e)||i(r[l],e);o[t.currentId.propertyName]=__assign(__assign({},t),{previous:a})}function P(e,t,r){var i=r[e],r=(r[e]||(i=r[e]={}),t.property.objectName),e=(e=i[r])||(i[r]={}),i=t.property.propertyName,r=e[i];(r=r||(e[i]=[])).push(t),1!==r.length&&m.lt(r[r.length-1].version,r[r.length-2].version)}u.RenamedObjectPropertyVersions=[{currentId:{objectName:"dataPoint",propertyName:"fill"},previousId:{objectName:"dataPoint",propertyName:"defaultCategoryColor"},version:u.ExplorationVersions.v3_19,types:u.DefaultCategoryColorVisualsToUpgrade},{currentId:{objectName:"columnTotal",propertyName:"fontColor"},previousId:{objectName:"total",propertyName:"fontColor"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontColor"},previousId:{objectName:"total",propertyName:"fontColor"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"fontFamily"},previousId:{objectName:"total",propertyName:"fontFamily"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontFamily"},previousId:{objectName:"total",propertyName:"fontFamily"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"fontSize"},previousId:{objectName:"total",propertyName:"fontSize"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontSize"},previousId:{objectName:"total",propertyName:"fontSize"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"bold"},previousId:{objectName:"total",propertyName:"bold"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"bold"},previousId:{objectName:"total",propertyName:"bold"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"italic"},previousId:{objectName:"total",propertyName:"italic"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"italic"},previousId:{objectName:"total",propertyName:"italic"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"underline"},previousId:{objectName:"total",propertyName:"underline"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"underline"},previousId:{objectName:"total",propertyName:"underline"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"backColor"},previousId:{objectName:"total",propertyName:"backColor"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"backColor"},previousId:{objectName:"total",propertyName:"backColor"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"applyToHeaders"},previousId:{objectName:"total",propertyName:"applyToHeaders"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"applyToHeaders"},previousId:{objectName:"total",propertyName:"applyToHeaders"},types:[w.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"visualLink",propertyName:"showDefaultTooltip"},previousId:{objectName:"visualLink",propertyName:"suppressDefaultTooltip"},types:[w.visuals.plugins.pivotTable.name],version:c.ShowDefaultTooltip,upgrader:u.UpgradeUtils.convertSuppressDefaultTooltip,featureSwitch:"showDefaultTooltip"},{currentId:{objectName:"fillPoint",propertyName:"style"},previousId:{objectName:"fillPoint",propertyName:"show"},types:[w.visuals.plugins.scatterChart.name],version:c.FillPointShowToStyle,upgrader:u.UpgradeUtils.convertScatterChartFillPoint,featureSwitch:"fillPointStyle"},{currentId:{objectName:"categoryAxis",propertyName:"switchAxisPosition"},previousId:{objectName:"categoryAxis",propertyName:"position"},types:[w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.ribbonChart.name],version:c.PositionToSwitchAxisPosition,upgrader:u.UpgradeUtils.convertAxisPositionProperty,featureSwitch:"switchAxisPosition"},{currentId:{objectName:"valueAxis",propertyName:"switchAxisPosition"},previousId:{objectName:"valueAxis",propertyName:"position"},version:c.PositionToSwitchAxisPosition,types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisPositionProperty,featureSwitch:"switchAxisPosition"},{currentId:{objectName:"categoryAxis",propertyName:"logAxisScale"},previousId:{objectName:"categoryAxis",propertyName:"axisScale"},version:c.AxisScaleToLogAxisScale,types:[w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"logAxisScale"},{currentId:{objectName:"valueAxis",propertyName:"logAxisScale"},previousId:{objectName:"valueAxis",propertyName:"axisScale"},version:c.AxisScaleToLogAxisScale,types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.ribbonChart.name,w.visuals.plugins.scatterChart.name,w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"logAxisScale"},{currentId:{objectName:"y2Axis",propertyName:"secLogAxisScale"},previousId:{objectName:"y2Axis",propertyName:"secAxisScale"},version:c.AxisScaleToLogAxisScale,types:[w.visuals.plugins.areaChart.name,w.visuals.plugins.lineChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name,w.visuals.plugins.stackedAreaChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"logAxisScale"},{currentId:{objectName:"valueAxis",propertyName:"secLogAxisScale"},previousId:{objectName:"valueAxis",propertyName:"secAxisScale"},version:c.AxisScaleToLogAxisScale,types:[a.comboChart.name,a.dataDotClusteredColumnComboChart.name,a.dataDotStackedColumnComboChart.name,a.lineClusteredColumnComboChart.name,a.lineStackedColumnComboChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"logAxisScale"},{currentId:{objectName:"columnHeaders",propertyName:"outlineStyle"},previousId:{objectName:"columnHeaders",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"rowHeaders",propertyName:"outlineStyle"},previousId:{objectName:"rowHeaders",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"values",propertyName:"outlineStyle"},previousId:{objectName:"values",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"total",propertyName:"outlineStyle"},previousId:{objectName:"total",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"grid",propertyName:"outlineStyle"},previousId:{objectName:"grid",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.pivotTable.name,w.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"header",propertyName:"outlineStyle"},previousId:{objectName:"header",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"searchBox",propertyName:"outlineStyle"},previousId:{objectName:"searchBox",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"items",propertyName:"outlineStyle"},previousId:{objectName:"items",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.slicer.name,w.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"card",propertyName:"outlineStyle"},previousId:{objectName:"card",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[w.visuals.plugins.multiRowCard.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"categoryAxis",propertyName:"logAxisScale"},previousId:{objectName:"categoryAxis",propertyName:"axisScale"},version:c.RemainingCategoryLogAxisScale,types:[a.areaChart.name,a.lineChart.name,a.lineClusteredColumnComboChart.name,a.lineStackedColumnComboChart.name,a.scatterChart.name,a.stackedAreaChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"remainingCartesianCategoryLogAxisScale"}],u.UpdatedObjectPropertyVersions=[{property:{objectName:"categoryAxis",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"categoryAxis",propertyName:"titleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"titleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"secFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"secTitleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"visualTooltip",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"outspacePane",propertyName:"titleSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"outspacePane",propertyName:"headerSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"filterCard",propertyName:"textSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader}],u.ObjectVersioning=(b=u.AddedObjectPropertyVersions,t=u.RenamedObjectPropertyVersions,e=u.UpdatedObjectPropertyVersions,_.find(t,(function(t){return _.find(b,(function(e){return(!t.types||!e.types||_.find(t.types,(function(t){return _.find(e.types,(function(e){return e===t}))})))&&e.property.objectName===t.previousId.objectName&&e.property.propertyName===t.previousId.propertyName&&m.lt(e.version,t.version)}))})),{added:(function(e){for(var t={},r=0;r<e.length;r++){var i=e[r];if(r&&m.lt(i.version,e[r-1].version),null!=i.types)for(var a=0,o=i.types;a<o.length;a++)P(o[a],i,t);else P(l,i,t)}return t})(b),renamed:(function(e){for(var t={},r=0,i=e.length;r<i;r++){var a=e[r];if(a.currentId.objectName===a.previousId.objectName&&(a.currentId.propertyName,a.previousId.propertyName),r&&m.lt(a.version,e[r-1].version),null!=a.types)for(var o=0,n=a.types;o<n.length;o++)V(s=n[o],a,t);else for(var s in V(l,a,t),t)V(s,a,t)}return t})(t),updated:e}),u.getVersionForObjectDefinitions=function(n,e,s,l,p){return d.visitPropertyExprs({definitions:n,descriptors:e,visitor:function(e,t,r,i){l=m.max(u.ExplorationVersionHelper.getVersionForSQExprWithDescriptor(e,i),l)}}),d.visitPropertyDefinitions(n,e,(function(e,t,r,i,a){var o=a&&a.properties[t],a=e[t];l=m.max(l,w.data.DataViewObjectVersioning.getVersionForDefinition(u.ObjectVersioning.added,a,r,s,i,t,l,(function(){var e=d.getValue(n,{objectName:i,propertyName:t},r);if(e){e=d.getDataBoundExprs(e,o.type,r,p);if(!_.isEmpty(e))return!0}return!1}))),d.isObjectPropertySQExprWithContext(a)&&(l=m.max(l,c.NarrativeVisual))})),l}})((e=T.services||(T.services={})).upgrade||(e.upgrade={}))})(powerbi=powerbi||{}),(function(e){((e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={})).UtteranceDefinitionVersions||(e.UtteranceDefinitionVersions={})).v1_0="1.0"})(powerbi=powerbi||{}),(function(n){var e,t,r,i,s,l,a;e=(e=n.explore||(n.explore={})).util||(e.util={}),i=n.explore.services.upgrade.CurrentExplorationVersion,s=n.data.DataViewObjectDefinitions,l=n.explore.contracts.ExplorationObjectDescriptors,a=n.explore.services.upgrade.ExplorationVersions,t=e.ThemeUtils||(e.ThemeUtils={}),r="CY18SU07",t.baseThemeVersions={CY17SU10:a.v3_6,CY17SU12:a.v3_7,CY18SU04:a.v3_12,CY18SU07:a.v3_15,CY19SU06:a.v5_3,CY19SU12:a.v5_6,CY20SU07:a.v5_13,CY20SU09:a.v5_15,CY21SU02:a.v5_18,CY21SU03:a.v5_19,CY21SU04:a.v5_20,CY21SU07:a.v5_24,CY21SU11:a.v5_27,CY22SU03:a.v5_30,CY22SU08:a.v5_35,CY22SU09:a.v5_37,CY22SU11:a.v5_40},t.ClassicBaseThemeName="Classic",t.DefaultBaseThemeName="Default",t.CustomThemeName="Custom",t.ClassicBaseThemeBuiltInThemeNames=["Classic","CityPark","Classroom","ColorblindSafe","Electric","HighContrast","Sunset","Twilight"],t.getVersionForBaseTheme=function(e){return t.baseThemeVersions[e]||a.v3_6},t.getThemeMetadata=function(e,t,r){return n.getThemeMetadata(e,t,r||i)},t.getCurrentBaseThemeMetadata=function(e){return{name:e&&e.featureSwitches&&e.featureSwitches.useNewCY19SU06BaseTheme?"CY22SU11":r,version:i,type:2}},t.getClassicBaseThemeMetadata=function(){return{name:r,version:t.baseThemeVersions[r],type:2}},t.evaluateObjects=function(e,t,r){var i=e.themeCollection,a=n.explore.constants.ExplorationComponentType,o=e.objects,a=((a=t.getVisualObjects(i,a,void 0,l))&&(o=s.clone(o||{}),s.extend(o,a)),t.getVisualStyle(i)),t=n.data.DataViewTransform.evaluateMetadataOnceDataViewObjectDefinitions(o,l,a,r);e.evaluatedObjects=t.dataViewObjects}})(powerbi=powerbi||{}),(function(e){var t,u,r;function i(e){this.downgraders=e,this.objectsDowngrader=t.createVisualObjectsDowngrader(this.downgraders)}e=(e=e.explore||(e.explore={})).services||(e.services={}),t=e.downgrade||(e.downgrade={}),u=jsCommon.Version,t.createExplorationDowngrader=function(e){return new r(e)},i.prototype.getFinalExplorationVersion=function(e,t){t=u.max(t,this.getFinalExplorationForObjectsVersion(e,t));for(var r=0,i=this.downgraders;r<i.length;r++){var a=i[r];t=u.max(t,a.getMinDowngradeVersionForContract(e))}return t},i.prototype.downgrade=function(e,t){this.downgradeVisualObjects(e,t);for(var r=0,i=this.downgraders;r<i.length;r++)i[r].downgrade(e,t)},i.prototype.downgradeVisualObjects=function(e,t){e=e&&e.sections;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var o=0,n=a;o<n.length;o++){var s,l,p=n[o],p=p&&p.config&&p.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&this.objectsDowngrader.downgrade(2,l,s,t),(l=p.objects)&&this.objectsDowngrader.downgrade(1,l,s,t))}}},i.prototype.getFinalExplorationForObjectsVersion=function(e,t){e=e&&e.sections;if(e){for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var o=0,n=a;o<n.length;o++){var s,l,p=n[o],p=p&&p.config&&p.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&(t=u.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(2,l,t,s))),(l=p.objects)&&(t=u.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(1,l,t,s))))}}return t}},r=i,t.ExplorationDowngrader=r})(powerbi=powerbi||{}),(function(h){var c,d,f,y,m,C,a,x,v,S,g,b,E,N,o,n,V,P,U,s,w,l,z,L,p,T,F,q,u,j,R,D,A,I,G,O,Q,k,t;function e(e,t,r,i,a,o,n){this.visualPlugins=e,this.telemetryService=t,this.featureSwitchService=r,this.canvasListOrderNormalizeService=i,this.contextActivityService=a,this.userState=o,this.explorationUpgrader=d.upgrade.createExplorationUpgrader(r),this.explorationDowngrader=d.downgrade.createExplorationDowngrader(n)}function M(e,t,r,i){this.visualPlugins=e,this.explorationDowngrader=t,this.telemetryService=r,this.featureSwitchService=i,this.version=k}function H(e){null!=e.x&&null!=e.y&&null!=e.width&&null!=e.height||(jsCommon.Trace.error("deserializeVisualContainer found null in layout position: "+JSON.stringify({x:e.x,y:e.y,width:e.width,height:e.height})),null==e.x&&(e.x=0),null==e.y&&(e.y=0),null==e.width&&(e.width=0),null==e.height&&(e.height=0))}function B(e){return void 0!==e.children}c=h.explore||(h.explore={}),d=c.services||(c.services={}),f=jsCommon.ArrayExtensions,y=h.explore.contracts.BookmarkExtensions,m=h.explore.services.upgrade.ComboSmallMultipleFormattingVisualTypes,C=h.explore.contracts,a=h.explore.services.upgrade.CurrentExplorationVersion,x=h.common.contracts.DataCacheModeType,v=h.data.DataViewObjectDefinitions,S=h.data.services.DataViewObjectSerializer,g=h.data.services.DisplayNameSerializer,b=h.data.ExpansionState,E=h.data.services.ExpansionStateSerializer,N=h.explore.services.upgrade.ExplorationFeatureVersions,o=h.explore.services.upgrade.ExplorationStateFeatureVersions,n=h.explore.services.upgrade.ExplorationStateVersions,V=h.explore.services.upgrade.ExplorationVersions,P=h.data.services.FilterExpressionMetadataSerializer,U=C.FilterContainer.ObjectType,s=C.FilterContainer.CommonObjectDescriptors,w=jsCommon.JsonExtensions,l=C.LinguisticSchemaSyncVersion,z=h.data.QueryProjectionCollection,L=h.contracts.ResourcePackageItemType,p=h.visualHost.utils.ResourcePackageUtils,T=h.data.services.SemanticQuerySerializer,F=h.data.SQExpr,q=h.data.SQExprUtils,u=jsCommon.StringExtensions,j=h.visualHost.ThemeUtils,R=jsCommon.Version,D=C.VisualContainer,A=C.VisualContainerGroup,I=c.util.VisualContainerUtils,G=C.VisualQuery,O="Gradient",d.createExplorationSerializer=function(e,t,r,i,a,o,n){return new Q(e,t,r,i,a,o,n)},e.prototype.deepCopyExploration=function(e,t){return this.deserializeExploration(this.serializeExploration(e,t),[],!0)},e.prototype.ensureInitialized=function(){return this.visualPlugins.ensureBuiltInPlugins()},e.prototype.deserializeExploration=function(e,t,r,i,a,o){var n=this;if(e){var s=void 0,e=(o&&(s=o.createChildActivity({name:"Upgrade Exploration"})),this.explorationUpgrader.upgrade(e,t,r,a));if(s&&(s.setProperty("upgraderCount",null==a?void 0:a.upgraderCount),s.resolve()),!e)return;e.config;var l,p,u=e.config,c={id:e.id,width:void 0,height:void 0,sections:void 0,dataSources:void 0,reportId:e.reportId,themeCollection:j.cloneThemeCollection(u.themeCollection),bookmarks:[],mwcToken:e.mwcToken,capacityUri:e.capacityUri,publicCustomVisuals:e.publicCustomVisuals},d=(u.tags&&(c.tags=_.cloneDeep(u.tags)),u.slowDataSourceSettings&&(c.slowDataSourceSettings=_.cloneDeep(u.slowDataSourceSettings)),u.settings&&(c.settings=_.cloneDeep(u.settings)),u.objects&&(c.objects=S.deserializeObjects(u.objects,C.ExplorationObjectDescriptors)),u.bookmarks&&(t=jsCommon.PerfTimer.logTime((function(){var e=n.deserializeBookmarks(u.bookmarks);f.hasUniqueNames(e),c.bookmarks=e})),o&&o.setProperty("bookmarkDeserializationDuration",t)),this.contextActivityService.upsertExplorationProperties({bookmarkCount:c.bookmarks?c.bookmarks.length:0}),e.userState&&(c.userState=this.deserializeUserState(e.userState)),e.activeWebBookmark&&(c.activeWebBookmark=this.deserializeWebBookmark(e.activeWebBookmark,r)),e.activeBookmark);if(d)for(var m=0,v=null!=(a=c.bookmarks)?a:[];m<v.length;m++){var g=v[m];if(!y.isBookmarkGroup(g)&&g.name===d.name){c.activeBookmark=g;break}}e.sections&&(s=_.sortBy(e.sections,(function(e){return void 0!==e.ordinal?e.ordinal:0})),l=c.settings&&c.settings.useStylableVisualContainerHeader,c.sections=_.map(s,(function(e){return n.deserializePage(e,l)})),c.filters=this.deserializeFilterContainers(e.filters),c.dataSources=C.createDataSourceArray(),e.resourcePackages&&(c.resourcePackages=this.deserializeResourcePackages(e.resourcePackages)),e.pods&&(c.pods=_.map(e.pods,(function(e){return n.deserializePod(e)})),f.hasUniqueNames(c.pods)),_.isNumber(u.activeSectionIndex)&&u.activeSectionIndex<e.sections.length&&(c.activeSectionIndex=u.activeSectionIndex),u.modelExtensions&&(c.modelExtensions=this.deserializeModelExtensions(u.modelExtensions)),i&&(i.lastTimeAModelChangeWasDetectedInTheCluster&&!_.isEmpty(i.onPremModelConnectionString)?(p=jsCommon.DateExtensions.deserializeDate(i.lastTimeAModelChangeWasDetectedInTheCluster),this.updateVisualContainerCachingOptions(c,p,(function(e){e.useInitialCachedQuery=!0}),(function(e){e.useInitialCachedQuery=!1}))):_.isEmpty(i.onPremModelConnectionString)&&i.dataCacheMode===x.Import&&i.lastRefreshTime&&(p=jsCommon.DateExtensions.deserializeDate(i.lastRefreshTime),this.updateVisualContainerCachingOptions(c,p,(function(e){e.disableCacheOnServerForInitialLoad=!0}),(function(e){e.disableCacheOnServerForInitialLoad=!1}))))),e.report&&(c.report=h.Prototype.inherit(e.report),e.report.linguisticSchemaId&&(c.reportHasLinguisticSchema=!0)),null!=u.defaultDrillFilterOtherVisuals&&(c.defaultDrillFilterOtherVisuals=u.defaultDrillFilterOtherVisuals),u.filterSortOrder&&(c.filterSortOrder=u.filterSortOrder),u.dataSourceVariables&&(c.dataSourceVariables=u.dataSourceVariables),u.creationSource&&(c.creationSource=u.creationSource),c.linguisticSchemaSyncVersion=this.deserializeLinguisticSchemaSyncVersion(u.linguisticSchemaSyncVersion)}return c},e.prototype.deserializeLinguisticSchemaSyncVersion=function(e){return null==e?l.Unspecified:(0 in l,e)},e.prototype.updateVisualContainerCachingOptions=function(e,t,r,i){for(var a=0,o=e.sections;a<o.length;a++)for(var n=0,s=o[a].visualContainers;n<s.length;n++){var l=s[n];(l.cachedData&&l.cachedData.dataUpdatedTime&&l.cachedData.data&&0<=+l.cachedData.dataUpdatedTime-+t?r:i)(l)}},e.prototype.deserializeResourcePackages=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];this.upgradeResourcePackage(a.resourcePackage),t.push(a.resourcePackage)}for(var o=0;o<t.length;++o)if(t[o])for(var n=t.length;--n>o;)t[n]&&t[o].name===t[n].name&&(t[n].id>t[o].id&&(t[o]=t[n]),t.splice(n,1));return t},e.prototype.deserializeLinkField=function(e){var t=T.deserializeExpr(e.fieldExpr);return F.isMeasure(t)&&!1===e.asAggregation||F.isColumn(t)||F.isHierarchyLevel(t),{asAggregation:e.asAggregation,fieldExpr:t}},e.prototype.deserializePage=function(e,t){var r,i,a=this;if(e)return r={id:e.id,objectId:e.objectId,name:e.name,displayName:e.displayName,visualContainers:void 0,visualContainerGroups:void 0,size:{displayOption:void 0!==e.displayOption?e.displayOption:0,height:e.height||c.constants.ExploreCanvasConstants.DefaultCanvasHeight,width:e.width||c.constants.ExploreCanvasConstants.DefaultCanvasWidth},filters:this.deserializeFilterContainers(e.filters)},e.transient&&(r.transient=e.transient),i=e.config,r.acceptsAllFiltersWhenLinked=i.acceptsAllFiltersWhenLinked,i.objects&&(r.objects=S.deserializeObjects(i.objects,C.Section.objectDescriptors)),null!=i.visibility&&(r.visibility=i.visibility),null!=i.type&&(r.type=i.type),null!=i.filterSortOrder&&(r.filterSortOrder=i.filterSortOrder),_.isEmpty(i.linkFields)||(r.linkFields=_.map(i.linkFields,(function(e){return a.deserializeLinkField(e)}))),i.dynamicConfig&&(r.dynamicConfig=this.deserializeDynamicConfig(i.dynamicConfig)),e.visualContainers&&((e=this.deserializeCanvasItems(e.visualContainers,null,t))?(r.visualContainers=e.visualContainers,r.visualContainerGroups=e.visualContainerGroups):(r.visualContainers=[],r.visualContainerGroups=[]),i.relationships&&(r.relationships=this.deserializeRelationships(i.relationships,r.visualContainers))),r},e.prototype.deserializePod=function(e){if(e)return{id:e.id,name:e.name,boundSection:e.boundSection,parameters:this.deserializePodParameters(e.parameters),cortanaEnabled:e.cortanaEnabled,type:void 0===e.type?0:e.type,referenceScope:void 0===e.referenceScope?0:e.referenceScope,config:this.deserializePodConfig(e.config)}},e.prototype.deserializeRelationships=function(e,t){if(!_.isEmpty(e)){for(var r,i=0,a=e;i<a.length;i++){var o=a[i],o=this.deserializeRelationship(o,t);o&&(r=r||[]).push(o)}return r}},e.prototype.deserializeBookmarks=function(e){var i=this;if(e)return _.map(e,(function(e){var t,r;return B(e)?(t={displayName:e.displayName,name:e.name,children:i.deserializeBookmarks(e.children)},_.each(t.children,(function(e){return e.parentGroup=t})),t):(r=e.explorationState,r={displayName:e.displayName,name:e.name,explorationState:d.ExplorationState.deserialize(r,i.visualPlugins,i.featureSwitchService)},e.options&&(r.options=i.deserializeBookmarkOptions(e.options)),r)}))},e.prototype.deserializeBookmarkOptions=function(e){return e},e.prototype.deserializeUserState=function(e){if(!u.isNullOrUndefinedOrWhiteSpaceString(e)){e=w.tryParseJSON(e);if(e)try{return this.userState.deserialize(e,this.visualPlugins,this.featureSwitchService)}catch(e){return e&&this.telemetryService.logEvent(h.telemetry.PersistentStateSerializationError,{stack:e.stack,message:e.message}),{explorationState:null}}}},e.prototype.deserializeWebBookmark=function(e,t){e=d.WebBookmark.deserialize(e,this.visualPlugins,this.featureSwitchService);if(e.errors&&!t)for(var r=0,i=e.errors;r<i.length;r++){var a=i[r];this.telemetryService.logEvent(h.telemetry.SerializationError,{type:"WebBookmark",errorCode:a.code,stack:a.stack,message:a.message})}return e.contract},e.prototype.deserializeModelExtensions=function(e){var r=this;return f.extendWithName(_.map(e,(function(e){var t={name:e.name,extends:e.extends};return e.entities&&(t.entities=r.deserializeModelExtensionEntities(e.entities)),t})))},e.prototype.deserializeModelExtensionEntities=function(e){var r=this;return f.extendWithName(_.map(e,(function(e){var t=e.extends?{name:e.name,extends:e.extends}:{name:e.name};return e.measures&&(t.measures=r.deserializeModelExtensionMeasures(e.measures)),t})))},e.prototype.deserializeModelExtensionMeasures=function(e){var r=this;return f.extendWithName(_.map(e,(function(e){var t={name:e.name,dataCategory:e.dataCategory,dataType:e.dataType,expression:e.expression,errorMessage:e.errorMessage,hidden:e.hidden,references:r.deserializeExpressionReferences(e.references),formulaOverride:e.formulaOverride,formatInformation:e.formatInformation,displayFolder:e.displayFolder};return e.annotations&&(t.annotations=r.deserializeModelExtensionAnnotations(e.annotations)),e.measureTemplate&&(t.measureTemplate={daxTemplateName:e.measureTemplate.daxTemplateName,version:e.measureTemplate.version}),e.description&&(t.description=e.description),t})))},e.prototype.deserializeExpressionReferences=function(e){return e?{unrecognizedReferences:!!e.unrecognizedReferences,measures:e.measures||[]}:{unrecognizedReferences:!1,measures:[]}},e.prototype.deserializeModelExtensionAnnotations=function(e){return f.extendWithName(_.map(e,(function(e){return{name:e.name,value:e.value}})))},e.prototype.deserializeDynamicConfig=function(e){var t,r,i;return e.quickExplore&&(t=e.quickExplore.selectedFields,r=e.quickExplore.visualContainerConfigurations,e=e.quickExplore.layout,(i=i||{}).quickExplore={selectedFields:_.map(t,(function(e){return T.deserializeExpr(e)})),visualContainerConfigurations:_.map(r,(function(e){return{name:e.name,fields:_.map(e.fields,(function(e){return T.deserializeExpr(e)}))}}))},e&&(i.quickExplore.layout=this.deserializeQuickExploreLayout(e))),i},e.prototype.deserializeQuickExploreLayout=function(e){var t;return e.combination?(t={version:e.combination.version},e.combination.dataTableName&&(t.dataTableName=e.combination.dataTableName),{combination:t}):e.related?(t={version:e.related.version},e.related.dataTableName&&(t.dataTableName=e.related.dataTableName),{related:t}):void 0},e.prototype.deserializeFilterCollection=function(e,t,r){if(e){e=this.explorationUpgrader.upgradeFilterCollection(e,t,r);if(e)return this.deserializeFilterContainers(e.filters)}},e.prototype.deserializeFilterContainer=function(e){return{name:e.name,type:C.FilterType[e.type],expression:e.expression?T.deserializeExpr(e.expression):void 0,filter:e.filter&&e.filter.Where?T.deserializeFilter(e.filter):void 0,restatement:e.restatement,cachedValueItems:g.deserializeFilterLabelIdPairs(e.cachedDisplayNames),howCreated:e.howCreated,isLinkedAsAggregation:e.isLinkedAsAggregation,isTransient:e.isTransient,isHiddenInViewMode:e.isHiddenInViewMode,objects:e.objects?S.deserializeObjects(e.objects,s):void 0,isLockedInViewMode:e.isLockedInViewMode,filterExpressionMetadata:e.filterExpressionMetadata?P.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0,displayName:e.displayName,ordinal:e.ordinal}},e.prototype.deserializeCanvasItems=function(e,t,r,i){if(!_.isEmpty(e)){for(var a=[],o=[],n={},s={},l=0,p=e;l<p.length;l++){var u=p[l],c=(u&&u.config,u.config),d=c.name,m=i&&i(u),u=this.deserializeCanvasItem(u,t,m),m=u.name;s[d]=m,C.isVisualContainer(u)&&a.push(u),void 0===c.parentGroupName?o.push(u):(n[c.parentGroupName]||(n[c.parentGroupName]=[]),n[c.parentGroupName].push(u))}var v,g={};for(v in n){var h=s[v];h?g[h]=n[v]:o.push.apply(o,n[v]||[])}return this.ensureVisualContainerGrouping(o,g,r),this.ensureNames(a),r?(this.ensureGroupZIndexNormalized(o),this.featureSwitchService.featureSwitches.accessibilityTopLevelNav?this.ensureGroupTabOrderNormalized(o,a):this.ensureListOrderNormalized(a,!1)):(o=__spreadArray([],a||[]),this.ensureListOrderNormalized(a)),{visualContainerGroups:o,visualContainers:a}}},e.prototype.deserializeCanvasItem=function(e,t,r){e&&e.config;var i=e.config;return i.singleVisual?this.deserializeVisualContainer(e,t,r):i.singleVisualGroup?this.deserializeVisualContainerGroup(e,t,r):void this.telemetryService.logEvent(h.telemetry.EXEmptyVisualContainerConfig)},e.prototype.deserializeVisualContainer=function(e,t,r){var i=e.config,r={name:r||i.name,id:t?void 0:e.id,layouts:f.createWithId(),config:{singleVisual:this.deserializeSingleVisual(i.singleVisual,e.prototypeQuery)}},t=(null!=e.visibility&&(r.visibility=e.visibility),null!=e.detailVisualLayout&&(r.detailVisualLayout=e.detailVisualLayout),void 0===e.dataBinaryBase64Encoded&&void 0===e.query&&void 0===e.dataTransforms||(r.cachedData={data:e.dataBinaryBase64Encoded,query:e.query,transforms:e.dataTransforms,dataUpdatedTime:e.dataUpdatedTime?jsCommon.DateExtensions.parseUtcDate(e.dataUpdatedTime):void 0}),r.filters=this.deserializeFilterContainers(e.filters),i.singleVisual.drillFilterOtherVisuals),e=(null!=t&&(r.drillFilterOtherVisuals=t),i.singleVisual.filterSortOrder);return null!=e&&(r.filterSortOrder=e),(t=r.layouts).push.apply(t,_.cloneDeep(i.layouts)||[]),_.forEach(r.layouts,(function(e){e.position&&H(e.position)})),r},e.prototype.deserializeVisualContainerGroup=function(e,t,r){var i=e.config,a=i.singleVisualGroup,r={name:r||i.name,id:t?void 0:e.id,children:[],displayName:a.displayName,groupMode:a.groupMode,layouts:f.createWithId(),isHidden:a.isHidden};return(t=r.layouts).push.apply(t,_.cloneDeep(i.layouts)||[]),a.objects&&(r.objects=S.deserializeObjects(a.objects,A.objectDescriptors)),r},e.prototype.deserializeRelationship=function(e,t){var r=f.findItemWithName(t,e.source),t=f.findItemWithName(t,e.target);if(0!==e.type&&r&&t)return{source:r,target:t,type:e.type}},e.prototype.deserializeFilterContainers=function(e){var t,r=this;if(!u.isNullOrUndefinedOrWhiteSpaceString(e))return t=[],e=w.tryParseJSON(e),e?e.map((function(e){return r.deserializeFilterContainer(e)})):t},e.prototype.deserializePodParameters=function(e){var t=this,r=[];return u.isNullOrUndefinedOrWhiteSpaceString(e)||(e=w.tryParseJSON(e))&&(r=e.map((function(e){return t.deserializePodParameter(e)}))),r},e.prototype.deserializePodParameter=function(e){return{name:e.name,boundFilter:e.boundFilter,fieldExpr:e.fieldExpr?T.deserializeExpr(e.fieldExpr):void 0,asAggregation:e.asAggregation,isLegacySingleSelection:e.isLegacySingleSelection}},e.prototype.deserializePodConfig=function(e){if(u.isNullOrUndefinedOrWhiteSpaceString(e))return{acceptsFilterContext:0};e=w.tryParseJSON(e);return void 0===e.acceptsFilterContext&&(e.acceptsFilterContext=0),e},e.prototype.deserializeVisualQuery=function(e,t,r,i,a,o){var n=this.visualPlugins.capabilities(e.visualType),s=n&&n.expandCollapse&&n.expandCollapse.supportsMerge,l=n&&n.expandCollapse&&n.expandCollapse.collapseParentAfterRemovingChildLevel,n=n&&n.noDefaultProjections,r=new G(t,this.convertProjections(r,t.select(),a,o),E.deserializeExpansionStates(i,{supportsMerge:s,canCollapseRoot:n,collapseParentAfterRemovingChildLevel:l}));this.upgradeVisualQuery(r,e.visualType),e.query=r},e.prototype.deserializeSingleVisual=function(e,t){var r={visualType:e.visualType||e.visualConfig.visualType},i=(r.visualType,null!=e.autoSelectVisualType&&(r.autoSelectVisualType=e.autoSelectVisualType),e.visualConfig?e.visualConfig.projections:void 0),a=e.projections||{};if(i)for(var o=0,n=i;o<n.length;o++)(l=a[(s=n[o]).role])||(a[s.role]=l=[]),l.push(s);else if(a&&0<a.length)for(var s,l,i=a,a={},p=0,u=i;p<u.length;p++)(l=a[(s=u[p]).role])||(a[s.role]=l=[]),l.push(s);var i=e.prototypeQuery||(t?w.tryParseJSON(t):null),i=(i&&(t=T.deserializeQuery(i),this.deserializeVisualQuery(r,t,a,e.expansionStates,e.showAllRoles,e.queryFieldParametersByRole)),e.display),t=(null!=e.display&&(r.display=i),e.columnProperties&&(r.columnProperties=_.cloneDeep(e.columnProperties)),e.queryOptions),i=(t&&(r.queryOptions=_.cloneDeep(t)),e.syncGroup),t=(null!=i&&(r.syncGroup=_.cloneDeep(i)),e.hasDefaultSort),i=(null!=t&&(r.hasDefaultSort=t),this.visualPlugins.capabilities(r.visualType));return i&&e.objects?r.objects=S.deserializeObjects(e.objects,i.objects):(t=e.objects)&&(r.objects=S.deserializeObjects(t,null)),e.vcObjects&&(r.vcObjects=S.deserializeObjects(e.vcObjects,D.CommonObjectDescriptors),(i=v.getObjectDefinition(r.vcObjects,"visualLink",void 0))&&(t=(t=e.vcObjects.visualLink[0].properties.qna)&&t.suggestedUtterances,_.isEmpty(t)||(i.properties.qna={suggestedUtterances:_.map(t,(function(e){return d.UtteranceDefinitionSerializer.deserialize(e)}))}))),this.featureSwitchService.featureSwitches.mobileAuthoringFormattingUI&&this.deserializeMobileState(r,e),e.cachedFilterDisplayItems&&(r.cachedFilterDisplayItems=g.deserializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(r.filterExpressionMetadata=P.deserializeFilterExpressionMetadata(e.filterExpressionMetadata)),r},e.prototype.deserializeMobileState=function(e,t){t.mobileVcObjects&&(e.mobileVcObjects=S.deserializeObjects(t.mobileVcObjects,D.CommonObjectDescriptors)),t.mobileObjects&&(e.mobileObjects=S.deserializeObjects(t.mobileObjects,null==(t=this.visualPlugins.capabilities(e.visualType))?void 0:t.objects))},e.prototype.ensureVisualContainerGrouping=function(e,t,r,i){for(var a=0,o=e;a<o.length;a++){var n,s,l=o[a];i&&(l.parentGroup=i),!r&&C.isVisualContainer(l)&&l.parentGroup&&(n=l.layouts.withId(0),s=I.getAbsoluteVisualContainerPosition(n.position,0,l.parentGroup),n.position=s,l.parentGroup=void 0),C.isVisualContainerGroup(l)&&(t[l.name],l.children=t[l.name]||[],this.ensureVisualContainerGrouping(l.children,t,r,l))}},e.prototype.ensureGroupZIndexNormalized=function(e){if(!_.isEmpty(e)){this.ensureListOrderNormalizedInternal(e,!0,"z");for(var t=0,r=e;t<r.length;t++){var i=r[t];C.isVisualContainerGroup(i)&&this.ensureGroupZIndexNormalized(i.children)}}},e.prototype.ensureGroupTabOrderNormalized=function(e,t){_.isEmpty(e)||_.every(t,(function(e){e=e.layouts.withId(0);return e&&e.position&&null==e.position.tabOrder}))||(this.ensureGroupsHaveTabOrders(e)||this.upgradeTabOrderToHierarchy(e),this.ensureGroupTabOrderNormalizedHelper(e))},e.prototype.upgradeTabOrderToHierarchy=function(e){var i=this;_.map(e,(function(t){var e,r;C.isVisualContainerGroup(t)&&void 0===(null==(e=null==(e=t.layouts)?void 0:e.withId(0).position)?void 0:e.tabOrder)&&(i.upgradeTabOrderToHierarchy(t.children),r=Number.NEGATIVE_INFINITY,C.traverseVisualContainerGroups([t],(function(e){e=null==(e=null==(e=e.layouts)?void 0:e.withId(0).position)?void 0:e.tabOrder;(r=e?_.max([r,e]):r)!==Number.NEGATIVE_INFINITY&&(t.layouts.withId(0).position.tabOrder=r)})))}))},e.prototype.ensureGroupsHaveTabOrders=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(C.isVisualContainerGroup(i)){var a=i.layouts.withId(0);if(void 0===(null==(a=null==a?void 0:a.position)?void 0:a.tabOrder))return!1;if(!this.ensureGroupsHaveTabOrders(i.children))return!1}}return!0},e.prototype.ensureGroupTabOrderNormalizedHelper=function(e){this.ensureTabOrderNormalized(e,!0),this.ensureTabOrderNormalized(e,!1);for(var t=0,r=e;t<r.length;t++){var i=r[t];C.isVisualContainerGroup(i)&&this.ensureGroupTabOrderNormalizedHelper(i.children)}},e.prototype.ensureListOrderNormalized=function(e,t){void 0===t&&(t=!0),_.isEmpty(e)||(t&&this.ensureListOrderNormalizedInternal(e,!0,"z"),_.every(e,(function(e){e=e.layouts.withId(0);return e&&e.position&&null==e.position.tabOrder}))||(this.ensureTabOrderNormalized(e,!0),this.ensureTabOrderNormalized(e,!1)))},e.prototype.ensureTabOrderNormalized=function(e,t){var r=this,e=_.filter(e,(function(e){e=r.getListOrderPropertyFunction(e,"tabOrder");return t?0<=e||void 0===e:e&&e<0}));this.ensureListOrderNormalizedInternal(e,t,"tabOrder")},e.prototype.getListOrderPropertyFunction=function(e,t){e=e.layouts.withId(0);return e&&e.position&&e.position[t]},e.prototype.setListOrderPropertyFunction=function(e,t,r){e=e.layouts.withId(0);e&&e.position&&(e.position[t]=r)},e.prototype.ensureListOrderNormalizedInternal=function(e,t,r){var i=this,a=this.canvasListOrderNormalizeService.getContainerListOrders(e,(function(e){return i.getListOrderPropertyFunction(e,r)}));this.canvasListOrderNormalizeService.shouldNormalizeListOrder(a,t)&&(a=this.canvasListOrderNormalizeService.normalizeListOrder(a,t,(function(e){return i.getListOrderPropertyFunction(e,r)})),this.updateListOrders(e,a,r))},e.prototype.updateListOrders=function(e,t,r){for(var i=0,a=e;i<a.length;i++){var o=a[i],n=t[o.name];null!=n&&n!==this.getListOrderPropertyFunction(o,r)&&this.setListOrderPropertyFunction(o,r,n)}},e.prototype.ensureNames=function(e){for(var t,r=e.length,i={},a=0;a<r;a++){var o=e[a].name;_.isEmpty(o)?t=!0:i[o]=!0}if(t)for(a=0;a<r;a++){var n=e[a],s=n.name;_.isEmpty(s)&&(n.name=I.nextUniqueName(i),i[n.name]=!0)}},e.prototype.convertProjections=function(e,t,r,i){for(var a={},o=_.keys(i),n=_.keys(e),s=0,l=_.union(o,n);s<l.length;s++){var p=l[s],u=_.includes(r,p);a[p]=this.convertProjectionArray(e[p],t,u,i?i[p]:void 0)}return a},e.prototype.convertProjectionArray=function(e,t,r,i){var a,o=[];if(!_.isEmpty(e))for(var n=0,s=e;n<s.length;n++){var l=s[n],p=this.convertProjection(l,t);l.active&&(a=a||[]).push(p.queryRef),o.push(p)}var u=[];if(!_.isEmpty(i))for(var c=0,d=i;c<d.length;c++){var m=d[c],m={index:m.index,length:m.length,expr:T.deserializeExpr(m.expr)};u.push(m)}return new z(o,a,r,u)},e.prototype.convertProjection=function(e,t){var r=e.queryRef,t={queryRef:r=_.isNumber(e.queryRef)?t[e.queryRef].name:r};return e.format&&(t.format=e.format),t},e.prototype.serializeExploration=function(e,t){return this.createSerializer().serializeExploration(e,t)},e.prototype.serializeModelExtensions=function(e){return this.createSerializer().serializeModelExtensions(e)},e.prototype.serializePage=function(e,t,r){return this.createSerializer().serializePage(e,t,r)},e.prototype.serializePageShallow=function(e,t,r){return this.createSerializer().serializePageShallow(e,t,r)},e.prototype.serializeVisualContainer=function(e,t){return this.createSerializer().serializeVisualContainer(e,t)},e.prototype.serializeVisualContainerGroup=function(e){return this.createSerializer().serializeVisualContainerGroup(e)},e.prototype.serializePod=function(e){return this.createSerializer().serializePod(e)},e.prototype.serializeFilterCollection=function(e){return this.createSerializer().serializeFilterCollection(e)},e.prototype.serializeResourcePackages=function(e){return this.createSerializer().serializeResourcePackages(e)},e.prototype.createSerializer=function(){return new t(this.visualPlugins,this.explorationDowngrader,this.telemetryService,this.featureSwitchService)},e.prototype.upgradeVisualQuery=function(e,t){if(t===h.visuals.plugins.filledMap.name&&e.projections[O]){var r=e.projections[O],i=e.projections.Size;if(i&&0<i.all.length)for(var a=i.all().length-1;0<=a;a--)e.removeProjection("Size",{fieldIndex:a});e.projections.Size=r,delete e.projections[O]}i=this.visualPlugins.capabilities(t);if(i){r=c.util.DrillUtils.getDrillableRoles(i),i=e.ensureDrillableRoles(r);if(!_.isEmpty(i)){for(var o={},n=0,s=i;n<s.length;n++){var l=s[n],p=e.projections[l],u=0;p&&(u=_.size(p.all())),o[l]=u}this.telemetryService.logEvent(h.telemetry.EXVisualDrillableRoleActiveItemsFixed,{visualType:t,fixedRoleByProjectionCount:JSON.stringify(o)})}}},e.prototype.upgradeResourcePackage=function(e){void 0===e.type&&(e.type=0)},e.prototype.getReferencedStaticResources=function(e){var t={},r=e.themeCollection.customTheme,i=e.themeCollection.baseTheme;if(this.addItemReference(t,e.resourcePackages,r&&r.type,r&&r.name),this.addItemReference(t,e.resourcePackages,i&&i.type,i&&i.name),!_.isEmpty(e.sections))for(var a=0,o=e.sections;a<o.length;a++){var n=o[a];if(d.StaticResourceReferences.addObjectsReferences(n.objects,C.Section.objectDescriptors,e.resourcePackages,t),!_.isEmpty(n.visualContainers))for(var s=0,l=n.visualContainers;s<l.length;s++){var p=l[s].config.singleVisual,u=p.objects,p=this.visualPlugins.capabilities(p.visualType);d.StaticResourceReferences.addObjectsReferences(u,p&&p.objects,e.resourcePackages,t)}}return t},e.prototype.addItemReference=function(e,t,r,i){var a;i&&r&&((t=p.findItemInPackages(t,r,i))&&(a=p.ensurePackageName(r),d.StaticResourceReferences.addItemReference(e,a,r,i,t.type)))},e.prototype.parseExplorationConfigs=function(e){var t,r=this;if(e)return t=this.parseConfig(e),t.sections=_.map(e.sections,(function(e){return r.parsePageConfigs(e)})),t},e.prototype.parseConfig=function(e){var t=_.clone(e);return t.config=w.tryParseJSON(e.config)||{},t},e.prototype.parsePageConfigs=function(e){var t=this,r=this.parseConfig(e);return r.visualContainers=_.map(e.visualContainers,(function(e){return t.parseConfig(e)})),r},e.prototype.stringifyExplorationConfigs=function(e){var t=this,r=this.stringifyConfig(e);return r.sections=_.map(e.sections,(function(e){return t.stringifyPageConfigs(e)})),r},e.prototype.stringifyConfig=function(e){var t=_.clone(e);return t.config=JSON.stringify(e.config),t},e.prototype.stringifyPageConfigs=function(e){var t=this,r=this.stringifyConfig(e);return r.visualContainers=_.map(e.visualContainers,(function(e){return t.stringifyConfig(e)})),r},e.prototype.parseFilterCollectionConfig=function(e){if(e)return this.parseConfig(e)},e.prototype.stringifyFilterCollectionConfig=function(e){if(e)return this.stringifyConfig(e)},Q=e,k=V.v5_32,d.getOldestSaveVersion=function(){return k},d.setOldestSaveVersion=function(e){k=e},M.prototype.serializeExploration=function(e,r){var t,i=this,a=e.sections,a=(r&&r.withTransientPages||(a=C.Section.filterTransient(a)),_.map(a,(function(e,t){return i.serializePage(e,t,r)}))),o=(_.isEmpty(e.pods)||(this.removeInvalidPods(e.sections,e.pods,this.telemetryService),t=_.map(e.pods,(function(e){return i.serializePod(e)})),f.hasUniqueNames(e.pods)),this.serializeExplorationShallowWithResourcePackages(e,r));if(o.sections=a,o.pods=t,!r||!r.forSave){var n=e.activeBookmark;if(n)for(var s=0,l=null!=(a=o.config.bookmarks)?a:[];s<l.length;s++){var p=l[s];if(!B(p)&&p.name===n.name){o.activeBookmark=p;break}}}return r&&r.forSave&&this.explorationDowngrader.downgrade(o,this.version),this.version,o.config.version,o},M.prototype.serializeBookmarks=function(e,r,i){var t,a=this;if(e)return t=_.map(e,(function(e){var t=!1;return y.isBookmarkGroup(e)||(t=d.ExplorationState.clearUnusedReferences(e.explorationState,r)),a.featureSwitchService.featureSwitches.bookmarkCacheEnabled&&i?(t&&i.deleteCache("bookmark",e),(t=i.getSerializedObject("bookmark",e))||(t=a.serializeBookmark(e,r,i),i.setSerializedObject("bookmark",e,t)),t):a.serializeBookmark(e,r,i)})),e=M.getVersion(e,t),this.version=R.max(this.version,e),t},M.prototype.serializeBookmark=function(e,t,r){if(y.isBookmarkGroup(e))return{displayName:e.displayName,name:e.name,children:this.serializeBookmarks(e.children,t,r)};t={displayName:e.displayName,name:e.name,explorationState:d.ExplorationState.serialize(e.explorationState,this.featureSwitchService)};return e.options&&(t.options=this.serializeBookmarkOptions(e.options)),t},M.prototype.serializeBookmarkOptions=function(e){return e},M.getVersion=function(e,t){var r=n.v1_0,i=n.v1_0;switch(t.forEach((function(e){B(e)||(r=R.max(e.explorationState.version,r))})),e.forEach((function(e){y.isBookmarkGroup(e)?i=R.max(i,N.BookmarkGroup):e.options&&(i=R.max(i,N.BookmarkOptions))})),r){case n.v1_0:i=R.max(i,N.bookmarks);break;case n.v1_1:i=R.max(i,N.ExplorationState_v1_1);break;case n.v1_2:i=R.max(i,N.ExplorationState_v1_2);break;case n.v1_3:i=R.max(i,N.ExplorationState_v1_3);break;case n.v1_4:i=R.max(i,N.ExplorationState_v1_4);break;case n.v1_5:i=R.max(i,N.VisualFilterExpressionMetadata);break;case n.v1_6:i=R.max(i,N.AllowInlineExploration);break;case o.FieldParameters:i=R.max(i,N.QueryFieldParameters);break;case o.OnObject:i=R.max(i,N.OnObject)}return i},M.prototype.serializeQnaAction=function(e){if(e){e=e.suggestedUtterances;if(!_.isEmpty(e))return{suggestedUtterances:_.map(e,(function(e){return d.UtteranceDefinitionSerializer.serialize(e)}))}}},M.prototype.serializeExplorationShallowWithResourcePackages=function(e,t){var r=e.activeSectionIndex,i=this.createVersionedElementConfig(k),r=(this.version=R.max(this.version,i.version),i.themeCollection=j.cloneThemeCollection(e.themeCollection),_.isNumber(r)&&(i.activeSectionIndex=r),_.isEmpty(e.modelExtensions)||(this.version=R.max(this.version,V.v3_0),i.modelExtensions=this.serializeModelExtensions(e.modelExtensions)),_.isEmpty(e.bookmarks)||(r=this.serializeBookmarks(e.bookmarks,e,null==t?void 0:t.cache),i.bookmarks=r),t&&t.excludeHighContrastTheme&&delete i.themeCollection.highContrastTheme,t&&t.forSave&&delete i.themeCollection.transientUserSetTheme,e.themeCollection.baseTheme),r=(r&&(this.version=R.max(this.version,h.explore.util.ThemeUtils.getVersionForBaseTheme(r.name))),u.isNullOrUndefinedOrWhiteSpaceString(e.dataSourceVariables)||(this.version=R.max(this.version,V.v4_2),i.dataSourceVariables=e.dataSourceVariables),e.tags&&(i.tags=e.tags),null!=e.defaultDrillFilterOtherVisuals&&(i.defaultDrillFilterOtherVisuals=e.defaultDrillFilterOtherVisuals,e.defaultDrillFilterOtherVisuals&&(this.version=R.max(this.version,N.SectionCrossDrill))),null!=e.filterSortOrder&&(i.filterSortOrder=e.filterSortOrder,e.filterSortOrder&&(this.version=R.max(this.version,N.FiltersSort))),e.slowDataSourceSettings&&(((r=_.cloneDeep(e.slowDataSourceSettings)).isCrossHighlightingDisabled||r.isFieldWellButtonEnabled||r.isFilterSelectionsButtonEnabled||r.isSlicerSelectionsButtonEnabled||r.isApplyAllButtonEnabled)&&(this.version=r.isApplyAllButtonEnabled?R.max(this.version,N.ApplyAll):R.max(this.version,N.slowDataSource)),i.slowDataSourceSettings=r),null!=e.linguisticSchemaSyncVersion&&(i.linguisticSchemaSyncVersion=e.linguisticSchemaSyncVersion,e.linguisticSchemaSyncVersion!==l.Unspecified&&(this.version=R.max(this.version,N.LinguisticSchemaSyncVersion))),e.settings&&(((r=_.cloneDeep(e.settings)).isPersistentUserStateDisabled||r.hideVisualContainerHeader)&&(this.version=R.max(this.version,N.ExplorationSettings)),r.useStylableVisualContainerHeader&&(this.version=R.max(this.version,N.StylableVisualContainerHeader)),void 0!==r.exportDataMode&&0!==r.exportDataMode&&(this.version=R.max(this.version,N.ExportDataMode)),r.useNewFilterPaneExperience&&(this.version=R.max(this.version,N.NewFilterPaneExperience)),r.isReportAnnotationsDisabled&&(this.version=R.max(this.version,N.ReportAnnotations)),!0===r.defaultFilterActionIsDataFilter&&(this.version=R.max(this.version,N.DefaultFilterAction)),r.useCrossReportDrillthrough&&(this.version=R.max(this.version,N.CrossReportDrillthrough)),r.allowChangeFilterTypes&&(this.version=R.max(this.version,N.AllowChangeFilterTypes)),r.allowInlineExploration&&(this.version=R.max(this.version,N.AllowInlineExploration)),r.optOutNewFilterPaneExperience&&(this.version=R.max(this.version,N.MigrateFilterPaneExperience)),r.filterPaneHiddenInEditMode&&(this.version=R.max(this.version,N.FilterPaneHiddenInEditMode)),r.disableFilterPaneSearch&&(this.version=R.max(this.version,N.DisableFilterPaneSearch)),r.pagesPosition&&(this.version=R.max(this.version,N.PagesPosition)),r.useEnhancedTooltips&&(this.version=R.max(this.version,N.EnhancedTooltips)),r.allowAutomatedInsightsNotification&&(this.version=R.max(this.version,N.AllowAutomatedInsightsNotification)),r.useDefaultAggregateDisplayName&&(this.version=R.max(this.version,N.DefaultAggregateDisplayName)),r.pauseQueries&&(this.version=R.max(this.version,N.PauseVisualQueries)),i.settings=r),e.objects&&(i.objects=this.serializeObjects(e.objects,C.ExplorationObjectDescriptors,"report")),t&&t.forSave?(this.version=this.explorationDowngrader.getFinalExplorationVersion(e,this.version),R.lt(this.version,i.version)):this.version=a,this.serializeFilterContainers(e.filters,t));return e.creationSource&&(i.creationSource=e.creationSource,this.version=R.max(this.version,N.QuickExplore)),i.version=this.version,{id:e.id,report:e.report,reportId:e.reportId,theme:e.themeCollection.customTheme&&e.themeCollection.customTheme.name,filters:r,resourcePackages:this.serializeResourcePackages(e.resourcePackages,t),sections:void 0,config:i,layoutOptimization:this.getLayoutOptimizations(e),publicCustomVisuals:e.publicCustomVisuals}},M.prototype.serializeLinkField=function(e){var t=e.fieldExpr;return F.isMeasure(t)&&!1===e.asAggregation||F.isColumn(t)||F.isHierarchyLevel(t),{asAggregation:e.asAggregation,fieldExpr:T.serializeExpr(t)}},M.prototype.serializeFilterCollection=function(e){var t;if(!_.isEmpty(e))return t=this.createVersionedElementConfig(k),{filters:this.serializeFilterContainers(e),config:t}},M.prototype.serializePage=function(e,t,r){var i=this.serializePageShallow(e,t,r);if(i.visualContainers=[],e.visualContainerGroups)this.serializeVisualContainerTreeToList(e.visualContainerGroups,i.visualContainers,r);else for(var a=0,o=e.visualContainers;a<o.length;a++){var n=o[a];i.visualContainers.push(this.serializeVisualContainer(n,r))}return i},M.prototype.serializeVisualContainerTreeToList=function(e,t,r){for(var i=!1,a=0,o=e;a<o.length;a++){var n=o[a];C.isVisualContainerGroup(n)?(i||(this.version=R.max(d.upgrade.ExplorationVersionHelper.getVersionForVisualContainerGroup(n),this.version),i=!0),t.push(this.serializeVisualContainerGroup(n)),this.serializeVisualContainerTreeToList(n.children,t,r)):t.push(this.serializeVisualContainer(n,r))}},M.prototype.isRegularPageUsingMeasureDrillthrough=function(e){var t=!1,r=!1;return e.type&&0!==e.type||(t=!0===e.acceptsAllFiltersWhenLinked,r=_.some(e.filters,(function(e){return 5===e.howCreated&&!e.isTransient&&(e.isLinkedAsAggregation||e.expression&&F.isMeasure(e.expression))}))),t||r},M.prototype.isMeasureDrillthroughPod=function(e){var t=!1,r=!1;return 1===e.type&&(t=e.config&&0===e.config.acceptsFilterContext,r=_.some(e.parameters,(function(e){return e.asAggregation||e.fieldExpr&&F.isMeasure(e.fieldExpr)}))),t||r},M.prototype.serializePageShallow=function(e,t,r){var i=this,t=(_(e.visualContainers).map((function(e){return e.name})).uniq().value().length,e.visualContainers.length,{id:e.id,name:e.name,displayName:e.displayName,filters:this.serializeFilterContainers(e.filters,r),ordinal:t,visualContainers:void 0,transient:e.transient,objectId:e.objectId,config:{}}),a=(e.size&&(t.displayOption=e.size.displayOption,t.width=e.size.width,t.height=e.size.height),t.config);return _.isEmpty(e.relationships)||(a.relationships=this.serializeRelationships(e.relationships),r&&r.featureUsage&&(r.featureUsage.hasVisualRelationships=!0)),e.objects&&(a.objects=this.serializeObjects(e.objects,C.Section.objectDescriptors,"page")),null!=e.visibility&&(a.visibility=e.visibility,this.version=R.max(this.version,N.SectionVisibility)),null!=e.type&&(a.type=e.type,this.version=R.max(this.version,N.CanvasTooltips)),null!=e.filterSortOrder&&(a.filterSortOrder=e.filterSortOrder,this.version=R.max(this.version,N.FiltersSort)),a.acceptsAllFiltersWhenLinked=e.acceptsAllFiltersWhenLinked,this.isRegularPageUsingMeasureDrillthrough(e)&&(this.version=R.max(this.version,N.MeasureDrillthrough)),_.isEmpty(e.linkFields)||(a.linkFields=_.map(e.linkFields,(function(e){return i.serializeLinkField(e)})),this.version=R.max(this.version,N.CanvasTooltips)),e.dynamicConfig&&(a.dynamicConfig=this.serializePageDynamicConfig(e.dynamicConfig),this.version=R.max(this.version,N.QuickExplore),null!=(r=a.dynamicConfig.quickExplore)&&r.layout&&(this.version=R.max(this.version,N.QuickExploreLayout))),t},M.prototype.serializePod=function(e){var t=this.serializePodParameters(e.parameters);return this.isMeasureDrillthroughPod(e)&&(this.version=R.max(this.version,N.MeasureDrillthrough)),1===e.referenceScope&&(this.version=R.max(this.version,N.CrossReportDrillthrough)),{id:e.id,name:e.name,boundSection:e.boundSection,parameters:_.isEmpty(t)?void 0:JSON.stringify(t),cortanaEnabled:e.cortanaEnabled||void 0,type:0!==e.type?e.type:void 0,referenceScope:0!==e.referenceScope?e.referenceScope:void 0,config:this.serializePodConfig(e.config)}},M.prototype.serializeVisualContainer=function(e,t){_.forEach(e.layouts,(function(e){e.position&&H(e.position)}));var r,i=this.serializeVisualContainerConfig(e,t),a=e.layouts&&e.layouts.withId(0);return a?(a.position,r={id:e.id,x:a.position.x,y:a.position.y,z:a.position.z,width:a.position.width,height:a.position.height,config:i,filters:this.serializeFilterContainers(e.filters)},a.position.tabOrder&&(r.tabOrder=a.position.tabOrder)):r={id:e.id,config:i,filters:this.serializeFilterContainers(e.filters)},_.isEmpty(e.filters)||(a=this.visualPlugins.capabilities(e.config.singleVisual.visualType),c.FilterUtils.supportsFilterOutput(a)&&(this.version=R.max(this.version,N.VisualLevelSlicerFilters))),t&&t.withVisibility&&(null!=e.visibility&&(r.visibility=e.visibility),null!=e.detailVisualLayout&&(r.detailVisualLayout=e.detailVisualLayout)),t&&e.cachedData&&((t.withQuery||t.withData)&&(r.query=e.cachedData.queryObject?JSON.stringify(e.cachedData.queryObject):e.cachedData.query,r.dataTransforms=e.cachedData.transformsObject?h.data.services.DataViewTransformActionsSerializer.serializeTransformActions(e.cachedData.transformsObject):e.cachedData.transforms,r.dataUpdatedTime=e.cachedData.dataUpdatedTime?e.cachedData.dataUpdatedTime.toISOString():void 0),t.withData&&(r.dataBinaryBase64Encoded=e.cachedData.dataObject?jsCommon.GzipUtility.compress(JSON.stringify(e.cachedData.dataObject)):e.cachedData.data)),r},M.prototype.serializeVisualContainerGroup=function(e){this.version=R.max(this.version,N.VisualContainerGrouping);var t,r={name:e.name,layouts:_.cloneDeep(e.layouts),singleVisualGroup:{displayName:e.displayName,groupMode:e.groupMode,isHidden:e.isHidden}},i=(e.parentGroup&&(r.parentGroupName=e.parentGroup.name),e.objects&&(r.singleVisualGroup.objects=this.serializeObjects(e.objects,A.objectDescriptors,A.objectType)),e.layouts&&e.layouts.withId(0));return i?(i.position,t={id:e.id,x:i.position.x,y:i.position.y,z:i.position.z,width:i.position.width,height:i.position.height,config:r},this.featureSwitchService.featureSwitches.accessibilityTopLevelNav&&i.position.tabOrder&&(t.tabOrder=i.position.tabOrder)):t={id:e.id,config:r},t},M.prototype.serializeModelExtensions=function(e){var t=this;if(e)return _.map(e,(function(e){return{name:e.name,extends:e.extends,entities:t.serializeModelExtensionEntities(e.entities)}}))},M.prototype.serializeRelationship=function(e){return e.source.name,e.target.name,{source:e.source.name,target:e.target.name,type:e.type}},M.prototype.serializeVisualContainerConfig=function(e,t){var r=e.config&&e.config.singleVisual,i=(e.name,r.visualType,r.query),a=i?i.projections:void 0,o={name:e.name,layouts:_.cloneDeep(e.layouts),singleVisual:{visualType:r.visualType,projections:this.serializeQueryProjections(a),prototypeQuery:i?T.serializeQuery(i.defn):void 0}},n=(this.featureSwitchService.featureSwitches.visualCalculations&&((n=i)&&n.defn.select().some((function(e){return F.isNativeVisualCalc(e.expr)})))&&(this.version=R.max(this.version,N.VisualCalculations)),null!=r.autoSelectVisualType&&(this.version=R.max(this.version,N.OnObject),o.singleVisual.autoSelectVisualType=r.autoSelectVisualType),this.serializeQueryFieldParameters(a)),a=(_.isEmpty(n)||(this.version=R.max(this.version,N.QueryFieldParameters),o.singleVisual.queryFieldParametersByRole=n),_.some(e.layouts,(function(e){return e.position&&void 0!==e.position.tabOrder}))&&(this.version=R.max(this.version,N.AccessibilityTopLevelNav)),i&&b.hasExpansionState(i.expansionStates)&&(a=E.serializeExpansionStates(i.expansionStates),_.isEmpty(a)||(o.singleVisual.expansionStates=a,this.version=R.max(this.version,N.ExpandCollapse))),r.columnProperties);if(a&&!_.isEmpty(a)&&(this.version=R.max(this.version,V.v3_4),o.singleVisual.columnProperties=_.cloneDeep(a)),r.queryOptions&&(null!=r.queryOptions.allowBinnedLineSample&&(this.version=R.max(this.version,V.v3_3)),null!=r.queryOptions.allowOverlappingPointsSample&&(this.version=R.max(this.version,V.v3_5)),null!=r.queryOptions.keepProjectionOrder&&(this.version=R.max(this.version,V.v4_1)),o.singleVisual.queryOptions=_.cloneDeep(r.queryOptions)),r.display&&(this.version=R.max(this.version,N.visualHidden),o.singleVisual.display=_.cloneDeep(r.display)),i&&i.defn){r.visualType!==h.visuals.plugins.slicer.name||(a=i.projections)&&a[h.visuals.slicerRoles.value]&&1<a[h.visuals.slicerRoles.value].all().length&&(this.version=R.max(this.version,N.HierarchicalSlicer)),I.isSmallMultiplesVisual(r)&&(_.some(m,(function(e){return e===r.visualType}))?this.version=R.max(this.version,N.CartesianSmallMultiplesCombo):this.version=R.max(this.version,N.CartesianSmallMultiples));for(var s=0,l=i.defn.select();s<l.length;s++){var p=l[s];this.version=R.max(this.version,d.upgrade.ExplorationVersionHelper.getVersionForSQExpr(p.expr))}this.version=R.max(this.version,d.upgrade.ExplorationVersionHelper.getVersionForSortDefinitions(i.defn.orderBy()))}var u,a=this.serializeShowAllRoles(i?i.projections:void 0),a=(_.isEmpty(a)||(o.singleVisual.showAllRoles=a,t&&t.featureUsage&&(t.featureUsage.hasShowAllEnabled=!0)),r.visualType===h.visuals.plugins.ribbonChart.name&&(this.version=R.max(this.version,V.v3_5)),r.visualType===h.visuals.plugins.actionButton.name&&(this.version=R.max(this.version,N.ActionButton)),r.visualType===h.visuals.plugins.pythonVisual.name&&(this.version=R.max(this.version,V.v3_17)),r.visualType===h.visuals.plugins.keyDriversVisual.name&&(this.version=R.max(this.version,V.v4_1),r.query&&!_.isEmpty(r.query.tryGetExprs(h.visuals.keyDriverRoleNames.details))&&(this.version=R.max(this.version,N.KeyDriversDetails))),r.visualType===h.visuals.plugins.qnaVisual.name&&(this.version=R.max(this.version,V.v5_4)),r.visualType===h.visuals.plugins.decompositionTreeVisual.name&&(this.version=R.max(this.version,V.v5_5)),r.visualType===h.visuals.plugins.azureMap.name&&(this.version=R.max(this.version,V.v5_13)),r.visualType===h.visuals.plugins.shape.name&&(this.version=R.max(this.version,N.ShapeVisual)),r.visualType===h.visuals.plugins.pageNavigator.name&&(this.version=R.max(this.version,N.NavigatorVisuals)),r.visualType===h.visuals.plugins.bookmarkNavigator.name&&(this.version=R.max(this.version,N.NavigatorVisuals)),r.visualType===h.visuals.plugins.rdlVisual.name&&(this.version=R.max(this.version,N.RdlVisual)),r.visualType===h.visuals.plugins.scorecard.name&&(this.version=R.max(this.version,N.ScorecardVisual)),r.syncGroup&&(o.singleVisual.syncGroup=_.cloneDeep(r.syncGroup),this.version=R.max(this.version,N.VisualSyncGroup)),null!=e.drillFilterOtherVisuals&&(o.singleVisual.drillFilterOtherVisuals=e.drillFilterOtherVisuals,this.version=R.max(this.version,N.SectionCrossDrill)),null!=e.filterSortOrder&&(o.singleVisual.filterSortOrder=e.filterSortOrder,this.version=R.max(this.version,N.FiltersSort)),e.parentGroup&&(o.parentGroupName=e.parentGroup.name,this.version=R.max(this.version,N.VisualContainerGrouping)),r.hasDefaultSort&&(o.singleVisual.hasDefaultSort=r.hasDefaultSort),i?r.query.defn.select():jsCommon.ArrayExtensions.createWithName()),e=(r.objects&&(i=(e=this.visualPlugins.capabilities(r.visualType))&&e.objects,o.singleVisual.objects=this.serializeObjects(r.objects,i,r.visualType,a),(e=r).visualType===h.visuals.plugins.scatterChart.name&&e.query&&e.query.projections.Play&&!_.isEmpty(e.query.projections.Play.all())&&(u=!1,v.visitPropertyDefinitions(r.objects,i,(function(e,t,r,i,a){"fill"===t&&"dataPoint"===i&&null!=r&&(u=!0)})),u&&(this.version=R.max(this.version,V.v5_1))),this.supportsScalarMarkers(r)&&R.lt(this.version,N.LineChartExplicitDots)&&this.upgradeIfScalarMarkersAreSet(r.objects)),r.vcObjects);return e&&(o.singleVisual.vcObjects=this.serializeObjects(e,D.CommonObjectDescriptors,r.visualType,a),(a=(i=v.getObjectDefinition(e,"visualLink",void 0))&&i.properties.qna)&&(o.singleVisual.vcObjects.visualLink[0].properties.qna=this.serializeQnaAction(a))),this.featureSwitchService.featureSwitches.mobileAuthoringFormattingUI&&this.serializeMobileState(r,o.singleVisual,null==t?void 0:t.forSave),r.cachedFilterDisplayItems&&(o.singleVisual.cachedFilterDisplayItems=g.serializeFilterLabelIdPairs(r.cachedFilterDisplayItems)),r.filterExpressionMetadata&&(o.singleVisual.filterExpressionMetadata=P.serializeFilterExpressionMetadata(r.filterExpressionMetadata,this.featureSwitchService.featureSwitches.serializeSpaceOptimization),this.version=R.max(this.version,N.VisualFilterExpressionMetadata)),this.version<N.DotPlotVisual&&(function(e){if(e.visualType===h.visuals.plugins.scatterChart.name){var t=h.visuals.scatterRoleNames.x,e=e.query,r=e?e.getRolesProjectionRefs([t]):void 0,r=_.size(r);if(1<r)return 1;if(1===r){r=e.tryGetExpr(t,0);if(r&&!q.isMeasure(r))return 1}}return})(r)&&(this.version=N.DotPlotVisual),o},M.prototype.serializeMobileState=function(e,t,r){r||(e.mobileVcObjects&&(t.mobileVcObjects=S.serializeObjects(e.mobileVcObjects,D.CommonObjectDescriptors,this.featureSwitchService.featureSwitches.serializeSpaceOptimization)),e.mobileObjects&&(t.mobileObjects=S.serializeObjects(e.mobileObjects,null==(r=this.visualPlugins.capabilities(e.visualType))?void 0:r.objects,this.featureSwitchService.featureSwitches.serializeSpaceOptimization)))},M.prototype.serializeObjects=function(e,t,r,i){var a=S.serializeObjects(e,t,this.featureSwitchService.featureSwitches.serializeSpaceOptimization);return this.isAtLatestVersion()||(this.version=R.max(this.version,d.upgrade.getVersionForObjectDefinitions(e,t,r,this.version,i))),a},M.prototype.isAtLatestVersion=function(){return this.version===a},M.prototype.serializeShowAllRoles=function(e){if(e)return e=_.pickBy(e,(function(e){return!0===e.showAll})),_.keys(e)},M.prototype.serializeQueryProjections=function(e){if(e){var t,r={};for(t in e){var i=e[t].all(),a=e[t].activeProjectionRefs;if(0<i.length){r[t]=[];for(var o=0,n=i;o<n.length;o++){var s=n[o],l=s.queryRef,p={queryRef:l};s.format&&(p.format=s.format),_.includes(a,l)&&(p.active=!0),r[t].push(p)}}}return r}},M.prototype.serializeQueryFieldParameters=function(e){if(e){var t,r={};for(t in e){var i=e[t].getFieldParameters();if(0<i.length){r[t]=[];for(var a=0,o=i;a<o.length;a++){var n=o[a],n={index:n.index,length:n.length,expr:T.serializeExpr(n.expr)};r[t].push(n)}}}return r}},M.prototype.serializeModelExtensionEntities=function(e){var r=this;if(e)return _.map(e,(function(e){var t={name:e.name};return e.extends&&(t.extends=e.extends),e.measures&&(t.measures=r.serializeModelExtensionMeasures(e.measures)),t}))},M.prototype.serializeExpressionReferences=function(e){var t;if(e&&(e.unrecognizedReferences||!_.isEmpty(e.measures)))return t={unrecognizedReferences:e.unrecognizedReferences},_.isEmpty(e.measures)||(t.measures=e.measures),t},M.prototype.serializeModelExtensionAnnotations=function(e){if(e)return _.map(e,(function(e){return{name:e.name,value:e.value}}))},M.prototype.serializeModelExtensionMeasures=function(e){var r=this;if(e)return _.map(e,(function(e){var t={name:e.name,dataType:e.dataType,dataCategory:e.dataCategory,expression:e.expression,errorMessage:e.errorMessage,hidden:e.hidden,references:r.serializeExpressionReferences(e.references),formulaOverride:e.formulaOverride,formatInformation:e.formatInformation,displayFolder:e.displayFolder};return e.annotations&&(t.annotations=r.serializeModelExtensionAnnotations(e.annotations)),e.measureTemplate&&(t.measureTemplate={daxTemplateName:e.measureTemplate.daxTemplateName,version:e.measureTemplate.version}),e.description&&(t.description=e.description,r.version=R.max(r.version,N.description)),t}))},M.prototype.serializeFilterContainers=function(e,t){if(e){for(var r=[],i=0,a=e;i<a.length;i++){var o,n=a[i];n&&(0!==n.howCreated||c.FilterUtils.isFilterModified(n))&&(!n.isTransient||t&&t.withTransientFilters)&&(7===n.howCreated&&t&&t.forSave&&(n.howCreated=1),5===n.howCreated&&(this.version=R.max(this.version,V.v3_5)),n.isHiddenInViewMode&&(this.version=R.max(this.version,N.FilterContainerVisibilityControl)),n.isLockedInViewMode&&(this.version=R.max(this.version,N.FilterContainerVisibilityControl)),n.displayName&&(this.version=R.max(this.version,N.RenameFilters)),n.ordinal&&(this.version=R.max(this.version,N.FiltersSort)),n.type===C.FilterType.RelativeTime&&(this.version=R.max(this.version,N.RelativeTimeFilter)),n.type===C.FilterType.Advanced&&null!=(o=n.filter)&&o.conditions().some((function(e){e=h.data.SQExpr.isNot(e)?e.arg:e;return h.data.SQExpr.isCompare(e)&&h.data.SQExpr.isConstantText(e.right)&&""===e.right.value}))&&(this.version=R.max(this.version,N.IsEmptyFilterOperator)),!n.filterExpressionMetadata||_.isEmpty(n.filterExpressionMetadata.expressions)||_.isEmpty(n.filterExpressionMetadata.cachedValueItems)||(_.isEmpty(n.filterExpressionMetadata.jsonFilter)?this.version=R.max(this.version,N.FilterContainerFilterMetadata):this.version=R.max(this.version,N.GokSupportForCV)),o=n.filterExpressionMetadata?P.serializeFilterExpressionMetadata(n.filterExpressionMetadata,this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0,r.push({name:n.name,expression:n.expression?T.serializeExpr(n.expression):void 0,filter:n.filter?T.serializeFilter(n.filter):void 0,type:C.FilterType[n.type],restatement:n.restatement,cachedDisplayNames:g.serializeFilterLabelIdPairs(n.cachedValueItems),howCreated:n.howCreated,isLinkedAsAggregation:n.isLinkedAsAggregation,isTransient:n.isTransient,objects:n.objects?this.serializeObjects(n.objects,s,U):void 0,isHiddenInViewMode:n.isHiddenInViewMode,isLockedInViewMode:n.isLockedInViewMode,filterExpressionMetadata:o,displayName:n.displayName,ordinal:n.ordinal}))}return JSON.stringify(r)}},M.prototype.createVersionedElementConfig=function(e){return{version:e}},M.prototype.serializeResourcePackages=function(e,a){if(!_.isEmpty(e)){for(var o=[],t=0,r=e;t<r.length;t++)!(function(e){var t,r,i=_.find(e.items,(function(e){return e.type===L.CustomVisualMetadata})),i=(!i||void 0===i.content||(t=_.isString(i.content)?jsCommon.JsonExtensions.tryParseJSON(i.content):i.content)&&(t.content=void 0,i.content=JSON.stringify(t)),e.items);i&&(r=["contentBlob","contentBlobUrl","promise"],a&&a.excludeResourceItemContent&&r.push("content"),i=_.map(i,(function(e){return _.omit(e,r)}))),o.push({resourcePackage:{id:e.id,name:e.name,type:e.type,items:i,disabled:!!e.disabled}})})(r[t]);return o}},M.prototype.getLayoutOptimizations=function(e){e=this.getDistinctLayouts(e);return this.getLayoutOptimizationFromLayouts(e)},M.prototype.getLayoutOptimizationFromLayouts=function(e){for(var t=0,r=0,i=e;r<i.length;r++)1===i[r].id&&(t|=1);return t},M.prototype.getDistinctLayouts=function(e){for(var e=e.sections,t=f.createWithId(),r=0,i=e;r<i.length;r++)for(var a=0,o=i[r].visualContainers;a<o.length;a++)for(var n=0,s=o[a].layouts;n<s.length;n++){var l=s[n];t.withId(l.id)||t.push(l)}return t},M.prototype.serializePodParameters=function(e){if(!_.isEmpty(e)){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];t.push({name:a.name,boundFilter:a.boundFilter,fieldExpr:a.fieldExpr?T.serializeExpr(a.fieldExpr):void 0,asAggregation:a.asAggregation||void 0,isLegacySingleSelection:a.isLegacySingleSelection||void 0})}return t}},M.prototype.serializePodConfig=function(e){return _.isEmpty(e)||0===e.acceptsFilterContext?"{}":JSON.stringify(e)},M.prototype.serializeRelationships=function(e){if(!_.isEmpty(e)){for(var t,r=0,i=e;r<i.length;r++){var a=i[r],a=this.serializeRelationship(a);a&&(t=t||[]).push(a)}return t}},M.prototype.removeInvalidPods=function(e,o,t){var n,r=_.map(e,(function(e){return e.name})),i=_.remove(o,(function(e){return!_.includes(r,e.boundSection)})),i=_.size(i);0<i&&t.logEvent(h.telemetry.PodSerializationErrorFixed,{errorType:"NonExistingBoundSection",count:i}),_.size(o)<=_.size(e)||(i=_.groupBy(o,(function(e){return e.boundSection})),n=0,_.forEach(i,(function(e){var t=e.length;if(1<t){n++;for(var r=e[0].boundSection,i=_.findLastIndex(o,(function(e){return e.boundSection===r})),a=t-1;0<a&&0<=i;)o.splice(i,1),a--,i=_.findLastIndex(o,(function(e){return e.boundSection===r}),i-1)}})),0<n&&t.logEvent(h.telemetry.PodSerializationErrorFixed,{errorType:"DuplicateBoundSection",count:n}),0<(i=_.size(o)-_.size(e))&&(o=o.slice(0,_.size(e)),t.logEvent(h.telemetry.PodSerializationErrorFixed,{errorType:"ExceedingPodsNumberAfterInitialFix",count:i})))},M.prototype.supportsScalarMarkers=function(t){var e=[h.visuals.plugins.lineChart.name,h.visuals.plugins.areaChart.name,h.visuals.plugins.stackedAreaChart.name];return _.some(e,(function(e){return e===t.visualType}))},M.prototype.upgradeIfScalarMarkersAreSet=function(e){var t=v.getValue(e,{objectName:"categoryAxis",propertyName:"axisType"},null);t&&"Scalar"===h.data.SQConstantExpr.getTextValue(t)&&(t=v.getValue(e,{objectName:"lineStyles",propertyName:"showMarker"},null))&&h.data.SQConstantExpr.getBooleanValue(t)&&(this.version=R.max(this.version,N.LineChartExplicitDots))},M.prototype.serializePageDynamicConfig=function(e){var t,r,i;return e.quickExplore&&(t=e.quickExplore.selectedFields,r=e.quickExplore.visualContainerConfigurations,e=e.quickExplore.layout,(i=i||{}).quickExplore={selectedFields:_.map(t,(function(e){return T.serializeExpr(e)})),visualContainerConfigurations:_.map(r,(function(e){return{name:e.name,fields:_.map(e.fields,(function(e){return T.serializeExpr(e)}))}}))},e&&(i.quickExplore.layout=this.serializeQuickExploreLayout(e),this.version=R.max(this.version,N.QuickExploreLayout))),i},M.prototype.serializeQuickExploreLayout=function(e){var t;return e.combination?(t={version:e.combination.version},e.combination.dataTableName&&(t.dataTableName=e.combination.dataTableName),{combination:t}):e.related?(t={version:e.related.version},e.related.dataTableName&&(t.dataTableName=e.related.dataTableName),{related:t}):void 0},t=M})(powerbi=powerbi||{}),(function(e){var c,d,t,r;function i(e){this.versionUpgraders=[c.v1_0.createVersionUpgrader(),c.v2_0.createVersionUpgrader(),c.v2_2.createVersionUpgrader(),c.v2_3.createVersionUpgrader(),c.v2_5.createVersionUpgrader(),c.v3_6_1.createVersionUpgrader(),c.v3_12_1.createVersionUpgrader(),c.v3_14.createVersionUpgrader(e),c.v3_14_1.createVersionUpgrader(),c.v3_15.createVersionUpgrader(),c.v3_18.createVersionUpgrader(),c.v3_19.createVersionUpgrader(),c.v3_20.createVersionUpgrader(e),c.v3_24.createVersionUpgrader(),c.v4_1.createVersionUpgrader(),c.v4_2.createVersionUpgrader(),c.v5_1.createVersionUpgrader(),c.v5_3.createVersionUpgrader(),c.v5_9.createVersionUpgrader(e),c.v5_11.createVersionUpgrader(),c.v5_16.createVersionUpgrader(e),c.v5_25.createVersionUpgrader(e),c.v5_28.createVersionUpgrader(),c.v5_31.createVersionUpgrader(e),c.v5_33.createVersionUpgrader(e),c.v5_38.createVersionUpgrader(e)],this.objectsUpgrader=c.createVisualObjectsUpgrader(this.versionUpgraders)}e=(e=e.explore||(e.explore={})).services||(e.services={}),c=e.upgrade||(e.upgrade={}),d=jsCommon.Version,t=jsCommon.JsonExtensions,c.createExplorationUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e,t,r,i){if(this.upgradeElement(e,t,r,(function(e,t,r){return e.upgrade(t,r)}),i))return t=e,this.upgradeVisualObjects(t,e.config.version),e.config.version=c.CurrentExplorationVersion,t},i.prototype.upgradeFilterCollection=function(e,t,r){if(this.upgradeElement(e,t,r,(function(e,t){return e.upgradeFilterCollection(t)})))return e.config.version=c.CurrentExplorationVersion,e},i.prototype.getVersionUpgraders=function(){return this.versionUpgraders},i.prototype.upgradeElement=function(e,t,r,i,a){t&&_.isEmpty(t);var o=this.getVersionedElementConfig(e),n=o.version&&_.isString(o.version)?o.version:d.ZeroStr;if(d.gt(n,c.CurrentExplorationVersion)){if(t.push({errorType:0}),!r)return}else for(var s=0,l=this.versionUpgraders;s<l.length;s++){var p=l[s],u=p.getVersion();(d.lt(u,"2.2")||d.gt(u,n))&&(i(p,e,n),a&&a.upgraderCount++)}return e},i.prototype.upgradeVisualObjects=function(e,t){t=t||d.ZeroStr;e=e&&e.sections;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var o=0,n=a;o<n.length;o++){var s,l,p=n[o],p=p&&p.config&&p.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&this.objectsUpgrader.upgrade(2,l,s,t),(l=p.objects)&&this.objectsUpgrader.upgrade(1,l,s,t))}}},i.prototype.getVersionedElementConfig=function(e){return _.isString(e.config)&&(e.config=t.tryParseJSON(e.config)),e.config||(e.config={version:d.ZeroStr}),e.config},r=i,c.ExplorationUpgrader=r})(powerbi=powerbi||{}),(function(p){var e,t,u,l,a,c,i,d,m,o,r,n;function s(){}function v(e){var t=e.column;if(t){e=g(e);if(e)return m.columnRef(e,t)}}function g(e){return m.entity(e.schema,e.entity,e.entityVar)}e=(e=p.explore||(p.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v1_0||(t.v1_0={}),u=p.data.services.DataViewObjectSerializer,l=p.visuals.GradientUtils,a=jsCommon.JsonExtensions,c=p.visuals.labelStyle,i=p.visuals.plugins,d=p.data.services.SemanticQuerySerializer,m=p.data.SQExprBuilder,o=jsCommon.Version,e.createVersionUpgrader=function(){return new n},s.prototype.upgrade=function(e,t){if(e&&(e.filters=this.upgradeFilterContainers(e.filters),e.sections))for(var r=0,i=e.sections;r<i.length;r++){var a=i[r];if(a.filters=this.upgradeFilterContainers(a.filters),a.visualContainers)for(var o=0,n=a.visualContainers;o<n.length;o++){var s,l=n[o],l=(l.filters=this.upgradeFilterContainers(l.filters),l.config.singleVisual);l&&(s=l.visualType||l.visualConfig.visualType,l.objects=this.upgradeObjects(l.objects,s,t))}}},s.prototype.upgradeVisualObjects=function(e,t,r,i){},s.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},s.prototype.getVersion=function(){return t.ExplorationVersions.v1_0},s.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},s.prototype.upgradeFilterContainer=function(e){var t;!e.expression&&e.field&&(t=r.fieldDef(e.field))&&(e.expression=d.serializeExpr(t)),void 0===e.howCreated&&(e.howCreated=e.autoGenerated?0:1)},s.prototype.upgradeObjects=function(e,t,r){switch(this.dropMalformedSelectors(e),t){case i.filledMap.name:return this.upgradeObjectsFilledMap(e);case i.card.name:return this.upgradeObjectsCard(e);case i.donutChart.name:case i.pieChart.name:return r&&o.gt(r,"1.0")?e:this.upgradeObjectsDonutChart(e)}return e},s.prototype.dropMalformedSelectors=function(e){if(e)for(var t in e){var r=e[t];if(r)for(var i=r.length-1;0<=i;i--){var a=r[i].selector;a&&(a.metadata||delete a.metadata,_.isEmpty(Object.keys(a))&&r.splice(i,1))}}},s.prototype.upgradeObjectsFilledMap=function(e){var t,r="dataPoint",i="fillRule",a=(e=e||{})[r];a||(e[r]=a=[]);for(var o=0,n=a;o<n.length;o++){var s=n[o];if(!s.selector){t=s;break}}return t||a.push(t={selector:null,properties:{}}),null==t.properties[i]&&(t.properties[i]=u.serializeObjectProperty(l.getDefaultFillRuleDefinition(),p.visuals.getFilledMapCapabilities().objects[r].properties[i])),e},s.prototype.upgradeObjectsCard=function(e){var t;return e&&(t=e.cardTitle)&&(e.categoryLabels=t,delete e.cardTitle),e},s.prototype.upgradeObjectsDonutChart=function(e){var t,r,i,a,o="categoryLabels",n="labels",s="labelStyle",l="show";if(e)return t=this.getMetadataOnceObjectDefn(e,n),r=this.getPropertyExpr(t,l),r=!!r&&d.deserializeExpr(r).value,a=this.getMetadataOnceObjectDefn(e,o),a?(l=!!(a=this.getPropertyExpr(a,l))&&d.deserializeExpr(a).value,r&&l?i=c.categoryAndData:r&&!l?i=c.data:!r&&l&&(i=c.category),delete e[o]):t&&t.properties[s]||(i=r?c.categoryAndData:c.category),null!=i&&(a=p.visuals.getDonutChartCapabilities().objects[n].properties,t||((l=e[n])||(e[n]=l=[]),(t=_.find(l,(function(e){return!e.selector})))||l.push(t={properties:{}})),t.properties.show=u.serializeObjectProperty(m.boolean(!0),a.show),t.properties[s]=u.serializeObjectProperty(m.text(i),a[s])),e},s.prototype.getMetadataOnceObjectDefn=function(e,t){if(e){e=e[t];if(!_.isEmpty(e))return _.find(e,(function(e){return!e.selector}))}},s.prototype.getPropertyExpr=function(e,t){if(e){e=e.properties[t];if(e)return e.expr}},n=s,e.VersionUpgrader=n,(r||(r={})).fieldDef=function(e){return (function(e){var t=e.aggregate;if(void 0!==t){e=v(e)||g(e);if(e)return m.aggregate(e,t)}})(e)||v(e)||(function(e){var t=e.measure;if(t){e=g(e);if(e)return m.measureRef(e,t)}})(e)||g(e)}})(powerbi=powerbi||{}),(function(e){var t,r;function i(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),((t=e.upgrade||(e.upgrade={})).v2_0||(t.v2_0={})).createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n=o[a],s=n.config;s.layouts||(n={x:n.x,y:n.y,z:n.z,width:n.width,height:n.height},s.layouts=[{id:0,position:n}])}}},i.prototype.upgradeFilterCollection=function(e){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v2_0},r=i})(powerbi=powerbi||{}),(function(e){var t,a,r;function i(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v2_2||(t.v2_2={}),a=jsCommon.JsonExtensions,e.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){},i.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},i.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},i.prototype.upgradeFilterContainer=function(e){2!==e.howCreated||e.precedence||(e.precedence=0)},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v2_2},r=i})(powerbi=powerbi||{}),(function(i){var e,t,a,o,r,n,s,l;function p(){}e=(e=i.explore||(i.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v2_3||(t.v2_3={}),a=i.data.DataViewObjectDefinitions,o=i.data.services.DataViewObjectSerializer,r=i.visuals.plugins,n=i.visuals.slicerMode,s=i.data.SQExprBuilder,e.createVersionUpgrader=function(){return new l},p.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n,s=o[a].config.singleVisual;s&&(n=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,n))}}},p.prototype.upgradeFilterCollection=function(e){},p.prototype.upgradeVisualObjects=function(e,t,r,i){},p.prototype.getVersion=function(){return t.ExplorationVersions.v2_3},p.prototype.upgradeObjects=function(e,t){return t===r.slicer.name?this.upgradeSlicerObjects(e):e},p.prototype.upgradeSlicerObjects=function(e){var t=a.ensure(e=e||{},"data",null),r=i.visuals.getSlicerCapabilities().objects.data.properties;return null==t.properties.mode&&(t.properties.mode=o.serializeObjectProperty(s.text(n.basic),r.mode)),e},l=p,e.VersionUpgrader=l})(powerbi=powerbi||{}),(function(e){var t,r,n,i,a;function o(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v2_5||(r.v2_5={}),n=e.data.DataViewObjectDefinitions,i=e.visuals.plugins,t.createVersionUpgrader=function(){return new a},o.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n,s=o[a].config.singleVisual;s&&(n=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,n))}}},o.prototype.upgradeFilterCollection=function(e){},o.prototype.upgradeVisualObjects=function(e,t,r,i){},o.prototype.getVersion=function(){return r.ExplorationVersions.v2_5},o.prototype.upgradeObjects=function(e,t){return t===i.gauge.name?this.upgradeGaugeTarget(e):e},o.prototype.upgradeGaugeTarget=function(e){var t=n.getObjectDefinition(e=e||{},"labels",null);if(t)for(var r=n.ensure(e,"target",null),i=0,a=["show","labelDisplayUnits","labelPrecision","color"];i<a.length;i++){var o=a[i];null!=t.properties[o]&&(r.properties[o]=t.properties[o])}return e},a=o,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(e){var t,r,l,d,m,i;function a(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v3_6_1||(r.v3_6_1={}),l=e.GeoJsonTypes,d=e.visualHost.utils.ResourcePackageUtils,m=e.contracts.ResourcePackageItemType,t.createVersionUpgrader=function(){return new i},a.prototype.upgrade=function(e){if(e){var t=e.resourcePackages||[],r=_.find(t,(function(e){return 2===e.resourcePackage.type})),i=!r,a=(r=r||{resourcePackage:{id:void 0,items:[],name:d.ensurePackageName(2),type:2}}).resourcePackage.items;if(e.sections)for(var o=0,n=e.sections;o<n.length;o++){var s=n[o];if(s.visualContainers)for(var l=0,p=s.visualContainers;l<p.length;l++){var u=p[l].config.singleVisual;u&&this.upgradeSharedResourcePackages(u.objects,a)}}var c=e.config&&e.config.baseTheme;!c||_.find(a,(function(e){return e.name===c}))||a.push({name:c,type:m.BaseTheme,path:"BaseThemes/"+c+".json"}),i&&0<r.resourcePackage.items.length&&(t.push(r),e.resourcePackages||(e.resourcePackages=t))}},a.prototype.upgradeFilterCollection=function(){},a.prototype.upgradeVisualObjects=function(e,t,r,i){},a.prototype.getVersion=function(){return r.ExplorationVersions.v3_6_1},a.prototype.upgradeSharedResourcePackages=function(e,i){for(var t in e)for(var r=0,a=e[t];r<a.length;r++){var o,n=a[r],s=this;for(o in n.properties)!(function(e){var t,r,e=n.properties[e],e=e&&e.geoJson;e&&(t=(t=e.type.expr).Literal&&t.Literal.Value)&&s.removeQuotes(t)===l.shared&&(r=s.removeQuotes(e.name.expr.Literal.Value),_.find(i,(function(e){return e.name===r}))||i.push({name:r,type:m.ShapeMap,path:"Shapemaps/"+r+".json"}))})(o)}},a.prototype.removeQuotes=function(e){return e.substr(1,e.length-2)},i=a,t.VersionUpgrader=i})(powerbi=powerbi||{}),(function(e){var t,n,r;function i(e){}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v3_14||(t.v3_14={}),n=jsCommon.JsonExtensions,e.createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t],a=i.config,o=n.tryParseJSON(i.filters)||[];1===a.type?this.upgradeTooltipPage(o,a):0!==a.type&&null!=a.type||this.upgradeRegularPage(o,a),i.filters=JSON.stringify(o)}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v3_14},i.prototype.upgradeTooltipPageLinkFields=function(e,t){var r=_.map(t.linkFields,(function(e){return{howCreated:5,isTransient:!1,isLinkedAsAggregation:e.asAggregation,expression:e.fieldExpr}}));e.push.apply(e,r||[]),t.linkFields=[]},i.prototype.upgradeTooltipPage=function(e,t){t.acceptsAllFiltersWhenLinked=!0,this.upgradeTooltipPageLinkFields(e,t)},i.prototype.upgradeRegularPage=function(e,t){if(t.acceptsAllFiltersWhenLinked=!1,e)for(var r=0,i=e;r<i.length;r++)i[r].isLinkedAsAggregation=!1},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(e){var t,r;function i(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(e=(t=e.upgrade||(e.upgrade={})).v3_14_1||(t.v3_14_1={})).createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n=o[a].config.singleVisual;n&&this.upgradeSQExprToInt(n.objects)}}},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return t.ExplorationVersions.v3_14_1},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeSQExprToInt=function(e){for(var t in e)if("labels"===t||"bubbles"===t||"categoryLabels"===t)for(var r=0,i=e[t];r<i.length;r++){var a,o,n=i[r];for(a in n.properties)"bubbleSize"!==a&&"labelDensity"!==a&&"backgroundTransparency"!==a||(o=(o=n.properties[a])&&o.expr&&o.expr.Literal)&&(o.Value,/^'\d+(\.\d+)?'$/.test(o.Value)&&(o.Value=this.convertLiteralSQTextIntoNumber(o.Value)+"L"))}},i.prototype.convertLiteralSQTextIntoNumber=function(e){return Math.floor(_.parseInt(e.substr(1,e.length-2)))},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(e){var t,r,i,c,a;function o(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v3_15||(r.v3_15={}),i=e.data.services.SemanticQuerySerializer,c=e.data.SQExprBuilder,t.createVersionUpgrader=function(){return new a},o.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n,s,l,p,u=o[a].config.singleVisual;u&&(u.vcObjects,n={},u.altText&&(n.general=[{properties:{altText:this.toExpr(c.text(u.altText))}}],delete u.altText),u.aspectRatio&&(s=u.aspectRatio,n.lockAspect=[{properties:{show:null!=s.show?this.toExpr(c.boolean(s.show)):void 0}}],delete u.aspectRatio),u.background&&(s=u.background,n.background=[{properties:{color:null!=s.color?{solid:{color:this.toExpr(c.text(s.color))}}:void 0,show:null!=s.show?this.toExpr(c.boolean(s.show)):void 0,transparency:null!=s.transparency?this.toExpr(c.integer(s.transparency)):void 0}}],delete u.background),u.border&&(l=u.border,n.border=[{properties:{color:null!=l.color?{solid:{color:this.toExpr(c.text(l.color))}}:void 0,show:null!=l.show?this.toExpr(c.boolean(l.show)):void 0}}],delete u.border),u.stylePresetName&&(n.stylePreset=[{properties:{name:this.toExpr(c.text(u.stylePresetName))}}],delete u.stylePresetName),u.title&&((l=u.title).show=null!=l.hidden?!l.hidden:l.show,n.title=[{properties:{alignment:null!=l.alignment?this.toExpr(c.text(l.alignment)):void 0,background:null!=l.background?{solid:{color:this.toExpr(c.text(l.background))}}:void 0,fontColor:null!=l.fontColor?{solid:{color:this.toExpr(c.text(l.fontColor))}}:void 0,fontFamily:null!=l.fontFamily?this.toExpr(c.text(l.fontFamily)):void 0,fontSize:null!=l.fontSize?this.toExpr(c.integer(l.fontSize)):void 0,show:null!=l.show?this.toExpr(c.boolean(l.show)):void 0,text:null!=l.text?this.toExpr(c.text(l.text)):void 0}}],delete u.title),u.visualLink&&(p=u.visualLink,n.visualLink=[{properties:{bookmark:null!=p.bookmark?this.toExpr(c.text(p.bookmark)):void 0,qna:p.qna,show:null!=p.show?this.toExpr(c.boolean(p.show)):void 0,type:null!=p.type?this.toExpr(c.text(p.type)):void 0}}],delete u.visualLink),u.visualTooltip&&(p=u.visualTooltip,n.visualTooltip=[{properties:{section:null!=p.section?this.toExpr(c.text(p.section)):void 0,type:null!=p.type?this.toExpr(c.text(p.type)):void 0}}],delete u.visualTooltip),this.clearUndefinedPropertiesVCObjects(n),_.isEmpty(n)||(u.vcObjects=n))}}},o.prototype.toExpr=function(e){return{expr:i.serializeExpr(e)}},o.prototype.clearUndefinedPropertiesVCObjects=function(e){for(var t in e){var r,i=e[t][0].properties;for(r in i)i[r]||delete i[r];_.isEmpty(i)&&delete e[t]}},o.prototype.upgradeFilterCollection=function(){},o.prototype.upgradeVisualObjects=function(e,t,r,i){},o.prototype.getVersion=function(){return r.ExplorationVersions.v3_15},a=o,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(e){var t,r,i,a;function o(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v3_18||(r.v3_18={}),i=e.explore.util.ThemeUtils,t.createVersionUpgrader=function(){return new a},o.prototype.upgrade=function(e){var t,r;e&&((r=e.config).themeCollection=t={},e.theme&&(t.customTheme=i.getThemeMetadata(e.theme,1,this.getVersion()),delete e.theme),r.baseTheme&&(t.baseTheme=i.getThemeMetadata(r.baseTheme,2,this.getVersion()),delete r.baseTheme))},o.prototype.upgradeFilterCollection=function(){},o.prototype.upgradeVisualObjects=function(e,t,r,i){},o.prototype.getVersion=function(){return r.ExplorationVersions.v3_18},a=o,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(e){var t,l,r;function i(){}function p(e){var t="defaultCategoryColor";if(e&&e.dataPoint)for(var r=0,i=e.dataPoint;r<i.length;r++){var a=i[r];null==a.selector&&a.properties[t]&&(a.properties.fill=a.properties[t],delete a.properties[t])}}function u(e){return _.includes(t.DefaultCategoryColorVisualsToUpgrade,e)}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v3_19||(t.v3_19={}),l=jsCommon.JsonExtensions,e.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o,n=a[i],s=n.config.singleVisual;s&&(o=s.objects,u(s.visualType)&&(p(o),(s=l.tryParseJSON(n.dataTransforms))&&(p(s.objects),n.dataTransforms=JSON.stringify(s))))}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v3_19},r=i,e.VersionUpgrader=r,e.upgradeDefaultCategoryColorToFill=p,e.needsToUpgradeDefaultCategoryColor=u})(powerbi=powerbi||{}),(function(e){var n,t;function r(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(e=(n=e.upgrade||(e.upgrade={})).v4_2||(n.v4_2={})).createVersionUpgrader=function(){return new t},r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;n.UpgradeUtils.updateSingleVisualConfigPxToPt(o)}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return n.ExplorationVersions.v4_2},t=r,e.VersionUpgrader=t})(powerbi=powerbi||{}),(function(e){var t,m,v,g,r;function i(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),m=t.upgrade||(t.upgrade={}),v=m.v5_1||(m.v5_1={}),g=e.data.services.SemanticQuerySerializer,v.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++){var i=r[t],a=(s=n=o=a=void 0,i);if(a&&a.config&&a.config.objects)for(var o=0,n=v.outspacePanePropertiesToUpdate;o<n.length;o++){var s=n[o];m.UpgradeUtils.upgradePropertyFromPxToPt(a.config.objects,s)}if(c=c=d=d=u=p=l=l=void 0,(l=i)&&l.config&&l.config.objects&&l.config.objects.filterCard)for(var l=l.config.objects.filterCard,p=0,u=l;p<u.length;p++){var c,d=u[p],d=d&&d.properties;!d||(c=d.textSize)&&(c=g.deserializeExpr(c.expr),d.textSize=m.UpgradeUtils.toExpr(m.UpgradeUtils.pxToPtExpr(c)))}}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return m.ExplorationVersions.v5_1},r=i,v.VersionUpgrader=r,v.outspacePanePropertiesToUpdate=[{objectName:"outspacePane",propertyName:"titleSize"},{objectName:"outspacePane",propertyName:"headerSize"}]})(powerbi=powerbi||{}),(function(e){var n,t;function r(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(e=(n=e.upgrade||(e.upgrade={})).v5_3||(n.v5_3={})).createVersionUpgrader=function(){return new t},r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;n.UpgradeUtils.updateSingleVisualConfigTextboxPxToPt(o)}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return n.ExplorationVersions.v5_3},t=r,e.VersionUpgrader=t})(powerbi=powerbi||{}),(function(e){var t,r;e=e.explore||(e.explore={}),t=(t=e.services||(e.services={})).UtteranceDefinitionSerializer||(t.UtteranceDefinitionSerializer={}),r=e.services.upgrade.UtteranceDefinitionVersions,t.serialize=function(e){return{Version:r.v1_0,Utterance:e.utterance}},t.deserialize=function(e){return{utterance:e.Utterance}}})(powerbi=powerbi||{}),(function(e){var t,a,o,n;t=(t=e.explore||(e.explore={})).services||(t.services={}),o=e.data.FieldExprPattern,n=e.data.SQExprConverter,(e=t.schemaItemActivationUtils||(t.schemaItemActivationUtils={})).setActiveSchemaItem=function(e,t,r){var t=n.asFieldPattern(t,r),i=(r=o.toFieldExprEntityItemPattern(t)).schema,r=r.entity,i=a.createActiveSchemaItem(i,r,t);e.setActiveItem(i)},e.trackItemThroughModelChange=function(e,t,r){if(e){for(var i=0,a=t.changes;i<a.length;i++){var o=a[i];if(o.itemDelete&&o.itemDelete.entity===e.entity&&(!o.itemDelete.property||e.property&&e.property===o.itemDelete.property||e.hierarchy&&e.hierarchy===o.itemDelete.property))return;o.entityRename&&e.entity===o.entityRename.before?e=__assign(__assign({},e),{entity:o.entityRename.after}):o.propertyRename&&e.entity===o.propertyRename.entity?((e=e.property&&e.property===o.propertyRename.before?__assign(__assign({},e),{property:o.propertyRename.after}):e).hierarchy||e.hierarchyLevel)&&e.hierarchy===o.propertyRename.before&&"Hierarchy"===o.propertyRename.objectType&&(e=__assign(__assign({},e),{hierarchy:o.propertyRename.after})):o.hierarchyLevelRename&&e.entity===o.hierarchyLevelRename.entity&&e.hierarchy===o.hierarchyLevelRename.hierarchy&&e.hierarchyLevel===o.hierarchyLevelRename.before?e=__assign(__assign({},e),{hierarchyLevel:o.hierarchyLevelRename.after}):o.measureMove&&e.entity===o.measureMove.source&&e.property===o.measureMove.property&&(e=__assign(__assign({},e),{entity:o.measureMove.destination}))}t=r.schema(e.schema);if(t)if(t.entities.withName(e.entity))return e.property?t.findProperty(e.entity,e.property)&&e:e.hierarchyLevel?t.findHierarchyLevel(e.entity,e.hierarchy,e.hierarchyLevel)&&e:(!e.hierarchy||t.findHierarchy(e.entity,e.hierarchy))&&e}},(a=t.ActiveSchemaItemFactory||(t.ActiveSchemaItemFactory={})).createActiveSchemaItem=function(e,t,r){return{schema:e,entity:t,property:o.getPropertyName(r),hierarchy:o.getHierarchyName(r)||r.hierarchyLevel&&r.hierarchyLevel.name,hierarchyLevel:r.hierarchyLevel&&r.hierarchyLevel.level}}})(powerbi=powerbi||{}),(function(e){var p;(function(e){var i=p.util.VisualContainerUtils,t=p.contracts.isVisualContainer;function s(){}s.selectCanvasItem=function(e,t,r,i){void 0===r&&(r=0);e=l.createSelectableCanvasItem(e);t.selectElement(e,r,i)},s.unselectCanvasItem=function(e,t){var r=s.getSelectedCanvasItems(t);_.includes(r,e)&&s.selectCanvasItems(_.without(r,e),t)},s.selectSubSelection=function(e,t,r,i){t=l.createSubSelectableCanvasItem(t,r);e.selectElement(t,i)},s.selectCanvasItems=function(e,t,r){e=_.map(e,(function(e){return l.createSelectableCanvasItem(e)}));t.selectElements(e,0,r)},s.isCanvasItemSelected=function(e,t){t=s.getSelectedCanvasItems(t);return _.includes(t,e)},s.getSelectedCanvasItem=function(e){return _.first(s.getSelectedCanvasItems(e))},s.getSelectedCanvasItems=function(e){return _.chain(e.getSelectedElements()).map((function(e){return e.canvasItem})).compact().value()},s.getSelectedVisualContainers=function(e){return _.chain(e.getSelectedElements()).filter((function(e){return p.contracts.isVisualContainer(e.canvasItem)})).map((function(e){return e.canvasItem})).compact().value()},s.hasMultipleVisualContainerSelection=function(e){return 1<s.getSelectedCanvasItems(e).length},s.getSelectedVisual=function(e){var e=s.getSelectedCanvasItems(e);if(1===e.length)return e=e[0],t(e)?e:void 0},s.getDefaultSelectedVisualInSingleOrMultiCase=function(e){var t,e=s.getSelectedCanvasItems(e),r=e[0];if(r)return t=i.getVisualType(r),_.every(e,(function(e){return i.getVisualType(e)===t}))?r:void 0},s.clearSubSelections=function(e){var t=e.getSelectedElements();if(t){for(var r=s.getSelectedVisualContainers(e),i=[],a=0,o=t;a<o.length;a++){var n=o[a];i.push(l.createSubSelectableCanvasItem(n.canvasItem,[]))}e.selectElements(i,1<r.length?1:0)}return t},e.selectionUtils=s;r.createSelectableCanvasItem=function(e){return o.createFromCanvasItem(e)},r.createSubSelectableCanvasItem=function(e,t){return o.createFromSubSelections(e,t)};var l=r;function r(){}function a(){}e.SelectableItemFactory=l,a.equals=function(e,t){if(e.length!==t.length)return!1;for(var r=0,i=e.length;r<i;r++)if(!o.equals(e[r],t[r]))return!1;return!0},e.SelectableUtils=a;Object.defineProperty(n.prototype,"id",{get:function(){if(this._canvasItem)return this._canvasItem.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasItem",{get:function(){return this._canvasItem},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"subSelections",{get:function(){return this._subSelections},enumerable:!1,configurable:!0}),n.createFromCanvasItem=function(e){var t=new n;return t._canvasItem=e,t},n.createFromSubSelections=function(e,t){e=n.createFromCanvasItem(e);return e._subSelections=t,e},n.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&!(e.id!==t.id||e.canvasItem!==t.canvasItem||!_.isEqual(e.subSelections,t.subSelections))};var o=n;function n(){}e.SelectableItem=o})((p=e.explore||(e.explore={})).services||(p.services={}))})(powerbi=powerbi||{}),(function(e){var t,i,a,n;function r(e,t,r,i,a,o){this.services={visualPlugin:e,featureSwitchService:t,localizationService:r,userInfo:i,embedModeService:a,licenseServiceExtend:o}}t=(t=e.explore||(e.explore={})).services||(t.services={}),i=e.explore.util.ScriptVisualsUtil,a=e.explore.util.VisualContainerUtils,t.createScriptVisualsService=function(e,t,r,i,a,o){return new n(e,t,r,i,a,o)},r.prototype.addScriptVisualInfo=function(e,t){var r=a.getVisualType(e);this.services.visualPlugin.isScriptVisual(r)&&e.id&&(e={id:e.id,scriptType:i.getScriptVisualType(r)},t.push(e))},r.prototype.showEnableScriptVisualDialogIfRequiredAsync=function(e,t,r){return null},r.prototype.getScriptVisualErrorDetails=function(e,t){var r,i=this.services.localizationService,a=this.services.featureSwitchService.featureSwitches;if(0===e&&!a.scriptVisualEnabled)r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupported",e)));else{if(this.services.embedModeService&&this.services.embedModeService.isAnonymousLiveEmbed())return r=a.scriptVisualAnonymousEmbeddingEnabled?r:this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedInEmbedReports",e)));var o,n=this.getUserInfoForErrorDetails();n&&n.isViralTenant?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedForViralTenant",e))):!1===a.rScriptVisualEnabled?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsDisabledByAdmin",e))):(a=!1,o=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario(),!this.services.licenseServiceExtend||Array.isArray(this.services.licenseServiceExtend)||o||(a=t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t)),n&&!1===n.isPremiumUser&&!a?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsIsProFeature",e))):n&&void 0===n.isPremiumUser&&void 0===n.isViralTenant&&void 0===t&&(r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedWithThisOperation",e)))))}return r},r.prototype.overrideEmbeddedErrorDetails=function(e,t){var r=this.services.embedModeService&&(this.services.embedModeService.isAppTokenEmbed()||this.services.embedModeService.isSaasOrPaasEmbed()||this.services.embedModeService.isSecurePublishToWeb()),i=this.services&&this.services.localizationService;if(r&&t)return(r=t).helpLink="",r.message=i.get(this.getLocalizationKey("Error_VisualsEmbeddedText",e)),r.displayableErrorInfo=[{errorInfoKey:i.get(this.getLocalizationKey("Error_VisualsEmbeddedText",e)),errorInfoValue:i.get(this.getLocalizationKey("Error_VisualsErrorInEmbedReports",e))}],r},r.prototype.getLocalizationKey=function(e,t){var r;switch(t){case 0:r="R";break;case 1:r="Py";break;default:r=""}return r+e},r.prototype.shouldBlockScriptVisual=function(e,t){var r=this.services.featureSwitchService.featureSwitches,i=this.getUserInfoForErrorDetails(),a=this.services.embedModeService&&this.services.embedModeService.isAnonymousLiveEmbed(),o=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario();switch(e){case 0:if(a)return!r.scriptVisualAnonymousEmbeddingEnabled||!r.scriptVisualEnabled;var n=!1;return(n=!this.services.licenseServiceExtend||Array.isArray(this.services.licenseServiceExtend)||o?n:t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t))?!1:!r.scriptVisualEnabled||i&&i.isViralTenant||!r.rScriptVisualEnabled||i&&!i.isPremiumUser;case 1:return a?!r.scriptVisualAnonymousEmbeddingEnabled:!(n=!this.services.licenseServiceExtend||Array.isArray(this.services.licenseServiceExtend)||o?n:t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t))&&(i&&i.isViralTenant||i&&!i.isPremiumUser)}},r.prototype.canLaunchExternalIDE=function(){return!1},r.prototype.launchExternalIDE=function(e){return null},r.prototype.openOptionsDialogAsync=function(){return null},r.prototype.refreshScriptCustomVisuals=function(e){},r.prototype.triggerDataRefresh=function(){var e="Visual_Error_RefreshFailed",t=this.services.localizationService.get(e),r=this.services.localizationService.get("Visual_Warning_AutoRefreshNotSupported");return{message:r,displayableErrorInfo:[{errorInfoKey:t,errorInfoValue:r}],helpLink:"https://go.microsoft.com/fwlink/?linkid=2188979",helpLinkType:1,hideDebugInfo:!0,resourceKey:e}},r.prototype.buildErrorDetails=function(e){return{message:e,displayableErrorInfo:[],helpLink:"https://go.microsoft.com/fwlink/?linkid=829101",errorType:1}},r.prototype.getUserInfoForErrorDetails=function(){var e=this.services.userInfo,t=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario();if(e&&!Array.isArray(e)&&!t)return{isViralTenant:e.userMetadata&&e.userMetadata.tenantMetadata&&0===e.userMetadata.tenantMetadata.tenantType,isPremiumUser:e.isPremiumUser}},n=r})(powerbi=powerbi||{}),(function(e){(function(e){function t(){}t.prototype.register=function(e,t,r){t=t();return{actionResult:t,succeeded:!(_.isBoolean(t)&&!t)}},t.prototype.getTopUndoFrame=function(){},t.prototype.canRedo=function(){return!1},t.prototype.canUndo=function(){return!1},t.prototype.canClear=function(){return!1},t.prototype.undo=function(){return!1},t.prototype.redo=function(){return!1},t.prototype.clear=function(){return!1},t.prototype.getReferences=function(){return{}},e.UndoRedoNoOp=t})((e=(e=e.explore||(e.explore={})).services||(e.services={})).undoRedoStrategy||(e.undoRedoStrategy={}))})(powerbi=powerbi||{}),(function(e){(function(i){function e(e,t){this.visualContainerName=e,this.action=t}e.prototype.equals=function(e){return!!e&&this.action===e.action&&this.visualContainerName===e.visualContainerName},i.ActionIdentifier=e,i.createUndoRedoService=function(e,t,r){return void 0===r&&(r=new i.undoRedoStrategy.UndoRedoNoOp),new a(e,t,r)};t.prototype.setStrategy=function(e){this.clear(),this.strategy=e},t.prototype.undo=function(){var e=this;this.verifyStrategy()&&this.canUndo()&&setTimeout((function(){e.strategy&&e.strategy.undo()&&(e.runSideEffects(),e.fireEvents())}))},t.prototype.redo=function(){var e=this;this.verifyStrategy()&&this.canRedo()&&setTimeout((function(){e.strategy&&e.strategy.redo()&&(e.runSideEffects(),e.fireEvents())}))},t.prototype.registerSideEffect=function(e){this.sideEffects||(this.sideEffects=[]),this.sideEffects.push(e)},t.prototype.clear=function(){this.verifyStrategy()&&(this.strategy.canClear()&&this.strategy.clear(),this.eventBridge.publishToChannel(i.events.undoRedoStackUpdated))},t.prototype.canRedo=function(){return this.verifyStrategy()&&this.strategy.canRedo()},t.prototype.canUndo=function(){return this.verifyStrategy()&&this.strategy.canUndo()},t.prototype.getTopUndoFrame=function(){return this.verifyStrategy()&&this.strategy.getTopUndoFrame()},t.prototype.undoRedoPostProcessing=function(e){this.loggerService.addUserAction({message:e,type:"UndoRedo"}),setTimeout(_.noop)},t.prototype.register=function(e,t,r){var i;return(this.verifyStrategy()?(i=(r=this.strategy.register(e,t,r)).actionResult,r.succeeded):(i=t(),!(_.isBoolean(i)&&!i)))&&(this.runSideEffects(e),this.fireEvents()),this.undoRedoPostProcessing(e),i},t.prototype.fireEvents=function(){this.eventBridge.publishToChannel(i.events.onReportChanged,{explorationContentChanged:!0}),this.eventBridge.publishToChannel(i.events.undoRedoStackUpdated)},t.prototype.runSideEffects=function(e){if(!_.isEmpty(this.sideEffects))for(var t=0,r=this.sideEffects;t<r.length;t++)r[t].run(e)},t.prototype.verifyStrategy=function(){return this.strategy,!!this.strategy};var a=t;function t(e,t,r){this.eventBridge=e,this.loggerService=t,this.strategy=r}})((e=e.explore||(e.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(l){var e;(function(e){var i=jsCommon.CircularStack,a=l.telemetry.EXUndoEventTime;function t(e,t,r){this.handler=e,this.staticResourceReferences=t,this.telemetry=r,this.undoStack=new i(30),this.redoStack=new i(30),this.staticResourceReferences.addReferenceSource(this)}t.prototype.register=function(e,t,r){var i=this,e=this.withTelemetry((function(){return i.captureUndoFrame(i.handler)}),"Capture",e),r=(e.recurringActionInfo=r,this.canMergeWithTopFrame(r)),e=this.startTransaction(e),t=t(),a=(this.isIPromise(t),!(_.isBoolean(t)&&!t));return a?this.endTransaction(e,r):this.cancelTransaction(e),{succeeded:a,actionResult:t}},t.prototype.getReferences=function(){return this.addStackReferences(this.undoStack,this.addStackReferences(this.redoStack))},t.prototype.addStackReferences=function(e,t){t=t||{};for(var r=e.length;0<r--;)_.merge(t,e.item(r).getReferences());return t},t.prototype.undo=function(){var e=this,t=!1;return t=this.canUndo()?this.withTelemetry((function(){return e.rollbackTop(e.undoStack,e.redoStack)}),"Undo",""):t},t.prototype.redo=function(){var e=this,t=!1;return t=this.canRedo()?this.withTelemetry((function(){return e.rollbackTop(e.redoStack,e.undoStack)}),"Redo",""):t},t.prototype.clear=function(){return this.undoStack.clear(),this.redoStack.clear(),!0},t.prototype.canRedo=function(){return 0<this.redoStack.length},t.prototype.canUndo=function(){return 0<this.undoStack.length},t.prototype.canClear=function(){return!0},t.prototype.getTopUndoFrame=function(){var e=this.undoStack.peek();return e?e.getFrame():void 0},t.prototype.withTelemetry=function(e,t,r){r=this.telemetry.startEvent(a,{description:r,event:t}),t=e();return r.resolve(),t},t.prototype.canMergeWithTopFrame=function(e){if(e&&this.canUndo()){var t=this.getTopUndoFrame();if(t&&void 0!==t.recurringActionInfo&&t.recurringActionInfo.equals(e))return!0}return!1},t.prototype.rollbackTop=function(e,t){var r,e=e.pop();if(e)return e=e.rollbackFrame(),r=this.validTransactionCheck(e),r&&t.push(e),r},t.prototype.isIPromise=function(e){return e&&e.finally},t.prototype.startTransaction=function(e){var t=new n;return this.currentTransaction||(this.currentTransaction=t,this.currentTransaction.addUndoFrame(e)),this.currentTransaction},t.prototype.endTransaction=function(e,t){this.currentTransaction,t||(this.redoStack.clear(),this.validTransactionCheck(this.currentTransaction)&&this.undoStack.push(this.currentTransaction)),this.currentTransaction=void 0},t.prototype.cancelTransaction=function(e){this.currentTransaction,this.currentTransaction=void 0},t.prototype.captureUndoFrame=function(e){return new r(e)},t.prototype.validTransactionCheck=function(e){return!!e},e.UndoRedoStack=t;o.prototype.rollbackFrame=function(){var e=new o(this.handler,this.snapshot);return this.handler.rollback(this.snapshot),e},o.prototype.getReferences=function(){return this.snapshot.getReferences&&this.snapshot.getReferences()};var r=o;function o(e,t){this.handler=e,this.snapshot=this.handler.takeSnapshot(t)}s.prototype.addUndoFrame=function(e){this.frames.push(e)},s.prototype.rollbackFrame=function(){return new s(_.map(this.frames,(function(e){if(e)return e.rollbackFrame()})))},s.prototype.getFrame=function(){return this.frames.length,this.frames[0]},s.prototype.getReferences=function(){for(var e={},t=0,r=this.frames;t<r.length;t++){var i=r[t];_.merge(e,i.getReferences())}return e};var n=s;function s(e){this.frames=e||[]}})((e=(e=l.explore||(l.explore={})).services||(e.services={})).undoRedoStrategy||(e.undoRedoStrategy={}))})(powerbi=powerbi||{}),(powerbi||(powerbi={})).columnPropertiesAuthoringModuleFactory=function(){return{getColumnPropertiesForExprs:function(e,t){var r=[];if(t.columnProperties)for(var i=0,a=e;i<a.length;i++){var o=a[i],n=t.query.defn.selectNameOf(o),n=t.columnProperties[n];n&&r.push({originalExpr:o,columnProperty:n})}return r},applyColumnPropertiesByExpr:function(t,e,r,i){(i=_.find(i,(function(e){return e.originalExpr===t})))&&(e=r.query.defn.selectNameOf(e),r.columnProperties[e]||(r.columnProperties[e]=i.columnProperty))}}},(function(E){var b,e,I,N,V,m,d,P,i,t,w,T,o,F,g,v,h,f,n,j,s,O,y,l,R,D,A,C,k,p;function a(e){return void 0!==e.expr}function u(e){return void 0!==e.role}function c(e,t,r){if(e.name!==E.visuals.cartesianRoleNames.rows)return!0;if(!s.supportsSmallMultiplesDataViewMapping(null==r?void 0:r.dataViewMappings))return!0;r=t.query;if(!r||!r.defn)return!1;r=E.data.QueryProjectionsByRole.getRole(r.projections,e.name);return!!r&&0<_.size(r.all())||t.hasUsedSmallMultiples}function M(e,t,r){var i,a=e.properties[t];return r&&r[e.objectName]&&r[e.objectName].properties[t]&&(i=r[e.objectName].properties[t].type),V.encodePropertyValue(a,i||{})}function B(e,t,r,i,a){this.visualPluginService=e,this.geoTaggingService=t,this.aggrOps=r,this.featureSwitchService=i,this.visualAuthoringCustomizeOperations=a,this.visualPluginOps=E.explore.services.createVisualPluginOps(e,i)}b=E.explore||(E.explore={}),e=b.services||(b.services={}),I=jsCommon.ArrayExtensions,N=E.data.DataViewObjectDefinition,V=E.data.DataViewObjectDefinitions,m=E.data.DataViewObjectDescriptors,d=E.data.DataViewRoleWildcard,P=E.explore.util.DrillUtils,i=E.data.FieldExprPattern,t=E.visuals.GradientUtils,w=b.util.HierarchyUtils,T=jsCommon.JsonComparer,o=E.data.QueryProjectionCollection,F=E.data.QueryProjectionsByRole,g=E.data.ScopeIdentityExtractor,v=E.data.Selector,h=E.data.dsr.SelectToIdentityExpressionsVisitor,f=E.data.SemanticFilter,n=E.data.SemanticQuery,j=b.contracts.SingleVisualConfig,s=E.visuals.SmallMultiplesUtils,O=E.data.SQExpr,y=E.data.SQExprBuilder,l=E.data.SQExprConverter,R=E.explore.utils.SQExprToRoleDictionary,D=E.data.SQExprUtils,A=E.data.SQHierarchyExprUtils,C=E.explore.util.VisualContainerUtils,k=b.contracts.VisualQuery,e.createVisualAuthoringCore=function(e,t,r,i,a){return new p(e,t,r,i,a)},e.isRemoveExpressionOptions=a,e.isRemoveFieldOptions=u,e.applyPropertyChanges=function(e,t,r,a){if(!e)return!1;var i=!1;function o(e,t,r,i){a&&a(e.objectName,e.selector,t,r,i,i&&e.properties&&e.properties[t])}if(e.replace)for(var n=0,s=e.replace;n<s.length;n++){var l=s[n],p=V.ensure(r,l.objectName,l.selector),u={};for(C in l.properties)N.isValidPropertyName(C)&&(u[C]=M(l,C,t));var c=p.properties;if(!V.allPropertiesAreEqual(c,u)){for(var i=!0,d=0,m=V.getUnequalProperties(c,u);d<m.length;d++)o(l,C=m[d],c[C],u[C]);p.properties=u}}if(e.merge)for(var v=0,g=e.merge;v<g.length;v++){var h,l=g[v],p=V.ensure(r,l.objectName,l.selector);for(C in l.properties)N.isValidPropertyName(C)&&(h=M(l,C,t),V.propertiesAreEqual(p.properties[C],h)||(i=!0,o(l,C,p.properties[C],h),p.properties[C]=h))}if(e.remove)for(var f=0,y=e.remove;f<y.length;f++){l=y[f];if(p=V.getObjectDefinition(r,l.objectName,l.selector))for(var C in l.properties)N.isValidPropertyName(C)&&p.properties.hasOwnProperty(C)&&(i=!0,o(l,C,p.properties[C],void 0),delete p.properties[C])}if(e.removeObject)for(var x=0,S=e.removeObject;x<S.length;x++){l=S[x];if(p=V.getObjectDefinition(r,l.objectName,l.selector)){if(a)for(var C in p.properties)o(l,C,p.properties[C],void 0);i=V.deleteObjectDefinition(r,l.objectName,l.selector)||i}}return i},e.isRoleAllowedForSmallMultiples=c,B.prototype.create=function(e){var t=this.visualPluginService.capabilities(e.visualType),r=E.visualCapabilitiesHelperModuleFactory().create(t,this.geoTaggingService);if(r){var i,a=e.query||new k(n.create(),{},[]),o={visualType:e.visualType,query:a};for(i in e.autoSelectVisualType&&(o.autoSelectVisualType=!0),this.visualAuthoringCustomizeOperations.customizeOptions(o,e.schema),o.query.projections)this.ensureDependentObjectDefn(r.objectDescs,i,o);a=e.expr,t=!e.inFilterVisualContainer&&a&&!_.isArray(a)&&D.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e.schema,e.expr,!b.FilterUtils.supportsFilterOutput(t),this.visualPluginOps.isAnalysisVisual(e.visualType));if(_.isEmpty(a)||this.tryAdd(r,o,t,e))return{singleVisual:o}}},B.prototype.add=function(e,t,r){t=t.singleVisual;if(!t)return!1;var i=this.visualPluginService.capabilities(t.visualType),i=E.visualCapabilitiesHelperModuleFactory().create(i,this.geoTaggingService);return!!i&&(t.query||(t.query=new k(n.create(),{},[])),!!this.tryAdd(i,t,r,e)&&(this.visualAuthoringCustomizeOperations.customizeOptions(t,e.schema),B.clearConversionSourceContext(t),!0))},B.prototype.remove=function(e,t,r){t=t.singleVisual;return!!t&&(!!this.tryRemove(t.query,t.columnProperties,e,r)&&(B.clearConversionSourceContext(t),!0))},B.prototype.removeAllParametersAndProjectionsFromRole=function(e,t,r,i,a){var o=t&&t.config;if(o){var n=o&&o.singleVisual&&o.singleVisual.query;if(n){var s=n.getQueryFieldParametersByRole(e);if(s&&0<s.length){for(var n={},l=n[e]=[],p=0,u=s;p<u.length;p++){var c=u[p];l.push({parameter:c,result:[]})}this.resolveParameters(r,t,n,i,a,void 0);for(var d=s.length-1;0<=d;d--){c=s[d];this.remove({count:void 0,projOptions:{parameter:c},role:e,shouldRemoveParameter:!0},o,r)}}}}},B.prototype.move=function(e,t){_.isNumber(e.sourceIndex)&&_.isNumber(e.targetIndex)&&0<=e.targetIndex&&e.sourceIndex,_.isNumber(e.sourceCount)&&e.sourceCount;var r,i=t.singleVisual;if(!i)return!1;if(e.sourceRole===e.targetRole&&!e.replacementExpressions)return!!i.query.moveProjection(e.targetRole,e.sourceIndex,e.targetIndex,e.sourceCount)&&(B.clearConversionSourceContext(i),!0);var a=[];if(!(null==(r=i.query)?void 0:r.getParameterByFieldIndex(e.sourceIndex,e.sourceRole)))for(var o=0;o<e.sourceCount;o++)if(a[o]=i.query.tryGetExpr(e.sourceRole,e.sourceIndex+o),!a[o])return!1;return this.moveProjectionCore(t,a,e)},B.prototype.convert=function(e){var t=e.source;if(!t)return!1;var r=(r=t.conversionSourceContext)||(t.conversionSourceContext=this.createConversionSourceContext(t.query,t.visualType,t.syncGroup)),i=this.visualPluginService.capabilities(r.visualType),a=this.visualPluginService.capabilities(e.target);if(!i||!a||_.isEmpty(a.dataRoles))return!1;if(T.equals(i,a))return o=this.visualPluginService.capabilities(t.visualType),this.convertRoleWildCardProperties(o,a,t.objects),t.query=r.query,t.visualType=e.target,t.visualType===e.target&&a.supportsSynchronizingFilterState&&(t.syncGroup=r.syncGroup),!0;var o=e.schema,n=this.convertDrillableRoles(r.query,i,a,e.target,o),s=n.query,l=P.getDrillableRoles(a),p=this.getUniqueQueryFields(r.query,a,e.target),p=_.differenceWith(p,n.convertedFields,k.isEqualQueryFields),u=E.visualCapabilitiesHelperModuleFactory().create(a,this.geoTaggingService),n=E.visualCapabilitiesHelperModuleFactory().create(i,this.geoTaggingService),c=(u.orderByRolePreferences(o,p),F.clone(s.projections)),p=this.getExpressionRoleMappings(t.query,p),p=this.getConversionExprRoleList(p,n,u,o,e.target,t,c,l);if(_.isEmpty(p)&&_.isEmpty(s.projections))return!1;for(var d=0,m=p;d<m.length;d++){var v=m[d];v.isFieldParameter?s.addParameter(v.expr,v.roleName):s.add(v.expr,v.roleName,{nativeReferenceName:v.nativeReferenceName}),this.ensureDependentObjectDefn(u.objectDescs,v.roleName,t)}for(var g,n=P.getDrillableRoles(this.visualPluginService.capabilities(t.visualType)),h=_.isEmpty(n)?(g=P.getDrillableRoles(i),r.query):(g=n,t.query),f=0,y=l;f<y.length;f++){var C=y[f];if(s.projections[C]){s.ensureActiveItems(C);for(var x=0,S=g;x<S.length;x++){var b=S[x];h.projections[b]&&(s.projections[C].activeProjectionRefs=h.projections[b].activeProjectionRefs)}}}return this.updateTargetShowAllInfo(r,s,u),s.removeUnusedOrderBy(),s.resetExpansionStates(),this.convertRoleWildCardProperties(i,a,t.objects),this.upgradePivotTableProperties(t.objects,t.visualType,e.target),t.query=s,t.visualType=e.target,this.visualAuthoringCustomizeOperations.customizeOptions(t,o),!0},B.prototype.convertRoleWildCardProperties=function(e,t,r){if(!_.isEmpty(r)){var i=_.chain(e.dataRoles).filter((function(e){return e.kind!==E.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value(),a=_.chain(t.dataRoles).filter((function(e){return e.kind!==E.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value();if(!_.isEmpty(i)&&!_.isEmpty(a))for(var o in r){o=r[o];if(!_.isEmpty(o))for(var n=0,s=o;n<s.length;n++){var l=s[n].selector;if(l&&!_.isEmpty(l.data))for(var p=0,u=l.data.length;p<u;p++){var c=l.data[p];v.isRoleWildcard(c)&&_.isEqual(_.sortBy(c.roles),_.sortBy(i))&&(l.data[p]=d.fromRoles(a))}}}}},B.prototype.upgradePivotTableProperties=function(e,t,r){"matrix"!==t&&"table"!==t||"pivotTable"!==r&&"tableEx"!==r||(V.moveProperty(e,"general",void 0,"textSize","grid"),V.moveProperty(e,"general",void 0,"autoSizeColumnWidth","columnHeaders")),"matrix"===t&&"pivotTable"===r&&(V.moveProperty(e,"general",void 0,"columnSubtotals","subTotals"),V.moveProperty(e,"general",void 0,"rowSubtotals","subTotals")),"table"===t&&"tableEx"===r&&V.moveProperty(e,"general",void 0,"totals","total")},B.prototype.setAggregate=function(e,t){return!!t.singleVisual.query.setAggregate(e.role,e.index,e.newAggregate)&&(B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.removeAggregate=function(e,t){return!!t.singleVisual.query.removeAggregate(e.role,e.index)&&(B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.setPercentOfGrandTotal=function(e,t){return!!t.singleVisual.query.setPercentOfGrandTotal(e.role,e.index)&&(B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.removePercentOfGrandTotal=function(e,t){return!!t.singleVisual.query.removePercentOfGrandTotal(e.role,e.index)&&(B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.setPercentOfRoleTotal=function(e,t){return!!t.singleVisual.query.setPercentOfRoleTotal(e.roleRefs,e.role,e.index)&&(B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.removePercentOfRoleTotal=function(e,t){return!!t.singleVisual.query.removePercentOfRoleTotal(e.role,e.index)&&(B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.updateVisualCalculation=function(e,t,r,i,a){var o=e.singleVisual.query;return!!o&&(!!o.updateVisualCalculation(t,r,i,a)&&(B.clearConversionSourceContext(e.singleVisual),!0))},B.prototype.toggleShowAll=function(e,t){t.singleVisual.query.toggleShowAll(e),B.clearConversionSourceContext(t.singleVisual)},B.prototype.changeActiveProjection=function(e,t,r){e=t.query.projections[e];if(e){var i,a=_.uniqBy(e.all(),(function(e){return e.queryRef})),o=_.uniq(e.activeProjectionRefs),n=(i=_.isEmpty(o)?i:o.length)&&_.findIndex(a,(function(e){return e.queryRef===o[i-1]}));if(!(null==n||n<0)){if(1===r){if(!(1<=n))return;o.pop(),1!==i&&o[i-2]===a[n-1].queryRef||o.push(a[n-1].queryRef)}else{if(3===r&&(o.length=0),a.length,!(a.length>n+1))return;o.push(a[n+1].queryRef)}return B.clearConversionSourceContext(t),e.activeProjectionRefs=o}}},B.prototype.addDrillFilter=function(e,t,r,i,a){this.addDrill(e,t,r,i,a,2,!0)},B.prototype.addDrillToDetailsFilter=function(e,t,r,i,a){_.remove(t,(function(e){return!!e.expression&&D.isMeasure(e.expression)})),this.addDrill(e,t,r,i,a,0,!1)},B.prototype.addDrill=function(p,u,c,e,d,m,v){if(u&&c&&!_.isEmpty(e)&&d)for(var t=function(e){var t,r=c.defn.select().withName(e).expr,e=d.expr,i=O.isNot(e),a=(i&&(e=e.arg),g.getInExpr(e)),o=[],n=void 0,s=r.getKeyColumns(p);if(!_.isEmpty(a.values))for(var l=0;l<a.args.length;l++)!(function(t){var e=a.args[t];e&&-1!==D.indexOfExpr(s,e)&&(o.push(e),e=_.map(a.values,(function(e){return[e[t]]})),n=_.isEmpty(n)?e:_.chain(n).zip(e).map((function(e){return _.flatten(e)})).value())})(l);_.isEmpty(o)||_.isEmpty(n)||(e=y.inValues(o,n||[]),i&&(e=y.not(e)),i=E.DataViewScopeIdentity.filterFromIdentity([{kind:1,expr:e,key:d.key}]),e=_.filter(u,(function(e){return O.equals(r,e.expression)})),t=void 0,(t=v?_.find(e,(function(e){return e.howCreated===m})):t)?(t.filter&&t.howCreated,t.filter=i,t.howCreated=m,t.precedence=0):(e={name:null,expression:r,filter:i,type:b.contracts.FilterType.Categorical,howCreated:m,precedence:0},u.push(e)))},r=0,i=e;r<i.length;r++)t(i[r])},B.prototype.removeDrillFilter=function(e,t){if(!e)return!1;var r;this.ensureFiltersArrayIsValid(e);for(var i=0,a=e.length;i<a;i++){var o=e[i];if(o&&(2===o.howCreated&&O.equals(t,o.expression))){r=i;break}}return void 0!==r&&(e.splice(r,1),!0)},B.prototype.setMatchingFilterToAuto=function(t,e){!e.filters||(e=_.find(e.filters,(function(e){return null!=e&&O.equals(e.expression,t)})))&&(e.howCreated=0)},B.prototype.removeAutoFilterFromContract=function(r,e,t){var i,a;!r||(i=r.filters)&&(a=r.config.singleVisual.query,t=null!=t?t:this.getRemoveOptionsQueryRefs(e,a),_.forEach(t,(function(e){var e=a.defn.select().withName(e),t=e?e.expr:void 0,e=I.filterArray(i,(function(e){return r.name,null!=e&&0===e.howCreated&&O.equals(e.expression,t)}));0<e.length&&(e.length,b.FilterUtils.isFilterModified(e[0])?e[0].howCreated=1:_.remove(r.filters,e[0]))})),this.ensureFiltersArrayIsValid(i))},B.prototype.ensureFiltersArrayIsValid=function(e){if(null!=e)for(var t=e.length-1;0<=t;t--)null==e[t]&&e.splice(t,1)},B.prototype.getRemoveOptionsQueryRefs=function(e,t){var r,i=[],a=e,o=a.projOptions;if(a.role&&null!==o.fieldIndex){var n=o.fieldIndex,s=o.parameter;if(s)for(var l=null!=(o=s.length)?o:0,p=0;p<l;p++){var u=t.getQueryRef(a.role,{parameter:s,indexInParameter:p});i.push(u)}else for(var c=null!=(o=a.count)?o:1,p=0;p<c;p++){u=t.getQueryRef(a.role,{fieldIndex:n+p});i.push(u)}}else e.expr&&(o=I.ensureArray(e.expr),r=t.defn.select(),_.forEach(o,(function(t){var e=_.filter(r,(function(e){e=e.expr;return O.isAggregation(e)&&(e=e.arg),O.equals(e,t)}));_.forEach(e,(function(e){e&&e.name&&i.push(e.name)}))})));return i},B.prototype.isEmptyQueryVisual=function(e){var t,e=e.config.singleVisual;return!!(e&&this.visualPluginOps.isQueryVisual(e.visualType)&&e.query&&0===e.query.defn.select().length&&_.isEmpty(e.query.getQueryFieldParameters()))&&(!!(t=this.visualPluginService.capabilities(e.visualType))&&!((t=E.ScriptResultUtil.extractScriptResultFromVisualConfig(t.dataViewMappings,e.objects))&&!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(t.source)))},B.prototype.setDefaultSort=function(e,t,r,i){if(e.config&&e.config.singleVisual){var e=e.config.singleVisual,a=i.capabilities(e.visualType);if(r.shouldApplyDefaultSort(e,a)){i=e.query;if(i){var r=i.defn,o=i.projections,n=r.select(),s=[],l=_.filter(a.dataRoles,(function(e){return!(_.has(e,"joinPredicate")||0===e.joinPredicate)}));if(_.some(l,(function(e){var e=F.getRole(o,e.name);if(e)return e=_.map(e.all(),(function(e){return n.withName(e.queryRef)})),_.some(e,(function(e){return e.expr&&!_.isEmpty(e.expr.getOrderByColumns(t))}))})))e.hasDefaultSort&&(e.query=new k(r.orderBy([]),i.projections,i.expansionStates),e.hasDefaultSort=!1);else{for(var p=i.hasVisualCalcExpressions(),u=!1,c=0,d=l;c<d.length;c++){var m=d[c],v=F.getRole(o,m.name);if(v){var g=_.map(v.all(),(function(e){return e.queryRef}));if(g){for(var h=!1,f=[],y=this.shouldDefaultExpandSort(m.name,a.expandAndSort,g.length),C={direction:1,expr:null},x=0,S=g;x<S.length;x++){var b=S[x],E=n.withName(b),E=E&&E.expr;if(E&&D.isExprValidForSorting(E)&&(!p||!D.isMeasure(E))){var N=E.getMetadata(t);if(N){var V=1===N.kind&&N.type.numeric;if(y&&(N.type.text||N.type.temporal||N.type.numeric&&_.first(g)!==b?f.push({direction:1,expr:E}):y=!1),null==C.expr&&(E&&V&&(C.direction=2),C.expr=E),N.type.temporal&&(h=u=!0,!y))break;if(V&&(h=!0,!y))break}}}if(y&&_.isEmpty(s)){_.isEmpty(f),s=f;break}if(h&&(_.isEmpty(s)||u)&&(C.expr,s=[C]),u||y)break}}}_.isEmpty(s)||(e.hasDefaultSort=!0,e.query=new k(r.orderBy(s),i.projections,i.expansionStates))}}}}},B.prototype.setDefaultExpandLevel=function(e,t,a,r){var o,n=this,s=t.capabilities(e.config.singleVisual.visualType);r&&s.expandAndSort&&_.includes(s.expandAndSort,r)&&e.config&&e.config.singleVisual&&((o=e.config.singleVisual.query)&&s.expandAndSort.forEach((function(e){var r,i,t=F.getRole(o.projections,e);t&&(r=t.getQueryRefs(),n.shouldDefaultExpandSort(e,s.expandAndSort,r.length)&&(i=o.defn.select(),r.every((function(e){var t=i.withName(e).expr.getMetadata(a);if(t)return t.type.text||t.type.temporal||t.type.numeric&&_.first(r)!==e}))&&(t.activeProjectionRefs=_.map(r,(function(e){return e})))))})))},B.prototype.ensureValidDrillState=function(e,t,r){for(var i=0,a=t;i<a.length;i++){var o=a[i],n=(this.removeDrillFilter(e.filters,o.expr),e.config.singleVisual.query),o=n.projections[o.roleName];!o||null!=(o=_.last(o.activeProjectionRefs))&&(n=n.defn.select().withName(o).expr,this.removeDrillFilter(e.filters,n))}this.ensureValidDrillMode(e,r)},B.prototype.ensureValidDrillMode=function(e,t){var r=e.drillMode;(1===r&&0===t.getSupportedDrillDirections(e)||2===r&&!t.canDrillToDetails(e))&&t.setDrillMode(e,0)},B.prototype.resolveParameters=function(b,E,e,N,V,P){var w={queryChange:!1,aliasChange:!1,outputFilterChange:!1,totalAddAttemptCount:0,totalAddSuccessCount:0,totalRemoveAttemptCount:0,totalRemoveSuccessCount:0,totalSuccessColumnCount:0,totalSuccessDateHierarchyCount:0,totalSuccessMeasureCount:0},T=E&&E.config&&E.config.singleVisual&&E.config.singleVisual.query;if(T){var F,t,j=[];for(F in e)for(var R=T.projections[F],D=R.getFieldParameters(),A=this,r=0,i=e[F];r<i.length;r++)!(function(e){var t=e.parameter,r=e.result,i=_.find(D,(function(e){return e.index===t.index}));if(!i)return;if(!O.equals(t.expr,i.expr))return;for(var a,o,n,s=R.getParameterProjections(i),l=_.map(s,(function(e){return T.defn.select().withName(e.queryRef).expr})),p=_.map(r,(function(e){return e.expr})),u=I.getLongestCommonSubsequence(p,l,O.equals),c=u.length-1,d=[],m=[],v=[],g=l.length-1;0<=g;g--)0<=c&&O.equals(l[g],u[c])?c--:(S={role:F,projOptions:{parameter:i,indexInParameter:g}},m.push(S),d.push(s[g].queryRef),a={expr:l[g],roleName:F},v.push(a));0<m.length&&(o=(e=A.removeWithValidation(T,d,m,E,b,v,N,V,void 0,!0)).removeSuccessCount,n=e.removeAttemptCount,e=e.outputFilterChange,w.totalRemoveSuccessCount+=o,w.totalRemoveAttemptCount+=n,w.outputFilterChange||(w.outputFilterChange=e));for(var c=0,h=0,f=0,g=0;g<p.length;g++){var y,C,x=r[g].alias,S={parameter:i,indexInParameter:g-(h-f)};0<u.length&&O.equals(p[g],u[c])?(c++,P&&(w.aliasChange=P(E,S,F,x)||w.aliasChange)):(C={expr:y=p[g],schema:b,targetRole:F,projOptions:S},h++,A.add(C,E.config,!1)&&(f++,O.isColumn(y)?w.totalSuccessColumnCount++:O.isMeasure(y)?w.totalSuccessMeasureCount++:O.isHierarchyLevel(y)&&w.totalSuccessDateHierarchyCount++,j.push(y),P&&(w.aliasChange=P(E,S,F,x)||w.aliasChange)))}w.totalAddAttemptCount+=h})(i[r]);w.totalAddSuccessCount=j.length,0<w.totalAddSuccessCount&&(t=this.runAddFieldValidation(E,b,j,N,V,void 0,!0),w.outputFilterChange||(w.outputFilterChange=t)),(0<w.totalAddSuccessCount||0<w.totalRemoveSuccessCount)&&(this.setDefaultSort(E,b,V,this.visualPluginService),C.setQueryKeepProjectionOrder(E),w.queryChange=!0)}return w},B.prototype.runAddFieldValidation=function(e,t,r,i,a,o,n,s){this.ensureValidDrillMode(e,i);i=!1;if(n&&!this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||(i=(null==(o=(o||this.updateFilterState.bind(this))(t,e,!1,!0,!0))?void 0:o.clearOrDefault)||(null==o?void 0:o.updateAll)),n||(this.setDefaultExpandLevel(e,this.visualPluginService,t,s),this.setDefaultSort(e,t,a,this.visualPluginService),C.setQueryKeepProjectionOrder(e)),_.isArray(r))for(var l=0,p=r;l<p.length;l++){var u=p[l];this.setMatchingFilterToAuto(u,e)}else this.setMatchingFilterToAuto(r,e);return i},B.prototype.removeWithValidation=function(e,t,r,i,a,o,n,s,l,p){var u=0,c=[],d=!1;this.removeAutoFilterFromContract(i,void 0,t);for(var m,v=0;v<r.length;v++){var g=this.remove(r[v],i.config,a);u+=g?1:0,g||c.push(v)}if(0<u){if(0<c.length){t=_.clone(t);for(var h=c.length-1;0<=h;h--)t.splice(c[h],1)}p||this.setDefaultExpandLevel(i,this.visualPluginService,a,null==(m=_.first(r))?void 0:m.role),this.ensureValidDrillState(i,o,n),this.isEmptyQueryVisual(i)?e=i.config.singleVisual.query=void 0:p||(this.setDefaultSort(i,a,s,this.visualPluginService),C.setQueryKeepProjectionOrder(i)),p&&!this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||(d=(null==(m=(l||this.updateFilterState.bind(this))(a,i,!0,!0,!0,null))?void 0:m.clearOrDefault)||(null==m?void 0:m.updateAll)),p||this.clearUnusedObjectDefinitions(i,e,t)}return{removeAttemptCount:r.length,removeSuccessCount:u,outputFilterChange:d}},B.prototype.clearUnusedObjectDefinitions=function(e,t,r){_.forEach(r,(function(i){var a;t&&t.isUsed(i)||(a=e.config.singleVisual.objects,_.forEach(a,(function(e,t){var r=[];_.forEach(e,(function(e){e.selector&&e.selector.metadata===i&&r.push(e.selector)})),_.forEach(r,(function(e){V.deleteObjectDefinition(a,t,e)}))})))}))},B.prototype.updateFilterState=function(e,t,r,i,a,o){var n=t.config.singleVisual,s=this.visualPluginService.capabilities(n.visualType),s=s?s.objects:null;if(i&&this.ensureDefaultFilterApplied(e,n,r))return{clearOrDefault:!0,updateAll:!1};i=!1;if(a){r=this.updateFilterOutput(n,s,e);if(2===r)return{clearOrDefault:!0,updateAll:!1};i=1===r}a=t.config.singleVisual;return{clearOrDefault:!1,updateAll:i=!i&&o&&a&&a.objects&&V.getValue(a.objects,o,null)?!0:i}},B.prototype.ensureDefaultFilterApplied=function(e,t,r){var i=this.visualPluginService.capabilities(t.visualType),i=i?i.objects:null,a=m.findDefaultValue(i),o=t.query&&t.query.getUniqueQueryRefs();if(!a||_.isEmpty(o))return this.clearDefaultFilterOutput(t,i);for(var n=t.query.defn.select(),s=[],l=[],p=!0,u=0,c=_.map(o,(function(e){return n.withName(e).expr}));u<c.length;u++){var d=c[u];D.getDefaultValue(d,e)?p?s.push.apply(s,this.getExprKeyColumns(d,e)):l.push.apply(l,this.getExprKeyColumns(d,e)):p=!1}if(_.isEmpty(s)&&_.isEmpty(l)||r)return this.clearDefaultFilterOutput(t,i);t.objects||(t.objects={});a=m.findFilterOutput(i),o=f.getDefaultAnyValueFilter(s,l);return V.setValue(t.objects,a,null,o),!0},B.prototype.getExprKeyColumns=function(e,t){var r=l.asFieldPattern(e);return r.column||r.groupingColumn||r.hierarchyLevel?e.getKeyColumns(t):[e]},B.prototype.clearDefaultFilterOutput=function(e,t){if(!e.objects)return!1;t=m.findFilterOutput(t);if(!t)return!1;var r=V.getValue(e.objects,t,null);return!(!r||!f.isDefaultFilter(r))&&(V.deleteProperty(e.objects,t.objectName,null,t.propertyName),!0)},B.prototype.updateFilterOutput=function(e,t,r){if(e.objects){t=m.findFilterOutput(t);if(t){var i=V.getValue(e.objects,t,null);if(i){if(!this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!e.query)return V.deleteProperty(e.objects,t.objectName,null,t.propertyName),2;r=this.updateFilterOutputForVisual(e.query,i,r);return f.isSameFilter(r,i)?0:r?(V.setValue(e.objects,t,null,r),1):(V.deleteProperty(e.objects,t.objectName,null,t.propertyName),2)}}}return 0},B.prototype.updateFilterOutputForVisual=function(e,t,r){var i=e.getUniqueQueryRefs();if(!_.isEmpty(i)){var a=new h,o=e.defn.select(),n=_.map(i,(function(e){return o.withName(e).expr.accept(a,r)})).reduce((function(e,t){return e.concat(t)}),[]);if(!_.isEmpty(n)){for(var s,l=[],p=0,u=t.where();p<u.length;p++){var c=u[p],d=D.syncSQExprWithFilterIdenities(n,c.condition);d&&(d={target:c.target,condition:d,annotations:c.annotations},l.push(d))}return s=0<l.length?new f(t.from(),l):s}}},B.prototype.moveProjectionCore=function(e,t,r){var i=e.singleVisual;if(!i||!i.query)return!1;var a=r.sourceRole,o=r.targetRole,n=r.sourceIndex,s=r.targetIndex,l=r.replacementExpressions,p=r.schema,u=r.allowPartialReplace,c=j.clone(i),r=c.query.getParameterByFieldIndex(n,a),d=(!r&&t.length,c.query.defn.orderBy()),m=l||t,v=E.columnPropertiesAuthoringModuleFactory(),g=v.getColumnPropertiesForExprs(m,c),l={role:a,projOptions:{fieldIndex:n,parameter:r},count:t.length,shouldRemoveParameter:!0};if(!this.tryRemoveProjections(c.query,c.columnProperties,l))return!1;0<d.length&&c.query.orderBy(d);var t=this.visualPluginService.capabilities(i.visualType),h=E.visualCapabilitiesHelperModuleFactory().create(t,this.geoTaggingService);if(!h)return!1;var f=h.roles.withName(o);if(!f)return!1;l=a===o&&s===n,d=!1;if(l){if(1===m.length&&D.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,p,m[0],this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!b.FilterUtils.supportsFilterOutput(t),this.visualPluginOps.isAnalysisVisual(c.visualType))){var y={expr:m[0],schema:p,targetRole:o,projOptions:{fieldIndex:s}};if(!(d=this.tryAdd(h,c,!0,y)))return!1}}else if(r){y={expr:r.expr,schema:p,targetRole:o,projOptions:{fieldIndex:s}};if(!(d=this.tryAdd(h,c,!0,y)))return!1}if(!d)for(var C=0;C<m.length;C++){var x,S=m[C],y=(m[C]=this.aggregateIfNecessary(m[C],f,p),{expr:m[C],schema:p,targetRole:o,projOptions:{fieldIndex:s+C}});if(!this.tryAdd(h,c,!1,y)){if(0<C&&u)break;return!1}i.query.projections[a].showAll&&(x=m[C].getMetadata(p),this.isShowAllRole(f.kind)&&x&&1!==x.kind&&(c.query.projections[o].showAll=!0)),v.applyColumnPropertiesByExpr(S,m[C],c,g)}return e.singleVisual=c,this.visualAuthoringCustomizeOperations.customizeOptions(e.singleVisual,p),B.clearConversionSourceContext(e.singleVisual),!0},B.prototype.aggregateIfNecessary=function(e,t,r){return null!=i.getAggregate(e,r)||t.kind!==E.VisualDataRoleKind.Measure||D.discourageAggregation(e,r)?t.kind===E.VisualDataRoleKind.Grouping?y.removeAggregate(e,r):e:this.aggrOps.createExprWithAggregate(e,r,!0,t.requiredTypes)},B.clearConversionSourceContext=function(e){e.conversionSourceContext=null},B.prototype.getConversionExprRoleList=function(o,n,s,l,p,u,c,d){function e(e){for(var t=[],r=0,i=o;r<i.length;r++){var a=i[r];a.isFieldParameter?t.push({expr:a.expr,isFieldParameter:a.isFieldParameter,roleName:a.roleName}):(a=e(a.expr))&&t.push({expr:a})}if(!_.isEmpty(t))return m.getCompatRolesForExprs(t,n,s,l,p,u,!0,c,d)}var m=this,t=this.getCompatRolesForExprs(o,n,s,l,p,u,!1,c,d);return _.isEmpty(t)&&(t=e((function(e){return D.isMeasure(e)?e:m.aggrOps.createExprWithAggregate(e,l,!0,null)}))),(t=_.isEmpty(t)?e((function(e){return D.isMeasure(e)?y.removeAggregate(e,l):e})):t)||[]},B.prototype.getCompatRolesForExprs=function(e,t,r,i,a,o,n,s,l){for(var p=[],u=s||{},c=new R(w.hierarchyLevelComparer),d=0,m=e;d<m.length;d++){var v=m[d],g=void 0,h=v.expr,f=v.isFieldParameter,y=v.roleName,C=v.nativeReferenceName,v=(y&&(g=t.roles.withName(y)),this.getTargetRoleForConversion(v,t,r));if(v=r.findCompatibleRole({queryProjections:u,schema:i,expr:h,targetRole:v,preferDrillableRoles:!1,roleToExprMap:c,useStrict:!0,isFieldParameter:f,sourceRole:f&&g})){v=this.ensureCorrectKeyInfluencersRole(a,v,void 0),g=this.ensureCorrectSmallMultiplesRole(o,r.capabilities,v,t.capabilities,y).name;if(!f){this.updateProjections(u,g,l);v=r.getNumberRangesForRoles(u)[g];if(this.shouldUseVariation(h,i,g,l,v,_.size(e)))return y=A.getSourceVariationExpr(h),p.push({expr:y,roleName:g,nativeReferenceName:C}),p}if(p.push({expr:h,isFieldParameter:f,roleName:g,nativeReferenceName:C}),n)return p}}return p},B.prototype.shouldUseVariation=function(e,t,r,i,a,o){if(!_.includes(i,r)&&a&&a.max<o){i=l.asFieldPattern(e,t);if(i&&i.columnHierarchyLevelVariation)return!0}return!1},B.prototype.getExpressionRoleMappings=function(t,e){return _.map(e,(function(e){return{expr:e.expr,roleName:t.getRoleNameForExpr(e.expr),isFieldParameter:e.isFieldParameter,nativeReferenceName:e.nativeReferenceName}}))},B.prototype.getTargetRoleForConversion=function(e,t,r){if(!r.hasPreferredTypes()){var e=e.roleName,i=t.roles,t=t.capabilities,a=r.roles,r=r.capabilities,i=i.withName(e),a=a.withName(e);if(i&&a&&_.isEqual(i.kind,a.kind)){i=this.getDataViewMappingConditions(t),a=this.getDataViewMappingConditions(r);if(!i&&!a||this.getDoesTargetRoleMatchSourceRole(e,i,a))return e}}},B.prototype.getDoesTargetRoleMatchSourceRole=function(r,e,i){return e&&i&&!e.some((function(e,t){e=_.get(e,r,null),t=_.get(i[t],r,null);return e&&t&&!_.isEqual(e,t)}))},B.prototype.getDataViewMappingConditions=function(e){e=e.dataViewMappings&&e.dataViewMappings[0];return e&&e.conditions},B.prototype.updateProjections=function(e,t,r){var i={queryRef:t},a=F.getRole(e,t);a||(e[t]=a=new o([])),a.addProjection(i),_.includes(r,t)&&a.addActiveQueryReference(a.all()[0].queryRef)},B.prototype.createConversionSourceContext=function(e,t,r){return{query:e,visualType:t,syncGroup:r}},B.prototype.convertDrillableRoles=function(e,t,r,i,a){var o=new k(e.defn.select([]),{},[]),t=P.getDrillableRoles(t);return _.isEmpty(t)?{query:o,convertedFields:[]}:{query:o,convertedFields:this.convertDrillableProjections(r,i,e,a,t,o)}},B.prototype.convertDrillableProjections=function(e,t,r,i,a,o){for(var n=P.getDrillableRoles(e),s=[],l=0,p=a;l<p.length;l++){var u=p[l],u=this.getQueryFieldsForRole(r,u,e,t),u=this.convertDrillableFields(u,i,e,o),s=_.unionWith(s,u,k.isEqualQueryFields);if(_.isEmpty(n))break}return o.ensureDrillableRoles(n),s},B.prototype.supportsFieldParameters=function(e){return this.featureSwitchService.featureSwitches.fieldParameters&&this.featureSwitchService.featureSwitches.fieldParametersAuthoring&&e.hasQueryFieldParameters()},B.prototype.getQueryFieldsForRole=function(e,t,r,i){var a=e.projections[t];return a?this.getQueryFields(e,r,i,(function(){return _.map(a.all(),(function(e){return e.queryRef}))}),(function(){return e.tryGetFieldExprs(t)})):[]},B.prototype.getUniqueQueryFields=function(e,t,r){return this.getQueryFields(e,t,r,(function(){return e.getUniqueQueryRefs()}),(function(){return e.getUniqueQueryFields()}))},B.prototype.getQueryFields=function(e,t,r,i,a){var o=e.defn.select();if(this.supportsFieldParameters(e)){e=a();if(b.FilterUtils.supportsFilterOutput(t)||this.visualPluginOps.isAnalysisVisual(r))for(var n=0,s=e;n<s.length;n++)s[n].isFieldParameter=!1;return e}a=i();return _.map(a,(function(e){return{expr:o.withName(e).expr,queryName:e,isFieldParameter:!1,nativeReferenceName:o.withName(e).nativeReferenceName}}))},B.prototype.convertDrillableFields=function(u,c,e,d){for(var m,v=E.visualCapabilitiesHelperModuleFactory().create(e,this.geoTaggingService),g=v.getNumberRangesForRoles(d),h=P.getDrillableRoles(e),f=_.isEmpty(h),y=new R(w.hierarchyLevelComparer),C=[],x=[],S=this,t=0,r=u;t<r.length;t++)!(function(e){var t=e.expr,r=e.queryName,i=e.nativeReferenceName;if(O.isHierarchyLevel(t)){var a=A.getSourceVariationExpr(e.expr);if(a&&_.find(x,(function(e){return O.equals(e,a)})))return C.push(e)}var o=v.findCompatibleRole({queryProjections:d.projections,schema:c,expr:t,preferDrillableRoles:!0,roleToExprMap:y,useStrict:!0,isFieldParameter:e.isFieldParameter});if(o){var n=o.name,s=g[n],l=-1;if(e.isFieldParameter)l=d.addParameter(t,o.name),C.push(e);else{var p=d.projections[n];if(f&&p&&(m=p.all().length,s&&s.max&&s.max<=m))return;if(S.shouldUseVariation(e.expr,c,o.name,h,s,_.size(u)))return p=A.getSourceVariationExpr(e.expr),x.push(p),l=d.add(p,n,{exprName:r,nativeReferenceName:i});l=d.add(t,n,{exprName:r,nativeReferenceName:i})}-1<l&&C.push(e)}})(r[t]);return C},B.prototype.tryRemove=function(e,t,r,i){return u(r)?this.tryRemoveProjections(e,t,r):!!a(r)&&this.tryRemoveExpressions(e,r,i)},B.prototype.tryRemoveExpressions=function(e,t,r){var i,a=!1,o=t.fieldParameter;if(_.isArray(t.expr))for(var n=0,s=t.expr;n<s.length;n++)var l=s[n],a=e.removeExpr(l,!!t.ignoreAggregates,r,null==o?void 0:o.expr)||a;else a=e.removeExpr(t.expr,!!t.ignoreAggregates,r,null==o?void 0:o.expr);return a=t.shouldRemoveParameter&&o&&0===(null!=(i=o.length)?i:0)?e.removeParameter(o)||a:a},B.prototype.tryRemoveProjections=function(e,t,r){var i=r.role,a=r.projOptions.parameter,o=!1;if(a)var n=r.shouldRemoveParameter,s=r.projOptions.indexInParameter,o=this.removeParameterProjections(e,t,a,i,n,s);else for(var l=r.projOptions.fieldIndex,p=(null!=(a=r.count)?a:1)-1;0<=p;p--)if(!(o=this.removeProjection(e,t,i,{fieldIndex:l})))return!1;return o},B.prototype.removeParameterProjections=function(e,t,r,i,a,o){var n=!1;if(null!=o)var s={parameter:r,indexInParameter:o},n=this.removeProjection(e,t,i,s);else for(var l=(null!=(o=r.length)?o:0)-1;0<=l;l--){s={parameter:r,indexInParameter:l};if(!(n=this.removeProjection(e,t,i,s)))return!1}return n=a&&0===(null!=(o=r.length)?o:0)?e.removeParameterByRoleName(r,i)||n:n},B.prototype.removeProjection=function(e,t,r,i){var a=e.getQueryRef(r,i),r=e.removeProjection(r,i);return a&&!e.isUsed(a)&&t&&t[a]&&delete t[a],r},B.prototype.tryAdd=function(e,t,r,i){var a=i.expr,o=new R(w.hierarchyLevelComparer),n=!1,s=i.projOptions;if(_.isArray(a))for(var l=s&&s.fieldIndex,p=0,u=a;p<u.length;p++){var c=u[p],n=null!=this.tryAddQuery(e,t,i,c,s,o,r)||n;null!=l&&s.fieldIndex++}else if(null==this.tryAddQuery(e,t,i,a,s,o,r))return!1;if(!r){var d=P.getDrillableRoles(e.capabilities);if(t.query.ensureDrillableRoles(d),_.isArray(a))return n}return!0},B.prototype.tryAddQuery=function(e,t,r,i,a,o,n){if(l=e.findCompatibleRole({queryProjections:t.query.projections,schema:r.schema,expr:i,preferDrillableRoles:!1,roleToExprMap:o,targetRole:r.targetRole,isFieldParameter:n})){var s,l=this.ensureCorrectKeyInfluencersRole(t.visualType,l,r.targetRole);if(this.featureSwitchService.featureSwitches.cartesianMultiplesAuthoring||c(l,t,e.capabilities)||(l=this.ensureCorrectSmallMultiplesRole(t,e.capabilities,l,void 0,void 0)),e.validateDuplicateColumnsInRole(l,i,t.query,n))return r=l.name,s=void 0,s=n?t.query.addParameter(i,r,a&&a.fieldIndex):t.query.add(i,r,a),this.ensureDependentObjectDefn(e.objectDescs,r,t),o.add(i,l),s}},B.prototype.ensureCorrectKeyInfluencersRole=function(e,t,r){return e!==E.visuals.plugins.keyDriversVisual.name||t.name!==E.visuals.keyDriverRoleNames.details||r?t:_.find(E.visuals.getKeyDriversCapabilities().dataRoles,(function(e){return e.name===E.visuals.keyDriverRoleNames.explainBy}))},B.prototype.ensureCorrectSmallMultiplesRole=function(e,t,r,i,a){var o;return null!=(o=this.featureSwitchService.featureSwitches)&&o.cartesianMultiplesAuthoring||!s.supportsSmallMultiplesDataViewMapping(null==t?void 0:t.dataViewMappings)||r.name!==E.visuals.cartesianRoleNames.rows||i&&a===E.visuals.cartesianRoleNames.rows&&s.supportsSmallMultiplesDataViewMapping(null==i?void 0:i.dataViewMappings)||e.hasUsedSmallMultiples?r:_.find(t.dataRoles,(function(e){return e.name===E.visuals.cartesianRoleNames.category}))},B.prototype.ensureDependentObjectDefn=function(e,t,r){if(e)for(var i in e){var a,o=e[i];for(a in o.properties){var n,s=o.properties[a];s.rule&&s.rule.inputRole===t&&(n=(n=r.objects)||(r.objects={}),(n=V.ensure(n,i,null)).properties[a]||(n.properties[a]=this.createDefaultDefinition(s.type)))}}},B.prototype.createDefaultDefinition=function(e){if(e.fillRule)return t.getDefaultFillRuleDefinition()},B.prototype.getSourceShowAllInfo=function(e){for(var t={},r=0,i=_.values(e);r<i.length;r++)for(var a=i[r],o=a.showAll,n=0,s=a.all();n<s.length;n++)t[s[n].queryRef]=o;return t},B.prototype.updateTargetShowAllInfo=function(e,t,r){for(var i=this.getSourceShowAllInfo(e.query.projections),a=0,o=_.keys(t.projections);a<o.length;a++){var n=o[a],s=r.roles.withName(n).kind;if(this.isShowAllRole(s))for(var l=0,p=t.projections[n].all();l<p.length;l++){var u=i[p[l].queryRef];u&&(t.projections[n].showAll=u)}}},B.prototype.isShowAllRole=function(e){return e===E.VisualDataRoleKind.Grouping||e===E.VisualDataRoleKind.GroupingOrMeasure},B.prototype.shouldDefaultExpandSort=function(e,t,r){return this.featureSwitchService.featureSwitches.easierHierarchicalAxis&&_.includes(t,e)&&1<r},p=B})(powerbi=powerbi||{}),(function(v){var S,e,g,u,h,b,r,E,f,c,i,y;function C(e,t,r){this.displayNameService=e,this.featureSwitches=t,this.visualPluginService=r}function n(e,t,r){this.isRoleSortable=e,this.getSortableFieldsForRole=t,this.featureSwitchService=r,this.groups=[],this.allSortableFields=[],this.uniqueGroupKeys=[],this.uniqueRoles=[]}S=v.explore||(v.explore={}),e=S.services||(S.services={}),g=v.DataViewMapping,u=v.data.QueryProjectionsByRole,h=v.visuals.SmallMultiplesUtils,b=v.data.SQExpr,r=v.data.SQExprBuilder,E=v.data.SQExprUtils,f=v.explore.util.VisualContainerUtils,c=S.contracts.VisualQuery,e.createSortService=function(e,t,r){return new i(e,t,r)},C.prototype.getSortableFields=function(e){var t=e.visualType,r=this.visualPluginService.capabilities(t);if(!r||!this.isVisualSortable(r))return{sortableFields:[],sortGroups:[]};t=this.createIsRoleSortableDelegate(t,e.compiledMappings);return this.getGroupedSortableFieldsFromProjections(e.query,e.schema,r,e.columnProperties,t)},C.prototype.createIsRoleSortableDelegate=function(e,t){var r=this.visualPluginService.getPlugin(e),e=this.visualPluginService.capabilities(e);if(!r.getSortableRoles||!e.sorting)return function(e){return!0};var e={dataViewMappings:t,featureSwitches:this.featureSwitches.featureSwitches},i=r.getSortableRoles(e);return _.isEmpty(i)?function(e){return!1}:function(e){return 0<=i.indexOf(e)}},C.prototype.addSort=function(e,t){e&&e.defn&&t&&(e.defn=e.defn.orderBy(t))},C.prototype.removeSort=function(e,t){if(e&&e.defn&&t)for(var r=0,i=t;r<i.length;r++){var a=i[r];e.defn=e.defn.removeOrderBy(a.expr)}},C.prototype.resetSort=function(e){var t;e&&e.defn&&(t=e.defn.orderBy(),this.removeSort(e,t))},C.prototype.applyImplicitSort=function(e,t){if(!t)return e;var r=e.defn;if(!r)return e;for(var t=t.clauses,i=r.select(),a=[],o=0,n=t;o<n.length;o++){var s,l=n[o],p=u.getRole(e.projections,l.role);p&&(s=l.direction,a.push.apply(a,_.map(p.all(),(function(e){return{expr:i.withName(e.queryRef).expr,direction:s}}))))}return _.isEmpty(a)?e:new c(r.orderBy(a),e.projections,e.expansionStates)},C.prototype.shouldApplyDefaultSort=function(e,t){if(null!=(r=t.sorting)&&r.custom||null!=(r=t.sorting)&&r.implicit)return!1;var r=e.query;if(!r)return!1;var i=f.createRoleKindByQueryRef(r),r=v.DataViewAnalysis.chooseDataViewMappings(r.projections,t.dataViewMappings,i,this.featureSwitches.featureSwitches),i=null==(t=null==r?void 0:r.supportedMappings)?void 0:t[0];return!((null==i?void 0:i.matrix)&&h.isSmallMultiplesDataViewMapping(i))&&(e.hasDefaultSort||_.isEmpty(e.query.defn.orderBy()))},C.prototype.ensureValidSorting=function(e){var t=e.query,r=t.defn;if(!r)return t;var i=r.orderBy();if(_.isEmpty(i))return t;var e=this.getSortableFields(e).sortableFields,a=[];if(!_.isEmpty(e))for(var o=0,n=e;o<n.length;o++){var s=n[o];a.push.apply(a,this.createSortDefinitions(s))}for(var l=!1,p=i.length-1;0<=p;p--)!(function(t){if(_.find(a,(function(e){return b.equals(e.expr,i[t].expr)})))return;i.splice(t,1),l=!0})(p);return l?new c(r.orderBy(i),t.projections,t.expansionStates):t},C.prototype.isVisualSortable=function(e){return _.some(e.dataRoles,(function(e){return e.kind!==v.VisualDataRoleKind.Measure}))},C.prototype.getGroupedSortableFieldsFromProjections=function(a,o,n,s,e){var t,l=this,p=a.defn.select(),u=a.defn.orderBy(),r=f.createRoleKindByQueryRef(a),r=v.DataViewAnalysis.chooseDataViewMappings(a.projections,n.dataViewMappings,r,this.featureSwitches.featureSwitches),i=new y(e,function(e,t,r,i){e=a.getRolesActiveProjectionsRefs([e],!1);return _.isEmpty(e)?[]:l.createSortableFieldsForQueryRefs(o,p,e,u,n,s,0!==r,t,i)},this.featureSwitches);if(r.supportedMappings)for(var c=0,d=r.supportedMappings;c<d.length;c++){var m=d[c];m.matrix&&h.isSmallMultiplesDataViewMapping(m)?g.visitMatrix(m.matrix,i):m.categorical&&null!=(t=this.featureSwitches.featureSwitches)&&t.sortLegend&&g.visitCategorical(m.categorical,i)}return _.isEmpty(i.groups)?this.getDefaultGroupSortableFieldsFromProjections(a,r,o,n,s,e):{sortableFields:i.allSortableFields,sortGroups:i.groups}},C.prototype.getDefaultGroupSortableFieldsFromProjections=function(e,t,r,i,a,o){i.dataRoles;for(var n=[],s=e.defn.select(),l=e.defn.orderBy(),p=_.some(t.supportedMappings,(function(e){return e.categorical})),u=0,c=i.dataRoles;u<c.length;u++){var d,m=c[u].name;o(m)&&(d=e.getRolesActiveProjectionsRefs([m],!1),_.isEmpty(d)||(m=!_.isEmpty(e.projections[m].activeProjectionRefs),d=this.createSortableFieldsForQueryRefs(r,s,d,l,i,a,p&&m,C.DefaultSortGroupKey),n.push.apply(n,d)))}return this.createResultWithSortGroup(n)},C.prototype.createSortableFieldsForQueryRefs=function(n,s,e,l,p,u,c,d,m){for(var v,g=!1,h=Number.MAX_VALUE,f=[],y=[],C=[],x=this,t=0,r=e;t<r.length;t++)!(function(e){var t=s.withName(e),r=null==t?void 0:t.expr;if(!r||!E.isExprValidForSorting(r))return;var i=x.getDisplayNameFromQueryRef(n,s,e,p,u),a=x.applySortingScope(r,m),o=_.findIndex(l,(function(e){return b.equals(e.expr,a)}));o!==S.constants.invalidSortExprIndex&&(h=Math.min(h,o)),c?((g=g||o!==S.constants.invalidSortExprIndex)&&!v&&(S.constants.invalidSortExprIndex,v=l[o].direction),y.push({name:e,expr:r}),C.push(i)):(g=o!==S.constants.invalidSortExprIndex,v=g?l[o].direction:void 0,f.push({displayName:i,exprs:[t],active:g,orderByIndex:g?o:void 0,sortDirection:v,groupKey:d,scope:m}))})(r[t]);return c?_.isEmpty(y)?[]:[{displayName:C.join(" "),exprs:y,active:g,orderByIndex:g?h:void 0,sortDirection:g?v:void 0,groupKey:d,scope:m}]:f},C.prototype.getDisplayNameFromQueryRef=function(e,t,r,i,a){t=null==(t=t.withName(r))?void 0:t.expr;return t?this.displayNameService.getDisplayName(t,e,i,r,a):""},C.prototype.createResultWithSortGroup=function(e){var t=[];return _.isEmpty(e)||t.push({key:C.DefaultSortGroupKey,displayName:null,fields:e,isDefaultGroup:!0}),{sortableFields:e,sortGroups:t}},C.prototype.createSortDefinitions=function(e){for(var t=[],r=0,i=e.exprs;r<i.length;r++){var a=i[r];t.push({expr:this.applySortingScope(a.expr,e.scope),direction:null!=(a=e.sortDirection)?a:2})}return t},C.prototype.applySortingScope=function(e,t){return _.isEmpty(t)?e:r.scopedEval(e,t)},C.DefaultSortGroupKey="Default",i=C,e.SortService=i,n.prototype.visitRole=function(e,t){if(this.isRoleSortable(e))switch(t){case"MatrixColumnsGroup":case"CategoricalSeries":this.featureSwitchService.featureSwitches.sortLegend&&this.addRole(e,"Legend",1);break;case"MatrixRowsGroup":return void this.addRole(e,e,1);case"CategoricalCategory":return void this.addRole(e,"Category",1);case"MatrixIntersection":case"MatrixRowsScopedValue":return void this.addRole(e,"Rows",0,!0,[r.roleRef("Rows")]);case"CategoricalValue":case"CategoricalValueGroup":return void this.addRole(e,"Category",0,!0);default:return}},n.prototype.addRole=function(e,t,r,i,a){var o;if(i=void 0===i?!1:i){if(!(o=_.find(this.groups,(function(e){return e.key===t}))))return}else o={key:t,displayName:n.RoleToSortGroupDisplayName[t],fields:[]};r=this.getSortableFieldsForRole(e,t,r,a);_.isEmpty(r)||(_.includes(this.uniqueRoles,e)||((a=this.allSortableFields).push.apply(a,r),this.uniqueRoles.push(e)),(a=o.fields).push.apply(a,r),i||_.includes(this.uniqueGroupKeys,o.key)||(this.groups.push(o),this.uniqueGroupKeys.push(o.key)))},n.prototype.visitReduction=function(){},n.prototype.enterComposite=function(){},n.prototype.exitComposite=function(){},n.RoleToSortGroupDisplayName=((e={}).Rows="Sort_Group_Small_multiples",e.Category="Sort_Group_Axis",e.Legend="Sort_Group_Legend",e),y=n})(powerbi=powerbi||{}),(function(b){b.visualCapabilitiesHelperModuleFactory=function(){var a=b,e=a.data,t=(r=a.explore).contracts,r=r.util,i=jsCommon.ArrayExtensions,n=a.DataViewMapping,o=a.DataViewAnalysis,c=r.DrillUtils,f=jsCommon.MathExtensions,s=e.SQExpr,l=e.SQExprConverter,y=t.VisualQuery,v=a.ValueType;function p(e){return e&&e.geography&&(e.geography.latitude||e.geography.longitude)}function u(e){return _.some(e.preferredTypes,(function(e){return p(e)||e.numeric}))}function d(e){return 0===e.cartesianKind||1===e.cartesianKind}g.prototype.findCompatibleRole=function(e){e.queryProjections,e.schema,e.expr,e.targetRole,e.roleToExprMap;var t=e.expr,r=e.roleToExprMap,i=e.targetRole,a=e.preferDrillableRoles;if(s.isHierarchyLevel(t)){var a=!0,o=this.getExistingTargetRoleForHierarchyLevelIfAny(t,r);if(o){if(i&&i!==o.name)return;i=o.name}}var o=l.asFieldPattern(t,e.schema),o=(o&&(n=o.column||o.columnAggr||o.groupingColumn||o.groupingColumnAggr||o.measure),{projections:e.queryProjections,metadata:t.getMetadata(e.schema),columnName:n?n.name:void 0,preferDrillableRoles:a,targetRole:i,isFieldParameter:e.isFieldParameter,useStrict:e.useStrict,sourceRole:e.sourceRole}),n=this.findRole(o);return n||(o.preferDrillableRoles=!e.preferDrillableRoles,n=this.findRole(o)),n&&r&&r.add(t,n),n},g.prototype.findRole=function(e){var t=this.roleMappings;if(!_.isEmpty(t))for(var r=t[0].getValueType(e.metadata?e.metadata.type:void 0,e.columnName),i=this.roles.allRolesWithPreference(r?r.extendedType:void 0,e.projections,e.preferDrillableRoles,e.useStrict,e.sourceRole),a=0,o=e.targetRole?[e.targetRole]:i;a<o.length;a++)for(var n=o[a],s=0,l=t;s<l.length;s++){var p=l[s].checkRoleCompatibility(e,n,i);if(p)return p}},g.prototype.getExistingTargetRoleForHierarchyLevelIfAny=function(e,t){return t.get(e)},g.prototype.orderByRolePreferences=function(e,t){for(var r=this.roles.defns,i=0,a=t.length,o=0,n=r.length;o<n;o++){var s=r[o].preferredTypes;if(!_.isEmpty(s))for(var l=i;l<a;l++){var p=t[l],u=p.expr.getMetadata(e);if(u){var c=u.type;if(c)for(var d=0,m=s.length;d<m;d++)if(c.extendedType===v.fromDescriptor(s[d]).extendedType){t.splice(l,1),t.splice(i,0,p),i++;break}}}}},g.prototype.getNumberRangesForRoles=function(e){for(var t=_.map(this.roles.defns,(function(e){return e.name})),r=e instanceof y?e.projections:e,i={},a=0,o=t;a<o.length;a++)i[c=o[a]]={min:1/0,max:0};for(var n=0,s=_.filter(this.roleMappings,(function(e){return e.projectionsAreCompatible({projections:r,roleNames:t,preferDrillableRoles:!0,ignoreMin:!0})}));n<s.length;n++)for(var l=s[n].getCondition(),p=0,u=t;p<u.length;p++){var c=u[p],d=l&&l[c],m=void 0,m=d?{min:f.max(d.min,0),max:f.min(d.max,1/0)}:{min:0,max:1/0};(v=i[c]).min=Math.min(m.min,v.min),v.max=Math.max(m.max,v.max)}for(var v,g=0,h=_.values(i);g<h.length;g++)(v=h[g]).min=Math.min(v.min,v.max);return i},g.prototype.getNonLatLongRoles=function(){var e=this.getLatLongRoleNames();return this.getFilteredRoleNames(e)},g.prototype.getFilteredRoleNames=function(e){for(var t=this.capabilities.dataViewMappings,r=[],i=0,a=t;i<a.length;i++){var o=a[i];o.categorical&&n.visitCategoricalCategories(o.categorical.categories,{visitRole:function(e){r.push(e)}}),o.matrix&&n.visitMatrixRows(o.matrix.rows,{visitRole:function(e){r.push(e)}})}return _.without.apply(_,__spreadArray([_.uniq(r)],e||[]))},g.prototype.getLatLongRoleNames=function(){return this.getRoleNames(u)},g.prototype.getCartesianGroupingOrMeasureRoleNames=function(){return this.getRoleNames(d)},g.prototype.getRoleNames=function(e){return _.chain(this.capabilities.dataRoles).filter(e).map((function(e){return e.name})).value()},g.prototype.hasPreferredTypes=function(){return _.some(this.capabilities.dataRoles,(function(e){return!_.isEmpty(e.preferredTypes)}))},g.prototype.validateDuplicateColumnsInRole=function(e,t,r,i){if(!e.noDuplicates)return!0;var a,e=e.name,o=r.projections;return!o||!o[e]||!(i?(i=o[e].getFieldParameters(),i=_.map(i,(function(e){return e.expr})),_.some(i,(function(e){return s.equals(t,e)}))):(i=o[e].all(),o=_.map(i,(function(e){return e.queryRef})),a=r&&r.defn&&r.defn.select(),e=_.map(o,(function(e){return a.withName(e).expr})),_.some(e,(function(e){return s.equals(t,e)}))))};var m=g;function g(e,t,r,i){this.capabilities=e,this.roles=t,this.objectDescs=r,this.roleMappings=i}C.prototype.getCondition=function(){return this.condition},C.prototype.checkRoleCompatibility=function(e,t,r){var i;if(e.projections,e.metadata,e.metadata)return i=this.roles.withName(t),i&&(e.isFieldParameter||this.exprIsCompatible(i,e.metadata,o.getPropertyCount(t,e.projections)+1,e.preferDrillableRoles)&&this.projectionsAreCompatible({projections:e.projections,roleNames:_.without(r,t),preferDrillableRoles:e.preferDrillableRoles,ignoreMin:!1}))?i:void 0},C.prototype.getValueType=function(e,t){return e=e&&null==e.categoryString&&null!=(t=t&&this.geoTaggingService.getFieldType(t))?v.fromPrimitiveTypeAndCategory(e.primitiveType,t):e},C.prototype.projectionsAreCompatible=function(e){e.projections,e.roleNames;for(var t=0,r=e.roleNames;t<r.length;t++){var i=r[t],a=this.roles.withName(i);if(!a)return!1;i=o.getPropertyCount(i,e.projections);if(!this.isCardinalityValid({count:i,roleName:a.name,preferDrillableRoles:e.preferDrillableRoles,ignoreMin:e.ignoreMin}))return!1}return!0},C.prototype.exprIsCompatible=function(e,t,r,i){if(!this.isCardinalityValid({count:r,roleName:e.name,preferDrillableRoles:i,ignoreMin:!1}))return!1;var r=e.kind;if(1===t.kind){if(r===a.VisualDataRoleKind.Grouping)return!1}else if(r===a.VisualDataRoleKind.Measure)return!1;var i=e.requiredTypes;return!(i&&!v.isCompatibleTo(t.type,i))&&!(null!=(i=null==(r=t.type)?void 0:r.misc)&&i.sparkline&&!e.supportsSparklines)},C.prototype.isRoleDrillable=function(e){return _.includes(this.drillableRoles,e)&&(!this.condition[e]||void 0===this.condition[e].max||1===this.condition[e].max)},C.prototype.isCardinalityValid=function(e){var t;return!!(!this.condition||e.preferDrillableRoles&&this.isRoleDrillable(e.roleName))||(!(t=this.condition[e.roleName])||null==o.validateRange(e.count,t,e.ignoreMin))};var h=C;function C(e,t,r,i){this.roles=e,this.geoTaggingService=t,this.condition=i,this.drillableRoles=r}S.prototype.withName=function(e){return i.findItemWithName(this.defns,e)},S.prototype.allRolesWithPreference=function(t,r,i,e,a){var o=this,n=_.map(this.defns,(function(e){return e.name}));return a?this.promoteAndPenalize(n,(function(e){return o.getRoleWeight(a,e)})):this.promoteAndPenalize(n,(function(e){return o.getTypeWeightForRole(t,e.preferredTypes)}),e),this.promoteAndPenalize(n,(function(e){return o.getProjectionWeightForRole(e,r,i)})),n},S.prototype.promoteAndPenalize=function(e,t,r){for(var i=0,a=0,o=this.defns;a<o.length;a++){var n=o[a],s=t(n);null!=s&&(n=e.splice(e.indexOf(n.name),1)[0],s!==S.penalize||r?s===S.promote&&e.splice(i++,0,n):e.push(n))}},S.prototype.getRoleWeight=function(e,t){return e.kind===t.kind||this.hasCommonTypes(e.requiredTypes,t.requiredTypes)||this.hasCommonTypes(e.requiredTypes,t.preferredTypes)||this.hasCommonTypes(e.preferredTypes,t.requiredTypes)||this.hasCommonTypes(e.preferredTypes,t.preferredTypes)?S.promote:S.penalize},S.prototype.hasCommonTypes=function(e,t){return!_.isEmpty(e)&&!_.isEmpty(t)&&!_.isEmpty(_.intersectionWith(e,t,_.isEqual))},S.prototype.getTypeWeightForRole=function(e,t){if(t){for(var r=S.penalize,i=0,a=t;i<a.length;i++){var o=a[i];if(e===v.fromDescriptor(o).extendedType){r=S.promote;break}}return r}},S.prototype.getProjectionWeightForRole=function(e,t,r){t=t[e.name];return!r&&t&&e.kind!==b.VisualDataRoleKind.Measure||r&&e.kind===b.VisualDataRoleKind.Measure?S.penalize:void 0},S.penalize=-1,S.promote=1;var x=S;function S(e){this.defns=e}return{create:function(e,t){if(e&&!_.isEmpty(e.dataRoles)){for(var r=e.dataViewMappings,i=new x(e.dataRoles),a=[],o=0,n=r;o<n.length;o++){var s=n[o].conditions;if(_.isEmpty(s))a.push(new h(i,t,c.getDrillableRoles(e)));else for(var l=0,p=s;l<p.length;l++){var u=p[l];a.push(new h(i,t,c.getDrillableRoles(e),u))}}return new m(e,i,e.objects,a)}},dataRoleWrapper:function(e){return new x(e)},isValueTypeDescriptorLatLong:p,isRoleCompatibleWithLatLong:u,isRoleCompatibleWithScatterXY:d}}})(powerbi=powerbi||{}),(function(n){var e,r,i,o,a,s,l,p;function t(e,t,r){this.index=e,this.restartToken=t,r&&(this.hierarchyLastNodeIndex=r)}function u(e,t,r,i,a){this.hasExecutedQuery=!0,this.dataProxy=e,this.promiseFactory=r,this.filterGenerator=t,this.dataSegments=[],this.telemetryV2Enabled=a,this.visualPluginService=i}function c(e){e=contextActivity.getAncestorActivityPropertiesOfEvent((function(e){return"Open Report"===e.name}),e);return e&&e.includesBootstrap}e=(e=n.explore||(n.explore={})).services||(e.services={}),r=jsCommon.PerfTimer,i=n.visuals.plugins,o=n.data.segmentation.DataViewMerger,a=n.data.WindowExpansionState,s=n.data.WindowExpansionStateBuilder,t.prototype.endsBeforeNode=function(e){this.hierarchyLastNodeIndex;for(var t=this.hierarchyLastNodeIndex,r=Math.min(t.length,e.length),i=0;i<r;i++){var a=t[i],o=e[i];if(a<o)return!0;if(o<a)return!1}return e.length>t.length},l=t,e.DataSegment=l,e.createExploreVisualDataProxyService=function(e,t,r,i,a){return new p(e,t,r,i,a=void 0===a?!1:a)},u.prototype.generateQuery=function(e){var t=r.start("visualQueryGenerator("+e.config.visualType+")"),e=e.visualQueryGenerator.execute({config:e.config,dataSources:e.dataSources,schema:e.schema,additionalFilters:e.hostServices.getFilters(this.filterGenerator,e.schema),restartToken:this.getRestartToken(e),cacheResponseOnServer:!(!e.isInitialLoad&&!e.cacheResponseOnServer),allowResultFromClientCache:e.allowResultFromClientCache,dataWindow:e.viewport,cacheOptions:e.cacheOptions,clientCacheOnly:e.clientCacheOnly,dataSourceVariables:e.hostServices.getDataSourceVariables(),performanceActivity:e.performanceActivity,executionMetricsKind:e.executionMetricsKind,telemetryV2Enabled:this.telemetryV2Enabled,requestPriority:e.requestPriority,applicationContext:e.applicationContext,windowExpansion:this.getWindowExpansion(e),disableAnchorTime:!!e.hostServices.disableAnchorTime||e.config.visualType===i.qnaVisual.name,drillableRoles:e.drillableRoles,useNativeReferenceNameAsDisplayNames:e.useNativeReferenceNameAsDisplayNames});return t(),e},u.prototype.getSegmentRestartToken=function(e){if(!(e<=0))return this.dataSegments.length,this.dataSegments[e-1].restartToken},u.prototype.runQuery=function(t){var r=this,e=(t.config,1===t.executionType&&t.preferCurrentData,this.promiseFactory.defer(this.telemetryV2Enabled)),i=_.last(this.dataSegments),i=i&&i.restartToken;if(1!==t.executionType||i){var a=t.generatedQuery||this.generateQuery(t);if(a)if(t.additionalDataViewKinds&&(a.options.kinds|=t.additionalDataViewKinds),a.error)e.reject(a.error),this.generatedQuery=void 0;else{if(!(this.generatedQuery&&this.hasExecutedQuery&&t.preferCurrentData&&n.data.areEquivalentOptions(a.options,this.generatedQuery.options))){if(a=this.ensureRestartToken(t,a),this.shouldDelayExecution(t,a))return this.resolveEmptyResult(a,e),n.createRejectablePromise2(e);t.performanceActivity&&(a.options.isColdLoad=c(t.performanceActivity),(i=t.performanceActivity.getProperty("parent"))&&"Visual Container Lifecycle"===i.name&&(i.lifecycleFlags|=4096));var o=this.dataProxy.execute(a.options);return o.then((function(e){return r.handleQueryResult(e,a,o,t.config.query)}),(function(e){throw r.generatedQuery=void 0,e}))}this.generatedQuery=a,e.resolve(null)}else this.generatedQuery=void 0,e.reject()}else e.reject();return n.createRejectablePromise2(e)},u.prototype.cancelQuery=function(e){this.dataProxy.cancelQuery(e)},u.prototype.ensureRestartToken=function(e,t){return 1!==e.executionType&&(this.dataSegments=[],e.preferCurrentData&&(t=this.generateQuery(e),e.additionalDataViewKinds&&(t.options.kinds|=e.additionalDataViewKinds))),t},u.prototype.getRestartToken=function(e){var t=this.dataSegments.length-1;return e.preferCurrentData?this.getSegmentRestartToken(t):1===e.executionType?this.getSegmentRestartToken(1+t):void 0},u.prototype.getWindowExpansion=function(e){if(e.config&&e.config.query&&e.config.query.expansionStates){var t=e.config.visualType,t=this.visualPluginService.capabilities(t);if(_.some(t.dataViewMappings,(function(e){return e&&e.matrix&&e.matrix.rows&&e.matrix.rows.dataReductionAlgorithm&&e.matrix.rows.dataReductionAlgorithm.topNPerLevel})))return t=this.windowExpansionState,3===e.executionType&&(e.windowExpansionState,t=e.windowExpansionState),e.windowExpansionTransform?e.windowExpansionTransform(t):(_.size(e.config.query.expansionStates),a.mergeWithExpansionState(_.first(e.config.query.expansionStates),t,e.config.query.defn.select(),e.schema));e.executionType}},u.prototype.shouldDelayExecution=function(e,t){return!t.options.query.command||t.deferred&&1!==e.executionType&&2!==e.executionType},u.prototype.resolveEmptyResult=function(e,t){this.generatedQuery=e,this.hasExecutedQuery=!1,t.resolve({dataReaderResult:{dataView:{metadata:{columns:[]}}}})},u.prototype.handleQueryResult=function(e,t,r,i){return this.hasExecutedQuery=!0,this.generatedQuery=t,r.matchesLastExecuteQuery&&(e=this.rewriteQueryResultWithoutPerformanceActivities(e)),this.addNewDataSegment(e&&e.dataReaderResult),this.addWindowExpansionState(t,i,e&&e.dataReaderResult),e},u.prototype.addWindowExpansionState=function(e,t,r){1===_.size(e.compiledMappings)&&e.compiledMappings[0].matrix&&e.compiledMappings[0].matrix.rows&&e.compiledMappings[0].matrix.rows.dataReductionAlgorithm&&e.compiledMappings[0].matrix.rows.dataReductionAlgorithm.topNPerLevel?(_.size(t.expansionStates),this.windowExpansionState=s.fromDataview(r.dataView)):this.windowExpansionState=null},u.prototype.addNewDataSegment=function(e){var t,r,i=e&&e.restartToken,e=e&&e.dataView,e=e&&e.matrix&&e.matrix.rows&&e.matrix.rows.root,a=this.dataSegments.length,e=_.isEmpty(e&&e.children)?new l(a,i):(r=void 0,r=(t=_.last(this.dataSegments))?(t.hierarchyLastNodeIndex,_.clone(t.hierarchyLastNodeIndex)):[],o.updateTreeLastNodeIndex(e,r),t&&t.endsBeforeNode(r),new l(a,i,r));this.dataSegments.push(e)},u.prototype.rewriteQueryResultWithoutPerformanceActivities=function(e){var t;return e&&e.dataReaderResult&&e.dataReaderResult.performanceActivities?(delete(t=__assign({},e.dataReaderResult)).performanceActivities,__assign(__assign({},e),{dataReaderResult:t})):e},u.prototype.canLoadMore=function(){var e=_.last(this.dataSegments);return null!=e&&null!=e.restartToken},u.prototype.lastExecutedQuery=function(){return this.generatedQuery},u.prototype.getNodeSegment=function(t){return _.some(this.dataSegments,(function(e){return _.isEmpty(e.hierarchyLastNodeIndex)})),_.find(this.dataSegments,(function(e){return!e.endsBeforeNode(t)}))},u.prototype.discardSegmentsFrom=function(e){this.dataSegments.length,this.dataSegments.length=e},u.prototype.getLastNodeIndex=function(){if(!_.isEmpty(this.dataSegments))return _.last(this.dataSegments).hierarchyLastNodeIndex},u.prototype.getSecondToLastNodeIndex=function(){if(this.dataSegments&&!(this.dataSegments.length<2))return __spreadArray([],this.dataSegments[this.dataSegments.length-2].hierarchyLastNodeIndex)},p=u,e.isColdLoad=c})(powerbi=powerbi||{}),(function(M){var B,e,n,Y,i,v,U,x,S,c,g,T,h,d,F,f,y,j,r,R,m,D,l,Z,C,b,t,$,a,A,I,z,O,k,L,q,te,E,N,ee,G,Q,H;function V(e,t,r,i,a,o,n,s,l,p,u,c,d,m){this.dataReaders=e,this.displayNames=t,this.visualPluginService=r,this.pluginOps=i,this.sortService=a,this.filterGenerator=o,this.aggrOps=n,this.featureSwitchService=s,this.transformPluginService=l,this.telemetryService=p,this.visualTimeSynchronizationService=u,this.visualQueryCapabilitiesService=c,this.cachePolicyProviderService=d,this.localizationService=m}function o(e,t,r){var i=k.call(this)||this;return i.schema=e,i.compiledMappings=t,i.query=r,i.pointsPerSparkline=52,i}function s(e,t,r,i){var a=q.call(this)||this;return a.query=e,a.queryRewrites=t,a.objects=r,a.context=i,a}function re(e){return{index:e.index}}function ie(e,t){var r;!t||e[r=t.index]||(e[r]={displayName:"",queryName:t.queryName,expr:t.expr})}function W(e,t){return{code:t,getDetails:function(){return{displayableErrorInfo:[],message:e}}}}function P(e,t){return{visual:{objects:e.objects,descriptors:t.objects},visualContainer:{objects:e.vcObjects,descriptors:B.contracts.VisualContainer.CommonObjectDescriptors}}}function X(e,t,r,i){var a,o,n,s,l,p=[];switch(e.name){case M.visuals.plugins.map.name:case M.visuals.plugins.azureMap.name:a=(function(e){var t=_.some(e,(function(e){return"Category"===e.roleName&&e.code===c.conditionRangeTooLarge})),r=_.some(e,(function(e){return"X"===e.roleName&&e.code===c.conditionKindExpectedGrouping})),e=_.some(e,(function(e){return"Y"===e.roleName&&e.code===c.conditionKindExpectedGrouping}));{if(t)return"DataViewMappingError_LocationAndLatLongGroup";if(r||e)return"DataViewMappingError_LatLongAggregateWithNoLocation"}})(t);break;case M.visuals.plugins.scatterChart.name:o=t,n=i,s=_.some(o,(function(e){return e.roleName===M.visuals.scatterRoleNames.category&&e.code===c.conditionRangeTooLarge})),l=_.some(o,(function(e){return e.roleName===M.visuals.scatterRoleNames.play&&e.code===c.conditionRangeTooLarge})),o=_.some(o,(function(e){return e.roleName===M.visuals.scatterRoleNames.x&&(e.code===c.conditionKindExpectedGrouping||e.code===c.conditionKindExpectedMeasure)})),a=s?n.featureSwitches.useModernFormatPane?"DataViewMappingError_ScatterGroupingValues":"DataViewMappingError_ScatterGroupingDetails":l?"DataViewMappingError_ScatterGroupingPlayAxis":o?"DataViewMappingError_ScatterXMismatchType":void 0}if(!a&&!_.isEmpty(t)){var u=t[0];switch(u.code){case c.conditionRangeTooLarge:a="DataViewMappingError_ConditionRangeTooLarge";break;case c.conditionRangeTooSmall:a="DataViewMappingError_ConditionRangeTooSmall";break;case c.conditionKindExpectedMeasure:a="DataViewMappingError_ConditionKindExpectedMeasure";break;case c.conditionKindExpectedGrouping:a="DataViewMappingError_ConditionKindExpectedGrouping";break;case c.conditionNotHierarchicallyRelated:return new ee(a="DataViewMappingError_ConditionNotHierarchicallyRelated",r);case c.conditionSchemaCapabilities_TupleFilters_InstanceFilters:a="DataViewMappingError_ConditionSchemaCapabilities_TupleFilters";break;case c.conditionKindExpectedGroupingOrMeasure:break;default:u.code}p=[u.roleName]}if(a)return W(r.format(a,p),a)}function w(e,t,r){this.localizationService=t,this.messageId="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo=[{errorInfoKey:"",errorInfoValue:""}],this.errorCode=e,this.hideErrorHelperText=!1,"Missing_References"===e?(this.displayableErrorInfo[0].errorInfoKey="Missing_References_Details_Title",this.displayableErrorInfo[0].errorInfoValue=r,this.detailsMessageFormat="Missing_References_Details_Message",this.messageId="Missing_References_Message",this.errorSource="User"):"Broken_Filters"===e?(this.displayableErrorInfo[0].errorInfoKey="ServiceError_CannotLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("Broken_Filters_Details_Message"),this.messageId="Broken_Filters_Message"):"ClientError_NoSupportedDataViewMappingFound"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualDisplayError_Title",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("ClientError_NoSupportedDataViewMappingFound_Message"),this.messageId="ClientError_NoSupportedDataViewMappingFound_Message"):"NoSupportRTS_PublishToWeb"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualContainer_UnableToFindVisualKey",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("NoSupportRTS_PublishToWeb_Message"),this.messageId="NoSupportRTS_PublishToWeb_Title",this.errorSource="User",this.hideErrorHelperText=!0):"DQP_No_MappedColumns_In_HierarchySlicers"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("DQP_No_MappedColumns_In_HierarchySlicers"),this.errorSource="User",this.hideErrorHelperText=!0,this.hideDebugInfo=!0,this.helperLink="https://go.microsoft.com/fwlink/?linkid=2139315"):"DataViewMappingError_ConditionNotHierarchicallyRelated"===e&&(this.messageId="DataViewMappingError_ConditionNotHierarchicallyRelated",this.displayableErrorInfo[0].errorInfoKey="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("DataViewMappingError_ConditionNotHierarchicallyRelated_Details"),this.errorSource="User",this.hideErrorHelperText=!0,this.hideDebugInfo=!0,this.helperLink="https://go.microsoft.com/fwlink/?linkid=2114278")}function K(e,t,r,i){this.displayNameService=r,this.incompatibleExprInfo=[];for(var a=0,o=e.select();a<o.length;a++){var n=o[a],s=b.asFieldPattern(n.expr);s&&s.percentOfGrandTotal&&this.incompatibleExprInfo.push({basePropertyName:d.getPropertyName(s),fieldDisplayName:this.displayNameService.getQualifiedDisplayName(n.expr,t,i)})}this.warnings=[]}function p(e){this.errorInfos=e}function u(e){this.highlightDisableType=e}B=M.explore||(M.explore={}),e=B.services||(B.services={}),n=M.data.CacheOptions,Y=jsCommon.ArrayExtensions,i=M.ClientErrorStrings,v=M.data.CompiledDataViewMapping,U=M.data.DataBoundObjectQueryExtender,x=M.data.DataReaderUtils,S=M.explore.contracts.DataSource,c=M.DataViewAnalysis.DataViewMappingMatchErrorCode,g=M.data.DataViewObjectDefinitions,T=M.data.DataViewObjectDescriptors,h=M.data.services.DataViewObjectSerializer,d=M.data.FieldExprPattern,F=M.data.FilterKindDetector,f=M.data.DataViewObjectDefinitions.isObjectPropertySQExpr,y=M.data.DataViewObjectDefinitions.isObjectPropertySQExprWithContext,j=M.data.PrimitiveValueEncoding,r=M.data.RelativeDateFilterPattern,R=M.data.ScalarKeyUtils,m=M.data.Selector,D=M.data.SemanticFilter,l=M.data.SemanticQuery,Z=M.data.SQExpr,C=M.data.SQExprBuilder,b=M.data.SQExprConverter,t=M.data.SQExprRewriter,$=M.data.SQExprUtils,a=jsCommon.StringExtensions,A=B.util.VisualContainerUtils,I=M.data.WindowExpansionState,e.createVisualQueryGenerator=function(e){return e.dataReaders,e.displayNameService,e.plugin,e.pluginOps,e.sortService,e.aggrOps,e.filterGenerator,e.featureSwitchService,e.transformPluginService,e.telemetryService,e.visualTimeSynchronizationService,new O(e.dataReaders,e.displayNameService,e.plugin,e.pluginOps,e.sortService,e.filterGenerator,e.aggrOps,e.featureSwitchService,e.transformPluginService,e.telemetryService,e.visualTimeSynchronizationService,e.visualQueryCapabilitiesService,e.cachePolicyProviderService,e.localizationService)},V.prototype.shouldExecute=function(e,t){if(!e||_.isEmpty(t)||B.contracts.VisualContainer.isHidden(e))return!1;var r=e.visualType,i=this.visualPluginService.capabilities(r);return!(!i||this.pluginOps.isQueryDisabled(r,i))&&(!!this.getQueryGenerator(t,e)&&(null==e.query?((e=[(t=P(e,i)).visual]).push(t.visualContainer),!_.isEmpty(e)&&U.needsToExtend(l.create(),e)):this.pluginOps.isQueryVisual(r)&&!this.pluginOps.isAnalysisVisual(r)))},V.prototype.execute=function(e){e.performanceActivity&&e.performanceActivity.isRunning()&&(t=e.performanceActivity.createChildActivity({name:"Query Generation"}));var t,r=e.config,i=e.dataSources;if(!_.isEmpty(i)){var a=x.findTypes(i,r.query&&r.query.defn);if(!_.isEmpty(a)){var o=this.getAnchorTimeQueryOptions(e.cacheOptions,!e.disableAnchorTime,e.additionalFilters,e.config),n=o.anchorTime,s=o.cacheOptions,o=o.relativeTimeError;if(o)return{options:null,error:o};var o=this.dataReaders.queryGenerator(a),l=this.getCompileMappingsResult(r,r&&r.visualType,e.schema,o,e.additionalFilters,e.dataViewMappingsOverride,e.performanceActivity),i=this.dataReaders.queryExtensionLookup(i);if(l){if(l.error)return{options:null,error:l.error};var p=l.compiled;if(p){if(p.query&&p.query.defn&&!_.isEmpty(p.query.defn.select())&&!_.isEmpty(p.query.defn.transforms()))for(var u={},c=0,d=p.query.defn.select();c<d.length;c++){var m=d[c];Z.isTransformOutputRoleRef(m.expr)||(u[m.name]=m)}var v,g=this.getVisualCapabilities(e.config.visualType),h=V.compileFilters(e.additionalFilters,g),i=this.generateQuery(o,e.schema,p,g.dataRoles,r.queryOptions&&r.queryOptions.keepProjectionOrder,g.filterMappings,h.dataFilter,h.highlightFilter,e.restartToken,e.dataWindow,e.dataSourceVariables,null,i,e.executionMetricsKind,g.noDefaultProjections,this.getWindowExpansionState(r,e.windowExpansion,e.schema),n),n=i.result,f=i.query,y=i.resolvedQuery,C=e.additionalFilters?e.additionalFilters.queryRefsForSingleItemDrillFilters:void 0,a=this.dataReaders.readerType(a);if(a)return v=S.queried(e.dataSources,y),x.uniqueReaderTypes(v).length,(a={type:a,query:{dataSources:S.dataReaderDataSources(v),command:n.command,cacheOptions:s,clientCacheOnly:e.clientCacheOnly,cacheResponseOnServer:e.cacheResponseOnServer,allowResultFromClientCache:e.allowResultFromClientCache,allowClientSideFilters:this.getAllowClientSideFiltersOrDefault(e,g),ignoreViewportForCache:e.ignoreViewportForCache,performanceActivity:e.performanceActivity,applicationContext:e.applicationContext},perfId:e.config.visualType}).kinds=this.pluginOps.targetedDataViewKinds(e.config.visualType,f),v=(function(d,m,k,M,e,B,U,v,g,t,r,i,h,a,o,z,f,n,y,L,q,G){var s=n?n.dataFilter:null,C={},x=$.buildExprEvaluationContext(e.defn.from());r&&(C.objects=r,h&&_.some(h,(function(e){return e.selectExprReplaced}))&&((r=new te(e.defn,h,r,x)).rewrite(),C.objects=r.rewrittenObjects));i&&(C.splits=i);_.isEmpty(e.expansionStates)||(C.expansionStates=e.expansionStates);var S,r={options:d,transforms:C,warnings:a,compiledMappings:o,deferred:y},i=(function(e,t){if(_.isEmpty(t))return{queryForTransformActions:e,internalToPublicSelectNameMappingsByRole:{}};for(var r=e.clone(),i=0,a=t;i<a.length;i++){var o,n,s=a[i];s.selectExprAdded?(o=r.defn.select(),n=s.selectExprAdded,o.length,n.selectIndex,o[n.selectIndex]=n.namedSQExpr,r.defn=r.defn.select(o)):s.projectionQueryRefChanged?(n=s.projectionQueryRefChanged,r.projections[n.role].replaceQueryRef(n.oldQueryRef,n.newInternalQueryRef)):s.aggregatesAdded||s.selectExprReplaced||JSON.stringify(s)}e=_.reduce(t,(function(e,t){var r,t=t.projectionQueryRefChanged;return t&&((r=e[t.role])||(e[t.role]=r={}),r[t.newInternalQueryRef]=t.oldQueryRef),e}),{});return{queryForTransformActions:r,internalToPublicSelectNameMappingsByRole:e}})(e,h),b=i.queryForTransformActions,E=i.internalToPublicSelectNameMappingsByRole,N=b.defn.select(),V=b.defn.orderBy(),l=b.projections;if(s){var a=s.where(),Q=$.buildExprEvaluationContext(s.from());if(_.some(a,(function(e){return e.condition&&!_.isEmpty(e.condition.validate(m,v,void 0,Q))})))return r.error=new ee("Broken_Filters",t),r}if(r.filterContext={dataFilters:n.dataFiltersUnmerged,highlightFilters:n.highlightFilter,highlightFiltersUnmerged:n.highlightFiltersUnmerged,query:B},l){var p,P=[],u={},c=void 0;for(p in l){var H=u[p]=[],w=l[p];_.isEmpty(w.activeProjectionRefs)||((c=c||{})[p]=_.map(w.activeProjectionRefs,(function(e){return{queryRef:e}})));for(var T=0,F=w.all();T<F.length;T++){var j=F[T],R=Y.indexWithName(N,j.queryRef);P.push({queryRef:j.queryRef,format:j.format,queryIndex:R,roleName:p,displayName:j.displayName}),H.push(R)}}C.selects=[];for(var D=[],o=b.defn.transforms(),W=!_.isEmpty(o),X=function(e,t){i=P,r=e;var r,i=_.chain(i).compact().filter((function(e){return e.queryIndex===r})).value(),a=N[e],e=f&&f[a.name];if(!W||e){e&&(a=e);e=$.buildExprEvaluationContext(b.defn.from());if(!_.isEmpty(a.expr.validate(m,v,void 0,e)))return D.push(a.expr),"continue";var e=a.expr.getMetadata(m,x),o={type:e.type,expr:a.expr},n=(!$.isMeasure(a.expr)&&(_.isEmpty(d.query.command)||y||g.keepAllMetadataColumns)&&(o.identityExprs=k.produceIdentities(a.expr,m)),$.getKpiMetadata(a.expr,m)),s=(n&&(o.kpi=n),G?(a.nativeReferenceName,o.displayName=a.nativeReferenceName):(n=(function(e,t){if(t)for(var r=0,i=t;r<i.length;r++){var a=i[r].projectionQueryRefChanged;if(a)if(a.newInternalQueryRef===e)return a.oldQueryRef}return e})(a.name,h),s=_.find(i,(function(e){return e.queryRef===a.name&&e.displayName})),o.displayName=s?s.displayName:U.getDisplayName(a.expr,m,g,n,M)),i[0]);!s||(n=s.format||e.format)&&(o.format=n)}else o={expr:a.expr,displayName:a.name};o.roles||(o.roles={});for(var l=0,p=i;l<p.length;l++){var u=p[l];u&&u.roleName&&(o.roles[u.roleName]=!0)}S=a.name,o.queryName=_.chain(Object.keys(o.roles)).map((function(e){return E[e]&&E[e][S]})).filter(_.isString).value()[0]||S;var c,s=_.find(L,(function(e){return e.queryName===o.queryName})),n=(_.isEmpty(null==s?void 0:s.relatedProjectionsQueryName)||(o.relatedSelects=_.map(s.relatedProjectionsQueryName,(function(e){return{queryName:e}}))),e=V,c=a.expr,_.findIndex(e,(function(e){return Z.equals(e.expr,c)}))),s=(-1!==n&&(i=V[n],o.sort=i.direction,o.sortOrder=n),$.getDefaultValue(a.expr,m));s&&(o.defaultValue={value:s},e=a.expr.getKeyColumns(m),o.defaultValue.identityFieldsValues=$.getDefaultValues(e,m));1===$.getAggregateBehavior(a.expr,m)&&(o.discourageAggregationAcrossGroups=!0);i=$.getParameterMetadata(a.expr,m);i&&(o.parameter=i),C.selects.push(o)},A=0,K=N.length;A<K;A++)X(A);if(h)for(var I=0,O=h;I<O.length;I++){var J=O[I];J.aggregatesAdded&&!(function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a.queryName===t.originalQueryRef){var o={},n=t.aggregates;n.min&&(o.min=re(n.min)),n.max&&(o.max=re(n.max)),a.aggregateSources=o;break}}var s=t.aggregates;ie(e,s.min),ie(e,s.max)})(C.selects,J.aggregatesAdded)}C.roles={ordering:u,drillableRoles:q},c&&(C.roles.activeItems=c,(function(e,t){var e=e&&e.roles,r=e&&e.activeItems;if(r)for(var i in r)for(var i=r[i],a=0,o=i;a<o.length;a++){var n=o[a];n.suppressConcat=_.includes(t,n.queryRef)}})(C,z)),r.error=ee.create(D,m,t)}return r})(a,e.schema,o,r.columnProperties,f,y,this.displayNames,this.aggrOps,g,this.localizationService,p.objectDefinitions,n.splits,n.queryRewrites,l.warnings,p.mappings,C,u,h,i.deferred,p.additionalProjections,e.drillableRoles,e.useNativeReferenceNameAsDisplayNames),t&&t.resolve(),v.options.query&&(v.options.query.telemetryV2Enabled=e.telemetryV2Enabled,null!=e.requestPriority&&(v.options.query.requestPriority=e.requestPriority)),v}}}}},V.prototype.getCompiledDataViewMapping=function(e){var t=e.config,r=this.getQueryGenerator(e.dataSources,t);if(r){t=this.getCompileMappingsResult(t,t&&t.visualType,e.schema,r);if(t&&!t.error)return t.compiled.mappings}},V.prototype.getAnchorTimeQueryOptions=function(e,t,r,i){var a,o=!(null==(o=this.visualQueryCapabilitiesService)||!o.getCapabilities().disableAnchorTime),t=t&&this.hasRelativeTimeFilters(r,i),r=e;return o&&t?{anchorTime:null,cacheOptions:r,relativeTimeError:new ee("NoSupportRTS_PublishToWeb",this.localizationService)}:(t&&(r=this.cachePolicyProviderService?this.cachePolicyProviderService.getRelativeTimeFilterQueryPolicy():n.AllowQuery,i=this.visualTimeSynchronizationService.getAnchorTime(),a=j.toTypeEncoded(i,M.ValueType.fromExtendedType(519))),{anchorTime:a,cacheOptions:r,relativeTimeError:null})},V.prototype.hasRelativeTimeFilters=function(e,t){return!(!e||!r.hasRelativeTimeFilter(e.dataFilter))||!!t&&!!t.query&&!!t.query.defn&&r.hasRelativeTimeFilter(t.query.defn)},V.prototype.executeForFlattenedQuery=function(e,t){var r=e.config,i=this.getQueryGenerator(e.dataSources,r);if(i){var a=this.getCompileMappingsResult(r,r&&r.visualType,e.schema,i,e.additionalFilters,e.dataViewMappingsOverride,e.performanceActivity);if(a&&!a.error){var o,n,a=a.compiled;if(a)return o=this.getVisualCapabilities(e.config.visualType),n=V.compileFilters(e.additionalFilters,o),this.generateFlattenedQuery(i,e.schema,a,o.dataRoles,r.queryOptions&&r.queryOptions.keepProjectionOrder,o.filterMappings,n.dataFilter,n.highlightFilter,e.restartToken,e.dataWindow,e.dataSourceVariables,t,o.noDefaultProjections,e.windowExpansion)}}},V.prototype.getQueryGenerator=function(e,t){if(!_.isEmpty(e)){t=t.query,e=x.findTypes(e,t&&t.defn);if(e)return this.dataReaders.queryGenerator(e)}},V.prototype.getVisualCapabilities=function(e){if(e)return e=this.visualPluginService.getPlugin(e),e&&e.capabilities},V.prototype.getCompileMappingsResult=function(e,t,r,i,a,o,n){if(e&&t&&r){var s=this.visualPluginService.getPlugin(t);if(s){var l=this.getVisualCapabilities(t),o=o||l.dataViewMappings,p=e.query,u=l.sorting?l.sorting.implicit:null,c=p?A.createRoleKindByQueryRef(p):{};if(o&&p){var d=M.DataViewAnalysis.chooseDataViewMappings(p.projections,o,c,this.featureSwitchService.featureSwitches,l.objects,e.objects,p.defn.select(),r);if(!d.supportedMappings){var m=X(s,d.mappingErrors,this.localizationService,this.featureSwitchService);if(m)return{error:m,compiled:null};var v,g=M.data.QueryProjectionsByRole.clone(p.projections);for(v in g){var h=g[v];h.activeProjectionRefs=_.map(h.activeProjectionRefs,(function(e){return"select"+M.obfuscate(e)}));for(var f=0,y=h.all();f<y.length;f++)y[f]?h.assignProjection({queryRef:"select"+M.obfuscate(y[f].queryRef)},f):h.assignProjection(null,f)}m=new ee("ClientError_NoSupportedDataViewMappingFound",this.localizationService);return m.addDebugInfo("VisualType",t),m.addDebugInfo("QueryProjectionsByRole",JSON.stringify(g)),this.telemetryService.logEvent(M.telemetry.EXVisualQueryGeneratorError,{code:t,debugInfo:JSON.stringify(m.getDetails(this.localizationService).debugErrorInfo)}),{error:m,compiled:null}}m=this.compileMappingsWithProperties(t,r,p,d.supportedMappings,c,l.dataRoles,l,e.queryOptions,e.columnProperties,P(e,l),a,s.customizeQuery,u,i)}else t=P(e,l),m=this.compileNoMappingsWithProperties(r,p,c,o,l.dataRoles,t,a);d=[];if(m){if(m.error)return{error:m.error,compiled:null};d.push.apply(d,E.validateAndAdjustRolesIfNecessary(m.mappings,m.query,r,this.displayNames,l)||[]),d.push.apply(d,N.validateAndAdjustHighlightIfNecessary(a)||[]),m.warnings&&d.push.apply(d,m.warnings||[]);for(var C=this.telemetryService.getOpenActivityById(n&&n.getProperty("telemetryActivityId")),x=0,S=d;x<S.length;x++){var b=S[x];this.telemetryService.logChildEvent(C&&C.event,M.telemetry.EXVisualQueryGeneratorWarning,{code:b.code})}}return{compiled:m,warnings:d}}}},V.compileFilters=function(e,t){var r,i,a,o;return e&&(i=e.dataFilter,a=e.dataFiltersUnmerged,r=e.highlightFilter,o=e.highlightFiltersUnmerged),r&&t.supportsHighlight,{dataFilter:i,dataFiltersUnmerged:a,highlightFilter:r,highlightFiltersUnmerged:o}},V.prototype.getAllowClientSideFiltersOrDefault=function(e,t){return _.isBoolean(e.allowClientSideFilters)?e.allowClientSideFilters:!!T.findSelfFilter(t.objects)},V.prototype.compileMappingsWithProperties=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m){r=B.TransformGeneratorUtils.addTransforms(p.visual.objects,i,r,this.transformPluginService,n);n=M.data.compileDataView({mappings:i,queryDefn:r.defn,queryProjections:r.projections,schema:t,objectDescriptors:p.visual.descriptors,objectDefinitions:p.visual.objects,roles:o,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:this.transformPluginService});if(this.hasMappedColumnsInHierarchySlicer(e,n))return{error:new ee("DQP_No_MappedColumns_In_HierarchySlicers",this.localizationService),query:void 0,mappings:void 0,additionalProjections:void 0,objectDefinitions:void 0};if(c){var i=this.getSorts(n),v=this.featureSwitchService.featureSwitches,c=c({dataViewMappings:n,scopedAggregates:v.scopedAggregates,cartesianMultiples:v.cartesianMultiples});if(c&&c.error)return v=c.error.code,{error:W(this.localizationService.get(v),v),query:void 0,mappings:void 0,additionalProjections:void 0,objectDefinitions:void 0};if(!_.isEmpty(r.expansionStates)){var g=[],c=(n.length,n[0].matrix);!c||(v=c.rows).for&&(g=_.map(v.for.in.items,(function(e){return e})));for(var h=0,f=r.expansionStates;h<f.length;h++){var y=f[h];if(!_.isEmpty(y.root.children))for(var C=0,x=y.levels.length;C<x;C++)for(var S=y.levels[C],b=0,E=g;b<E.length;b++){var N=E[b];N.queryName===S.queryRefs[0]&&2!==N.subtotalType&&(N.subtotalType=1)}}}c=this.getSorts(n);r=this.updateSorts(r,i,c)}for(var V=s,P=t,w=0,T=n;w<T.length;w++){var F=T[w];V&&!1===V.allowBinnedLineSample&&!(function(e){var e=e.categorical;e&&e.dataReductionAlgorithm&&e.dataReductionAlgorithm.binnedLineSample&&(e.dataReductionAlgorithm=void 0,e.categories&&(e.categories.dataReductionAlgorithm={sample:{}}),e.values&&(e=e.values).group&&(e.group.dataReductionAlgorithm={top:{}}))})(F),V&&!1===V.allowOverlappingPointsSample&&!(function(e){var t=e.categorical,e=e.matrix;{var r;t&&t.dataReductionAlgorithm&&t.dataReductionAlgorithm.overlappingPointsSample?(r=t.dataReductionAlgorithm.overlappingPointsSample.count,t.dataReductionAlgorithm={sample:{}},r&&(t.dataReductionAlgorithm.sample.count=r)):e&&e.rows&&e.rows.dataReductionAlgorithm&&e.rows.dataReductionAlgorithm.overlappingPointsSample&&(r=e.rows.dataReductionAlgorithm.overlappingPointsSample.count,e.rows.dataReductionAlgorithm={sample:{}},r&&(e.rows.dataReductionAlgorithm.sample.count=r))}})(F),!(function(e){return _.every(e.schemas,(function(e){return e.capabilities&&e.capabilities.supportsTopNPerLevel}))})(P)&&!(function(e){e=e.matrix;{var t;e&&e.rows&&e.rows.dataReductionAlgorithm&&e.rows.dataReductionAlgorithm.topNPerLevel&&(t=e.rows.dataReductionAlgorithm.topNPerLevel.fallbackTopCount,e.rows.dataReductionAlgorithm={top:{}},t&&(e.rows.dataReductionAlgorithm.top.count=t))}})(F)}r=B.TransformGeneratorUtils.removeUnsupportedTransforms(this.transformPluginService,r,n),r=this.sortService.applyImplicitSort(r,d),r=this.sortService.ensureValidSorting({query:r,schema:t,visualType:e,columnProperties:l,compiledMappings:n});v=z.setProperties(t,n,r,p.visual.objects,p.visual.descriptors),i=v.modifiedObjectDefinitions,c=v.addedScalarKeys,i=this.setFilteredToUniqueValueProperties(u,m,t,n,r,i),p.visual.objects=i,s=this.getQueryRefsByRole(r,o),d=[p.visual],p.visualContainer&&d.push(p.visualContainer),e=U.extend(r.defn,t,d,s,r.projections,a,u&&u.dataFilter,!0);if(e){for(var j=new B.contracts.VisualQuery(e.queryDefn,r.projections,r.expansionStates),R=e.additionalProjections,D=e.warnings,A=0,I=c;A<I.length;A++){var O=I[A],k=j.defn.selectNameOf(O.expr);O.roleItem.scalarKeyInfo||(O.roleItem.scalarKeyInfo={}),O.roleItem.scalarKeyInfo.scalarKeyQueryName=k}p.visual=this.addDefaultFormatStringsForDataBoundProperties(p.visual,t,$.buildExprEvaluationContext(r.defn.from())),p.visual=this.rewriteObjectDefinitions(e.objectDefinitionRewrites,p.visual)}return{query:j||r,mappings:n,additionalProjections:R,warnings:D,objectDefinitions:p.visual.objects}},V.prototype.addDefaultFormatStringsForDataBoundProperties=function(e,t,r){var i={};for(u in e.objects){var a=e.descriptors[u];if(a)for(var o=0,n=e.objects[u];o<n.length;o++)for(d in(c=n[o]).properties){var s=a.properties[d];if(s&&s.formatStringProperty){var l=c.properties[d],p=void 0;if(f(l))p=l;else{if(!y(l))continue;p=l.value}g.getValue(e.objects,s.formatStringProperty,c.selector)||(l=p.getMetadata(t,r))&&(l.type||l.format)&&(p=null!=(p=l.format)?p:M.visuals.valueFormatter.getDefaultFormatString(l.type))&&g.setValue(i,s.formatStringProperty,c.selector,C.text(p))}}}if(!_.isEmpty(i))for(var u in e.objects=g.clone(e.objects),i)for(var c,d,m=0,v=i[u];m<v.length;m++)for(d in(c=v[m]).properties)g.setValue(e.objects,{objectName:u,propertyName:d},c.selector,c.properties[d]);return e},V.prototype.hasMappedColumnsInHierarchySlicer=function(e,t){if(e===M.visuals.plugins.slicer.name)for(var r=0,i=t;r<i.length;r++){var a=i[r],a=null==(a=null==a?void 0:a.metadata)?void 0:a.columns;if(1!==(null==a?void 0:a.length)&&_.some(a,(function(e){return 1===(null==(e=null==e?void 0:e.parameter)?void 0:e.kind)})))return!0}return!1},V.prototype.rewriteObjectDefinitions=function(e,t){if(!_.isEmpty(e)){t.objects=g.clone(t.objects);for(var r=0,i=e;r<i.length;r++){var a,o=i[r];for(a in t.objects)for(var n=0,s=t.objects[a];n<s.length;n++){var l=s[n];if(m.equals(l.selector,o.selector))for(var p in l.properties){var u=l.properties[p],c=void 0;if(f(u))c=u;else{if(!y(u))continue;c=u.value}Z.equals(c,o.from)&&(l.properties[p]=o.to)}}}}return t},V.prototype.getSorts=function(e){for(var t=[],r=0,i=e;r<i.length;r++){for(var a=[],o=0,n=i[r].metadata.columns;o<n.length;o++){var s=n[o];s.sort&&a.push({queryName:s.queryName,sort:s.sort,sortOrder:s.sortOrder})}t.push(a)}return t},V.prototype.updateSorts=function(e,t,r){if(_.isEqual(t,r))return e;for(var i=[],a=e.defn.select(),o=0,n=r;o<n.length;o++)for(var s=n[o],l=0,p=_.sortBy(s,(function(e){return e.sortOrder}));l<p.length;l++){var u=p[l],c=a.withName(u.queryName);i.push({direction:u.sort,expr:c.expr})}return new B.contracts.VisualQuery(e.defn.orderBy(i),e.projections,e.expansionStates)},V.prototype.getQueryRefsByRole=function(t,e){var r={};if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var o=a[i],n=t.tryGetExprs(o.name);r[o.name]=_.map(n,(function(e){return t.defn.selectNameOf(e)}))}return r},V.prototype.setFilteredToUniqueValueProperties=function(e,o,n,t,r,s){var l=this;if(!e||!e.dataFilter)return s;for(var p,u=r.defn.select(),c=e.dataFilter.where(),d=e.queryRefsForSingleItemDrillFilters,i=0,a=t;i<a.length;i++){var m=a[i];m&&m.categorical&&m.categorical.categories&&v.visitCategoricalCategories(m.categorical.categories,{visitRole:function(e){if(!_.isEmpty(e.items))for(var t=0,r=e.items;t<r.length;t++){var i=r[t],a=i.queryName;i.filteredToUniqueValueProperty&&_.includes(d,a)&&(a=u.withName(a),(a=l.isColumnFilteredToUniqueValue(a.expr,c,n,o))&&(p=p||(s?g.clone(s):{}),l.setFilteredToUniqueValueProperty(a,i,p)))}}})}return p||s},V.prototype.isColumnFilteredToUniqueValue=function(e,r,t,i){if(!i||!i.hasAmbiguousEqualitySemantics)return!0;e=e.getKeyColumns(t);return _.every(e,(function(t){return _.some(r,(function(e){e=B.FilterUtils.getFilterValuesForColumn(t,e);if(1===_.size(e)){e=e[0];if(Z.isConstant(e)&&!i.hasAmbiguousEqualitySemantics(e))return!0}return!1}))}))},V.prototype.setFilteredToUniqueValueProperty=function(e,t,r){var i=t.filteredToUniqueValueProperty,e=C.boolean(e),t={metadata:t.queryName};g.setValue(r,i,t,e)},V.prototype.compileNoMappingsWithProperties=function(e,t,r,i,a,o,n){if(!t&&_.isEmpty(i)){t=new B.contracts.VisualQuery(l.create(),{},[]);var i=this.getQueryRefsByRole(t,a),s=[o.visual],s=(s.push(o.visualContainer),U.extend(t.defn,e,s,i,t.projections,r,n&&n.dataFilter,!0));if(s)return i=new B.contracts.VisualQuery(s.queryDefn,t.projections,t.expansionStates),r=s.additionalProjections,n=M.data.compileDataView({mappings:[{table:{rows:{for:{in:"*"}}}}],queryDefn:t.defn,queryProjections:t.projections,schema:e,objectDescriptors:o.visual.descriptors,objectDefinitions:o.visual.objects,roles:a,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:this.transformPluginService}),o.visual=this.addDefaultFormatStringsForDataBoundProperties(o.visual,e,$.buildExprEvaluationContext(t.defn.from())),o.visual=this.rewriteObjectDefinitions(s.objectDefinitionRewrites,o.visual),{query:i||t,mappings:n,additionalProjections:r,warnings:s.warnings,objectDefinitions:o.visual.objects}}},V.prototype.generateQuery=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,g,h){t=this.getQueryGeneratorOptions(t,r,i,a,o,n,s,l,p,u,c,d,m,v,g,h),i=e.execute(t);return{result:i,query:r.query,resolvedQuery:t.query,deferred:i.deferred}},V.prototype.generateFlattenedQuery=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m){t=this.getQueryGeneratorOptions(t,r,i,a,o,n,s,l,p,u,c,void 0,void 0,d,m);return e.executeForQueryOnly?e.executeForQueryOnly(t):t.query},V.prototype.getQueryGeneratorOptions=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,g){var h=t.query,a=this.filterGenerator.resolveFilterTargets(e,h,r,a,o),o=(function(e){var t=e.orderBy();if(_.isEmpty(t))return e;for(var r=!1,i=0,a=t;i<a.length;i++){var o=a[i];Z.isSparklineData(o.expr)&&(o.expr=o.expr.measure,r=!0)}return r?e.orderBy(t):e})(o=B.TransformGeneratorUtils.rewriteTransform(this.transformPluginService,a,h.projections,r,this.getQueryRefsByRole(t.query,r),t.additionalProjections,t.mappings)),a=new L(e,t.mappings,o);return o=o.rewrite(a),{query:u?u(o):o,queryExtensionLookup:c,mappings:t.mappings,additionalProjections:t.additionalProjections,highlightFilter:n,restartToken:s,dataWindow:l,highVolumeOverride:this.featureSwitchService&&this.featureSwitchService.featureSwitches.highVolume,expansionStates:t.query.expansionStates,dataSourceVariables:p,executionMetricsKinds:d,keepProjectionOrder:i,noDefaultProjections:m,windowExpansion:v,anchorTime:g}},V.prototype.getWindowExpansionState=function(e,t,r){var i=this.visualPluginService.capabilities(e.visualType);if(_.some(i.dataViewMappings,(function(e){return e&&e.matrix&&e.matrix.rows&&e.matrix.rows.dataReductionAlgorithm&&e.matrix.rows.dataReductionAlgorithm.topNPerLevel})))return t||(_.size(e.query.expansionStates),I.mergeWithExpansionState(_.first(e.query.expansionStates),void 0,e.query.defn.select(),r))},O=V,(z||(z={})).setProperties=function(l,e,p,u,c){for(var d,m=[],t=0,r=e;t<r.length;t++){var i=r[t];v.visitMapping(i,{visitRole:function(e){if(e.items)for(var t=0,r=e.items;t<r.length;t++){var i=r[t];i.scalarKeyInfo&&i.scalarKeyInfo.scalarKeyMinProperty&&(d=d||(u?(a=h.serializeObjects(u,c),h.deserializeObjects(a,c)):{}),m.push((a=l,o=p,n=d,s=void 0,s=(i=i).scalarKeyInfo.scalarKeyMinProperty,M.contract.check(i.scalarKeyInfo.hasScalarKey,"Scalar key requested when not available"),o=o.defn.select().withName(i.queryName).expr,o=C.aggregate(R.getScalarKeyExpr(o,a),3),a=i.scalarKeyInfo.selector,g.setValue(n,s,a,o),{roleItem:i,expr:o})))}var a,o,n,s}})}return{modifiedObjectDefinitions:d||u,addedScalarKeys:m}},__extends(o,k=t),o.prototype.visitSparklineData=function(t){_.size(t.grouping);for(var e,r,i=this.pointsPerSparkline+1,a=t.grouping[0],a=(Z.isHierarchyLevel(a)&&null!=(r=null==(r=a.getMetadata(this.schema))?void 0:r.type)&&r.temporal&&(r=M.data.ScalarKeyUtils.getScalarKeyExpr(a,this.schema))&&(e=C.aggregate(r,3)),_.find(this.query.select(),(function(e){return Z.equals(e.expr,t)}))),o=a.name,n=!1,s=0,l=this.compiledMappings;s<l.length;s++){var p=l[s];v.visitMapping(p,{visitRole:function(e){var e=_.find(e.items,(function(e){return e.queryName===o}));null!=(e=null==e?void 0:e.sparklineInfo)&&e.includeMinGroupingInterval&&(n=!0)}})}return C.sparklineData(t.measure,t.grouping,e,i,n)},L=o,__extends(s,q=t),s.prototype.rewrite=function(){for(var e in this.objects)for(var t=0;t<this.objects[e].length;t++){var r=this.objects[e][t];if(r.selector){r=r.selector,r=m.toScopeIdentities(r);if(!_.isEmpty(r)){this.rewrittenObjects||(this.rewrittenObjects=g.clone(this.objects));for(var i=0,a=r;i<a.length;i++){var o=a[i].expr;this.rewrittenObjects[e][t].selector={data:[M.data.createDataViewScopeIdentity(o.accept(this))]}}}}}},s.prototype.visitSelectRef=function(e){var t=e.expressionName,t=this.query.select().withName(t),r=t.expr,t=(t&&Z.isColumn(t.expr)&&Z.isSubqueryRef(t.expr.source)&&(r=$.getSubqueryExpression(t.expr,this.context)),_.find(this.queryRewrites,(function(e){return e.selectExprReplaced&&Z.equals(e.selectExprReplaced.originalExpr,r)})));return t?t.selectExprReplaced.replacedExpr:e},te=s,e.getDataViewMappingErrorFromFailures=X,w.create=function(e,t,r){if(!_.isEmpty(e)){for(var i=[],a=function(e,t){return e.hierarchy?e.hierarchy.name:e.hierarchyLevel?e.hierarchyLevel.name+"."+e.hierarchyLevel.level:t},o=0,n=e;o<n.length;o++){var s=n[o],s=b.asFieldPattern(s),l=void 0;if(s.sparklineData)var p=s.sparklineData.measure,u=(_.size(s.sparklineData.grouping),_.first(s.sparklineData.grouping)),p=a(p,d.getPropertyName(p)),u=a(u,d.getPropertyName(u)),l=r.format("VisualTitle_By_Template",p,u);else{p=d.toFieldExprEntityItemPattern(s);if(!p)continue;u=a(s,d.getPropertyName(s)),s=(l="("+p.entity+") "+u,t.schema(p.schema)),s=s&&s.findProperty(p.entity,u);s&&s.errorMessage&&(l+=": "+s.errorMessage)}i.push(l)}return new w("Missing_References",r,i.join(", "))}},Object.defineProperty(w.prototype,"code",{get:function(){return this.errorCode},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"source",{get:function(){return this.errorSource},enumerable:!1,configurable:!0}),w.prototype.addDebugInfo=function(e,t){this.debugErrorInfo||(this.debugErrorInfo=[]),this.debugErrorInfo.push({errorInfoKey:e,errorInfoValue:t})},w.prototype.getDetails=function(e){var t=e.get(this.displayableErrorInfo[0].errorInfoKey),r=this.displayableErrorInfo[0].errorInfoValue;return this.detailsMessageFormat&&(r=a.format(e.get(this.detailsMessageFormat),r)),{message:e.get(this.messageId),displayableErrorInfo:[{errorInfoKey:t,errorInfoValue:r}],debugErrorInfo:(e=[{errorInfoKey:i.ClientErrorCode,errorInfoValue:this.code}]).concat.apply(e,this.debugErrorInfo||[]),hideErrorHelperText:this.hideErrorHelperText,hideDebugInfo:this.hideDebugInfo,helpLink:this.helperLink}},ee=w,e.VisualQueryClientError=ee,(E||(E={})).validateAndAdjustRolesIfNecessary=function(e,t,r,i,a){for(var o=new G(t.defn,r,i,a),n=0,s=e;n<s.length;n++){var l=s[n];v.visitMapping(l,o)}return o.warnings},K.prototype.visitRole=function(e){e.showAll&&0<this.incompatibleExprInfo.length&&(e.showAll=!1,this.warnings.push(new Q(this.incompatibleExprInfo)))},G=K,Object.defineProperty(p.prototype,"code",{get:function(){return"ShowAllDiabledWarning"},enumerable:!1,configurable:!0}),p.prototype.getDetails=function(e){var t=e.get("ShowAllDisabledWarning_Value"),r=_.map(this.errorInfos,(function(e){return e.fieldDisplayName})).join(", ");return{message:e.get("ShowAllDisabledWarning_Message"),displayableErrorInfo:[{errorInfoKey:e.get("ShowAllDiabledWarning_ErrorInfoKey"),errorInfoValue:a.format(t,r)}]}},Q=p,(N||(N={})).validateAndAdjustHighlightIfNecessary=function(e){if(e&&e.highlightFilter){var t=e.highlightFilter.where(),r=_.find(t,(function(e){return 3===F.runDetector(e.condition)})),t=_.find(t,(function(e){return Z.isExists(e.condition)}));if(r||t)return e.dataFilter=e.dataFilter?D.merge([e.dataFilter,e.highlightFilter]):e.highlightFilter,e.highlightFilter=void 0,[new H(r?0:1)]}},Object.defineProperty(u.prototype,"code",{get:function(){switch(this.highlightDisableType){case 0:return"HighlightWithTOPNDisabledWarning";case 1:return"HighlightWithExistsFiltersDisabledWarning"}},enumerable:!1,configurable:!0}),u.prototype.getDetails=function(e){var t=0===this.highlightDisableType,r=t?"HighlightWithTOPNDisabledWarning_ErrorInfoKey":"HighlightWithExistFiltersDisabledWarning_ErrorInfoKey",i=t?"HighlightWithTOPNDisabledWarning_Value":"HighlightWithExistFiltersDisabledWarning_Value";return{message:e.get(t?"HighlightWithTOPNDisabledWarning_Message":"HighlightWithExistFiltersDisabledWarning_Message"),displayableErrorInfo:[{errorInfoKey:e.get(r),errorInfoValue:e.get(i)}]}},H=u})(powerbi=powerbi||{}),(function(s){var i,e,a,n,o;function t(e,t,r,i,a){this.visualPluginService=e,this.pluginOps=t,this.explorationNavigationService=r,this.featureSwitchService=i,this.visualCapabilitiesService=a}i=s.explore||(s.explore={}),e=i.services||(i.services={}),a=s.visuals.plugins,n=i.util.VisualContainerUtils,e.createVisualRelationshipService=function(e,t,r,i,a){return new o(e,t,r,i,a)},t.prototype.relationship=function(e,t,r){return this.getRelationship(e.relationships,t,r)},t.prototype.drillRelationship=function(e,t,r){e=this.getRelationship(e.relationships,t,r);if(e)return t=e,2===e.type?{source:e.source,target:e.target,type:1}:t},t.prototype.getRelationship=function(e,t,r){return _.find(e,(function(e){return e.source.name===t.name&&e.target.name===r.name}))},t.prototype.getIsCrossHighlightingDisabled=function(){var e=this.explorationNavigationService&&this.explorationNavigationService.getCurrentExploration(),e=e&&e.slowDataSourceSettings;return e&&e.isCrossHighlightingDisabled},t.prototype.relationshipFilterAction=function(e,t,r,i){e=this.relationship(e,t,r);return this.getRelationshipFilterAction(e,t,r,i)},t.prototype.drillRelationshipFilterAction=function(e,t,r,i){if(!t.drillFilterOtherVisuals)return 3;e=this.drillRelationship(e,t,r),e&&e.type,e=this.getRelationshipFilterAction(e,t,r,i);return e},t.prototype.shouldApplyCrossDrill=function(e,t,r,i){if(t!==r&&n.getVisualType(r)!==a.slicer.name){e=this.drillRelationshipFilterAction(e,t,r,i);if(1===e)return!0;if(0===e)if(1===this.defaultDrillFilterAction(t,r))return!0}return!1},t.prototype.getRelationshipFilterAction=function(e,t,r,i){if(e&&this.supportsFilterActionTarget(t,r,e.type))return e.type;var e=r&&r.config&&r.config.singleVisual,r=e&&r.config.singleVisual.visualType,a=this.visualPluginService.capabilities(r);if(this.getIsCrossHighlightingDisabled()&&!this.isSlicer(a,r)){var o=t&&t.config&&t.config.singleVisual,t=o&&t.config.singleVisual.visualType,n=this.visualPluginService.capabilities(t);if(!this.isFilter(n,t,o&&o.objects))return 3}if(a){n=e.query;if(n){t=this.visualPluginService.getPlugin(r);if(t&&t.isCrossFilteredByDefault){o=e.objects,r={mappings:a.dataViewMappings,queryDefn:n.defn,queryProjections:n.projections,schema:i,objectDescriptors:a.objects,objectDefinitions:o,roles:a.dataRoles,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:s.data.transforms.createTransformPluginService()},e=s.data.compileDataView(r);if(t.isCrossFilteredByDefault({dataViewMappings:e}))return 3}}}return 0},t.prototype.isSlicer=function(e,t){return!!i.FilterUtils.tryGetFilterPropertyIdentifier(e,t,this.visualPluginService)},t.prototype.isFilter=function(e,t,r){return e?this.isSlicer(e,t):null!=i.FilterUtils.tryGetFilterProperty(e,t,this.visualPluginService,r)},t.prototype.supportsFilterActionTarget=function(e,t,r){var i=n.getVisualType(t),a=n.getVisualType(e);if(!_.isEmpty(a)&&!_.isEmpty(i))switch(r){case 1:case 3:return!0;case 2:var o=this.visualPluginService.capabilities(i);return(!o||o.supportsHighlight)&&!this.visualCapabilitiesService.hasFilterCapabilities(a)}return!1},t.prototype.supportsAnyFilterAction=function(e){e=n.getVisualType(e);if(_.isEmpty(e)||!this.pluginOps.isQueryVisual(e)&&!this.pluginOps.isQnaVisual(e))return!1;e=this.visualPluginService.capabilities(e);return!e||!1!==e.supportsSelection},t.prototype.defaultFilterAction=function(e,t){var r=this.explorationNavigationService&&this.explorationNavigationService.getCurrentExploration(),r=r&&r.settings;return r&&!!r.defaultFilterActionIsDataFilter||!this.supportsFilterActionTarget(e,t,2)?this.supportsFilterActionTarget(e,t,1)?1:void 0:2},t.prototype.defaultDrillFilterAction=function(e,t){e=this.defaultFilterAction(e,t);return e=2===e?1:e},o=t})(powerbi=powerbi||{}),(function(r){var e;(function(e){var n=r.explore.util.VisualContainerUtils;function t(e){this.visualPlugins=e,this.collectedFilters=[]}t.prototype.collectFilters=function(e,t,r){if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var o=a[i];o&&o.filter&&this.collectFilter(o.filter,o,r,t)}},t.prototype.collectFiltersForFilterContainer=function(e,t,r,i){if(e)for(var a=0,o=e;a<o.length;a++){var n=o[a];n.filter&&n!==r&&this.collectFilter(n.filter,n,i,t)}},t.prototype.collectFilter=function(e,t,r,i,a){var o;e&&(r&&(o=n.getVisualCapabilities(r,this.visualPlugins)),this.collectedFilters.push({filter:e,filterContainer:t,sourceVisualContainer:r,sourceVisualContainerCapabilities:o,scopeType:i,collectedFilterSource:a}))},t.prototype.getCollectedFilters=function(){return this.collectedFilters},e.FilterCollector=t})((e=r.explore||(r.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(l){var v;(function(t){var e=jsCommon.ArrayExtensions,c=l.explore.contracts.CollectedFilterSource,r=l.data.SemanticFilter,i=l.data.services.SemanticQuerySerializer,a=l.data.SubqueryRewriter,o=l.data.TopNFilterPruner,n=v.util.VisualContainerUtils;function u(e,t,r,i,a,o,n){var s={filter:e,scope:t,filterExpressionMetadata:n};if(r)s.restatement=r.restatement,s.type=r.type,s.isHidden=!!r.isHiddenInViewMode,s.filterExpressionMetadata=r.expression?{expressions:[r.expression]}:void 0,s.displayName=r.displayName,r.cachedValueItems&&s.filterExpressionMetadata?s.filterExpressionMetadata.cachedValueItems=m(r.cachedValueItems,0):r.filterExpressionMetadata&&(s.filterExpressionMetadata=r.filterExpressionMetadata);else if(i&&v.FilterUtils.supportsFilterOutput(a)&&i.config.singleVisual.query){e=i.config.singleVisual.query.defn.select(),t=i.config.singleVisual.cachedFilterDisplayItems,n=i.config.singleVisual.filterExpressionMetadata;if(1<=e.length&&t&&o===c.Slicer)s.filterExpressionMetadata={expressions:[e[0].expr],cachedValueItems:m(t,0)};else if(n)s.filterExpressionMetadata=n;else{s.filterExpressionMetadata={expressions:[]};for(var l=0,p=e;l<p.length;l++){var u=p[l];s.filterExpressionMetadata.expressions.push(u.expr)}}}return s}function d(e){var t;if(null!=e)return t={Restatement:e.restatement,type:e.type},e.expression&&(t.expression=i.serializeExpr(e.expression)),t}function m(e,t){for(var r=[],i=0,a=e;i<a.length;i++){var o=a[i],n={identities:[o.identity],valueMap:{}};n.valueMap[t]=o.displayName,r.push(n)}return r}function s(e,t){this.visualContainer=e,this.filterContainer=t,e&&(t=n.getVisualQuery(e))&&(this.visualSemanticQuery=t.defn),this.needToEnsurePrecedence=!1,this.shouldPruneUnnecessaryFilters=!1}t.toFilterData=u,t.generateSingleFilterMetadata=d,t.generateFilterMetadata=function(e){if(!_.isEmpty(e)){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];t.push(d(a))}return t}},s.prototype.setSelectorFilter=function(e){this.selectorFilter,this.selectorFilter=e,this.shouldPruneUnnecessaryFilters=!0},s.prototype.addDrillFilter=function(e){this.drillFilters=this.drillFilters||[],this.drillFilters.push(e)},s.prototype.addVisualFilter=function(e){this.visualSemanticQuery&&(e.filter=a.rewriteSubqueriesForContainingQuery(e.filter,this.visualSemanticQuery)),this.visualFilters=this.visualFilters||[],this.visualFilters.push(e),this.needToEnsurePrecedence=!0,this.shouldPruneUnnecessaryFilters=!0},s.prototype.addDrillthroughFilter=function(e){this.drillthroughFilters=this.drillthroughFilters||[],this.drillthroughFilters.push(e),this.needToEnsurePrecedence=!0},s.prototype.addSectionFilter=function(e){this.sectionFilters=this.sectionFilters||[],this.sectionFilters.push(e),this.needToEnsurePrecedence=!0},s.prototype.addReportFilter=function(e){this.reportFilters=this.reportFilters||[],this.reportFilters.push(e),this.needToEnsurePrecedence=!0},s.prototype.addCrossFilter=function(e){this.crossFilters=this.crossFilters||[],this.crossFilters.push(e),this.needToEnsurePrecedence=!0},s.prototype.addHighlight=function(e){this.highlightFilters=this.highlightFilters||[],this.highlightFilters.push(e)},s.prototype.addCollectedFilters=function(e,t,r){for(var i=0,a=e;i<a.length;i++){var o,n=a[i],s=n.filter,l=n.filterContainer,p=n.sourceVisualContainer;r&&!r(s,l,p)||(o=l,n.filterContainer&&n.filterContainer===this.filterContainer&&(o=null),s=u(s,n.scopeType,o,p,n.sourceVisualContainerCapabilities,n.collectedFilterSource),!l||2!==l.howCreated&&0!==l.precedence?n.sourceVisualContainer?n.sourceVisualContainer===this.visualContainer?this.addVisualFilter(s):this.addCrossFilter(s):5===l.howCreated?this.addDrillthroughFilter(s):1===n.scopeType?this.addSectionFilter(s):2===n.scopeType?this.addReportFilter(s):n.filterContainer&&n.filterContainer===this.filterContainer&&this.addVisualFilter(s):this.addDrillFilter(s),t&&l&&(this.metadata=this.metadata||[],this.metadata.push(d(l))))}},s.prototype.mergeHighlightFiltersBasedOnRelationship=function(e,t,r){var i=this;switch(t){case 0:case 2:if(!r){_.each(e,(function(e){return i.addHighlight(e)}));break}case 1:e&&_.each(e,(function(e){return i.addCrossFilter(e)}))}},s.prototype.getFilters=function(e){var e=this.getFilterData(e),t=this.highlightFilters&&r.merge(this.highlightFilters.map((function(e){return e.filter})));return{dataFilter:e?r.merge(_.map(e,(function(e){return e.filter}))):void 0,dataFiltersUnmerged:e,highlightFilter:t,highlightFiltersUnmerged:this.highlightFilters,filterMetadata:this.metadata}},s.prototype.getFilterData=function(e){var t,r,i,a,o;if(this.selectorFilter,this.pruneUnnecessaryFilters(),e||this.ensurePrecedence(),this.drillFilters||this.sectionFilters||this.reportFilters||this.visualFilters||this.crossFilters||this.drillthroughFilters)return e=this.drillFilters||[],t=this.visualFilters||[],r=this.sectionFilters||[],i=this.drillthroughFilters||[],a=this.reportFilters||[],o=this.crossFilters||[],e.concat(t).concat(o).concat(r).concat(i).concat(a)},s.prototype.getCrossHighlightFilters=function(){var e,t;if(this.pruneUnnecessaryFilters(),this.ensurePrecedence(),this.selectorFilter||this.visualFilters)return e=this.selectorFilter?[this.selectorFilter]:[],t=this.visualFilters||[],e.concat(t)},s.prototype.getHighlightFilters=function(){return this.highlightFilters},s.prototype.clearHighlightFilters=function(){this.highlightFilters=void 0},s.prototype.getUnmergedDrillCrossFilter=function(){return this.pruneUnnecessaryFilters(),this.ensurePrecedence(),this.drillFilters},s.prototype.getCrossFilters=function(){return this.crossFilters},s.prototype.ensurePrecedence=function(){var e;this.needToEnsurePrecedence&&(this.visualFilters&&(e={visualFilters:this.visualFilters,crossFilters:this.crossFilters,reportFilters:this.reportFilters,drillThroughFilters:this.drillthroughFilters,sectionFilters:this.sectionFilters},this.visualFilters=t.FilterPrecedenceResolver.resolve(e)),this.needToEnsurePrecedence=!1)},s.prototype.pruneUnnecessaryFilters=function(){var r=this;this.shouldPruneUnnecessaryFilters&&(this.visualFilters&&this.selectorFilter&&this.visualFilters&&this.selectorFilter&&(this.visualFilters=e.filterArray(this.visualFilters,(function(e,t){return e.filter=o.removeUnnecessaryTopNFilters(e.filter,r.selectorFilter.filter),0<e.filter.where().length}))),this.shouldPruneUnnecessaryFilters=!1)},t.FilterBuilder=s})((v=l.explore||(l.explore={})).services||(v.services={}))})(powerbi=powerbi||{}),(function(u){var e,v,g,t,o,n,r,a,c,l,s,p,i,d,h,m,E;function f(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,g,h,f,y,C,x,S,b){this.queryExecutionServices=e,this.hostServices=t,this.promiseFactory=r,this.conceptualSchemaProxy=i,this.featureSwitchService=a,this.telemetryService=o,this.visualQueryGenerator=n,this.visualPlugin=s,this.visualPluginOps=l,this.filterGenerator=p,this.displayNameService=u,this.explorationNavigation=c,this.visualValidationService=d,this.resourceLoader=m,this.eventBridge=v,this.dataProxyService=g,this.dataSources=h,this.visualLifecycleService=f,this.resourceRegistration=y,this.cachePolicyProviderService=C,this.visualInsightsAnalysisHandler=x,this.visualParameterService=S,this.visualDataProxyExecutionService=b}e=u.explore||(u.explore={}),v=e.services||(e.services={}),g=u.data.CacheOptions,t=u.common,o=u.data.segmentation.DataViewMerger,n=u.data.services.DataViewTransformActionsSerializer,r=jsCommon.DateExtensions,a=e.util.ExplorationTelemetryUtil,c=u.data.dsr,l=u.explore.services.generateFilterMetadata,s=u.PbiPromise,p=u.visualHost.ResourcePackageReferenceResolver,i=u.explore.util.ResourcePackageUtils,d=u.visualHost.utils.ResourcePackageUtils,h=e.util.VisualContainerUtils,m=u.explore.util.VisualPerformanceActivityUtil,v.createVisualContainerQueryHandler=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,g,h,f,y,C,x,S,b){return new E(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,g,h,b,S,f,y,C,x)},f.prototype.attach=function(e){this.queryExecutionServices=e},f.prototype.cancelQuery=function(e){this.visualDataProxyExecutionService.cancelQuery(e),this.visualParameterService.cancelResolve(e)},f.prototype.generateApplicationContext=function(e,t){var r=this.explorationNavigation&&this.explorationNavigation.getCurrentExploration()&&this.explorationNavigation.getCurrentExploration().report,i=r&&r.objectId;return{DatasetId:r&&r.model&&r.model.dbName,Sources:[{ReportId:i,Operation:e,VisualId:t&&t.name}]}},f.prototype.runQuery=function(t){var e,r=this,i=m.updateParentWithNewLinkingActivity(t.performanceActivity,u.telemetry.EXRunQuery,this.telemetryService),a=t.performanceActivity,o=(this.featureSwitchService.featureSwitches.resolveParametersEvent&&(e=this.startResolveParametersPerformanceActivity(a)),this.startQueryPerformanceActivity(a)),n=this.dataSources.get(),s=t.contract,l=s.config.singleVisual,p=l.query&&l.query.hasQueryFieldParameters();if(this.visualValidationService.shouldBlockVisualQuery&&this.visualValidationService.shouldBlockVisualQuery(s)||!(t.skipShouldRunQueryVerification||this.visualQueryGenerator.shouldExecute(l,n)||this.visualParameterService.shouldExecute(l,n)))return this.featureSwitchService.featureSwitches.resolveParametersEvent&&this.transitionResolveParametersToQuery(!1,e,o),o&&o.queryActivity.resolve(),i&&i.resolve(),!1;a=o&&o.telemetryActivity,this.queryExecutionServices.notifyStart(a),e&&e.setProperty("start",jsCommon.performance.now()),a=this.resolveQueryParameters(t,e),a=this.visualInsightsAnalysisHandler.supportsInsights(s)?a.then((function(){if(r.featureSwitchService.featureSwitches.resolveParametersEvent&&r.transitionResolveParametersToQuery(!0,e,o),!p||r.visualQueryGenerator.shouldExecute(l,n))return r.visualInsightsAnalysisHandler.runInsights(s).then((function(e){if(e){if(e.error)throw e.error;e.queryExecutionOptions&&_.merge(t,e.queryExecutionOptions)}return r.runQueryImpl(t,n,s,o,e&&e.warnings)}))})):a.then((function(){if(r.featureSwitchService.featureSwitches.resolveParametersEvent&&r.transitionResolveParametersToQuery(!0,e,o),!p||r.visualQueryGenerator.shouldExecute(l,n))return r.runQueryImpl(t,n,s,o,void 0)}));return a.catch((function(e){r.queryExecutionServices.handleErrors(e,o)})).finally((function(){r.queryExecutionServices.notifyEnd(),i&&i.resolve()})),!0},f.prototype.transitionResolveParametersToQuery=function(e,t,r){t&&(r&&r.queryActivity.setProperty("start",jsCommon.performance.now()),e&&0<t.getProperty("metadataParameterCount")?t.resolve():t.cancel(!0))},f.prototype.resolveQueryParameters=function(i,a){var o=this,n=this.dataSources.get();return this.conceptualSchemaProxy.get(n).then((function(e){var t=o.generateApplicationContext(i.queryOperation,i.contract),r=o.getDatasetCacheOptions(i,n,!1),e={dataSources:n,schema:e,additionalFilters:o.hostServices.getFilters(o.filterGenerator,e),config:i.contract.config.singleVisual,cacheOptions:r,allowResultFromClientCache:i.allowResultFromClientCache,applicationContext:t,cacheResponseOnServer:i.cacheResponseOnServer,visual:i.contract,performanceActivity:a,metricsKind:i.executionMetricsKind};return o.visualParameterService.resolve(e)}))},f.prototype.runQueryImpl=function(a,o,n,s,r){var l,p=this,u=(!a.initialLoad&&this.hostServices&&this.updateCachedData(a),this.getDatasetCacheOptions(a,o,!0)),e=a.initialLoad&&this.featureSwitchService.featureSwitches.verboseTelemetry,t=(e&&(l=this.startVisualFirstLoadTelemetryEvent(u,o,n.name,s&&s.telemetryActivity)),t=this.generateApplicationContext(a.queryOperation,n),this.visualDataProxyExecutionService.runQuery({dataSources:o,contract:n,viewport:a.viewport,hostServices:this.hostServices,initialLoad:a.initialLoad,useVisualContainerCache:a.useVisualContainerCache,preferCurrentData:a.preferCurrentData,allowResultFromClientCache:a.allowResultFromClientCache,cacheResponseOnServer:a.cacheResponseOnServer,cacheResponseOnContract:a.cacheResponseOnContract,cacheOptions:u,clientCacheOnly:a.clientCacheOnly,visualFirstLoadEvent:l,performanceActivity:s&&s.queryActivity,executionMetricsKind:a.executionMetricsKind,canDefer:a.canDefer,requestPriority:a.requestPriority,applicationContext:t,windowExpansionTransform:a.windowExpansionTransform,skipShouldRunQueryVerification:a.skipShouldRunQueryVerification,previewGate:a.previewGate})),i=n.config.singleVisual.visualType,c=n.config.singleVisual.objects,d=this.loadResourcePackageReferences(i,c),m=(a.geocodingTracker&&a.geocodingTracker.newQuery(s&&s.rootActivity),!1);return t.previewPromise.then((function(t){t&&!m&&p.resolveResourcePackageReferences(i,t.dataProxyQuery.transforms.objects,s&&s.rootActivity).then((function(e){p.handleQueryResult(n,t.result,t.dataProxyQuery,e,null,null,!0,s,r)}))}),(function(e){e.ignorable})),t.finalPromise.then((function(e){var t=e&&e.result&&e.result.dataReaderResult,r=!!(u&g.AllowCache),i=(t&&r&&l&&(l.event.info.cacheResultFromServer=e.result.dataReaderResult.fromCache),p.getLastRefreshTime(o));return r&&t&&p.isResultStale(i,e.result.dataReaderResult.timestamp)?(r=!!(u&g.PreventRefresh),t=g.AllowQuery|g.CacheResult,t=r?t|g.PreventRefresh:t,l&&(l.event.info.staleCacheResultFromServer=!0),p.visualDataProxyExecutionService.runQuery({dataSources:o,contract:n,viewport:a.viewport,hostServices:p.hostServices,initialLoad:a.initialLoad,useVisualContainerCache:!1,preferCurrentData:a.preferCurrentData,allowResultFromClientCache:!1,cacheResponseOnServer:!1,cacheOptions:t,visualFirstLoadEvent:l,performanceActivity:s&&s.queryActivity,executionMetricsKind:a.executionMetricsKind,requestPriority:a.requestPriority,canDefer:a.canDefer}).finalPromise):e})).then((function(e){return d.then((function(){p.processQueryResult(a,e,s,r)}))})).finally((function(){m=!0,e&&l&&l.resolve()}))},f.prototype.startQueryPerformanceActivity=function(e){if(e&&e.isRunning())return{rootActivity:e,queryActivity:e.createChildActivity({name:"Query"}),telemetryActivity:this.telemetryService.getOpenActivityById(e&&e.getProperty("telemetryActivityId"))}},f.prototype.startResolveParametersPerformanceActivity=function(e){if(e)return e.createChildActivity({name:"Resolve Parameters"})},f.prototype.startVisualFirstLoadTelemetryEvent=function(e,t,r,i){e=!!(e&g.AllowCache),t=h.hasOnPremDataSource(t),i=i?this.telemetryService.startChildEvent(i.event,u.telemetry.EXVisualFirstLoad,{onPrem:t,isServerCacheEligible:e,visualName:r}):this.telemetryService.startEvent(u.telemetry.EXVisualFirstLoad,{onPrem:t,isServerCacheEligible:e,visualName:r});return a.addExplorationInfoToEvent(i.event,this.explorationNavigation),i},f.prototype.getCachedQueryOrGenerate=function(a){return __awaiter(this,void 0,u.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:if(t=m.updateParentWithNewLinkingActivity(a.performanceActivity,u.telemetry.EXGetCachedQueryOrGenerate,this.telemetryService),r=this.dataProxyService.lastExecutedQuery())return this.cachedQueryResult=void 0,[2,r];e.label=1;case 1:return e.trys.push([1,,4,5]),(i=this.cachedQueryResult)?[3,3]:[4,this.generateQuery(a)];case 2:i=e.sent(),e.label=3;case 3:return[2,i];case 4:return t&&t.resolve(),[7];case 5:return[2]}}))}))},f.prototype.generateQuery=function(i){return __awaiter(this,void 0,s,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return t=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(t)];case 1:return r=e.sent(),r={dataSources:t,schema:r,config:i.contract.config.singleVisual,hostServices:this.hostServices,visualQueryGenerator:this.visualQueryGenerator,executionType:0,preferCurrentData:null==i.preferCurrentData||i.preferCurrentData,viewport:i.viewport,allowResultFromClientCache:null==i.allowResultFromClientCache||i.allowResultFromClientCache,cacheOptions:void 0,performanceActivity:i.performanceActivity,executionMetricsKind:i.executionMetricsKind},r=this.visualDataProxyExecutionService.generateQuery(r),this.dataProxyService.lastExecutedQuery()?this.cachedQueryResult=void 0:this.cachedQueryResult=r,[2,r]}}))}))},f.prototype.updateCachedData=function(a){return __awaiter(this,void 0,u.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return!1===a.cacheResponseOnContract?[2]:[4,this.generateQuery(__assign(__assign({},a),{performanceActivity:void 0}))];case 1:return t=e.sent(),r=a.contract,t&&!t.error&&r.cachedData&&(r.cachedData.dataUpdatedTime=void 0,i=this.visualPlugin.capabilities(r.config.singleVisual.visualType),r.cachedData.transformsObject=n.serializeDataViewTransformActions(t.transforms,i.objects),r.cachedData.queryObject=t.options.query.command,r.cachedData.dataObject=void 0),[2]}}))}))},f.prototype.loadMoreData=function(t){var r=this,e=this.startQueryPerformanceActivity(t.performanceActivity);this.queryExecutionServices.notifyStart(),this.getNextDataSegment(t,e).then((function(e){e&&r.mergeMoreData(e.result,e.dataProxyQuery,t.currentData,e.performanceActivityContext)})).catch((function(){e&&e.queryActivity.reject()})).finally((function(){r.queryExecutionServices.notifyEnd()}))},f.prototype.canLoadMoreData=function(){return this.visualDataProxyExecutionService.canLoadMoreData()},f.prototype.loadWindow=function(t){var r=this,i=this.startQueryPerformanceActivity(t.performanceActivity);this.queryExecutionServices.notifyStart(),this.visualDataProxyExecutionService.loadWindow({dataSources:this.dataSources.get(),contract:t.contract,hostServices:this.hostServices,viewport:t.viewport,useVisualContainerCache:t.useVisualContainerCache,performanceActivity:null==i?void 0:i.queryActivity,executionMetricsKind:t.executionMetricsKind,windowExpansionState:t.windowExpansionState}).then((function(e){r.handleLoadMoreDataWarnings(e&&e.result,e&&e.dataProxyQuery),r.processQueryResult(t,e,i,void 0)})).catch((function(e){r.queryExecutionServices.handleErrors(e),i&&i.queryActivity.reject()})).finally((function(){r.queryExecutionServices.notifyEnd()}))},f.prototype.getNextDataSegment=function(e,t){var r=this,i=t||this.startQueryPerformanceActivity(e.performanceActivity),a=this.promiseFactory.defer();return this.visualDataProxyExecutionService.canLoadMoreData()?this.visualDataProxyExecutionService.loadMoreData({dataSources:this.dataSources.get(),contract:e.contract,hostServices:this.hostServices,viewport:e.viewport,useVisualContainerCache:e.useVisualContainerCache,performanceActivity:null==i?void 0:i.queryActivity,executionMetricsKind:e.executionMetricsKind}).then((function(e){r.handleLoadMoreDataWarnings(e&&e.result,e&&e.dataProxyQuery);var t=e;i&&(t=__assign(__assign({},e),{performanceActivityContext:i})),a.resolve(t)}),(function(e){r.queryExecutionServices.handleErrors(e),i&&i.queryActivity.reject(),a.reject(e)})):(i&&i.queryActivity.reject(),a.reject("Cannot load more data")),a.promise},f.prototype.reloadDataSegment=function(e,t){var r=e.currentData&&e.currentData.dataView&&e.currentData.dataView.matrix&&e.currentData.dataView.matrix.rows&&e.currentData.dataView.matrix.rows.root;r&&(t=this.dataProxyService.getNodeSegment(t))&&0!==t.index?(this.dataProxyService.discardSegmentsFrom(t.index),t=this.dataProxyService.getLastNodeIndex(),o.pruneTree(r,t)?this.loadMoreData(e):this.runQuery(e)):this.runQuery(e)},f.prototype.mergeMoreData=function(e,t,r,i){var t=f.getDataProxyQueryExecutionResultWarnings(e,t),a=e&&e.dataReaderResult?e.dataReaderResult.dataView:null;a?(null!=r&&r.dataView,r=r.dataView,o.mergeDataViews(r,a),a={dataView:r,dataViewSource:e&&e.dataViewSource,performanceActivities:e&&e.dataReaderResult&&e.dataReaderResult.performanceActivities,isFirstSegment:!1},_.isEmpty(t)||(a.warnings=t),this.queryExecutionServices.loadMergedData(a,i)):i&&i.queryActivity.resolve()},f.prototype.visualizeDataViewSource=function(r,i,a,e){var o,n,s=this,l=this.startQueryPerformanceActivity(e),e=r.config.singleVisual,e=this.visualPluginOps.targetedDataViewKinds(e.visualType,e.query),p=c.read(e,i.data,t.utils.getDsrReaderSwitches(this.featureSwitchService.featureSwitches)),e=p.error;e?this.queryExecutionServices.handleErrors(e):(o=this.dataSources.get(),n=r&&r.config&&r.config.singleVisual,o&&n&&this.conceptualSchemaProxy.get(o).then((function(e){var t,e=s.visualQueryGenerator.execute({config:n,dataSources:o,schema:e,additionalFilters:s.hostServices.getFilters(s.filterGenerator,e),restartToken:p.restartToken,dataWindow:a,dataSourceVariables:s.hostServices.getDataSourceVariables(),disableAnchorTime:!!s.hostServices.disableAnchorTime||s.visualPluginOps.isQnaVisual(n.visualType)});e&&((t=s.promiseFactory.defer()).resolve(e.options),s.handleQueryResult(r,{dataViewSource:i,dataReaderResult:p},{transforms:e.transforms,error:e.error,warnings:e.warnings,options:t.promise},null,{updateContractCache:!0},null,!1,l))})))},f.prototype.updateNonQueryVisual=function(e,t,r){var i,a=this,o=this.startQueryPerformanceActivity(r),n={dataView:null,dataViewSource:null};t?(i=e.config.singleVisual.visualType,e=e.config.singleVisual.objects,this.queryExecutionServices.notifyStart(),this.resolveResourcePackageReferences(i,e,r).then((function(e){a.queryExecutionServices.applyUpdate(n,t,e,o)})).finally((function(){a.queryExecutionServices.notifyEnd()}))):this.queryExecutionServices.applyUpdate(n,t,null,o)},f.prototype.updateContractCache=function(r,e,i){var a=this;if(!r)return this.promiseFactory.reject(null);var t=this.dataSources.get();if(!t)return this.promiseFactory.reject(null);var o=r.cachedData&&r.cachedData.dataUpdatedTime?r.cachedData.dataUpdatedTime:null,n=e&&e.dataViewSource?e.dataViewSource.data:void 0,s=i&&i.error;return e&&e.dataReaderResult&&e.dataReaderResult.disallowPersisting&&(n=o=null,s=new u.IgnorableClientError("VisualContainerQueryHandler.updateContractCache() cachingError")),this.conceptualSchemaProxy.get(t).then((function(t){return i.options.then((function(e){e={transforms:i.transforms,error:s,warnings:i.warnings,options:e,compiledMappings:i.compiledMappings};r.cachedData=h.createCacheEntry(a.visualPlugin,a.displayNameService,n,e,t,r.config.singleVisual,a.featureSwitchService.featureSwitches,l(r.filters),o)}))}))},f.prototype.getLastRefreshTime=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.dsr&&i.dsr.lastRefreshTime)return i.dsr.lastRefreshTime}},f.prototype.processQueryResult=function(t,r,i,a){var e,o,n=this;r&&(o={updateContractCache:null==(e=t.cacheResponseOnContract)||e,updateServerCache:r.updateServerVisualContainerCache},this.resolveResourcePackageReferences(t.contract.config.singleVisual.visualType,r.dataProxyQuery.transforms.objects,i&&i.rootActivity).then((function(e){n.handleQueryResult(t.contract,r&&r.result,r.dataProxyQuery,e,o,t.currentData,!1,i,a)})))},f.prototype.isResultStale=function(e,t){e=r.tryDeserializeDate(e),t=r.parseIsoDate(t);return!(!e||!t)&&t<e},f.prototype.getDatasetCacheOptions=function(e,t,r){var i=e.contract.id,a=e.initialLoad,i=this.visualLifecycleService&&this.visualLifecycleService.has(i,r);if(this.featureSwitchService.featureSwitches.expandQueryCaching){if(this.isQueryCachingEnabledForAnyDataset(t))return this.cachePolicyProviderService.getInteractiveQueryPolicy(a&&i,e.interactiveQueryCachingSetting)}else if(a&&i&&this.isQueryCachingEnabledForAnyDataset(t))return g.AllowCache|g.AllowQuery|g.CacheResult},f.prototype.isQueryCachingEnabledForAnyDataset=function(e){return!!_.some(e,(function(e){return e.dsr&&e.dsr.isQueryCachingEnabled}))},f.prototype.handleQueryResult=function(t,e,r,i,a,o,n,s,l){var p,u,c,d,m=this;void 0===a&&(a={}),void 0===n&&(n=!1),this.queryExecutionServices.clearErrors(),e?(u={dataView:e.dataReaderResult?e.dataReaderResult.dataView:null,dataViewSource:e.dataViewSource||null,performanceActivities:e.dataReaderResult?e.dataReaderResult.performanceActivities:null},c=f.getDataProxyQueryExecutionResultWarnings(e,r)||[],l&&(c=_.concat(c,l)),_.isEmpty(c)||(u.warnings=c),(d=h.isSegment(u.dataView))&&(u.isFirstSegment=d),null!=(d=null==(d=this.featureSwitchService)?void 0:d.featureSwitches)&&d.queryContext&&(p=null==(d=e.dataReaderResult)?void 0:d.queryContext)&&(u.queryContext=p)):(u={dataView:o&&o.dataView,dataViewSource:o&&o.dataViewSource,isFirstSegment:o&&o.isFirstSegment},c=o&&o.warnings||[],l&&(c=_.concat(c,l)),_.isEmpty(c)||(u.warnings=c),null!=(l=null==(d=this.featureSwitchService)?void 0:d.featureSwitches)&&l.queryContext&&(p=null==o?void 0:o.queryContext)&&(u.queryContext=p)),this.queryExecutionServices.handleWarnings(c,r&&r.transforms),this.queryExecutionServices.applyUpdate(u,r.transforms,i,s,n),a&&a.updateContractCache&&(d=e&&e.dataViewSource?e.dataViewSource.data:void 0,l=this.updateContractCache(t,d,r),a.updateServerCache&&l.then((function(){r.options.then((function(e){_.isEmpty(e.query.command)||(e={visualContainerId:t.id,query:JSON.stringify(e.query.command),dataTransforms:m.getCachedTransformsString(t)},m.eventBridge.publishToChannel(v.events.newQueryCacheResultAvailable,e))}))})))},f.prototype.handleLoadMoreDataWarnings=function(e,t){this.queryExecutionServices.clearErrors();e=f.getDataProxyQueryExecutionResultWarnings(e,t)||[];this.queryExecutionServices.handleWarnings(e,t&&t.transforms)},f.prototype.getCachedTransformsString=function(e){e=e.cachedData;if(e){e=e.transformsObject;if(e)return n.serializeTransformActions(e)}},f.prototype.loadResourcePackageReferences=function(e,t){var r=this,e=this.visualPlugin.capabilities(e),e=e&&e.objects,i=this.explorationNavigation.getCurrentExploration();return i||p.hasResourceReferencesToResolve(t,e),p.loadFromDataViewObjects(t,e,(function(){return i?i.resourcePackages:null}),this.resourceLoader,this.promiseFactory,(function(e,t){return r.ensureSharedResource(i,e,t)}))},f.prototype.ensureSharedResource=function(e,t,r){this.resourceRegistration&&(e=i.ensureResourcePackageType(e,2),d.findItemInPackage(e,t)||this.resourceRegistration.add(t,2,r))},f.prototype.resolveResourcePackageReferences=function(e,t,r){var e=this.visualPlugin.capabilities(e),e=e&&e.objects,i=this.explorationNavigation.getCurrentExploration();return i||p.hasResourceReferencesToResolve(t,e),p.loadAndResolveFromDataViewObjects(t,e,i?i.resourcePackages:null,this.resourceLoader,this.promiseFactory,void 0,r)},f.getDataProxyQueryExecutionResultWarnings=function(e,t){var r;return t&&!_.isEmpty(t.warnings)&&(r=r||[]).push.apply(r,t.warnings||[]),e&&e.dataReaderResult&&!_.isEmpty(e.dataReaderResult.warnings)&&(r=r||[]).push.apply(r,e.dataReaderResult.warnings||[]),r},E=f,v.VisualContainerQueryHandler=E})(powerbi=powerbi||{}),(function(e){var t,d,m,v;function g(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];if(_.some(i.filter.where(),(function(e){return 3===d.runDetector(e.condition)})))return!0}return!1}t=(t=e.explore||(e.explore={})).services||(t.services={}),d=e.data.FilterKindDetector,m=e.data.SemanticFilter,v=e.data.SubqueryRewriter,(t.FilterPrecedenceResolver||(t.FilterPrecedenceResolver={})).resolve=function(e){if(g(e.sectionFilters),g(e.reportFilters),_.isEmpty(e.visualFilters))return e.visualFilters;for(var t=!1,r=[],i=0,a=e.visualFilters;i<a.length;i++){var o=(p=a[i]).filter.where().filter((function(e){return 0===d.runDetector(e.condition)})),t=t||g([p]);r.push.apply(r,o.map((function(e){return m.fromSQExpr(e.condition)})))}if(!t)return e.visualFilters;for(var n=[],s=0,l=e.visualFilters;s<l.length;s++){var p,u,c=p=l[s];g([p])&&(u=p.filter,_.isEmpty(r)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,r)),_.isEmpty(e.crossFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.crossFilters.map((function(e){return e.filter})))),_.isEmpty(e.sectionFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.sectionFilters.map((function(e){return e.filter})))),_.isEmpty(e.drillThroughFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.drillThroughFilters.map((function(e){return e.filter})))),c={filter:u=_.isEmpty(e.reportFilters)?u:v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.reportFilters.map((function(e){return e.filter})))}),n.push(c)}return n}})(powerbi=powerbi||{}),(function(n){var e;(function(e){var t=n.data.FilterKindDetector,i=n.data.SQScopedEvalExpr;function r(e){this.options=e}r.prototype.resolveSemanticQuery=function(e){return e?e.where(this.resolveFilters(e.where()),e.from()):null},r.prototype.resolveFilters=function(e){var t=this;return e?_.map(e,(function(e){return t.resolveFilter(e)})):null},r.prototype.resolveFilter=function(e){if(!e)return null;if(e.target)return e;if(e.condition)switch(t.runDetector(e.condition)){case 0:return this.resolveColumnFilter(e);case 2:return this.resolveExistsFilter(e);case 1:return this.resolveMeasureFilter(e);case 3:return this.resolveSubqueryFilter(e);default:return}},r.prototype.resolveColumnFilter=function(e){return{condition:e.condition,annotations:e.annotations}},r.prototype.resolveMeasureFilter=function(e){var t,r,i=this,a=null,o=((a=this.options.mappings&&this.options.mappings.measureFilter?this.options.mappings.measureFilter.targetRoles:a)&&_.some(a,(function(e){return i.options.queryProjections[e]}))||(a=this.getDefaultMeasureFilterTargetRoles()),e.condition);if(a){for(var n=0,s=a;n<s.length;n++){var l=s[n],l=this.options.queryProjections[l];if(l)for(var p=0,u=l.all();p<u.length;p++){var c=u[p],d=this.options.select.filter((function(e){return e.name===c.queryRef})),m=(_.isEmpty(d)||d.length,d[0].expr),d=d[0].name,v=m.getMetadata(this.options.schema),g=t&&t[d];v&&1!==v.kind&&!g&&(r||(r=[],t={}),r.push(m),t[d]=!0)}}o=h.rewrite(o,a)}return{target:r,condition:o,annotations:e.annotations}},r.prototype.resolveExistsFilter=function(e){return e.target,e},r.prototype.resolveSubqueryFilter=function(e){return{condition:e.condition,annotations:e.annotations}},r.prototype.getDefaultMeasureFilterTargetRoles=function(){return(this.options.dataRoles?this.options.dataRoles.filter((function(e){return e.kind===n.VisualDataRoleKind.Grouping||e.kind===n.VisualDataRoleKind.GroupingOrMeasure})):[]).map((function(e){return e.name}))},e.VisualFilterMappingResolver=r;a=n.data.SQExprRewriter,__extends(o,a),o.rewrite=function(e,t){t=new o(t);return e.accept(t)},o.prototype.visitScopedEval=function(e){var t=this,r=_.filter(e.scope,(function(e){return!n.data.SQExpr.isRoleRef(e)||_.includes(t.filterTargetRoles,e.role)}));return r.length===e.scope.length?e:new i(e.expression,r)};var a,h=o;function o(e){var t=a.call(this)||this;return t.filterTargetRoles=e,t}})((e=n.explore||(n.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(c){var a,n,r,i,o,s,l,d;function e(e,t,r,i,a,o,n,s,l,p,u,c){this.telemetryService=e,this.eventBridge=t,this.explorationNavigation=r,this.dataSourcesService=i,this.conceptualSchemaProxy=a,this.globalEventBridge=o,this.visualTimeSynchronizationService=n,this.notificationBarService=s,this.localizationService=l,this.errorService=p,this.reportRefreshCacheService=u,this.reportRefreshConfigProxy=c,this.visualsLoaded=!1,this.timerExpired=!1,this.isRunning=!1,this.refreshDelayedCount=0,this.refreshPaused=!1,this.subscriptionManager=t.createChannelSubscriptionManager()}a=c.explore||(c.explore={}),n=a.services||(a.services={}),r=c.explore.contracts.AutoPageRefreshOption,i=c.common.constants.MaxInt32,o=c.common.events.reportRefreshStateChanged,s=c.explore.util,n.AutoPageRefreshErrorId="apr_error_notification_bar",n.createReportRefreshService=function(e,t,r,i,a,o,n,s,l,p,u,c){return new d(e,t,r,i,a,o,n,s,l,p,u,c)},l={autoRefreshEnabled:!0,refreshIntervalSeconds:1},e.prototype.subscribeEvents=function(){var e=this;null==this.subscriptionManager&&(this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager()),this.subscriptionManager.subscribe(n.events.sectionChanged,(function(){return e.onSectionChanged()})).subscribe(c.common.events.printSectionReady,(function(){return e.onVisualsLoaded()})).subscribe(n.events.sectionObjectsEvaluated,(function(){return e.onSectionsObjectsEvaluated()})).subscribe(n.events.modelChanged,(function(){return e.onModelChanged()}))},e.prototype.init=function(t){return void 0===t&&(t=!0),__awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.triggerNotifications=t,[4,this.loadPageSettings()];case 1:return e.sent(),[4,this.updateRefreshState()];case 2:return e.sent(),this.subscribeEvents(),[2]}}))}))},e.prototype.destroy=function(){var e;this.stopRefresh(),null!=(e=this.subscriptionManager)&&e.unsubscribeAll(),this.subscriptionManager=void 0},e.prototype.refreshData=function(){this.reportRefreshCacheService.tryClearDSRCache()&&this.eventBridge.publishToChannel(n.events.visualContainerChanged,{affectContainer:function(){return!0}})},e.prototype.setRefreshPaused=function(e){this.refreshPaused=e},e.prototype.getRefreshStats=function(){return{adminConfig:this.adminConfig,effectiveRefreshInterval:this.effectiveRefreshInterval,lastRefreshTimestamp:this.lastUpdateDate?this.lastUpdateDate.toLocaleTimeString():void 0}},e.prototype.loadAdminSettings=function(){var a;return __awaiter(this,void 0,c.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:if(!e.sent())return[2];if(!this.reportRefreshConfigProxy)return this.adminConfig=l,[2];t=null==(a=null==(a=this.explorationNavigation.getCurrentExploration())?void 0:a.report)?void 0:a.modelId,e.label=2;case 2:return e.trys.push([2,4,,5]),[4,(r=this).reportRefreshConfigProxy.getAPRConfig(t)];case 3:return r.adminConfig=e.sent(),[3,5];case 4:return i=e.sent(),this.telemetryService.logEvent(c.telemetry.EXGetAPRConfigFailure,{modelId:t}),this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_GetAdminConfigErrorTryAgain"),!0,i,"FailedToGetAPRAdminConfig"),this.adminConfig=void 0,[2];case 5:return this.adminConfig?this.adminConfig.autoRefreshEnabled||this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_AdminDisabled")):this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_GetAdminConfigErrorTryAgain"),!0),[2]}}))}))},e.prototype.loadPageSettings=function(){return __awaiter(this,void 0,c.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return r=this.explorationNavigation.getCurrentSection(),[4,this.isAPREnabledInSection(r)];case 1:return e.sent()?(t=this.refreshIntervalInMilliseconds,i=s.DurationParser.parseISODurationdString(r.evaluatedObjects.pageRefresh.duration||a.constants.ExploreCanvasConstants.DefaultTimeInterval),this.refreshIntervalInMilliseconds=s.DurationParser.durationParseResultAsMilliseconds(i)):this.refreshIntervalInMilliseconds=void 0,[2,this.refreshIntervalInMilliseconds!==t]}}))}))},e.prototype.onSectionsObjectsEvaluated=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.loadPageSettings()];case 1:return t=e.sent(),this.refreshIntervalInMilliseconds&&t?this.updateRefreshState():!this.refreshIntervalInMilliseconds&&this.isRunning&&this.stopRefresh(),[2]}}))}))},e.prototype.onModelChanged=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getRefreshInterval()];case 1:return(t=e.sent())&&!this.isRunning?this.updateRefreshState():!t&&this.isRunning&&this.stopRefresh(),[2]}}))}))},e.prototype.getRefreshInterval=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:return e.sent()?this.refreshIntervalInMilliseconds&&this.adminConfig&&this.adminConfig.autoRefreshEnabled?(t=_.max([this.refreshIntervalInMilliseconds,1e3*this.adminConfig.refreshIntervalSeconds]),[2,_.min([i,t])]):[2]:[2,null]}}))}))},e.prototype.isPageRefreshSupported=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return t=e.sent(),[3,3];case 2:return e.sent(),[2,!1];case 3:return[2,_.some(t.schemas,(function(e){return e.capabilities&&e.capabilities.supportsFastRefresh}))]}}))}))},e.prototype.updateRefreshState=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.stopRefresh(),this.isRunning=!0,this.adminConfig||null==this.refreshIntervalInMilliseconds?[3,2]:[4,this.loadAdminSettings()];case 1:e.sent(),e.label=2;case 2:return[4,this.getRefreshInterval()];case 3:return null!=(t=e.sent())?this.runTimer(t):this.isRunning=!1,[2]}}))}))},e.prototype.triggerRefreshUponSectionChange=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=this.explorationNavigation.getCurrentSection(),[4,this.isAPREnabledInSection(t)];case 1:return e.sent()&&this.triggerRefresh(),[2]}}))}))},e.prototype.onSectionChanged=function(){return __awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.triggerRefreshUponSectionChange()];case 1:return e.sent(),this.lastUpdateDate=void 0,[4,this.loadPageSettings()];case 2:return e.sent(),[4,this.updateRefreshState()];case 3:return e.sent(),[2]}}))}))},e.prototype.onVisualsLoaded=function(){this.visualsLoaded=!0,this.timerExpired&&this.isRunning&&this.onTimerExpired()},e.prototype.stopRefresh=function(){this.nextUpdateDate=void 0,this.isRunning=!1,this.timerExpired=!1,this.clearTimeoutAndAnimationFrame(),this.notifyReportRefreshStateChanged(),this.notificationBarService.hide(n.AutoPageRefreshErrorId)},e.prototype.clearTimeoutAndAnimationFrame=function(){clearTimeout(this.timeoutId),this.timeoutId=void 0,cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0},e.prototype.runTimer=function(e){var t=this;this.clearTimeoutAndAnimationFrame(),this.nextUpdateDate=new Date(Date.now()+e),this.notifyReportRefreshStateChanged(),this.timeoutId=setTimeout((function(){t.timeoutId=void 0,t.animationFrameId=requestAnimationFrame((function(){t.animationFrameId=void 0,t.onTimerTriggered()}))}),e)},e.prototype.onTimerTriggered=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.timerExpired=!0,this.visualsLoaded?this.onTimerExpired():this.refreshDelayedCount+=1,[4,this.loadAdminSettings()];case 1:return e.sent(),[4,this.getRefreshInterval()];case 2:return null!=(t=e.sent())?this.runTimer(t):this.stopRefresh(),[2]}}))}))},e.prototype.triggerRefresh=function(){var e=this.explorationNavigation.getCurrentSection();this.reportRefreshCacheService.clearClientCache(e),this.visualTimeSynchronizationService.setAnchorTimeToNow(),this.eventBridge.publishToChannel(n.events.dataRefreshTriggered)},e.prototype.calculateEffectiveInterval=function(){this.effectiveRefreshInterval=this.lastUpdateDate?(new Date).getTime()-this.lastUpdateDate.getTime():void 0},e.prototype.onTimerExpired=function(){this.refreshPaused||(this.logTriggerRefresh(this.refreshDelayedCount),this.calculateEffectiveInterval(),this.lastUpdateDate=new Date,this.triggerRefresh(),this.timerExpired=!1,this.visualsLoaded=!1,this.refreshDelayedCount=0,this.notifyReportRefreshStateChanged())},e.prototype.logTriggerRefresh=function(u){return __awaiter(this,void 0,c.Promise,(function(){var t,r,i,a,o,n,s,l,p;return __generator(this,(function(e){switch(e.label){case 0:return t=this.explorationNavigation.getCurrentSection(),l=this.explorationNavigation.getCurrentExploration().report,r=this.explorationNavigation.getExplorationTelemetryData(),a=-1,o=i="",s=n="-1",l&&l.model&&(p=l.model,i=p.dbName,o=l.objectId,a=p.id),l=t.objectId,[4,this.getRefreshInterval()];case 1:return p=e.sent(),r&&(n=r.exid,s=r.exsid),this.telemetryService.logEvent(c.telemetry.TriggerRefresh,{reportId:o,pageId:l,dbName:i,modelId:a,interval:p,delayCount:u,exid:n,exsid:s}),[2]}}))}))},e.prototype.notifyReportRefreshStateChanged=function(){var e,t;this.triggerNotifications&&(e=void 0,(t=this.explorationNavigation.getCurrentExploration().report)&&(e=t.objectId),this.globalEventBridge.publishToChannel(o,{reportId:e,nextUpdateDate:this.nextUpdateDate,lastUpdateDate:this.lastUpdateDate}))},e.prototype.sendNotification=function(e,t,r,i){var a=this,o=(void 0===t&&(t=!1),{id:n.AutoPageRefreshErrorId,message:e,notificationType:1,actions:[]});r&&(o.secondaryLink={action:function(){a.errorService.error(e,i,{requestId:r.requestId,statusCode:r.status&&r.status.toString()})},displayText:this.localizationService.get("Generic_ShowDetails")}),t&&o.actions.push({action:function(){a.notificationBarService.hide(n.AutoPageRefreshErrorId),a.updateRefreshState()},displayText:this.localizationService.get("TryAgain")}),this.notificationBarService.notify(o)},e.prototype.isAPREnabledInSection=function(t){return __awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:return e.sent()?[2,t&&t.evaluatedObjects&&t.evaluatedObjects.pageRefresh&&t.evaluatedObjects.pageRefresh.show&&(null==t.evaluatedObjects.pageRefresh.refreshType||t.evaluatedObjects.pageRefresh.refreshType===r.APR)]:[2,!1]}}))}))},d=e})(powerbi=powerbi||{}),(function(S){var e,b,E,v,r,N,V,P,w;function g(e,t){switch(e){case r.Forecast.name:return t.some((function(e){return S.DataViewMapping.isForecastDefined(e)}));case r.SampleAndDetectAnomaly.name:return t.some((function(e){return S.DataViewMapping.isAnomalyDefined(e)}));default:return 1}}e=(e=S.explore||(S.explore={})).TransformGeneratorUtils||(e.TransformGeneratorUtils={}),b=S.visuals.AnomalyDetectionTransformConstants,E=S.data.CompiledDataViewMapping,v=S.data.DataViewObjectDefinitions,r=S.data.transforms.plugins,N=S.data.SQExpr,V=S.data.SQExprBuilder,P=S.data.SQExprUtils,w=jsCommon.StringExtensions,e.addTransforms=function(a,e,n,t,r){if(!a)return n;function i(r){function e(t){var e;i.properties[t].type.queryTransform&&(e=_.filter(a[r],(function(e){var t=e,e=n;if(!t.selector||!_.isString(t.selector.metadata))return!0;var r=e.projections;if(r)for(var i in r){i=r[i];if(i){i=i.all();if(i)for(var a=0,o=i;a<o.length;a++)if(o[a].queryRef===t.selector.metadata)return!0}}return!1})),s.push.apply(s,_.map(e,(function(e){return{objectName:r,propertyName:t,object:e}}))))}var t,i=l[r];for(t in i.properties)e(t)}var o,s=[],l=r.objects;for(o in l)i(o);if(_.isEmpty(s))return n;for(var p=n.clone(),u=0,c=s;u<c.length;u++){var d,m=c[u],m=v.getValue(a,{objectName:m.objectName,propertyName:m.propertyName},m.object.selector);m&&g(m.algorithm,e)&&(d=t.getTransformPlugin(m.algorithm),p.addTransform(d,m.parameters,r))}return p},e.removeUnsupportedTransforms=function(e,t,r){var i=t.defn.transforms();if(_.isEmpty(i))return t;for(var a=t.clone(),o=0,n=i;o<n.length;o++){var s,l=n[o];g(l.algorithm,r)||(s=e.getTransformPlugin(l.algorithm),a.removeTransform(s,l.name))}return a},e.rewriteTransform=function(e,t,r,i,a,o,n){var s=t.transforms();if(_.isEmpty(s))return t;var l=t.select();if(_.isEmpty(l))return t;for(var p=(o=(function(e,n,s,l){for(var p=[],u=[],e=e.select(),t=0,r=e;t<r.length;t++)!(function(t){if(N.isTransformOutputRoleRef(t.expr))return p.push(t);var e=Object.keys(s),e=_.filter(e,(function(e){return _.includes(s[e],t.name)}));if(!_.isEmpty(e)){for(var r=!1,i=0,a=e;i<a.length;i++){var o=a[i];if(!n[o].activeProjectionRefs||_.includes(n[o].activeProjectionRefs,t.name)){p.push(t),r=!0;break}}return r||u.push(t)}_.isEmpty(l)||((e=_.find(l,(function(e){return e.queryName===t.name})))&&e.selector&&e.selector.data?p:u).push(t)})(r[t]);return{transformSelects:p,topLevelSelects:u}})(t,r,a,o)).transformSelects,o=o.topLevelSelects,u=[],c=0;c<s.length;c++){var d=s[c],m=e.getTransformPlugin(d.algorithm),v="input"+c,g="output"+c,d=(d.input.parameters=(function(e,t){t=_.find(t,(function(e){return S.DataViewMapping.isAnomalyDefined(e)}));{var r;t&&(t=t.categorical.dataReductionAlgorithm.binnedLineSample.warningCount,r=b.transformParameterSampleCountName,t&&!_.find(e,(function(e){return e.name===r}))&&e.push({name:r,expr:V.integer(t)}))}return e})(d.input.parameters,n),{algorithm:d.algorithm,name:d.name,input:{parameters:d.input.parameters,table:{name:v,columns:(function(e,l,p,u,t){var e=_.filter(e,(function(e){return!N.isTransformOutputRoleRef(e.expr)})),c=(function(e){for(var r,i,t=0,a=e;t<a.length;t++){var o=a[t];if(o.categorical&&(o=o.categorical.categories,_.isEmpty(o)||E.visitCategoricalCategories(o,{visitRole:function(e){var t=_.find(e.items,(function(e){return null==(e=e.scalarKeyInfo)?void 0:e.scalarKeyMinProperty}));t&&(r=e.role,i=t.scalarKeyInfo.scalarKeyQueryName)}})),r&&i)return{roleName:r,queryName:i}}})(t);return _.map(e,(function(e){var t=e,e=c,r=l,i=p,a=u,o=Object.keys(r),n=t.name===(null==e?void 0:e.queryName),s=n?e.roleName:_.find(o,(function(e){return _.includes(r[e],t.name)})),o=_.find(i,(function(e){return e.name===s})),i=!1;return{role:(i=null==e?null!=o:n||null!=s&&s!==e.roleName)?(function(t,e,r){e=_.find(e.inputRoles,(function(e){e=e.visualDataRoleMatching;return!e||(void 0===e.cartesianKind||e.cartesianKind===r.cartesianKind)&&((void 0===e.matchGrouping||e.matchGrouping!==P.isMeasure(t))&&((void 0===e.matchMeasure||e.matchMeasure===P.isMeasure(t))&&(!e.skipJoinPredicateNone||0!==r.joinPredicate)))}));if(e)return e.name})(t.expr,a,o):void 0,expression:t}}))})(p,a,i,m,n)}},output:{table:{name:g,columns:(function(e,s,l){for(var p={},t=0,r=e;t<r.length;t++){var i=r[t];N.isTransformOutputRoleRef(i.expr)||(p[i.name]=!0)}return _.map(e,(function(t){var e,r,i;if(N.isTransformOutputRoleRef(t.expr)){var a,o=void 0;for(a in l){var n=l[a].all();_.some(n,(function(e){return e.queryRef===t.name}))&&(o=a)}e=o,r=t.expr,i=w.findUniqueName(p,t.name)}else r=V.columnRef(V.transformTableRef(s),t.name),i=t.name;return{role:e,expression:{name:i,expr:r}}}))})(p,v,r)}}}),p=_.map(d.output.table.columns,(function(e){var t=V.columnRef(V.transformTableRef(g),e.expression.name);return{name:e.expression.name,expr:t}}));u.push(d)}var h,f=_.last(u),y=t.orderBy(),y=(f&&!_.isEmpty(y)&&(h=_.map(y,(function(t){var e=_.find(l,(function(e){return N.equals(e.expr,t.expr)})),e=V.columnRef(V.transformTableRef(f.output.table.name),e.name);return{direction:t.direction,expr:e}}))),t.transforms(u));if(!_.isEmpty(o))for(var C=0,x=o;C<x.length;C++)!(function(t){var e=_.findIndex(l,(function(e){return e.name===t.name}));p.splice(e,0,t)})(x[C]);return y=y.select(p),y=h?y.orderBy(h):y},e.prototypeQueryFromRunnableQuery=function(i,e){if(_.isEmpty(i.transforms())||_.isEmpty(i.select()))return i;var a=[];return _.map(i.select().slice(0,e),(function(e){var t,r;N.isColumn(e.expr)&&N.isTransformTableRef(e.expr.source)?(t=e.expr.source.source,(r=_.find(i.transforms(),(function(e){return(null==(e=e.output.table)?void 0:e.name)===t})))&&(r=(function(e,t){e.output.table;var r=_.find(e.output.table.columns,(function(e){return e.expression.name===t.ref}));if(r){var i=r.expression.expr;if(N.isColumn(i))return null==(e=_.find(null==(r=e.input.table)?void 0:r.columns,(function(e){return(null==(e=e.expression)?void 0:e.name)===i.ref})))?void 0:e.expression.expr}})(r,e.expr))&&!N.isTransformOutputRoleRef(r)&&a.push({name:e.name,expr:r})):a.push(e)})),i.createModified({select:a,transforms:null})}})(powerbi=powerbi||{}),(function(e){var t,r;(t=(t=e.explore||(e.explore={})).constants||(t.constants={})).invalidSortExprIndex=-1,t.DefaultSchemaName=e.data.dsr.DefaultSchemaName,t.ExplorationSchemaName="extension",t.DefaultDrillFilterOtherVisuals=!0,t.SectionComponentType="page",t.ExplorationComponentType="report",t.GroupComponentType="group",t.MinContainerWidth=12,t.MinContainerHeight=12,(r=t.ExploreCanvasConstants||(t.ExploreCanvasConstants={})).DefaultCanvasWidth=960,r.DefaultCanvasHeight=720,r.DefaultCanvasBackgroundColor="#FFFFFF",r.DefaultCanvasOutspaceColor="#EAEAEA",r.DefaultCanvasOutspaceTransparency=0,r.DefaultOutspacePaneTransparency=0,r.DefaultControlForegroundColor="#000000",r.DefaultControlBackgroundColor="#ffffff",r.DefaultOutspacePaneCheckboxAndApplyColor="#F2C811",r.DefaultOutspacePaneWidth=200,r.OutspacePaneCollapsedWidth=32,r.OutspacePaneMinWidth=180,r.OutspacePaneMaxWidth=420,r.DefaultOutspacePaneBorder=!0,r.DefaultOutspacePaneBorderColor="#C8C8C8",r.DefaultOutspacePaneTitleSizePt=12,r.DefaultOutspaceSearchTextSizePt=10,r.DefaultOutspacePaneHeaderSizePt=9,r.DefaultOutspacePaneFontFamily="'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",r.DefaultAppliedFilterCardTransparency=0,r.DefaultAvailableFilterCardTransparency=0,r.DefaultFilterCardBorder=!0,r.DefaultFilterCardBorderColor="#C8C8C8",r.DefaultFilterCardTextSizePt=9,r.Available="Available",r.Applied="Applied",r.FilterCardSearchBoxBorderColor="#C8C6C4",r.FilterCardSearchBoxBackgroundColor="#FFFFFF",r.FilterCardFontColor="#252423",r.DefaultCanvasBackgroundTransparency=0,r.DefaultWidescreenWidth=1280,r.DefaultWidescreenHeight=720,r.DefaultCortanaWidth=296,r.DefaultCortanaHeight=592,r.DefaultLetterWidth=816,r.DefaultLetterHeight=1056,r.DefaultTooltipWidth=320,r.DefaultTooltipHeight=240,r.CanvasGutterSize=10,r.MobileFooterHeight=60,r.DefaultTimeInterval="PT30M",r.getDefaultCanvasBackground=function(){return{color:r.DefaultCanvasBackgroundColor,transparency:r.DefaultCanvasBackgroundTransparency}},r.getDefaultCanvasOutspace=function(){return{color:r.DefaultCanvasOutspaceColor,transparency:r.DefaultCanvasOutspaceTransparency}}})(powerbi=powerbi||{}),(function(h){!(function(e){var t=h.data,c=t.FieldExprPattern,v=t.SQExpr,g=jsCommon.StringExtensions,d=h.data.SQExprConverter,u=t.SQExprUtils,m=h.explore.util.VisualContainerUtils;function a(){}a.getApplyStateInfoForInternallDrillthrough=function(e,t,r,i){void 0===r&&(r=!0);i={skipUnmatchedDrillthroughFilters:!1,filterMatchingBehavior:i=void 0===i?0:i},i=a.getFiltersState(e,i,t);return{state:{activeSection:r?e.name:void 0,sections:((t={})[e.name]={filters:i},t)},options:{clearUnmatchedData:!1,suppressDataSourceVariables:!0,suppressActiveSection:!r}}},a.getFiltersState=function(e,i,t){var a=[],o=t?__spreadArray([],t||[]):[],n={},s=i.filterMatchingBehavior;if(!_.isEmpty(e.filters))for(var r=0,l=e.filters;r<l.length;r++)!(function(t){if(5!==t.howCreated||t.isTransient)return;t.expression;var e=_.find(o,(function(e){return(1===s||!e.isTransient)&&e.filterExpressionMetadata&&1===e.filterExpressionMetadata.expressions.length&&v.equals(e.filterExpressionMetadata.expressions[0],t.expression)})),r=h.explore.services.convertToFilterContainerState(t);if(e)_.remove(o,e),r.filter=e.filter,r.cachedValueItems=void 0;else{if(i.skipUnmatchedDrillthroughFilters)return;r.filter=void 0,r.cachedValueItems=void 0}a.push(r),n[t.name]=!0})(l[r]);t={exprIdentifiedMerges:a};if(0===s&&_.some(o,(function(e){return e.isTransient}))||1===s&&!_.isEmpty(o)){for(var p=[],u=0,c=o;u<c.length;u++){var d=c[u],m=(1!==s&&d.isTransient,g.findUniqueName(n,"transientFilter")),m=(n[m]=!0,{name:m,expression:_.isEmpty(d.filterExpressionMetadata)||1!==d.filterExpressionMetadata.expressions.length?void 0:d.filterExpressionMetadata.expressions[0],type:d.type,restatement:d.restatement,filter:d.filter,howCreated:5,isTransient:!0,displayName:d.displayName});p.push(m)}t.transientFilters=p}return t},a.getMatchedLinkFieldsFromParameters=function(e,t,r,i){e=_.map(e,(function(e){e={fieldExpr:e.fieldExpr,asAggregation:e.asAggregation};return null!=e.fieldExpr&&v.isMeasure(e.fieldExpr)&&e.asAggregation,null==e.asAggregation&&e.fieldExpr&&v.isMeasure(e.fieldExpr)&&(e.asAggregation=!1),e}));if(!_.isEmpty(e))return this.getMatchedLinkFields(e,t,r,i)},a.getMatchedLinkFields=function(e,n,s,l){for(var p=[],t=0,r=e;t<r.length;t++)!(function(e){var t=e.fieldExpr;if(!t)return;if(v.isMeasure(t)||v.isColumn(t)||v.isGroupRef(t)||v.isHierarchyLevel(t),v.isMeasure(t))e.asAggregation,_.find(s,(function(e){return v.isMeasure(e)&&v.equals(e,t)}))&&p.push(e);else{var r=t.getKeyColumns(l);if(!_.isEmpty(r))if(e.asAggregation)for(var i=0,a=s;i<a.length;i++){var o=a[i];if(v.isAggregation(o)){o=o.arg.getKeyColumns(l);if(u.isSubset(r,o)){p.push(e);break}}}else u.isSubset(r,n)&&p.push(e)}})(r[t]);return p},a.getMeasuresFromSelectors=function(e,t,r){for(var i=[],a=m.getVisualQuery(t),o=0,n=e;o<n.length;o++){var s=n[o];if(s.metadata)for(var l=0,p=s.metadata;l<p.length;l++){var u=p[l],u=a.defn.select().withName(u);u&&u.expr&&(u=d.asFieldPattern(u.expr,r),u=c.getBaseSQExpr(u,r),i.push(u))}}return i},a.hasMeasureOrAsAggregationPodParameter=function(e,t){return(1===e||2===e)&&_.some(t,(function(e){return e.asAggregation||e.fieldExpr&&v.isMeasure(e.fieldExpr)}))},e.DrillthroughUtils=a})(h.explore||(h.explore={}))})(powerbi=powerbi||{}),(function(e){var t,r,i,a,o,n,s;function l(e){var t=r.call(this)||this;return t.schema=e,t}t=(t=e.explore||(e.explore={})).util||(t.util={}),i=e.data.SQEntityExpr,a=e.data.SQExprRewriter,o=e.data.SQHierarchyExpr,n=e.data.SQHierarchyLevelExpr,s=e.data.SQPropertyVariationSourceExpr,__extends(l,r=a),l.prototype.visitEntity=function(e){var t=this.getVariationMapping(e);return t?new i(e.schema,t.sourceEntity.name):e},l.prototype.visitColumnRef=function(t){var e=t.source.accept(this);if(e!==t.source){var r=this.getVariationMapping(t.source);if(r){var i=_.find(r.variation.defaultHierarchy.levels,(function(e){return e.column.name===t.ref}));if(i)return new n(new o(new s(e,r.variation.name,r.sourceProperty.name),r.variation.defaultHierarchy.name),i.name)}}return t},l.prototype.getVariationMapping=function(e){e=this.schema.schema(e.schema).findVariationToHierarchyMappings(e.entity);if(e)return _.last(e)},a=l,t.VariationToHierarchyRewriter=a})(powerbi=powerbi||{}),(function(a){var f,e,y,C,x,l;function t(e,t,r,i,a,o,n,s){this.state=e,this.navigation=t,this.eventBridge=r,this.visibility=i,this.filterGenerator=a,this.explorationActivity=o,this.telemetryService=n,this.runningVisualService=s}f=a.explore||(a.explore={}),e=f.services||(f.services={}),y=a.explore,C=y.services.events,x=C.explorationFiltersContainerChanged,e.createExplorationStateManagerService=function(e,t,r,i,a,o,n,s){return new l(e,t,r,i,a,o,n,s)},t.prototype.exploration=function(){return this.navigation.getCurrentExploration()},t.prototype.capture=function(e,t){var r=this.exploration();if(r)return this.state.capture(r,e,t)},t.prototype.apply=function(e,t,r){var i=this.exploration(),e=this.state.apply(e,i,t,r);return this.applyImpact(e,i,r),e},t.prototype.captureFilterState=function(e){return this.state.captureFilterState(e)},t.prototype.applyFilterState=function(e,t){var r,i=this;_.isEmpty(e)||(r=this.state.applyFilterState(e,t),this.explorationActivity.doActivity((function(e){i.eventBridge.publishToChannel(C.visualContainerChanged,{affectContainer:function(e){return _.includes(r.visualContainers,e)},parentActivity:e})}),(function(e){return i.telemetryService.startChildActivity(e&&e.event,a.telemetry.EXExplorationStateApplyImpact)})))},t.prototype.applyImpact=function(m,v,g){var h=this;this.explorationActivity.doActivity((function(e){var t=m.dataSourceVariables,r=[],i=(t&&g.suppressDataSourceVariables,m.objects&&h.eventBridge.publishToChannel(C.explorationObjectsChanged),2===m.filterScope&&(g.suppressData,h.eventBridge.publishToChannel(x,{container:v}),t=!0),m.activeSection?(g.suppressActiveSection,h.navigation.updateActiveSection({targetSectionIndex:v.activeSectionIndex,forceUpdate:!0,parentActivity:e})):1===m.filterScope?(g.suppressData,s=h.navigation.getCurrentSection(),h.eventBridge.publishToChannel(y.services.events.sectionFiltersContainerChanged,{container:s}),r=_.union(r,s.visualContainers)):0!==m.filterScope&&_.isEmpty(m.visualContainers)||(g.suppressData&&g.suppressDisplay,r=_.union(r,m.visualContainers)),[]),a=(t?(h.eventBridge.publishToChannel(C.visualContainerChanged,{affectContainer:_.stubTrue,parentActivity:e}),s=h.navigation.getCurrentSection(),i.push.apply(i,s.visualContainers||[])):_.isEmpty(r)||(h.eventBridge.publishToChannel(C.visualContainerChanged,{affectContainer:function(e){return _.includes(r,e)},parentActivity:e}),i.push.apply(i,r||[])),m.visualContainerGroups);if(_.isEmpty(a)||(h.eventBridge.publishToChannel(C.visualContainerGroupChanged,{affectContainer:function(e){return _.includes(a,e)}}),i.push.apply(i,a||[])),g.suppressDisplay||(m.visibility?h.visibility.set(m.visibility.visual,m.visibility.mode):g.targetVisualNames?(o=v.sections[v.activeSectionIndex],n=_.filter(o.visualContainers,(function(e){return _.includes(g.targetVisualNames,e.name)})),h.visibility.clearForVisualContainers(n)):h.visibility.clear(),_.isEmpty(i)||h.eventBridge.publishToChannel(C.canvasItemHiddenChanged,{changedItems:i})),!g.suppressData){var o,n,t=m.pendingHighlights,s=h.navigation.getCurrentSection();if(t){h.filterGenerator.setMultipleFiltersOnSelectData(v,s,t,e,void 0);for(var l=0,p=t;l<p.length;l++){var u=p[l],c=u.sourceVisualContainer,d=h.runningVisualService.getVisual(c),c=c.config.singleVisual;d?(u.filterExpressionMetadata&&f.FilterExpressionMetadataUtils.hydrateSelectorsByColumnWithValueDetails(u.selection,u.filterExpressionMetadata),d.setSelectedDatapoints(u.selection,!0)):c.pendingSelection=u.selection}}else g.targetVisualNames?(o=v.sections[v.activeSectionIndex],n=_.filter(o.visualContainers,(function(e){return _.includes(g.targetVisualNames,e.name)})),h.filterGenerator.clearCrossHighlightForVisualContainers(o,n,e,void 0)):h.filterGenerator.clearCrossHighlight(s,e,void 0)}}),(function(e){return h.telemetryService.startChildActivity(e&&e.event,a.telemetry.EXExplorationStateApplyImpact)}))},l=t})(powerbi=powerbi||{}),(function(d){var e,g,t,h,c,f,m,y,v,r,C,l,x,S,o,a,b,E,N,V,P,u,w,T,i,n;function F(e,t,r){if(!_.isEmpty(e)){for(var i,a={},o=0,n=e;o<n.length;o++){var s=n[o];r(s)||(s.isTransient?(a.transientFilters||(a.transientFilters=[]),a.transientFilters.push(p(s))):A(s)&&!_.isEmpty(s.name)?(a.nameIdentifiedMerges||(a.nameIdentifiedMerges={}),a.nameIdentifiedMerges[s.name]=p(s)):s.expression?(a.exprIdentifiedMerges||(a.exprIdentifiedMerges=[]),a.exprIdentifiedMerges.push(p(s))):3===(i=s).howCreated||4===i.howCreated?(a.typeIdentifiedMerges||(a.typeIdentifiedMerges=[]),a.typeIdentifiedMerges.push(p(s))):(_.isEmpty(s.name)&&(s.name=l.getNextFilterName(e)),a.nameIdentifiedMerges||(a.nameIdentifiedMerges={}),a.nameIdentifiedMerges[s.name]=p(s)))}if(!_.isEmpty(a))return a}}function p(e){return{name:e.name,type:e.type,filter:e.filter,expression:e.expression,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedValueItems:e.cachedValueItems,filterExpressionMetadata:_.cloneDeep(e.filterExpressionMetadata)}}function j(e){return name,{name:e.name,type:e.type,filter:e.filter,expression:e.expression,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedValueItems:e.cachedValueItems,filterExpressionMetadata:_.cloneDeep(e.filterExpressionMetadata),displayName:e.displayName}}function R(e,t){e.filter=t.filter,e.cachedValueItems=t.cachedValueItems,e.filterExpressionMetadata=_.cloneDeep(t.filterExpressionMetadata),e.type=t.type}function D(e){e.filter=void 0,e.cachedValueItems=void 0,e.filterExpressionMetadata=void 0}function A(e){return e.isHiddenInViewMode||e.isLockedInViewMode}function s(e,t,r){if(t.filterState)return!0;t=m.findFilterOutput(r);return _.some([t],e)}function k(e){return _.some([{objectName:"outspacePane",propertyName:"expanded"},{objectName:"outspacePane",propertyName:"visible"}],e)}function I(e,t,r,i,a,o,n,s,l,p,u){this.expandCollapse=e,this.filterGenerator=t,this.plugins=r,this.visualPluginOps=i,this.aggrOps=a,this.featureSwitchService=o,this.sortService=n,this.drillService=s,this.telemetryService=u,this.nonDrillthroughIsLinkedAsAggregationCallback=function(e){return e.howCreated,!1},this.visualAuthoringCore=c(r,l,a,o,p)}function O(e,t){var r=this;return(r=i.call(this)||this).valid=!0,r.query=e,r.schema=t,r}e=(e=d.explore||(d.explore={})).services||(e.services={}),g=d.data,t=d.explore,h=jsCommon.ArrayExtensions,c=d.explore.services.createVisualAuthoringCore,f=d.data.DataViewObjectDefinitions,m=d.data.DataViewObjectDescriptors,y=d.DataViewObjectProperty,v=g.DataViewTransform,r=d.explore.contracts.ExplorationObjectDescriptors,C=t.contracts,l=t.FilterUtils,x=t.PodUtils,S=g.ProjectionUtils,o=g.QueryProjectionCollection,a=d.data.dsr.SelectToIdentityExpressionsVisitor,b=d.data.SemanticFilter,E=d.data.SemanticQuery,N=d.data.SQExpr,V=d.explore.contracts.VisualContainer,P=t.util.VisualContainerUtils,u=t.util.PresentationUtils,w=d.explore.contracts.VisualQuery,e.createExplorationStateService=function(e,t,r,i,a,o,n,s,l,p,u){return new T(e,t,r,i,a,o,n,s,l,p,u)},e.convertToFilterContainerState=p,I.prototype.capture=function(e,t,r){e.activeSectionIndex;var i=e.sections[e.activeSectionIndex],a={activeSection:i.name,filters:F(e.filters,0,this.nonDrillthroughIsLinkedAsAggregationCallback),sections:{}};if(this.featureSwitchService.featureSwitches.dataSourceVariablesOverride&&!r.suppressDataSourceVariables&&(a.dataSourceVariables=e.dataSourceVariables),e.objects&&(a.objects=this.captureExplorationObjects(e.objects)),r.captureAllSections)for(var o=0,n=e.sections;o<n.length;o++){var s=n[o];a.sections[s.name]=this.captureSection(s,t,e,r.capturePresentation)}else a.sections[i.name]=this.captureSection(i,t,e,r.capturePresentation);return a},I.prototype.captureExplorationObjects=function(e){return this.captureObjects(r,e,k)},I.prototype.captureFilterState=function(e){var t=this.captureFilterStateObjects(e.visualType,e.objects);return{visualType:e.visualType,objects:t,cachedFilterDisplayItems:e.cachedFilterDisplayItems}},I.prototype.captureSection=function(t,e,r,i){var a=this.getCrossHighlights(t);return{filters:F(t.filters,0,(function(e){return x.isLinkedAsAggregation(r,t,e)})),visualContainers:this.captureVisualContainers(t.visualContainers,a,e,i),visualContainerGroups:this.captureVisualContainerGroups(t.visualContainerGroups)}},I.prototype.getCrossHighlights=function(e){return e&&e.crossFilterSource&&e.crossFilterSource.highlight},I.prototype.captureVisualContainerGroups=function(e){for(var t,r=0,i=e;r<i.length;r++){var a,o,n=i[r];C.isVisualContainerGroup(n)&&(a={},null!=n.isHidden&&(a.isHidden=n.isHidden),_.isEmpty(n.children)||(o=this.captureVisualContainerGroups(n.children),a.children=o),null==a.isHidden&&null==a.children||((t=t||{})[n.name]=a))}return t},I.prototype.captureVisualContainers=function(e,o,n,s){for(var l={},p=this,t=0,r=e;t<r.length;t++)!(function(e){e.name;var t=e.config.singleVisual;if(!t)return;var r=void 0;_.isEmpty(o)||(i=_.find(o,(function(e){return e.sourceVisualContainer.config.singleVisual===t&&!_.isEmpty(e.selection)})))&&(r={selection:i.selection,filterExpressionMetadata:i.filterExpressionMetadata||void 0});var i={filters:F(_.union(e.filters,p.getAdditionalVisualFiltersToCapture(e,n)),0,p.nonDrillthroughIsLinkedAsAggregationCallback),singleVisual:{visualType:t.visualType,objects:p.captureVisualObjects(t.visualType,t.objects),cachedFilterDisplayItems:t.cachedFilterDisplayItems,filterExpressionMetadata:t.filterExpressionMetadata},highlight:r},r=(null!=t.autoSelectVisualType&&(i.singleVisual.autoSelectVisualType=t.autoSelectVisualType),e.visibility),r=(null!=r&&0!==r&&(i.visibility=r),V.isHidden(t)&&(i.singleVisual.hidden=!0),t.query),a=s&&t.presentationChangesApplied;(a||r&&r.hasQueryFieldParameters())&&(a&&(i.singleVisual.targetType=t.visualType),null!=t.autoSelectVisualType&&(i.singleVisual.targetAutoSelectVisualType=t.autoSelectVisualType),r&&r.projections&&r.defn&&(i.singleVisual.projections=u.captureProjections(r,a))),r&&r.projections&&p.featureSwitchService.featureSwitches.fieldParameters&&(i.singleVisual.parameters=u.captureParameters(r)),r&&r.defn&&(i.singleVisual.orderBy=r.defn.orderBy()),r&&r.projections&&(i.singleVisual.activeProjections=p.captureActiveProjections(r)),r&&r.expansionStates&&(i.singleVisual.expansionStates=g.ExpansionState.clone(r.expansionStates)),l[e.name]=i})(r[t]);return l},I.prototype.captureActiveProjections=function(e){var t,r=e.defn.select();for(t in e.projections){var i,a=e.projections[t].activeProjectionRefs;_.isEmpty(a)||(a=_.map(a,(function(e){return r.withName(e).expr})),(i=i||{})[t]=a)}return i},I.prototype.captureVisualObjects=function(e,t){return this.captureFilterStateObjects(e,t)},I.prototype.captureFilterStateObjects=function(e,t){e=this.plugins.capabilities(e);return e&&e.objects?this.captureObjects(e.objects,t,s):{}},I.prototype.captureObjects=function(e,t,r){var i,a={};for(i in e){var o,n=e[i];for(o in n.properties){var s=n.properties[o],l={objectName:i,propertyName:o};!s.captureState&&!r(l,s,e)||(s=f.getValue(t,l,null))&&f.setValue(a,l,null,s)}}var p={};return _.isEmpty(a)||(p.merge=a),p},I.prototype.apply=function(e,t,r,i){var a,o,n={visualContainers:[],visualContainerGroups:[],issues:[]};for(a in i.suppressActiveSection||this.applyActiveSection(e.activeSection,t,n),i.suppressData||i.targetVisualNames||this.applyFilters(e.filters,t,2,n,i.clearUnmatchedData,[],void 0,r,this.nonDrillthroughIsLinkedAsAggregationCallback),e.objects&&this.applyExplorationObjects(e.objects,t,n,i),e.sections){var s,l,p=h.findItemWithName(t.sections,a);p&&(s=e.sections[a],l=!i.suppressActiveSection||this.isActiveSection(p.name,t),this.applySection(t,s,p,r,n,i,l))}return n.activeSection&&null!=n.filterScope&&(o=t.sections[t.activeSectionIndex],P.clearSectionQueryCaches(o)),i.suppressDataSourceVariables||this.applyDataSourceVariables(e.dataSourceVariables,t,n),_.isEmpty(n.issues)||this.featureSwitchService.featureSwitches.noLogExplorationStateApplyImpactIssues||this.telemetryService.logEvent(d.telemetry.EXExplorationStateApplyImpactIssues,{context:"apply",issues:_.reduce(n.issues,(function(e,t){return e|t.type}),0)}),n},I.prototype.applyExplorationObjects=function(e,t,r,i){var a,o={},n=(e&&e.merge&&(o.merge=f.clone(e.merge)),t.objects||{});for(a in o.merge)for(var s=0,l=o.merge[a];s<l.length;s++){var p,u=l[s],c=f.ensure(n,a,u.selector);for(p in u.properties){var d=u.properties[p];this.shouldApplyExplorationProperty(a,i)&&!f.propertiesAreEqual(c.properties[p],d)&&(r.objects=!0,c.properties[p]=d)}}return r.objects&&!t.objects&&(t.objects=n),r},I.prototype.isDisplayOptions=function(e){return void 0!==e&&void 0!==e.outspacePane&&void 0!==e.visuals},I.prototype.shouldApplyExplorationProperty=function(e,t){return"outspacePane"===e&&this.isDisplayOptions(t.suppressDisplay)?!t.suppressDisplay.outspacePane:!t.suppressDisplay},I.prototype.applyFilterState=function(e,t){for(var r={visualContainers:[],visualContainerGroups:[],issues:[]},i=0,a=e;i<a.length;i++){var o=a[i],n=o.visual,s=o.state,l=n.config.singleVisual,p=this.plugins.capabilities(l.visualType),o=o.impacted;(o=this.applyObjects(s,l,s.objects,p.objects,t,r)||o)&&!_.includes(r.visualContainers,n)&&r.visualContainers.push(n)}return _.isEmpty(r.issues)||this.featureSwitchService.featureSwitches.noLogExplorationStateApplyImpactIssues||this.telemetryService.logEvent(d.telemetry.EXExplorationStateApplyImpactIssues,{context:"applyFilterState",issues:_.reduce(r.issues,(function(e,t){return e|t.type}),0)}),r},I.prototype.isActiveSection=function(e,t){return e===t.sections[t.activeSectionIndex].name},I.prototype.applyActiveSection=function(e,t,r){this.isActiveSection(e,t)||(0<=(e=h.indexWithName(t.sections,e))?(t.activeSectionIndex=e,r.activeSection=!0):r.issues.push({type:1}))},I.prototype.applyDataSourceVariables=function(e,t,r){e?(t.dataSourceVariables=e,r.dataSourceVariables=!0):t.dataSourceVariables=void 0},I.prototype.applyFilters=function(e,t,r,i,a,o,n,s,l){var p=!1,u=[],e={nameIdentifiedMerges:_.clone(e&&e.nameIdentifiedMerges||{}),exprIdentifiedMerges:__spreadArray([],e&&e.exprIdentifiedMerges||[]),typeIdentifiedMerges:__spreadArray([],e&&e.typeIdentifiedMerges||[]),transientFilters:__spreadArray([],e&&e.transientFilters||[])},p=this.applyRemainingFilters(e,t,0===r,i,u,o,n,s,l)||p;if(a&&t.filters)for(var c=t.filters.length-1;0<=c;c--){var d=t.filters[c];d?d.type===C.FilterType.Passthrough||_.includes(u,d)||(2===d.howCreated?(t.filters.splice(c,1),this.addImpactCrossDrillSourceUpdate(n,t,0===r,i)):D(d),p=!0):t.filters.splice(c,1)}return p&&this.setMinimumFilterScope(i,r),p},I.prototype.applyRemainingFilters=function(e,t,r,i,a,o,n,s,l){var p=this.applyTransientFilters(e,t,a,i),p=this.applyMatchingFilterByName(e,t,a,i)||p;if(!_.isEmpty(e.nameIdentifiedMerges)){for(var u in e.nameIdentifiedMerges)e.exprIdentifiedMerges.push(e.nameIdentifiedMerges[u]);e.nameIdentifiedMerges={}}p=this.applyMatchingFilterByExpr(e,t,r,a,s,l,i)||p,p=this.applyMatchingFilterByType(e,t,a,i)||p;s=this.applyDrillFilters(e,t,a,o,i);return p=s||p,s&&this.addImpactCrossDrillSourceUpdate(n,t,r,i),p},I.prototype.addImpactCrossDrillSourceUpdate=function(e,t,r,i){t&&r?(r=this.filterGenerator.updateCrossDrillFromVisualContainersOperation(e,[t]),i.visualContainers=_.union(i.visualContainers,r)):i.issues.push({type:64})},I.prototype.applyMatchingFilterByName=function(i,a,o,n){if(_.isEmpty(i)||_.isEmpty(i.nameIdentifiedMerges)||_.isEmpty(a.filters))return!1;var e,s=!1,l=[];for(e in i.nameIdentifiedMerges)!(function(t){var r=i.nameIdentifiedMerges[t],e=(r.name!==t&&n.issues.push({type:4}),_.findIndex(a.filters,(function(e){return e.howCreated===r.howCreated&&!_.includes(o,e)&&e.name===t})));-1!==e&&(b.isSameFilter(a.filters[e].filter,r.filter)||(R(a.filters[e],r),s=!0),l.push(t),o.push(a.filters[e]))})(e);return l.forEach((function(e){delete i.nameIdentifiedMerges[e]})),s},I.prototype.applyMatchingFilterByExpr=function(p,u,c,d,m,v,g){if(_.isEmpty(p)||_.isEmpty(p.exprIdentifiedMerges))return!1;for(var h,f,y=!1,C=!1,x=__spreadArray([],p.exprIdentifiedMerges||[]),S=this;f=_.head(x);)!(function(){var r=f.howCreated;if(2===r)return x.splice(0,1);var e,t=_.remove(x,(function(e){return e===f||e.howCreated===r&&N.equals(e.expression,f.expression)})),i=[];if((u.filters||[]).forEach((function(e,t){!e||e.howCreated!==r||_.includes(d,e)||v(e)||!N.equals(e.expression,f.expression)||A(e)&&e.name!==f.name||i.push(t)})),_.isEmpty(i)&&c&&0===r&&(f.filter?(1!==t.length&&g.issues.push({type:8}),C||(C=!0,h=P.getAutoVisualFilterContainers(u,S.visualPluginOps,m,S.aggrOps)),(e=_.find(h,(function(e){return N.equals(e.expression,f.expression)})))&&((u.filters||(u.filters=[])).push(e),i.push(u.filters.length-1))):(_.remove(p.exprIdentifiedMerges,f),_.remove(t,f))),0<i.length){for(var a=Math.min(t.length,i.length);t.length>a;){var o=_.findIndex(t,(function(e){return _.isEmpty(e.filter)}));if(-1===o)break;t.splice(o,1)}for(var n=0;n<a;n++){var s=i[n];b.isSameFilter(u.filters[s].filter,t[n].filter)||(R(u.filters[s],t[n]),y=!0),d.push(u.filters[s])}for(n=a;n<t.length;n++){var l=j(t[n]);(u.filters||(u.filters=[])).push(l),d.push(l),y=!0}for(n=a;n<i.length;n++){s=i[n];D(u.filters[s]),y=!0}p.exprIdentifiedMerges=_.difference(p.exprIdentifiedMerges,t)}})();return y},I.prototype.applyDrillFilters=function(e,r,i,a,o){var n=!1;if(!(_.isEmpty(a)||_.isEmpty(e)||_.isEmpty(e.exprIdentifiedMerges))){for(var s=[],t=0,l=e.exprIdentifiedMerges;t<l.length;t++)!(function(t){if(2!==t.howCreated)return;if(!_.find(a,(function(e){return N.equals(t.expression,e)})))return o.issues.push({type:32});var e=_.find(r.filters,(function(e){return 2===e.howCreated&&!_.includes(i,e)&&N.equals(e.expression,t.expression)}));e?(b.isSameFilter(e.filter,t.filter)||(R(e,t),n=!0),i.push(e)):(e=j(t),(r.filters||(r.filters=[])).push(e),i.push(e),n=!0),s.push(t)})(l[t]);e.exprIdentifiedMerges=_.difference(e.exprIdentifiedMerges,s)}return n},I.prototype.applyMatchingFilterByType=function(e,r,i,a){var o=!1;if(!_.isEmpty(e)&&!_.isEmpty(e.typeIdentifiedMerges)){for(var n=[],t=0,s=e.typeIdentifiedMerges;t<s.length;t++)!(function(t){3!==t.howCreated&&4!==t.howCreated&&a.issues.push({type:16});var e=_.find(r.filters,(function(e){return e.howCreated===t.howCreated&&!_.includes(i,e)}));e?(R(e,t),i.push(e)):(e=j(t),(r.filters||(r.filters=[])).push(e),i.push(e)),n.push(t),o=!0})(s[t]);e.typeIdentifiedMerges=_.difference(e.typeIdentifiedMerges,n)}return o},I.prototype.applyTransientFilters=function(e,r,i,a){var o=!1;if(!_.isEmpty(e)&&!_.isEmpty(e.transientFilters)){for(var t=0,n=e.transientFilters;t<n.length;t++)!(function(t){5===t.howCreated&&!0===t.isTransient||a.issues.push({type:2});var e=_.find(r.filters,(function(e){return e.isTransient&&!_.includes(i,e)&&b.isSameFilter(e.filter,t.filter)}));e?(R(e,t),i.push(e)):(e=j(t),(r.filters||(r.filters=[])).push(e),i.push(e)),o=!0})(n[t]);e.transientFilters=[]}e=_.remove(r.filters,(function(e){return e&&e.isTransient&&!_.includes(i,e)}));return o=o||!_.isEmpty(e)},I.prototype.applySection=function(t,e,r,i,a,o,n){o.suppressData||o.targetVisualNames||this.applyFilters(e.filters,r,1,a,o.clearUnmatchedData,[],r,i,(function(e){return x.isLinkedAsAggregation(t,r,e)}));for(var s=0,l=r.visualContainers;s<l.length;s++){var p,u=l[s],c=u.name;o.targetVisualNames&&!_.includes(o.targetVisualNames,c)||(p=void 0,null!=(c=e.visualContainers&&e.visualContainers[c])?(p=this.applyVisualState(t,c,r,u,i,a,o,n,!0),c.highlight&&!o.suppressData&&n&&(_.isEmpty(c.highlight.selection),this.isSelectionValid(c.highlight.selection,u.config.singleVisual,i)&&(null==a.pendingHighlights&&(a.pendingHighlights=[]),o.suppressData,a.pendingHighlights.push({selection:c.highlight.selection,sourceVisualContainer:u,filterExpressionMetadata:c.highlight.filterExpressionMetadata})))):o.clearUnmatchedData&&(p=this.applyVisualState(t,{},r,u,i,a,o,n,!1)),_.isEmpty(p)||(c=_.without.apply(_,__spreadArray([p],a.visualContainers||[])),(u=a.visualContainers).push.apply(u,c||[])))}for(var d=this.getCrossHighlights(r),m=0,v=r.visualContainerGroups;m<v.length;m++){var g,h=v[m];C.isVisualContainerGroup(h)&&(null!=(g=e.visualContainerGroups&&e.visualContainerGroups[h.name])&&this.applyVisualGroupState(g,r,h,a,o,d))}},I.prototype.applyVisualState=function(e,t,r,i,a,o,n,s,l){var p,u,c,d,m,v,g,h=!1,f=t.singleVisual,y=(n.suppressData||(u=null==(u=null==(u=n.defaultPresentationState)?void 0:u[r.name])?void 0:u[i.name],c=p=!1,this.presentationChangesAllowed(e,n,i,f,this.visualPluginOps)&&(p=(e=this.applyPresentationChanges(i,f,u,f&&f.parameters,a)).changesApplied,c=e.parametersRemoved),u=!1,this.featureSwitchService.featureSwitches.fieldParameters&&(u=this.applyParameterStateByRole(a,i,f,c)),e=f&&f.orderBy,c=this.applySort(i.config.singleVisual,e,n.clearUnmatchedData),e=f&&f.activeProjections,e=this.applyActiveProjections(i.config.singleVisual,e,n.clearUnmatchedData),d=this.collectValidDrillExprs(i.config.singleVisual),d=this.applyFilters(t.filters,i,0,o,n.clearUnmatchedData,d,r,a,this.nonDrillthroughIsLinkedAsAggregationCallback),m=f&&f.expansionStates,m=this.applyExpansionStates(i,m,n.clearUnmatchedData,a,o),g=this.plugins.capabilities(i.config.singleVisual.visualType),y=f&&f.objects,v=!1,h=(v=g&&g.objects?this.applyObjects(f,i.config.singleVisual,y,g.objects,a,o):v)||p||c||e||d||m||u),[]);return this.getSuppressDisplayOptions(n).visuals||(null!=(g=t.visibility)&&s&&(o.visibility={visual:i,mode:g}),l&&!f||(a=!1,f?a=!!f.hidden:n.suppressUnmatchedClearHidden&&(a=V.isHidden(i.config.singleVisual)),y.push.apply(y,this.applyHidden(a,i,r)||[]))),h&&!_.includes(y,i)&&y.push(i),y},I.prototype.applyPresentationChanges=function(e,t,r,i,a){var o=e.config.singleVisual;if(!t)return{changesApplied:!1,parametersRemoved:!1};var n=!t.targetType;if(n&&!o.presentationChangesApplied)return{changesApplied:!1,parametersRemoved:!1};var s=!1,l=n?null==r?void 0:r.visualType:t.targetType,p=n?null==r?void 0:r.autoSelectVisualType:t.targetAutoSelectVisualType,r=n?null==r?void 0:r.projections:t.projections,t=(l&&(s=l!==o.visualType,o.visualType=l),null!=p&&(s=s||p!==o.autoSelectVisualType,o.autoSelectVisualType=p),!o.query&&r&&(o.query=new w(E.create(),{},[])),o.query);return r&&t?(this.applyVisualQueryPresentationChanges(t,r,i,e,a),o.presentationChangesApplied=!n,{changesApplied:!0,parametersRemoved:!0}):{changesApplied:o.presentationChangesApplied=s,parametersRemoved:!1}},I.prototype.applyParameterStateByRole=function(e,t,n,s){if(!n||!n.parameters)return!1;var r=t.config.singleVisual;if(!r.query&&s)r.query=new w(E.create(),{},[]);else if(!r.query)return!1;var l,i=n.parameters,p=r.query,u={},c=p.getResolveParameterResultsByRole();for(l in i){var d=i[l],m=(u[l]=[],p.projections[l]);if(m=!m&&s&&0<d.length?p.projections[l]=new o([]):m)for(var v=this,a=0;a<d.length;a++)!(function(e){var t=d[e];if(s){var r=p.addParameter(t.expr,l,t.index),i=m.getParameterByFieldIndex(r);(c[l]||(c[l]=[])).push({parameter:i,result:[]})}else{var r=_.find(u[l],(function(e){return N.equals(e.expr,t.expr)})),a=r?r.count:0,o=_.sortBy(m.findParameterBySQExpr(t.expr),(function(e){return e.index}));if(a>=o.length)return;i=o[a],r?r.count++:u[l].push({expr:t.expr,count:1})}o=c[l],a=_.find(o,(function(e){return e.parameter.index===i.index})),r=v.getProjectionsForParameter(d,e,n.projections,l);a.result=_.map(r,(function(e){return{expr:e,alias:void 0}}))})(a)}return this.visualAuthoringCore.resolveParameters(e,t,c,this.drillService,this.sortService,void 0).queryChange},I.prototype.getProjectionsForParameter=function(e,t,r,i){var a=[],o=e[t];if(void 0!==o.length&&0<o.length)for(var n=S.convertFieldIndexToProjectionIndexUsingParameters(o.index,e),s=n;s<n+o.length;s++)a.push(r[i][s]);return a},I.prototype.applyVisualQueryPresentationChanges=function(e,t,r,i,a){for(var o in e.projections)this.visualAuthoringCore.removeAllParametersAndProjectionsFromRole(o,i,a,this.drillService,this.sortService);for(var o in t){for(var n=this.getNonParameterExpressions(t[o],r,o),s=void 0,s=0;s<n.length;s++){var l=n[s],p=!1;if(e.projections[o])for(var u=e.tryGetExprs(o),c=s;c<u.length;c++){var d=u[c];if(g.SQExpr.equals(d,l,!0,!0,!0)){p=!0,c!==s&&e.moveProjection(o,c,s,1);break}}p||e.add(l,o,{fieldIndex:s})}if(e.projections[o])for(var m=e.tryGetExprs(o).length;m>n.length&&0<m;)e.removeProjection(o,{fieldIndex:--m})}for(var o in e.projections)if(null==(n=this.getNonParameterExpressions(t[o],r,o))||!n.length)for(var m=e.tryGetExprs(o).length,v=0;v<m;v++)e.removeProjection(o,{fieldIndex:0})},I.prototype.getNonParameterExpressions=function(e,t,a){if(e){for(var o=[],r=0;r<e.length;r++)!(function(r){var i=t&&t[a];if(i&&0<i.length&&_.find(i,(function(e){var t=S.convertFieldIndexToProjectionIndexUsingParameters(e.index,i);return void 0!==e.length&&0<e.length&&t<=r&&r<=t+e.length-1})))return;null!==e[r]&&o.push(e[r])})(r);return o}},I.prototype.applyVisualGroupState=function(i,a,o,n,s,l){var e,t,r=o.name;if(s.targetVisualNames&&!_.includes(s.targetVisualNames,r)||(r=void 0,this.getSuppressDisplayOptions(s).visuals||(e=i.isHidden,t=o.isHidden,null!=e&&e!==t&&(o.isHidden=e,r=!0),e&&!_.isEmpty(l)&&(t=this.clearCrossHighlightsForGroup(o,a,l),n.visualContainers=_.chain(n.visualContainers).concat(t).uniq().value())),r&&n.visualContainerGroups.push(o)),!_.isEmpty(i.children)){var p,u=this;for(p in i.children)!(function(t){var e=i.children[t],r=_.find(o.children,(function(e){return e.name===t}));if(!e||!r||!C.isVisualContainerGroup(r))return;u.applyVisualGroupState(e,a,r,n,s,l)})(p)}},I.prototype.getSuppressDisplayOptions=function(e){e=e.suppressDisplay;return this.isDisplayOptions(e)?e:{outspacePane:e,visuals:e}},I.prototype.applyFilterExpressionCache=function(e,t,r){r?this.clearFilterExpressionCache(t):(t.filterExpressionMetadata=e.filterExpressionMetadata,t.cachedFilterDisplayItems=e.cachedFilterDisplayItems)},I.prototype.clearFilterExpressionCache=function(e){e.filterExpressionMetadata=void 0,e.cachedFilterDisplayItems=void 0},I.prototype.applyHidden=function(e,t,r){var i=t.config.singleVisual;if(e!==V.isHidden(i))return V.setHidden(i,e),i=[t],e?_.chain(i).concat(this.clearCrossHighlightsForVisual(t,r)).uniq().value():i},I.prototype.clearCrossHighlightsForGroup=function(e,t,r){var i,a=[];return C.traverseVisualContainerGroups([e],(function(t){C.isVisualContainer(t)&&_.some(r,(function(e){return e.sourceVisualContainer===t}))&&a.push(t)})),(i=_.isEmpty(a)?i:this.clearCrossHighlightsForVisuals(a,t))||[]},I.prototype.clearCrossHighlightsForVisual=function(e,t){return this.clearCrossHighlightsForVisuals([e],t)},I.prototype.clearCrossHighlightsForVisuals=function(e,t){var r=__spreadArray([],e||[]);return r.push.apply(r,this.filterGenerator.clearCrossHighlightForVisualContainersOperation(t,e)||[]),_.uniq(r)},I.prototype.collectValidDrillExprs=function(e){var t=e.query;if(!t)return[];var r=t.defn.select();if(_.isEmpty(r))return[];var i,a=[];for(i in t.projections)for(var o=t.projections[i],n=o.activeProjectionRefs||[],s=_.last(n),l=0,p=o.all();l<p.length;l++){var u=p[l];if(s&&u.queryRef===s)break;u=r.withName(u.queryRef);a.push(u.expr)}return a},I.prototype.applyActiveProjections=function(e,p,t){var u=e.query;if(!u)return!1;var c=u.defn.select(),e=this.plugins.capabilities(e.visualType),d=e&&e.drilldown&&e.drilldown.roles||[],m=!1,v={};for(r in p)!(function(e){if(!_.includes(d,e))return;var t=p[e],r=(v[e]||(v[e]=[]),u.projections[e]);if(!r)return m=!0;var i=r.all();if(_.isEmpty(i))return m=!0;if(t.length>i.length)return m=!0;if(1===t.length){var a=t[0],r=_.find(i,(function(e){e=c.withName(e.queryRef);return N.equals(e.expr,a)}));if(!r)return m=!0;v[e].push(r.queryRef)}else for(var o=0;o<t.length;o++){i.length;var n=t[o],s=i[o],l=c.withName(s.queryRef);N.equals(l.expr,n)?v[e].push(s.queryRef):m=!0}})(r);if(m)for(var r in u.projections)v[r]=[];var i=!1;for(r in u.projections)if(_.includes(d,r)){var a=u.projections[r],o=v[r];if(_.isEmpty(o)){if(!t)continue;var n=a.all();_.isEmpty(n)||(o=[_.head(n).queryRef])}h.sequenceEqual(a.activeProjectionRefs,o,(function(e,t){return e===t}))||(a.activeProjectionRefs=o,i=!0)}return i},I.prototype.applySort=function(e,t,r){e=e.query;if(!e)return!1;var i=e.defn.orderBy()||[];return!(!t&&!r)&&(!h.sequenceEqual(i,t=t||[],g.SQUtils.sqSortDefinitionEquals)&&(e.orderBy(t),!0))},I.prototype.applyObjects=function(e,t,r,i,a,o){var n={},r=(r&&(r.merge&&(n.merge=f.clone(r.merge)),r.remove&&(n.remove=r.remove.slice())),t.objects||{}),s=m.findFilterOutput(i),l=this.plugins.getPlugin(t.visualType),l=(this.applyPluginUpdateSemantics(l,n,r,i),n.remove||(n.remove=this.getVisualPropertiesToRemove(t.visualType,r,n.merge)),this.mergeObjects(e,t,n.merge,r,o,a,s)),p=p||l.visualImpacted;return n.remove=n.remove.concat(l.removeList),p=this.removeObjects(t,r,n.remove,o,s)||p},I.prototype.updateQueryProjectionsFromExpansionState=function(p,e,u){var c=this;if(_.isEmpty(e))return!1;for(var t=function(s){function l(e){return e=s.roles[e],p.projections[e],p.projections[e]&&p.projections[e].all()}function e(t){for(var i=0,a=l(0),o=0,n=0;n<_.size(s.levels)&&"break"!==(function(){if(o===_.size(a)){if(o=0,++i>=_.size(s.roles))return"break";if(!(a=l(i)))return"break"}var r=s.levels[n],e=(_.size(r.queryRefs),_.findIndex(a,(function(e){var t=null==(t=S.tryGetExprByProjection(p.defn,e))?void 0:t.expr;return e.queryRef===_.first(r.queryRefs)&&c.verifyExpansionIdentities(r,t,u)}),t?o:0));if(-1===e)return"break";t&&o!==e&&p.moveProjection(s.roles[i],e,o,1)})();n++,o++);return n}var t=s.getVisibleDescendentsDepth(s.root,-1),r=Math.max(_.findLastIndex(s.levels,(function(e){return e.isPinned}))+1,t);if(!(r<=e(!1)))return{value:!1};_.remove(p.expansionStates,(function(e){return _.isEqual(e.roles,s.roles)})),e(!0);var r=s.clone(),i=(p.setActiveProjections(r.roles,t),p.getRolesUniqueProjectionRefs(r.roles)),a=_.findIndex(r.levels,(function(e){return e.isCollapsed}));r.updateLevels(i,-1===a?t:a),p.expansionStates||(p.expansionStates=[]),p.expansionStates.push(r)},r=0,i=e;r<i.length;r++){var a=t(i[r]);if("object"==typeof a)return a.value}return!0},I.prototype.applyExpansionStates=function(r,e,t,a,o){var n=this,i=r.config.singleVisual,s=i.query;if(!s)return!1;var l=s.expansionStates||[];if(!e&&!t)return!1;if(g.ExpansionState.areEqual(l,e=e||[]))return!1;t=this.plugins.capabilities(i.visualType);return t&&t.expandCollapse&&t.expandCollapse.restoreProjectionsOrderFromBookmark?this.updateQueryProjectionsFromExpansionState(s,e,a):(s.expansionStates=g.ExpansionState.clone(_.filter(e,(function(e){1!==e.roles.length&&o.issues.push({type:256});var t=s.projections[e.roles[0]],i=t&&t.all()||[];return!(!n.expandCollapse.isEnabled(r,e.roles)||1!==e.roles.length||i.length<e.levels.length)&&_.every(e.levels,(function(e,t){e.queryRefs.length;var t=i[t],r=null==(r=S.tryGetExprByProjection(s.defn,t))?void 0:r.expr;return t.queryRef===e.queryRefs[0]&&n.verifyExpansionIdentities(e,r,a)}))}))),!0)},I.prototype.verifyExpansionIdentities=function(e,t,r){var i=new a;return _.isEmpty(e.identityKeys)||h.sequenceEqual(e.identityKeys,t.accept(i,r),N.equals)},I.prototype.applyPluginUpdateSemantics=function(e,t,r,i){if(t&&e&&e.mergeObjects){var a=d.visuals.visualStyles.create(),r=v.evaluateMetadataOnceDataViewObjectDefinitions(r,i,a,this.featureSwitchService.featureSwitches).dataViewObjects,i=v.evaluateMetadataOnceDataViewObjectDefinitions(t.merge||{},i,a,this.featureSwitchService.featureSwitches).dataViewObjects,a=e.mergeObjects({objects:r,changes:i});if(a){if(null==a.removeObject&&a.replace,a.merge){t.merge={};for(var o=0,n=a.merge;o<n.length;o++)for(p in(l=n[o]).properties){var s=e.capabilities.objects[l.objectName].properties[p].type,s=f.encodePropertyValue(l.properties[p],s);f.setValue(t.merge,{objectName:l.objectName,propertyName:p},l.selector,s)}}if(a.remove){t.remove=[];for(var l,p,u=0,c=a.remove;u<c.length;u++)for(p in(l=c[u]).properties)t.remove.push({object:l.objectName,property:p,selector:l.selector})}}}},I.prototype.mergeObjects=function(e,t,r,i,a,o,n){var s={visualImpacted:!1,removeList:[]};if(!_.isEmpty(r))for(var l in r)for(var p=0,u=r[l];p<u.length;p++){var c,d=u[p],m=f.ensure(i,l,d.selector);for(c in d.properties){var v=d.properties[c];if(!f.propertiesAreEqual(m.properties[c],v)){if(n&&y.propertyIdentifiersEqual(n,{objectName:l,propertyName:c})){var g=!!this.isFilterValid(v,t,o);if(this.applyFilterExpressionCache(e,t,!g),!g){a.issues.push({type:128}),s.removeList.push({object:n.objectName,property:n.propertyName,selector:null});continue}this.setMinimumFilterScope(a,1)}m.properties[c]=v,s.visualImpacted=!0,t.objects||(t.objects=i)}}}return s},I.prototype.removeObjects=function(e,t,r,i,a){if(_.isEmpty(r))return!1;for(var o=!1,n=0,s=r;n<s.length;n++){var l=s[n],p=l.selector,u=l.object,l=l.property;f.deleteProperty(t,u,p,l)&&(o=!0,a&&y.propertyIdentifiersEqual(a,{objectName:u,propertyName:l})&&(this.clearFilterExpressionCache(e),this.setMinimumFilterScope(i,1)))}return o},I.prototype.getVisualPropertiesToRemove=function(e,t,r){var i=this.plugins.capabilities(e);if(!i||!i.objects)return[];var a,o=m.findFilterOutput(i.objects),n=[];for(a in i.objects){var s,l=i.objects[a];for(s in l.properties){var p,u=l.properties[s];u.persistUnmatchedState||(u.filterState||u.captureState||o&&y.propertyIdentifiersEqual(o,{objectName:a,propertyName:s}))&&(p=f.getValue(r,u={objectName:a,propertyName:s},null),f.getValue(t,u,null)&&!p&&n.push({object:a,property:s,selector:null}))}}return n},I.prototype.isFilterValid=function(e,t,r){t=t.query;if(!t)return!1;t=new n(t.defn,r);return e.rewrite(t),t.valid},I.prototype.isSelectionValid=function(e,t,r){var e=g.Selector.filterFromSelectorsByColumn(e),i=new g.SemanticQueryRewriter(g.SQExprRemoveEntityVariablesRewriter.instance).rewriteFrom(e.from()),a=_.map(e.where(),(function(e){return{condition:e.condition.accept(g.SQExprRemoveEntityVariablesRewriter.instance)}})),e=new b(i,a);return this.isFilterValid(e,t,r)},I.prototype.setMinimumFilterScope=function(e,t){e.filterScope?e.filterScope=Math.max(t,e.filterScope):e.filterScope=t},I.prototype.getAdditionalVisualFiltersToCapture=function(e,t){for(var r=[],i=0,a=P.getAutoVisualFilterContainers(e,this.visualPluginOps,t,this.aggrOps)||[];i<a.length;i++)!(function(t){_.find(e.filters,(function(e){return N.equals(e.expression,t.expression)}))||r.push(t)})(a[i]);return r},I.prototype.presentationChangesAllowed=function(e,t,r,i,a){if(!e.settings||!e.settings.allowInlineExploration)return!1;if(!t.applyPresentationChanges)return!1;e=r&&r.config&&r.config.singleVisual;if(!e)return!1;var t=[function(e){return a.isQnaVisual(e)},function(e){return a.isQueryVisual(e)}],o=i&&i.visualType;if(!t.some((function(e){return e(o)})))return!1;r=e&&e.vcObjects,i=f.getValue(r,{objectName:"visualHeader",propertyName:"showPersonalizeVisualButton"},null);return!i||!1!==i.value},T=I,i=g.SQExprRewriter,__extends(O,i),O.prototype.visitColumnRef=function(e){return this.valid=this.valid&&this.exprInSelects(e),e},O.prototype.exprInSelects=function(t){var e=_.some(this.query.select(),(function(e){return N.equals(e.expr,t,!0,!0)}));if(e)return!0;if(!this.schema)return e;for(var r=0,i=this.query.select();r<i.length;r++){var a=i[r].expr.getKeyColumns(this.schema);if(_.some(a,(function(e){return N.equals(t,e,!0,!0)})))return!0}return!1},n=O})(powerbi=powerbi||{}),(function(a){var o,e,n,s,l,p,u;function c(e,t){var r=a.data.SQExprUtils.getDefaultValue(e,t);if(r)return e=o.FilterUtils.getFormatter(e,t),a.data.RestatementHelper.fromDefault(e.format(r.value))}function d(e){return e.constant?e.constant.value:e.dateSpan?e.dateSpan.value:void 0}o=a.explore||(a.explore={}),e=(e=o.services||(o.services={})).filterRestatementUtil||(e.filterRestatementUtil={}),n=a.data.isFilterComparisonPattern,s=a.data.RelativeDateRangeHelper,l=a.data.SQExprBuilder,p=a.data.RelativeFilterType,u=a.data.RelativeDateFilterPattern,e.visitBetweenHelper=function(e){e.lower,e.upper;var t=e.lower.value,e=e.upper.value;return s.getDateRangeRestatement({min:t,max:e})},e.visitRelativeDateRangeHelper=function(e,t,r,i){return s.getRestatement(e.options,i,t,r)},e.visitComparisonFilterPatternHelper=function(e,t,r){var i=l.fieldExpr(e.arg);return e.condition.defaultValue?c(i,t):e.condition.anyValue?void 0:(i=o.FilterUtils.getFormatter(i,t),t=r||d(e.condition),a.data.RestatementHelper.fromCondition([new a.data.Condition(e.filterOperator,t,i)],2))},e.getDefaultValueRestatement=c,e.getAdvancedFilterPatternRestatement=function(e,t,r){return t=(function e(t,r){{var i;return n(t)?(i=l.fieldExpr(t.arg),i=o.FilterUtils.getFormatter(i,r),[new a.data.Condition(t.filterOperator,d(t.condition),i)]):__spreadArray(__spreadArray([],e(t.left,r)||[]),e(t.right,r)||[])}})(e,t),a.data.RestatementHelper.fromCondition(t,e.logicalOperator,void 0,r)},e.updateRelativeTimeRestatementOnToggle=function(e,t,r,i,a,o){t.get(e).then((function(){var e,t=i.contract,t=u.extractParametersFromSemanticFilter(t.filter,p.Time),t=t&&t.options;t&&(e=o&&i.isFilterExpanded(),t=s.getRestatement(t,e,(function(e,t){return r.format(e,t)}),a),i.setRestatement(t))}))}})(powerbi=powerbi||{}),(function(l){var e;(function(t){var a=l.explore.util.DisplayNameServiceUtils,o=l.data.FieldExprPattern,n=l.data.SQExprBuilder,s=jsCommon.StringExtensions;function e(e,t,r,i,a,o){this.schema=e,this.locOptions=t,this.visualTimeSynchronizationService=r,this.networkAvailabilityService=i,this.displayNameServiceVisitor=a,this.displayOptions=o}e.prototype.visitIn=function(e){var r=this,i=e.args,t=e.values,t=_.map(t,(function(e){return _.map(e,(function(e,t){t=n.fieldExpr(i[t]),t=t&&t.getMetadata(r.schema);return l.visuals.valueFormatter.format(e.value,t&&t.format)})).join(" ")})),t=a.concatStrings(t,"Generic_Or",this.locOptions);return this.displayOptions&&this.displayOptions.includeFieldNamesInFilter?(e=e.args,e=_.map(e,(function(e){return o.visit(e,r.displayNameServiceVisitor)})).join(" "),s.format(this.locOptions.stringResourceProvider.get("VisualTitle_Is_Template"),e,t)):t},e.prototype.visitBetween=function(e){return t.filterRestatementUtil.visitBetweenHelper(e)},e.prototype.visitRelativeDateRange=function(e){var r=this;return t.filterRestatementUtil.visitRelativeDateRangeHelper(e,(function(e,t){return r.locOptions.stringResourceProvider.format(e,t)}),this.visualTimeSynchronizationService.getAnchorTime(),this.networkAvailabilityService.isNetworkAvailable())},e.prototype.visitTopN=function(e){},e.prototype.visitCompare=function(e){return t.filterRestatementUtil.visitComparisonFilterPatternHelper(e,this.schema)},e.prototype.visitAdvanced=function(e){return t.filterRestatementUtil.getAdvancedFilterPatternRestatement(e,this.schema)},e.prototype.visitComplex=function(e){},e.prototype.visitComposite=function(e){},e.prototype.visitHierarchical=function(e){},t.FilterRestatementVisitor=e})((e=l.explore||(l.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(a){var t,s,o,n;function e(e,t,r,i){var a=this;this.telemetryService=e,this.eventBridge=t,this.selectionService=r,this.explorationNavigation=i,this.selectionService=r,t.createChannelSubscriptionManager().subscribe(s.events.selectionChanged,(function(){return a.updatePopOutMode()}))}t=a.explore||(a.explore={}),s=t.services||(t.services={}),o=t.util.VisualContainerUtils,s.createVisibilityService=function(e,t,r,i){return new n(e,t,r,i)},e.prototype.get=function(e){var t=this.explorationNavigation.getCurrentSection(),t=t&&t.poppedOutElement;if(t)return(e=e||27)&t.visibility?t.visualContainer:void 0},e.prototype.set=function(t,e,r){var i,a,o,n;void 0===r&&(r=!0),0===e?this.clearInternal(!0,r):(s.selectionUtils.selectCanvasItem(t,this.selectionService),i={visualContainer:t,visibility:e},a=this.explorationNavigation.getAllSections(),(a=_.find(a,(function(e){return 0<=e.visualContainers.indexOf(t)})))&&(n=a&&a.poppedOutElement,(o=(o=i)||null)===(n=(n=n)||null)||!o==!n&&(o.visualContainer===n.visualContainer&&o.visibility===n.visibility)||(this.clearInternal(!1,!1),this.setMode(i,e,r),a.poppedOutElement=i,this.poppableItem=i,this.raiseEvent(this.generateVisibilityChangedEventArgs(e)))))},e.prototype.clear=function(){this.clearInternal()},e.prototype.clearForVisualContainers=function(e){var t=this.explorationNavigation.getCurrentSection(),r=t&&t.poppedOutElement;if(r)for(var i=0,a=e;i<a.length;i++){var o=a[i];if(r.visualContainer===o){this.clearInternal();break}}},e.prototype.clearInternal=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var r,i=this.explorationNavigation.getCurrentSection(),a=i&&i.poppedOutElement;a&&(r=this.poppableItem.visibility,this.setMode(a,0,t),i.poppedOutElement=void 0,e&&this.raiseEvent(this.poppableItem&&this.poppableItem.visualContainer===a.visualContainer?this.generateVisibilityChangedEventArgs(r):void 0),this.poppableItem=void 0)},e.prototype.isSeeDataMode=function(e){return e&&(2===e||8===e||16===e)},e.prototype.updatePopOutMode=function(){var e=s.selectionUtils.getDefaultSelectedVisualInSingleOrMultiCase(this.selectionService);e&&t.contracts.isVisualContainer(e)&&null!=e.visibility&&0!==e.visibility?this.set(e,e.visibility,!1):this.clearInternal(!0,!1)},e.prototype.raiseEvent=function(e){this.eventBridge.publishToChannel(s.events.visibilityChanged,e)},e.prototype.setMode=function(e,t,r){var i=e.visualContainer;r&&(r=(function(e){switch(e){case 1:return"Maximized";case 2:return"MaximizedWithData";case 8:return"MaximizedWithAccessibleData";case 4:return"Spotlight";case 16:return"VisualCalcEditing";default:return"Normal"}})(t),this.telemetryService.logEvent(a.telemetry.EXToggleVisualDisplay,{visualType:o.getVisualType(i),displayType:r,visualName:e.visualContainer.name})),i.visibility=t},e.prototype.generateVisibilityChangedEventArgs=function(e){return{preserveScroll:4===e}},n=e})(powerbi=powerbi||{}),(function(e){var t,r,i;function a(e){this.visualPlugins=e,this.visualPlugins}t=(t=e.explore||(e.explore={})).services||(t.services={}),r=e.data.DataViewObjectDescriptors,t.createVisualCapabilitiesService=function(e){return new i(e)},a.prototype.hasFilterCapabilities=function(e){e=this.visualPlugins.getPlugin(e);return!!(e&&e.capabilities&&e.capabilities.objects&&r.findFilterOutput(e.capabilities.objects))},i=a})(powerbi=powerbi||{}),(function(e){var t;function r(){this.visualIds={}}(e=(e=e.explore||(e.explore={})).services||(e.services={})).createVisualLifecycleService=function(){return new t},r.prototype.add=function(e){this.visualIds[e]=1},r.prototype.delete=function(e){delete this.visualIds[e]},r.prototype.has=function(e,t){void 0===t&&(t=!0);var r=1===this.visualIds[e];return r&&t&&this.delete(e),r},t=r,e.VisualLifecycleService=t})(powerbi=powerbi||{}),(function(o){var e,t,r,n,i;function a(e,t){this.plugins=e,this.featureSwitchService=t}e=o.explore||(o.explore={}),t=e.services||(e.services={}),r=o.data.DataViewObjectDescriptors,n=e.util.VisualContainerUtils,t.createVisualPluginOps=function(e,t){return new i(e,t)},a.prototype.canEdit=function(e,t){e=this.plugins.capabilities(e);switch(e&&e.advancedEditModeSupport){case 1:return!0;case 2:return t;default:return!1}},a.prototype.dataViewKinds=function(e,t){if(e){var r,i,a=this.plugins.capabilities(e);if(a)return a=a.dataViewMappings,i=o.DataViewMapping.targetDataViewKinds(a),t&&(r=n.createRoleKindByQueryRef(t),a=o.DataViewAnalysis.chooseDataViewMappings(t.projections,a,r,this.featureSwitchService.featureSwitches),i=o.DataViewMapping.targetDataViewKinds(a.supportedMappings),"map"===e&&1&i&&o.visuals.MapPluginMethods.mightRequireMatrixForUnpivot(t.projections,a.supportedMappings)&&(i|=2)),i||void 0}},a.prototype.targetedDataViewKinds=function(e,t){var r=31;return r=this.plugins.isCustomVisual(e)?r:this.dataViewKinds(e,t)||31},a.prototype.supportsFocusMode=function(e){e=this.plugins.capabilities(e);return e&&e.dataViewMappings&&!e.disableFocusMode},a.prototype.isSupportedVisual=function(e){e=n.getVisualType(e);return!!e&&!!this.plugins.getPlugin(e)},a.prototype.canConvertVisual=function(e){if(!e)return!1;var t=n.getVisualType(e);if(!t)return!1;var r=this.plugins.capabilities(t);return(this.isQueryVisual(t)||!(!r||!r.isConvertible))&&!n.hasGroupByItemsInQuery(e)},a.prototype.canFormatVisual=function(e){return!!e&&!n.hasGroupByItemsInQuery(e)},a.prototype.canSummarizeVisual=function(e){e=this.plugins.getPlugin(e);return!!e&&(this.isAnalysisVisualPlugin(e)?!!e.getAnalysisVisualNarrativeSummaryConfiguration:!!e.getNarrativeSummaryBindings)},a.prototype.isAnalysisVisualPlugin=function(e){return this.isAnalysisVisual(e.name)},a.prototype.isQueryVisual=function(e){var t=this.plugins.capabilities(e);return!t||!this.isQueryDisabled(e,t)&&null!=t.dataViewMappings},a.prototype.isQueryDisabled=function(e,t){if(t&&o.ScriptResultUtil.findScriptResultMapping(t.dataViewMappings))return!this.plugins.isScriptVisualQueryable(e)},a.prototype.supportVisualSearch=function(e){var t=this.plugins.capabilities(e);return!(!t||!this.isQueryVisual(e))&&!!r.findSelfFilter(t.objects)},a.prototype.isAnalysisVisual=function(e){return e===o.visuals.plugins.keyDriversVisual.name},a.prototype.isQnaVisual=function(e){return e===o.visuals.plugins.qnaVisual.name},i=a})(powerbi=powerbi||{}),(function(e){var t,s,r,i,o,l,p,u,c,n,d,m,v,g,h,f;function a(e){var t;if(e)return t={},e.byName&&(t.nameIdentifiedMerges=_.mapValues(e.byName,y)),e.byExpr&&(t.exprIdentifiedMerges=_.map(e.byExpr,y)),e.byType&&(t.typeIdentifiedMerges=_.map(e.byType,y)),e.byTransientState&&(t.transientFilters=_.map(e.byTransientState,y)),t}function y(e){return{name:e.name,type:i.FilterType[e.type],filter:e.filter?v.deserializeFilter(e.filter):void 0,expression:e.expression?v.deserializeExpr(e.expression):void 0,restatement:e.restatement,howCreated:e.howCreated,precedence:e.precedence,isTransient:e.isTransient,cachedValueItems:p.deserializeFilterLabelIdPairs(e.cachedDisplayNames),filterExpressionMetadata:e.filterExpressionMetadata?m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0}}function C(e){return{isHidden:e.isHidden,children:e.children&&_.mapValues(e.children,C)}}function x(e,t){var r,i,a,o,n;if(e)return r={visualType:e.visualType},null!=e.autoSelectVisualType&&(r.autoSelectVisualType=e.autoSelectVisualType),e.objects&&(r.objects=b(e.objects)),e.orderBy&&(r.orderBy=v.deserializeSortDefinitions(e.orderBy,null)),e.targetType&&(r.targetType=e.targetType),null!=e.targetAutoSelectVisualType&&(r.targetAutoSelectVisualType=e.targetAutoSelectVisualType),e.activeProjections&&(r.activeProjections=S(e.activeProjections)),_.isEmpty(e.parameters)||(r.parameters=(function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return{expr:v.deserializeExpr(e.expr),index:e.index,length:e.length}})))}return t})(e.parameters)),e.projections&&(r.projections=S(e.projections)),e.display&&"hidden"===e.display.mode&&(r.hidden=!0),e.cachedFilterDisplayItems&&(r.cachedFilterDisplayItems=p.deserializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(r.filterExpressionMetadata=m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata)),e.expansionStates&&(n=(o=t.capabilities(e.visualType))&&o.expandCollapse&&o.expandCollapse.supportsMerge,i=o&&o.expandCollapse&&o.expandCollapse.collapseParentAfterRemovingChildLevel,a=o&&o.noDefaultProjections,r.expansionStates=u.deserializeExpansionStates(e.expansionStates,{supportsMerge:n,canCollapseRoot:a,collapseParentAfterRemovingChildLevel:i})),e.mobileVcObjects&&(r.mobileVcObjects=l.deserializeObjects(e.mobileVcObjects,d.CommonObjectDescriptors)),e.mobileObjects&&(n=(o=t.capabilities(e.visualType))&&o.objects,r.mobileObjects=l.deserializeObjects(e.mobileObjects,n)),r}function S(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return null===e?null:v.deserializeExpr(e)})))}return t}function b(e){var t={};return e.merge&&(t.merge=l.deserializeObjects(e.merge,null)),e.remove&&(t.remove=_.map(e.remove,E)),t}function E(e){return{object:e.object,property:e.property,selector:l.deserializeSelector(e.selector)}}function N(e,t,r,i){return new f(r).serializeSingleVisual(e,t,i)}function V(e){this.featureSwitchService=e,this.version=c.v1_0}t=(t=(t=e.explore||(e.explore={})).services||(t.services={})).ExplorationState||(t.ExplorationState={}),s=e.explore.services.downgrade,r=e.explore,i=r.contracts,o=e.explore.services.upgrade.CurrentExplorationStateVersion,l=e.data.services.DataViewObjectSerializer,p=e.data.services.DisplayNameSerializer,u=e.data.services.ExpansionStateSerializer,c=r.services.upgrade.ExplorationStateVersions,n=r.services.upgrade.ExplorationStateFeatureVersions,d=r.contracts.VisualContainer,m=e.data.services.FilterExpressionMetadataSerializer,v=e.data.services.SemanticQuerySerializer,g=e.explore.services.upgrade,h=jsCommon.Version,t.clearUnusedReferences=function(e,t){for(var r,i,a={},o=!1,n=0,s=t.sections;n<s.length;n++)for(var l,p=0,u=(l=s[n]).visualContainers;p<u.length;p++)a[u[p].name]=!0;for(r in e.sections)for(i in(l=e.sections[r]).visualContainers)a[i]||(o=!0,delete l.visualContainers[i]);return o},t.cloneSingleVisual=function(e,t,r){return x(N(e,null,r,t),t)},t.deserialize=function(e,t,r,i){return null!=i&&i.runUpgraders&&(i=g.ExplorationStateVersionToExplorationVersion[e.version],e=g.createExplorationStateUpgrader(r).upgrade(e,i)),r={activeSection:e.activeSection,filters:a(e.filters),sections:_.mapValues(e.sections,(function(e){return r=t,{filters:a((e=e).filters),visualContainers:_.mapValues(e.visualContainers,(function(e){var t=r;return t=x(e.singleVisual,t),{filters:a(e.filters),singleVisual:t,visibility:e.singleVisual?(function(e){if(debug.assertAnyValue(e,"display"),e&&e.mode)switch(e.mode){case"maximize":switch(e.maximizedOptions&&e.maximizedOptions.dataTable){case"accessible":return 8;case"normal":return 2;default:return 1}case"spotlight":return 4}})(e.singleVisual.display):void 0,highlight:e.highlight?(function(e){return{selection:l.deserializeSelection(e.selection),filterExpressionMetadata:e.filterExpressionMetadata?m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0}})(e.highlight):void 0}})),visualContainerGroups:e.visualContainerGroups&&_.mapValues(e.visualContainerGroups,C)};var r}))},e.objects&&(r.objects=b(e.objects)),e.dataSourceVariables&&(r.dataSourceVariables=e.dataSourceVariables),r},t.serialize=function(e,t,r,i,a){var o,n=new f(t),t={version:void 0,activeSection:e.activeSection,filters:n.serializeFilters(e.filters),sections:_.mapValues(e.sections,(function(e){return n.serializeSection(e,r)}))};return e.objects&&(t.objects=n.serializeObjects(e.objects),n.version=h.max(n.version,c.v1_3)),e.dataSourceVariables&&(t.dataSourceVariables=e.dataSourceVariables,n.version=h.max(n.version,c.v1_4)),null!=i&&i.runDowngraders&&n.version!==g.CurrentExplorationStateVersion&&(i=s.createExplorationStateDowngrader(a),o=g.ExplorationStateVersionToExplorationVersion[n.version],o=i.getFinalExplorationVersion(e,o),i.downgrade(t,o),t.version=_.findKey(g.ExplorationStateVersionToExplorationVersion,(function(e){return e===o})),t.version),t.version=t.version||n.version,t},t.serializeFilterContainer=function(e,t){return new f(t).serializeFilterContainer(e)},t.serializeHighlightState=function(e,t){return new f(t).serializeHighlightState(e)},t.serializeSingleVisual=N,V.prototype.serializeFilters=function(e){var t,r=this;if(e)return t={},e.nameIdentifiedMerges&&(t.byName=_.mapValues(e.nameIdentifiedMerges,(function(e){return r.serializeFilterContainer(e)}))),e.exprIdentifiedMerges&&(t.byExpr=_.map(e.exprIdentifiedMerges,(function(e){return r.serializeFilterContainer(e)}))),e.typeIdentifiedMerges&&(t.byType=_.map(e.typeIdentifiedMerges,(function(e){return r.serializeFilterContainer(e)}))),e.transientFilters&&(t.byTransientState=_.map(e.transientFilters,(function(e){return r.serializeFilterContainer(e)}))),t},V.prototype.serializeFilterContainer=function(e){var t=e.filterExpressionMetadata?m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0;return{name:e.name,type:null!=e.type?i.FilterType[e.type]:void 0,filter:e.filter?v.serializeFilter(e.filter):void 0,expression:e.expression?v.serializeExpr(e.expression):void 0,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedDisplayNames:p.serializeFilterLabelIdPairs(e.cachedValueItems),filterExpressionMetadata:t}},V.prototype.serializeSection=function(e,t){var r=this;return 1<_.chain(e.visualContainers).values().sumBy((function(e){return null==e.highlight?0:1})).value()&&(this.version=h.max(this.version,c.v1_2)),{filters:this.serializeFilters(e.filters),visualContainers:_.mapValues(e.visualContainers,(function(e){return r.serializeVisualContainer(e,t)})),visualContainerGroups:e.visualContainerGroups&&_.mapValues(e.visualContainerGroups,(function(e){return r.serializeVisualContainerGroup(e)}))}},V.prototype.serializeVisualContainer=function(e,t){return e.highlight&&(this.version=h.max(this.version,c.v1_1)),{filters:this.serializeFilters(e.filters),singleVisual:this.serializeSingleVisual(e.singleVisual,e.visibility,t),highlight:e.highlight?this.serializeHighlightState(e.highlight):void 0}},V.prototype.serializeVisualContainerGroup=function(e){var t=this;return{isHidden:e.isHidden,children:e.children&&_.mapValues(e.children,(function(e){return t.serializeVisualContainerGroup(e)}))}},V.prototype.serializeSingleVisual=function(e,t,r){var i;if(e)return i={visualType:e.visualType},null!=e.autoSelectVisualType&&(i.autoSelectVisualType=e.autoSelectVisualType,this.version=h.max(this.version,n.OnObject)),e.objects&&(i.objects=this.serializeObjects(e.objects)),e.orderBy&&(i.orderBy=v.serializeSortDefinitions(e.orderBy,!0)),e.activeProjections&&(i.activeProjections=this.serializeActiveProjections(e.activeProjections)),e.targetType&&(i.targetType=e.targetType,this.version=h.max(this.version,c.v1_6)),null!=e.targetAutoSelectVisualType&&(i.targetAutoSelectVisualType=e.targetAutoSelectVisualType,this.version=h.max(this.version,n.OnObject)),e.projections&&(i.projections=this.serializeActiveProjections(e.projections),this.version=h.max(this.version,c.v1_6)),_.isEmpty(e.parameters)||(i.parameters=this.serializeParameters(e.parameters),this.version=h.max(this.version,n.FieldParameters)),e.cachedFilterDisplayItems&&(i.cachedFilterDisplayItems=p.serializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(i.filterExpressionMetadata=m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization),this.version=h.max(this.version,c.v1_5)),e.mobileVcObjects&&(i.mobileVcObjects=this.serializeMobileObjects(e.mobileVcObjects,d.CommonObjectDescriptors,e.visualType)),e.mobileObjects&&r&&(r=(r=r.capabilities(e.visualType))&&r.objects,i.mobileObjects=this.serializeMobileObjects(e.mobileObjects,r,e.visualType)),_.isEmpty(e.expansionStates)||(i.expansionStates=u.serializeExpansionStates(e.expansionStates)),e.hidden,e.hidden?i.display={mode:"hidden"}:t&&(i.display=(function(e){switch(e){case 1:return{mode:"maximize"};case 2:return{mode:"maximize",maximizedOptions:{dataTable:"normal"}};case 8:return{mode:"maximize",maximizedOptions:{dataTable:"accessible"}};case 4:return{mode:"spotlight"}}})(t)),i},V.prototype.serializeMobileObjects=function(e,t,r){this.version=h.max(this.version,n.AllowMobileVisualFormatting);var i,a=l.serializeObjects(e,t,this.featureSwitchService.featureSwitches.serializeSpaceOptimization);return this.version!==o&&(i=g.ExplorationStateVersionToExplorationVersion[this.version],i=g.getVersionForObjectDefinitions(e,t,r,i,jsCommon.ArrayExtensions.createWithName()),this.version=h.max(this.version,_.findKey(g.ExplorationStateVersionToExplorationVersion,(function(e){return e===i}))),this.version),a},V.prototype.serializeActiveProjections=function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return null===e?null:v.serializeExpr(e)})))}return t},V.prototype.serializeParameters=function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return{expr:v.serializeExpr(e.expr),index:e.index,length:e.length}})))}return t},V.prototype.serializeObjects=function(e){var t=this,r={};return e.merge&&(r.merge=l.serializeObjects(e.merge,null,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization)),e.remove&&(r.remove=_.map(e.remove,(function(e){return t.serializeObjectPropSelector(e)}))),r},V.prototype.serializeObjectPropSelector=function(e){return{object:e.object,property:e.property,selector:l.serializeSelector(e.selector)||null}},V.prototype.serializeHighlightState=function(e){return e.filterExpressionMetadata&&(this.version=h.max(this.version,c.v1_3)),{selection:l.serializeSelection(e.selection,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization),filterExpressionMetadata:e.filterExpressionMetadata?m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0}},f=V})(powerbi=powerbi||{}),(function(e){var s;e=e.explore||(e.explore={}),(e=(s=e.services||(e.services={})).WebBookmark||(s.WebBookmark={})).deserialize=function(e,t,r,i){var a=[],o={objectId:e.objectId,name:e.objectId,type:e.type};e.creationTime&&(o.creationTime=new Date(Date.parse(e.creationTime))),e.expirationTime&&(o.expirationTime=new Date(Date.parse(e.expirationTime))),e.displayName&&(o.displayName=e.displayName),e.isDefault&&(o.isDefault=e.isDefault),null!=e.id&&(o.id=e.id);try{var n=void 0;!e.explorationState||(n=jsCommon.JsonExtensions.tryParseJSON(e.explorationState))||a.push({code:0}),n&&(o.explorationState=s.ExplorationState.deserialize(n,t,r,i))}catch(e){a.push({code:1,message:e.message,stack:e.stack})}return e={contract:o},_.isEmpty(a)||(e.errors=a),e},e.serialize=function(e,t,r,i,a){var o={objectId:e.objectId,type:e.type};return e.creationTime&&(o.creationTime=e.creationTime.toISOString()),e.expirationTime&&(o.expirationTime=e.expirationTime.toISOString()),e.displayName&&(o.displayName=e.displayName),e.isDefault&&(o.isDefault=e.isDefault),null!=e.id&&(o.id=e.id),e.explorationState&&(e=s.ExplorationState.serialize(e.explorationState,t,i,a,r),o.explorationState=JSON.stringify(e)),o}})(powerbi=powerbi||{}),(function(e){var t,c,r;function i(e){e=t.createExplorationDowngrader(e).downgraders;this.objectsDowngrader=t.createVisualObjectsDowngrader(e)}e=(e=e.explore||(e.explore={})).services||(e.services={}),t=e.downgrade||(e.downgrade={}),c=jsCommon.Version,t.createExplorationStateDowngrader=function(e){return new r(e)},i.prototype.getFinalExplorationVersion=function(e,t){var r=e&&e.sections;if(r){for(var i=0,a=Object.keys(r);i<a.length;i++)for(var o=r[a[i]],n=0,s=Object.keys(o.visualContainers);n<s.length;n++){var l,p=s[n],p=o.visualContainers[p],u=p.singleVisual;u&&(u=u.visualType,(l=null==(l=p.singleVisual)?void 0:l.mobileVcObjects)&&(t=c.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(2,l,t,u))),(p=null==(l=p.singleVisual)?void 0:l.mobileObjects)&&(t=c.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(1,p,t,u))))}return t}},i.prototype.downgrade=function(e,t){var r=e&&e.sections;if(r)for(var i=0,a=Object.keys(r);i<a.length;i++)for(var o=r[a[i]],n=0,s=Object.keys(o.visualContainers);n<s.length;n++){var l,p,u=s[n],u=o.visualContainers[u].singleVisual;u&&(l=u.visualType,(p=u.mobileVcObjects)&&this.objectsDowngrader.downgrade(2,p,l,t),(p=u.mobileObjects)&&this.objectsDowngrader.downgrade(1,p,l,t))}},r=i,t.ExplorationStateDowngrader=r})(powerbi=powerbi||{}),(function(e){var t,r;function i(e){this.objectsUpgrader=t.createVisualObjectsUpgrader(t.createExplorationUpgrader(e).getVersionUpgraders())}e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=e.upgrade||(e.upgrade={})).createExplorationStateUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e,t){var r=e&&e.sections;if(r){for(var i=0,a=Object.keys(r);i<a.length;i++)for(var o=r[a[i]],n=0,s=Object.keys(o.visualContainers);n<s.length;n++){var l,p,u=s[n],u=o.visualContainers[u].singleVisual;u&&(l=u.visualType,(p=u.mobileVcObjects)&&this.objectsUpgrader.upgrade(2,p,l,t),(p=u.mobileObjects)&&this.objectsUpgrader.upgrade(1,p,l,t))}return e}},r=i,t.ExplorationStateUpgrader=r})(powerbi=powerbi||{}),(function(e){var t,r,n,i,a;function o(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v3_12_1||(r.v3_12_1={}),n=e.data.DataViewObjectDefinitions,i=e.visuals.plugins,t.createVersionUpgrader=function(){return new a},o.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n,s=o[a].config.singleVisual;s&&(n=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,n))}}},o.prototype.upgradeFilterCollection=function(e){},o.prototype.upgradeVisualObjects=function(e,t,r,i){},o.prototype.getVersion=function(){return r.ExplorationVersions.v3_12_1},o.prototype.upgradeObjects=function(e,t){return t===i.slicer.name?this.upgradeSlicerObjects(e):e},o.prototype.upgradeSlicerObjects=function(e){var t,r,i,a,o=n.getObjectDefinition(e=e||{},"general",null),o=o&&o.properties.filter,o=o&&o.filter;return o&&this.isAndFilter(o)&&((a=n.getObjectDefinition(e,"data",null))&&(t=a.properties.startDate,r=a.properties.endDate,i=a.properties.numericStart,a=a.properties.numericEnd,(t&&!r||i&&!a)&&this.BetweenToBeforeOrAfterFilter(o,1),(r&&!t||a&&!i)&&this.BetweenToBeforeOrAfterFilter(o,0))),e},o.prototype.isAndFilter=function(e){if(1===e.Where.length){e=e.Where[0].Condition;if(e&&e.And)return!0}return!1},o.prototype.BetweenToBeforeOrAfterFilter=function(e,t){var r=e.Where[0].Condition;return e.Where[0].Condition=0===t?r.And.Right:r.And.Left,e},a=o,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(c){var e,t,a,d,u,o,n,r;function i(e){this.featureSwitchService=e}function m(e,t,r){var i=h(r),t=t&&!_.isEmpty(t[i]);return"scatterChart"===r&&t&&null==a.getObjectDefinitionProperties(e,"fillPoint")&&((e=e||{}).fillPoint=[{properties:{show:{expr:o.serializeExpr(n.boolean(!0))}}}]),e}function h(e){switch(e){case"filledMap":return"Size";case"barChart":case"clusteredBarChart":case"clusteredColumnChart":case"columnChart":case"funnel":case"hundredPercentStackedBarChart":case"hundredPercentStackedColumnChart":case"map":case"treemap":case"scatterChart":return"Gradient"}}function f(e){switch(e){case"filledMap":case"barChart":case"clusteredBarChart":case"clusteredColumnChart":case"columnChart":case"funnel":case"hundredPercentStackedBarChart":case"hundredPercentStackedColumnChart":case"map":case"treemap":case"scatterChart":return"Tooltips"}}function y(e,t){return"filledMap"===e&&t&&!_.isEmpty(t.Series)&&!_.isEmpty(t.Size)}function v(e,t,r,i){var a,o=h(r);if(o){var n=t&&t[o];if(!_.isEmpty(n)){var s=n[0].queryRef;if(s){var l=_.cloneDeep(_.find(i&&i.Select,(function(e){return e.Name===s})));if(l){delete l.Name;var p=l.Aggregation||l.Measure;if(p){var u=p.Expression.Column&&p.Expression.Column.Expression.SourceRef||p.Expression.SourceRef;if(u){p=_.find(i.From,(function(e){return e.Name===u.Source}));if(p){u.Entity=p.Entity,delete u.Source;var c=e&&e.dataPoint;if(!_.isEmpty(c))for(var d=0,m=c;d<m.length;d++){var v,g=m[d];if(null==g.selector&&g.properties.fillRule){y(r,t)||(v=_.cloneDeep(g.properties.fillRule),c.push({selector:{data:[{dataViewWildcard:{matchingOption:1}}]},properties:((a={}).fill={solid:{color:{expr:{FillRule:{FillRule:(function(e){e.linearGradient2&&C(e.linearGradient2);e.linearGradient3&&C(e.linearGradient3);return e})(v),Input:l}}}}},a)})),c.splice(c.indexOf(g),1),delete t[o],!(function(t,e){for(var r in e){r=e[r];if(_.some(r,(function(e){return e.queryRef===t})))return 1}return})(s,t)&&(t[v=f(r)]||(t[v]=[]),(a=t[v]).push.apply(a,n||[]));break}}}}}}}}}}function s(e){e.color&&(e.color=e.color.expr);var t=e,t=(t.value&&(t.value=t.value.expr),e);t.strategy&&(t.strategy=t.strategy.expr)}function C(e){s(e.min),s(e.max),e.mid&&s(e.mid),e.nullColoringStrategy&&s(e.nullColoringStrategy)}e=(e=c.explore||(c.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v3_20||(t.v3_20={}),a=c.data.services.wireContracts.DataViewObjectDefinitions,d=c.data.DataViewWildcard,u=jsCommon.JsonExtensions,o=c.data.services.SemanticQuerySerializer,n=c.data.SQExprBuilder,e.createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){if(e)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o,n,s,l=a[i],p=l.config.singleVisual;p&&(o=p.visualType,n=p.projections,this.featureSwitchService.featureSwitches.cartesianConditionalFormatting&&(p.objects=m(p.objects,n,o),v(p.objects,n,o,p.prototypeQuery)),(s=u.tryParseJSON(l.dataTransforms))&&(this.featureSwitchService.featureSwitches.cartesianConditionalFormatting&&(s.objects=m(s.objects,n,o),v(s.objects,n,o,p.prototypeQuery)),l.dataTransforms=JSON.stringify(s)))}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationFeatureVersions.CartesianConditionalFormatting},r=i,e.VersionUpgrader=r,e.getFillRuleInputRoleFromVisualType=h,e.upgradeGradientOnObjectDef=function(e,t,r){var i=h(r);if(i){var a=t.getQueryRef(i,{fieldIndex:0});if(a){t.defn;var o=t.defn.select().withName(a),n=e&&e.dataPoint;if(!_.isEmpty(n))for(var s=0,l=n;s<l.length;s++){var p=l[s],u=p.properties.fillRule;if(null==p.selector&&u){y(r,t.projections)||n.push({selector:{data:[d.create(1)]},properties:{fill:{solid:{color:c.data.SQExprBuilder.fillRule(o.expr,u)}}}}),n.splice(n.indexOf(p),1),1===t.getUsageCount(a)&&(u=t.tryGetExpr(i,0),p=f(r),t.add(u,p)),t.removeProjection(i,{fieldIndex:0});break}}}}},e.upgradeGradientOnWireContractObjectDef=v})(powerbi=powerbi||{}),(function(e){var t,l,p,r;function i(){this.podNamePrefix="Pod"}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v3_24||(t.v3_24={}),l=jsCommon.JsonExtensions,p=jsCommon.StringExtensions,e.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections)){for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];this.upgradeSectionAcceptsAllFiltersWhenLinked(i)}for(var a=e.pods||[],o={},n=0,s=a;n<s.length;n++)o[s[n].name]=!0;for(var l=0,p=e.sections;l<p.length;l++){i=p[l];this.upgradeSection(i,a,o)}_.isEmpty(a)||(e.pods=a)}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v3_24},i.prototype.upgradeSectionAcceptsAllFiltersWhenLinked=function(e){e.config||(e.config={}),null==e.config.acceptsAllFiltersWhenLinked&&(1===e.config.type?e.config.acceptsAllFiltersWhenLinked=!0:0===e.config.type||null==e.config.type?e.config.acceptsAllFiltersWhenLinked=!1:e.config.type)},i.prototype.upgradeSection=function(e,t,r){var i,a,o;e&&e.name&&(i=l.tryParseJSON(e.filters)||[],a=_.some(i,(function(e){return 5===e.howCreated})),(o=this.findPodForSectionName(t,e.name))?this.upgradeExistingPod(o,e.config,a):a&&(o=this.createPod(t,e.name,e.config,r)),e.config&&(e.config.acceptsAllFiltersWhenLinked=void 0),o&&(this.upgradeFilters(o,i),e.filters=JSON.stringify(i)))},i.prototype.upgradeFilters=function(e,t){var r=[];p.isNullOrUndefinedOrWhiteSpaceString(e.parameters)||(r=l.tryParseJSON(e.parameters));for(var i=0,a=t;i<a.length;i++){var o,n,s=a[i];s.name&&!s.isTransient&&(o=5===s.howCreated,(n=this.findParamForFilterName(r,s.name))?(n.fieldExpr=s.expression,n.asAggregation=s.isLinkedAsAggregation,o||(n.isLegacySingleSelection=!0)):o&&(n={name:"Param_"+s.name,boundFilter:s.name,fieldExpr:s.expression,asAggregation:s.isLinkedAsAggregation},r.push(n)),s.isLinkedAsAggregation=void 0)}e.parameters=JSON.stringify(r)},i.prototype.upgradeExistingPod=function(e,t,r){e.config=this.createPodConfig(t),e.referenceScope=0,e.type=r?this.determineType(t):0},i.prototype.findParamForFilterName=function(e,t){if(!_.isEmpty(e))return _.find(e,(function(e){return e.boundFilter===t}))},i.prototype.findPodForSectionName=function(e,t){if(!_.isEmpty(e))return _.find(e,(function(e){return e.boundSection===t}))},i.prototype.createPod=function(e,t,r,i){t={name:p.findUniqueName(i,this.podNamePrefix),boundSection:t,type:this.determineType(r),referenceScope:0,config:this.createPodConfig(r)};return e.push(t),i[t.name]=!0,jsCommon.ArrayExtensions.hasUniqueNames(e),t},i.prototype.createPodConfig=function(e){e=!e||e.acceptsAllFiltersWhenLinked?0:1;return JSON.stringify({acceptsFilterContext:e})},i.prototype.determineType=function(e){return e&&0!==e.type&&void 0!==e.type?e&&1===e.type?2:void 0:1},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(n){var e,t,a,o,r;function i(){this.keyDriverObjectName="keyDrivers",this.selectedNumericAnalysisPropertyName="selectedNumericAnalysis"}e=(e=n.explore||(n.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v4_1||(t.v4_1={}),a=n.data.services.DataViewObjectSerializer,o=n.visuals.keyDriversNumericAnalysis,e.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;o&&o.visualType===n.visuals.plugins.keyDriversVisual.name&&(o.objects=this.upgradeKeyDriversVisualObjects(o.objects))}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v4_1},i.prototype.upgradeKeyDriversVisualObjects=function(e){var t,r,i=(e=e||{})[this.keyDriverObjectName];return(i=i||(e[this.keyDriverObjectName]=[{properties:{}}]))[0].properties[this.selectedNumericAnalysisPropertyName]||(t={enumeration:o.type},r=n.data.SQExprBuilder.typedConstant(o.categorical,t),i[0].properties[this.selectedNumericAnalysisPropertyName]=a.serializeObjectProperty(r,{type:t})),e},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(t){var e,r,i;function a(){}e=(e=t.explore||(t.explore={})).services||(e.services={}),(e=(r=e.upgrade||(e.upgrade={})).v5_11||(r.v5_11={})).createVersionUpgrader=function(){return new i},a.prototype.upgrade=function(e){this.forAllSectionsAllContainers(e,[t.visuals.plugins.lineChart.name,t.visuals.plugins.areaChart.name,t.visuals.plugins.stackedAreaChart.name],this.upgradeLineChartDotProperties)},a.prototype.forAllSectionsAllContainers=function(e,r,i){if(e&&!_.isEmpty(e.sections))for(var t=0,a=e.sections;t<a.length;t++)for(var o=0,n=a[t].visualContainers;o<n.length;o++)!(function(e){var t,e=e.config&&e.config.singleVisual;e&&e.objects&&(t=e&&e.visualType,_.findIndex(r,(function(e){return e===t}))<0||i(e.objects,e.projections))})(n[o])},a.prototype.upgradeLineChartDotProperties=function(e,t){var r=e.categoryAxis,i=e.dataPoint,e=e.lineStyles;if(r&&0!==r.length){r=r[0].properties;if(r&&r.axisType){r=r.axisType.expr.Literal.Value.replace(/['"]+/g,"");if(i&&"Categorical"===r&&t&&t.Category&&1===t.Category.length&&t.Category[0]){var a=t.Category[0].queryRef;if(a)for(var o=0;o<i.length;o++){var n,s=i[o].properties;_.keys(s).length,!s||!s.fill||1<_.keys(s).length||(s=i[o].selector)&&s.data&&1===s.data.length&&s.data[0]&&((s=s.data[0]).scopeId&&s.scopeId.Comparison&&s.scopeId.Comparison.Left&&s.scopeId.Comparison.Left.Column&&((n=(s=s.scopeId.Comparison.Left.Column).Property)&&s.Expression&&s.Expression.SourceRef&&((s=s.Expression.SourceRef.Entity)&&s+"."+n===a&&(i.splice(o,1),o--))))}}if(e&&0<e.length&&"Scalar"===r)for(var l=0,p=e;l<p.length;l++){var u=p[l];u.selector||(u=u.properties)&&u.showMarker&&("true"===(u=u.showMarker).expr.Literal.Value&&(u.expr.Literal.Value="false"))}}}},a.prototype.upgradeFilterCollection=function(){},a.prototype.upgradeVisualObjects=function(e,t,r,i){},a.prototype.getVersion=function(){return r.ExplorationVersions.v5_11},i=a,e.VersionUpgrader=i})(powerbi=powerbi||{}),(function(s){var e,t,l,p,a,r;function i(e){this.featureSwitchService=e}function o(e){return void 0!==e.children}e=(e=s.explore||(s.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v5_16||(t.v5_16={}),l=s.data.services.DataViewObjectSerializer,p=s.data.services.FilterExpressionMetadataSerializer,a=jsCommon.JsonExtensions,e.createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization&&e&&!(_.isEmpty(e.config.bookmarks)&&_.isEmpty(e.filters)&&_.isEmpty(e.sections))){_.isEmpty(e.config.bookmarks)||this.upgradeBookmarks(e.config.bookmarks),e.filters&&(e.filters=this.upgradeFilterContainers(e.filters));for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],n=o.config&&o.config.singleVisual,o=(n&&n.filterExpressionMetadata&&p.isFilterExpressionMetadata(n.filterExpressionMetadata)&&(n.filterExpressionMetadata=this.upgradeFilterExpressionMetadata(n.filterExpressionMetadata)),o.filters&&(o.filters=this.upgradeFilterContainers(o.filters)),n&&n.visualType);n&&n.objects&&o===s.visuals.plugins.textbox.name&&this.upgradeFilterContextProperties(n.objects)}}},i.prototype.upgradeFilterContextProperties=function(e){var t,r=this;for(t in e)for(var i=0,a=e[t];i<a.length;i++){var o,n=a[i];for(o in n.properties){var s=n.properties[o];l.isObjectPropertyWithContext(s)&&(s=(s=s.context)&&s.filterContext,_.isEmpty(s)||_.forEach(s,(function(e){e.metadata&&p.isFilterExpressionMetadata(e.metadata)&&(e.metadata=r.upgradeFilterExpressionMetadata(e.metadata))})))}}},i.prototype.upgradeBookmarks=function(e){for(var t=0,r=e;t<r.length;t++){var i,a=r[t];o(a)?this.upgradeBookmarks(a.children):(i=a.explorationState.sections,this.upgradeSectionState(i),(i=a.explorationState.filters)&&this.upgradeFilters(i))}},i.prototype.upgradeSectionState=function(e){var r=this;_.forEach(e,(function(e){_.forEach(e.visualContainers,(function(e){var t=e.highlight,t=(t&&t.selection&&l.isSelectorsByColumn(t.selection)&&(t.selection=r.upgradeSelectorsByColumn(t.selection)),t&&t.filterExpressionMetadata&&p.isFilterExpressionMetadata(t.filterExpressionMetadata)&&(t.filterExpressionMetadata=r.upgradeFilterExpressionMetadata(t.filterExpressionMetadata)),e.singleVisual);t.filterExpressionMetadata&&p.isFilterExpressionMetadata(t.filterExpressionMetadata)&&(t.filterExpressionMetadata=r.upgradeFilterExpressionMetadata(t.filterExpressionMetadata))})),e.filters&&r.upgradeFilters(e.filters)}))},i.prototype.upgradeFilters=function(e){var t=this;e.byName&&_.forEach(e.byName,(function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=t.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))})),e.byExpr&&this.upgradeFilterContainerState(e.byExpr),e.byTransientState&&this.upgradeFilterContainerState(e.byTransientState),e.byType&&this.upgradeFilterContainerState(e.byType)},i.prototype.upgradeFilterContainerState=function(e){var t=this;_.forEach(e,(function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=t.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))}))},i.prototype.upgradeSelectorsByColumn=function(e){e=_.map(e,(function(e){return l.deserializeSelectorsByColumn(e)})),e=s.data.DecomposedIdentities.decomposeSelectorsByColumn(e);return l.serializeDecomposedSelectors(e)},i.prototype.upgradeFilterExpressionMetadata=function(e){e=p.deserializeOldFilterExpressionMetadata(e),e=s.data.DecomposedIdentities.decomposeFilterExpressionMetadata(e);return l.serializeDecomposedFilterExpressionMetadata(e)},i.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},i.prototype.upgradeFilterContainer=function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=this.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))},i.prototype.getVersion=function(){return t.ExplorationVersions.v5_16},r=i,e.VersionUpgrader=r,e.isBookmarkGroup=o,e.isStateBookmark=function(e){return!o(e)}})(powerbi=powerbi||{}),(function(e){var t,r,i,a;function o(e){this.featureSwitchService=e}function C(e){return i.deserializeExpr(e.expr).value}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v5_25||(r.v5_25={}),i=e.data.services.SemanticQuerySerializer,t.createVersionUpgrader=function(e){return new a(e)},o.prototype.upgrade=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.buttonTileFormatting&&e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;if(o&&"actionButton"===o.visualType&&o.objects){var n=o.objects;if(n.text)for(var s,l,p=0,u=n.text;p<u.length;p++)(c=null==(f=u[p])?void 0:f.properties)&&(d=c.padding)&&(l=s=void 0,s=c.horizontalAlignment?C(c.horizontalAlignment):"right",l=c.verticalAlignment?C(c.verticalAlignment):"middle","left"===s?f.properties.leftMargin=d:"right"===s&&(f.properties.rightMargin=d),"top"===l?f.properties.topMargin=d:"bottom"===l&&(f.properties.bottomMargin=d),delete f.properties.padding);if(n.icon)for(var c,d,m=0,v=n.icon;m<v.length;m++)(c=null==(f=v[m])?void 0:f.properties)&&(d=c.padding)&&(f.properties.leftMargin=d,f.properties.rightMargin=d,f.properties.topMargin=d,f.properties.bottomMargin=d,delete f.properties.padding);if(n.outline)for(var g=0,h=n.outline;g<h.length;g++){var f,y=null==(f=h[g])?void 0:f.properties.roundEdge;y&&(n.shape=n.shape||[],n.shape.push({properties:{roundEdge:y},selector:f.selector}),delete f.properties.roundEdge)}}}},o.prototype.upgradeVisualObjects=function(e,t,r,i){},o.prototype.upgradeFilterCollection=function(){},o.prototype.getVersion=function(){return r.ExplorationVersions.v5_25},a=o,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(n){var e,o,s,l,t;function r(){}e=(e=n.explore||(n.explore={})).services||(e.services={}),e=(o=e.upgrade||(e.upgrade={})).v5_28||(o.v5_28={}),s=n.data.SQExprBuilder,l=n.data.services.SemanticQuerySerializer,e.createVersionUpgrader=function(){return new t},r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;o&&o.objects&&(o&&o.visualType)===n.visuals.plugins.azureMap.name&&this.upgradeAzureMapProperties(o.objects)}},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.upgradeAzureMapProperties=function(e){e=e.heatMapLayer;if(e&&0!==e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t];a.selector||(a=a.properties)&&a.heatMapOpacity&&(i=a.heatMapOpacity,i=Number(l.deserializeExpr(i.expr).value),i=isNaN(i)?0:100-100*i,delete a.heatMapOpacity,a.mapTransparency=o.UpgradeUtils.toExpr(s.integer(i)))}},r.prototype.upgradeFilterCollection=function(){},r.prototype.getVersion=function(){return o.ExplorationVersions.v5_28},t=r,e.VersionUpgrader=t})(powerbi=powerbi||{}),(function(a){var e,c,o,n,s,l,t,d,p,u,m,v,g,r,h,f,y,C,x,S,b,E,N,V,i,P,w,T,F;function j(e){this.featureSwitchService=e}function R(e){return t.deserializeExpr(e.expr).value}e=(e=a.explore||(a.explore={})).services||(e.services={}),e=(c=e.upgrade||(e.upgrade={})).v5_31||(c.v5_31={}),o=a.visuals.cartesianChartProps,n=a.visuals.legendMarkerRendering,s=a.visuals.lineChartProps,l=a.visuals.plugins,t=a.data.services.SemanticQuerySerializer,d=a.data.SQExprBuilder,e.createVersionUpgrader=function(e){return new r(e)},p=[l.tableEx.name,l.pivotTable.name,l.slicer.name,l.filterSlicer.name,l.multiRowCard.name],u=[l.barChart.name,l.clusteredBarChart.name,l.clusteredColumnChart.name,l.columnChart.name,l.hundredPercentStackedBarChart.name,l.hundredPercentStackedColumnChart.name,l.ribbonChart.name],m=[l.areaChart.name,l.barChart.name,l.clusteredBarChart.name,l.clusteredColumnChart.name,l.columnChart.name,l.hundredPercentStackedBarChart.name,l.hundredPercentStackedColumnChart.name,l.lineChart.name,l.lineClusteredColumnComboChart.name,l.lineStackedColumnComboChart.name,l.ribbonChart.name,l.scatterChart.name,l.stackedAreaChart.name,l.waterfallChart.name],v=[l.comboChart.name,l.dataDotClusteredColumnComboChart.name,l.dataDotStackedColumnComboChart.name,l.lineClusteredColumnComboChart.name,l.lineStackedColumnComboChart.name],g=[l.lineChart.name,l.areaChart.name,l.stackedAreaChart.name,l.lineStackedColumnComboChart.name,l.lineClusteredColumnComboChart.name],j.prototype.upgrade=function(e){},j.prototype.upgradeVisualObjects=function(e,t,r,i){1===e&&(_.some(u,(function(e){return e===r}))&&(this.upgradeCartesianAxisScale(t,o.categoryAxis.logAxisScale.objectName),this.upgradeCartesianAxisPosition(t,o.categoryAxis.switchAxisPosition.objectName)),_.some(m,(function(e){return e===r}))&&(this.upgradeCartesianAxisScale(t,o.valueAxis.logAxisScale.objectName),this.upgradeCartesianAxisPosition(t,o.valueAxis.switchAxisPosition.objectName)),_.some(v,(function(e){return e===r}))&&this.upgradeCartesianSecAxisScale(t,o.valueAxis.secLogAxisScale.objectName),_.some(g,(function(e){return e===r}))&&(this.upgradeCartesianSecAxisScale(t,o.y2Axis.secLogAxisScale.objectName),this.upgradeDefaultToCircle(t,s.legend.legendMarkerRendering.objectName)),this.featureSwitchService.featureSwitches.outlineDropdownToCheckboxes&&_.some(p,(function(e){return e===r}))&&this.upgradeOutlineProperties(t,r),this.featureSwitchService.featureSwitches.splitSubTotals&&r===l.pivotTable.name&&this.upgradeSubTotalsProperties(t),this.featureSwitchService.featureSwitches.splitGrandTotals&&r===l.pivotTable.name&&this.upgradeTotalProperties(t),r===a.visuals.plugins.scatterChart.name&&this.upgradeScatterChartFillPoint(t)),2===e&&(this.featureSwitchService.featureSwitches.splitHelpTooltip&&this.upgradeVisualHeaderTooltip(t),this.featureSwitchService.featureSwitches.showDefaultTooltip&&this.upgradeVisualLink(t))},j.prototype.upgradeCartesianAxisScale=function(e,t){var r;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.logAxisScale&&(r=o.categoryAxis,this.upgradeAxisScale(e,t,r.axisScale.propertyName,r.logAxisScale.propertyName))},j.prototype.upgradeCartesianSecAxisScale=function(e,t){var r;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.logAxisScale&&(r=o.valueAxis,this.upgradeAxisScale(e,t,r.secAxisScale.propertyName,r.secLogAxisScale.propertyName))},j.prototype.upgradeVisualHeaderTooltip=function(e){e=e[C];if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t].properties;!a||!a[S]||a[x]||(i=(i=a[S])&&R(i))&&i!==y&&(a[x]=c.UpgradeUtils.toExpr(d.text(f)))}},j.prototype.upgradeSubTotalsProperties=function(e){var t=e.subTotals;if(t&&0<t.length)for(var r=t.length,i=0;i<r;i++){var a=t[i],o=a.properties,n={properties:{}};if(o&&!a.selector){for(var s=0,l=h;s<l.length;s++){var p=l[s],u=o[p.propertyName];u&&(n.properties[p.propertyName]=u,delete o[p.propertyName])}_.isEmpty(n.properties)||(t.push(__assign(__assign({},n),{selector:{id:"Column"}})),t.push(__assign(__assign({},n),{selector:{id:"Row"}})))}}},j.prototype.upgradeVisualLink=function(e){if(this.featureSwitchService.featureSwitches.useModernFormatPane){e=e[b];if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t].properties;a&&a[E]&&(i=(i=a[E])&&R(i),i=c.UpgradeUtils.convertSuppressDefaultTooltip(i),a[N]=c.UpgradeUtils.toExpr(d.boolean(i)),delete a[E])}}},j.prototype.upgradeOutlineProperties=function(e,t){for(var r=0,i=this.getPropertiesToUpgrade(t);r<i.length;r++){var a=i[r],o=a.objectName,n=a.propertyName,a=e[o];if(a&&0!==a.length)for(var s=0,l=a;s<l.length;s++){var p,u=l[s].properties;u&&u[n]&&(p=R(u[n]),p=c.UpgradeUtils.convertOutlineValue(p),u[V]=c.UpgradeUtils.toExpr(d.integer(p)),delete u[n])}}},j.prototype.upgradeTotalProperties=function(e){var t=e.total;t&&0<t.length&&(e.rowTotal=_.cloneDeep(t),e.columnTotal=_.cloneDeep(t),delete e.total)},j.prototype.getPropertiesToUpgrade=function(e){switch(e){case l.tableEx.name:return i;case l.pivotTable.name:return P;case l.slicer.name:return w;case l.filterSlicer.name:return T;case l.multiRowCard.name:return F;default:return[]}},j.prototype.upgradeDefaultToCircle=function(e,t){var r,i,a;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.removeDefaultToCircleToggle&&(e=e[t],t=s.legend.defaultToCircle.propertyName,r=s.legend.legendMarkerRendering.propertyName,e&&0<e.length&&((e=e[0].properties)&&e[t]&&(i=void 0,e[r]&&(i=R(e[r])),a=R(e[t]),i!==n.markerOnly&&i||a?i===n.markerOnly&&a&&(e[r]=c.UpgradeUtils.toExpr(d.text(n.markerCircleDefault))):e[r]=c.UpgradeUtils.toExpr(d.text(n.markerOnly)),delete e[t])))},j.prototype.upgradeAxisScale=function(e,t,r,i){this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.logAxisScale&&((e=e[t])&&0<e.length&&((t=e[0].properties)&&t[r]&&(e=R(t[r]),e=c.UpgradeUtils.convertAxisScaleProperty(e),t[i]=c.UpgradeUtils.toExpr(d.boolean(e)),delete t[r])))},j.prototype.upgradeCartesianAxisPosition=function(e,t){var r,i;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.switchAxisPosition&&(e=e[t],t=o.categoryAxis.position.propertyName,r=o.categoryAxis.switchAxisPosition.propertyName,e&&0<e.length&&((e=e[0].properties)&&e[t]&&(i=R(e[t]),i=c.UpgradeUtils.convertAxisPositionProperty(i),e[r]=c.UpgradeUtils.toExpr(d.boolean(i)),delete e[t])))},j.prototype.upgradeScatterChartFillPoint=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.fillPointStyle){e=e.fillPoint;if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t];a.selector||(a=a.properties)&&a.show&&(i=R(a.show),i=c.UpgradeUtils.convertScatterChartFillPoint(i),a.style=c.UpgradeUtils.toExpr(d.text(i)),delete a.show)}}},j.prototype.upgradeFilterCollection=function(){},j.prototype.getVersion=function(){return c.ExplorationVersions.v5_31},r=j,e.VersionUpgrader=r,h=[{objectName:"subTotals",propertyName:"fontColor"},{objectName:"subTotals",propertyName:"fontFamily"},{objectName:"subTotals",propertyName:"fontSize"},{objectName:"subTotals",propertyName:"bold"},{objectName:"subTotals",propertyName:"italic"},{objectName:"subTotals",propertyName:"underline"},{objectName:"subTotals",propertyName:"backColor"},{objectName:"subTotals",propertyName:"applyToHeaders"}],f="Canvas",y="none",C="visualHeaderTooltip",x="type",S="section",b="visualLink",E="suppressDefaultTooltip",N="showDefaultTooltip",V="outlineStyle",i=[{objectName:"grid",propertyName:"outline"},{objectName:"columnHeaders",propertyName:"outline"},{objectName:"values",propertyName:"outline"},{objectName:"total",propertyName:"outline"}],P=[{objectName:"grid",propertyName:"outline"},{objectName:"columnHeaders",propertyName:"outline"},{objectName:"values",propertyName:"outline"},{objectName:"rowHeaders",propertyName:"outline"}],w=[{objectName:"searchBox",propertyName:"outline"},{objectName:"items",propertyName:"outline"},{objectName:"header",propertyName:"outline"}],T=[{objectName:"searchBox",propertyName:"outline"},{objectName:"items",propertyName:"outline"},{objectName:"header",propertyName:"outline"}],F=[{objectName:"card",propertyName:"outline"}]})(powerbi=powerbi||{}),(function(e){var t,a,o,r,n,s,l,i;function p(e){this.featureSwitchService=e}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(a=t.upgrade||(t.upgrade={})).v5_33||(a.v5_33={}),o=e.visuals.cartesianChartProps,r=e.visuals.plugins,n=e.data.services.SemanticQuerySerializer,s=e.data.SQExprBuilder,t.createVersionUpgrader=function(e){return new i(e)},l=[r.areaChart.name,r.lineChart.name,r.lineClusteredColumnComboChart.name,r.lineStackedColumnComboChart.name,r.scatterChart.name,r.stackedAreaChart.name],p.prototype.upgrade=function(e){},p.prototype.upgradeVisualObjects=function(e,t,r,i){this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.remainingCartesianCategoryLogAxisScale&&1===e&&_.some(l,(function(e){return e===r}))&&this.upgradeCartesianAxisScale(t,o.categoryAxis.logAxisScale.objectName)},p.prototype.upgradeCartesianAxisScale=function(e,t){var r=o.categoryAxis;this.upgradeAxisScale(e,t,r.axisScale.propertyName,r.logAxisScale.propertyName)},p.prototype.upgradeAxisScale=function(e,t,r,i){var e=e[t];e&&0<e.length&&((t=e[0].properties)&&(t[i]&&t[r]?delete t[r]:t[r]&&(e=t[r],e=n.deserializeExpr(e.expr).value,e=a.UpgradeUtils.convertAxisScaleProperty(e),t[i]=a.UpgradeUtils.toExpr(s.boolean(e)),delete t[r])))},p.prototype.upgradeFilterCollection=function(){},p.prototype.getVersion=function(){return a.ExplorationVersions.v5_33},i=p,t.VersionUpgrader=i})(powerbi=powerbi||{}),(function(e){var t,u,r;function i(e){this.featureSwitchService=e}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v5_38||(t.v5_38={}),u=jsCommon.JsonExtensions,e.createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){this.featureSwitchService.featureSwitches.onObject&&this.upgradeDrillthroughTargetRegularSections(e)},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return t.ExplorationVersions.v5_38},i.prototype.upgradeDrillthroughTargetRegularSections=function(e){if(!_.isEmpty(null==e?void 0:e.sections)&&!_.isEmpty(e.pods)){for(var t={},r=0,i=e.pods;r<i.length;r++){var a=i[r],o=a.boundSection;_.isEmpty(o)||t[o]||1!==a.type||StringExtensions.isNullOrUndefinedOrWhiteSpaceString(a.parameters)||(o=u.tryParseJSON(a.parameters),_.some(o,(function(e){return!!e.fieldExpr}))&&(t[a.boundSection]=!0))}for(var n=0,s=e.sections;n<s.length;n++){var l=s[n],p=null==(p=l.config)?void 0:p.type;(null==p||0===p)&&t[l.name]&&(l.config||(l.config={}),l.config.type=2)}}},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(e){var t,r;function i(e){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(e=(t=e.upgrade||(e.upgrade={})).v5_9||(t.v5_9={})).createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o,n=a[i],n=n.config&&n.config.singleVisual;n&&n.objects&&("pivotTable"!==(o=n&&n.visualType)&&"tableEx"!==o||this.upgradeTablixProperties(n.objects,o))}},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeTablixProperties=function(e,t){e=e.values;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r];this.isValidRoleWildcard(a.selector,t)&&a.properties&&(a.properties.backColor||a.properties.fontColor)&&(a.selector.data=[{dataViewWildcard:{matchingOption:1}}])}},i.prototype.isValidRoleWildcard=function(e,t){return!(!e||_.isEmpty(e.data)||1!==e.data.length||_.isEmpty(e.data[0].roles))&&("tableEx"===t&&_.isEqual(e.data[0].roles,["Values"])||"pivotTable"===t&&_.isEqual(e.data[0].roles,["Rows","Columns"]))},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return t.ExplorationVersions.v5_9},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(e){var s,t;function r(e){this.downgraders=e}e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).downgrade||(e.downgrade={}),s=jsCommon.Version,e.createVisualObjectsDowngrader=function(e){return new t(e)},r.prototype.getFinalVisualObjectsVersion=function(e,t,r,i){for(var a=0,o=this.downgraders;a<o.length;a++){var n=o[a];r=s.max(r,n.getMinDowngradeVersionForVisualObjects(e,t,i))}return r},r.prototype.downgrade=function(e,t,r,i){for(var a=0,o=this.downgraders;a<o.length;a++)o[a].downgradeVisualObjects(e,t,r,i)},t=r,e.VisualObjectsDowngrader=t})(powerbi=powerbi||{}),(function(e){var l,t;function r(e){this.upgraders=e}e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={}),l=jsCommon.Version,e.createVisualObjectsUpgrader=function(e){return new t(e)},r.prototype.upgrade=function(e,t,r,i){for(var a=0,o=this.upgraders;a<o.length;a++){var n=o[a],s=n.getVersion();l.gt(s,i)&&n.upgradeVisualObjects(e,t,r,i)}},t=r,e.VisualObjectsUpgrader=t})(powerbi=powerbi||{}),(function(A){!(function(r){var e=A.formattingService,t=jsCommon.Lazy,s=jsCommon.StringExtensions;function i(e,t,r){this.op=e,this.onOperatorChanged(),this.isCalendarShown=!1,this.value=new V(t,r)}Object.defineProperty(i.prototype,"operator",{get:function(){return this.op},set:function(e){this.op!==e&&(this.op=e,this.onOperatorChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"valueRequired",{get:function(){return this.valRequired},enumerable:!1,configurable:!0}),i.prototype.accept=function(e){return e.visit(this)},i.empty=function(){return new i(0)},i.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&(e.operator===t.operator&&V.equals(e.value,t.value))},i.prototype.onOperatorChanged=function(){this.valRequired=a.getValueRequired(this.operator),this.valRequired?this.cachedValue&&(this.value=this.cachedValue,this.cachedValue=void 0):this.value&&(this.cachedValue=this.value,this.value=void 0)},r.Condition=i;Object.defineProperty(P.prototype,"isDate",{get:function(){return null!=this.dateValue},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"hasValue",{get:function(){return null!=this.dateValue||!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(this.stringValue)},enumerable:!1,configurable:!0}),P.prototype.isValidDate=function(){return this.isDate&&(!_.isString(this.value)||null!==e.parseDate(this.value))},P.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&(P.compareDateTimeValue(e,t)&&e.stringValue===t.stringValue)},P.compareDateTimeValue=function(e,t){return(e.dateValue?e.dateValue.valueOf():0)===(t.dateValue?t.dateValue.valueOf():0)};var a,o,n,l,p,u,c,d,m,v,g,h,f,y,C,x,S,b,E,N,V=P;function P(e,t){null!=e&&(e instanceof Date&&(this.dateValue=e),this.value=e,this.formatter=t,this.stringValue=this.formatter?this.formatter.format(this.value):this.value.toString()),this.dateValue?this.timeValue=new Date(this.dateValue.getTime()):(this.timeValue=new Date,this.timeValue.setHours(0,0,0,0))}function w(){var e=[];return e.push(n.getValue()),e}function T(e,t){var r;if(0<e.length){for(var i=[],a=0,o=e;a<o.length;a++){var n=o[a];i.push(j(n))}r=A.visuals.valueFormatter.formatListOr(i),r=t?s.format(A.common.getLocalize().get("FilterRestatement_NotEqual"),r):s.format(A.common.getLocalize().get("FilterRestatement_Equal"),r)}return r}function F(e,t){e=r.SQExprConverter.getFirstComparandValue(e);return t?t.format(e):e}function j(e){return null===e?null:_.isString(e)?e:e.displayName||("function"!=typeof e||"object"!=typeof e?e:void 0)}r.ConditionValue=V,o=a=r.OperatorHelper||(r.OperatorHelper={}),n=new t(function(){return{value:9,label:A.common.getLocalize().get("FilterOperator_Is"),tooltip:A.common.getLocalize().get("FilterOperator_IsTooltip")}}),l=new t(function(){return{value:10,label:A.common.getLocalize().get("FilterOperator_IsNot"),tooltip:A.common.getLocalize().get("FilterOperator_IsNotTooltip")}}),p=new t(function(){return{value:11,label:A.common.getLocalize().get("FilterOperator_IsBlank"),tooltip:A.common.getLocalize().get("FilterOperator_IsBlankTooltip")}}),u=new t(function(){return{value:12,label:A.common.getLocalize().get("FilterOperator_IsNotBlank"),tooltip:A.common.getLocalize().get("FilterOperator_IsNotBlankTooltip")}}),c=new t(function(){return{value:5,label:A.common.getLocalize().get("FilterOperator_Contains"),tooltip:A.common.getLocalize().get("FilterOperator_ContainsTooltip")}}),d=new t(function(){return{value:6,label:A.common.getLocalize().get("FilterOperator_DoesNotContain"),tooltip:A.common.getLocalize().get("FilterOperator_DoesNotContainTooltip")}}),m=new t(function(){return{value:7,label:A.common.getLocalize().get("FilterOperator_StartsWith"),tooltip:A.common.getLocalize().get("FilterOperator_StartsWithTooltip")}}),v=new t(function(){return{value:8,label:A.common.getLocalize().get("FilterOperator_DoesNotStartWith"),tooltip:A.common.getLocalize().get("FilterOperator_DoesNotStartWithTooltip")}}),g=new t(function(){return{value:13,label:A.common.getLocalize().get("FilterOperator_IsEmptyString"),tooltip:A.common.getLocalize().get("FilterOperator_IsEmptyStringTooltip")}}),h=new t(function(){return{value:14,label:A.common.getLocalize().get("FilterOperator_IsNotEmptyString"),tooltip:A.common.getLocalize().get("FilterOperator_IsNotEmptyStringTooltip")}}),f=new t(function(){return{value:3,label:A.common.getLocalize().get("FilterOperator_GreaterThan_DT"),tooltip:A.common.getLocalize().get("FilterOperator_GreaterThan_DT")}}),y=new t(function(){return{value:4,label:A.common.getLocalize().get("FilterOperator_GreaterThanOrEqual_DT"),tooltip:A.common.getLocalize().get("FilterOperator_GreaterThanOrEqual_DT")}}),C=new t(function(){return{value:1,label:A.common.getLocalize().get("FilterOperator_LessThan_DT"),tooltip:A.common.getLocalize().get("FilterOperator_LessThan_DT")}}),x=new t(function(){return{value:2,label:A.common.getLocalize().get("FilterOperator_LessThanOrEqual_DT"),tooltip:A.common.getLocalize().get("FilterOperator_LessThanOrEqual_DT")}}),S=new t(function(){return{value:3,label:A.common.getLocalize().get("FilterOperator_GreaterThan"),tooltip:A.common.getLocalize().get("FilterOperator_GreaterThan")}}),b=new t(function(){return{value:4,label:A.common.getLocalize().get("FilterOperator_GreaterThanOrEqual"),tooltip:A.common.getLocalize().get("FilterOperator_GreaterThanOrEqual")}}),E=new t(function(){return{value:1,label:A.common.getLocalize().get("FilterOperator_LessThan"),tooltip:A.common.getLocalize().get("FilterOperator_LessThan")}}),N=new t(function(){return{value:2,label:A.common.getLocalize().get("FilterOperator_LessThanOrEqual"),tooltip:A.common.getLocalize().get("FilterOperator_LessThanOrEqual")}}),o.getValueRequired=function(e){return 11!==e&&12!==e&&0!==e&&13!==e&&14!==e},o.getFilterOperators=function(e,t){return t?w():e.text?((t=[]).push(c.getValue()),t.push(d.getValue()),t.push(m.getValue()),t.push(v.getValue()),t.push(n.getValue()),t.push(l.getValue()),t.push(p.getValue()),t.push(u.getValue()),t.push(g.getValue()),t.push(h.getValue()),t):e.integer||e.numeric?((t=[]).push(E.getValue()),t.push(N.getValue()),t.push(S.getValue()),t.push(b.getValue()),t.push(n.getValue()),t.push(l.getValue()),t.push(p.getValue()),t.push(u.getValue()),t):e.dateTime?((t=[]).push(n.getValue()),t.push(l.getValue()),t.push(f.getValue()),t.push(y.getValue()),t.push(C.getValue()),t.push(x.getValue()),t.push(p.getValue()),t.push(u.getValue()),t):void 0},o.isOperatorForColumnMappedToMParameter=function(t){return w().some((function(e){return e.value===t}))},(t=r.RestatementHelper||(r.RestatementHelper={})).fromCondition=function(e,t,r,i){for(var a,o=new R(t,r,i),n=0,s=e;n<s.length;n++){var l=s[n];null!=l.operator&&0!==l.operator&&(a=l.accept(o))}return a},t.fromLabels=T,t.fromDataViewScopeIdentities=function(e,t,r){for(var i=[],a=0,o=e;a<o.length;a++){var n=o[a];i.push(F(n,r))}return T(i,t)},t.getLabelFromScopeId=F,t.fromDefault=function(e){if(null!=e)return s.format(A.common.getLocalize().get("FilterRestatement_IsDefault"),j(e))};D.prototype.visit=function(e){e=this.conditionToString(e);if(e)return _.isEmpty(this.result)?this.result=e:(_.isEmpty(this.logicalOperatorResourceId),this.result=s.format(this.logicalOperatorResourceId,this.result,e)),this.result},D.prototype.conditionToString=function(e){var t,r=e.value;if(!a.getValueRequired(e.operator)||r&&r.hasValue)switch(r&&(t=this.formatter?this.formatter.format(r.value||r.stringValue):r.stringValue),e.operator){case 9:return s.format(this.localizationService.get("FilterRestatement_Equal"),t);case 10:return s.format(this.localizationService.get("FilterRestatement_NotEqual"),t);case 3:return r.isDate?s.format(this.localizationService.get("FilterRestatement_GreaterThan_DT"),t):s.format(this.localizationService.get("FilterRestatement_GreaterThan"),t);case 4:return r.isDate?s.format(this.localizationService.get("FilterRestatement_GreaterThanOrEqual_DT"),t):s.format(this.localizationService.get("FilterRestatement_GreaterThanOrEqual"),t);case 1:return r.isDate?s.format(this.localizationService.get("FilterRestatement_LessThan_DT"),t):s.format(this.localizationService.get("FilterRestatement_LessThan"),t);case 2:return r.isDate?s.format(this.localizationService.get("FilterRestatement_LessThanOrEqual_DT"),t):s.format(this.localizationService.get("FilterRestatement_LessThanOrEqual"),t);case 5:return s.format(this.localizationService.get("FilterRestatement_Contains"),t);case 6:return s.format(this.localizationService.get("FilterRestatement_DoesNotContain"),t);case 7:return s.format(this.localizationService.get("FilterRestatement_StartWith"),t);case 8:return s.format(this.localizationService.get("FilterRestatement_DoesNotStartWith"),t);case 11:return this.localizationService.get("FilterOperator_IsBlank");case 12:return this.localizationService.get("FilterOperator_IsNotBlank");case 13:return this.localizationService.get("FilterOperator_IsEmptyString");case 14:return this.localizationService.get("FilterOperator_IsNotEmptyString");default:return""}};var R=D;function D(e,t,r){void 0===r&&(r=A.common.getLocalize()),this.localizationService=r,0===e?this.logicalOperatorResourceId=this.localizationService.get("FilterRestatement_CompoundAnd"):1===e&&(this.logicalOperatorResourceId=this.localizationService.get("Generic_Or")),this.formatter=t}})(A.data||(A.data={}))})(powerbi=powerbi||{}),(function(e){var i;function r(e,t){var r=e.value,i=e.unit,a=e.isTimeUnit;switch(i){case"S":return 1===r?t.get("TimeUnit_Second"):t.get("TimeUnit_Seconds");case"M":return a?1===r?t.get("TimeUnit_Minute"):t.get("TimeUnit_Minutes"):1===r?t.get("TimeUnit_Month"):t.get("TimeUnit_Months");case"H":return 1===r?t.get("TimeUnit_Hour"):t.get("TimeUnit_Hours");case"D":return 1===r?t.get("TimeUnit_Day"):t.get("TimeUnit_Days");case"W":return 1===r?t.get("TimeUnit_Week"):t.get("TimeUnit_Weeks");case"Y":return 1===r?t.get("TimeUnit_Year"):t.get("TimeUnit_Years");default:return""}}function a(e){switch(e){case"S":case"M":case"H":return!0;default:return!1}}function o(e,t){e=[{value:e,unit:t,isTimeUnit:a(t)}],t=i.DurationParser.durationParseResultItemsToDurationParseResult(e);return i.DurationParser.durationParseResultAsMilliseconds(t)}function n(e,t){t=Math.pow(10,t||0);return Math.round(e*t)/t}e=e.explore||(e.explore={}),(e=(i=e.util||(e.util={})).DurationDisplayHelper||(i.DurationDisplayHelper={})).isBelowMinimumValue=function(e,t,r){return o(e,t)<(r&&""!==r?i.DurationParser.durationParseResultAsMilliseconds(i.DurationParser.parseISODurationdString(r)):-Number.MAX_VALUE)},e.isAboveMaximumValue=function(e,t,r){return e=o(e,t),(r&&""!==r?i.DurationParser.durationParseResultAsMilliseconds(i.DurationParser.parseISODurationdString(r)):Number.MAX_VALUE)<e},e.getFullUnitName=r,e.getReadableTimeString=function(e,t){return e=i.DurationParser.parseISODurationdString(e),(e=i.DurationParser.durationParseResultToArray(e)).length<=0?"":e[0].value+" "+r(e[0],t)},e.isTimeUnit=a,e.convertSecondsToTimeString=function(e,t){return isNaN(e)?t.get("TwoDashes"):e<60?1===e?t.get("TimeUnit_One_second"):t.format("TimeUnit_seconds_with_value",[n(e,1)]):(e/=60)<60?1===e?t.get("TimeUnit_One_minute"):t.format("TimeUnit_minutes_with_value",[n(e,1)]):1===(e/=60)?t.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_OneHour"):t.format("TimeUnit_hours_with_value",[n(e,1)])},e.getTimeString=function(e,t){var r=e.value,i=e.unit,a=e.isTimeUnit;switch(i){case"S":return 1===r?t.get("TimeUnit_One_second"):t.format("TimeUnit_seconds_with_value",r);case"M":return a?1===r?t.get("TimeUnit_One_minute"):t.format("CdsaAuthoring_Iframe_TheNumberOfHowManyMinutes",r):1===r?t.get("TimeUnit_One_month"):t.format("TimeUnit_months_with_value",r);case"H":return 1===r?t.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_OneHour"):t.format("TimeUnit_hours_with_value",r);case"D":return 1===r?t.get("TimeUnit_One_day"):t.format("TimeUnit_days_with_value",r);case"W":return 1===r?t.get("TimeUnit_One_week"):t.format("TimeUnit_weeks_with_value",r);case"Y":return 1===r?t.get("TimeUnit_One_year"):t.format("TimeUnit_years_with_value",r);default:return""}}})(powerbi=powerbi||{}),(function(g){var e,a,h,f,y,o;function n(i,a){if(!i||!a)return i||a;for(var o={expressions:a.expressions.slice(),cachedValueItems:_.isEmpty(a.cachedValueItems)?[]:a.cachedValueItems.slice()},n={},e=0;e<i.expressions.length;e++)!(function(e){var t=i.expressions[e],r=_.findIndex(o.expressions,(function(e){return e===t||y.equals(e,t)}));-1===r&&(r=a.expressions.length,o.expressions.push(t)),n[e]=r})(e);if(!_.isEmpty(i.cachedValueItems))for(var t=0,r=i.cachedValueItems;t<r.length;t++){var s,l=r[t],p={};for(s in l.valueMap)p[n[s]]=l.valueMap[s];o.cachedValueItems.push({identities:l.identities,valueMap:p})}return o}function s(e,t){if(!_.isEmpty(e)){for(var r={expressions:[],cachedValueItems:[]},i=0,a=e;i<a.length;i++){var o,n=a[i],s={identities:[],valueMap:{}};n.valueDetails||(o=h.getDataViewKind(t),n.valueDetails=h.query([t],n,o,[],!0));for(var l=0,p=n.valueDetails;l<p.length;l++){var u,c=p[l];c.expr&&(y.isColumn(c.expr)||y.isHierarchyLevel(c.expr))&&((u=_.indexOf(r.expressions,c.expr))<0&&(r.expressions.push(c.expr),u=r.expressions.length-1),s.valueMap[u]=c.formattedValue)}if(!_.isEmpty(s.valueMap)){for(var d in n.dataMap)for(var m=0,v=jsCommon.ArrayExtensions.ensureArray(n.dataMap[d]);m<v.length;m++){var g=v[m];1===g.kind&&s.identities.push(g)}r.cachedValueItems.push(s)}}return r}}function l(e,t){if(!_.isEmpty(e))return r(_.map(e,(function(e){return f.convertSelectorsByColumnToSelector(e)})),t)}function r(e,t){if(!_.isEmpty(e)&&t&&t.query)for(var r=t.query.defn.select(),i=0,a=e;i<a.length;i++){var o=a[i],o=f.toScopeIdentities(o);if(_.isEmpty(o))return;for(var n=0,s=o;n<s.length;n++)for(var l=s[n].expr,l=g.data.ScopeIdentityExtractor.getKeys(l),p=0,u=l;p<u.length;p++)for(var c=u[p],d=0,m=r;d<m.length;d++){var v=m[d];if(!y.equals(c,v.expr))return!0}}}e=g.explore||(g.explore={}),a=e.FilterExpressionMetadataUtils||(e.FilterExpressionMetadataUtils={}),h=g.data.DataViewQueryEngine,f=g.data.Selector,y=g.data.SQExpr,o=g.data.SQExprBuilder,a.getSelectorsByColumnMetadata=function(e,t,r,i){if(void 0===i&&(i=!1),!_.isEmpty(e)&&l(e,t))return _.some(e,(function(e){return e.valueDetails}))&&i?s(e,r):(t=h.getDataPointsDescription(r,e),a.convertToFilterExpressionMetadata(t))},a.mergeFilterExpressionMetadata=n,a.mergeFilterExpressionMetadataArray=function(e){for(var t=null,r=0,i=e;r<i.length;r++)t=n(i[r],t);return t},a.convertCacheToFilterExpressionMetadata=function(e,t){if(!_.isEmpty(t)&&e){for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i],n={identities:[o.identity],valueMap:{}};n.valueMap[0]=o.displayName,r.push(n)}return{expressions:[e],cachedValueItems:r}}},a.hydrateSelectorsByColumnWithValueDetails=function(m,v){if(m.length&&v.cachedValueItems&&v.cachedValueItems.length)for(var e=0;e<m.length;e++)!(function(e){var t=m[e],n=t.dataMap,r=e,i=v.cachedValueItems[r].identities,a=!0,o=0;for(u in n)for(var s=0,l=jsCommon.ArrayExtensions.ensureArray(n[u]);s<l.length;s++){var p=l[s];if(!i[o]||!g.DataViewScopeIdentity.equals(p,i[o])){a=!1;break}o++}if((r=a?r:_.findIndex(v.cachedValueItems,(function(e){var t,r=0;for(t in n)for(var i=0,a=jsCommon.ArrayExtensions.ensureArray(n[t]);i<a.length;i++){var o=a[i];if(!e.identities[r]||!g.DataViewScopeIdentity.equals(o,e.identities[r]))return!1;r++}return!0})))<0)return;var u,c=[],d=v.cachedValueItems[r].valueMap;for(u in d)c.push({identity:v.cachedValueItems[r].identities[0],expr:v.expressions[u],formattedValue:d[u],value:d[u]});t.valueDetails=c})(e)},a.buildFilterExpressionMetadataFromSelectors=s,a.convertToFilterExpressionMetadata=function(e){if(!_.isEmpty(e)){for(var t={expressions:[],cachedValueItems:[]},r=0,i=e;r<i.length;r++){for(var a=i[r],o={identities:[],valueMap:{}},n=0,s=a.selector.data;n<s.length;n++){var l=s[n];1===l.kind&&o.identities.push(l)}for(var p=0,u=a.values;p<u.length;p++){var c,d=u[p];(d.expr instanceof g.data.SQColumnRefExpr||y.isHierarchyLevel(d.expr))&&((c=_.indexOf(t.expressions,d.expr))<0&&(t.expressions.push(d.expr),c=t.expressions.length-1),o.valueMap[c]=d.formattedValue)}_.isEmpty(o.valueMap)||t.cachedValueItems.push(o)}return t}},a.tryGetDisplayNameIdentityPairs=function(e){if(e&&!(_.isEmpty(e.expressions)||1<e.expressions.length)){for(var t=[],r=0,i=e.cachedValueItems;r<i.length;r++){var a=i[r];if(_.isEmpty(a.identities)||1<a.identities.length)return;a.valueMap[0];a={identity:a.identities[0],displayName:a.valueMap[0]};t.push(a)}return t}},a.hasGroupOnKeysByColumn=l,a.hasGroupOnKeys=r,a.isDecomposedFilterExpressionMetadata=function(e){return!!e.decomposedIdentities},a.isFilterExpressionMetadata=function(e){return!!e.cachedValueItems},a.makeIdentity=function(e,t){if(!e)return null;for(var r=0;r<e.length;r++)var i=o.equal(e[r],t[r]),a=a?o.and(a,i):i;return g.data.createDataViewScopeIdentity(a)}})(powerbi=powerbi||{}),(function(e){var r;function i(e,t){e=e&&parseFloat(e.replace(",","."));return(isNaN(e)?0:e)*t}e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).DurationParser||(e.DurationParser={}),r=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,e.parseISODurationdString=function(e){return e=e,e=r.exec(e)||new Array(9),t="-"===e[1]?-1:1,{years:i(e[2],t),months:i(e[3],t),weeks:i(e[4],t),days:i(e[5],t),hours:i(e[6],t),minutes:i(e[7],t),seconds:i(e[8],t)};var t},e.durationParseResultAsMilliseconds=function(e){return 31536e6*e.years+2592e6*e.months+6048e5*e.weeks+864e5*e.days+36e5*e.hours+6e4*e.minutes+1e3*e.seconds},e.durationParseResultItemsToDurationParseResult=function(e){for(var t={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0},r=0,i=e;r<i.length;r++){var a=i[r],o=a.value;a.isTimeUnit&&"S"===a.unit?t.seconds=o:a.isTimeUnit&&"M"===a.unit?t.minutes=o:a.isTimeUnit&&"H"===a.unit?t.hours=o:"D"===a.unit?t.days=o:"W"===a.unit?t.weeks=o:"M"===a.unit?t.months=o:"Y"===a.unit&&(t.years=o)}return t},e.durationParseResultToISODurationString=function(e){var t="P";return 0<e.years&&(t+=e.years+"Y"),0<e.months&&(t+=e.months+"M"),0<e.weeks&&(t+=e.weeks+"W"),0<e.days&&(t+=e.days+"D"),0===e.hours&&0===e.minutes&&0===e.seconds||(t+="T",0<e.hours&&(t+=e.hours+"H"),0<e.minutes&&(t+=e.minutes+"M"),0<e.seconds&&(t+=e.seconds+"S")),t},e.durationParseResultToArray=function(e){var t=[];return e.seconds&&t.push({value:e.seconds,unit:"S",isTimeUnit:!0}),e.minutes&&t.push({value:e.minutes,unit:"M",isTimeUnit:!0}),e.hours&&t.push({value:e.hours,unit:"H",isTimeUnit:!0}),e.days&&t.push({value:e.days,unit:"D",isTimeUnit:!1}),e.weeks&&t.push({value:e.weeks,unit:"W",isTimeUnit:!1}),e.months&&t.push({value:e.months,unit:"M",isTimeUnit:!1}),e.years&&t.push({value:e.years,unit:"Y",isTimeUnit:!1}),t}})(powerbi=powerbi||{}),(function(e){var i,t,a;function r(e){return!(null==(e=e.dynamicConfig)||!e.quickExplore)}i=e.explore||(e.explore={}),t=i.SectionUtils||(i.SectionUtils={}),a=e.explore.util.VisualContainerUtils,t.isQuickExploreSection=r,t.areAnySectionQuickExplore=function(e){return _.some(e,r)},t.getQuickExploreLayoutTelemetry=function(e){if(e=null==(e=null==(e=null==e?void 0:e.dynamicConfig)?void 0:e.quickExplore)?void 0:e.layout)return e.combination?"Combination."+e.combination.version:e.related?"Related."+e.related.version:void 0},t.setUniqueNewSectionCanvasItemNames=function(e,t){var r=_.flatMap(t,(function(e){return e.visualContainerGroups}));_.isEmpty(r)||i.contracts.traverseVisualContainerGroups(e.visualContainerGroups,(function(e){var t=a.uniqueName(r);e.name=t,r.push(e)}))}})(powerbi=powerbi||{});;
"use strict";var powerbi,__extends=this&&this.__extends||(function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}})(),__awaiter=this&&this.__awaiter||function(e,o,s,l){return new(s=s||Promise)(function(i,t){function r(e){try{a(l.next(e))}catch(e){t(e)}}function n(e){try{a(l.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,n)}a((l=l.apply(e,o||[])).next())})},__generator=this&&this.__generator||function(r,n){var a,o,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,o=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=n.call(r,l)}catch(e){t=[6,e],o=0}finally{a=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__spreadArray=this&&this.__spreadArray||function(e,t){for(var i=0,r=t.length,n=e.length;i<r;i++,n++)e[n]=t[i];return e},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};!(function(t){var i=t.telemetry||(t.telemetry={}),e=jsCommon.Utility,r=t.telemetryEventFactory,n=t.telemetry.EventFactories;e?e.generateGuid:Function.prototype,i.EXNewExplorationEventName="PBI.EX.NewExploration",i.EXNewExploration=n[i.EXNewExplorationEventName]=function(e){return r({name:i.EXNewExplorationEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["enterpriseCapacitySkuTier"],loggers:i.EXNewExplorationLoggers})},i.EXRefreshReportEventName="PBI.EX.RefreshReport",i.EXRefreshReport=n[i.EXRefreshReportEventName]=function(e){return r({name:i.EXRefreshReportEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXRefreshReportLoggers})},i.EXSaveExplorationEventName="PBI.EX.SaveExploration",i.EXSaveExploration=n[i.EXSaveExplorationEventName]=function(e){return r({name:i.EXSaveExplorationEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isPersonalization"],loggers:i.EXSaveExplorationLoggers})},i.EXInteractionVisualConversionEventName="PBI.EX.InteractionVisualConversion",i.EXInteractionVisualConversion=n[i.EXInteractionVisualConversionEventName]=function(e){return r({name:i.EXInteractionVisualConversionEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXInteractionVisualConversionLoggers})},i.EXInteractionExpandEventName="PBI.EX.InteractionExpand",i.EXInteractionExpand=n[i.EXInteractionExpandEventName]=function(e){return r({name:i.EXInteractionExpandEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXInteractionExpandLoggers,logExpAssignment:!0})},i.EXInteractionDrillEventName="PBI.EX.InteractionDrill",i.EXInteractionDrill=n[i.EXInteractionDrillEventName]=function(e){return r({name:i.EXInteractionDrillEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXInteractionDrillLoggers,logExpAssignment:!0})},i.EXDrillToDetailsEventName="PBI.EX.DrillToDetails",i.EXDrillToDetails=n[i.EXDrillToDetailsEventName]=function(e){return r({name:i.EXDrillToDetailsEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXDrillToDetailsLoggers,logExpAssignment:!0})},i.EXAddFilterEventName="PBI.EX.AddFilter",i.EXAddFilter=n[i.EXAddFilterEventName]=function(e){return r({name:i.EXAddFilterEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXAddFilterLoggers})},i.EXClearFilterEventName="PBI.EX.ClearFilter",i.EXClearFilter=n[i.EXClearFilterEventName]=function(e){return r({name:i.EXClearFilterEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXClearFilterLoggers,logExpAssignment:!0})},i.EXRemoveFilterEventName="PBI.EX.RemoveFilter",i.EXRemoveFilter=n[i.EXRemoveFilterEventName]=function(e){return r({name:i.EXRemoveFilterEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXRemoveFilterLoggers})},i.EXHideFilterEventName="PBI.EX.HideFilter",i.EXHideFilter=n[i.EXHideFilterEventName]=function(e){return r({name:i.EXHideFilterEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXHideFilterLoggers})},i.EXLockFilterEventName="PBI.EX.LockFilter",i.EXLockFilter=n[i.EXLockFilterEventName]=function(e){return r({name:i.EXLockFilterEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXLockFilterLoggers})},i.EXTogglePaneExpandedEventName="PBI.EX.TogglePaneExpanded",i.EXTogglePaneExpanded=n[i.EXTogglePaneExpandedEventName]=function(e){return r({name:i.EXTogglePaneExpandedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXTogglePaneExpandedLoggers})},i.EXToggleFilterCardExpandedEventName="PBI.EX.ToggleFilterCardExpanded",i.EXToggleFilterCardExpanded=n[i.EXToggleFilterCardExpandedEventName]=function(e){return r({name:i.EXToggleFilterCardExpandedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:i.EXToggleFilterCardExpandedLoggers})},i.EXToggleFilterCardSortEventName="PBI.EX.ToggleFilterCardSort",i.EXToggleFilterCardSort=n[i.EXToggleFilterCardSortEventName]=function(e){return r({name:i.EXToggleFilterCardSortEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXToggleFilterCardSortLoggers})},i.EXFilterPaneAdvancedFilterAppliedEventName="PBI.EX.FilterPaneAdvancedFilterApplied",i.EXFilterPaneAdvancedFilterApplied=n[i.EXFilterPaneAdvancedFilterAppliedEventName]=function(e){return r({name:i.EXFilterPaneAdvancedFilterAppliedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane","isDateTime"],loggers:i.EXFilterPaneAdvancedFilterAppliedLoggers})},i.EXFilterPaneTopNFilterAppliedEventName="PBI.EX.FilterPaneTopNFilterApplied",i.EXFilterPaneTopNFilterApplied=n[i.EXFilterPaneTopNFilterAppliedEventName]=function(e){return r({name:i.EXFilterPaneTopNFilterAppliedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:i.EXFilterPaneTopNFilterAppliedLoggers})},i.EXFilterPaneRelativeDateFilterAppliedEventName="PBI.EX.FilterPaneRelativeDateFilterApplied",i.EXFilterPaneRelativeDateFilterApplied=n[i.EXFilterPaneRelativeDateFilterAppliedEventName]=function(e){return r({name:i.EXFilterPaneRelativeDateFilterAppliedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:i.EXFilterPaneRelativeDateFilterAppliedLoggers})},i.EXFilterPaneRelativeTimeFilterAppliedEventName="PBI.EX.FilterPaneRelativeTimeFilterApplied",i.EXFilterPaneRelativeTimeFilterApplied=n[i.EXFilterPaneRelativeTimeFilterAppliedEventName]=function(e){return r({name:i.EXFilterPaneRelativeTimeFilterAppliedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:i.EXFilterPaneRelativeTimeFilterAppliedLoggers})},i.EXFilterPaneBasicFilterChangedEventName="PBI.EX.FilterPaneBasicFilterChanged",i.EXFilterPaneBasicFilterChanged=n[i.EXFilterPaneBasicFilterChangedEventName]=function(e){return r({name:i.EXFilterPaneBasicFilterChangedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:i.EXFilterPaneBasicFilterChangedLoggers,logExpAssignment:!0})},i.EXFilterPaneFilterDefaultRestoredEventName="PBI.EX.FilterPaneFilterDefaultRestored",i.EXFilterPaneFilterDefaultRestored=n[i.EXFilterPaneFilterDefaultRestoredEventName]=function(e){return r({name:i.EXFilterPaneFilterDefaultRestoredEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXFilterPaneFilterDefaultRestoredLoggers})},i.EXFilterPaneFilterClearedEventName="PBI.EX.FilterPaneFilterCleared",i.EXFilterPaneFilterCleared=n[i.EXFilterPaneFilterClearedEventName]=function(e){return r({name:i.EXFilterPaneFilterClearedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXFilterPaneFilterClearedLoggers,logExpAssignment:!0})},i.EXFilterPaneFilterDeletedEventName="PBI.EX.FilterPaneFilterDeleted",i.EXFilterPaneFilterDeleted=n[i.EXFilterPaneFilterDeletedEventName]=function(e){return r({name:i.EXFilterPaneFilterDeletedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXFilterPaneFilterDeletedLoggers})},i.EXFilterPaneInteractionEventName="PBI.EX.FilterPaneInteraction",i.EXFilterPaneInteraction=n[i.EXFilterPaneInteractionEventName]=function(e){return r({name:i.EXFilterPaneInteractionEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:i.EXFilterPaneInteractionLoggers,logExpAssignment:!0})},i.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName="PBI.EX.ImprovedFilterExperience.ToggleOutspacePaneExpansion",i.EXImprovedFilterExperienceToggleOutspacePaneExpansion=n[i.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName]=function(e){return r({name:i.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXImprovedFilterExperienceToggleOutspacePaneExpansionLoggers,logExpAssignment:!0})},i.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName="PBI.EX.ImprovedFilterExperience.ToggleOutspacePaneVisibility",i.EXImprovedFilterExperienceToggleOutspacePaneVisibility=n[i.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName]=function(e){return r({name:i.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXImprovedFilterExperienceToggleOutspacePaneVisibilityLoggers})},i.EXImprovedFilterExperienceShowRestatementEventName="PBI.EX.ImprovedFilterExperience.ShowRestatement",i.EXImprovedFilterExperienceShowRestatement=n[i.EXImprovedFilterExperienceShowRestatementEventName]=function(e){return r({name:i.EXImprovedFilterExperienceShowRestatementEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXImprovedFilterExperienceShowRestatementLoggers,logExpAssignment:!0})},i.EXLoadFilterErrorEventName="PBI.EX.LoadFilterError",i.EXLoadFilterError=n[i.EXLoadFilterErrorEventName]=function(e){return r({name:i.EXLoadFilterErrorEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:i.EXLoadFilterErrorLoggers})},i.EXCreateVisualEventName="PBI.EX.CreateVisual",i.EXCreateVisual=n[i.EXCreateVisualEventName]=function(e){return r({name:i.EXCreateVisualEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCreateVisualLoggers})},i.EXAddFieldEventName="PBI.EX.AddField",i.EXAddField=n[i.EXAddFieldEventName]=function(e){return r({name:i.EXAddFieldEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXAddFieldLoggers})},i.EXResolveParametersEventName="PBI.EX.ResolveParameters",i.EXResolveParameters=n[i.EXResolveParametersEventName]=function(e){return r({name:i.EXResolveParametersEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXResolveParametersLoggers,logRatio:.001})},i.EXSwitchQueryParameterEventName="PBI.EX.SwitchQueryParameter",i.EXSwitchQueryParameter=n[i.EXSwitchQueryParameterEventName]=function(e){return r({name:i.EXSwitchQueryParameterEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXSwitchQueryParameterLoggers})},i.EXChangeQuickCalcEventName="PBI.EX.ChangeQuickCalc",i.EXChangeQuickCalc=n[i.EXChangeQuickCalcEventName]=function(e){return r({name:i.EXChangeQuickCalcEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXChangeQuickCalcLoggers})},i.EXSetConditionalFormattingEventName="PBI.EX.SetConditionalFormatting",i.EXSetConditionalFormatting=n[i.EXSetConditionalFormattingEventName]=function(e){return r({name:i.EXSetConditionalFormattingEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXSetConditionalFormattingLoggers})},i.EXSetDataBarsEventName="PBI.EX.SetDataBars",i.EXSetDataBars=n[i.EXSetDataBarsEventName]=function(e){return r({name:i.EXSetDataBarsEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXSetDataBarsLoggers})},i.EXExplorationRefreshEventName="PBI.EX.ExplorationRefresh",i.EXExplorationRefresh=n[i.EXExplorationRefreshEventName]=function(e){return r({name:i.EXExplorationRefreshEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXExplorationRefreshLoggers})},i.EXSnapshotEmbedCreateEventName="PBI.EX.SnapshotEmbedCreate",i.EXSnapshotEmbedCreate=n[i.EXSnapshotEmbedCreateEventName]=function(e){return r({name:i.EXSnapshotEmbedCreateEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXSnapshotEmbedCreateLoggers})},i.EXPublicEmbedCreateEventName="PBI.EX.PublicEmbedCreate",i.EXPublicEmbedCreate=n[i.EXPublicEmbedCreateEventName]=function(e){return r({name:i.EXPublicEmbedCreateEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXPublicEmbedCreateLoggers})},i.EXSnapshotEmbedDeleteEventName="PBI.EX.SnapshotEmbedDelete",i.EXSnapshotEmbedDelete=n[i.EXSnapshotEmbedDeleteEventName]=function(e){return r({name:i.EXSnapshotEmbedDeleteEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXSnapshotEmbedDeleteLoggers})},i.EXSnapshotEmbedUpdateEventName="PBI.EX.SnapshotEmbedUpdate",i.EXSnapshotEmbedUpdate=n[i.EXSnapshotEmbedUpdateEventName]=function(e){return r({name:i.EXSnapshotEmbedUpdateEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXSnapshotEmbedUpdateLoggers})},i.EXImportCustomVizEventName="PBI.EX.ImportCustomViz",i.EXImportCustomViz=n[i.EXImportCustomVizEventName]=function(e){return r({name:i.EXImportCustomVizEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXImportCustomVizLoggers})},i.EXCdnVisualOverrideEventName="PBI.EX.CdnVisualOverride",i.EXCdnVisualOverride=n[i.EXCdnVisualOverrideEventName]=function(e){return r({name:i.EXCdnVisualOverrideEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCdnVisualOverrideLoggers})},i.EXDeleteCustomVizEventName="PBI.EX.DeleteCustomViz",i.EXDeleteCustomViz=n[i.EXDeleteCustomVizEventName]=function(e){return r({name:i.EXDeleteCustomVizEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXDeleteCustomVizLoggers})},i.EXEnableCustomVizEventName="PBI.EX.EnableCustomViz",i.EXEnableCustomViz=n[i.EXEnableCustomVizEventName]=function(e){return r({name:i.EXEnableCustomVizEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXEnableCustomVizLoggers})},i.EXVisualRelationshipOverrideEventName="PBI.EX.VisualRelationshipOverride",i.EXVisualRelationshipOverride=n[i.EXVisualRelationshipOverrideEventName]=function(e){return r({name:i.EXVisualRelationshipOverrideEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXVisualRelationshipOverrideLoggers})},i.EXCodePaneUserRunScriptEventName="PBI.EX.CodePaneUserRunScript",i.EXCodePaneUserRunScript=n[i.EXCodePaneUserRunScriptEventName]=function(e){return r({name:i.EXCodePaneUserRunScriptEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCodePaneUserRunScriptLoggers})},i.EXCodePaneUserEditScriptWithExternalIDEEventName="PBI.EX.CodePaneUserEditScriptWithExternalIDE",i.EXCodePaneUserEditScriptWithExternalIDE=n[i.EXCodePaneUserEditScriptWithExternalIDEEventName]=function(e){return r({name:i.EXCodePaneUserEditScriptWithExternalIDEEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCodePaneUserEditScriptWithExternalIDELoggers})},i.EXCodePaneUserOpenOptionsDialogEventName="PBI.EX.CodePaneUserOpenOptionsDialog",i.EXCodePaneUserOpenOptionsDialog=n[i.EXCodePaneUserOpenOptionsDialogEventName]=function(e){return r({name:i.EXCodePaneUserOpenOptionsDialogEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCodePaneUserOpenOptionsDialogLoggers})},i.EXCodePaneLaunchExternalIDEFailedEventName="PBI.EX.CodePaneLaunchExternalIDEFailed",i.EXCodePaneLaunchExternalIDEFailed=n[i.EXCodePaneLaunchExternalIDEFailedEventName]=function(e){return r({name:i.EXCodePaneLaunchExternalIDEFailedEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:i.EXCodePaneLaunchExternalIDEFailedLoggers})},i.EXCodePaneLaunchExternalIDESucceededEventName="PBI.EX.CodePaneLaunchExternalIDESucceeded",i.EXCodePaneLaunchExternalIDESucceeded=n[i.EXCodePaneLaunchExternalIDESucceededEventName]=function(e){return r({name:i.EXCodePaneLaunchExternalIDESucceededEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCodePaneLaunchExternalIDESucceededLoggers})},i.EXCodePaneShowWarningEventName="PBI.EX.CodePaneShowWarning",i.EXCodePaneShowWarning=n[i.EXCodePaneShowWarningEventName]=function(e){return r({name:i.EXCodePaneShowWarningEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:i.EXCodePaneShowWarningLoggers})},i.EXExportVisualDataEventName="PBI.EX.ExportVisualData",i.EXExportVisualData=n[i.EXExportVisualDataEventName]=function(e){return r({name:i.EXExportVisualDataEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["requestId"],loggers:i.EXExportVisualDataLoggers,logExpAssignment:!0})},i.EXLoadReportWithScriptVisEventName="PBI.EX.LoadReportWithScriptVis",i.EXLoadReportWithScriptVis=n[i.EXLoadReportWithScriptVisEventName]=function(e){return r({name:i.EXLoadReportWithScriptVisEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXLoadReportWithScriptVisLoggers})},i.ExploreHostChangeReportPageEventName="PBI.ExploreHost.ChangeReportPage",i.ExploreHostChangeReportPage=n[i.ExploreHostChangeReportPageEventName]=function(e){return r({name:i.ExploreHostChangeReportPageEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["sectionGuid","groupObjectId","isReadonlyGroup","scrubUserInfo","newReport"],loggers:i.ExploreHostChangeReportPageLoggers})},i.EXRemoveMobileCanvasVisualsEventName="PBI.EX.RemoveMobileCanvasVisuals",i.EXRemoveMobileCanvasVisuals=n[i.EXRemoveMobileCanvasVisualsEventName]=function(e){return r({name:i.EXRemoveMobileCanvasVisualsEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXRemoveMobileCanvasVisualsLoggers})},i.EXLoadReportContainerEventName="PBI.EX.LoadReportContainer",i.EXLoadReportContainer=n[i.EXLoadReportContainerEventName]=function(e){return r({name:i.EXLoadReportContainerEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXLoadReportContainerLoggers})},i.EXLoadReportContainerDatasetMissingEventName="PBI.EX.LoadReportContainerDatasetMissing",i.EXLoadReportContainerDatasetMissing=n[i.EXLoadReportContainerDatasetMissingEventName]=function(e){return r({name:i.EXLoadReportContainerDatasetMissingEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXLoadReportContainerDatasetMissingLoggers})},i.EXInitExplorationEventName="PBI.EX.InitExploration",i.EXInitExploration=n[i.EXInitExplorationEventName]=function(e){return r({name:i.EXInitExplorationEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXInitExplorationLoggers})},i.EXLoadExplorationVisualsEventName="PBI.EX.LoadExplorationVisuals",i.EXLoadExplorationVisuals=n[i.EXLoadExplorationVisualsEventName]=function(e){return r({name:i.EXLoadExplorationVisualsEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXLoadExplorationVisualsLoggers,defaultTimeoutSec:60})},i.EXVisualContainerChangedEventName="PBI.EX.VisualContainerChanged",i.EXVisualContainerChanged=n[i.EXVisualContainerChangedEventName]=function(e){return r({name:i.EXVisualContainerChangedEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXVisualContainerChangedLoggers,logRatio:0})},i.EXRenderExplorationVisualEventName="PBI.EX.RenderExplorationVisual",i.EXRenderExplorationVisual=n[i.EXRenderExplorationVisualEventName]=function(e){return r({name:i.EXRenderExplorationVisualEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXRenderExplorationVisualLoggers,logRatio:.01})},i.EXFetchExplorationEventName="PBI.EX.FetchExploration",i.EXFetchExploration=n[i.EXFetchExplorationEventName]=function(e){return r({name:i.EXFetchExplorationEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXFetchExplorationLoggers})},i.EXChangeCanvasLayoutEventName="PBI.EX.ChangeCanvasLayout",i.EXChangeCanvasLayout=n[i.EXChangeCanvasLayoutEventName]=function(e){return r({name:i.EXChangeCanvasLayoutEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXChangeCanvasLayoutLoggers})},i.EXClusteringAddClusteringEventName="PBI.EX.Clustering.AddClustering",i.EXClusteringAddClustering=n[i.EXClusteringAddClusteringEventName]=function(e){return r({name:i.EXClusteringAddClusteringEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXClusteringAddClusteringLoggers})},i.EXClusteringEditClusteringEventName="PBI.EX.Clustering.EditClustering",i.EXClusteringEditClustering=n[i.EXClusteringEditClusteringEventName]=function(e){return r({name:i.EXClusteringEditClusteringEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXClusteringEditClusteringLoggers})},i.EXQuickMeasuresOpenDialogEventName="PBI.EX.QuickMeasures.OpenDialog",i.EXQuickMeasuresOpenDialog=n[i.EXQuickMeasuresOpenDialogEventName]=function(e){return r({name:i.EXQuickMeasuresOpenDialogEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXQuickMeasuresOpenDialogLoggers})},i.EXQuickMeasuresDialogResultEventName="PBI.EX.QuickMeasures.DialogResult",i.EXQuickMeasuresDialogResult=n[i.EXQuickMeasuresDialogResultEventName]=function(e){return r({name:i.EXQuickMeasuresDialogResultEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXQuickMeasuresDialogResultLoggers})},i.EXQuickMeasuresOnMeasureChangeEventName="PBI.EX.QuickMeasures.OnMeasureChange",i.EXQuickMeasuresOnMeasureChange=n[i.EXQuickMeasuresOnMeasureChangeEventName]=function(e){return r({name:i.EXQuickMeasuresOnMeasureChangeEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXQuickMeasuresOnMeasureChangeLoggers})},i.EXDrillthroughGotoTargetEventName="PBI.EX.Drillthrough.GotoTarget",i.EXDrillthroughGotoTarget=n[i.EXDrillthroughGotoTargetEventName]=function(e){return r({name:i.EXDrillthroughGotoTargetEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXDrillthroughGotoTargetLoggers,logExpAssignment:!0})},i.EXDrillthroughFilterUpdateEventName="PBI.EX.Drillthrough.FilterUpdate",i.EXDrillthroughFilterUpdate=n[i.EXDrillthroughFilterUpdateEventName]=function(e){return r({name:i.EXDrillthroughFilterUpdateEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXDrillthroughFilterUpdateLoggers})},i.EXRefreshHostDataEventName="PBI.EX.RefreshHostData",i.EXRefreshHostData=n[i.EXRefreshHostDataEventName]=function(e){return r({name:i.EXRefreshHostDataEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXRefreshHostDataLoggers})},i.EXBookmarkAddEventName="PBI.EX.BookmarkAdd",i.EXBookmarkAdd=n[i.EXBookmarkAddEventName]=function(e){return r({name:i.EXBookmarkAddEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXBookmarkAddLoggers})},i.EXBookmarkUpdateEventName="PBI.EX.BookmarkUpdate",i.EXBookmarkUpdate=n[i.EXBookmarkUpdateEventName]=function(e){return r({name:i.EXBookmarkUpdateEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXBookmarkUpdateLoggers})},i.EXBookmarkDeleteEventName="PBI.EX.BookmarkDelete",i.EXBookmarkDelete=n[i.EXBookmarkDeleteEventName]=function(e){return r({name:i.EXBookmarkDeleteEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXBookmarkDeleteLoggers})},i.EXBookmarkPlayEventName="PBI.EX.BookmarkPlay",i.EXBookmarkPlay=n[i.EXBookmarkPlayEventName]=function(e){return r({name:i.EXBookmarkPlayEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXBookmarkPlayLoggers})},i.EXBookmarkApplyEventName="PBI.EX.BookmarkApply",i.EXBookmarkApply=n[i.EXBookmarkApplyEventName]=function(e){return r({name:i.EXBookmarkApplyEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXBookmarkApplyLoggers})},i.EXBookmarkLoadErrorEventName="PBI.EX.Bookmark.LoadError",i.EXBookmarkLoadError=n[i.EXBookmarkLoadErrorEventName]=function(e){return r({name:i.EXBookmarkLoadErrorEventName,baseEvent:i.ErrorWithStackTrace(e),info:e,category:t.TelemetryCategory.CriticalError,loggers:i.EXBookmarkLoadErrorLoggers})},i.EXCopyPasteSyncGroupEventName="PBI.EX.CopyPasteSyncGroup",i.EXCopyPasteSyncGroup=n[i.EXCopyPasteSyncGroupEventName]=function(e){return r({name:i.EXCopyPasteSyncGroupEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCopyPasteSyncGroupLoggers})},i.EXCustomDateTableOpenDialogEventName="PBI.EX.CustomDateTableOpenDialog",i.EXCustomDateTableOpenDialog=n[i.EXCustomDateTableOpenDialogEventName]=function(e){return r({name:i.EXCustomDateTableOpenDialogEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCustomDateTableOpenDialogLoggers})},i.EXCustomDateTableCommitEventName="PBI.EX.CustomDateTableCommit",i.EXCustomDateTableCommit=n[i.EXCustomDateTableCommitEventName]=function(e){return r({name:i.EXCustomDateTableCommitEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCustomDateTableCommitLoggers})},i.EXCustomDateTableValidationResultEventName="PBI.EX.CustomDateTableValidationResult",i.EXCustomDateTableValidationResult=n[i.EXCustomDateTableValidationResultEventName]=function(e){return r({name:i.EXCustomDateTableValidationResultEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXCustomDateTableValidationResultLoggers})},i.EXUpdateActiveSectionEventName="PBI.EX.UpdateActiveSection",i.EXUpdateActiveSection=n[i.EXUpdateActiveSectionEventName]=function(e){return r({name:i.EXUpdateActiveSectionEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,optionalParameters:["forceUpdate","suppressHistory","clearSelection","isCancelled1"],loggers:i.EXUpdateActiveSectionLoggers,defaultTimeoutSec:10})},i.EXVisualContainerApplyUpdateEventName="PBI.EX.VisualContainerApplyUpdate",i.EXVisualContainerApplyUpdate=n[i.EXVisualContainerApplyUpdateEventName]=function(e){return r({name:i.EXVisualContainerApplyUpdateEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXVisualContainerApplyUpdateLoggers,logRatio:0})},i.EXVisualDataChangedEventName="PBI.EX.VisualDataChanged",i.EXVisualDataChanged=n[i.EXVisualDataChangedEventName]=function(e){return r({name:i.EXVisualDataChangedEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXVisualDataChangedLoggers,logRatio:0})},i.EXApplySlicerEventName="PBI.EX.ApplySlicer",i.EXApplySlicer=n[i.EXApplySlicerEventName]=function(e){return r({name:i.EXApplySlicerEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXApplySlicerLoggers,logExpAssignment:!0})},i.EXApplyAllClickedEventName="PBI.EX.ApplyAllClicked",i.EXApplyAllClicked=n[i.EXApplyAllClickedEventName]=function(e){return r({name:i.EXApplyAllClickedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXApplyAllClickedLoggers})},i.EXSelectDataPointEventName="PBI.EX.SelectDataPoint",i.EXSelectDataPoint=n[i.EXSelectDataPointEventName]=function(e){return r({name:i.EXSelectDataPointEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXSelectDataPointLoggers,logExpAssignment:!0})},i.EXRefreshSingleVisualEventName="PBI.EX.RefreshSingleVisual",i.EXRefreshSingleVisual=n[i.EXRefreshSingleVisualEventName]=function(e){return r({name:i.EXRefreshSingleVisualEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXRefreshSingleVisualLoggers})},i.EXPerformanceAnalyzerRefreshReportEventName="PBI.EX.PerformanceAnalyzerRefreshReport",i.EXPerformanceAnalyzerRefreshReport=n[i.EXPerformanceAnalyzerRefreshReportEventName]=function(e){return r({name:i.EXPerformanceAnalyzerRefreshReportEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXPerformanceAnalyzerRefreshReportLoggers})},i.EXPerformanceAnalyzerExportLogsEventName="PBI.EX.PerformanceAnalyzerExportLogs",i.EXPerformanceAnalyzerExportLogs=n[i.EXPerformanceAnalyzerExportLogsEventName]=function(e){return r({name:i.EXPerformanceAnalyzerExportLogsEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXPerformanceAnalyzerExportLogsLoggers})},i.EXPerformanceAnalyzerCopyQueriesEventName="PBI.EX.PerformanceAnalyzerCopyQueries",i.EXPerformanceAnalyzerCopyQueries=n[i.EXPerformanceAnalyzerCopyQueriesEventName]=function(e){return r({name:i.EXPerformanceAnalyzerCopyQueriesEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXPerformanceAnalyzerCopyQueriesLoggers})},i.EXPerformanceAnalyzerStopRecordingEventName="PBI.EX.PerformanceAnalyzerStopRecording",i.EXPerformanceAnalyzerStopRecording=n[i.EXPerformanceAnalyzerStopRecordingEventName]=function(e){return r({name:i.EXPerformanceAnalyzerStopRecordingEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXPerformanceAnalyzerStopRecordingLoggers})},i.EXThemeDialogClosedEventName="PBI.EX.ThemeDialogClosed",i.EXThemeDialogClosed=n[i.EXThemeDialogClosedEventName]=function(e){return r({name:i.EXThemeDialogClosedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXThemeDialogClosedLoggers})},i.SettingsFavoriteResourcePackagesEventName="PBI.Settings.FavoriteResourcePackages",i.SettingsFavoriteResourcePackages=n[i.SettingsFavoriteResourcePackagesEventName]=function(e){return r({name:i.SettingsFavoriteResourcePackagesEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["favoriteResourcePackagePayload"],loggers:i.SettingsFavoriteResourcePackagesLoggers})},i.SettingsVisualPaneEventName="PBI.Settings.VisualPane",i.SettingsVisualPane=n[i.SettingsVisualPaneEventName]=function(e){return r({name:i.SettingsVisualPaneEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["visualPaneActionPayload"],loggers:i.SettingsVisualPaneLoggers})},i.SettingsOutOfBoxVisualsEventName="PBI.Settings.OutOfBoxVisuals",i.SettingsOutOfBoxVisuals=n[i.SettingsOutOfBoxVisualsEventName]=function(e){return r({name:i.SettingsOutOfBoxVisualsEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,optionalParameters:["outOfBoxVisuals"],loggers:i.SettingsOutOfBoxVisualsLoggers})},i.EXDrillthroughButtonClickedEventName="PBI.EX.DrillthroughButtonClicked",i.EXDrillthroughButtonClicked=n[i.EXDrillthroughButtonClickedEventName]=function(e){return r({name:i.EXDrillthroughButtonClickedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXDrillthroughButtonClickedLoggers})},i.EXSmallMultiplesFirstFieldEventName="PBI.EX.SmallMultiplesFirstField",i.EXSmallMultiplesFirstField=n[i.EXSmallMultiplesFirstFieldEventName]=function(e){return r({name:i.EXSmallMultiplesFirstFieldEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXSmallMultiplesFirstFieldLoggers})},i.EXAnalyticsLoadSchemaErrorEventName="PBI.EX.AnalyticsLoadSchemaError",i.EXAnalyticsLoadSchemaError=n[i.EXAnalyticsLoadSchemaErrorEventName]=function(e){return r({name:i.EXAnalyticsLoadSchemaErrorEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:i.EXAnalyticsLoadSchemaErrorLoggers})},i.EXExecuteActionCommandsEventName="PBI.EX.ExecuteActionCommands",i.EXExecuteActionCommands=n[i.EXExecuteActionCommandsEventName]=function(e){return r({name:i.EXExecuteActionCommandsEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXExecuteActionCommandsLoggers})},i.EXUndefinedTooltipStyleInActionBarEventName="PBI.EX.UndefinedTooltipStyleInActionBar",i.EXUndefinedTooltipStyleInActionBar=n[i.EXUndefinedTooltipStyleInActionBarEventName]=function(e){return r({name:i.EXUndefinedTooltipStyleInActionBarEventName,info:e,category:t.TelemetryCategory.CriticalError,loggers:i.EXUndefinedTooltipStyleInActionBarLoggers})},i.EXActionBarShownEventName="PBI.EX.ActionBarShown",i.EXActionBarShown=n[i.EXActionBarShownEventName]=function(e){return r({name:i.EXActionBarShownEventName,baseEvent:i.Verbose(e),info:e,category:t.TelemetryCategory.Verbose,loggers:i.EXActionBarShownLoggers})},i.EXScanModeKeyPressedEventName="PBI.EX.ScanModeKeyPressed",i.EXScanModeKeyPressed=n[i.EXScanModeKeyPressedEventName]=function(e){return r({name:i.EXScanModeKeyPressedEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXScanModeKeyPressedLoggers})},i.EXGetInsightsMenuCommandEventName="PBI.EX.GetInsightsMenuCommand",i.EXGetInsightsMenuCommand=n[i.EXGetInsightsMenuCommandEventName]=function(e){return r({name:i.EXGetInsightsMenuCommandEventName,baseEvent:i.CustomerAction(e),info:e,category:t.TelemetryCategory.CustomerAction,loggers:i.EXGetInsightsMenuCommandLoggers})},i.SparklinesDeleteEventName="PBI.Sparklines.Delete",i.SparklinesDelete=n[i.SparklinesDeleteEventName]=function(e){return r({name:i.SparklinesDeleteEventName,info:e,loggers:i.SparklinesDeleteLoggers})},i.CopyVisualImageEntryPointEventName="PBI.CopyVisualImage.EntryPoint",i.CopyVisualImageEntryPoint=n[i.CopyVisualImageEntryPointEventName]=function(e){return r({name:i.CopyVisualImageEntryPointEventName,info:e,loggers:i.CopyVisualImageEntryPointLoggers})}})(powerbi=powerbi||{}),(function(i){var s;(function(r){var a=i.data.Condition,o=i.data.OperatorHelper,t=i.data.RestatementHelper,n=i.data.SQExprUtils;function e(e){this.field=e,this.conditions=[],this.operators=[],this.logicalOperator=2,this.logicalAndOperator=0,this.logicalOrOperator=1}e.prototype.toSQExpr=function(e){var t=this.field,i=t.getMetadata(e);if(i)return i=i.type,e=n.hasMappedMParameter(t,e),r.FilterCardConverter.toSQExpr(t,i,this.conditions,this.logicalOperator,e)},e.prototype.getRestatement=function(e){return t.fromCondition(this.conditions,this.logicalOperator,e)},e.prototype.areConditionsValid=function(e,t){var i=this.conditions;if(_.isEmpty(i))return!1;for(var r=0,n=i.length;r<n;r++){var a=i[r];if(null==a.operator||0===a.operator){if(r<n-1)return!1}else if(!e||a.value&&a.value.hasValue){if(o.getValueRequired(a.operator)&&a.value&&!a.value.hasValue)return!1;if(t&&!this.isConditionValid(t,a))return!1}}return!0},e.prototype.loadOperators=function(e,t,i){var r=this.field;_.isEmpty(r.validate(e,t))&&(t=r.getMetadata(e),this.operators=o.getFilterOperators(t.type,i))},e.prototype.ensureConditions=function(e,t){var i=this.operators,r=0,n=(this.conditions||(this.conditions=[]),_.isEmpty(this.conditions)&&!_.isEmpty(i)&&this.conditions.push(new a(i[0].value)),2);for(e&&(r=t?1:2,n=t?2:1,i=!o.isOperatorForColumnMappedToMParameter(this.conditions[0].operator),e=1<this.conditions.length&&!t,(0===this.logicalOperator||i||e)&&(this.conditions=[new a(9)],this.logicalOperator=r));this.conditions.length<n;)this.conditions.push(a.empty()),this.logicalOperator=r},e.prototype.isConditionValid=function(e,t){if(!e)return!1;var i=this.field,e=s.FilterUtils.getValueType(i,e);return!!e&&r.FilterCardConverter.isConditionValid(i,e,t)},r.AdvFilterCard=e})((s=i.explore||(i.explore={})).viewModels||(s.viewModels={}))})(powerbi=powerbi||{}),(function(n){var e,t,r,o,i,a,s,l,u,c,p,h,d,v,g,m,y,f,C,S;function b(e,t){var i=r.call(this)||this;return i.supportsCategorical=!0,i.context={isNegative:!1,allowNot:!0,logicalOperator:2},i.formatter=e,i.field=t,i}function E(e,t,i,r){void 0===r&&(r=!1),this.propertyExpr=e,this.dataType=t,this.logicalOperator=i,this.isMappedToMParameter=r}e=n.explore||(n.explore={}),t=e.viewModels||(e.viewModels={}),o=n.data.Condition,i=n.data.ConditionValue,a=n.data.SQAndExpr,s=n.data.SQBetweenExpr,l=n.data.SQCompareExpr,u=n.data.SQConstantExpr,c=n.data.SQContainsExpr,p=n.data.SQDateSpanExpr,h=n.data.SQExpr,d=n.data.SQExprBuilder,v=n.data.SQInExpr,g=n.data.SQNotExpr,m=n.data.SQOrExpr,y=n.data.SQStartsWithExpr,f=/[0-9]*\.?[0-9]+%/,(e=t.FilterCardConverter||(t.FilterCardConverter={})).createAdvFilter=function(e,t,i){return e.accept(new C(t,i))},e.toSQExpr=function(e,t,i,r,n){for(var a,o=new S(e,t,r=void 0===r?0:r,n=void 0===n?!1:n),s=0,l=i;s<l.length;s++){var u=l[s];null!=u.operator&&0!==u.operator&&(a=u.accept(o))}return a},e.isConditionValid=function(e,t,i){return e=new S(e,t,void 0),null!=i.accept(e)},r=n.data.DefaultSQExprVisitor,__extends(b,r),b.prototype.visitColumnRef=function(e){if(null==this.field||h.equals(this.field,e))return this.createFilterCard(e)},b.prototype.visitGroupRef=function(e){if(null==this.field||h.equals(this.field,e))return this.createFilterCard(e)},b.prototype.visitMeasureRef=function(e){return this.createFilterCard(e)},b.prototype.visitAggr=function(e){return this.createFilterCard(e)},b.prototype.visitArithmetic=function(e){return this.createFilterCard(e)},b.prototype.visitHierarchyLevel=function(e){return this.supportsCategorical=!1,this.createFilterCard(e)},b.prototype.visitEntity=function(e){return this.createFilterCard(e)},b.prototype.visitIn=function(e){if(!e.table&&e.args&&1===e.args.length){e.args[0].accept(this);var t=this.filter;if(null==t&&null!=this.field)return this.createFilterCard(this.field);for(var i=this.context,r=0,n=e.values;r<n.length;r++){var a=n[r];i.condition=new o(i.isNegative?10:9),a[0].accept(this),t.conditions.push(i.condition)}if(2!==t.logicalOperator);else return e=i.isNegative?0:1,t.logicalOperator=e,t}},b.prototype.visitBetween=function(e){this.supportsCategorical=!1,e.arg.accept(this);var t=this.filter,i=this.context;if(i.condition=new o(i.isNegative?1:4),e.lower.accept(this)&&(t.conditions.push(i.condition),i.condition=new o(i.isNegative?3:2),e.upper.accept(this)&&(t.conditions.push(i.condition),2===t.logicalOperator)))return t.logicalOperator=0,t},b.prototype.visitAnd=function(e){this.supportsCategorical=!1;var t=this.context,i=t.isNegative?1:0;if(2===t.logicalOperator)t.logicalOperator=i;else if(t.logicalOperator!==i)return;if(e.left.accept(this)&&e.right.accept(this))return this.filter},b.prototype.visitOr=function(e){var t=this.context,i=t.isNegative?0:1;if(2===t.logicalOperator)t.logicalOperator=i;else if(t.logicalOperator!==i)return;if(e.left.accept(this)&&e.right.accept(this))return this.filter},b.prototype.visitCompare=function(e){var t=this.context,i=this.getFilterOperator(e,t.isNegative);if(void 0!==i&&0!==i){t.condition=new o(this.getFilterOperator(e,t.isNegative));i=t.allowNot;if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this))if(e.right instanceof u||e.right instanceof p)return(e=this.filter).conditions.push(this.context.condition),1<e.conditions.length&&2===e.logicalOperator&&(e.logicalOperator=0),t.allowNot=i,t.condition=null,e}},b.prototype.visitNot=function(e){var t=this.context,i=e.arg;if((i instanceof l||i instanceof v||i instanceof s||t.allowNot&&(i instanceof a||i instanceof m||i instanceof c||i instanceof y||i instanceof g))&&(t.isNegative=!t.isNegative,e.arg.accept(this)))return t.isNegative=!t.isNegative,this.filter},b.prototype.visitConstant=function(e){var t;if(this.context.condition)return t=this.context.condition,0!==e.type.primitiveType&&(t.value=new i(e.value,this.formatter)),this.filter},b.prototype.visitDateSpan=function(e){var t,i;if(this.supportsCategorical=!1,5===e.unit)return i=(t=this.context).allowNot,t.allowNot=!1,e=e.arg.accept(this),t.allowNot=i,e},b.prototype.visitContains=function(e){this.supportsCategorical=!1;var t=this.context,i=(t.condition=new o(t.isNegative?6:5),t.allowNot);if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this))return e=this.filter,e.conditions.push(this.context.condition),t.allowNot=i,e},b.prototype.visitStartsWith=function(e){this.supportsCategorical=!1;var t=this.context,i=(t.condition=new o(t.isNegative?8:7),t.allowNot);if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this))return e=this.filter,e.conditions.push(this.context.condition),t.allowNot=i,e},b.prototype.getFilterOperator=function(e,t){switch(this.supportsCategorical=this.supportsCategorical&&0===e.comparison,e.comparison){case 3:return t?4:1;case 4:return t?3:2;case 1:return t?2:3;case 2:return t?1:4;case 0:return n.data.SQExpr.isConstantNull(e.right)?t?12:11:n.data.SQExpr.isConstantText(e.right)&&""===e.right.value?t?14:13:t?10:9}},b.prototype.createFilterCard=function(e){return this.filter||(this.filter=new t.AdvFilterCard(e),this.filter.supportsCategorical=this.supportsCategorical,this.filter.logicalOperator=this.context.logicalOperator),this.filter},C=b,E.prototype.visit=function(e){e=this.expandExpr(e);return e&&(this.result?0===this.logicalOperator?this.result=d.and(this.result,e):1===this.logicalOperator&&(this.result=d.or(this.result,e)):this.result=e),this.result},E.prototype.expandExpr=function(e){var t,i=11!==e.operator&&12!==e.operator&&13!==e.operator&&14!==e.operator;if((t=i?this.getValueExpr(e):t)||!i)switch(e.operator){case 9:return d.compare(0,this.propertyExpr,t);case 10:return d.not(d.compare(0,this.propertyExpr,t));case 11:return d.compare(0,this.propertyExpr,d.nullConstant());case 12:return d.not(d.compare(0,this.propertyExpr,d.nullConstant()));case 5:return d.contains(this.propertyExpr,t);case 6:return d.not(d.contains(this.propertyExpr,t));case 7:return d.startsWith(this.propertyExpr,t);case 8:return d.not(d.startsWith(this.propertyExpr,t));case 3:return d.compare(1,this.propertyExpr,t);case 4:return d.compare(2,this.propertyExpr,t);case 1:return d.compare(3,this.propertyExpr,t);case 2:return d.compare(4,this.propertyExpr,t);case 13:return d.compare(0,this.propertyExpr,d.text(""));case 14:return d.not(d.compare(0,this.propertyExpr,d.text("")))}},E.prototype.getValueExpr=function(e){var t=this.dataType;if(e.value){var i=e.value.stringValue;if((t.integer||t.numeric)&&i)return r=n.formattingService.parseFloat(i),isNaN(r)?void 0:(i.match(f)&&(r/=100),2===t.primitiveType?d.decimal(r):_.isInteger(r)?d.integer(r):d.double(r));if(t.text&&i)return d.text(i);if(t.dateTime){var r=e.value.dateValue;if(r)return this.isMappedToMParameter?d.dateTime(r):d.dateSpan(5,d.dateTime(r))}}},S=E})(powerbi=powerbi||{}),(function(e){(function(e){function t(e,t){this._contract=e,this._state=t}Object.defineProperty(t.prototype,"contract",{get:function(){return this._contract},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"readOnlyState",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.updateViewState=function(){this.updateViewStateCore(this._state)},t.prototype.updateViewStateCore=function(e){},e.ViewModel=t})((e=e.explore||(e.explore={})).viewModels||(e.viewModels={}))})(powerbi=powerbi||{}),(function(P){var e;(function(e){var o=P.explore.constants.ExploreCanvasConstants.CanvasGutterSize,h=P.visuals.ColorHelper,V=P.common.utils.ColorUtility,t=jsCommon.CssConstants.createClassAndSelector,m=jsCommon.CssConstants,x=P.data.DataViewObjectDefinitions,w=P.explore.constants.ExploreCanvasConstants,u=P.explore.services,s=P.explore.constants.ExploreCanvasConstants.MobileFooterHeight,y=P.visualHost.ResourcePackageReferenceResolver,l=P.explore.contracts.SectionAlignmentOption;function r(){}r.setScrollWidth=function(e){this.scrollWidth=e},r.fitToWidth=function(e,t,i,r,n,a,o){void 0===a&&(a=!1),null!=e.canvasOptions.overrideSectionAlignment&&(o=e.canvasOptions.overrideSectionAlignment);var s=t.get(0).getBoundingClientRect(),l=this.findParentElement(t,this.ExploreCanvasSelector).get(0).getBoundingClientRect(),u=t.find(".displayAreaViewport").get(0).getBoundingClientRect(),c=(s.width>u.width&&(c=s.width-u.width,null!=this.scrollWidth&&.01<Math.abs(this.scrollWidth-c)&&jsCommon.Trace.error("Multiple scroll bar widths detected, "+this.scrollWidth+" -> "+c),this.scrollWidth=c),n.getConfig()),n=2*w.CanvasGutterSize,p=s.width-n,h=s.height-n,d=this.getFitToWidthScaledSize(e,p,r),v=t.find(this.DisplayAreaNameSelector.selector),g=1===e.viewModel.canvasLayout,h=(d.height<=h&&!g?(e.canvasViewStyle=2,t.css(m.overflowXProperty,m.hiddenValue).css(m.overflowYProperty,m.hiddenValue),this.positionElement(v,u,d,o,!0,c.displayOptions.forceCenteredVerticalAlignment)):(n=c.displayOptions.scaleBackgroundImageToWidth?w.CanvasGutterSize/2+(this.scrollWidth||0):3*w.CanvasGutterSize/2+(this.scrollWidth||8),p=s.width-n,d=this.getFitToWidthScaledSize(e,p,r),e.canvasViewStyle=1,t.css(m.overflowXProperty,m.hiddenValue).css(m.overflowYProperty,m.scrollValue),this.clearElementPosition(v)),p/e.viewModel.width),g=this.getWallpaperScale(l,e.viewModel.width,e.viewModel.height,e.canvasOptions.scrollbarOffset,0);i.setDisplayAreaScaleFactor(h),i.setWallpaperScaleFactor(g),this.updateCanvasSize(e,d.width,d.height),v.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e)),this.setElementSize(v,d),a||c.displayOptions.preserveScrollPositionOnResize||(u=!1,(o=e.fitToWidthScrollPosition)&&((s=e.viewModel&&e.viewModel.contract)&&s.name===o.sectionName&&s.size&&s.size.width===o.sectionSize.width&&s.size.height===o.sectionSize.height&&(u=!0,t.scrollTop(o.relativeScroll*h)),u||(e.fitToWidthScrollPosition=void 0)),u||t.scrollTop(0),t.scrollLeft(0))},r.getWallpaperScale=function(e,t,i,r,n,a,o){return 0===n?(e.width-r)/t:(n=i,(n=a&&o?a.getConfig().displayOptions.hideTileMenu?e.height:e.height-o:n)/i)},r.getFitToWidthScaledSize=function(e,t,i){var r,n=t/e.viewModel.width,a=e.viewModel.height*n+i;return!e.adjustScaleForLayout||(e=e.adjustScaleForLayout({x:n,y:n})).x===n&&e.y===n||(t*=r=(e=Math.min(e.x,e.y))/n,a=(a-i)*r+i,n=e),{width:t,height:a}},r.fitToPage=function(e,t,i,r,n,a){null!=e.canvasOptions.overrideSectionAlignment&&(a=e.canvasOptions.overrideSectionAlignment);var o=this.findParentElement(t,this.ExploreCanvasSelector).get(0).getBoundingClientRect(),s=e.outerViewport.width/e.viewModel.width,l=this.getFitToPageScaleY(e,r,n),l=Math.min(s,l),o=this.getWallpaperScale(o,e.viewModel.width,e.viewModel.height,e.canvasOptions.scrollbarOffset,l===s?0:1,r,n),r=(!e.adjustScaleForLayout||(s=e.adjustScaleForLayout({x:l,y:l})).x===l&&s.y===l||(l=Math.min(s.x,s.y)),i.setDisplayAreaScaleFactor(l),i.setWallpaperScaleFactor(o),t.scrollTop(0).scrollLeft(0),e.viewModel.width*l),s=e.viewModel.height*l+n,i=(e.canvasViewStyle=0,e.canvasViewStyle|=4,t.css(m.overflowXProperty,m.hiddenValue).css(m.overflowYProperty,m.hiddenValue),this.updateCanvasSize(e,r,s),t.find(this.DisplayAreaNameSelector.selector)),o=(i.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e)),{width:r,height:s});this.setElementSize(i,o),this.positionElement(i,e.outerViewport,o,a,!1)},r.getFitToPageScaleY=function(e,t,i){i=t.getConfig().displayOptions.hideTileMenu?e.outerViewport.height:e.outerViewport.height-i;return(i-=this.getCanvasOutlineSize(e,t))/e.viewModel.height},r.findParentElement=function(e,t){if(e)return e.hasClass(t.class)?e:this.findParentElement(e.parent(),t)},r.getVerticalAlignmentSetting=function(e,t,i){e=e.viewModel&&e.viewModel.contract&&e.viewModel.contract.evaluatedObjects&&e.viewModel.contract.evaluatedObjects.displayArea&&e.viewModel.contract.evaluatedObjects.displayArea.verticalAlignment&&e.viewModel.contract.evaluatedObjects.displayArea.verticalAlignment.toString();if(e)return l[e];e=i.getCurrentExploration(),i=e&&e.evaluatedObjects&&e.evaluatedObjects.section&&e.evaluatedObjects.section.verticalAlignment&&e.evaluatedObjects.section.verticalAlignment.toString();return i?l[i]:void 0},r.positionElement=function(e,t,i,r,n,a){a=null!=t.height&&null!=i.height?(t.height-(a?s:0)-i.height)/2:void 0,t=null!=t.width&&null!=i.width?(t.width-i.width)/2:void 0,i={position:"absolute",left:null!=t?t+"px":""};r===l.Top?_.extend(i,{top:null!=a?(n?o:0)+"px":""}):(l.Middle,_.extend(i,{top:null!=a?a+"px":""})),e.css(i)},r.setElementSize=function(e,t){e.css({height:t.height+"px",width:t.width+"px"})},r.clearElementPosition=function(e){e.css({position:"",top:"",left:""})},r.clearElementSize=function(e){e.css({height:"",width:""})},r.fitToScreen=function(e,t,i,r){var n=t.find(this.DisplayAreaNameSelector.selector);this.clearElementPosition(n),this.clearElementSize(n),e.canvasViewStyle=8,i.setDisplayAreaScaleFactor(1),i.setWallpaperScaleFactor(1),this.updateCanvasSize(e,e.outerViewport.width,e.outerViewport.height),t.css(m.overflowXProperty,m.hiddenValue).css(m.overflowYProperty,m.hiddenValue),n.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e))},r.getCanvasActualSize=function(e,t,i){t=r.getAutoLayoutVisualVCHeader(t,i),i=e.size;return{height:i.height+t,width:i.width}},r.displayInActualSize=function(e,t,i,r,n,a,o){void 0===o&&(o=1),null!=e.canvasOptions.overrideSectionAlignment&&(a=e.canvasOptions.overrideSectionAlignment);var s=t.find(this.DisplayAreaNameSelector.selector),l=e.isCanvasBackdropVisible(),u=(e.canvasViewStyle=0,e.viewModel.width*o),n=e.viewModel.height*o+n,c={width:l?w.PhoneAuthoringViewportWidth:u,height:l?w.PhoneAuthoringViewportHeight:n},t=(c.width>e.outerViewport.width?(e.canvasViewStyle|=512,t.css(m.overflowXProperty,m.autoValue)):(e.canvasViewStyle|=256,t.css(m.overflowXProperty,m.hiddenValue)),c.height>e.outerViewport.height?(e.canvasViewStyle|=128,t.css(m.overflowYProperty,m.autoValue)):(e.canvasViewStyle|=64,t.css(m.overflowYProperty,m.hiddenValue)),e.canvasViewStyle),a=(this.positionElement(s,e.outerViewport,{width:256&t?c.width:void 0,height:64&t?c.height:void 0},a,!0),e.canvasViewStyle|=256&t&&64&t?32:16,this.setElementSize(s,c),r.setDisplayAreaScaleFactor(o),r.setWallpaperScaleFactor(o),this.updateCanvasSize(e,u,n),this.convertDisplayOptionToStyle(e));s.attr("class",this.DisplayAreaNameSelector.class+" "+a),l&&i.attr("class",this.CanvasBackdropSelector.class+" "+a)},r.displayInActualSizeTopLeft=function(e,t,i,r){var n=t.find(this.DisplayAreaNameSelector.selector),t=(e.canvasViewStyle=0,e.canvasViewStyle|=512,e.canvasViewStyle|=128,e.canvasViewStyle|=16,e.viewModel.width>=e.outerViewport.width?t.css(m.overflowXProperty,m.autoValue):t.css(m.overflowXProperty,m.hiddenValue),e.viewModel.height>=e.outerViewport.height?t.css(m.overflowYProperty,m.autoValue):t.css(m.overflowYProperty,m.hiddenValue),i.setDisplayAreaScaleFactor(1),i.setWallpaperScaleFactor(1),e.viewModel.width),i=e.viewModel.height+r;n.css({width:t+"px",height:i+"px"}),this.updateCanvasSize(e,t,i),n.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e))},r.updateCanvasSize=function(e,t,i){t={width:t,height:i};0<t.width&&0<t.height&&(e.size=t)},r.updateAndApplyBackground=function(e,t,i,r,n,a,o,s,l,u,c,p,h){var d,v,g,m,y,f,C,S=u.getConfig(),b=S.displayOptions.hideOutspaceFormatting,E=1===u.getMode()&&!t.isCanvasBackdropVisible(),h=!!h.get();switch(e){case 1:g=t.outspace=t.outspace||{},v="outspace",d=t.outspaceBackground,m=w.getDefaultCanvasOutspace(),y=l.getCurrentLayoutCapabilities().canShowCanvasOutspace();break;case 2:g=t.background=t.background||{},v="background",d=t.canvasBackground,m=w.getDefaultCanvasBackground(),y=l.getCurrentLayoutCapabilities().canShowCanvasBackground()}y?(r=r&&r[v],f=g.image,h?(g.color=w.DefaultCanvasBackgroundColor,g.transparency=0,g.image=null):r?(g.color=P.DataViewObject.getFillColorByPropertyName(r,"color",w.DefaultCanvasBackgroundColor),g.transparency=P.DataViewObject.getValue(r,"transparency",w.DefaultCanvasBackgroundTransparency),g.image=r.image):this.setDefaultBackgroundProperties(g,m),(null==(r=g.image)?void 0:r.name)!==(null==f?void 0:f.name)&&null!=(f=t.backgroundImageChanging)&&f.call(t,e),f=t.viewModel.contract.objects,(C=(f=x.getObjectDefinition(f,v,null))&&f.properties.image)&&P.data.SQExpr.isResourcePackageItem(C.url)?this.setImageFromPackage(t,d,g,r,C.url,f,a,o,s,p,E,c,b,e,h):this.setImage(d,g,r,r?r.url:"",h,p,E,c,b,e,t)):(this.setDefaultBackgroundProperties(g,m),this.setImage(d,m,null,"",h,p,E,c,b,e,t)),2===e&&(u&&S.displayOptions.extendBackgroundToWholeCanvas?i.css({"background-color":V.hexToRGBString(g.color,(100-g.transparency)/100)}):i.css({"background-color":""}))},r.setDefaultBackgroundProperties=function(e,t){e.color=t.color,e.image=t.image,e.transparency=t.transparency},r.setImage=function(e,t,i,r,n,a,o,s,l,u,c){var p=i&&i.scaling,n=n?1:(100-t.transparency)/100,i=i&&r;i!==e.imageSource&&(e.imageSource=i,null!=(r=c.backgroundImageChanged)&&r.call(c,u)),e.imageFitClass=p,e.imageStyle=p===P.visuals.imageScalingType.normal?{transform:"scale("+a.getWallpaperScaleFactor()+")"}:{},e.backgroundStyle||(e.backgroundStyle={}),e.backgroundStyle.opacity=n,e.backgroundStyle["background-color"]=l&&1===u?"transparent":V.hexToRGBString(t.color),2===u&&(i=h.getThemeColor(s,"foregroundNeutralSecondary"),e.displayAreaStyle||(e.displayAreaStyle={}),e.displayAreaStyle["box-shadow"]=l?"0 0 0":"0 0 10px rgba(200,200,200,"+n+")",e.displayAreaStyle.outline=o&&n<=.5?"2px dotted "+i:"none",e.imageStyle=p===P.visuals.imageScalingType.normal?{transform:"scale("+a.getDisplayAreaScaleFactor()+")"}:{})},r.setImageFromPackage=function(i,r,n,a,o,s,e,t,l,u,c,p,h,d,v){var g,m=this,t=(void 0===h&&(h=!1),t.getCurrentExploration());t&&(g=i.viewModel.contract,y.loadAndResolveFromSQExpr(o,t.resourcePackages,e,l).then((function(e){var t=s.properties.image;g===i.viewModel.contract&&t&&P.data.SQExpr.equals(t.url,o)&&m.setImage(r,n,a,e.value||"",v,u,c,p,h,d,i)})))},r.setDisplayAreaBackground=function(e,t,i){t&&t.outspace?e.canvasBackground.displayAreaStyle&&delete e.canvasBackground.displayAreaStyle["background-color"]:(e.canvasBackground.displayAreaStyle||(e.canvasBackground.displayAreaStyle={}),t=h.getThemeColor(i,"background"),e.canvasBackground.displayAreaStyle["background-color"]=t)},r.convertDisplayOptionToStyle=function(e){var t="";return e.useResponsiveLayout&&(t+=" responsive"),e.disableAnimations&&(t+=" disableAnimations"),8==(8&e.canvasViewStyle)&&(t+=" fitToScreen"),4==(4&e.canvasViewStyle)&&(t+=" fitToPage"),1==(1&e.canvasViewStyle)&&(t+=" fitToWidthOrigin"),2==(2&e.canvasViewStyle)&&(t+=" fitToWidthCentered"),256==(256&e.canvasViewStyle)&&(t+=" actualSizeAlignCenter"),512==(512&e.canvasViewStyle)&&(t+=" actualSizeAlignLeft"),64==(64&e.canvasViewStyle)&&(t+=" actualSizeAlignMiddle"),128==(128&e.canvasViewStyle)&&(t+=" actualSizeAlignTop"),32==(32&e.canvasViewStyle)&&(t+=" actualSizeCentered"),16==(16&e.canvasViewStyle)&&(t+=" actualSizeOrigin"),t.trim()},r.getAutoLayoutVisualVCHeader=function(e,t){return t&&t.getCapabilities().visualContainerOptions.useStylableHeader||e&&e.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()?0:w.AutoLayoutVisualVCHeader},r.getCanvasOutlineSize=function(e,t){if(1===t.getMode()){t=e.background&&e.background.transparency;if(t&&t>=w.DisplayAreaTransparencyOutlineThreshold)return w.DisplayAreaOutlineSize}return 0},r.applyFitOption=function(e,t,i,r,n,a){if(e.viewModel&&e.viewModel.contract){var o=t.find(this.DisplayAreaContainerNameSelector.selector),s=this.findParentElement(t,this.ExploreCanvasSelector).find(this.CanvasBackdropSelector.selector),t=i.canvasScale.getDisplayOption(),l=(2!==t&&(e.fitToWidthScrollPosition=void 0),this.getAutoLayoutVisualVCHeader(i.formFactor,i.explorationCapabilities));switch(t){case 2:this.fitToWidth(e,o,i.canvasScale,l,i.viewModeState,a,r);break;case 1:this.fitToPage(e,o,i.canvasScale,i.viewModeState,l,r);break;case 3:this.displayInActualSize(e,o,s,i.canvasScale,l,r,n);break;case 4:this.displayInActualSizeTopLeft(e,o,i.canvasScale,l);break;default:this.fitToScreen(e,o,i.canvasScale,l)}i.eventBridge.publishToChannel(u.events.CanvasResized)}},r.storeOverflowValuesAndChange=function(e,t){this.currentOverflowXCSSValue=e.css(m.overflowXProperty),this.currentOverflowYCSSValue=e.css(m.overflowYProperty),e.css(m.overflowXProperty,t),e.css(m.overflowYProperty,t)},r.restoreOverflowValues=function(e){e.css(m.overflowXProperty,this.currentOverflowXCSSValue),e.css(m.overflowYProperty,this.currentOverflowYCSSValue)},r.visualPositionToRect=function(e){return{left:e.x,top:e.y,width:e.width,height:e.height}},r.rectToVisualPosition=function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},r.isCortanaPageSize=function(e){return!1},r.DisplayAreaNameSelector=t("displayArea"),r.DisplayAreaContainerNameSelector=t("displayAreaContainer"),r.VisualContainerHostSelector=t("visualContainerHost"),r.OutspaceContainerSelector=t("outspaceContainer"),r.OutspaceImageSelector=t("outspaceImage"),r.VisualBackgroundContainerSelector=t("visualBackgroundContainer"),r.VisualBackgroundImageSelector=t("visualBackgroundImage"),r.DefaultVisualPosition={x:100,y:100,width:300,height:300},r.CanvasBackdropSelector=t("canvasBackdrop"),r.ExploreCanvasSelector=t("exploreCanvas"),r.currentOverflowXCSSValue="",r.currentOverflowYCSSValue="",e.CanvasDisplayUtility=r})((e=P.explore||(P.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(A){var T,o,i,D,s,l,t,n,u,a,c,M;function r(e,i){for(var t={},r=0,n=i;r<n.length;r++){var a=n[r];t[a.name]=!0}function o(t){return _.findIndex(i,(function(e){return e.name===t.name}))}var s=[];T.viewModels.traverseVisualContainerGroups(e,(function(e){t[e.name]&&s.push(e)}));return s.sort((function(e,t){return o(e)-o(t)})),s}function p(e,t){void 0===t&&(t=!1);for(var i=e.parentGroup,r=e;i;){if(i.isSelected||i.isChildSelected){t&&i.isSelected&&(r=i);break}i=(r=i).parentGroup}return r}function h(e,t){var i=e.filter;if((e.type===n.Include||e.type===n.Exclude)&&i){var r=i.rewrite(t);if(r!==i)return A.Prototype.inherit(e,(function(e){return e.filter=r}))}return e}function d(e,t,i){if(!_.isEmpty(e)){for(var r=t&&[],n=0,a=e;n<a.length;n++){var o=a[n].canvasItem;o&&(t&&T.contracts.isVisualContainerGroup(o)?r.push(o):i(o))}t&&!_.isEmpty(r)&&T.contracts.traverseVisualContainerGroups(r,(function(e){return i(e)}))}}function v(e,a,o,t,i,r,n,s,l,u){if(e){var c={},p=!!n,h=o.size,d=u?o.visualContainerGroups:o.visualContainers,v=_.flatMap(a.sections,(function(e){return u?e.visualContainerGroups:e.visualContainers})),g=[],m=i.getCurrentLayout(),i=(T.contracts.traverseVisualContainerGroups(d,(function(e){null==e.parentGroup&&(e=e.layouts.withId(m).position,g.push(e))})),T.contracts.traverseVisualContainerGroups(v,(function(e){c[e.name]=!0})),t.deserializeCanvasItems(e,!0,u,(function(){var e=M.nextUniqueName(c);return c[e],c[e]=!0,e})));if(i){var v=i.visualContainerGroups,t=i.visualContainers,y=I(d,m),f=O(o.visualContainers,m),C=D.createWithId(),S=[],b=function(e){var t,i=null!=e.parentGroup,r=e.layouts.withId(m),n=r.position;if(u||T.contracts.isVisualContainer(e),i&&u||(n.z=y++,S.push(e)),null!=n.tabOrder&&T.contracts.isVisualContainer(e)&&(t=0<=n.tabOrder,n.tabOrder=t?f.pos++:f.neg--),!i){for(;2!==(function(e,t){var i=t.width||0,t=t.height||0,r=0;e.x+e.width>i&&(e.x=Math.max(i-e.width,0),r++);e.y+e.height>t&&(e.y=Math.max(t-e.height,0),r++);return r})(n,h)&&(function(t,e){return _.some(e,(function(e){return t.x===e.x&&t.y===e.y}))})(n,g);)n.x+=10,n.y+=10;g.push(n)}e.layouts=D.extendWithId([r]),p&&T.contracts.isVisualContainer(e)&&(t=T.viewModels.ViewModelFactory.convertVisualContainer(a,o,e,m),C.push(t))};if(u)T.contracts.traverseVisualContainerGroups(v,b);else for(var E=0,V=t;E<V.length;E++){var x=V[E];b(x)}if((e=o.visualContainers).push.apply(e,t||[]),p&&(i=n.visualContainers).push.apply(i,C||[]),u?(o.visualContainerGroups=A.ItemGroupingManager.add.apply(A.ItemGroupingManager,__spreadArray([o.visualContainerGroups],v||[])),p&&(d=T.viewModels.ViewModelFactory.convertVisualContainerGroups(v,C,m),n.visualContainerGroups=A.ItemGroupingManager.add.apply(A.ItemGroupingManager,__spreadArray([n.visualContainerGroups],d||[])))):(o.visualContainerGroups=A.ItemGroupingManager.add.apply(A.ItemGroupingManager,__spreadArray([o.visualContainerGroups],t||[])),p&&(n.visualContainerGroups=A.ItemGroupingManager.add.apply(A.ItemGroupingManager,__spreadArray([n.visualContainerGroups],C||[])))),r.publishVisualContainerAddedEvent(),s&&T.services.selectionUtils.selectCanvasItems(S,s,!0),l)for(var w=0,P=S;w<P.length;w++){var F=P[w];T.contracts.isVisualContainer(F)&&l.applyFilterOutput(F)}return S}}}function I(e,t){return _.isEmpty(e)?0:_.chain(e).map((function(e){e=e.layouts.withId(t),e=e&&e.position;return e&&e.z||0})).max().value()+1}function O(e,t){var i=0,r=0;if(_.isEmpty(e))return{pos:i,neg:r};for(var n=0,a=e;n<a.length;n++){var o=a[n].layouts.withId(t),o=o&&o.position,o=o&&null!=o.tabOrder?o.tabOrder:void 0;null!=o&&(i=Math.max(i,o),r=Math.min(r,o))}return{pos:i+1,neg:r-1}}function y(e,t){e=e.layouts.withId(t);return e&&e.position}T=A.explore||(A.explore={}),o=T.util||(T.util={}),D=jsCommon.ArrayExtensions,s=A.data.DataViewObjectDefinitions,l=A.data.DataViewTransform,t=A.explore.constants.ExploreCanvasConstants,n=A.explore.contracts.FilterType,u=A.explore.services.selectionUtils,a=A.data.SQExpr,c=A.explore.services.StaticResourceReferences,M=A.explore.util.VisualContainerUtils,(i=o.CanvasVisualsUtility||(o.CanvasVisualsUtility={})).objectIsHidden=function(e,t,i){var i=i&&i[e],r=A.explore.viewModels.PropertySliceNames.Show;return i?i.hasOwnProperty(r)&&!i[r]:void 0!==(i=s.getValue(t,{objectName:e,propertyName:r},null))&&a.isConstant(i)&&!i.value},i.getSelectedCanvasItemViewModels=function(e,t){return t=u.getSelectedCanvasItems(t),r(e.visualContainerGroups,t)},i.findVisualContainerViewModel=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.contract===t)return n}},i.findCanvasItemViewModels=r,i.syncCanvasItemViewModelsWithContracts=function e(t,i){t.length,i.length;for(var r=0,n=t;r<n.length;r++){var a=n[r],o=A.ItemGroupingManager.find(a.name,i);o&&T.viewModels.isVisualContainerGroup(a)&&T.contracts.isVisualContainerGroup(o)&&(a.contract!==o&&(a.contract.name,o.name,a.contract=o),e(a.children,o.children))}},i.addOffsetFromGroup=function(e,t){if(t.parentGroup)for(var i=t.parentGroup;i;){var r=i.position;e.left+=r.x,e.top+=r.y,i=i.parentGroup}return e},i.getContainerGroupDepth=function(e){var t=0;if(_.isEmpty(e))return t;if(e[0].parentGroup)for(var i=e[0].parentGroup;i;)t++,i=i.parentGroup;return (function e(t,i){i++;var r=i;for(var n=0,a=t;n<a.length;n++){var o=a[n];T.contracts.isVisualContainerGroup(o)&&(r=Math.max(e(o.children,i),r))}return r})(e,t)},i.toggleSelectContainer=function(e,t,i,r,n){r.hideAllDropdowns(),o.EventBubblingUtility.markAsHandled(e);var r=jsCommon.BrowserUtils.isCtrlOrMeta(e),a=u.isCanvasItemSelected(t.contract,i);if(!(r&&a&&1<u.getSelectedCanvasItems(i).length))return n?void u.selectCanvasItem(t.contract,i,jsCommon.SelectionUtility.getMultiSelectMode(e)):((r=p(t)).parentGroup&&r.parentGroup.isSelected&&u.unselectCanvasItem(r.parentGroup.contract,i),u.selectCanvasItem(r.contract,i,jsCommon.SelectionUtility.getMultiSelectMode(e)),void(null!==(a=e.currentTarget,n=r.contract.name,t=$(a).parents('[name="'+n+'"]:first')[0])&&void 0!==t&&t.focus()));u.unselectCanvasItem(t.contract,i)},i.setHoverForParentGroup=function(e,t,i){if(e.parentGroup)if(t){var r=p(e);r!==e&&M.notifyContainerHoverEvent(t,r.name,i)}else for(var n=e.parentGroup;n;)M.notifyContainerHoverEvent(t,n.name,i),n=n.parentGroup},i.getContainerToSelect=p,i.selectIfNotSelected=function(e,t){u.isCanvasItemSelected(e,t)||u.selectCanvasItem(e,t)},i.serializeSelection=function(t,e,i,r){void 0===r&&(r=!0);var n=[];return d(e.getSelectedElements(),r,(function(e){T.contracts.isVisualContainerGroup(e)?n.push(t.serializeVisualContainerGroup(e)):(e=(function(e,t){if(!e.filters)return e;t=new o.VariationToHierarchyRewriter(t);return (function(e,t){var i=D.rewriteArray(e.filters,(function(e){return h(e,t)}));return i===e.filters?e:A.Prototype.inherit(e,(function(e){return e.filters=i}))})(e,t)})(e,i),n.push(t.serializeVisualContainer(e)))})),n},i.evaluateObjects=function(e,t,i,r,n,a){var o=e.objects,i=((i=n.getVisualObjects(r,i,void 0,t))&&(o=s.clone(o||{}),s.extend(o,i)),n.getVisualStyle(r)),n=l.evaluateMetadataOnceDataViewObjectDefinitions(o,t,i,a.featureSwitches);e.evaluatedObjects=n.dataViewObjects},i.evaluateSectionObject=function(e,t,i,r,n,a,o){if(e=s.clone(e.objects||{}),r=n.getVisualObjects(r,A.explore.constants.SectionComponentType,void 0,((n={})[t]=i,n)),s.extend(e,r),e&&e[t]){n=s.getObjectDefinition(e,t,o);if(n)return r=A.data.createEmptyEvalContext(),A.data.createDataViewObjectEvaluator(a.featureSwitches,A.visuals.visualStyles.create()).run(t,r,i,n.properties)}},i.rewriteFilterContainer=h,i.getSelectionResources=function(e,t,i){void 0===i&&(i=!0);var r={};return d(e=e.getSelectedElements(),i,(function(e){e=e,T.contracts.isVisualContainer(e)&&(e=e.config.singleVisual.objects,c.addObjectsReferences(e,void 0,t,r))})),r},i.checkBoundaryForCharts=function(e,t,i){return 0<(t=(e=Math.max(0,e-t/2))+t-i)&&(e-=t),e},i.duplicateCanvasItem=function(e,t,i,r,n,a,o,s,l,u){return _.first(v([e],t,i,r,n,a,o,s,l,u))},i.duplicateCanvasItems=v,i.addVisualContainerToCanvas=function(i,r,n,a,o,s){var l;return __awaiter(this,void 0,A.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return i.expr?[3,1]:(t=o.addEmptyVisualContainer(r,n,i.visualType,i.position,i.shouldSummarize),[3,3]);case 1:return[4,o.addVisualContainer({expr:i.expr,visualType:i.visualType,targetRole:i.targetRole,dataSources:a,allowAggregate:null==(l=i.allowAggregate)||l,shouldSummarize:i.shouldSummarize},r,n)];case 2:t=e.sent(),e.label=3;case 3:return s.logEvent(A.telemetry.EXCreateVisual,{source:(function(e){switch(e){case 0:return"CheckboxTickedInFieldList";case 3:return"DraggedToFieldWell";case 1:return"DraggedToCanvas";case 2:return"VisualTypeIconClicked";case 4:return"InsertVisualButton";case 5:return"WhatIfParameterControl";case 8:return"QnaAppBar";case 6:return"QnaDoubleClick";case 7:return"QnaKeyboardShortcut";case 9:return"FieldParameterControl";case 10:return"CanvasBackgroundContextMenu"}})(i.telemetrySource),visualType:M.getVisualType(t),visualName:t.name}),[2,t]}}))}))},i.convertToScaledPosition=function(e,t,i){var r,n,a,t={x:e.x*t.x,y:e.y*t.y,z:e.z,width:e.width*t.x,height:e.height*t.y,angle:e.angle,tabOrder:e.tabOrder};return!0===i&&(i=Math.round(t.x),r=Math.round(t.y),n=Math.round(t.x+t.width),a=Math.round(t.y+t.height),t={x:i,y:r,z:t.z,width:n-i,height:a-r,angle:e.angle,tabOrder:e.tabOrder}),t},i.convertFromScaledPosition=function(e,t){return{x:e.x/t.x,y:e.y/t.y,z:e.z,width:e.width/t.x,height:e.height/t.y,angle:e.angle,tabOrder:e.tabOrder}},i.convertToScaledRect=function(e,t){return{left:e.left*t.x,top:e.top*t.y,width:e.width*t.x,height:e.height*t.y}},i.convertFromScaledRect=function(e,t){return{left:e.left/t.x,top:e.top/t.y,width:e.width/t.x,height:e.height/t.y}},i.getZIndexForNewCanvasItem=I,i.getNextTabOrders=O,i.getTabOrderForNewVisual=function(e,t,i){if(!e||_.isEmpty(e.visualContainers))return 0;var r=t?A.explore.services.CanvasListOrderingConstants.posMinOrder:A.explore.services.CanvasListOrderingConstants.negMinOrder;return _.forEach(e.visualContainers,(function(e){var e=e.layouts.withId(i),e=e&&e.position;e&&e.tabOrder&&(e=e.tabOrder,r=t?Math.max(r,e):Math.min(r,e))})),r+(t?1:-1)},i.getDragRestrictElementRect=function(e,t,i){for(var r=0,n=0,a=0,o=0,s=null,l=0,u=0,c=i.length;u<c;u++){l=u;if((d=i[u])===e){v=(v=d.parentGroup)&&v.layouts.withId(t)?v:void 0,s=M.getAbsoluteVisualContainerPosition(y(d,t),t,v);break}}if(s){i.splice(l,1);for(var p=0,h=i;p<h.length;p++){v=(v=(d=h[p]).parentGroup)&&v.layouts.withId(t)?v:void 0;var d,v,g=M.getAbsoluteVisualContainerPosition(y(d,t),t,v),m=s.x-g.x,r=r<m?m:r,n=n<(m=g.y+g.height-(s.y+s.height))?m:n,a=a<(m=s.y-g.y)?m:a,o=o<(m=g.x+g.width-(s.x+s.width))?m:o}return{top:0-(0<a?a/s.height:0),left:0-(0<r?r/s.width:0),bottom:1+(0<n?n/s.height:0),right:1+(0<o?o/s.width:0)}}},i.getPosition=y,i.getCanvasItemsByLevel=function(e){for(var t={},i=0,r=u.getSelectedCanvasItems(e);i<r.length;i++){var n=r[i],a=n.parentGroup?n.parentGroup.name:"root";t[a]=t[a]||[],t[a].push(n)}return t},i.filterContractsByTabOrderSign=function(e,t){return _.filter(e,(function(e){e=i.getPosition(e,0).tabOrder;return t?void 0===e||0<=e:e&&e<0}))},i.getOutspacePaneWidth=function(e){return(e=e.getCurrentSection())&&e.evaluatedObjects&&e.evaluatedObjects.outspacePane&&e.evaluatedObjects.outspacePane.width||t.DefaultOutspacePaneWidth}})(powerbi=powerbi||{}),(function(n){var e,a,o;function s(e){e=e.solid.color;return jsCommon.Color.isHexString(e.value)?{solid:{color:e.value}}:null}function t(e,t){var i,r;return{minValue:i=void 0!==e.minValue?u(e.minValue,t):i,maxValue:r=void 0!==e.maxValue?u(e.maxValue,t):r,positiveColor:n.fillDefinitionHelpers.createSolidFillDefinition(e.positiveColor&&e.positiveColor.solid.color,"maxColor"),negativeColor:n.fillDefinitionHelpers.createSolidFillDefinition(e.negativeColor&&e.negativeColor.solid.color,"minColor"),axisColor:n.fillDefinitionHelpers.createSolidFillDefinition(e.axisColor&&e.axisColor.solid.color,"foreground"),reverseDirection:o.boolean(e.reverseDirection),hideText:o.boolean(e.hideText)}}function l(e,t){return n.VisualObjectRepetition.getDefinition(e,t)}function u(e,t){var i;return t.integer||t.numeric,t.integer?(i=Math.round(e),o.integer(i)):2===t.primitiveType?o.decimal(e):(t.extendedType,o.double(e))}e=(e=n.explore||(n.explore={})).util||(e.util={}),o=n.data.SQExprBuilder,(a=e.DataBarsUtil||(e.DataBarsUtil={})).DefaultDataBarsSettings={reverseDirection:!1,hideText:!1},a.getDataBarsSettings=function(e,t){var i;if(!(e=l(e.objects,t)))return a.DefaultDataBarsSettings;(t=e.minValue)&&(i=t.value);var r,t=e.maxValue;return{minValue:i,maxValue:r=t?t.value:r,positiveColor:s(e.positiveColor),negativeColor:s(e.negativeColor),axisColor:s(e.axisColor),reverseDirection:e.reverseDirection.value,hideText:e.hideText.value}},a.createDefaultDataBarsDefinition=function(){return t(a.DefaultDataBarsSettings,n.ValueType.fromPrimitiveTypeAndCategory(12))},a.createDataBarsDefinition=t,a.getDefinition=l,a.isDataBarsApplied=function(e,t){return void 0!==l(e,t)}})(powerbi=powerbi||{}),(function(e){var t;function i(e){return e in t?t[e]:0}e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ErrorDetailsUtility||(e.ErrorDetailsUtility={}),t={BlockedCustomVisual:1,ScriptVisualsNotEnabled:1,UnapprovedCustomVisual:1,CvApiVersionNotSupported:1},e.hasAdditionalErrorInfo=function(e){return!!e&&(e=e.displayableErrorInfo,!_.isEmpty(e)&&(!_.isEmpty(e[0].errorInfoKey)&&!_.isEmpty(e[0].errorInfoValue)))},e.getErrorOverlayType=i,e.shouldHideSeeDetails=function(e){return 1===i(e)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).EventBubblingUtility||(e.EventBubblingUtility={})).handled=function(e){var t;if(e)return void 0!==(t=(null!=(t=e.originalEvent)?t:e).handled)&&!0===t},e.markAsHandled=function(e){var t;e&&((null!=(t=e.originalEvent)?t:e).handled=!0)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ExplorationTrustedVisualUtil||(e.ExplorationTrustedVisualUtil={})).explorationContainsTrustedVisual=function(t,e,i){return!!i.isTrustedVisual(t)&&_.some(e.sections,(function(e){return _.some(e.visualContainers,(function(e){return e.config.singleVisual.visualType===t}))}))},e.acquireTrustedVisuals=function(e,t){for(var i=[],r=0,n=e.sections;r<n.length;r++)for(var a=0,o=n[r].visualContainers;a<o.length;a++){var s=o[a].config.singleVisual.visualType;s&&t.isTrustedVisual(s)&&i.push(s)}return t.getConsentAndLoadVisuals(i)}})(powerbi=powerbi||{}),(function(R){var k,X,H,r,G,j,U,z;k=R.explore||(R.explore={}),X=k.util||(k.util={}),H=R.explore.contracts.FilterType,r=R.explore.services.FormatPainter,G=jsCommon.JsonExtensions,j=R.common.dialog.MessageDialogBuilder,U=R.data.services.SemanticQuerySerializer,z=R.explore.util.VisualContainerUtils,(X.ExploreClipboardHandlerUtility||(X.ExploreClipboardHandlerUtility={})).createClipboardHandler=function(E,V,x,w,P,F,A,T,c,D,M,I,e,u,t,O){var i=this;function N(e){for(var t=0,i=e;t<i.length;t++)i[t].config.singleVisual.syncGroup=null}function L(e,t,i){var r,n,a=[],o=(r=E.exploration.contract.sections,n=e,_.find(r,(function(e){return e.name===n})));if(o)for(var s=0;s<i.length;s++){var l,u=i[s];k.contracts.isVisualContainer(u)&&((l=c.capabilities(u.config.singleVisual.visualType))&&l.supportsSynchronizingFilterState&&u.config.singleVisual.query&&!u.config.singleVisual.syncGroup&&(l=(function(e,t){return _.find(e,(function(e){return e.name===t}))})(o.visualContainers,V.deserializeCanvasItem(t[s]).name))&&a.push({sourceVisual:l,newVisual:u}))}return a}function B(l){return __awaiter(this,void 0,R.Promise,(function(){var t,i,r,n,a,o,s;return __generator(this,(function(e){switch(e.label){case 0:return[4,P.get(F.get())];case 1:for(t=e.sent(),i=(function(){for(var e={},t=0,i=E.exploration.contract.sections;t<i.length;t++)for(var r=0,n=i[t].visualContainers;r<n.length;r++){var a=n[r].config.singleVisual.syncGroup;a&&(e[a.groupName]=!0)}return e})(),r=0,n=l;r<n.length;r++)a=n[r],o=a.sourceVisual.config.singleVisual,(s=o.syncGroup)?a.newVisual.config.singleVisual.syncGroup=__assign({},s):(s=u.generateUniqueGroupName(t,o,i),o.syncGroup={groupName:s,fieldChanges:!0,filterChanges:!0},a.newVisual.config.singleVisual.syncGroup={groupName:s,fieldChanges:!0,filterChanges:!0},i[s]=!0);return[2]}}))}))}return{deleteSelection:function(){E.exploration&&E.exploration.exploreCanvas&&T.deleteSelectedVisuals(E.exploration.exploreCanvas)},deserializeAndDuplicateData:function(f,C,S,b){return __awaiter(i,void 0,void 0,(function(){var l,u,c,p,h,d,v,g,m,y;return __generator(this,(function(e){switch(e.label){case 0:return E.exploration&&E.exploration.exploreCanvas&&S.length?b?[3,2]:[4,P.get(F.get())]:[2];case 1:for(l=e.sent(),u=0,c=S;u<c.length;u++){p=c[u],o=s=a=n=r=i=t=void 0;var t=p,i=l;if(t.filters){for(var r=G.tryParseJSON(t.filters),n=0,a=r;n<a.length;n++){var o,s=a[n];s.type===H[H.Categorical]&&null!=s.filter&&((o=(function(e,t){var i,e=e&&e.HierarchyLevel,e=e&&e.Expression&&e.Expression.Hierarchy,e=e&&e.Expression&&e.Expression.PropertyVariationSource;if(e)return i=U.deserializeExpr(e.Expression).getTargetEntity(),i=i&&i.entity,(function(e,t,i,r){for(var n=0,a=e.schemas;n<a.length;n++)for(var o=a[n],s=0,l=o.entities;s<l.length;s++){var u=l[s];if(u.name===t)for(var c=0,p=u.properties;c<p.length;c++){var h=p[c];if(h.name===i){h=h.column;if(h&&h.variations)for(var d=0,v=h.variations;d<v.length;d++){var g=v[d];if(g.name===r)return g.navigationProperty.targetEntity.name}}}}})(t,i,e.Property,e.Name)})(s.expression,i))&&(s.filter.From.length,s.filter.From[0].Entity=o))}t.filters=JSON.stringify(r)}}e.label=2;case 2:return(v=E.exploration,h=v.contract,y=v.exploreCanvas,d=h&&h.settings&&h.settings.useStylableVisualContainerHeader,v=X.CanvasVisualsUtility.duplicateCanvasItems(S,v.contract,y.contract,V,M,T,y,A,D,d))?(!b&&O&&z.hasVisualColumnRename(v)&&O.syncVisualColumnRenames(h),1===f?[2]:(g=_.filter(v,(function(e){return k.contracts.isVisualContainer(e)&&e.config.singleVisual.syncGroup})),C===E.exploration.exploreCanvas.contract.name?(N(g),[2]):(m=L(C,S,v),_.isEmpty(g)&&_.isEmpty(m)?[2]:[4,new j(w).show("syncVisuals",{titleText:x.get("SyncVisualsDialog_Title"),messageText:x.get("SyncVisualsDialog_Message"),okButtonText:x.get("SyncVisualsDialog_Sync"),cancelButtonText:x.get("SyncVisualsDialog_DoNotSync")})]))):[2];case 3:return(y=0===e.sent(),I.logEvent(R.telemetry.EXCopyPasteSyncGroup,{keepSynced:y,visualGroupCount:m.length}),y)?[4,B(m)]:[3,5];case 4:return e.sent(),[3,6];case 5:N(g),e.label=6;case 6:return[2]}}))}))},serializeSelection:function(){return __awaiter(i,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return i=(t=X.CanvasVisualsUtility).serializeSelection,r=[V,A],[4,P.get(F.get())];case 1:return[2,i.apply(t,r.concat([e.sent()]))]}}))}))},getSelectionResources:function(){return X.CanvasVisualsUtility.getSelectionResources(A,E.exploration.contract.resourcePackages)},getSelectionSectionName:function(){return E.exploration.exploreCanvas.contract.name},deserializeVisualContainer:function(e){return V.deserializeCanvasItem(e,!0)},copyCanvasItemFormat:function(){return r.copyFormatCanvasItem(A,c,E.exploration.contract.themeCollection,t)},pasteCanvasItemFormat:function(e){e=r.pasteFormatCanvasItem(A,c,e);e&&T.raiseCanvasItemChanged(e)},isReady:function(){return null!=E.exploration}}}})(powerbi=powerbi||{}),(function(i){var e;(function(e){function t(){}t.getDefaultVisualPlugin=function(e){return e&&e.featureSwitches&&e.featureSwitches.pivotTableVisualEnabled?i.visuals.plugins.tableEx:i.visuals.plugins.table},e.FieldWellUtility=t})((e=i.explore||(i.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(a){var r,e,t,n,o,s;function i(e,t,i){return 0===e.displayOption?s.Dynamic:e.width===r.constants.ExploreCanvasConstants.DefaultCanvasWidth&&e.height===o.DefaultCanvasHeight?s.Standard:e.width===r.constants.ExploreCanvasConstants.DefaultWidescreenWidth&&e.height===o.DefaultWidescreenHeight?s.Widescreen:n.isCortanaPageSize(e)?-1!==(i=r.PodUtils.findPodIndexForSectionName(t,i.name))&&t.pods[i].cortanaEnabled?s.Cortana:s.Custom:e.width===r.constants.ExploreCanvasConstants.DefaultLetterWidth&&e.height===o.DefaultLetterHeight?s.Letter:(t=e).width===r.constants.ExploreCanvasConstants.DefaultTooltipWidth&&t.height===r.constants.ExploreCanvasConstants.DefaultTooltipHeight?s.Tooltip:s.Custom}r=a.explore||(a.explore={}),e=r.util||(r.util={}),n=a.explore.util.CanvasDisplayUtility,o=r.constants.ExploreCanvasConstants,s=a.explore.contracts.SectionPageSizeTypes.PageSizeTypes,(t=e.PropertyPaneUtils||(e.PropertyPaneUtils={})).PageSizeTypesToSectionSize=((e={})[s.Dynamic]={displayOption:0,width:r.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:r.constants.ExploreCanvasConstants.DefaultCanvasHeight},e[s.Standard]={displayOption:1,width:r.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:r.constants.ExploreCanvasConstants.DefaultCanvasHeight},e[s.Widescreen]={displayOption:1,width:r.constants.ExploreCanvasConstants.DefaultWidescreenWidth,height:r.constants.ExploreCanvasConstants.DefaultWidescreenHeight},e[s.Cortana]={displayOption:3,width:r.constants.ExploreCanvasConstants.DefaultCortanaWidth,height:r.constants.ExploreCanvasConstants.DefaultCortanaHeight},e[s.Letter]={displayOption:1,width:r.constants.ExploreCanvasConstants.DefaultLetterWidth,height:r.constants.ExploreCanvasConstants.DefaultLetterHeight},e[s.Tooltip]={displayOption:1,width:r.constants.ExploreCanvasConstants.DefaultTooltipWidth,height:r.constants.ExploreCanvasConstants.DefaultTooltipHeight},e[s.Custom]={displayOption:3,width:r.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:r.constants.ExploreCanvasConstants.DefaultCanvasHeight},e),t.getDisplayNames=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];t.push(__assign(__assign({},n),{value:""+n.value,displayName:a.explore.viewModels.ViewModelFactory.getDisplayName(n.displayName)}))}return t},t.getDisplayUnits=function(e){for(var t=[],i=0,r=a.visuals.valueFormatter.getDisplayUnits(e=void 0===e?!1:e);i<r.length;i++){var n=r[i];t.push({displayName:n.title,value:n.value.toString()})}return t},t.getPageSizeType=function(e,t){return i(e,t.getCurrentExploration(),t.getCurrentSection())},t.getPageSizeTypeBySection=i,t.getDefaultSectionSize=function(e){return t.PageSizeTypesToSectionSize[e]}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).ScopeUtils||(e.ScopeUtils={})).getSchemaPromise=function(e,t,i){return e?i.get(e):t.reject()},e.defineDataSourcesOnScopeLegacy=function(e,t){Object.defineProperty(e,"dataSources",{get:function(){return t.get()},set:function(e){return t.set(e)}})}})(powerbi=powerbi||{}),(function(e){var t,l,r;t=(t=e.explore||(e.explore={})).util||(t.util={}),l=e.data.SQExpr,r=e.explore.util.VisualContainerUtils,(t=t.SparklinesUtil||(t.SparklinesUtil={})).containsSparklineData=function(e){return _.some(r.getSelectExprs(e),(function(e){return l.isSparklineData(e.expr)}))},t.replaceSparklineDataWithMeasure=function(n,a,o){var e=r.getSelectExprs(a);if(!_.isEmpty(e))for(var s=r.getVisualQuery(a),t=0,i=e;t<i.length;t++)!(function(e){var t,i,r=e.expr;l.isSparklineData(r)&&(t=r.measure,i=s.getRoleNameForExpr(r),e=_.chain(s.tryGetExprs(i)).map((function(e,t){return{expr:e,index:t}})).filter((function(e){return l.equals(e.expr,r)})).map((function(e){return e.index})).value(),_.forEach(e,(function(e){return o.replaceField(n,t,i,e,a)})))})(i[t])},t.getFieldCharacteristics=function(e,t){(t=null==(t=e.grouping[0].getMetadata(t))?void 0:t.type)&&(i=t.dateTime||t.temporal?"Date":t.numeric?"Numeric":"Categorical");var i,t=l.isAggregation(e.measure)?"Aggregate":"Measure";return{groupingType:i,measureType:t}}})(powerbi=powerbi||{}),(function(y){var A,d,e,h,u,a,o,f,v,C,S,b,g,E,l,c,V,s,r,x,w,R,P,F,T,k,D,m,X,H,M,n,I,p,O,G,t,j;function N(e,t,i,r,n,a,o,s,l,u,c,p,h,d,v,g,m,y,f,C,S,b,E,V,x,w,P){var F=this;this.visualPluginService=e,this.pluginOps=t,this.displayNameService=i,this.contextActivityService=r,this.telemetry=n,this.explorationNavigationService=a,this.selectionService=o,this.geotaggingAnalyzerService=s,this.explorationSerializer=l,this.eventBridge=u,this.featureSwitchService=c,this.sortService=p,this.visualRelationshipService=h,this.drill=d,this.expandCollapse=v,this.filterGenerator=g,this.aggrOps=m,this.resourceRegistration=y,this.formFactorProvider=f,this.localizationService=C,this.viewModeState=S,this.linguisticSchemaProxy=b,this.explorationCapabilities=E,this.layoutAuthoring=V,this.runningVisualService=x,this.visualAuthoringCustomizeOperations=w,this.settingsService=P,this.updateFilterState=function(e,t,i,r,n,a){i=F.core.updateFilterState(e,t,i,r,n,a);i.clearOrDefault?F.notifyVisualContainers([t],"UserAction_ChangeFilter",!0,e):F.notifyVisualContainers([t],"UserAction_ChangeFilter",i.updateAll,e)},this.core=A.services.createVisualAuthoringCore(e,s,m,c,w)}function i(){return null!==t&&t.apply(this,arguments)||this}function U(e,t,i,r){var n=e.getMetadata(t);if(n&&n.type.geography)return u.map.name;var a=T.asFieldPattern(e);if(i&&a){var o=a.column||a.groupingColumn,o=o&&o.name,s=a.hierarchyLevel&&a.hierarchyLevel||a.columnHierarchyLevelVariation&&a.columnHierarchyLevelVariation.level;if(s){var l=s.level;if(i.isGeographic(l))return u.map.name;s=m.getConceptualHierarchyLevel(t,s.schema,s.entity,s.name,l),o=s&&s.column&&s.column.name}if(o&&i.isGeographic(o))return u.map.name}l=a.column,s=l&&t.schema(l.schema).findProperty(l.entity,l.name).column;return(D.getWhatIfParameterMetadata(s)&&1===s.defaultAggregate?u.slicer:L(e,n,t)&&1!==n.defaultAggregate?u.clusteredColumnChart:r&&r.pivotTableVisualEnabled?u.tableEx:u.table).name}function z(e,t,i,r){i=_.filter(i.filters,(function(e){return 5===e.howCreated}));e.logChildEvent(r&&r.event,y.telemetry.EXDrillthroughFilterUpdate,{type:t,countOfCurrentPageDrillthroughFilters:i.length})}function L(e,t,i){return!!t&&(1===t.kind||t.type.numeric&&!D.discourageAggregation(e,i))}function B(e){var t;switch(t=e?e.kind:t){case 0:return"Entity";case 2:return"ColumnRef";case 3:return"MeasureRef";case 4:return"Aggregation";case 5:return"PropertyVariationSource";case 6:return"Hierarchy";case 7:return"HierarchyLevel";case 46:return"Sparkline";default:return"Other"}}function W(e){switch(e){case c.Advanced:return"Advanced";case c.Categorical:return"Categorical";case c.Passthrough:return"Passthrough";case c.Range:return"Range";case c.Visual:return"Visual"}}function Q(e){switch(e){case 2:return"Exploration";case 1:return"Section";case 0:return"Visual"}}A=y.explore||(y.explore={}),h=A.util||(A.util={}),u=y.visuals.plugins,a=y.visuals.ActionButtonType,o=jsCommon.ArrayExtensions,f=y.explore.constants,v=y.data.DataBoundExprExtractor,C=y.data.DataViewObjectDefinitions,S=y.data.DataViewRoleWildcard,b=y.explore.util.DrillUtils,g=A.services.events,E=y.explore.constants.ExploreCanvasConstants,l=y.data.FieldExprPattern,c=A.contracts.FilterType,V=y.explore.util.HierarchyUtils,s=y.data.QueryProjectionsByRole,r=y.contracts.ResourcePackageItemType,x=A.services.selectionUtils,w=y.data.SemanticFilter,R=y.visuals.SmallMultiplesUtils,P=y.data.SQExpr,F=y.data.SQExprBuilder,T=y.data.SQExprConverter,k=y.data.SQExprHierarchyToHierarchyLevelConverter,D=y.data.SQExprUtils,m=y.data.SQHierarchyExprUtils,X=y.data.SQScopedEvalExpr,H=y.visuals.TablixProperties,M=y.explore.contracts.VisualContainer,n=y.explore.contracts.VisualContainerGroup,I=y.explore.util.VisualContainerUtils,p=y.explore.contracts.VisualLink,O=A.contracts.VisualQuery,(e=d=h.ParameterAddingBehavior||(h.ParameterAddingBehavior={}))[e.Default=1]="Default",e[e.AddAsData=2]="AddAsData",e[e.AddAsMetadata=3]="AddAsMetadata",h.createVisualAuthoringOperations=function(e,t,i,r,n,a,o,s,l,u,c,p,h,d,v,g,m,y,f,C,S,b,E,V,x,w,P){return new G(e,t,i,r,n,a,o,s,l,u,c,p,h,d,v,g,m,y,f,C,S,b,E,V,x,w,P)},N.prototype.logSmallMultiplesTelemetry=function(e,t,i,r,n){var a=null==(a=e.config)?void 0:a.singleVisual;!1!=!!a&&r===y.visuals.cartesianRoleNames.rows&&R.supportsSmallMultiplesDataViewMapping(null==i?void 0:i.dataViewMappings)&&(i=null==(r=a.query)?void 0:r.projections)&&i[y.visuals.cartesianRoleNames.rows]&&1===i[y.visuals.cartesianRoleNames.rows].all().length&&this.telemetry.logEvent(y.telemetry.EXSmallMultiplesFirstField,{source:n,targetVisualType:t,visualName:e.name})},N.prototype.updateVisualCalculation=function(e,t,i,r,n){return this.core.updateVisualCalculation(e.config,t,i,r,n)},N.prototype.switchQueryParameter=function(e,t,i,r,n){var a,o=t.config.singleVisual.query,s=o.tryGetFieldExprs(r)[i],l=s.isFieldParameter;if(l)u=null==(a=o.getParameterByFieldIndex(i,r))?void 0:a.expr;else{var u=(u=P.isAggregation(s.expr)?s.expr.arg.getTargetColumnRef(e):u)||s.expr;if(!D.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e,u,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!this.filterGenerator.supportsFilterOutput(t),this.isAnalysisVisual(t)))return!1}return!!u&&(!!this.removeFieldFromRole({role:r,projOptions:{fieldIndex:i,parameter:a}},e,t)&&(!!this.addFieldInRole(e,u,r,t,i,!1,!1,l?d.AddAsData:d.AddAsMetadata)&&(this.isVisualRecommendationAllowed(t)&&null!=n&&n.updateWithRecommendation(t,void 0,e),this.telemetry.logEvent(y.telemetry.EXSwitchQueryParameter,{fromMetadataToData:l,visualType:I.getVisualType(t),visualName:t.name,role:r}),!0)))},N.prototype.addFieldToVisual=function(e,t,i,r,n){if(i){var a,o,s=D.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e,t,!this.filterGenerator.supportsFilterOutput(i),this.isAnalysisVisual(i)),l=s?"FieldParameter":B(t),u=this.contextActivityService.createActivity({name:"UpdateField",visualName:i.name,data:{fieldKinds:[l],operationType:"Add",source:"CheckboxTickedInFieldList"===n?"FieldList":"DraggedToFieldWell"===n?"FieldWell":"Visual"}}),c=(this.core.ensureFiltersArrayIsValid(i.filters),i.config.singleVisual),p=c.query,h=this.visualPluginService.capabilities(c.visualType),r=(s?(a=this.addExpressionToVisual(e,i,t,s),this.isVisualRecommendationAllowed(i)&&a&&null!=r&&r.updateWithRecommendation(i,void 0,e)):a=this.isVisualRecommendationAllowed(i)?null!=(o=null==r?void 0:r.updateWithRecommendation(i,{toAdd:t},e)):this.addHierarchyLevelToExistingHierarchiesInVisual(e,h,i.config,t)||this.addExpressionToVisualWithoutAggregation(e,i,h,t)||this.addExpressionToVisualForcingAggregation(e,i,t)||this.addExpressionToVisual(e,i,t,s),t.getConceptualProperty(e)),r=r&&r.measure&&r.measure.template&&r.measure.template.name;if(a)return void 0===(c=null==(a=c.query)?void 0:a.getRoleNameForExpr(t))&&"CheckboxTickedInFieldList"===n&&(c=this.getTargetRoleAndExpressionsForAdd(e,i,t).targetRole),this.runAddFieldValidation(i,e,t,s,void 0,c),void 0!==n&&(o=I.getVisualType(i),this.telemetry.logEvent(y.telemetry.EXAddField,{source:n,targetVisualType:o,fieldKind:l,drillToDetailsMode:I.hasGroupByItemsInQuery(i),success:!0,quickMeasureTemplateName:r,visualName:i.name}),this.logSmallMultiplesTelemetry(i,o,h,c,n)),u.resolve(),!0;i.config.singleVisual.query=p,void 0!==n&&this.telemetry.logEvent(y.telemetry.EXAddField,{source:n,targetVisualType:I.getVisualType(i),fieldKind:l,drillToDetailsMode:I.hasGroupByItemsInQuery(i),success:!1,quickMeasureTemplateName:r,visualName:i.name}),u.reject()}return!1},N.prototype.addFieldInRole=function(e,t,i,r,n,a,o,s,l){var u;switch(void 0===s&&(s=d.Default),this.core.ensureFiltersArrayIsValid(r.filters),s){case d.Default:u=D.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e,t,!this.filterGenerator.supportsFilterOutput(r),this.isAnalysisVisual(r));break;case d.AddAsData:u=!1;break;case d.AddAsMetadata:u=!0}var c,p,s=u?"FieldParameter":B(t),h=this.contextActivityService.createActivity({name:"UpdateField",visualName:r.name,data:{fieldKinds:[s],operationType:"Add",source:"FieldWell"}}),l=(this.isVisualRecommendationAllowed(r)&&null==i?u?(c=this.addExpressionToVisual(e,r,t,u),null!=l&&l.updateWithRecommendation(r,void 0,e)):c=!(null==l||!l.updateWithRecommendation(r,{toAdd:t},e)):(l=void 0,p=this.getVisualDataRole(r,i),u||this.shouldPreferGroupToAggregate(e,t,u,r,p)||a||(t=this.createExprWithAggregate(t,e,!0,p),l=!0),o={expr:u?t:(a=this.canHierarchyLevelJoinExistingGroup(e,r.config.singleVisual.query,i,t,n),p=this.getTargetRoleAndExpressionsForAdd(e,r,t,i,o),l||a?t:p&&p.expressions),schema:e,targetRole:i,projOptions:{fieldIndex:n}},(c=this.core.add(o,r.config,u))&&(I.getSingleVisualConfig(r).autoSelectVisualType=void 0)),t.getConceptualProperty(e)),a=l&&l.measure&&l.measure.template&&l.measure.template.name;return c?(this.runAddFieldValidation(r,e,t,u,void 0,i),p=I.getVisualType(r),this.telemetry.logEvent(y.telemetry.EXAddField,{source:"DraggedToFieldWell",targetVisualType:p,fieldKind:s,drillToDetailsMode:I.hasGroupByItemsInQuery(r),success:!0,quickMeasureTemplateName:a,visualName:r.name}),n=this.visualPluginService.capabilities(p),this.logSmallMultiplesTelemetry(r,p,n,i,"DraggedToFieldWell"),h.resolve(),!0):(this.telemetry.logEvent(y.telemetry.EXAddField,{source:"DraggedToFieldWell",targetVisualType:I.getVisualType(r),fieldKind:s,drillToDetailsMode:I.hasGroupByItemsInQuery(r),success:!1,quickMeasureTemplateName:a,visualName:r.name}),h.reject(),!1)},N.prototype.resolveParameters=function(e,t,i){var i=this.core.resolveParameters(e,t,i,this.drill,this.sortService,this.setDisplayNameAlias),r=i.queryChange,n=i.aliasChange,a=i.outputFilterChange,o=i.totalAddAttemptCount,s=i.totalAddSuccessCount,l=i.totalRemoveAttemptCount,u=i.totalRemoveSuccessCount,c=i.totalSuccessColumnCount,p=i.totalSuccessDateHierarchyCount,i=i.totalSuccessMeasureCount;return r?(this.notifyVisualContainers([t],void 0,a,e,a?3:1),a=I.getVisualType(t),this.telemetry.logEvent(y.telemetry.EXResolveParameters,{targetVisualType:a,addSuccessTotalCount:s,addAttemptTotalCount:o,addSuccessTotalColumnCount:c,addSuccessTotalDateHierarchyCount:p,addSuccessTotalMeasureCount:i,removeSuccessCount:u,removeAttemptCount:l,visualName:t.name})):n&&this.notifyVisualContainers([t],void 0,!1,e,1),r},N.prototype.setDisplayNameAlias=function(e,t,i,r){var n=e.config.singleVisual,a=n.query,o=n.columnProperties;if(!a)return!1;if(a.getParameterByFieldIndex(t.fieldIndex,i))return!1;var s,l,u,c=a.getQueryRef(i,t);return r?(a=a.defn.select().withName(c))&&P.isNativeVisualCalc(a.expr)?(s=(a=a.expr).name,!!this.updateVisualCalculation(e,t.fieldIndex,i,r,a.expression)&&s!==r):(n.columnProperties||(n.columnProperties=o={}),(l=o[c])||(o[c]=l={}),u=l.displayName,l.displayName=r,l.displayName!==u):o?!!(l=o[c])&&(u=l.displayName,delete l.displayName,void 0!==u):void 0},N.prototype.runAddFieldValidation=function(e,t,i,r,n,a){r?this.notifyVisualContainers([e],"UserAction_EditVisual",!1,t,2):(this.core.runAddFieldValidation(e,t,i,this.drill,this.sortService,this.updateFilterState,n,a),(r=e.config.singleVisual&&e.config.singleVisual.query)&&(r.hasVisualCalcExpressions()||r.defn.select().some((function(e){return null!=e.nativeReferenceName})))&&this.ensureNativeReferenceName(t,e))},N.prototype.expandHierarchy=function(e,t,i,r,n){var a=(t.config.singleVisual.query.tryGetExprs(i)||[]).slice(r,r+n);if(!_.isEmpty(a)){a=a[0];if(P.isHierarchyLevel(a)){var a=a.arg,o=m.expandExpr(e,a);if(_.isArray(o)){var s=o.length;if(n<s){for(var l=t.config.singleVisual.query,u=!1,c=0;c<s;c++)if(!P.equals(l.tryGetExpr(i,r+c),o[c])){var p={expr:o[c],schema:e,targetRole:i,projOptions:{fieldIndex:r+c}};if(!this.core.add(p,t.config,!1))break;this.core.setMatchingFilterToAuto(o[c],t),u=!0}return u&&this.notifyVisualContainers([t]),u}}}}return!1},N.prototype.removeFieldFromAllRoles=function(e,t,i,r){var n=r||x.getSelectedVisualContainers(this.selectionService),a=!1,r=this.tryGetParameterExprs(e,n);if(!_.isEmpty(r))for(var o=0,s=r;o<s.length;o++)var l=s[o],u=l.exprs,l=l.parameter,a=this.removeFieldImpl(u,n,t,i,"FieldParameter",l)||a;a=this.removeFieldImpl(e,n,t,i,B(e))||a;r=m.expandExpr(t,e,!0);return a=_.isArray(r)&&!_.isEmpty(r)?this.removeFieldImpl(r,n,t,i,"HierarchyLevel")||a:a},N.prototype.tryGetParameterExprs=function(e,t){for(var i=[],r=t.length-1;-1<r;r--){var n=t[r].config.singleVisual.query;n&&(n=n.getParameterProjectionExprs(e),i.push.apply(i,n))}return i},N.prototype.removeFieldFromRole=function(e,t,i,r){var n,a,o,s,l;return!!i&&(n=e.role,a=i.config.singleVisual.query,o=(l=e.projOptions).fieldIndex,s=!!(l=l.parameter||a.getParameterByFieldIndex(o,n)),e=__assign(__assign({},e),{projOptions:__assign(__assign({},e.projOptions),{parameter:l}),shouldRemoveParameter:s}),l=void 0,l=s?["FieldParameter"]:[B(a.tryGetExpr(n,o))],this.invokeRemoveOnSelectedVisuals(e,[i],t,r,l))},N.prototype.removeInvalidExpressions=function(e,t,i){var r=t.config.singleVisual;if(!r||!r.query)return!1;for(var n=[],a=r.query.defn.select(),o=0,s=a;o<s.length;o++){var l=s[o].expr;_.isEmpty(l.validate(e,this.aggrOps))||n.push(l)}for(var u=0,c=n;u<c.length;u++){var p=c[u];this.removeFiltersWithExpr(p,t)}return this.removeFieldImpl(n,[t],e,i,"Other"),this.removeInvalidDataBoundProperty(r.vcObjects,e,a),this.removeInvalidDataBoundProperty(r.objects,e,a),!0},N.prototype.removeInvalidDataBoundProperty=function(u,c,p){var e;!u||(e=(function(l){function e(s){var e=u[s];if(!_.isEmpty(e))for(var t=function(e){var t,a=e.properties,o=e.selector;for(t in a){var i=(function(e){var t=a[e],t=v.getDataBoundExprs(t,o,p);if(!_.isEmpty(t))for(var i=0,r=t;i<r.length;i++){var n=r[i];if(null==n.expr||!_.isEmpty(n.expr.validate(c,l)))return{value:function(){C.deleteProperty(u,s,o,e)}}}})(t);if("object"==typeof i)return i}},i=0,r=e;i<r.length;i++){var n=t(r[i]);if("object"==typeof n)return n}}for(var t in u){t=e(t);if("object"==typeof t)return t.value}})(this.aggrOps))&&(e(),this.eventBridge.publishToChannel(g.visualContainerChanged,{affectContainer:function(){return!0}}))},N.prototype.moveField=function(e,t,i,r,n,a,o){var s=o||x.getSelectedVisual(this.selectionService);if(s){var l=s.config.singleVisual.query,o=l.getParameterByFieldIndex(r,t),u=[];if(null!=o)u.push("FieldParameter");else for(var c=0;c<a;c++){var p=l.tryGetExpr(t,r+c);u.push(B(p))}var h=this.contextActivityService.createActivity({name:"UpdateField",visualName:s.name,data:{fieldKinds:u,operationType:"Move",source:"FieldWell"}});if(!o&&t!==i){var d=this.getVisualDataRole(s,i),d=V.getHierarchyReplacementExpressions(s.config,t,r,a,d);if(_.isEmpty(d))return h.reject(),!1;d=d}var v={sourceRole:t,targetRole:i,sourceIndex:r,targetIndex:n,sourceCount:a,replacementExpressions:d,schema:e,allowPartialReplace:!0},g=b.getDrillFilterRemovalInfoList(l,v,1);if(this.core.removeAutoFilterFromContract(s,{projOptions:{fieldIndex:r,parameter:o},role:t,count:a}),this.core.move(v,s.config)){this.core.setDefaultExpandLevel(s,this.visualPluginService,e,i),this.core.ensureValidDrillState(s,g,this.drill),this.core.setDefaultSort(s,e,this.sortService,this.visualPluginService),I.setQueryKeepProjectionOrder(s),this.updateFilterState(e,s,!0,!0,!0);o=s.config.singleVisual.query.tryGetExpr(i,n);if(this.logReportMeasureMoveTelemetry(e,s,t,i,o),d&&0<d.length)for(var m=0,y=d;m<y.length;m++){p=y[m];this.core.setMatchingFilterToAuto(p,s)}v=I.getVisualType(s),g=this.visualPluginService.capabilities(v);return this.logSmallMultiplesTelemetry(s,v,g,i,"DraggedToFieldWell"),h.resolve(),!0}h.reject()}return!1},N.prototype.drillDownLevel=function(e,t,i){if(t){var r=I.getVisualType(t),n=this.telemetry.startEvent(y.telemetry.EXInteractionExpand,{sourceVisualType:r,isInlineHierarchyEnabled:2===i,visualName:t.name}),a=t.config.singleVisual,r=_.isEmpty(e)?[]:[e];if(_.isEmpty(r)&&(e=this.visualPluginService.capabilities(a.visualType),r=b.getDrillableRoles(e)),!_.isEmpty(r))for(var o=0,s=r;o<s.length;o++){var l=s[o];if(l){var u=this.core.changeActiveProjection(l,a,i);if(u)return 2===i&&this.expandCollapse.isEnabled(t,[l])&&(u.length,this.expandCollapse.expandLevel(t,[l],u.length-2,!0)),this.notifyVisualContainers([t],"UserAction_Drill"),void n.resolve()}}n.reject()}},N.prototype.replaceField=function(e,t,i,r,n,a,o){var s=this.getTargetRoleAndExpressionsForAdd(e,n,t,i).expressions,l=this.contextActivityService.createActivity({name:"UpdateField",visualName:n.name,data:{fieldKinds:_.map(jsCommon.ArrayExtensions.ensureArray(s),B),operationType:"Replace",source:"FieldWell"}}),a={sourceRole:i,targetRole:i,sourceIndex:r,targetIndex:r,sourceCount:null!=a?a:1,replacementExpressions:jsCommon.ArrayExtensions.ensureArray(s),schema:e},s={projOptions:{fieldIndex:r,parameter:n.config.singleVisual.query.getParameterByFieldIndex(r,i)},role:i};return this.core.removeAutoFilterFromContract(x.getSelectedVisual(this.selectionService),s),this.core.move(a,n.config)?(this.resetSearchProperties(n),r=D.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e,t,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!this.filterGenerator.supportsFilterOutput(n),this.isAnalysisVisual(n)),this.runAddFieldValidation(n,e,t,r,void 0,i),this.isVisualRecommendationAllowed(n)&&null!=o&&o.updateWithRecommendation(n,void 0,e),l.resolve(),!0):(l.reject(),!1)},N.prototype.drillDown=function(l,e,u,t){var i=I.getVisualType(u),c=this.telemetry.startEvent(y.telemetry.EXInteractionDrill,{sourceVisualType:i,isDrillDown:!0,visualName:u.name}),p=u.config.singleVisual,i=this.runningVisualService.getVisual(u);if(i.clearSelectedDatapoints(),!_.isEmpty(e)&&!_.isEmpty(e[0].dataMap)){u.filters||(u.filters=[]);var h=e[0].dataMap,d=p.query,i=_.isEmpty(t)?[]:[t];if(_.isEmpty(i)&&(e=this.visualPluginService.capabilities(p.visualType),i=b.getDrillableRoles(e)),!_.isEmpty(i))for(var v=this,r=0,n=i;r<n.length;r++){var a=(function(e){var t=d.projections[e],i=t&&t.activeProjectionRefs,t=_.filter(h,(function(e,t){return _.includes(i,t)}));if(!_.isEmpty(t)){var r=d.currentDrillMode(e)||2,n=v.core.changeActiveProjection(e,p,r);if(n){2===r&&v.expandCollapse.isEnabled(u,[e])&&(n.length,r=_.uniq(n),v.expandCollapse.expandLevel(u,[e],r.length-2,!0));for(var a=0,o=t;a<o.length;a++){var s=o[a];v.core.addDrillFilter(l,u.filters,d,i,N.chooseRepetitionSelectorForDrill(s))}n=v.explorationNavigationService.getCurrentSection();return v.filterGenerator.updateCrossFilterOnDrill(n,u),v.notifyVisualContainers([u],"UserAction_Drill"),c.resolve(),{value:!0}}}})(n[r]);if("object"==typeof a)return a.value}c.reject()}return!1},N.chooseRepetitionSelectorForDrill=function(e){if(1===(e=o.ensureArray(e)).length)return e[0];for(var t=0,i=e;t<i.length;t++){var r=i[t],n=n||r;r.key.length>n.key.length&&(n=r)}return n},N.prototype.drillUp=function(e,t){if(t){var i=I.getVisualType(t),r=this.telemetry.startEvent(y.telemetry.EXInteractionDrill,{sourceVisualType:i,isDrillDown:!1,visualName:t.name}),n=t.config.singleVisual,a=n.query,i=_.isEmpty(e)?[]:[e];if(_.isEmpty(i)&&(e=this.visualPluginService.capabilities(t.config.singleVisual.visualType),i=b.getDrillableRoles(e)),!_.isEmpty(i))for(var o=0,s=i;o<s.length;o++){var l,u=s[o],c=this.core.changeActiveProjection(u,n,1);if(!_.isEmpty(c))return l=_.last(c),l=a.defn.select().withName(l).expr,2===(a.currentDrillMode(u)||2)&&this.expandCollapse.isEnabled(t,[u])&&(c=_.uniq(c),this.expandCollapse.collapseLevel(t,[u],c.length-1)),this.core.removeDrillFilter(t.filters,l)&&(u=this.explorationNavigationService.getCurrentSection(),this.filterGenerator.updateCrossFilterOnDrill(u,t)),this.notifyVisualContainers([t],"UserAction_Drill"),void r.resolve()}r.reject()}},N.prototype.setDrillFilterOtherVisualsSetting=function(e){var t=x.getSelectedVisual(this.selectionService);t&&this.setVisualDrillFilterOtherVisualsSetting(t,e)},N.prototype.drillToDetails=function(e,t,i,r,n,a){var o,s=i;do{if(!(o=this.drillToDetailsCore(e,t,s,r,n,a)))return}while(!o.targetQueryHasColumns&&1<s.length&&(s=s.slice(0,-1),!0));return o.targetVisualContainer},N.prototype.drillToDetailsCore=function(e,t,i,r,n,a){var o=!1;if(o=_.some(i)?P.isAggregation(_.head(i))&&1===i.length||_.every(i,(function(e){return P.isMeasure(e)})):o){var o=M.clone(n,this.explorationSerializer),r=(this.addDrillToDetailsFilters(t,o,r),o.config.singleVisual),s={name:e,config:{singleVisual:r},layouts:n.layouts,filters:o.filters};if(r.visualType!==y.visuals.plugins.tableEx.name){e=this.convert(t,s,y.visuals.plugins.tableEx.name);if(!e)return}((r=s.config.singleVisual).vcObjects=r.vcObjects||{}).stylePreset=[{properties:{name:F.text("Default")}}];for(var o=r.objects={},l=(C.setValue(o,H.PropTotalTableExTotals,void 0,F.boolean(!1)),r.query),u=0,c=i;u<c.length;u++){var p=c[u],h=p.getTargetEntity(),h=(P.isAggregation(p)?(this.removeAggregatesAndMeasures(t,s,!1),this.removeTableReferences(s),this.addDetailTableProperties(t,h,s),l.defn=l.defn.addGroupBy(h)):(this.addDetailTableProperties(t,h,s,!0,a),this.removeAggregatesAndMeasures(t,s,!0),this.removeTableReferences(s)),I.getVisualType(n));this.telemetry.logEvent(y.telemetry.EXDrillToDetails,{sourceVisualType:h,targetExprKind:B(p),visualName:n.name})}return{targetVisualContainer:s,targetQueryHasColumns:0<l.defn.select().length}}},N.prototype.isAnalysisVisual=function(e){return e&&e.config&&e.config.singleVisual&&this.pluginOps.isAnalysisVisual(e.config.singleVisual.visualType)},N.prototype.removeAggregatesAndMeasures=function(e,t,n){for(var a=t.config.singleVisual.query,i=0,r=a.defn.select();i<r.length;i++)!(function(t){var e,i,r=t.expr;(D.isMeasure(r)&&!1===n||P.isAggregation(r)&&!0===n)&&(e=a.getRoleNameForExpr(r),i=s.getRole(a.projections,e),i=_.findIndex(i.all(),(function(e){return e.queryRef===t.name})),a.removeAggregate(e,i)),P.isMeasure(r)&&!1===n&&a.removeExpr(r,!1)})(r[i])},N.prototype.removeTableReferences=function(e){for(var t=e.config.singleVisual.query,i=0,r=t.defn.select();i<r.length;i++){var n=r[i];P.isEntity(n.expr)&&t.removeExpr(n.expr,!1)}},N.prototype.addDetailTableProperties=function(e,t,i,r,n){for(var a=i.config.singleVisual.query,o=D.getConceptualEntity(t,e),s=0,l=a.defn.select();s<l.length;s++){var u=l[s].expr,c=u.getTargetEntity();_.isEqual(t,c)||(D.isRelatedOneToOne(e,t,c,0)||D.isRelatedToMany(e,c,t,0)||a.removeExpr(u,!1))}for(var p=0,h=o.properties;p<h.length;p++){var d,v=h[p];v.hidden||1===v.kind&&n||(1===v.kind||v.type.integer||v.type.numeric)&&!r||v.type.dateTime&&v.column&&!_.isEmpty(v.column.variations)||(d=void 0,d=1===v.kind?F.measureRef(t,v.name):F.columnRef(t,v.name),a.defn.selectNameOf(d)||this.addFieldToVisual(e,d,i))}},N.prototype.setAggregate=function(e,t,i,r,n,a){var o,s=null==(s=I.getVisualQuery(n))?void 0:s.tryGetExpr(t,i),s=null==(s=null==s?void 0:s.getMetadata(e))?void 0:s.type,s=this.contextActivityService.createActivity({name:"ChangeAggregation",visualName:n.name,data:{aggregation:r,dataType:s?y.ExtendedTypeNames[s.extendedType]:void 0}}),l={projOptions:{fieldIndex:i},role:t};return this.core.removeAutoFilterFromContract(x.getSelectedVisual(this.selectionService),l),this.isVisualRecommendationAllowed(n)?o=null!=a.updateWithRecommendation(n,{toUpdate:{role:t,index:i,aggregateToUse:r}},e):(o=this.core.setAggregate({role:t,index:i,newAggregate:r,schema:e},n.config))&&(this.core.setDefaultSort(n,e,this.sortService,this.visualPluginService),I.setQueryKeepProjectionOrder(n)),o?(this.notifyVisualContainers([n]),s.resolve()):s.reject(),o},N.prototype.removeAggregate=function(e,t,i,r,n){var a,o=null==(o=I.getVisualQuery(r))?void 0:o.tryGetExpr(t,i),o=null==(o=null==o?void 0:o.getMetadata(e))?void 0:o.type,o=this.contextActivityService.createActivity({name:"ChangeAggregation",visualName:r.name,data:{aggregation:void 0,dataType:o?y.ExtendedTypeNames[o.extendedType]:void 0}}),s={projOptions:{fieldIndex:i},role:t};return this.core.removeAutoFilterFromContract(x.getSelectedVisual(this.selectionService),s),this.isVisualRecommendationAllowed(r)?a=null!=n.updateWithRecommendation(r,{toUpdate:{role:t,index:i,aggregateToUse:void 0}},e):(a=this.core.removeAggregate({role:t,index:i,schema:e},r.config))&&(this.core.setDefaultSort(r,e,this.sortService,this.visualPluginService),I.setQueryKeepProjectionOrder(r)),a?(this.notifyVisualContainers([r]),o.resolve()):o.reject(),a},N.prototype.setPercentOfGrandTotal=function(e,t,i,r){var n=this.contextActivityService.createActivity({name:"ChangeShowFieldAs",visualName:r.name,data:{operationType:"SetPercentOfGT"}});return this.core.setPercentOfGrandTotal({role:t,index:i,schema:e},r.config)?(this.core.setDefaultSort(r,e,this.sortService,this.visualPluginService),this.core.ensureValidDrillMode(r,this.drill),this.notifyVisualContainers([r]),n.resolve(),!0):(n.reject(),!1)},N.prototype.removePercentOfGrandTotal=function(e,t,i,r){var n=this.contextActivityService.createActivity({name:"ChangeShowFieldAs",visualName:r.name,data:{operationType:"RemovePercentOfGT"}});return this.core.removePercentOfGrandTotal({role:t,index:i,schema:e},r.config)?(this.core.setDefaultSort(r,e,this.sortService,this.visualPluginService),this.notifyVisualContainers([r]),n.resolve(),!0):(n.reject(),!1)},N.prototype.setPercentOfRoleTotal=function(e,t,i,r,n){var a=this.contextActivityService.createActivity({name:"ChangeShowFieldAs",visualName:n.name,data:{operationType:"SetPercentOfRT"}});return this.core.setPercentOfRoleTotal({roleRefs:t,role:i,index:r,schema:e},n.config)?(this.core.setDefaultSort(n,e,this.sortService,this.visualPluginService),this.core.ensureValidDrillMode(n,this.drill),this.notifyVisualContainers([n]),a.resolve(),!0):(a.reject(),!1)},N.prototype.removePercentOfRoleTotal=function(e,t,i,r){var n=this.contextActivityService.createActivity({name:"ChangeShowFieldAs",visualName:r.name,data:{operationType:"RemovePercentOfGT"}});return this.core.removePercentOfRoleTotal({role:t,index:i,schema:e},r.config)?(this.core.setDefaultSort(r,e,this.sortService,this.visualPluginService),this.notifyVisualContainers([r]),n.resolve(),!0):(n.reject(),!1)},N.prototype.setVariation=function(e,t,i,r,n,a){a=a||1;var o=P.isHierarchy(i),s=this.contextActivityService.createActivity({name:"ChangeShowFieldAs",visualName:t.name,data:{operationType:o?"UseVariations":"RemoveVariations"}});if(n<0)return s.reject(),!1;for(var l=[],u=0;u<a;u++)if(l[u]=t.config.singleVisual.query.tryGetExpr(r,n+u),!l[u])return s.reject(),!1;var c=[i];if(o&&!(c=k.convert(i,e)))return s.reject(),!1;o=this.getVisualDataRole(t,r),i=V.getHierarchyReplacementExpressions(t.config,r,n,a,o,c);if(_.isEmpty(i))return s.reject(),!1;var o=i,c={sourceRole:r,targetRole:r,sourceIndex:n,targetIndex:n,sourceCount:l.length,replacementExpressions:o,schema:e,allowPartialReplace:!0},i={count:l.length,projOptions:{fieldIndex:n},role:r},i=b.getDrillFilterRemovalInfoList(t.config.singleVisual.query,i,0),p={count:a,projOptions:{fieldIndex:n},role:r},p=(this.core.removeAutoFilterFromContract(x.getSelectedVisual(this.selectionService),p),this.core.move(c,t.config));if(p&&(this.core.setDefaultExpandLevel(t,this.visualPluginService,e,r),this.core.ensureValidDrillState(t,i,this.drill),this.core.setDefaultSort(t,e,this.sortService,this.visualPluginService),I.setQueryKeepProjectionOrder(t),this.notifyVisualContainers([t]),o&&0<o.length))for(var h=0,d=o;h<d.length;h++){var v=d[h];this.core.setMatchingFilterToAuto(v,t)}return p?s.resolve():s.reject(),p},N.prototype.toggleShowAll=function(e,t){t&&(this.core.toggleShowAll(e,t.config),I.setQueryKeepProjectionOrder(t),this.notifyVisualContainers([t]))},N.prototype.createVisualContainerConfig=function(e,t,i){return this.createVisualContainerConfigCore(t,e,i)},Object.defineProperty(N.prototype,"featureSwitches",{get:function(){return this.featureSwitchService.featureSwitches},enumerable:!1,configurable:!0}),N.prototype.addDrillToDetailsFilters=function(e,t,i){if(!_.isEmpty(i)&&i[0]&&!_.isEmpty(i[0].dataMap)){var r=I.getVisualQuery(t);if(r){var n=[];if(r.projections)for(var a in r.projections)_.isEmpty(r.projections[a].activeProjectionRefs)||n.push(r.projections[a].activeProjectionRefs);var o,s=i[0].dataMap;for(o in t.filters=t.filters||[],s){var l=_.find(n,(function(e){return _.includes(e,o)}));this.core.addDrillToDetailsFilter(e,t.filters,r,l||[o],N.chooseRepetitionSelectorForDrill(s[o]))}}}},N.prototype.findCompatibleRole=function(e,t,i,r){var t=t.config.singleVisual,n=t.query||new O(y.data.SemanticQuery.create(),{},[]),t=this.visualPluginService.capabilities(t.visualType),n=n&&n.projections;if(t&&n)return(t=y.visualCapabilitiesHelperModuleFactory().create(t,this.geotaggingAnalyzerService))&&t.findCompatibleRole({queryProjections:n,schema:e,expr:i,roleToExprMap:new A.utils.SQExprToRoleDictionary(h.HierarchyUtils.hierarchyLevelComparer),preferDrillableRoles:!1,isFieldParameter:r})},N.prototype.getMaxNumberOfExpressionsAllowedInRole=function(e,t,i){var t=t.config.singleVisual,r=t.query||new O(y.data.SemanticQuery.create(),{},[]),t=this.visualPluginService.capabilities(t.visualType),n=r&&r.projections;if(t&&n){n=y.visualCapabilitiesHelperModuleFactory().create(t,this.geotaggingAnalyzerService),t=b.getDrillableRoles(t);if(_.includes(t,i))return Number.MAX_VALUE;t=n.getNumberRangesForRoles(r)[i];if(t&&t.max)return t.max}return 0},N.prototype.getTargetRoleAndExpressionsForAdd=function(e,t,i,r,n){var a,o=i;return m.isHierarchyOrVariation(e,i)&&!this.shouldUseOriginalColumn(t,e,i,!1,r)&&(o=m.expandExpr(e,i,n),_.isArray(o)&&(n=o,r||(a=this.findCompatibleRole(e,t,n[0],!1))&&(r=a.name),r&&(a=this.getMaxNumberOfExpressionsAllowedInRole(e,t,r))!==Number.MAX_VALUE&&(o=1===a&&P.isColumn(i)?i:P.isHierarchy(i)||P.isColumn(i)?n.slice(0,a):n.slice(n.length-a,n.length)))),{targetRole:r,expressions:o}},N.prototype.shouldUseOriginalColumn=function(e,t,i,r,n){if(n||(r=this.findCompatibleRole(t,e,i,r))&&(n=r.name),n){r=this.getVisualDataRole(e,n);if(r){e=i.getConceptualProperty(t);if(e&&e.column&&(e.type===y.ValueType.fromExtendedType(518)||e.type===y.ValueType.fromExtendedType(519))&&r.preferDateColumn)return!0}}return!1},N.prototype.addExpressionToVisualWithoutAggregation=function(e,t,i,r){var n=i&&y.ScriptResultUtil.findScriptResultMapping(i.dataViewMappings),a=this.getTargetRoleAndExpressionsForAdd(e,t,r),i=(a.targetRole&&i.dataRoles[a.targetRole]!==y.VisualDataRoleKind.Measure||(a.expressions instanceof Array&&(a.expressions=r),n||this.shouldPreferGroupToAggregate(e,r,!1,t)||(a.expressions=this.createExprWithAggregate(a.expressions,e,!1))),{expr:a.expressions,schema:e,targetRole:a.targetRole});return this.core.add(i,t.config,!1)},N.prototype.addExpressionToVisualForcingAggregation=function(e,t,i){i=this.createExprWithAggregate(i,e,!0);return this.core.add({expr:i,schema:e},t.config,!1)},N.prototype.addExpressionToVisual=function(e,t,i,r){return this.core.add({expr:i,schema:e},t.config,r)},N.prototype.createVisualContainerConfigCore=function(e,t,i){function r(e){return e instanceof Array}var n,a,o=e.expr,s=(n=r(o=!e.allowAggregate||r(o)||this.shouldPreferGroupToAggregate(t,o,!1)?o:this.createExprWithAggregate(o,t,!1))?o[0]:o,this.featureSwitchService.featureSwitches.onObject&&this.settingsService.getSuggestVisualByDefault()?null==e.visualType:void 0);return s&&null!=n?(a={name:"dummyContainer",config:{singleVisual:{visualType:void 0,autoSelectVisualType:!0}}},null!=i&&i.updateWithRecommendation(a,{toAdd:n},t),a.config):(i=e.visualType||U(n,t,this.geotaggingAnalyzerService,this.featureSwitches),a=e.inFilterVisualContainer,this.core.create({expr:o,visualType:i,schema:t,autoSelectVisualType:s,inFilterVisualContainer:a}))},N.prototype.addVisualContainerImageFromData=function(e,t,i){i=this.resourceRegistration.add(i,1,r.Image,{content:"data:image/png;base64,"+t});this.addVisualContainerImage(e,i)},N.prototype.addVisualContainerImage=function(e,t){var t={singleVisual:{visualType:"image",objects:{general:[{properties:{imageUrl:t}}]}}},i=y.Prototype.inherit(e),r=this.formFactorProvider.getCurrentLayout();i.position=N.getPositionForAddedVisual(e.exploreCanvas,r,e.position),this.createVisualFromConfig(i,t,void 0,"InsertVisualButton")},N.prototype.addVisualContainerBasicShapeVisual=function(e,t){var i=y.Prototype.inherit(e),r=this.formFactorProvider.getCurrentLayout(),r=(i.position=N.getPositionForAddedVisual(e.exploreCanvas,r,e.position),{singleVisual:{visualType:u.basicShape.name,objects:{general:[{properties:{shapeType:F.text(t)}}]}}});this.createVisualFromConfig(i,r,void 0,"InsertVisualButton")},N.prototype.addVisualContainerShapeVisual=function(e,t){t.shapeType;var i=y.Prototype.inherit(e),r=this.formFactorProvider.getCurrentLayout(),e=(i.position=N.getPositionForAddedVisual(e.exploreCanvas,r,e.position),{singleVisual:{visualType:u.shape.name,objects:{shape:[{properties:{tileShape:F.text(t.shapeType)}}],rotation:[{properties:{shapeAngle:F.integer(null!=(r=t.shapeRotation)?r:0)}}]}}});this.createVisualFromConfig(i,e,void 0,"InsertVisualButton")},N.prototype.addVisualContainerActionButtonVisual=function(e,t){var i=y.Prototype.inherit(e),r=this.formFactorProvider.getCurrentLayout(),r=(i.position=N.getPositionForAddedVisual(e.exploreCanvas,r,e.position),{icon:[{properties:{shapeType:F.text(t)},selector:{id:"default"}}]}),n={properties:{show:F.boolean(!0)}};switch(t){case a.back:n.properties.type=F.text(p.Back);break;case a.qna:n.properties.type=F.text(p.Qna);break;case a.bookmarks:n.properties.type=F.text(p.Bookmark);break;default:n=void 0}e={singleVisual:{visualType:u.actionButton.name,objects:r}};n&&(e.singleVisual.vcObjects={},e.singleVisual.vcObjects.visualLink=[n]),this.createVisualFromConfig(i,e,void 0,"InsertVisualButton")},N.prototype.addVisualContainerNavigatorVisual=function(e,t){var i=this.formFactorProvider.getCurrentLayout(),r=(e.position=N.getPositionForAddedVisual(e.exploreCanvas,i,e.position),{singleVisual:{visualType:void 0}});switch(t){case"page":r.singleVisual.visualType=u.pageNavigator.name;break;case"bookmark":r.singleVisual.visualType=u.bookmarkNavigator.name}this.createVisualFromConfig(e,r,void 0,"InsertVisualButton")},N.prototype.applyConfigOptions=function(e,t){return e.visualLink&&(t.singleVisual.vcObjects=t.singleVisual.vcObjects||{},t.singleVisual.vcObjects.visualLink=[e.visualLink]),t},N.prototype.addVisualContainer=function(e,t,i,r,n,a){var o=this.formFactorProvider.getCurrentLayout(),o=(a=N.getPositionForAddedVisual(r,o,a),t.expr instanceof Array,t.expr=m.expandExpr(e,t.expr),this.createVisualContainerConfig(e,t,n));if(o)return this.createVisualFromConfig({sections:i,exploreCanvas:r,position:a,postProcessing:t.postProcessing,selectedVisualContainers:t.selectedVisualContainers},o)},N.prototype.addEmptyVisualContainer=function(e,t,i,r,n,a){var o=this.formFactorProvider.getCurrentLayout(),o=(r=N.getPositionForAddedVisual(t,o,r),this.featureSwitchService.featureSwitches.onObject&&this.settingsService.getSuggestVisualByDefault()?null==i:void 0),i={singleVisual:{visualType:null!=i?i:y.visuals.plugins.columnChart.name}};return o&&(i.singleVisual.autoSelectVisualType=!0),this.createVisualFromConfig({sections:e,exploreCanvas:t,position:r,postProcessing:a,selectedVisualContainers:n},i)},N.prototype.addVisualContainerFromConfig=function(e,t,i,r,n,a){return n=n||N.getPositionForAddedVisual(r,null),this.createVisualFromConfig({sections:i,exploreCanvas:r,position:n,select:a},e,t,void 0,!1)},N.prototype.groupVisualContainers=function(e,t){for(var i=this,r=e.contract.visualContainerGroups,n=1,a=I.getVisualContainerGroups(r),o=this.formFactorProvider.getCurrentLayout(),s=e.contract,s=_.isEmpty(s.visualContainerGroups)?s.visualContainers:s.visualContainerGroups,s=N.getDefaultVisualContainerPosition(s,o),o=this.formFactorProvider.getCurrentLayout();_.some(a,(function(e){return A.contracts.isVisualContainerGroup(e)&&e.displayName===i.localizationService.get("Group")+" "+n}));)n++;s={name:I.uniqueName(r),displayName:this.localizationService.get("Group")+" "+n,groupMode:0,layouts:jsCommon.ArrayExtensions.extendWithId([{id:o,position:s}]),children:t},e.contract.visualContainerGroups=y.ItemGroupingManager.group(s,r),t=h.CanvasVisualsUtility.findCanvasItemViewModels(e.visualContainerGroups,s.children),r=A.viewModels.ViewModelFactory.convertVisualContainerGroup(s,t,o);return r&&(e.visualContainerGroups=y.ItemGroupingManager.group(r,e.visualContainerGroups),h.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(e.visualContainerGroups,e.contract.visualContainerGroups)),x.selectCanvasItem(s,this.selectionService),r},N.prototype.ungroupVisualContainers=function(e,t){e.contract.visualContainerGroups=y.ItemGroupingManager.ungroup(t,e.contract.visualContainerGroups);var i=y.ItemGroupingManager.find(t.name,e.visualContainerGroups);if(A.viewModels.isVisualContainerGroup(i))return e.visualContainerGroups=y.ItemGroupingManager.ungroup(i,e.visualContainerGroups),h.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(e.visualContainerGroups,e.contract.visualContainerGroups),x.unselectCanvasItem(t,this.selectionService),i},N.prototype.moveCanvasItemsInTree=function(e,t,i,r,n){void 0===n&&(n=!1),e.contract.visualContainerGroups=y.ItemGroupingManager.move(t,i,e.contract.visualContainerGroups,r);var a=h.CanvasVisualsUtility.findCanvasItemViewModels(e.visualContainerGroups,t),o=y.ItemGroupingManager.find(i.name,e.visualContainerGroups);return e.visualContainerGroups=y.ItemGroupingManager.move(a,o,e.visualContainerGroups,r),h.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(e.visualContainerGroups,e.contract.visualContainerGroups),n?(i.parentGroup,i.parentGroup&&((o=y.ItemGroupingManager.find(i.parentGroup.name,e.contract.visualContainerGroups))?x.selectCanvasItem(o,this.selectionService):this.selectionService.clearSelection())):x.selectCanvasItem(t[0],this.selectionService),a},N.prototype.updateContainerListOrders=function(e,t,i){for(var r=this.formFactorProvider.getCurrentLayout(),n=[],a=[],o=0,s=e;o<s.length;o++){var l=s[o],u=t[l.name];null!=u&&(u=Math.floor(u))!==l.layouts.withId(r).position[i]&&("z"===i?this.setZIndex(l,u):this.setTabOrder(l,u),(A.contracts.isVisualContainer(l)?n:a).push(l))}_.isEmpty(n)||this.notifyVisualContainers(n),_.isEmpty(a)||this.notifyVisualContainerGroups(a)},N.prototype.createVisualFilters=function(e,t,i,r){for(var e=A.viewModels.ViewModelFactory.createVisualFilters(e,t,r,this.displayNameService,this.visualPluginService,this.pluginOps,this.filterGenerator,this.aggrOps,this.localizationService),n=0,a=e;n<a.length;n++){var o=a[n];o.updateFilterProperties(r,this.visualPluginService,this.aggrOps),!o.canVisualize()||o.isInvalid()||this.createFilterVisualContainerConfig(o.contract,i,r,!1)}return e},N.prototype.moveFilter=function(e,t,i,r){var n=A.FilterUtils.getFiltersContainer(t,this.selectionService,this.explorationNavigationService);return this.setFilterSortType(e,t,3),this.moveFilterContainer(n.filters,r,i),!0},N.prototype.setFilterSortType=function(e,t,i){var r=A.FilterUtils.getFiltersContainer(t,this.selectionService,this.explorationNavigationService);return r.filterSortOrder!==i&&(this.telemetry.logEvent(y.telemetry.EXToggleFilterCardSort,{sortType:h.getTelemetryFilterCardSortType(i)}),3===i?(this.sortFiltersByCurrentSortType(e,r,t),this.updateFilterOrdinal(r.filters)):r.filters&&r.filters.forEach((function(e){null!=e&&(e.ordinal=void 0)})),r.filterSortOrder=i),!0},N.prototype.sortFiltersByCurrentSortType=function(i,e,r){var n,a,o=this,t=(void 0===e.filterSortOrder&&(e.filterSortOrder=1),e.filters.filter((function(e){return A.FilterUtils.getFilterCapabilities(e).canSort}))),s=e.filters.filter((function(e){return!A.FilterUtils.getFilterCapabilities(e).canSort}));1===e.filterSortOrder||2===e.filterSortOrder?(n=x.getSelectedVisual(this.selectionService),a=I.getVisualCapabilities(n,this.visualPluginService),t.sort((function(e,t){e=e.displayName||o.getDisplayName(e,i,a,r,n&&n.config.singleVisual)||"",t=t.displayName||o.getDisplayName(t,i,a,r,n&&n.config.singleVisual)||"";return e.localeCompare(t)})),2===e.filterSortOrder&&t.reverse()):3===e.filterSortOrder&&t.sort((function(e,t){return e.ordinal-t.ordinal})),e.filters=t.concat(s)},N.prototype.moveFilterContainer=function(e,t,i){t<i&&(i-=1);var r=e[t];e.splice(t,1),e.splice(i,0,r),this.updateFilterOrdinal(e)},N.prototype.updateFilterOrdinal=function(i){i.forEach((function(e,t){null!=e&&(e.ordinal=t,null==e.name&&(e.name=A.FilterUtils.getNextFilterName(i)))}))},N.prototype.getDisplayName=function(e,t,i,r,n){var a,o,s;return e.type===c.Include||e.type===c.Exclude?(a=new A.services.IncludeExcludeSQExprVisitor(t,this.displayNameService),A.FilterUtils.getDisplayNameForIncludeExcludeFilters(this.localizationService,e.type,a.dataPoints.length)):e.type===c.Passthrough?e.restatement:(a=e.expression&&T.asFieldPattern(e.expression),s=o=void 0,e.expression&&n&&(o=n.query&&n.query.defn.selectNameOf(e.expression),s=n.columnProperties),this.displayNameService.getDisplayName(e.expression,t,i,o,0===r?s:void 0,{includeVariationSource:!0})||(a?l.getFieldExprName(a):void 0))},N.prototype.addFilter=function(e,t,i,r,n,a){n&&i.scopeType;var o,s,l,u,c,p=x.getSelectedVisual(this.selectionService);if(A.FilterUtils.canAdd(p,t,e,i,n,this.pluginOps))return this.core.ensureFiltersArrayIsValid(i.container.filters),c=n?5:1,o=A.FilterUtils.getDefaultFilterType(t,e,c),s={name:A.FilterUtils.getNextFilterName(i.container.filters),expression:t,type:o,howCreated:c},u=_.isEmpty(A.FilterUtils.validate(s,e,this.aggrOps)),s.expanded=A.FilterUtils.canExpandManually(c,!1,t,u),y.data.SQExprUtils.isMeasure(t)||this.createFilterVisualContainerConfig(s,r,e),void 0!==a&&i.container.filterSortOrder,A.FilterUtils.add(i.container,s),3===i.container.filterSortOrder&&this.moveFilterContainer(i.container.filters,i.container.filters.length-1,a),c={filter:s,changeType:1,scope:i,changeFilterActivity:l=this.featureSwitchService.featureSwitches.certifiedTelemetryUserEvents?A.FilterUtils.createChangeFilterActivity(this.contextActivityService,"Add Filter"):l},A.FilterUtils.notifyFilterContainerChangedByUser(this.eventBridge,c),l&&l.resolve(),n?(A.PodUtils.isPodEnabled(s,i),z(this.telemetry,"Add",i.container,void 0),u=this.explorationNavigationService.getCurrentExploration(),r=i.container,null!=u&&null!=r&&(a=A.FilterUtils.determineIsLinkedAsAggregation(s,e,this.aggrOps),c={filterName:s.name,type:0,isCausedByCode:!1,fieldExpr:s.expression,asAggregation:a,isLegacySingleSelection:!1},A.PodUtils.addParameter(u,r.name,s.name,s.expression,c.asAggregation,!1,A.PodUtils.determineType(r,this.featureSwitchService.featureSwitches.onObject)),this.eventBridge.publishToChannel(g.podParameterChanged,c))):D.isMeasure(t)&&this.telemetry.logEvent(y.telemetry.EXAddFilter,{filterType:W(o),filterScopeType:Q(i.scopeType),fieldKind:B(t),drillToDetailsMode:I.hasGroupByItemsInQuery(p),viewMode:h.getTelemetryViewMode(this.viewModeState.getMode())}),s.name},N.prototype.addFilterContainers=function(e,t){this.core.ensureFiltersArrayIsValid(e);for(var i=0,r=e;i<r.length;i++){var n=r[i],a=(A.FilterUtils.add(t.container,n),void 0),n={filter:n,changeType:1,scope:t,changeFilterActivity:a=this.featureSwitchService.featureSwitches.certifiedTelemetryUserEvents?A.FilterUtils.createChangeFilterActivity(this.contextActivityService,"Add Filter"):a};A.FilterUtils.notifyFilterContainerChangedByUser(this.eventBridge,n),a&&a.resolve()}},N.prototype.removeFilter=function(e,t,i,r){return this.removeFilterImpl(e,t,i,r)},N.prototype.toggleSlicerVisualSearch=function(e,t,i){e.config,e.config.singleVisual;var i=h.VisualContainerUtils.getVisualCapabilities(e,i),r=this.filterGenerator.tryGetSelfFilterEnabledProperty(i);if(!r)return!1;var e=e.config.singleVisual,n=(e.objects||(e.objects={}),y.data.DataViewObjectDefinitions.getValue(e.objects,r,null));return n&&n.value?(y.data.DataViewObjectDefinitions.deleteProperty(e.objects,r.objectName,null,r.propertyName),(n=t.tryGetSelfFilterProperty(i))&&y.data.DataViewObjectDefinitions.deleteProperty(e.objects,n.objectName,null,n.propertyName)):y.data.DataViewObjectDefinitions.setValue(e.objects,r,null,y.data.SQExprBuilder.boolean(!0)),!0},N.prototype.assignSyncGroup=function(e,t){e.config.singleVisual.syncGroup=__assign({},t),e.config.singleVisual.conversionSourceContext=void 0},N.prototype.clearSyncGroup=function(e){e.config.singleVisual.syncGroup=void 0,e.config.singleVisual.conversionSourceContext=void 0},N.prototype.enableSearchInFilterCard=function(e,t){var i=u.slicer.capabilities,i=this.filterGenerator.tryGetSelfFilterEnabledProperty(i),r=y.visuals.visualStyles.create().colorPalette,n=y.visuals.slicerProps.searchBox,a=this.featureSwitchService.featureSwitches.paneColorRefresh||this.explorationCapabilities.getCapabilities().showFluentDesign,o=a?E.FilterCardSearchBoxBorderColor:r.foregroundNeutralDark.value,a=a?E.FilterCardSearchBoxBackgroundColor:r.foregroundNeutralSecondary.value;this.ensureObjectDefinitionProperty(e,t,i,null,y.data.SQExprBuilder.boolean(!0)),this.ensureObjectDefinitionProperty(e,t,n.borderColor,null,{solid:{color:y.data.SQExprBuilder.text(o)}}),this.featureSwitches.outlineDropdownToCheckboxes?this.ensureObjectDefinitionProperty(e,t,n.outlineStyle,null,y.data.SQExprBuilder.integer(0)):this.ensureObjectDefinitionProperty(e,t,n.outline,null,y.data.SQExprBuilder.text(y.visuals.outline.none)),this.ensureObjectDefinitionProperty(e,t,n.background,null,{solid:{color:y.data.SQExprBuilder.text(a)}})},N.prototype.createFilterVisualContainerConfig=function(e,t,i,r){void 0===r&&(r=!0),e.expression;var n,a,o,s,l,u,c,p,h,d,v,g,m=e.expression;P.isTransformOutputRoleRef(m)||(v=D.discourageAggregation(m,i),g=(n=T.asFieldPattern(m)).column||n.groupingColumn||n.hierarchyLevel,t={expr:m,dataSources:t,allowAggregate:!1,visualType:y.visuals.plugins.filterSlicer.name,inFilterVisualContainer:!0},D.isMeasure(m)||(r=!r||null==(r=e.config)?void 0:r.singleVisual.objects,(t=this.createVisualContainerConfigCore(t,i))&&((a=t.singleVisual.objects)||(t.singleVisual.objects=a={}),p=!(d=5===e.howCreated&&!e.isTransient),c=y.visuals.slicerProps.selection.selectAllCheckboxEnabled,h=y.visuals.slicerProps.selection.singleSelect,l=y.visuals.slicerProps.header.show,u=y.visuals.slicerProps.data.mode,o=y.visuals.slicerProps.general.filter,s=y.visuals.slicerProps.data.isInvertedSelectionMode,this.ensureObjectDefinitionProperty(a,r,u,null,F.text(y.visuals.slicerMode.basic)),this.ensureObjectDefinitionProperty(a,r,c,null,F.boolean(p)),this.ensureObjectDefinitionProperty(a,r,h,null,F.boolean(d)),this.ensureObjectDefinitionProperty(a,r,l,null,F.boolean(!1)),this.enableSearchInFilterCard(a,r),u=this.featureSwitchService.featureSwitches.paneColorRefresh||this.explorationCapabilities.getCapabilities().showFluentDesign,c=y.visuals.visualStyles.create().colorPalette,p=y.visuals.slicerProps.items.textSize,h=y.visuals.slicerProps.items.fontColor,d=u?E.FilterCardFontColor:c.foregroundLight.value,this.ensureObjectDefinitionProperty(a,r,p,null,F.integer(f.smallFontSizeInPoint)),this.ensureObjectDefinitionProperty(a,r,h,null,{solid:{color:y.data.SQExprBuilder.text(d)}}),!v&&g&&(l=F.entity(g.schema,g.entity,g.entityVar),u=F.aggregate(l,2),c=y.visuals.slicerProps.general.count,p=t.singleVisual.query.getRoleNameForExpr(m),h={data:[S.fromRoles([p])]},this.ensureObjectDefinitionProperty(a,r,c,h,u)),d=0===e.howCreated&&!w.isDefaultFilter(e.filter),this.core.ensureDefaultFilterApplied(i,t.singleVisual,d)&&null==e.filter&&(v=n.column||n.groupingColumn?m.getKeyColumns(i):[m],e.filter=w.getDefaultValueFilter(v)),e.filter&&this.ensureObjectDefinitionProperty(a,r,o,null,e.filter),null!=(g=C.getValue(e.objects,{objectName:"general",propertyName:"isInvertedSelectionMode"},void 0))&&this.ensureObjectDefinitionProperty(a,r,s,null,g),e.config=t)))},N.prototype.ensureObjectDefinitionProperty=function(e,t,i,r,n){t=t?C.getValue(t,i,r):void 0;C.setValue(e,i,r,t||n)},N.prototype.notifyVisualContainers=function(e,t,i,r,n){var a=this,o=(void 0===t&&(t="UserAction_EditVisual"),this.explorationNavigationService.getCurrentSection()),s=_.map(e,(function(e){return i?I.filterAffects(e,o,a.visualRelationshipService,r):I.contractEqualityComparator(e)}));this.eventBridge.publishToChannel(g.visualContainerChanged,{affectContainer:function(t){return _.some(s,(function(e){return e(t)}))},sourceLabelKey:t,visualContainerChangeType:n})},N.prototype.notifyVisualContainerGroups=function(t){this.eventBridge.publishToChannel(g.visualContainerGroupChanged,{affectContainer:function(e){return _.includes(t,e)}})},N.prototype.convert=function(e,t,i,r,n,a,o){var s=I.getVisualType(t),l=!!I.isVisualTypeAutoSelect(t),u=null==i,c=this.telemetry.startEvent(y.telemetry.EXInteractionVisualConversion,{sourceVisualType:s,targetVisualType:i,visualName:t.name}),p=l&&s===i||!l&&u?this.contextActivityService.createActivity({name:"ChangeAutoVisual",visualName:t.name,data:{initialAutoVisualValue:l}}):this.contextActivityService.createActivity({name:"ChangeVisualType",visualName:t.name,data:{targetVisualType:i,sourceVisualType:s}});if(l&&u||!l&&!u&&s===i)return c.resolve(),p.resolve(),!1;if(l&&!u&&s===i)return t.config.singleVisual.autoSelectVisualType=void 0,c.resolve(),p.resolve(),this.eventBridge.publishToChannel(g.visualTypeChanged),!0;a&&(t.postProcessing=a({outputVisualContainer:t,selectedVisualContainers:n})),this.visualAuthoringCustomizeOperations.requiresCustomizeConvert(t)&&this.visualAuthoringCustomizeOperations.customizeConvert(t),null!=i&&this.customizeConvertTo(t,i);l=t.config.singleVisual.query;if(u||(a=this.visualPluginService.capabilities(i),l&&_.isEmpty(a.dataRoles)&&(l=t.config.singleVisual.query=void 0)),l){if(!u&&!o){this.resetSearchProperties(t);n=A.contracts.SingleVisualConfig.clone(t.config.singleVisual),a=this.core.convert({schema:e,source:n,target:i});if(!a)return p.reject(),c.reject();t.config.singleVisual=n,this.core.ensureFiltersArrayIsValid(t.filters),c.resolve(),p.resolve();var l=this.visualPluginService.capabilities(s),n=this.filterGenerator.tryGetFilterPropertyIdentifier(l),l=(n||(l=this.visualPluginService.capabilities(i),n=this.filterGenerator.tryGetFilterPropertyIdentifier(l)),this.core.ensureValidDrillMode(t,this.drill),this.ensurePercentRoleTotal(t,i),this.updateFilterState(e,t,!1,!0,!0,n),t.filters);return _.isEmpty(l)||A.FilterUtils.supportsVisualFilters(t,this.pluginOps)||(t.filters=[]),this.removeUnsupportedDataBoundProperties(t,i),this.core.setDefaultSort(t,e,this.sortService,this.visualPluginService),_.remove(l,(function(e){return null==e||0===e.howCreated&&void 0===e.filter})),t.config.singleVisual.autoSelectVisualType=void 0,this.eventBridge.publishToChannel(g.visualTypeChanged),a}null!=(i=null==r?void 0:r.updateWithRecommendation(t,o?{visualType:i}:void 0,e))&&(t.config.singleVisual.autoSelectVisualType=!0)}else u&&(i=s,t.config.singleVisual.autoSelectVisualType=!0);return t.config.singleVisual.visualType=i,c.resolve(),p.resolve(),this.notifyVisualContainers([t]),this.eventBridge.publishToChannel(g.visualTypeChanged),!0},N.prototype.setOrderBy=function(e,t){var i=e.config.singleVisual;i.query.orderBy(t),i.hasDefaultSort=_.isEmpty(t),this.notifyVisualContainers([e],"UserAction_Sorting")},N.prototype.removeOrderBy=function(e,t,i){for(var r=0,n=t;r<n.length;r++){var a=n[r];e.config.singleVisual.query.removeOrderBy(a)}this.core.setDefaultSort(e,i,this.sortService,this.visualPluginService),this.notifyVisualContainers([e])},N.prototype.deleteVisualRelationships=function(e,t){_.remove(e.relationships,(function(e){return e.source===t||e.target===t}))},N.prototype.addProperty=function(e,t,i,r){var e=e.config.singleVisual,n=e.objects;n||(e.objects=n={}),C.setValue(n,t,i,r)},N.prototype.removeProperty=function(e,t,i){e=e.config.singleVisual.objects;1<C.deleteProperty(e,t.objectName,i,t.propertyName)&&this.telemetry.logEvent(y.telemetry.EXDefnsDuplicateSelector)},N.prototype.setVisibility=function(e,t,i){var r=e.config.singleVisual;M.setHidden(r,t),t&&(r=this.explorationNavigationService.getCurrentSection(),this.filterGenerator.clearCrossHighlightForVisualContainers(r,[e]),i||x.unselectCanvasItem(e,this.selectionService))},N.prototype.clearCrossHighlightsForGroup=function(e,t,i){var r,n=[];return A.contracts.traverseVisualContainerGroups([e],(function(t){A.contracts.isVisualContainer(t)&&_.some(i,(function(e){return e.sourceVisualContainer===t}))&&n.push(t)})),_.isEmpty(n)||(this.filterGenerator.clearCrossHighlightForVisualContainers(t,n),r=this.clearCrossHighlightsForVisuals(n,t)),r||[]},N.prototype.ensureNativeReferenceName=function(r,e){var n,t,a,o=this,s=e.config.singleVisual,l=s.query;null!=l&&(n=I.getVisualCapabilities(e,this.visualPluginService),t=(e=_.partition(l.defn.select(),(function(e){return null!=e.nativeReferenceName})))[0],e=e[1],_.isEmpty(e)||(a=Object.assign.apply(Object,__spreadArray([{}],t.map((function(e){var t={};return t[e.nativeReferenceName]=!0,t})))),_.forEach(l.defn.select(),(function(e,t){var i;null==e.nativeReferenceName&&(i=e.expr,e=o.displayNameService.getDisplayName(i,r,n,e.name,s.columnProperties),P.isHierarchyLevel(i)&&(i=m.getSourceHierarchy(i)||m.getSourceVariationExpr(i),e=o.displayNameService.getDisplayName(i,r,n,null,s.columnProperties)+" "+e),i=StringExtensions.findUniqueName(a,e),a[i]=!0,l.setNativeReferenceNameAt(t,i))}))))},N.prototype.clearCrossHighlightsForVisuals=function(e,t){var i=__spreadArray([],e||[]);return i.push.apply(i,this.filterGenerator.clearCrossHighlightForVisualContainersOperation(t,e)||[]),_.uniq(i)},N.prototype.setVisualContainerGroupVisibility=function(e,t,i){var r;n.setHidden(e,t),t&&(r=(t=this.explorationNavigationService.getCurrentSection())&&t.crossFilterSource&&t.crossFilterSource.highlight,this.clearCrossHighlightsForGroup(e,t,r)),i||x.unselectCanvasItem(e,this.selectionService)},N.prototype.setVisualContainerGroupDisplayName=function(e,t){n.setDisplayName(e,t)},N.prototype.setZIndex=function(e,t){var i=this.formFactorProvider.getCurrentLayout();e.layouts.withId(i).position.z=t},N.prototype.setTabOrder=function(e,t){var i=this.formFactorProvider.getCurrentLayout();e.layouts.withId(i).position.tabOrder=t},N.prototype.setVisualRelationship=function(e,t,i,r){var n;t!==i&&(e.relationships=e.relationships||[],(n=this.visualRelationshipService.relationship(e,t,i))?n.type=r:(_.includes(e.visualContainers,t),_.includes(e.visualContainers,i),e.relationships.push({source:t,target:i,type:r})))},N.prototype.persistProperties=function(e,t,i){var r=t.objects||{},n=this.visualPluginService.capabilities(t.visualType),n=n?n.objects:void 0;return!!A.services.applyPropertyChanges(e,n,r,i)&&(t.objects=r,!(t.autoSelectVisualType=void 0))},N.prototype.persistVCProperties=function(e,t){var i=t.vcObjects||{};return!!A.services.applyPropertyChanges(e,M.CommonObjectDescriptors,i)&&(t.vcObjects=i,!0)},N.prototype.removeUnsupportedDataBoundProperties=function(e,t){var r,n,a;(this.visualPluginService.isScriptVisual(t)||this.pluginOps.isAnalysisVisual(t))&&(r=e.config.singleVisual.vcObjects)&&(n=e.config.singleVisual.query.defn.select(),a=[],_.forEach(r,(function(e,i){e=e[0].properties;_.forEach(e,(function(e,t){0<v.getDataBoundExprs(e,null,n).length&&a.push((function(){C.deleteProperty(r,i,null,t)}))}))})),_.forEach(a,(function(e){e()})))},N.prototype.ensurePercentRoleTotal=function(e,t){this.visualPluginService.capabilities(t).dataRoleTotals||(t=new j,t=new A.schemaRewriterUtils.VisualQueryExprRewriter(t),t=new h.VisualContainerRewriter([t]),h.traverseVisualContainer(e,t,this.visualPluginService))},N.prototype.getVisualDataRole=function(e,t){e=I.getDataRolesForVisual(e,this.visualPluginService);if(!_.isEmpty(e))return o.findItemWithName(e,t)},N.prototype.removeFieldImpl=function(e,t,i,r,n,a){return this.invokeRemoveOnSelectedVisuals({expr:e,ignoreAggregates:!0,fieldParameter:a,shouldRemoveParameter:!0},t,i,r,[n])},N.prototype.removeFilterImpl=function(e,t,i,r){if(t&&t.container&&t.container.filters)for(var n,a,o={filter:e,changeType:0,scope:t,parentActivity:i,changeFilterActivity:r},s=0;s<t.container.filters.length;s++)if(t.container.filters[s]===e)return t.container.filters.splice(s,1),3===t.container.filterSortOrder&&this.updateFilterOrdinal(t.container.filters),A.FilterUtils.notifyFilterContainerChangedByUser(this.eventBridge,o),(5===e.howCreated&&!e.isTransient&&1===t.scopeType||A.PodUtils.isPodEnabled(e,t))&&(a=this.explorationNavigationService.getCurrentExploration(),n=t.container,null!=a&&null!=n&&(A.PodUtils.deleteParameter(a,n.name,e.name,this.linguisticSchemaProxy),a={filterName:e.name,type:1},this.eventBridge.publishToChannel(g.podParameterChanged,a))),!0;return!1},N.prototype.removeFiltersWithExpr=function(e,t){var i,r=t.filters;if(!r)return!1;for(var n=r.length-1;0<=n;n--){var a=r[n];P.equals(a.expression,e)&&(i=this.removeFilterImpl(a,{scopeType:0,container:t},void 0,void 0))}return i},N.prototype.invokeRemoveOnSelectedVisuals=function(e,t,i,r,n){for(var a=!1,o=[],s=t.length-1;-1<s;s--){var l,u,c,p=t[s],h=p.config.singleVisual.query;h&&(l=this.contextActivityService.createActivity({name:"UpdateField",visualName:p.name,data:{fieldKinds:n,operationType:"Remove",source:null!=e.expr?"FieldList":"FieldWell"}}),this.checkSparklineRemovedAndLog(h,e,i),u=b.getDrillFilterRemovalInfoList(h,e,0),c=this.core.getRemoveOptionsQueryRefs(e,h),h=0<this.core.removeWithValidation(h,c,[e],p,i,u,this.drill,this.sortService,this.updateFilterState).removeSuccessCount,a=a||h,h&&(o.push(p),this.isVisualRecommendationAllowed(p)&&null!=r&&r.updateWithRecommendation(p,void 0,i)),a?l.resolve():l.reject())}return _.isEmpty(o)||this.notifyVisualContainers(o),a},N.prototype.buildVisualContainerFromConfig=function(e,t,i){return this.core.ensureFiltersArrayIsValid(i),{name:e,config:t,filters:i||[]}},N.prototype.createVisualFromConfig=function(e,t,i,r,n){void 0===n&&(n=!0),t=this.applyConfigOptions(e,t);var a=this.formFactorProvider.getCurrentLayout(),o=_.flatMap(e.sections,(function(e){return e.visualContainerGroups})),o=I.uniqueName(o),o=this.buildVisualContainerFromConfig(o,t,i),t=(o.layouts=jsCommon.ArrayExtensions.extendWithId([{id:a,position:e.position}]),this.explorationNavigationService.getCurrentExploration()),i=(t.defaultDrillFilterOtherVisuals&&(o.drillFilterOtherVisuals=!0),e.exploreCanvas),s=i.contract,l=x.getSelectedCanvasItems(this.selectionService),u=l&&l[0],l=l&&1===l.length&&A.contracts.isVisualContainerGroup(u),n=(e.postProcessing&&(o.postProcessing=e.postProcessing({outputVisualContainer:o,selectedVisualContainers:e.selectedVisualContainers||s.visualContainers})),s.visualContainers.push(o),l&&A.contracts.isVisualContainerGroup(u)?s.visualContainerGroups=y.ItemGroupingManager.addToGroup(o,u,s.visualContainerGroups):s.visualContainerGroups=y.ItemGroupingManager.add(s.visualContainerGroups,o),n&&this.eventBridge.publishToChannel(g.visualContainerAdded,{visualName:o.name}),A.viewModels.ViewModelFactory.convertVisualContainer(t,s,o,a));if(n)return i.visualContainers.push(n),l?(t=y.ItemGroupingManager.find(u.name,i.visualContainerGroups),A.viewModels.isVisualContainerGroup(t)&&(i.visualContainerGroups=y.ItemGroupingManager.addToGroup(n,t,i.visualContainerGroups)),h.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(i.visualContainerGroups,s.visualContainerGroups),a=y.ItemGroupingManager.find(u.name,i.visualContainerGroups),A.viewModels.isVisualContainerGroup(a)&&this.layoutAuthoring.addCanvasItemToGroup(a,n,!0)):i.visualContainerGroups=y.ItemGroupingManager.add(i.visualContainerGroups,n),!1!==e.select&&x.selectCanvasItem(o,this.selectionService,0,!0),this.telemetry.logEvent(y.telemetry.EXCreateVisual,{source:r,visualType:I.getVisualType(o),visualName:o.name}),o},N.prototype.createExprWithAggregate=function(e,t,i,r){if(D.discourageAggregation(e,t))return e;var n=this.getPreferredAggregate(t,e,r);return this.aggrOps.createExprWithAggregate(e,t,i,r?r.requiredTypes:null,n)},N.getPositionForAddedVisual=function(e,t,i){e=e.contract.visualContainerGroups;if(!i)return N.getDefaultVisualContainerPosition(e,t);if(null!=i.z)return i;i=_.cloneDeep(i);return i.z=h.CanvasVisualsUtility.getZIndexForNewCanvasItem(e,t),i},N.getDefaultVisualContainerPosition=function(e,t){return{height:0,width:0,x:0,y:0,z:h.CanvasVisualsUtility.getZIndexForNewCanvasItem(e,t)}},N.prototype.shouldPreferGroupToAggregate=function(e,t,i,r,n){if(r){var a=n||this.findCompatibleRole(e,r,t,!1);if(a&&a.kind===y.VisualDataRoleKind.GroupingOrMeasure&&1===a.kindPreference)return!0}if(n&&n.kind===y.VisualDataRoleKind.GroupingOrMeasure){a=this.isRoleOrExprLatLong(e,t,n);if(a){if(!r)return!0;var o=I.getVisualQuery(r);if(o&&o.projections)for(var r=this.visualPluginService.capabilities(r.config.singleVisual.visualType),r=y.visualCapabilitiesHelperModuleFactory().create(r,this.geotaggingAnalyzerService),s=void 0,l=0,u=s=a?r.getNonLatLongRoles():s;l<u.length;l++){var c=u[l];if(o.projections[c])return!1}}else{if(!D.isExprValidForAggregation(t)||i)return!0;var p=t.getMetadata(e);if(L(t,p,e))return 1===(null==p?void 0:p.defaultAggregate)}}if(!n&&1===(null==(p=t.getMetadata(e))?void 0:p.defaultAggregate))return!0;return n&&n.kind!==y.VisualDataRoleKind.Measure},N.prototype.getPreferredAggregate=function(e,t,i){if(this.isRoleOrExprLatLong(e,t,i))return 1},N.prototype.isRoleOrExprLatLong=function(e,t,i){var r=y.visualCapabilitiesHelperModuleFactory().isValueTypeDescriptorLatLong;if(i){i=i.preferredTypes;if(r(_.isEmpty(i)?void 0:i[0]))return!0}i=t.getMetadata(e);return!!r(i?i.type:void 0)},N.prototype.canHierarchyLevelJoinExistingGroup=function(e,t,i,r,n){var a=t&&t.projections[i];if(P.isHierarchyLevel(r)&&a&&0<a.all().length){var a=a.all(),e=m.expandExpr(e,r.arg),o=_.isNumber(n)?n-1:a.length-1;if(0<=o&&m.areHierarchyLevelsOrdered(e,t.tryGetExpr(i,o),r))return!0;if(_.isNumber(n)&&n<a.length&&m.areHierarchyLevelsOrdered(e,r,t.tryGetExpr(i,n)))return!0}return!1},N.prototype.addHierarchyLevelToExistingHierarchiesInVisual=function(e,t,i,r){var n=!1,e=V.getOptionsToAddHierarchyLevelToExistingHierarchies(e,t,i.singleVisual.query,r);if(e)for(var a=0,o=e;a<o.length;a++)var s=o[a],n=this.core.add(s,i,!1)||n;return n},N.prototype.resetSearchProperties=function(e){var t,i=I.getObjectDefinitions(e);i&&(e=I.getVisualCapabilities(e,this.visualPluginService),(t=this.filterGenerator.tryGetSelfFilterEnabledProperty(e))&&C.deleteProperty(i,t.objectName,null,t.propertyName),(t=this.filterGenerator.tryGetSelfFilterProperty(e))&&C.deleteProperty(i,t.objectName,null,t.propertyName))},N.prototype.logReportMeasureMoveTelemetry=function(e,t,i,r,n){var a;i!==r&&(a=n&&n.getTargetEntity())&&a.schema===f.ExplorationSchemaName&&(a=n.getConceptualProperty(e))&&(n=this.getVisualDataRole(t,i),e=this.getVisualDataRole(t,r),(i=JSON.stringify(n.requiredTypes))!==(t=JSON.stringify(e.requiredTypes))&&this.telemetry.logEvent(y.telemetry.EXReportMeasureMoveRoleKind,{dataType:y.PrimitiveTypeNames[a.type.primitiveType],sourceTypes:i,targetTypes:t}))},N.prototype.setVisualDrillFilterOtherVisualsSetting=function(e,t){e.drillFilterOtherVisuals!==t&&(e.drillFilterOtherVisuals=t,this.eventBridge.publishToChannel(g.visualDrillFilterOtherVisualsSettingChanged,{visualContainer:e,on:t}))},N.prototype.customizeConvertTo=function(e,t){var e=e.config.singleVisual,i=this.visualPluginService.getCustomizeConvertTo(e.visualType,t);if(i&&i.objects){var r,n=e.objects,a=e.mobileObjects,o=this.visualPluginService.capabilities(e.visualType),s=this.visualPluginService.capabilities(t);for(r in i.objects){var l,u=i.objects[r],c=s.objects[r];for(l in u){var p=u[l],h=c.properties[l],h=h.type;this.customizeConvertProperty(n,o,p,h,{objectName:r,propertyName:l}),a&&this.customizeConvertProperty(a,o,p,h,{objectName:r,propertyName:l})}}}},N.prototype.customizeConvertProperty=function(e,t,i,r,n){var a,o=[];if(i.transformArgs)for(var s=0,l=i.transformArgs;s<l.length;s++){var u=l[s],c=u.identifier,p=c.objectName,c=c.propertyName,u=this.getVisualObjectPropertyDefinition(e,u.identifier,u.selector),p=t.objects[p].properties[c].type,c=void 0;p.fill&&p.fill.solid?c=u&&u.solid&&u.solid.color:u instanceof P&&(c=u),o.push(c)}var h,d=n.objectName,v=n.propertyName,g=(i.transform||_.identity).apply(void 0,o),m=r;g?r.fill&&r.fill.solid?(P.isConstantText(g)||P.isThemeDataColor(g),a={solid:{color:g}}):(m.bool||m.numeric||m.integer||m.text||m.enumeration)&&(m.bool&&P.isConstantBoolean(g),(m.numeric||m.integer)&&P.isConstantNumeric(g),(m.text||m.enumeration)&&P.isConstantText(g),a=g):a=void 0,void 0!==a?(h=this.getOrCreateDataViewObjectDefinition(e,n,i.targetSelector)).properties[v]=a:(h=this.getDataViewObjectDefinition(e[d],i.targetSelector))&&h.properties[v]&&delete h.properties[v]},N.prototype.getVisualObjectPropertyDefinition=function(e,t,i){var r=t.objectName,t=t.propertyName,e=e[r]||[],r=this.getDataViewObjectDefinition(e,i);return r&&r.properties[t]},N.prototype.getOrCreateDataViewObjectDefinition=function(e,t,i){var t=t.objectName,r=e[t]=e[t]||[],r=this.getDataViewObjectDefinition(r,i);return r||e[t].push(r=void 0!==i?{properties:{},selector:i}:{properties:{}}),r},N.prototype.getDataViewObjectDefinition=function(e,t){return _.find(e,(function(e){return null==e.selector&&null==t||e.selector&&t&&e.selector.id===t.id}))},N.prototype.checkSparklineRemovedAndLog=function(e,t,i){var r,n=t;if(n.expr?r=jsCommon.ArrayExtensions.ensureArray(n.expr):(n=t).role&&null!=n.projOptions.fieldIndex&&(t=e.tryGetExprs(n.role),_.isEmpty(t)||(r=t.slice(n.projOptions.fieldIndex,n.projOptions.fieldIndex+(null!=(e=n.count)?e:1)))),!_.isEmpty(r))for(var a=0,o=r;a<o.length;a++){var s=o[a];P.isSparklineData(s)&&this.logSparklineEvent(s,i)}},N.prototype.logSparklineEvent=function(e,t){e=h.SparklinesUtil.getFieldCharacteristics(e,t),t=e.groupingType,e=e.measureType;this.telemetry.logEvent(y.telemetry.SparklinesDelete,{groupingType:t,measureType:e})},N.prototype.isVisualRecommendationAllowed=function(e){return this.featureSwitchService.featureSwitches.onObject&&I.isVisualTypeAutoSelect(e)},G=N,t=y.data.SQExprRewriter,__extends(i,t),i.prototype.visitScopedEval=function(e){return new X(e.expression,[])},j=i,h.getVisualDefaultType=U,h.logDrillthroughFilterUpdateTelemetry=z,h.isNumericMeasure=L,h.getTelemetryFieldKind=B,h.getTelemetryFilterType=W,h.getTelemetryFilterScopeType=Q,h.getTelemetryViewMode=function(e){switch(e){case 0:return"View";case 1:return"Edit"}},h.getTelemetryFilterCardSortType=function(e){switch(e){case 1:return"Ascending";case 2:return"Descending";case 3:return"Custom"}}})(powerbi=powerbi||{}),(function(c){var e,p,h;function d(e,t,i,r,n,a){var o;e&&t&&((o=e.getAdapter())&&r&&o.update({viewport:t,suppressAnimations:!0,dataViews:e.getDataViews(),type:i,resizeMode:a,viewMode:r.getViewMode(),editMode:n}))}function v(e){var t=e.warnings,i=e.dataBoundObjectWarnings,r=t?_.cloneDeep(t):{};if(!_.isEmpty(i))for(var n in r.visualObjectWarnings||(r.visualObjectWarnings={}),i){var a=r.visualObjectWarnings[n];a?a.push.apply(a,i[n]||[]):r.visualObjectWarnings[n]=i[n]}return r}function g(e,t,i,r){if(_.isArray(t)){var n=_.filter(t,(function(e){return!(e instanceof h)}));if(_.isEmpty(n)){e.dataBoundObjectWarnings||(e.dataBoundObjectWarnings={});for(var a=0,o=_.filter(t,(function(e){return e instanceof h}));a<o.length;a++){var s,l=o[a],u=l.propertyId.objectName;i&&p.objectIsHidden(u,i,r)||(l={selector:l.selector,warnings:[l]},(s=e.dataBoundObjectWarnings[u])?s.push(l):e.dataBoundObjectWarnings[u]=[l])}}else n.length,t.length,e.warnings={warnings:n}}else e.warnings=t}e=(e=(e=c.explore||(c.explore={})).util||(e.util={})).VisualContainerUtils||(e.VisualContainerUtils={}),p=c.explore.util.CanvasVisualsUtility,h=c.data.DataBoundExprWarning,e.updateVisual=d,e.wrapRunningVisual=function(o,i,r,s,t,n,l,e,a){var u={getType:function(){return o.type},setType:function(e){return o.type=e},getViewport:function(){return o.viewport},setViewport:function(e,t){o.viewport=e,t&&d(u,e,c.VisualUpdateType.Resize,i,r)},getData:function(){return o.data},getAdapter:function(){return o.visual},getDataViews:function(){return o.dataViews},setDataViews:function(e){return o.dataViews=e},getDataTransforms:function(){return o.dataTransforms},setThemeCollection:function(e){return o.themeCollection=e},getIsInFocus:function(){return o.isInFocus},setIsInFocus:function(e){return o.isInFocus=e},setData:function(e,t,i){o.data=e,o.dataAppliedEvent&&(o.dataAppliedEvent.reject(),o.dataAppliedEvent=void 0),o.performanceActivity&&(o.performanceActivity.cancel(!0),o.performanceActivity=void 0),o.dataAppliedEvent=t,o.performanceActivity=i},setDataTransforms:function(e){return o.dataTransforms=e},setPendingSelection:function(e){return o.pendingSelection=e},hasPendingSelection:function(){return!!o.pendingSelection},setAdditionalObjectUpdates:function(e){return o.additionalObjectUpdates=e},setIsDisabled:function(e){return o.isDisabled=e},getIsDisabled:function(){return o.isDisabled},setIsDisabledIfUncertified:function(e){return o.isDisabledIfUncertified=e},getIsDisabledIfUncertified:function(){return o.isDisabledIfUncertified},setReportId:function(e){return o.reportId=e},getErrorInfo:function(){return o.errorInfo},setErrorInfo:function(e){return o.errorInfo=e},getWarnings:function(){return v(o)},setWarnings:function(e,t,i){return g(o,e,t,i)},getDataBoundObjectWarnings:function(){return o.dataBoundObjectWarnings},resetWarnings:function(e){(e=void 0===e?!1:e)&&(o.dataBoundObjectWarnings={}),o.warnings=void 0},getHasPendingChanges:function(){return o.hasPendingChanges},setHasPendingChanges:function(e){return o.hasPendingChanges=e},getSelectedDatapoints:function(){return o.selectedDatapoints},setSelectedDatapoints:function(e,t){var i=o,r=s,n=l,a=i.visual;r.pendingSelection||i.pendingSelection,t&&(a&&a.visualHasMethod&&a.visualHasMethod("onRestoreSelection")?a.onRestoreSelection({selection:e}):(g(i,[new c.visuals.OnRestoreSelectionNotSupportedWarning]),n&&n(v(i)))),i.selectedDatapoints=e},clearSelectedDatapoints:function(){o.selectedDatapoints=void 0;var e=o.visual;e&&e.onClearSelection&&e.onClearSelection(),t.selectDataPoint(n,[],void 0,void 0,1)},getSubSelectionStyles:function(e){if(a){var t=a.getSubSelectionStyles(e);if(t)return t}return o.visual&&o.visual.getSubSelectionStyles&&o.visual.getSubSelectionStyles(e)},getSubSelectionShortcuts:function(e){if(a){var t=a.getSubSelectionShortcuts(e);if(t)return t}return o.visual&&o.visual.getSubSelectionShortcuts&&o.visual.getSubSelectionShortcuts(e)},getSubSelectables:function(e){var t,i=[],r=null==(r=null==(t=null==o?void 0:o.visual)?void 0:t.getSubSelectables)?void 0:r.call(t,e);return r&&i.push.apply(i,r),a&&(t=a.getSubSelectables(e))&&i.push.apply(i,t),0!==i.length?i:void 0}};return e&&(u.sortServices=e),u}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).VisualHostServicesUtil||(e.VisualHostServicesUtil={})).createQueryVisualHostServices=function(){return{getFilters:function(){return{dataFilter:null,dataFiltersUnmerged:null}},getDataSourceVariables:function(){},getVisualRelationshipFilterAction:function(){return 0},selectDataPoint:_.noop,setVisualRelationshipFilterAction:_.noop}},e.createVisualHostDecompositionService=function(r,n){return{clearAILevels:function(e){return n.clearAILevels(r,e)},isDecompositionAnalysisSupported:function(){return n.isDecompositionAnalysisSupported(r)},isSupported:function(){return n.isSupported()},isTopNPerLevelSupported:function(){return n.isTopNPerLevelSupported()},removeLevel:function(e){return n.removeLevel(r,e)},addLevelAndExpandNode:function(e,t){return n.addLevelAndExpandNode(r,e,t)},addAILevelAndExpandNode:function(e,t,i){return n.addAILevelAndExpandNode(r,e,t,i)},updateLevel:function(e,t){return n.updateLevel(r,e,t)},updateAILevel:function(e,t){return n.updateAILevel(r,e,t)},toggleLockedLevels:function(e){return n.toggleLockedLevels(r,e)},toggleNode:function(e){return n.toggleNode(r,e)}}}})(powerbi=powerbi||{}),(function(c){var e,p,h,t,d,v,g,m,y,f,C,S,b,E;function V(e){if(e&&e.solid)return e.solid.color}function x(e,t,i,r,n,a){var o=c.DataViewObject.getValue(e,"bold"),s=c.DataViewObject.getValue(e,"italic"),l=c.DataViewObject.getValue(e,"underline"),u={size:"fontSize",family:"fontFamily"},s=(o&&(u.bold="bold"),s&&(u.italic="italic"),l&&(u.underline="underline"),o=t?d.createFromObjectOrStyle(e,u,void 0,r,void 0,"label",n):d.createFromDataViewObject(e,u,void 0,void 0,n),d.inherit(o,{color:a}));return i&&(s=d.inherit(s,{size:v.createFromPt(g)})),d.flatten(s)}e=(e=(e=c.explore||(c.explore={})).util||(e.util={})).VisualTooltipStyleUtils||(e.VisualTooltipStyleUtils={}),p=c.visuals.ColorHelper,h=c.visuals.DefaultDataItemTooltipStyle,t=c.visuals.Font,d=c.visuals.FontProperties,v=c.visuals.Units.FontSize,g=9,m={size:h.titleFontProperties.size,family:h.titleFontProperties.family},y={size:h.valueFontProperties.size,family:h.valueFontProperties.family},f={size:h.titleFontProperties.size,family:t.Family.regular.css},C=h.titleFontProperties.color,S=h.valueFontProperties.color,b=h.background.solid.color,E=h.actionFontProperties.color,t="#252423",e.DefaultDataItemEnhancedTooltipStyle={titleFontProperties:{color:t,family:m.family,size:m.size,weight:h.titleFontProperties.weight},valueFontProperties:{color:t,family:y.family,size:y.size,weight:h.valueFontProperties.weight},actionFontProperties:{color:t,family:f.family,size:f.size},hoverColor:"#C8C6C4",dividerColor:"#C8C6C4",background:{solid:{color:"#FFFFFF"}},transparency:0},e.getVisualTooltipStyles=function(e,t,i,r){var n,a=(l=(function(e,t,i){var r,n,a,o,s=!(!e||!(e.titleFontColor||e.valueFontColor||e.background));t&&!s?(r=V(e&&e.themedTitleFontColor)||p.getThemeColor(i,c.visuals.ForegroundColorName),n=V(e&&e.themedValueFontColor)||p.getThemeColor(i,c.visuals.ForegroundColorName),a=V(e&&e.themedBackground)||p.getThemeColor(i,c.visuals.BackgroundColorName),o=V(e&&e.actionFontColor)||p.getThemeColor(i,c.visuals.ForegroundColorName)):t&&s?(r=V(e&&e.themedTitleFontColor)||V(e&&e.titleFontColor)||C,n=V(e&&e.themedValueFontColor)||V(e&&e.valueFontColor)||S,a=V(e&&e.themedBackground)||V(e&&e.background)||b,o=V(e&&e.actionFontColor)||r):(r=V(e&&e.titleFontColor)||C,n=V(e&&e.valueFontColor)||S,a=V(e&&e.background)||b);return{actionFontColor:o,backgroundColor:a,titleFontColor:r,valueFontColor:n}})(r,t,e)).actionFontColor,o=l.backgroundColor,s=l.titleFontColor,l=l.valueFontColor,u=x(r,t,i,e,m,s),l=x(r,t,i,e,y,l),a=a?x(r,t,i,e,f,a):void 0,o={solid:{color:o}};return{titleFontProperties:u,valueFontProperties:l,actionFontProperties:a=void 0===a&&i?x(r,t,i,e,f,t?E:s):a,discoverabilityFontProperties:n=t?_.clone(a):n,background:o,transparency:r&&null!=r.transparency?r.transparency:t?0:h.transparency,hoverColor:p.getThemeColor(e,c.visuals.BackgroundNeutralName),dividerColor:p.getThemeColor(e,c.visuals.BackgroundNeutralName)}}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).constants||(e.constants={})).scrollCarouselToEndEventName="scrollCarouselToEnd",e.pinVisualContainerEventName="pinVisualContainer",e.trustedVisualConsentStateChangedEventName="trustedVisualConsentStateChanged",e.invalidVisualContainerId=-1,e.updateNavButtonEvent="updateNavButtonEvent",e.ConnectionSetupLimit=4,e.smallFontSizeInPoint=9,e.MaxGroupingDepth=20,(e=e.ExploreCanvasConstants||(e.ExploreCanvasConstants={})).AutoLayoutVisualPadding=10,e.AutoLayoutVisualVCHeader=20,e.AutoLayoutVisualSkittlesRightPadding=30,e.AutoLayoutMaxSpaceHeight=300,e.AutoLayoutMaxSpaceWidth=300,e.AutoLayoutMinSpaceHeight=150,e.AutoLayoutMinSpaceWidth=150,e.ResponsiveLayoutMaxWidthBreakpoint=500,e.ScrollbarOffset=15,e.DefaultCanvasUiScale={x:1,y:1},e.DisplayAreaHeightAdditionMinimumScale=.9,e.DisplayAreaHeightScaleAddtion=.02,e.DisplayAreaOverflowEpsilonPx=8,e.DisplayAreaOutlineSize=8,e.DisplayAreaTransparencyOutlineThreshold=50,e.FieldListShimmeringBarHeight=24,e.PhoneAuthoringViewportHeight=558,e.PhoneAuthoringViewportWidth=324,e.PhonePortraitColumnCount=18,e.PhonePortraitRowCount=180,e.PhonePortraitCanvasHeight=3600})(powerbi=powerbi||{}),(function(e){((e=e.explore||(e.explore={})).modules||(e.modules={})).ExploreUIShellModule={name:"powerbi.exploreUIShell",dependency:{javascript:"ExploreUIShell/module",css:["exploreUIShell"]}}})(powerbi=powerbi||{}),(function(p){var e,t,i,h,s;function r(e,t){var i,r,n,a,o={color:h.color(t.minColor,"minColor")},s=t.minValue,s=(null!=s&&(i=h.double(s)),t.diverging&&(n={color:h.color(t.midColor,"midColor")},null!=(s=t.midValue)&&(r=h.double(s))),{color:h.color(t.maxColor,"maxColor")}),l=t.maxValue,l=(null!=l&&(a=h.double(l)),t.nullStrategy),u=t.nullColor,c={},t=t.diverging?c.linearGradient3={min:o,mid:n,max:s}:c.linearGradient2={min:o,max:s};return i&&(t.min.value=i),r&&(t.mid.value=r),a&&(t.max.value=a),l&&(t.nullColoringStrategy={strategy:h.text(l)},l===p.NullStrategy.specificColor&&(t.nullColoringStrategy.color=h.color(u,"nullColor"))),h.fillRule(e,c)}function n(e,t,i,r,n){var a,o;return 0<t&&(a=h.compare(2,e,s.overRangeOf(e,t/100))),i<100&&(o=h.compare(r?4:3,e,s.overRangeOf(e,i/100))),{condition:a&&o?h.and(a,o):a||o,value:n}}e=(e=p.explore||(p.explore={})).util||(e.util={}),i=p.visuals.GradientUtils,h=p.data.SQExprBuilder,s=p.data.SQRangePercentExpr,(t=e.ConditionalFormattingUtil||(e.ConditionalFormattingUtil={})).createDefaultGradientFillDefinition=function(e){return{solid:{color:r(e,i.getDefaultGradientSettings())}}},t.createFillExpression=r,t.createDefaultConditionalFillDefinition=function(e,t){return e={condition:h.compare(3,e,h.double(0)),value:h.text(t)},{solid:{color:h.conditional([e])}}},t.DefaultIconId="CircleHigh",t.DefaultIconLayout="Before",t.DefaultIconVerticalAlignment="Top",t.createDefaultIconDefinition=function(e){return{kind:"Icon",value:h.conditional([n(e,67,100,!0,h.text("CircleHigh")),n(e,33,67,!1,h.text("SignMedium")),n(e,0,33,!1,h.text("SignLow"))]),layout:h.text(t.DefaultIconLayout),verticalAlignment:h.text(t.DefaultIconVerticalAlignment)}},t.createIconPercentCase=n,t.createIconNumberCase=function(e,t,i,r,n){var a,o;return null!==t&&(a=h.compare(2,e,h.double(t))),null!==i&&(o=h.compare(r?4:3,e,h.double(i))),{condition:a&&o?h.and(a,o):a||o,value:n}}})(powerbi=powerbi||{}),(function(e){((e=e.explore||(e.explore={})).htmlTemplate||(e.htmlTemplate={})).put=function(e){e.put("components/dateTimePicker/dateTimePicker.html",'<div class="datetimePicker" pbi-lazy-load-contents="$ctrl.moduleConfig"> <input type="text" aria-labelledby="{{ $ctrl.labelId }}" class="inputFieldInSlice" ng-blur="$ctrl.dateTextUpdated()" ng-model="$ctrl.textVal" ng-class="{\'ng-invalid\': $ctrl.inputInvalid}" placeholder="{{::$ctrl.placeholder}}"/> <button class="calendar" type="button" ng-attr-title="{{$ctrl.calendarButtonText}}" dropdown-overlay-invoke="{{$ctrl.id}}"><svg-use-symbol sheet="filterPaneIcons" symbol-id="fieldListEntity"></svg-use-symbol></button><dropdown-overlay class="calendarDropDown" dropdown-overlay-name="{{$ctrl.id}}"><datepicker class="calendar" ng-model="$ctrl.dateVal" ng-change="$ctrl.dateSelected()" onclick="event.stopPropagation()" show-weeks="false" min-date="$ctrl.validators.min" max-date="$ctrl.validators.max"></datepicker></dropdown-overlay></div>'),e.put("views/canvasVisualHeaderIcon.html",'<button tooltip tooltip-config="$ctrl.tooltipConfigManager.getTooltipConfig()" ng-disabled="!$ctrl.isClickable()" ng-switch="$ctrl.iconType"><i class="infoIcon glyphicon {{$ctrl.useStylableHeader() ? \'pbi-glyph-info-nocircle\' : \'pbi-glyph-info\'}}" ng-switch-when="info"></i><i class="warningIcon pbi-glyph-warning glyphicon" ng-switch-when="warning"></i><i class="errorIcon pbi-glyph-error glyphicon" ng-switch-when="error"></i></button>')}})(powerbi=powerbi||{}),(function(i){var e,t,r;function n(){r||(i.common.initializeAngularModule(),i.visualHost.initializeAngularModule(),angular.module("powerbi.explore.controllers",[]),angular.module("powerbi.explore.directives",[]),angular.module("powerbi.explore.components",[]),angular.module("powerbi.explore",["powerbi.common","powerbi.explore.controllers","powerbi.explore.directives","powerbi.explore.components","powerbi.visualHost"]).run(["lazyScopedFactories",function(e){}]).run(["$templateCache",t]),r=!0)}e=i.explore||(i.explore={}),t=i.explore.htmlTemplate.put,e.initializeAngularModule=n,r=!1,n(),e.registerBuildingBlocksForHost=function(e){var t=[{name:"DateTimePicker",blockType:2,consumerHostFlags:8203,factory:i.explore.components.DateTimePicker}];i.common.registerBuildingBlocksForHost(e,t,{componentsTarget:"powerbi.explore.components",directivesTarget:"powerbi.explore.directives"})}})(powerbi=powerbi||{}),(function(i){var e;(function(e){function t(e,t){void 0===t&&(t=!1),this.localizationService=e,this.showIcons=t,this.allCommands=[]}t.prototype.getItems=function(){return this.menuItems},t.prototype.getCommandByIndex=function(e){return this.allCommands[e]},t.prototype.createItems=function(r){return __awaiter(this,void 0,i.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=[],[4,this.createMenuItemsFromCommands(r,t)];case 1:return(i=e.sent(),_.isEmpty(i))?[2,this.createNoAvailableActionsMenu()]:(this.allCommands=t,[2,{items:i}])}}))}))},t.prototype.createNoAvailableActionsMenu=function(){var e=[],t=this.localizationService.get("VisualContainer_ContextMenu_NoAvailableActions"),t=this.createMenuItem(null,t,null);return t.disabled=!0,e.push(t),{items:e}},t.prototype.createMenuItemsFromCommands=function(p,h){return void 0===h&&(h=[]),__awaiter(this,void 0,i.Promise,(function(){var t,i,r,n,a,o,s,l,u,c;return __generator(this,(function(e){switch(e.label){case 0:if(_.isEmpty(p))return[2];t=[],i=0,r=p,e.label=1;case 1:return i<r.length?[4,(n=r[i]).isVisible()]:[3,11];case 2:return e.sent()?(1===n.separatorPosition&&(t.length,t[t.length-1].type,c=this.createItemSeparator(),t.push(c)),o=a=void 0,n.getToolTip?[4,n.getToolTip(this.localizationService)]:[3,4]):[3,10];case 3:o=e.sent(),e.label=4;case 4:return(l=n.isDisabled)?[4,n.isDisabled()]:[3,6];case 5:l=e.sent(),e.label=6;case 6:return(s=l)?[3,9]:[4,n.getChildren()];case 7:return u=e.sent(),[4,this.createMenuItemsFromCommands(u,h)];case 8:a=e.sent(),e.label=9;case 9:h.push(n),u=this.createMenuItem(h.length-1,n.title(this.localizationService),s,a,n.glyph,n.selected,n.customIcon,o),t.push(u),2===n.separatorPosition&&(c=this.createItemSeparator(),t.push(c)),e.label=10;case 10:return i++,[3,1];case 11:return[2,t]}}))}))},t.prototype.createMenuItem=function(e,t,i,r,n,a,o,s){return{key:e,text:t,type:0,children:r,icon:n,selected:a,customIcon:o,showIcon:this.showIcons,disabled:i,tooltip:s}},t.prototype.createItemSeparator=function(){return{type:1,checked:!1}},e.VisualContainerContextMenu=t})((e=i.explore||(i.explore={})).components||(e.components={}))})(powerbi=powerbi||{}),(function(e){var C,S,D;function t(e,t,i,r,n,a,o,s,l,u,c,p,h,d,v,g,m,y,f,C,S,b,E,V,x,w,P,F,A,_,T){this.conceptualSchemaProxy=e,this.contextActivityService=t,this.clipboard=i,this.dataSources=r,this.drill=n,this.expandCollapse=a,this.eventBridge=o,this.explorationCapabilities=s,this.explorationNavigation=l,this.explorationExtensibility=u,this.featureSwitchService=c,this.filterGenerator=p,this.groupAuthoring=h,this.includeExcludeService=d,this.lazyScoped=v,this.drillToDetails=g,this.panesVisibilityService=m,this.pluginOps=y,this.promiseFactory=f,this.telemetryService=C,this.viewModeState=S,this.visibility=b,this.visualAuthoring=E,this.overlayService=V,this.undoRedo=x,this.visualPlugin=w,this.selection=P,this.layoutAuthoring=F,this.runningVisualService=A,this.copyVisualImageService=_,this.visualContainerCopyService=T}C=e.explore||(e.explore={}),(S=C.services||(C.services={})).createVisualContainerMenuFactoryService=function(e,t,i,r,n,a,o,s,l,u,c,p,h,d,v,g,m,y,f,C,S,b,E,V,x,w,P,F,A,_,T){return new D(e,t,i,r,n,a,l,u,c,o,p,C,h,d,v,s,b,E,m,S,f,g,y,V,x,w,P,F,A,_,T)},t.prototype.createDrillthroughCommands=function(e,t,i){var r=this.explorationExtensibility.getCommandsDisplayOptions(e.name);return new S.DrillthroughCommandCollection(e,t,"ModeOn",this.drill,this.explorationNavigation,this.lazyScoped,this.pluginOps,i,this.telemetryService,this.contextActivityService,"ContextMenu",void 0,r)},t.prototype.createOptionsCommands=function(e,t,i){this.explorationNavigation.getCurrentExploration();var r=this.explorationNavigation.getCurrentExploration().settings,n=this.explorationExtensibility.getCommandsDisplayOptions(e.contract.name),r=__spreadArray(__spreadArray([new S.AddCommentVisualCommand(e,this.eventBridge,t,this.contextActivityService,"VisualHeader",n),new S.ShareToTeamsVisualCommand(e,this.visibility,this.eventBridge,t,this.contextActivityService,"VisualHeader",n),new S.ToggleSearchCommand(e,this.filterGenerator,this.overlayService,this.undoRedo,this.visualAuthoring,this.visualPlugin,t,this.contextActivityService,"VisualHeader",n),new S.EnterAdvancedEditModeCommand(e,this.eventBridge,this.overlayService,t,this.contextActivityService,"VisualHeader",n),new S.ExportVisualDataCommand(e,this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.featureSwitchService,this.filterGenerator,this.overlayService,t,r,this.contextActivityService,"VisualHeader",n),new S.SeeDataCommand(e.contract,this.drill,this.visibility,this.pluginOps,this.contextActivityService,"VisualHeader",!0,this.viewModeState,n),new S.DeleteVisualContainerCommand(e,this.eventBridge,this.undoRedo,t,this.contextActivityService,"VisualHeader",n),new S.GetClustersCommand(e,this.eventBridge,t,this.contextActivityService,"VisualHeader",n),new S.ToggleSpotlightCommand(e,this.visibility,t,this.contextActivityService,"VisualHeader",n),new S.GetInsightsCommand(e,t,this.lazyScoped,this.telemetryService,this.contextActivityService,"VisualHeader",n)],this.getSortCommands(e,t,n)),[new S.TurnOnFormatModeCommand(this.viewModeState,this.featureSwitchService,this.panesVisibilityService,n)]);return this.getCustomCommands(r,1,e.contract,i,void 0,n)},t.prototype.getSortCommands=function(e,t,i){if(_.isEmpty(t.sortSetting.sortGroups))return[];var r,n=t.sortSetting.sortGroups;if(1===n.length&&n[0].isDefaultGroup)return r=n[0],[new S.SortDescendingCommand(e,this.eventBridge,this.overlayService,t,r,this.contextActivityService,"VisualHeader",i),new S.SortAscendingCommand(e,this.eventBridge,this.overlayService,t,r,this.contextActivityService,"VisualHeader",i),new S.SortByCommandCollection(e,this.eventBridge,this.overlayService,t,this.contextActivityService,"VisualHeader",i)];for(var a=[],o=0,s=n;o<s.length;o++){var l=s[o],l=new S.GroupedSortByCommandCollection(e,this.eventBridge,this.overlayService,t,l,this.contextActivityService,"VisualHeader",i);a.push(l)}return a},t.prototype.createNonQueryCommands=function(e,t){var i=this.explorationExtensibility.getCommandsDisplayOptions(e.name),r=this.explorationNavigation.getCurrentExploration().settings,t=__spreadArray(__spreadArray([],C.contracts.isVisualContainerGroup(e.contract)?[]:[new S.VisualContainerShareCommandsCollection(this.eventBridge,this.explorationCapabilities,this.viewModeState,this.visibility,t,this.contextActivityService,"ContextMenu",e,i)]),[new S.VisualContainerGroupingCommandsCollection(e.contract,this.selection,this.layoutAuthoring,this.viewModeState,r,i)]);return this.featureSwitchService.featureSwitches.daxTransformEnabled&&t.push(new S.SummarizeVisualContainerCommand(e.contract,this.explorationNavigation,this.pluginOps,this.selection,this.visualAuthoring,this.viewModeState,i,this.runningVisualService,this.contextActivityService,"ContextMenu")),this.featureSwitchService.featureSwitches.onObject&&t.push(new S.TurnOnFormatModeCommand(this.viewModeState,this.featureSwitchService,this.panesVisibilityService,i)),t},t.prototype.createCommands=function(p,h,d,v,g,m,y,f){return __awaiter(this,void 0,e.Promise,(function(){var t,i,r,n,a,o,s,l,u,c;return __generator(this,(function(e){switch(e.label){case 0:return!g||C.contracts.isVisualContainerGroup(p.contract)?[2,this.createNonQueryCommands(p,m)]:(t=p,i=this.runningVisualService.getVisual(p.contract),r=h.data,n=h.dataRoles,a=h.nodeIndex,o=h.position,s=[],l=this.explorationExtensibility.getCommandsDisplayOptions(t.name),u=this.explorationNavigation.getCurrentExploration().settings,s.push(new S.VisualContainerShareCommandsCollection(this.eventBridge,this.explorationCapabilities,this.viewModeState,this.visibility,m,this.contextActivityService,"ContextMenu",t,l)),[4,this.conceptualSchemaProxy.get(this.dataSources.get())]);case 1:return c=e.sent().schema(void 0),this.expandCollapse.isSupported(c&&c.capabilities,p.contract,n)&&this.expandCollapse.isEnabled(p.contract,n)&&(c=this.expandCollapse.getAllowedActions(p.contract,n,r))&&(s.push(new S.ExpandCollapseCommandsCollection(t.contract,c,!1,r,n,a,v,this.contextActivityService,"ContextMenu",l)),s.push(new S.ExpandCollapseCommandsCollection(t.contract,c,!0,r,n,a,v,this.contextActivityService,"ContextMenu",l))),s.push(new S.DrillDownCommand(p.contract,r,n,this.dataSources,this.drill,this.visualAuthoring,i,this.contextActivityService,"ContextMenu",void 0,l),new S.DrillToDetailsCommand(p.contract,r,this.drill,this.dataSources,this.drillToDetails,i,this.contextActivityService,"ContextMenu",l),new S.SeeDataCommand(p.contract,this.drill,this.visibility,this.pluginOps,this.contextActivityService,"ContextMenu",void 0,this.viewModeState,l),new S.CreateVisualCalculationCommand(p.contract,this.drill,this.pluginOps,this.contextActivityService,"ContextMenu",this.featureSwitchService,this.eventBridge,this.visualPlugin,l),new S.DrillDownLevelWithoutCurrentGroupCommand(p.contract,n,this.visualAuthoring,this.drill,i,this.contextActivityService,"ContextMenu",l),new S.DrillDownLevelWithCurrentGroupCommand(p.contract,n,this.visualAuthoring,this.drill,i,this.contextActivityService,"ContextMenu",l),new S.DrillUpCommand(p.contract,r,n,this.drill,this.visualAuthoring,i,this.contextActivityService,"ContextMenu",void 0,l),new S.CreateGroupCommand(p.contract,r,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.groupAuthoring,this.promiseFactory,l),new S.IncludeCommand(p.contract,r,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.includeExcludeService,this.promiseFactory,this.contextActivityService,"ContextMenu",f,l),new S.ExcludeCommand(p.contract,r,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.includeExcludeService,this.promiseFactory,this.contextActivityService,"ContextMenu",f,l),new S.DrillthroughCommandCollection(p.contract,r,"ContextMenu",this.drill,this.explorationNavigation,this.lazyScoped,this.pluginOps,d,this.telemetryService,this.contextActivityService,"ContextMenu",void 0,l),new S.InsightsAnalysisCommandsCollection(p.contract,r,o,this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.explorationCapabilities,this.explorationNavigation,this.lazyScoped,this.viewModeState,d,void 0,this.contextActivityService,"ContextMenu",l),new S.VisualContainerGroupingCommandsCollection(p.contract,this.selection,this.layoutAuthoring,this.viewModeState,u,l),new S.ClearSelectionCommand(t.contract,i,this.contextActivityService,"ContextMenu",l)),this.featureSwitchService.featureSwitches.daxTransformEnabled&&s.push(new S.SummarizeVisualContainerCommand(t.contract,this.explorationNavigation,this.pluginOps,this.selection,this.visualAuthoring,this.viewModeState,l,this.runningVisualService,this.contextActivityService,"ContextMenu")),0<(c=new S.CopyCommandsCollection(t,this.clipboard,this.featureSwitchService,this.copyVisualImageService,this.telemetryService,this.visualContainerCopyService,this.explorationCapabilities,this.explorationNavigation,this.visibility,this.viewModeState,h,this.eventBridge,this.contextActivityService,"ContextMenu",l)).commandsCount&&(this.featureSwitchService.featureSwitches.copyPasteMenuImage||this.featureSwitchService.featureSwitches.copyPasteMenuMetadata?s.unshift(c):s.push(c)),this.featureSwitchService.featureSwitches.onObject&&s.push(new S.TurnOnFormatModeCommand(this.viewModeState,this.featureSwitchService,this.panesVisibilityService,l)),[2,this.getCustomCommands(s,0,t.contract,r,y,l)]}}))}))},t.prototype.getCustomCommands=function(r,n,a,o,s,l){var e,u=this,c={};return null!=(e=this.explorationExtensibility.getGroups())&&e.forEach((function(e){c[e.name]=new S.ExtensionCommandsGroup(e.title,l,e.menuLocation)})),this.getCommandExtensions(a,n).forEach((function(e){var t=u.getCommandMenuExtension(e,n),e=new S.ExtensionCommand(a,o,e.name,t.title||e.title,u.eventBridge,u.explorationExtensibility,u.featureSwitchService,u.contextActivityService,"ContextMenu",t.icon||e.icon,s,l),i=t.groupName&&c[t.groupName];i?(i.isEmpty&&(1===i.menuLocation?r.unshift(i):r.push(i)),i.addChild(e)):1===t.menuLocation?r.unshift(e):r.push(e)})),r},t.prototype.getCommandMenuExtension=function(e,t){var i=e&&e.extend;switch(t){case 0:return i&&i.visualContextMenu;case 1:return i&&i.visualOptionsMenu}},t.prototype.getCommandExtensions=function(t,e){var i=this,r=this.explorationExtensibility.getCommandExtensions()||[];switch(t&&(r=r.filter((function(e){return i.visualMenuShouldHaveCommand(t,e)}))),e){case 0:return r.filter((function(e){return e.extend&&e.extend.visualContextMenu}));case 1:return r.filter((function(e){return e.extend&&e.extend.visualOptionsMenu}))}},t.prototype.visualMenuShouldHaveCommand=function(t,e){return!e.visuals||e.visuals.some((function(e){return e===t.name}))},D=t})(powerbi=powerbi||{}),(function(i){var e;(function(e){function t(e,t,i,r,n,a,o){this.defaultTitleKey=e,this.selectors=t,this.glyph=i,this.commandDisplayOption=r,this.selected=n,this.customIcon=a,this.separatorPosition=o,_.isEmpty(t)||_.some(t,(function(e){return _.isEmpty(e)})),this.selectors=_.compact(t)}t.prototype.title=function(e){return e&&this.defaultTitleKey?e.get(this.defaultTitleKey):this.defaultTitleKey},t.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},t.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,2!==this.commandDisplayOption]}))}))},t.prototype.isDisabled=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,1===this.commandDisplayOption]}))}))},t.prototype.getChildren=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,null]}))}))},t.prototype.getTelemetryInfo=function(){return this.defaultTitleKey},t.prototype.announceSelectionState=function(e,t){e&&(t=e.getLocalizedString(this.getSelectionStateStringKey(t)),e.alertScreenReader(t))},t.prototype.getSelectionStateStringKey=function(e){return e?"FieldListProperty_Selected":"FieldListProperty_Unselected"},e.VisualContainerMenuCommand=t})((e=i.explore||(i.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(ke){!(function(g){var p,c=g.services||(g.services={}),n=jsCommon.EnumExtensions,B=ke.data.Selector,R=ke.explore.util.VisualContainerUtils,e=(p=c.VisualContainerMenuCommand,__extends(t,p),t.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=N(this.visualContainer.name,this.contextActivityService,"DrillDown",this.source),_.isEmpty(this.selectors))?(t.reject(),[2]):(this.dataSources,this.visualAuthoring,[4,this.visualAuthoring.drillDown(this.selectors,this.visualContainer,this.dataSources.get(),_.head(this.roles))]);case 1:return e.sent()?t.resolve():t.reject(),[2]}}))}))},t.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,p.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:(r=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),i=n.hasFlag(r,4),r=n.hasFlag(r,2),[2,i||r])}}))}))},t.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,p.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},t);function t(e,t,i,r,n,a,o,s,l,u,c){u=p.call(this,u||"DrillDown",t,"pbi-glyph-drilldowndisabled",c&&c.drill)||this;return u.visualContainer=e,u.roles=i,u.dataSources=r,u.drill=n,u.visualAuthoring=a,u.runningVisual=o,u.contextActivityService=s,u.source=l,u}c.DrillDownCommand=e,h=c.VisualContainerMenuCommand,__extends(i,h),i.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return this.visualAuthoring,t=N(this.visualContainer.name,this.contextActivityService,"DrillUp",this.source),this.visualAuthoring.drillUp(_.head(this.roles),this.visualContainer),t.resolve(),[2]}))}))},i.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,h.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,n.hasFlag(t,1)]):[2,!1]}}))}))},i.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,h.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var h,e=i;function i(e,t,i,r,n,a,o,s,l,u){l=h.call(this,l||"DrillUp",void 0,"pbi-glyph-drillup",u&&u.drill)||this;return l.visualContainer=e,l.roles=i,l.drill=r,l.visualAuthoring=n,l.runningVisual=a,l.contextActivityService=o,l.source=s,l}c.DrillUpCommand=i,u=c.VisualContainerMenuCommand,__extends(r,u),r.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return this.visualAuthoring,t=N(this.visualContainer.name,this.contextActivityService,"DrillDownLevel"===this.defaultTitleKey?"DrillDownLevelUngrouped":"DrillDownLevelGrouped",this.source),this.visualAuthoring.drillDownLevel(_.head(this.roles),this.visualContainer,this.drillDirection),t.resolve(),[2]}))}))},r.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,u.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var u,l,e=r;function r(e,t,i,r,n,a,o,s,l){e=u.call(this,e,void 0,void 0,l&&l.drill)||this;return e.visualContainer=t,e.roles=i,e.drillDirection=r,e.visualAuthoring=n,e.runningVisual=a,e.contextActivityService=o,e.source=s,e}function a(e,t,i,r,n,a,o,s){e=l.call(this,"DrillDownLevel",e,t,3,i,n,a,o,s)||this;return e.drill=r,e.runningVisual=n,e}c.DrillDownLevelCommand=e,__extends(a,l=e),a.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,l.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,n.hasFlag(t,4)]):[2,!1]}}))}))},a.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,l.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},c.DrillDownLevelWithoutCurrentGroupCommand=a,__extends(o,d=e),o.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,d.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,n.hasFlag(t,2)]):[2,!1]}}))}))},o.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,d.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var d;function o(e,t,i,r,n,a,o,s){e=d.call(this,"DrillDownLevelGrouped",e,t,2,i,n,a,o,s)||this;return e.drill=r,e.runningVisual=n,e}c.DrillDownLevelWithCurrentGroupCommand=o,v=c.VisualContainerMenuCommand,__extends(s,v),s.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){return t=N(this.visualContainer.name,this.contextActivityService,"DrillToDetails",this.source),_.isEmpty(this.selectors)?t.reject():(this.dataSources,this.drillToDetails,i=this.dataSources.get(),this.drillToDetails.drillToDetails(this.selectors,this.visualContainer,i),t.resolve()),[2]}))}))},s.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,v.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:[2,this.drill.canDrillToDetails(this.visualContainer,this.selectors)]}}))}))},s.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,v.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var v,e=s;function s(e,t,i,r,n,a,o,s,l){t=v.call(this,"DataPointTable_Show",t,void 0,l&&l.drill)||this;return t.visualContainer=e,t.drill=i,t.dataSources=r,t.drillToDetails=n,t.runningVisual=a,t.contextActivityService=o,t.source=s,t}c.DrillToDetailsCommand=s,m=c.VisualContainerMenuCommand,__extends(y,m),y.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.isCollapse?[4,m.prototype.isDisabled.call(this)]:[3,2];case 1:return[2,e.sent()||!(this.allowedActions.collapseHierarchy||this.allowedActions.collapseLevel||this.allowedActions.collapseNode)];case 2:return[4,m.prototype.isDisabled.call(this)];case 3:return[2,e.sent()||!(this.allowedActions.expandHierarchy||this.allowedActions.expandLevel||this.allowedActions.expandNode)]}}))}))},y.prototype.getChildren=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))};var m;function y(e,t,i,r,n,a,o,s,l,u){r=m.call(this,i?"Collapse":"Expand",r,void 0,u&&u.expandCollapse)||this;return r.allowedActions=t,r.isCollapse=i,r.roles=n,r.nodeIndex=a,r.childCommands=[new k(e,r.isCollapse,r.allowedActions,r.selectors,r.roles,r.nodeIndex,o,s,l,u),new X(e,r.isCollapse,r.allowedActions,r.selectors,r.roles,r.nodeIndex,o,s,l,u),new j(e,r.isCollapse,r.allowedActions,r.selectors,r.roles,r.nodeIndex,o,s,l,u)],r}c.ExpandCollapseCommandsCollection=y,f=c.VisualContainerMenuCommand,__extends(C,f),C.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetNodeExpansionState,t=N(this.visualContainer.name,this.contextActivityService,"ExpandCollapseNode",this.source),this.handlers.onSetNodeExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),t.resolve(),[2]}))}))},C.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,f.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||(this.isCollapse?!this.allowedActions.collapseNode:!this.allowedActions.expandNode)]}}))}))};var f,k=C;function C(e,t,i,r,n,a,o,s,l,u){r=f.call(this,"ExpandCollapseNode",r,void 0,u&&u.expandCollapse)||this;return r.visualContainer=e,r.isCollapse=t,r.allowedActions=i,r.roles=n,r.nodeIndex=a,r.handlers=o,r.contextActivityService=s,r.source=l,r}c.ExpandCollapseNodeCommand=k,S=c.VisualContainerMenuCommand,__extends(H,S),H.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetLevelExpansionState,t=N(this.visualContainer.name,this.contextActivityService,"ExpandCollapseLevel",this.source),this.handlers.onSetLevelExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),t.resolve(),[2]}))}))},H.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,S.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.isCollapse?!this.allowedActions.collapseLevel:!this.allowedActions.expandLevel]}}))}))};var S,X=H;function H(e,t,i,r,n,a,o,s,l,u){r=S.call(this,"ExpandCollapseLevel",r,void 0,u&&u.expandCollapse)||this;return r.visualContainer=e,r.isCollapse=t,r.allowedActions=i,r.roles=n,r.nodeIndex=a,r.handlers=o,r.contextActivityService=s,r.source=l,r}c.ExpandCollapseLevelCommand=X,G=c.VisualContainerMenuCommand,__extends(U,G),U.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetHierarchyExpansionState,t=N(this.visualContainer.name,this.contextActivityService,"ExpandCollapseHierarchy",this.source),this.handlers.onSetHierarchyExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),t.resolve(),[2]}))}))},U.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,G.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.isCollapse?!this.allowedActions.collapseHierarchy:!this.allowedActions.expandHierarchy]}}))}))};var G,j=U;function U(e,t,i,r,n,a,o,s,l,u){r=G.call(this,"All",r,void 0,u&&u.expandCollapse)||this;return r.visualContainer=e,r.isCollapse=t,r.allowedActions=i,r.roles=n,r.nodeIndex=a,r.handlers=o,r.contextActivityService=s,r.source=l,r}c.ExpandCollapseHierarchyCommand=j,b=c.VisualContainerMenuCommand,__extends(E,b),E.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=!(this.explorationSettings&&this.explorationSettings.useStylableVisualContainerHeader))?[3,2]:[4,b.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:[2,1===this.viewModeState.getMode()]}}))}))},E.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=g.contracts.isVisualContainerGroup(this.container)||!!this.container.parentGroup,(t=!c.selectionUtils.hasMultipleVisualContainerSelection(this.selection)&&!t)?[3,2]:[4,b.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},E.prototype.getChildren=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))};var b,e=E;function E(e,t,i,r,n,a){var o=b.call(this,"Group_Action",void 0,void 0,a&&a.groupVisualContainers)||this;return o.container=e,o.selection=t,o.viewModeState=r,o.explorationSettings=n,o.childCommands=[new W(o.selection,i,a),new J(o.container,i,a),new q(o.selection,i,a)],o}c.VisualContainerGroupingCommandsCollection=E,z=c.VisualContainerMenuCommand,__extends(Q,z),Q.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return this.layoutAuthoring.groupCanvasItems(c.selectionUtils.getSelectedCanvasItems(this.selection)),[2]}))}))},Q.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=!1,1<(r=c.selectionUtils.getSelectedCanvasItems(this.selection)).length&&(i=r[0].parentGroup,t=_.every(r,(function(e){return e.parentGroup===i})),r=g.util.CanvasVisualsUtility.getContainerGroupDepth(r),t=t&&r<g.constants.MaxGroupingDepth),(r=!t)?[3,2]:[4,z.prototype.isDisabled.call(this)];case 1:r=e.sent(),e.label=2;case 2:return[2,r]}}))}))};var z,W=Q;function Q(e,t,i){i=z.call(this,"Group_Action",void 0,void 0,i&&i.groupVisualContainers)||this;return i.selection=e,i.layoutAuthoring=t,i}c.GroupVisualContainerCommand=W,K=c.VisualContainerMenuCommand,__extends($,K),$.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return this.layoutAuthoring.mergeCanvasItemContainers(c.selectionUtils.getSelectedCanvasItems(this.selection)),[2]}))}))},$.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=this.layoutAuthoring.canMergeCanvasItems(),(t=!t)?[3,2]:[4,K.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var K,q=$;function $(e,t,i){i=K.call(this,"Merge",void 0,void 0,i&&i.groupVisualContainers)||this;return i.selection=e,i.layoutAuthoring=t,i}c.MergeVisualContainerGroupCommand=q,Z=c.VisualContainerMenuCommand,__extends(Y,Z),Y.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return(t=g.contracts.isVisualContainerGroup(this.container)?this.container:this.container.parentGroup)&&this.layoutAuthoring.ungroupCanvasItems(t),[2]}))}))},Y.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=g.contracts.isVisualContainerGroup(this.container)||!!this.container.parentGroup,[4,Z.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||!t]}}))}))};var Z,J=Y;function Y(e,t,i){i=Z.call(this,"Ungroup",void 0,void 0,i&&i.groupVisualContainers)||this;return i.container=e,i.layoutAuthoring=t,i}c.UngroupVisualContainerCommand=J,ee=c.VisualContainerMenuCommand,__extends(V,ee),V.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i,r,n;return __generator(this,(function(e){return g.contracts.isVisualContainer(this.itemContainer)&&(t=N(this.itemContainer.name,this.contextActivityService,"SummarizeVisualContainer",this.source)),i=this.getSelectedSummarizableVisuals(),r=this.explorationNavigation.getCurrentExploreCanvas(),n=this.explorationNavigation.getAllSections(),this.visualAuthoring.addVisualContainerTextbox(n,r,void 0,!0,i),null!=t&&t.resolve(),[2]}))}))},V.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2,_.isEmpty(this.getSelectedSummarizableVisuals())]}))}))},V.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,ee.prototype.isVisible.call(this)];case 1:return[2,e.sent()&&1===this.viewModeState.getMode()]}}))}))},V.prototype.getSelectedSummarizableVisuals=function(){var i=this,e=c.selectionUtils.getSelectedVisualContainers(this.selection);return _.filter(e,(function(e){var t=i.runningVisualService.getVisual(e);return!!_.isEmpty(t&&t.getErrorInfo())&&i.pluginOps.canSummarizeVisual(g.util.VisualContainerUtils.getVisualType(e))&&!R.isSmallMultiplesVisual(e.config.singleVisual)}))};var ee;function V(e,t,i,r,n,a,o,s,l,u){o=ee.call(this,"Summarize",void 0,void 0,o&&o.summarize)||this;return o.itemContainer=e,o.explorationNavigation=t,o.pluginOps=i,o.selection=r,o.visualAuthoring=n,o.viewModeState=a,o.runningVisualService=s,o.contextActivityService=l,o.source=u,o}c.SummarizeVisualContainerCommand=V,te=c.VisualContainerMenuCommand,__extends(x,te),x.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){return this.visibility,t=N(this.visualContainer.name,this.contextActivityService,"SeeData",this.source),i=2,this.viewModeState&&this.viewModeState.getConfig().displayOptions.showVisualAccessibleData&&(i=8),this.visibility.set(this.visualContainer,i),t.resolve(),[2]}))}))},x.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,te.prototype.isVisible.call(this)];case 1:return e.sent()?[2,this.visualContainer&&2!==this.visualContainer.visibility&&this.drill.canSeeData(this.visualContainer)&&!this.pluginOps.isAnalysisVisual(g.util.VisualContainerUtils.getVisualType(this.visualContainer))]:[2,!1]}}))}))};var te,e=x;function x(e,t,i,r,n,a,o,s,l){o=te.call(this,"VisualTable_Show",void 0,(o=void 0===o?!1:o)?"itemIcon glyphicon pbi-glyph-seedata glyph-small":void 0,l&&l.seeData)||this;return o.visualContainer=e,o.drill=t,o.visibility=i,o.pluginOps=r,o.contextActivityService=n,o.source=a,o.viewModeState=s,o}c.SeeDataCommand=x,ie=c.VisualContainerMenuCommand,__extends(re,ie),re.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:if(this.pendingGroupOperation)return[2];this.pendingGroupOperation=!0,this.dataSources,this.conceptualSchemaProxy,t=this.dataSources.get(),e.label=1;case 1:return e.trys.push([1,,4,5]),[4,this.conceptualSchemaProxy.get(t)];case 2:return i=e.sent(),this.groupAuthoring,[4,this.groupAuthoring.visual.group(this.visualContainer,this.selectors,!0,t,i)];case 3:return e.sent(),[3,5];case 4:return this.pendingGroupOperation=!1,[7];case 5:return[2]}}))}))},re.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return(t=!this.featureSwitchService.featureSwitches.enableGroupAuthoring)?[3,2]:[4,ie.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:(i=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(i)]:[2,!1];case 3:return i=e.sent(),r=i.schema(void 0),r=!1!==(r&&r.capabilities&&r.capabilities.supportsGrouping),r=r&&this.groupAuthoring.visual.canGroup(this.visualContainer,this.selectors,i),[2,this.promiseFactory.resolve(r)]}}))}))};var ie;function re(e,t,i,r,n,a,o,s){t=ie.call(this,"Group_Data_Action",t,void 0,s&&s.createGroup)||this;return t.visualContainer=e,t.conceptualSchemaProxy=i,t.dataSources=r,t.featureSwitchService=n,t.groupAuthoring=a,t.promiseFactory=o,t}c.CreateGroupCommand=re,ne=c.VisualContainerMenuCommand,__extends(ae,ne),ae.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return this.includeExcludeService,t=N(this.visualContainer.name,this.contextActivityService,3===this.filterCreationKind?"Include":"Exclude",this.source),this.includeExcludeService.setFilter(this.filterCreationKind,this.selectors,this.visualContainer,this.dataView),t.resolve(),[2]}))}))},ae.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,ne.prototype.isVisible.call(this)];case 1:return e.sent()?B.hasIdentities(this.selectors)&&(t=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(t)]:[2,this.promiseFactory.resolve(!1)]:[2,this.promiseFactory.resolve(!1)];case 2:return t=e.sent(),null!=this.selectors[0].dataMap?(i=this.includeExcludeService.isIncludeExcludeSupported(this.visualContainer,t,this.selectors),[2,this.promiseFactory.resolve(i)]):[2,this.promiseFactory.resolve(!1)]}}))}))};var ne,e=ae;function ae(e,t,i,r,n,a,o,s,l,u,c,p){e=ne.call(this,e,i,void 0,p&&p.includeExclude)||this;return e.visualContainer=t,e.filterCreationKind=r,e.conceptualSchemaProxy=n,e.dataSources=a,e.includeExcludeService=o,e.promiseFactory=s,e.dataView=l,e.contextActivityService=u,e.source=c,e}c.IncludeExcludeCommand=e,__extends(se,oe=e);var oe;function se(e,t,i,r,n,a,o,s,l,u,c){return oe.call(this,"VisualContainer_ContextMenu_Include",e,t,3,i,r,a,o,u,s,l,c)||this}c.IncludeCommand=se,__extends(ue,le=e),ue.prototype.isDisabled=function(){var a,o;return __awaiter(this,void 0,ke.Promise,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:if(t=null==(a=null==(a=this.dataView)?void 0:a.metadata)?void 0:a.columns)for(i=0,r=t;i<r.length;i++)if(n=r[i],1===(null==(o=null==n?void 0:n.parameter)?void 0:o.kind))return[2,this.promiseFactory.resolve(!0)];return[4,le.prototype.isDisabled.call(this)];case 1:return[2,e.sent()]}}))}))},ue.prototype.getToolTip=function(t){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isDisabled()];case 1:return e.sent()?[2,this.promiseFactory.resolve(t.get("DQP_Disabled_Operator"))]:[2,this.promiseFactory.resolve(t.get("VisualContainer_ContextMenu_Exclude"))]}}))}))};var le;function ue(e,t,i,r,n,a,o,s,l,u,c){return le.call(this,"VisualContainer_ContextMenu_Exclude",e,t,4,i,r,a,o,u,s,l,c)||this}c.ExcludeCommand=ue,ce=c.VisualContainerMenuCommand,__extends(w,ce),w.prototype.isVisible=function(){var i;return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,ce.prototype.isVisible.call(this)];case 1:return e.sent()?null!=(i=this.runningVisual)&&i.getSelectedDatapoints&&(t=null==(i=this.runningVisual)?void 0:i.getSelectedDatapoints())?[2,!_.isEmpty(t)]:[2,!1]:[2,!1]}}))}))},w.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return t=N(this.visualContainer.name,this.contextActivityService,"ClearSelection",this.source),this.runningVisual.clearSelectedDatapoints(),t.resolve(),[2]}))}))};var ce,e=w;function w(e,t,i,r,n){n=ce.call(this,"Slicer_Clear",void 0,void 0,n&&n.clearSelection)||this;return n.visualContainer=e,n.runningVisual=t,n.contextActivityService=i,n.source=r,n}c.ClearSelectionCommand=w,pe=c.VisualContainerMenuCommand,__extends(de,pe),de.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return this.telemetryService.logEvent(ke.telemetry.CopyVisualImageEntryPoint,{visualType:this.viewModel.name,hasMetadata:this.hasMetadata,entryPoint:"ContextMenu"}),this.eventBridge.publishToChannel(ke.explore.services.events.copyVisualAsImage,{visual:this.viewModel,hasMetadata:this.hasMetadata,useModernClipboard:this.useModernClipboard}),[2]}))}))};var pe,he=de;function de(e,t,i,r,n,a,o){e=pe.call(this,e,void 0,void 0,o&&o.copy)||this;return e.viewModel=t,e.eventBridge=i,e.hasMetadata=r,e.useModernClipboard=n,e.telemetryService=a,e}c.CopyImageCommand=he,ve=c.VisualContainerMenuCommand,__extends(ge,ve),Object.defineProperty(ge.prototype,"commandsCount",{get:function(){return this.childCommands.length},enumerable:!1,configurable:!0}),ge.prototype.getChildren=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))};var ve;function ge(e,t,i,r,n,a,o,s,l,u,c,p,h,d,v){v=ve.call(this,"Copy",void 0,void 0,v&&v.copy)||this;return v.visualContainer=e,v.clipboard=t,v.featureSwitchService=i,v.copyVisualImageService=r,v.telemetryService=n,v.visualContainerCopyService=a,v.explorationCapabilities=o,v.explorationNavigation=s,v.visibility=l,v.viewModeState=u,v.args=c,v.eventBridge=p,v.contextActivityService=h,v.source=d,v.childCommands=[],v.copyPasteService=ke.CopyPasteService.create(),c.copyArgs&&(c.copyArgs.singleValue||c.copyArgs.grid)&&(v.childCommands.push(new ye("Visual_CopyValue",v.visualContainer.contract,v.copyPasteService,v.telemetryService,v.args.copyArgs.singleValue,v.contextActivityService,v.source)),v.childCommands.push(new Se("Visual_CopySelection",v.visualContainer.contract,v.copyPasteService,v.telemetryService,v.args.copyArgs.grid,v.contextActivityService,v.source))),v.visibility.get()||0!==v.viewModeState.getMode()&&v.childCommands.push(new Ve(v.visualContainer.contract,"Visual_CopyVisual",v.clipboard,v.contextActivityService,v.source)),(v.featureSwitchService.featureSwitches.copyPasteMenuImage||v.featureSwitchService.featureSwitches.copyPasteMenuMetadata)&&null!=v.explorationNavigation.getCurrentExploration().reportId&&(t=g.util.VisualContainerUtils.getVisualType(e.contract),v.copyVisualImageService.canCopy(t)&&v.visualContainerCopyService.showCopyVisualImageOption(e,v.visualContainerCopyService.getActiveSection(),"ContextMenu")&&(v.featureSwitchService.featureSwitches.copyPasteMenuImage&&v.childCommands.push(new he("Image",v.visualContainer,v.eventBridge,!1,v.explorationCapabilities.getCapabilities().useModernClipboard,v.telemetryService)),v.featureSwitchService.featureSwitches.copyPasteMenuMetadata&&v.childCommands.push(new he("Image_WithCaption",v.visualContainer,v.eventBridge,!0,v.explorationCapabilities.getCapabilities().useModernClipboard,v.telemetryService)))),v}c.CopyCommandsCollection=ge,me=c.VisualContainerMenuCommand,__extends(fe,me),fe.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,me.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||null===this.valueCallback||!("string"==typeof this.valueCallback||"function"==typeof this.valueCallback)]}}))}))},fe.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){return t=N(this.visualContainer.name,this.contextActivityService,"CopyValue",this.source),i=g.util.VisualContainerUtils.getVisualType(this.visualContainer),this.copyPasteService.copyText(this.valueCallback,this.telemetryService,i),t.resolve(),[2]}))}))};var me,ye=fe;function fe(e,t,i,r,n,a,o,s){e=me.call(this,e,void 0,void 0,s&&s.copy)||this;return e.visualContainer=t,e.copyPasteService=i,e.telemetryService=r,e.valueCallback=n,e.contextActivityService=a,e.source=o,e}c.CopyValueCommand=ye,Ce=c.VisualContainerMenuCommand,__extends(be,Ce),be.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,Ce.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||null===this.valueCallback||"function"!=typeof this.valueCallback]}}))}))},be.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){return t=N(this.visualContainer.name,this.contextActivityService,"CopySelection",this.source),i=g.util.VisualContainerUtils.getVisualType(this.visualContainer),this.copyPasteService.copyGrid(this.valueCallback,this.telemetryService,i),t.resolve(),[2]}))}))};var Ce,Se=be;function be(e,t,i,r,n,a,o,s){e=Ce.call(this,e,void 0,void 0,s&&s.copy)||this;return e.visualContainer=t,e.copyPasteService=i,e.telemetryService=r,e.valueCallback=n,e.contextActivityService=a,e.source=o,e}c.CopySelectionCommand=Se,Ee=c.VisualContainerMenuCommand,__extends(xe,Ee),xe.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){return t=N(this.visualContainer.name,this.contextActivityService,"CopyVisual",this.source),this.clipboard.copy(),t.resolve(),[2]}))}))};var Ee,Ve=xe;function xe(e,t,i,r,n,a){t=Ee.call(this,t,void 0,void 0,a&&a.copy)||this;return t.visualContainer=e,t.clipboard=i,t.contextActivityService=r,t.source=n,t}c.CopyVisualCommand=Ve,P=c.VisualContainerMenuCommand,__extends(F,P),F.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},F.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return[4,P.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.dataSources.get())&&(i=this.explorationCapabilities.getCapabilities())&&i.insights?[4,this.lazyScoped("userEmulationService")]:[2,!1]:[2,!1];case 2:return e.sent().getState()?[2,!1]:[4,this.conceptualSchemaProxy.get(t)];case 3:return i=e.sent(),[4,this.getAnalysisOptions(i)];case 4:return r=e.sent(),[2,!_.isEmpty(r)]}}))}))},F.prototype.isDisabled=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return R.isSmallMultiplesVisual(this.visualContainer.config.singleVisual)?[2,!0]:[2,P.prototype.isDisabled.call(this)]}))}))},F.prototype.getChildren=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i,r,n,a,o;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(t)]:[2,void 0];case 1:return t=e.sent(),[4,this.getAnalysisOptions(t)];case 2:if(i=e.sent(),_.isEmpty(i))return[2,null];for(r=[],n=0,a=i;n<a.length;n++)o=a[n],o=new Pe(this.selectors,this.visualContainer,this.position,o,this.dataSources,this.eventBridge,this.explorationNavigation,this.viewModeState,this.lazyScoped,this.contextActivityService,this.source,this.displayOverride),r.push(o);return[2,r]}}))}))},F.prototype.getAnalysisOptions=function(r){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.lazyScoped("insightsAnalysisModern")];case 1:return t=e.sent(),[4,this.queryHandler.getCachedQueryOrGenerate({contract:this.visualContainer})];case 2:return null==(i=e.sent())?[2]:[2,t.getOptions(this.visualContainer,i.filterContext,this.selectors,r,this.analysisType)]}}))}))};var P,e=F;function F(e,t,i,r,n,a,o,s,l,u,c,p,h,d,v){t=P.call(this,"VisualContainer_ContextMenu_Analyze",t,void 0,null==v?void 0:v.insightsAnalysis)||this;return t.visualContainer=e,t.position=i,t.conceptualSchemaProxy=r,t.dataSources=n,t.eventBridge=a,t.explorationCapabilities=o,t.explorationNavigation=s,t.lazyScoped=l,t.viewModeState=u,t.queryHandler=c,t.analysisType=p,t.contextActivityService=h,t.source=d,t.displayOverride=v,t}c.InsightsAnalysisCommandsCollection=F,we=c.VisualContainerMenuCommand,__extends(A,we),A.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return this.insightsAnalysisData,this.explorationNavigation,this.dataSources,this.viewModeState,this.eventBridge,t=N(this.visualContainer.name,this.contextActivityService,"Analyze",this.source),[4,this.lazyScoped("insightsLauncher")];case 1:return(i=e.sent(),this.insightsAnalysisData.useInsightsPane)?[4,i.showInsightsFor(this.insightsAnalysisData)]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,i.launch(this.insightsAnalysisData,this.position)];case 4:e.sent(),e.label=5;case 5:return t.resolve(),[2]}}))}))},A.prototype.title=function(e){return e&&this.defaultTitleKey?e.get(this.defaultTitleKey):this.insightsAnalysisData.question},A.prototype.getChildren=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2,null]}))}))};var we,Pe=A;function A(e,t,i,r,n,a,o,s,l,u,c,p){e=we.call(this,null,e,void 0,p&&p.insightsAnalysis)||this;return e.visualContainer=t,e.position=i,e.insightsAnalysisData=r,e.dataSources=n,e.eventBridge=a,e.explorationNavigation=o,e.viewModeState=s,e.lazyScoped=l,e.contextActivityService=u,e.source=c,e}c.InsightsAnalysisCommand=Pe,Fe=c.VisualContainerMenuCommand,__extends(T,Fe),T.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},T.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,Fe.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:this.drill.canDrillthrough(this.visualContainer)?(this.children,[4,(i=this).getChildren()]):[3,4];case 3:return i.children=e.sent(),[2,!_.isEmpty(this.children)];case 4:return[2,!1]}}))}))},T.prototype.getChildren=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i,r,n,a=this;return __generator(this,(function(e){switch(e.label){case 0:return void 0!==this.children?[2,this.children]:(t=this.drillthroughEntryPoint,i=this.explorationNavigation.getCurrentSection(),n=g.util.VisualContainerUtils.getVisualType(this.visualContainer),_.isEmpty(this.selectors)||_.isEmpty(i.name)||!this.pluginOps.isQueryVisual(n)?[2,[]]:[4,this.queryHandler.getCachedQueryOrGenerate({contract:this.visualContainer})]);case 1:return null==(r=e.sent())?[2]:[4,this.lazyScoped("drillthrough")];case 2:return[4,e.sent().getDrillthroughActions(i.name,this.visualContainer,this.selectors,r.filterContext)];case 3:return n=e.sent(),[2,_.map(n,(function(e){return new _e(a.visualContainer,e,t,a.lazyScoped,a.telemetryService,a.contextActivityService,a.source,a.displayOverride)}))]}}))}))};var Fe;function T(e,t,i,r,n,a,o,s,l,u,c,p,h){p=Fe.call(this,p||"Drillthrough",t,"pbi-glyph-drillthrough",h&&h.drillthrough)||this;return p.visualContainer=e,p.drillthroughEntryPoint=i,p.drill=r,p.explorationNavigation=n,p.lazyScoped=a,p.pluginOps=o,p.queryHandler=s,p.telemetryService=l,p.contextActivityService=u,p.source=c,p.displayOverride=h,p}c.DrillthroughCommandCollection=T,Ae=c.VisualContainerMenuCommand,__extends(Te,Ae),Te.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.drillthroughActionData,this.drillthroughEntryPoint,this.lazyScoped,this.telemetryService,t=N(this.visualContainer.name,this.contextActivityService,"DrillThrough",this.source),[4,this.lazyScoped("drillthrough")];case 1:return e.sent().applyDrillthroughState(this.drillthroughActionData,!0),t.resolve(),this.telemetryService.logEvent(ke.telemetry.EXDrillthroughGotoTarget,{entryPoint:this.drillthroughEntryPoint,toExternalReport:!!this.drillthroughActionData.targetReportGuid}),[2]}}))}))},Te.prototype.title=function(e){return this.drillthroughActionData.reportDisplayName?this.drillthroughActionData.sectionDisplayName+" ["+this.drillthroughActionData.reportDisplayName+"]":this.drillthroughActionData.sectionDisplayName};var Ae,_e=Te;function Te(e,t,i,r,n,a,o,s){s=Ae.call(this,"Drillthrough",void 0,void 0,s&&s.drillthrough)||this;return s.visualContainer=e,s.drillthroughActionData=t,s.drillthroughEntryPoint=i,s.lazyScoped=r,s.telemetryService=n,s.contextActivityService=a,s.source=o,s}c.DrillthroughCommand=_e,De=c.VisualContainerMenuCommand,__extends(D,De),D.prototype.title=function(e){return this.groupTitle},D.prototype.getChildren=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2,this.children]}))}))},D.prototype.addChild=function(e){this.children.push(e)},Object.defineProperty(D.prototype,"isEmpty",{get:function(){return 0===this.children.length},enumerable:!1,configurable:!0}),D.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2,De.prototype.isVisible&&!this.isEmpty]}))}))};var De,e=D;function D(e,t,i){t=De.call(this,null,void 0,void 0,t&&t.extensions)||this;return t.groupTitle=e,t.menuLocation=i,t.children=[],t}c.ExtensionCommandsGroup=D,Me=c.VisualContainerMenuCommand,__extends(M,Me),M.prototype.title=function(e){return this.commandTitle},M.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){return t=N(this.visualContainer.name,this.contextActivityService,"ExtensionCommand",this.source),i=this.getDataPointsDescriptions(),this.explorationExtensibilityService.executeCustomCommand(this.eventBridge,this.visualContainer,this.commandName,i),t.resolve(),[2]}))}))},M.prototype.getDataPointsDescriptions=function(){var e=[];if(this.visualContainerDataSelectionService&&!_.isEmpty(this.selectors))for(var t=0,i=this.selectors;t<i.length;t++){var r=i[t],n=this.visualContainerDataSelectionService.getSelectedValues(r,this.featureSwitchService.featureSwitches.dataPointLassoSelect);e.push({selector:r,values:n})}return e};var Me;function M(e,t,i,r,n,a,o,s,l,u,c,p){t=Me.call(this,null,t,void 0,p&&p.extensions,void 0,u)||this;return t.visualContainer=e,t.commandName=i,t.commandTitle=r,t.eventBridge=n,t.explorationExtensibilityService=a,t.featureSwitchService=o,t.contextActivityService=s,t.source=l,t.visualContainerDataSelectionService=c,t}c.ExtensionCommand=M,Ie=c.VisualContainerMenuCommand,__extends(I,Ie),I.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,Ie.prototype.isVisible.call(this)];case 1:return[2,e.sent()&&this.featureSwitchService.featureSwitches.onObject&&1===this.viewModeState.getMode()]}}))}))},I.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return this.viewModeState.setFormatMode(!0,"Context Menu"),this.panesVisibilityService.isPaneVisible(1)||this.panesVisibilityService.togglePaneVisibility(1),[2]}))}))};var Ie,e=I;function I(e,t,i,r){r=Ie.call(this,"Format",void 0,void 0,r&&r.turnOnFormatMode)||this;return r.viewModeState=e,r.featureSwitchService=t,r.panesVisibilityService=i,r}c.TurnOnFormatModeCommand=I,Oe=c.VisualContainerMenuCommand,__extends(O,Oe),O.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t,i;return __generator(this,(function(e){return this.getRoleWithMeasure()&&(t=N(this.visualContainer.name,this.contextActivityService,"CreateVisualCalculation",this.source),i={mode:0},this.eventBridge.publishToChannel(c.events.editVisualCalculation,i),t.resolve()),[2]}))}))},O.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.featureSwitchService.featureSwitches.visualCalculationsAuthoring&&this.featureSwitchService.featureSwitches.visualCalculations?[4,Oe.prototype.isVisible.call(this)]:[2,!1];case 1:return e.sent()?!this.getRoleWithMeasure()||16===this.visualContainer.visibility?[2,!1]:[2,this.visualContainer&&this.drill.canSeeData(this.visualContainer)&&!this.pluginOps.isAnalysisVisual(g.util.VisualContainerUtils.getVisualType(this.visualContainer))]:[2,!1]}}))}))},O.prototype.getRoleWithMeasure=function(){var e=g.util.VisualContainerUtils.getVisualType(this.visualContainer),e=this.visualPlugin.capabilities(e);if(e)return _.find(e.dataRoles,(function(e){return[ke.VisualDataRoleKind.GroupingOrMeasure,ke.VisualDataRoleKind.Measure].includes(e.kind)}))};var Oe;function O(e,t,i,r,n,a,o,s,l){l=Oe.call(this,"Create_Visual_Calculation",void 0,void 0,l&&l.seeData)||this;return l.visualContainer=e,l.drill=t,l.pluginOps=i,l.contextActivityService=r,l.source=n,l.featureSwitchService=a,l.eventBridge=o,l.visualPlugin=s,l}function N(e,t,i,r){return t.createActivity({name:"VisualAction",visualName:e,data:{action:i,source:r}})}c.CreateVisualCalculationCommand=O,Ne=c.VisualContainerMenuCommand,__extends(Be,Ne),Be.prototype.execute=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return this.eventBridge.publishToChannel(c.events.shareVisual,{visual:this.visualContainer}),[2]}))}))},Be.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.explorationCapabilities.getCapabilities().allowShareVisual&&0===this.viewModeState.getMode())?[4,Ne.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var Ne,Le=Be;function Be(e,t,i,r,n){n=Ne.call(this,"Sharing_Visual_LinkToSelection",void 0,"pbi-glyph-link",n&&n.shareVisual)||this;return n.eventBridge=e,n.explorationCapabilities=t,n.viewModeState=i,n.visualContainer=r,n}c.VisualContainerShareVisualCommand=Le,Re=c.VisualContainerMenuCommand,__extends(L,Re),L.prototype.isVisible=function(){return __awaiter(this,void 0,ke.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.explorationCapabilities.getCapabilities().allowShareVisual&&0===this.viewModeState.getMode())?[4,Re.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},L.prototype.getChildren=function(){return __awaiter(this,void 0,ke.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))};var Re,e=L;function L(e,t,i,r,n,a,o,s,l){var u=Re.call(this,"Share",void 0,void 0,l&&l.shareVisual)||this;return u.explorationCapabilities=t,u.viewModeState=i,u.childCommands=[new Le(e,t,i,s.contract,l),new c.ShareToTeamsVisualCommand(s,r,e,n,a,o,l)],u}c.VisualContainerShareCommandsCollection=L})(ke.explore||(ke.explore={}))})(powerbi=powerbi||{}),(function(r){var e;(function(e){var i=r.common.utils.IdUtility;function t(e,t){this.moduleConfig={name:"ui.bootstrap",dependency:{javascript:"angular-ui-datetimepicker"}},this.services=t,this.id=i.generateId(),this.calendarButtonText=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_Calendar")}t.createOptions=function(){return{additionalServices:["overlayService","localizationService"]}},t.prototype.$onInit=function(){var t=this;this.ngModel.$render=function(){var e;_.isNumber(t.ngModel.$viewValue)?"Invalid Date"!==(e=new Date(t.ngModel.$viewValue)).toString()?t.ngModel.$setViewValue(e):t.ngModel.$setViewValue(void 0):void 0!==t.ngModel.$viewValue&&t.ngModel.$viewValue instanceof Date?t.inputInvalid||(t.dateVal=t.ngModel.$viewValue,t.textVal=t.ngModel.$viewValue.toLocaleDateString()+" "+t.ngModel.$viewValue.toLocaleTimeString()):(t.textVal=void 0,t.dateVal=void 0,t.inputInvalid=!1)}},t.prototype.$onChanges=function(e){e&&e.validators&&void 0!==this.textVal&&this.validateTextInput()},t.prototype.dateSelected=function(){this.inputInvalid=!1,this.textVal=this.dateVal.toLocaleDateString()+" "+this.dateVal.toLocaleTimeString(),this.ngModel.$setViewValue(this.dateVal),this.services.overlayService.hideAllDropdowns()},t.prototype.dateTextUpdated=function(){this.validateTextInput(),this.inputInvalid||this.ngModel.$setViewValue(this.dateVal)},t.prototype.validateTextInput=function(){var e;this.textVal?(e=new Date(this.textVal),this.inputInvalid="Invalid Date"===e.toString(),this.validators&&(this.inputInvalid=this.inputInvalid||e<this.validators.min||e>this.validators.max),this.inputInvalid||(this.dateVal=e)):(this.textVal=void 0,this.dateVal=void 0,this.inputInvalid=!1)},e.DateTimePickerController=t})((e=r.explore||(r.explore={})).controllers||(e.controllers={}))})(powerbi=powerbi||{}),(function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).DateTimePicker={templateUrl:"components/dateTimePicker/dateTimePicker.html",bindings:{placeholder:"<",validators:"<",labelId:"<"},require:{ngModel:"ngModel"},controller:e.common.createController(t.controllers.DateTimePickerController)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={})).FilterEvents||(e.FilterEvents={})).filterChanged={name:"filterChanged"},e.topNFilterOrderByUpdate={type:2,name:"topNFilterOrderByUpdate"}})(powerbi=powerbi||{}),(function(u){!(function(n){var e,r,a,o,s;function l(e,t){var i=r.call(this,e,{expanded:!1,canToggleSingleSelect:!1,availableTypes:[],type:e.type})||this;return i.isInvalidForMappedColumn=!1,i.id=l.counter++,i.restatement="",i.displayName="",i.containerScope=t,i.howCreated=0,i.isLinkedAsAggregation=!1,i.filterCapabilities=n.FilterUtils.getFilterCapabilities(e),i}e=n.viewModels||(n.viewModels={}),a=n.contracts.FilterType,o=u.data.SQExprUtils,s=u.explore.util.VisualContainerUtils,r=e.ViewModel,__extends(l,r),l.prototype.setServices=function(e,t,i){this.visualHostServices=e,this.visualPlugin=t,this.viewModeState=i},l.prototype.isInvalid=function(){return this.invalid},l.prototype.clearDQPWarning=function(){this.isInvalidForMappedColumn&&(this.invalid=!1,this.readOnlyState.invalid=!1,this.isInvalidForMappedColumn=!1)},l.prototype.isInvalidCardType=function(){return this.cardType&&this.cardType.invalid},Object.defineProperty(l.prototype,"isVisualFilter",{get:function(){return this.containerScope&&0===this.containerScope.scopeType},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"hasDefaultValue",{get:function(){return this.defaultValue&&(1===this.howCreated||5===this.howCreated)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isLinkField",{get:function(){return 5===this.howCreated&&!this.contract.isTransient},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canToggleLinkAsAggregation",{get:function(){return this.isLinkField&&!this.isMeasure},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canDeleteManually",{get:function(){return this.filterCapabilities.canDelete||!!this.readOnlyState.invalid},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canClearManually",{get:function(){return this.filterCapabilities.canClear},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"hasRestatement",{get:function(){return""!==this.restatement&&null!=this.restatement},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canHideManually",{get:function(){return this.filterCapabilities.canHide},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canLockManually",{get:function(){return this.filterCapabilities.canLock},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canRenameManually",{get:function(){return this.filterCapabilities.canRename},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canSortManually",{get:function(){return this.filterCapabilities.canSort},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canExpandManually",{get:function(){return this.filterCapabilities.canEdit&&n.FilterUtils.canExpandManually(this.contract.howCreated,this.contract.isTransient,this.contract.expression,!this.invalid)},enumerable:!1,configurable:!0}),l.prototype.getFilterContainerScope=function(){return this.containerScope},l.prototype.setRestatement=function(e){this.contract.type===this.readOnlyState.type&&(this.restatement=e)},l.prototype.clearRestatement=function(){this.restatement=""},l.prototype.getRestatement=function(){return this.restatement},l.prototype.updateFilterCardStyle=function(e,t){t&&(e=e&&e.evaluatedObjects,this.style=n.FilterUtils.getFilterCardStyle(e,!!this.contract.filter,t,this.filterCardStyleArguments))},Object.defineProperty(l.prototype,"checkboxAndApplyColor",{get:function(){return this.style&&this.style.checkboxAndApplyColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"borderColor",{get:function(){return this.style&&this.style.borderColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"backgroundColor",{get:function(){return this.style&&this.style.backgroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"foregroundColor",{get:function(){return this.style&&this.style.foregroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"inputBoxBorderColor",{get:function(){return this.style&&this.style.inputBoxBorderColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"inputBoxBackgroundColor",{get:function(){return this.style&&this.style.inputBoxBackgroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"inputBoxForegroundColor",{get:function(){return this.style&&this.style.inputBoxForegroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"fontSize",{get:function(){return this.style&&this.style.fontSize},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"fontFamily",{get:function(){return this.style&&this.style.fontFamily},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"visualContainer",{get:function(){if(this.isVisualFilter)return this.containerScope.container},enumerable:!1,configurable:!0}),l.prototype.isFilterLocked=function(){return this.contract.isLockedInViewMode},l.prototype.isFilterHidden=function(){return this.contract.isHiddenInViewMode},l.prototype.isFilterExpanded=function(){return this.readOnlyState.expanded},l.prototype.updateFilterProperties=function(e,t,i){this.contract.expression&&(r=this.contract.expression,this.isMeasure=o.isMeasure(r),this.discourageAggregation=o.discourageAggregation(r,e),this.valueType=n.FilterUtils.getValueType(r,e),this.formatter=n.FilterUtils.getFormatter(r,e),this.defaultValue=o.getDefaultValue(r,e),this.parameterMetadata=o.getConceptualParameterMetadata(r,e),5===this.howCreated&&!this.contract.isTransient||this.isMappedToMParameter()&&!this.supportsMultipleValues()?(this.isSingleSelectionRequired=!0,this.disableSelectionModeToggle=!0):this.contract.isTransient&&(this.isSingleSelectionRequired=!1,this.disableSelectionModeToggle=!0)),this.contract.objects&&(r=u.data.DataViewObjectDefinitions.getValue(this.contract.objects,{objectName:"general",propertyName:"isInvertedSelectionMode"},void 0),this.isInvertedSelectionMode=r&&r.value);var r=this.containerScope.container;this.hasGroupingScope=r&&s.hasGrouping(r,e),this.invalid=!_.isEmpty(n.FilterUtils.validate(this.contract,e,i)),this.invalid?this.isInvalidForMappedColumn=!1:(this.isInvalidForMappedColumn=this.hasInvalidFiltersForMParameters(this.contract,e),this.invalid=this.isInvalidForMappedColumn),this.disabled=n.FilterUtils.shouldDisableFilter(this.contract,e,r,i,t)},l.prototype.hasInvalidFiltersForMParameters=function(e,t){e=null==(e=null==e?void 0:e.filter)?void 0:e.conditions();if(e)for(var i=0,r=e;i<r.length;i++){var n=r[i];if(!o.checkExprForValidMParameters(n,t))return!0}return!1},l.prototype.switchType=function(e){this.readOnlyState.type=e},l.prototype.canVisualize=function(){var e=this.contract;return e.expression&&e.type!==a.Passthrough&&!this.isMeasure},l.prototype.updateViewStateCore=function(e){var t=this.contract,i=(e.type,!this.invalid),t=(e.disabled=this.disabled,e.expanded=!0===t.expanded&&i,e.invalid=!i,_.some(this.availableTypes,(function(e){return e.type===a.Categorical}))&&!e.visual&&t.config&&(i=t.config.singleVisual)&&this.visualHostServices&&this.visualPlugin&&(e.visual={viewport:l.DefaultVisualViewPort,type:u.visuals.plugins.filterSlicer.name,dataTransforms:{objects:i.objects},hostServices:this.visualHostServices,interactivityOptions:{dragDataPoint:!1,selection:!0},allowInvalidDataView:!0,visualPlugin:this.visualPlugin,themeCollection:{}}),5===this.howCreated&&!this.contract.isTransient);e.canToggleSingleSelect=!t&&!this.contract.isTransient&&!(e.disabled||!e.expanded||!e.visual||!e.visual.data)},l.prototype.updateAvailableTypes=function(e,t){void 0===t&&(t=u.common.getLocalize());var i,r=this.readOnlyState.type;r===a.Passthrough?this.availableTypes=[]:(i=[],!this.valueType||this.valueType.bool||this.isLinkField||i.push({type:a.Advanced,label:t.get("FilterPane_Advanced")}),this.isMeasure||(i.push({type:a.Categorical,label:t.get("FilterPane_Basic")}),this.valueType&&this.valueType.dateTime&&!this.isMappedToMParameter()&&(i.push({type:a.RelativeDate,label:t.get("FilterPane_RelativeDate")}),i.push({type:a.RelativeTime,label:t.get("FilterPane_RelativeTime")})),this.isVisualFilter&&!this.isMappedToMParameter()&&i.push({type:a.TopN,label:t.get("FilterPane_TopN")})),this.availableTypes=i,this.hiddenTypes=[],this.updateCardType(r,t))},l.prototype.updateCardType=function(t,e){void 0===e&&(e=u.common.getLocalize());var i=this.availableTypes;this.readOnlyState.type=t,this.cardType=_.find(i,(function(e){return e.type===t})),!this.cardType&&this.hiddenTypes&&0<this.hiddenTypes.length?(this.cardType=_.find(this.hiddenTypes,(function(e){return e.type===t})),this.availableTypes.push(this.cardType)):!this.cardType&&this.isMappedToMParameter()&&(this.cardType={type:a.Categorical,label:e.get("FilterPane_Basic")})},l.prototype.isSingleSelectDisabled=function(){return this.disableSelectionModeToggle||!this.viewModeState||0===this.viewModeState.getMode()},l.prototype.getDisplayName=function(){return this.contract.displayName||this.displayName},l.prototype.updateIsLinkedAsAggregation=function(e){this.isLinkedAsAggregation=e},l.prototype.getInputPlaceholder=function(){return this.viewModeState&&this.viewModeState.getConfig().displayOptions.enableMobileFilters?u.common.getLocalize().get("TypeHere"):""},l.prototype.isMappedToMParameter=function(){return this.parameterMetadata&&1===this.parameterMetadata.kind},l.prototype.supportsMultipleValues=function(){var e;return!(null==(e=this.parameterMetadata)||!e.supportsMultipleValues)},l.prototype.supportsSelectAll=function(){var e;return!(null==(e=this.parameterMetadata)||!e.supportsSelectAll)},l.DefaultVisualViewPort={width:146,height:180,scale:1},l.counter=0,e.FilterViewModel=l})(u.explore||(u.explore={}))})(powerbi=powerbi||{}),(function(y){var p,f,e,l,C,u,S,b,c;function h(e){var t,i;return e.filter&&((i=e.filter.conditions()).length,(i=i[0])&&(t=f.FilterCardConverter.createAdvFilter(i,null,e.expression))),t=!t&&e.expression?new f.AdvFilterCard(e.expression):t}function d(e,t,i,r,n,a,o){var s=u.asFieldPattern(e);return i.getDisplayName(e,t,r,n,0===o?a:void 0,{includeVariationSource:!0})||(s?l.getFieldExprName(s):void 0)}function v(e,t,i,r,n,a,o){i=i.getQualifiedDisplayName(e,t,n);return 5===o||6===o||2===o?i=r.format("FilterCard_Transient_Drill",[i]):7===o?i=r.format("FilterCard_Transient_URL",[i]):a&&(i=r.format("FilterCard_Transient",[i])),i}function g(e,t,i,r,n){i=new p.services.IncludeExcludeSQExprVisitor(i,r);if(!e.filter)return e.type?new f.FilterViewModel(e,t):void 0;var r=e.filter.conditions();if(!(_.isEmpty(r)||1<r.length))return r[0].accept(i),0<i.dataPoints.length?(e.type=i.isExclude?C.Exclude:C.Include,(r=new f.FilterViewModel(e,t)).displayName=p.FilterUtils.getDisplayNameForIncludeExcludeFilters(n,e.type,i.dataPoints.length),r):void 0}function m(e,i,t,r,n,a,o){null!=e.type&&(e.type,C.Passthrough),e.type,null==e.type&&(e.type=C.Passthrough);var s,l,u,c,p,h,d,v,g=new f.FilterViewModel(e,t),m=e.restatement;return m&&""!==m||!e.filter||(_.size(e.filter.where()),m=n.getFilterRestatement(e.filter,r,i,s={includeFieldNamesInFilter:!0}),g.tooltip=n.getQualifiedFilterRestatement(e.filter,r,i,s),_.isEmpty(m)&&(l=y.data.PassthroughFilterPattern.extractParametersFromFilter(e.filter),_.isEmpty(l)||(p=o.get("ListJoin_Separator"),h=v=d=void 0,a&&(u=a.columnProperties),c=l.fieldsBeingFiltered.map((function(e){var t=a&&a.query&&a.query.defn.selectNameOf(e);return n.getDisplayName(e,r,i,t,u)})).join(p),p=l.fieldsBeingFiltered.map((function(e){return n.getQualifiedDisplayName(e,r,i,s)})).join(p),l.isSubquery&&l.itemCount?(1===t.scopeType&&e.howCreated,t=b.format(l.itemCount),l.orderByField&&(e=a&&a.query&&a.query.defn.selectNameOf(l.orderByField),e=n.getDisplayName(l.orderByField,r,i,e,u),h=l.isTop?"FilterRestatement_TopNBy_Drillthrough":"FilterRestatement_BottomNBy_Drillthrough",d=[t,c,e],v=[t,p,e])):(d=[c],v=[p],h=l.isSubquery?"FilterRestatement_Subquery":"FilterRestatement_Columns"),m=S.format.apply(S,__spreadArray([o.get(h)],d||[])),g.tooltip=S.format.apply(S,__spreadArray([o.get(h)],v||[]))))),g.setRestatement(m),g}function E(e,t,i,r,n,a,o){var s,l,u,c=h(e);if(c)return e.expression||(e.expression=c.field),null!=e.type&&e.type!==C.Categorical&&e.type!==C.Visual&&(e.type,C.Advanced),e.type,null==e.type&&(e.filter?e.type=p.FilterUtils.getFilterType(c.field,c.supportsCategorical):(e.isTransient,e.type=p.FilterUtils.getDefaultFilterType(e.expression,r,e.howCreated))),null==e.type&&(e.type=C.Categorical),c=e.expression,s=new f.FilterViewModel(e,i),o&&(l=o.query&&o.query.defn.selectNameOf(c),u=o.columnProperties),s.displayName=d(c,r,n,t,l,u,i.scopeType),s.tooltip=v(c,r,n,a,t,e.isTransient,e.howCreated),s}function V(e,t,i,r,n,a,o){var s;if(0===i.scopeType&&5!==e.howCreated)return s=y.data.TopNFilterPattern.extractParametersFromFilter(e.filter),s&&w(e,C.TopN,s.fieldBeingFiltered),P(e,C.TopN,i,r,n,a,t,o)}function x(e,t,i,r,n,a,o,s,l){var u=f.RelativeFilterViewModelUtil.relativeFilterTypeToFilterType(e),e=y.data.RelativeDateFilterPattern.extractParametersFromSemanticFilter(t.filter,e);if(e){if(e.options&&e.options.anchorDate&&l)return;w(t,u,e.field)}return P(t,u,r,n,a,o,i,s)}function w(e,t,i){null!=e.type&&e.type,e.type,e.type=t,e.expression=i}function P(e,t,i,r,n,a,o,s){var l;if(e.type===t&&e.expression)return t=new f.FilterViewModel(e,i),l=s&&s.query?s.query.defn.selectNameOf(e.expression):void 0,s=s?s.columnProperties:void 0,t.displayName=d(e.expression,r,n,o,l,s,i.scopeType),t.tooltip=v(e.expression,r,n,a,o,e.isTransient,e.howCreated),t}p=y.explore||(y.explore={}),f=p.viewModels||(p.viewModels={}),l=y.data.FieldExprPattern,C=p.contracts.FilterType,u=y.data.SQExprConverter,S=jsCommon.StringExtensions,b=y.visuals.valueFormatter,c=y.data.RelativeFilterType,(e=f.FilterViewModelFactory||(f.FilterViewModelFactory={})).convertFilterContainer=function(e,t,i,r,n,a,o,s,l){var u;switch(e.expression||e.filter||e.type===C.Include||(e.type,C.Exclude),e.isTransient&&e.filter,e.type){case C.TopN:u=V(e,s,r,t,i,o,l);break;case C.Advanced:case C.Categorical:u=E(e,s,r,t,i,o,l);break;case C.RelativeTime:u=x(c.Time,e,s,r,t,i,o,l,!1);break;case C.RelativeDate:u=x(c.Date,e,s,r,t,i,o,l,!1);break;case C.Passthrough:u=m(e,s,r,t,i,l,o);break;case C.Include:case C.Exclude:u=g(e,r,t,i,o);break;default:u=V(e,s,r,t,i,o,l)||x(c.Time,e,s,r,t,i,o,l,!0)||x(c.Date,e,s,r,t,i,o,l,!0)||E(e,s,r,t,i,o,l)||g(e,r,t,i,o)||m(e,s,r,t,i,l,o)}return e.type,u.howCreated=e.howCreated,u.updateFilterProperties(t,n,a),u},e.extractAdvFilterCard=h})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={}),(t=e.PropertyCardNames||(e.PropertyCardNames={})).Background="background",t.Border="border",t.CategoryAxis="categoryAxis",t.ConditionalFormatting="conditionalFormatting",t.DataBars="dataBars",t.DataPoint="dataPoint",t.DropShadow="dropShadow",t.General="general",t.Gradient="gradient",t.Labels="labels",t.Legend="legend",t.LockAspect="lockAspect",t.PersonalizeVisual="personalizeVisual",t.StylePreset="stylePreset",t.Title="title",t.Totals="totals",t.ValueAxis="valueAxis",t.VisualHeader="visualHeader",t.VisualLink="visualLink",t.VisualTooltip="visualTooltip",t.VisualHeaderTooltip="visualHeaderTooltip",t.Zoom="zoom",t.CategoryLabels="categoryLabels",(t=e.PropertySliceNames||(e.PropertySliceNames={})).ApplyToAllPages="applyToAllPages",t.Color="color",t.FlagsSelection="flagsSelection",t.InnerPadding="innerPadding",t.NumericSelection="numericSelection",t.Position="position",t.RevertToDefault="revertToDefault",t.SecPosition="secPosition",t.SecShow="secShow",t.SecShowAxisTitle="secShowAxisTitle",t.Selection="selection",t.Slider="slider",t.Show="show",t.ShowAxisTitle="showAxisTitle",t.ShowGradientLegend="showGradientLegend",t.TextArea="textarea",t.Transparency="transparency",t.SwitchAxisPosition="switchAxisPosition",(t=e.GeneralPropertyNames||(e.GeneralPropertyNames={})).X="x",t.Y="y",t.Width="width",t.Height="height",t.AltText="altText",t.AllowBinnedLineSample="allowBinnedLineSample",t.AllowOverlappingPointsSample="allowOverlappingPointsSample",t.KeepLayerOrder="keepLayerOrder"})(powerbi=powerbi||{}),(function(e){var s,t,i,l;function r(e,t){if(e&&e.sections)return e=e.sections,e=_.findIndex(e,(function(e){return e.name===t})),-1!==e?e:void 0}function a(e,t){for(var i=1,r=t.format("Explore_Section_Page",[i.toFixed()]);0<=_.findLastIndex(e,(function(e){return e.displayName===r}));)r=t.format("Explore_Section_Page",[(++i).toFixed()]);return r}function n(e){return!!(1&e.visibility)}s=e.explore||(e.explore={}),t=s.SectionUtils||(s.SectionUtils={}),i=jsCommon.ArrayExtensions,l=e.explore.contracts.Section,t.synchronizeSectionsIds=function(e,t){var i=l.filterTransient(t),r=l.filterTransient(e);i.length,r.length;for(var n=i.length-1;0<=n;n--){var a=i[n],o=r[n];a.id=o.id,a.objectId=o.objectId,!(function e(t,i){for(var r=t.length-1;0<=r;r--){var n=t[r],a=i[r];n.id=a.id,s.contracts.isVisualContainerGroup(n),s.contracts.isVisualContainerGroup(a),s.contracts.isVisualContainerGroup(n)&&s.contracts.isVisualContainerGroup(a)&&e(n.children,a.children)}})(a.visualContainerGroups,o.visualContainerGroups)}},t.findSectionIndexForSectionName=r,t.getActiveSectionIndex=function(e,t){var i;return i=null!=(i=null==(i=t?r(e,t):i)&&_.isNumber(e.activeSectionIndex)?e.activeSectionIndex:i)&&_.inRange(i,0,e.sections.length)?i:0},t.findSectionIndexForSection=function(e,t){return e&&e.sections?(e=e.sections,_.findIndex(e,(function(e){return e===t}))):-1},t.findSectionById=function(e,t){return e&&e.sections?i.findWithId(e.sections,t):null},t.findSectionIndexForSectionId=function(e,t){return e&&e.sections?(e=e.sections,_.findIndex(e,(function(e){return e.id===t}))):-1},t.getNextSectionDisplayNameWithIndex=a,t.fillDefaultSectionDisplayNames=function(e,t){for(var i=0,r=e.sections;i<r.length;i++){var n=r[i];n.displayName||(n.displayName=a(e.sections,t))}},t.getVisibleSections=function(e){return _.filter(e,(function(e){return!n(e)}))},t.isSectionHidden=n,t.isSectionTooltip=function(e){return!!(1&e.type)}})(powerbi=powerbi||{}),(function(e){var t,n;t=(t=e.explore||(e.explore={})).util||(t.util={}),n=e.explore.SectionUtils,(t=t.ExplorationUtil||(t.ExplorationUtil={})).isIntermediateState=function(e){return!e||!e.exploration},t.isReportAnnotationsEnabled=function(e){return!e||!e.isReportAnnotationsDisabled},t.removeQuickExploreConfig=function(e){for(var t=0,i=e.sections;t<i.length;t++){var r=i[t];n.isQuickExploreSection(r)&&(r.dynamicConfig=void 0)}}})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={})).DetailVisualEvents||(e.DetailVisualEvents={})).spinnerAction={name:"spinnerAction"}})(powerbi=powerbi||{}),(function(e){var t,i;function r(e,t){void 0===t&&(t=0),this.selectedVisualOriginalPosition=-1,this.contract=e,this.canvasLayout=t}t=e.explore||(e.explore={}),i=t.viewModels||(t.viewModels={}),t=e.explore.constants.ExploreCanvasConstants,i.FixedPhoneCanvasSettings={phoneWidth:t.PhoneAuthoringViewportWidth,phoneHeight:t.PhonePortraitCanvasHeight,phoneGridLayout:{columnCount:t.PhonePortraitColumnCount,rowCount:t.PhonePortraitRowCount,newVisualCellCount:{width:6,height:6}}},Object.defineProperty(r.prototype,"width",{get:function(){return 0===this.canvasLayout?this.contract.size&&this.contract.size.width:i.FixedPhoneCanvasSettings.phoneWidth},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return 0===this.canvasLayout?this.contract.size&&this.contract.size.height:i.FixedPhoneCanvasSettings.phoneHeight},enumerable:!1,configurable:!0}),t=r,i.ExploreCanvas=t})(powerbi=powerbi||{}),(function(r){var e;function t(e,t,i){return{key:t,text:(i=void 0===i?r.common.getLocalize():i).get(e),type:0}}((e=(e=(e=r.explore||(r.explore={})).viewModels||(e.viewModels={})).ExplorationContainerViewModelFactory||(e.ExplorationContainerViewModelFactory={})).MenuItemFactory||(e.MenuItemFactory={})).createNavigationMenuItems=function(e){return{items:[t("Duplicate_page",0,e),t("Rename_page",1,e),t("Delete_page",2,e),t("Hide_page",3,e)]}}})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={}),(t=e.ExplorationContainerViewModelFactory||(e.ExplorationContainerViewModelFactory={})).createNavigationMenuItems=function(e){return t.MenuItemFactory.createNavigationMenuItems(e)}})(powerbi=powerbi||{}),(function(x){!(function(e){var t=e.viewModels||(e.viewModels={}),i=jsCommon.EnumExtensions,F=x.data.SQExpr,A=x.data.SQExprConverter,T=x.data.FieldExprPattern,r=(t.getIconClassName=function(e,t,i){var t=t?"_paneColorRefresh":"",r=e.fieldType;if(1===r)return"fieldListFolder"+t;if(5===r)return"none";if(2===r)return"fieldListHierarchy"+t;if(6===r)return"fieldListMeasure"+t;if(1===e.contract.queryable)return"fieldListError"+t;if(1===e.kind)return e.contract.measure&&e.contract.measure.kpi&&4===e.fieldType?"fieldListKpi"+t:e.contract.measure&&e.contract.measure.changeDetectionMetadata?"fieldListChangeDetection"+t:"fieldListMeasure"+t;if(void 0!==e.contract.type&&void 0!==e.contract.type.geography)return"fieldListGeoData"+t;if(0===e.kind){r=e.contract.column;if(r){if(r.parameterMetadata)return"fieldListParameter"+t;if(r.groupingMetadata)return"fieldListGroup"+t;if(r.calculated)return e.type&&e.type.numeric?"fieldListNumericCalculatedColumn"+t:"fieldListCalculatedColumn"+t;if(!_.isEmpty(r.variations)&&e.type.dateTime)return"fieldListCalendar"+t}if(e.idOnEntityKey)return"fieldListIdentity"+t}return e.type&&e.type.numeric&&1!==e.defaultAggregate&&i?"fieldListNumeric"+t:"none"},Object.defineProperty(n.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canEdit",{get:function(){return this.contract.capabilities.canEdit&&!this.disableEditing},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canCreateColumn",{get:function(){return this.canEdit&&!1!==this.contract.capabilities.supportsCalculatedColumns},enumerable:!1,configurable:!0}),n.prototype.findEntity=function(t){return _.find(this.entities,(function(e){return e.name===t}))},n.prototype.findFields=function(e,t,i){e=this.findEntity(e);if(e)return e.findFields(t,i)},n.prototype.findHierarchies=function(e,t,i){e=this.findEntity(e);if(e)return e.findHierarchies(t,i)},n.prototype.findKpis=function(e,t,i){e=this.findEntity(e);if(e)return e.findKpis(t,i)},n.prototype.findKpiMeasures=function(e,t,i){e=this.findEntity(e);if(e)return e.findKpiMeasures(t,i)},n.prototype.findItems=function(e){var t=[];if(!F.isTransformOutputRoleRef(e)&&!F.isSparklineData(e)){var i=A.asFieldPattern(e),r=T.toFieldExprEntityItemPatterns(i);if(i){var n=i.hierarchyLevel||i.hierarchyLevelAggr;if(n){_.size(r);e=this.findHierarchies(r[0].entity,n.name,n.schema);if(e)for(var a=0,o=e;a<o.length;a++){var s=o[a];t.push(s);for(var l=0,u=s.hierarchyLevels;l<u.length;l++)(f=u[l]).name===n.level&&t.push(f)}}else if(i.columnHierarchyLevelVariation){var c=i.columnHierarchyLevelVariation.source.name;if(_.size(r),!(V=this.findFields(r[0].entity,c,r[0].schema)))return t;for(var p=0,h=V;p<h.length;p++){var d=h[p],v=(t.push(d),d.properties);if(v)for(var g=0,m=v;g<m.length;g++){var y=m[g];if(y instanceof D&&y.name===i.columnHierarchyLevelVariation.level.name){t.push(y);for(var f,C=0,S=y.hierarchyLevels;C<S.length;C++)(f=S[C]).name===i.columnHierarchyLevelVariation.level.level&&t.push(f)}}}}else{var b=T.getPropertyNames(i);b&&(_.size(r),_.size(b));for(var E=0;E<r.length;E++){var V,x=r[E],c=null==b?void 0:b[E];if(V=this.findFields(x.entity,c,x.schema)||this.findKpiMeasures(x.entity,c,x.schema))for(var w=0,P=V;w<P.length;w++){d=P[w];t.push(d)}}}}}return t},n.getUniqueId=function(){return n._uid++},n._uid=0,n);function n(e){this.contract=e,this.showCheckboxes=!0,this.entities=[]}t.FieldListConceptualModel=r,Object.defineProperty(a.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"displayName",{get:function(){return this.displayNameOverride||this.contract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"description",{get:function(){return this.contract.description},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"errorMessage",{get:function(){return this.contract.errorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"calculated",{get:function(){return this.contract.calculated},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"iconClassName",{get:function(){return 1===this.contract.queryable?"fieldListError":this.calculated?"fieldListEntityCalculated":this.isMeasureGroup?"fieldListMeasureGroup":void 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hidden",{get:function(){return i.hasFlag(this.contract.visibility,1)&&_.every(this.properties,(function(e){return!e.isExtension||e.hidden}))},set:function(e){this.contract.visibility=e?i.setFlag(this.contract.visibility,1):i.resetFlag(this.contract.visibility,1)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canEdit",{get:function(){return this.contractSchema.capabilities.canEdit&&!this.schema.disableEditing&&!t.FieldListViewModelUtils.isAbandoned(this.contract)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"private",{get:function(){return i.hasFlag(this.contract.visibility,4)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"showAsVariationsOnly",{get:function(){return i.hasFlag(this.contract.visibility,2)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"showHidden",{get:function(){return this.schema.showHidden},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canRefresh",{get:function(){return this.canEdit&&this.contract.capabilities.canRefresh},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canEditEntity",{get:function(){return this.canEdit&&!this.calculated&&this.contract.capabilities.canEditSource},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canDelete",{get:function(){return this.canEdit&&this.contract.capabilities.canDelete},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canRename",{get:function(){return this.canEdit&&this.contract.capabilities.canRename},enumerable:!1,configurable:!0}),a.prototype.findFields=function(e,t){return this.findFieldsByType(e,t,0)},a.prototype.findKpis=function(e,t){return this.findFieldsByType(e,t,4)},a.prototype.findKpiMeasures=function(e,t){return this.findFieldsByType(e,t,5)},a.prototype.findHierarchies=function(e,t){return this.findFieldsByType(e,t,2)},a.prototype.findFieldsByType=function(t,i,r){var e=[];2===r?e.push.apply(e,_.filter(this.hierarchies,(function(e){return e.name===t&&e.schema.name===i}))):e.push.apply(e,_.filter(this.properties,(function(e){return e.name===t&&e.fieldType===r&&e.schemaName===i})));for(var n=0,a=this.displayFolders;n<a.length;n++)for(var o=a[n],s=0,l=_.filter(o.getAllChildren(),(function(e){return e.name===t&&e.fieldType===r}));s<l.length;s++){var u=l[s];e.indexOf(u)<0&&e.push(u)}if(!_.isEmpty(e))return e},Object.defineProperty(a.prototype,"userEntity",{get:function(){return!(this.private||this.showAsVariationsOnly)},enumerable:!1,configurable:!0});e=a;function a(e,t,i){this.hasCheckedProperties=!1,this.contract=e,this.contractSchema=t,this.schema=i,this.properties=[],this.columnsAndMeasures=[],this.hierarchies=[],this.displayFolders=[]}function o(e,t,i){this.hasCheckedChildren=!1,this.contract=e,this.schema=t,this.entity=i,this.id=r.getUniqueId()}t.FieldListConceptualEntity=e,Object.defineProperty(o.prototype,"children",{get:function(){return this._children},set:function(e){this._children=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"schemaName",{get:function(){return this.schema.name},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"displayName",{get:function(){return this.displayNameOverride||this.contract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"description",{get:function(){return this.contract.description},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"errorMessage",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"visible",{get:function(){return!this.parent||this.parent.expanded&&this.parent.visible},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hidden",{get:function(){return this.contract.hidden},set:function(e){this.contract.hidden=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"showHidden",{get:function(){return this.entity.showHidden},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"canEdit",{get:function(){return!this.variation&&this.schema.capabilities.canEdit&&!this.entity.schema.disableEditing},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"disableDragging",{get:function(){return this.entity.schema.disableDragging},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"disableSelectionOnFocus",{get:function(){return this.entity.schema.disableSelectionOnFocus},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"showCheckboxes",{get:function(){return this.entity.schema.showCheckboxes},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isExtension",{get:function(){return!1},enumerable:!1,configurable:!0}),e=o,t.FieldListConceptualItem=e,__extends(c,s=e),Object.defineProperty(c.prototype,"kind",{get:function(){return this.contract.kind},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"defaultAggregate",{get:function(){return this.contract.column?this.contract.column.defaultAggregate:null},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"type",{get:function(){return this.contract.type},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"idOnEntityKey",{get:function(){return!!this.contract.column&&this.contract.column.idOnEntityKey},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"errorMessage",{get:function(){return this.contract.errorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canDelete",{get:function(){return this.canEdit&&!1!==this.contract.canDelete},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canAddToFilter",{get:function(){return!this.contract.measure||!this.schema.capabilities.limitMultiColumnFiltersToQueryGroupColumns},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"properties",{get:function(){return this.children},enumerable:!1,configurable:!0}),c.prototype.clone=function(){return new c(this.contract,this.schema,this.entity)};var s,l,u=c;function c(e,t,i,r,n){e=s.call(this,e,t,i)||this;return e.children=[],e.originalEntity=r,e.variation=n,e.expanded=!1,e.draggable=!e.disableDragging,e.fieldType=0,e}function p(e,t,i){var r=this;return(r=l.call(this,e,t,i)||this).fieldType=6,r}t.FieldListConceptualProperty=u,__extends(p,l=e),Object.defineProperty(p.prototype,"defaultAggregate",{get:function(){return 3},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isExtension",{get:function(){return!1},enumerable:!1,configurable:!0}),p.prototype.clone=function(){return new p(this.contract,this.schema,this.entity)},t.FieldListConceptualRowCount=p,__extends(d,h=u),Object.defineProperty(d.prototype,"defaultAggregate",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"idOnEntityKey",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isExtension",{get:function(){return!0},enumerable:!1,configurable:!0}),d.prototype.clone=function(){return new d(this.contract,this.schema,this.entity)};var h;function d(e,t,i){return h.call(this,e,t,i)||this}t.FieldListConceptualExtensionMeasure=d,__extends(g,v=u),Object.defineProperty(g.prototype,"hidden",{get:function(){return this.parent.hidden},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"name",{get:function(){return this.hierarchyLevelContract.name},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"displayName",{get:function(){return this.displayNameOverride||this.hierarchyLevelContract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"description",{get:function(){return this.hierarchyLevelContract.description},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"canDelete",{get:function(){return!this.variation&&this.canEdit&&!1!==this.hierarchyLevelContract.canDelete},enumerable:!1,configurable:!0}),g.prototype.clone=function(e){e=e||this.parent;return new g(this.hierarchyLevelContract,this.schema,e,this.entity)};var v;function g(e,t,i,r,n,a){var o=this;return(o=v.call(this,e.column,t,r)||this).originalEntity=n,o.variation=a,o.hierarchyLevelContract=e,o.parent=i,o.fieldType=3,o}t.FieldListConceptualHierarchyLevel=g,__extends(y,m=e),Object.defineProperty(y.prototype,"properties",{get:function(){return this.hierarchyLevels},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"children",{get:function(){return this.hierarchyLevels},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"canDelete",{get:function(){return!this.variation&&this.canEdit&&!1!==this.contract.canDelete},enumerable:!1,configurable:!0}),y.prototype.findLevel=function(t,e){return _.find(this.hierarchyLevels,(function(e){return e.name===t}))},y.prototype.clone=function(){var t=new y(this.contract,this.schema,this.entity);return t.hierarchyLevels=_.map(this.hierarchyLevels,(function(e){return e.clone(t)})),t};var m,D=y;function y(e,t,i,r,n){e=m.call(this,e,t,i)||this;return e.expanded=!1,e.hierarchyLevels=[],e.originalEntity=r,e.variation=n,e.draggable=!e.disableDragging,e.fieldType=2,e}t.FieldListConceptualHierarchy=D,__extends(C,f=e),Object.defineProperty(C.prototype,"kind",{get:function(){return this.contract.kind},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"properties",{get:function(){return this.kpiMeasures},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"children",{get:function(){return this.kpiMeasures},enumerable:!1,configurable:!0}),C.prototype.clone=function(){var t=new C(this.contract,this.schema,this.entity);return t.kpiMeasures=_.map(this.kpiMeasures,(function(e){return e.clone(t)})),t};var f;function C(e,t,i){e=f.call(this,e,t,i)||this;return e.expanded=!1,e.kpiMeasures=[],e.fieldType=4,e}t.FieldListConceptualKpi=C,__extends(b,S=u),Object.defineProperty(b.prototype,"displayName",{get:function(){var e;switch(this.kpiType){case 2:e=this.locOptions.KpiValueDisplayName;break;case 1:e=this.locOptions.KpiGoalDisplayName;break;case 0:e=this.locOptions.KpiStatusDisplayName;break;case 3:e=this.locOptions.KpiTrendDisplayName}return this.displayNameOverride||e||this.contract.displayName},enumerable:!1,configurable:!0}),b.prototype.clone=function(e){e=e||this.parent;return new b(this.contract,this.schema,this.kpiType,e,this.entity,this.locOptions)};var S;function b(e,t,i,r,n,a){var o=this;return(o=S.call(this,e,t,n)||this).kpiType=i,o.parent=r,o.locOptions=a,o.draggable=!o.disableDragging,o.fieldType=5,o}t.FieldListConceptualKpiMeasure=b,__extends(V,E=e),Object.defineProperty(V.prototype,"hidden",{get:function(){return!_.some(this.children,(function(e){return!e.hidden}))},set:function(e){},enumerable:!1,configurable:!0}),V.prototype.clone=function(){},V.prototype.getAllChildren=function(){for(var e=[],t=0,i=this.children;t<i.length;t++){var r=i[t];e.push(r),1===r.fieldType&&e.push.apply(e,r.getAllChildren()||[])}return e};var E,u=V;function V(e,t,i,r,n){var a=E.call(this,e,r,n)||this;a.expanded=!1,a.parent=i,a.children=t,a.fieldType=1;for(var o=0,s=t;o<s.length;o++)s[o].parent=a;return a}t.FieldListConceptualDisplayFolder=V})(x.explore||(x.explore={}))})(powerbi=powerbi||{}),(function(e){var S,r;function t(e,t,i){void 0===i&&(i=!1),this.withRowCounts=!1,this.localizationService=e,this.withRowCounts=i}e=e.explore||(e.explore={}),(S=e.viewModels||(e.viewModels={})).createFieldListViewModelFactory=function(e,t,i){return new r(e,t,i=void 0===i?!1:i)},t.prototype.createModel=function(e,t,i,r){for(var e=e.schemas,n=S.FieldListViewModelUtils.getExtensions(e),a=0,o=S.FieldListViewModelUtils.sortExtensionSchemasAtEnd(e);a<o.length;a++)var s=o[a],l=this.convertConceptualSchema(s,l,n,t,i,r);return l},t.prototype.convertConceptualSchema=function(t,i,r,e,n,a){var o,s=this,n=((i=i||new S.FieldListConceptualModel(t)).disableDragging=n,_.filter(t.entities,(function(e){return!S.FieldListViewModelUtils.isExtension(e)||S.FieldListViewModelUtils.isAbandoned(e)}))),n=_.map(n,(function(e){return s.convertConceptualEntity(e,t,i,r)}));return(o=i.entities).push.apply(o,n||[]),i.disableEditing=e,i.disableSelectionOnFocus=a,i},t.prototype.convertConceptualEntity=function(e,t,i,r){var n=this,a=new S.FieldListConceptualEntity(e,t,i);if(a.properties=[],e.properties&&!S.FieldListViewModelUtils.isExtension(e))for(var o,s=0,l=e.properties;s<l.length;s++)(f=l[s]).measure&&f.measure.kpi?(o=this.convertConceptualKpi(f,t,a),a.columnsAndMeasures.push(o),a.properties.push(o)):f.kpiValue||(o=this.convertConceptualProperty(f,t,a),a.columnsAndMeasures.push(o),a.properties.push(o));if(a.isMeasureGroup=S.FieldListViewModelUtils.isMeasureGroup(e.properties),a.expanded=!1,e.hierarchies&&0<e.hierarchies.length){a.hierarchies=_.map(e.hierarchies,(function(e){return n.convertConceptualHierarchy(e,t,a)}));for(var u=0,c=a.hierarchies;u<c.length;u++){var p=c[u];a.properties.push(p)}}if(r){var h,i=S.FieldListViewModelUtils.getExtensionKey(t.name,e.name);if(h=r.entities[i])for(var d=0,v=h;d<v.length;d++)for(var g=v[d],m=0,y=g.entity.properties;m<y.length;m++){var f=y[m],C=this.convertConceptualExtensionMeasure(f,g.schema,a);a.properties.push(C)}}return S.FieldListViewModelDisplayFolderMerger.mergeDisplayFolders(a,e.displayFolders,h,this),S.FieldListViewModelUtils.sortProperties(a.properties),S.FieldListViewModelUtils.removeDuplicateProperties(a.properties,a.displayFolders),S.FieldListViewModelUtils.flattenFolders(a),S.FieldListViewModelUtils.updatePropertiesWithChildren(a),this.withRowCounts&&0===e.visibility&&!t.capabilities.discourageQueryAggregateUsage&&(r=this.createConceptualRowCount(t,a),a.properties.unshift(r)),a},t.prototype.convertConceptualDisplayFolder=function(e,t,i,r){for(var n={},a={},o=0,s=r.properties;o<s.length;o++){var l=s[o];3===l.fieldType||2===l.fieldType?a[l.name]=l:n[l.name]=l}return this.convertConceptualDisplayFolderCore(e,t,i,n,a,r)},t.prototype.convertConceptualDisplayFolderCore=function(e,t,i,r,n,a){for(var o=[],s=0,l=e.properties;s<l.length;s++){var u=l[s];u&&(h=r[u.name])&&o.push(h.clone())}for(var c=0,p=e.hierarchies;c<p.length;c++){var h,d=p[c];d&&(h=n[d.name])&&o.push(h.clone())}for(var v=new S.FieldListConceptualDisplayFolder(e,o,i,t,a),g=0,m=e.displayFolders;g<m.length;g++){var y=m[g];v.children.push(this.convertConceptualDisplayFolderCore(y,t,v,r,n,a))}return S.FieldListViewModelUtils.sortProperties(v.children),v},t.prototype.convertConceptualHierarchy=function(e,t,i,r,n){var a=new S.FieldListConceptualHierarchy(e,t,i,r,n);a.hierarchyLevels=[];for(var o=0,s=e.levels;o<s.length;o++){var l=s[o];a.hierarchyLevels.push(this.convertConceptualHierarchyLevel(l,t,a))}return a},t.prototype.convertConceptualHierarchyLevel=function(e,t,i){return new S.FieldListConceptualHierarchyLevel(e,t,i,i.entity,i.originalEntity,i.variation)},t.prototype.convertConceptualProperty=function(e,t,i){for(var r=new S.FieldListConceptualProperty(e,t,i),n=0,a=S.FieldListViewModelUtils.getPropertyVariations(e);n<a.length;n++){var o=a[n];r.children.push(this.convertConceptualVariationHierarchy(o,t,r))}return r},t.prototype.convertConceptualVariationHierarchy=function(e,t,i){t=this.convertConceptualHierarchy(e.defaultHierarchy,t,i.entity,e.navigationProperty.targetEntity,e.name);return t.parent=i,t},t.prototype.convertConceptualExtensionMeasure=function(e,t,i){return new S.FieldListConceptualExtensionMeasure(e,t,i)},t.prototype.convertConceptualKpi=function(e,t,i){var r=new S.FieldListConceptualKpi(e,t,i),n={},a=(n.KpiValueDisplayName=this.localizationService.get("KpiValueFieldListDisplayName"),n.KpiStatusDisplayName=this.localizationService.get("KpiStatusFieldListDisplayName"),n.KpiGoalDisplayName=this.localizationService.get("KpiGoalFieldListDisplayName"),n.KpiTrendDisplayName=this.localizationService.get("KpiTrendFieldListDisplayName"),e.measure.kpi),o=a.goal,s=a.status,a=a.trend;return r.kpiMeasures=[],r.kpiMeasures.push(this.convertConceptualKpiMeasure(e,t,2,r,i,n)),o&&r.kpiMeasures.push(this.convertConceptualKpiMeasure(o,t,1,r,i,n)),s&&r.kpiMeasures.push(this.convertConceptualKpiMeasure(s,t,0,r,i,n)),a&&r.kpiMeasures.push(this.convertConceptualKpiMeasure(a,t,3,r,i,n)),r},t.prototype.convertConceptualKpiMeasure=function(e,t,i,r,n,a){return new S.FieldListConceptualKpiMeasure(e,t,i,r,n,a)},t.prototype.createConceptualRowCount=function(e,t){var i={name:t.name,displayName:this.localizationService.get("QuickExplore_RowCount"),canDelete:!1,hidden:!1};return new S.FieldListConceptualRowCount(i,e,t)},r=t})(powerbi=powerbi||{}),(function(e){var o;function p(e,t){return JSON.stringify({e:t})}function h(e){return e.hasOwnProperty("extends")}function i(e,t){return e=(e||"").toLocaleUpperCase(),t=(t||"").toLocaleUpperCase(),e.localeCompare(t)}e=e.explore||(e.explore={}),(e=(o=e.viewModels||(e.viewModels={})).FieldListViewModelUtils||(o.FieldListViewModelUtils={})).isMeasureGroup=function(e){return _.find(e,(function(e){return!e.hidden}))&&!_.find(e,(function(e){return!e.hidden&&1!==e.kind&&2!==e.kind}))},e.getExtensions=function(e){for(var t={entities:{}},i=0,r=e;i<r.length;i++){var n=r[i];if(h(n))for(var a=n.extends,o=0,s=n.entities;o<s.length;o++){var l,u,c=s[o];h(c)&&(l={schema:n,entity:c},c=p(0,c.name),(u=t.entities[c])?u.push(l):t.entities[c]=u=[l])}}return t},e.sortExtensionSchemasAtEnd=function(e){var t=_.filter(e,(function(e){return!h(e)})),e=_.filter(e,h);return _.union(t,e)},e.getExtensionKey=p,e.isExtension=h,e.isAbandoned=function(e){return e.isAbandoned},e.updatePropertiesWithChildren=function(e){for(var t=[],i=0,r=e.properties;i<r.length;i++)!(function e(t,i){t.push(i);if(!(i instanceof o.FieldListConceptualKpi||i instanceof o.FieldListConceptualHierarchy||i instanceof o.FieldListConceptualProperty))return;if(_.isEmpty(i.properties))return;for(var r=0,n=i.properties;r<n.length;r++){var a=n[r];e(t,a)}})(t,r[i]);e.properties=t},e.sortProperties=function(e){e&&e.sort((function(e,t){return i(e.displayName,t.displayName)}))},e.compareAlphabeticallyIgnoreCase=i,e.removeDuplicateProperties=function(e,t){var i;_.isEmpty(e)||(function e(t,i){if(_.isEmpty(t))return;var r=[];for(var n=0,a=t;n<a.length;n++)for(var o=a[n],s=0,l=o.children;s<l.length;s++){var u=l[s];1===u.fieldType?r.push(u):i[u.name]=u}e(r,i)}(t,i={}),_.remove(e,(function(e){return 1!==e.fieldType&&i[e.name]})))},e.flattenFolders=function(e){var t=[];!(function e(t,i){for(var r=0,n=t;r<n.length;r++){var a=n[r];i.push(a),1===a.fieldType&&e(a.children,i)}})(e.properties,t),e.properties=t},e.findTargetEntityViewModel=function(e,t){return _.find(e.entities,(function(e){return e.contract===t}))},e.getHierarchyLevelDictionary=function(e){var t={};if(!_.isEmpty(e))for(var i=0,r=e;i<r.length;i++){var n=r[i],a={};t[n.name]=a;for(var o=0,s=n.levels;o<s.length;o++){var l=s[o];a[l.column.name]=l}}return t},e.getPropertyVariations=function(e){var t=[];if(e.column&&e.column.variations)for(var i=0,r=e.column.variations;i<r.length;i++){var n=r[i],a=n.navigationProperty.targetEntity,o=n.defaultHierarchy;a&&a.hierarchies&&o&&!o.hidden&&t.push(n)}return t}})(powerbi=powerbi||{}),(function(C){var r,e,h,n,t,S,l,u,i,a,c,d;function o(e,t,i,r,n,a,o,s,l){n=new c(e,n,a,t,i,r,o,s,l);return h.visit(e,n)}function s(e,t,i,r,n,a,o,s,l){this.sqExpr=e,this.dataRoleKind=t,this.requiredTypes=i,this.schema=r,this.aggrOps=n,this.hasHierarchyLevels=a,this.localizationService=o,this.property=s,this.forceAggregateItems=l}function p(e,t,i,r,n,a,o,s,l,u,c,p){this.property=e,this.bucket=t,this.buckets=i,this.dataRole=r,this.forceAggregateItems=n,this.schema=a,this.aggrOps=o,this.visual=s,this.featureSwitchService=l,this.groupingDesignStateService=u,this.showValueAsService=c,this.localizationService=p,this.supportedOperations=null!=(e=this.property.supportedOperations)?e:67108863,this.menuItems=[],1==(1&this.supportedOperations)&&this.menuItems.push(this.createDeleteMenuItem()),this.property.interactivityOptions.isEditableField&&32768==(32768&this.supportedOperations)&&this.menuItems.push(this.createRenameMenuItem()),524288==(524288&this.supportedOperations)&&(1<this.bucket.properties.length&&this.menuItems.push(this.createMoveGroupMenuItem()),1<this.buckets.length&&this.menuItems.push(this.createMoveToGroupMenuItem())),this.createConditionalFormattingOptions()}function v(){return{type:0}}r=C.explore||(C.explore={}),e=r.viewModels||(r.viewModels={}),h=C.data.FieldExprPattern,n=C.explore.utils.GroupUtils,t=C.data.SQExpr,S=C.data.SQExprBuilder,l=C.data.SQExprConverter,u=C.data.SQExprUtils,i=C.data.SQHierarchyExprUtils,a=C.explore.util.VisualContainerUtils,(e=e.MenuItemFactory||(e.MenuItemFactory={})).createAggregateMenuItems=o,s.prototype.visitEntity=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitColumn=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitColumnAggr=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitGroupingColumn=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitGroupingColumnAggr=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitColumnHierarchyVariation=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitColumnHierarchyLevelVariation=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitColumnSubquery=function(e){return[]},s.prototype.visitColumnAggrSubquery=function(e){return[]},s.prototype.visitColumnTransformRef=function(e){return[]},s.prototype.visitEntityAggr=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitHierarchy=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitHierarchyLevel=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitHierarchyLevelAggr=function(e){return this.createMenuItems(this.sqExpr)},s.prototype.visitMeasure=function(e){return[]},s.prototype.visitPercentOfGrandTotal=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItemsForPercentOfTotal(e)},s.prototype.visitPercentOfRoleTotal=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItemsForPercentOfTotal(e)},s.prototype.visitPercentile=function(e){return[]},s.prototype.visitSelectRef=function(e){return[]},s.prototype.visitFilteredEval=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItems(e)},s.prototype.visitArithmetic=function(e){return[]},s.prototype.visitConstant=function(e){return[]},s.prototype.visitSparklineData=function(e){return[]},s.prototype.visitNativeVisualCalc=function(e){return[]},s.prototype.createMenuItemsForPercentOfTotal=function(e){var t=S.removeAggregate(e,this.schema).getMetadata(this.schema);if(!t)return[];t=t.type,t=t.text||t.dateTime||t.duration?[3,4]:[];return this.createMenuItems(e,t)},s.prototype.createMenuItems=function(e,t){void 0===t&&(t=[]);var i=[];if(!this.hasHierarchyLevels&&_.isEmpty(e.validate(this.schema,this.aggrOps))&&!u.discourageAggregation(e,this.schema)){var r=this.dataRoleKind===C.VisualDataRoleKind.Grouping,n=this.dataRoleKind===C.VisualDataRoleKind.GroupingOrMeasure,r=r&&!this.forceAggregateItems?[]:this.aggrOps.getSupportedAggregates(e,this.schema,this.requiredTypes),r=_.difference(r,t);(n&&!(function(e,t){e=e.getConceptualProperty(t);return e&&1===e.kind})(e,this.schema)&&!(function(e,t){e=l.asFieldPattern(e,t);return e&&e.entityAggr})(e,this.schema)||this.forceAggregateItems&&!_.isEmpty(r))&&i.push(this.createRemoveAggregateMenuItem());for(var a=0,o=r;a<o.length;a++){var s=o[a];i.push(this.createAggregateMenuItem(s))}}return i},s.prototype.createAggregateMenuItem=function(e){var t=v(this.property),i=(t.key={action:4,aggregate:e},S.removeAggregate(this.sqExpr,this.schema).getMetadata(this.schema)),e=r.services.getAggregateKey(e,i);return t.text=this.localizationService.get("Aggregate_"+e),t},s.prototype.createRemoveAggregateMenuItem=function(){var e=v(this.property);return e.key={action:2},e.text=this.localizationService.get("FieldWell_RemoveAggregate"),e},s.prototype.visitTransformOutputRoleRef=function(e){return[]},c=s,p.prototype.createConditionalFormattingOptions=function(){var t=this;!_.isEmpty(this.property.conditionalFormattingRepetitions)&&this.visual&&(this.conditionalFormattingOptions=this.property.conditionalFormattingRepetitions.map((function(e){return{repetition:e,propertyDefinition:C.VisualObjectRepetition.getDefinition(t.visual.objects,e)}})))},p.prototype.visitEntity=function(e){return this.menuItems},p.prototype.visitColumn=function(e){var t=this.property.expr;return 4096==(4096&this.supportedOperations)&&this.addConditionalFormattingMenuItems(t),4==(4&this.supportedOperations)&&this.addAggregateMenuItems(),16==(16&this.supportedOperations)&&this.addShowValueAsMenuItem(e.schema),64==(64&this.supportedOperations)&&this.addQuickCalcMenuItem(e.schema),8==(8&this.supportedOperations)&&this.addShowAllMenuItem(t),2048==(2048&this.supportedOperations)&&this.addHierarchiesMenuItems(this.property.hierarchyLevels),128==(128&this.supportedOperations)&&this.addVariationsMenuItems(e),256==(256&this.supportedOperations)&&this.addGroupsMenuItems(e),this.isFieldParameterOperations()&&this.addFieldParameterMenuItems(),this.menuItems},p.prototype.visitColumnAggr=function(e){var t=this.property.expr;return 2097152==(2097152&this.supportedOperations)&&this.addSparklineMenuItem(e.schema),4096==(4096&this.supportedOperations)&&this.addConditionalFormattingMenuItems(t),4==(4&this.supportedOperations)&&this.addAggregateMenuItems(),16==(16&this.supportedOperations)&&this.addShowValueAsMenuItem(e.schema),64==(64&this.supportedOperations)&&this.addQuickCalcMenuItem(e.schema),8==(8&this.supportedOperations)&&this.addShowAllMenuItem(t),2048==(2048&this.supportedOperations)&&this.addHierarchiesMenuItems(this.property.hierarchyLevels),128==(128&this.supportedOperations)&&this.addVariationsMenuItems(e),this.isFieldParameterOperations()&&this.addFieldParameterMenuItems(),this.menuItems},p.prototype.visitGroupingColumn=function(e){var t=this.property.expr;return this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.addVariationsMenuItems(e),this.addGroupsMenuItems(e),this.menuItems},p.prototype.visitGroupingColumnAggr=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.addVariationsMenuItems(e),this.menuItems},p.prototype.visitColumnHierarchyVariation=function(e){return this.menuItems},p.prototype.visitColumnHierarchyLevelVariation=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.source.schema),this.addQuickCalcMenuItem(e.source.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},p.prototype.visitColumnSubquery=function(e){return this.menuItems},p.prototype.visitColumnAggrSubquery=function(e){return this.menuItems},p.prototype.visitColumnTransformRef=function(e){return this.menuItems},p.prototype.visitEntityAggr=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},p.prototype.visitHierarchy=function(e){return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addShowAllMenuItem(_.head(this.property.hierarchyLevels).expr),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},p.prototype.visitHierarchyLevel=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},p.prototype.visitHierarchyLevelAggr=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},p.prototype.visitMeasure=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},p.prototype.visitPercentile=function(e){var t=this.property.expr;return this.addConditionalFormattingMenuItems(t),this.menuItems},p.prototype.visitSelectRef=function(e){return[]},p.prototype.visitTransformOutputRoleRef=function(e){return[]},p.prototype.visitPercentOfGrandTotal=function(e){return this.addPercentTotalMenuItems(e.baseExpr)},p.prototype.visitPercentOfRoleTotal=function(e){return this.addPercentTotalMenuItems(e.baseExpr)},p.prototype.visitFilteredEval=function(e){return this.addFilteredEvalMenuItems()},p.prototype.visitArithmetic=function(e){return this.menuItems},p.prototype.visitNativeVisualCalc=function(e){return this.addEditVisualCalcMenuItems(),this.menuItems},p.prototype.visitConstant=function(e){return this.menuItems},p.prototype.visitSparklineData=function(e){return this.addEditSparklineMenuItem(),this.menuItems},p.prototype.isFieldParameterOperations=function(){return 16777216==(16777216&this.supportedOperations)||8388608==(8388608&this.supportedOperations)},p.prototype.addEditVisualCalcMenuItems=function(){t.isNativeVisualCalc(this.property.expr)&&this.featureSwitchService.featureSwitches.visualCalculationsAuthoring&&this.featureSwitchService.featureSwitches.visualCalculations&&(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createEditCalculationMenuItem()))},p.prototype.createEditCalculationMenuItem=function(){var e=v(this.property);return e.key={action:33554432},e.text=this.localizationService.get("FieldWell_EditVisualCalculation"),e},p.prototype.addFieldParameterMenuItems=function(){this.property.expr.getConceptualProperty(this.schema)&&(this.menuItems.push(this.createSeparatorMenuItem()),16777216==(16777216&this.supportedOperations)?this.menuItems.push(this.createColumnToParameter()):8388608==(8388608&this.supportedOperations)&&this.menuItems.push(this.createParameterToColumn()))},p.prototype.addFilteredEvalMenuItems=function(){return this.addAggregateMenuItems(),this.menuItems},p.prototype.addPercentTotalMenuItems=function(e){var t=S.fieldExpr(e),t=(this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(h.getSchema(e)),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),h.getProperty(e));return t&&this.addVariationsMenuItems(t),this.menuItems},p.prototype.addAggregateMenuItems=function(){var e,t=o(this.property.expr,this.schema,this.aggrOps,!_.isEmpty(this.property.hierarchyLevels),this.dataRole.kind,this.dataRole.requiredTypes,this.localizationService,this.property,this.forceAggregateItems);_.isEmpty(t)||(this.menuItems.push(this.createSeparatorMenuItem()),(e=this.menuItems).push.apply(e,t||[]))},p.prototype.addConditionalFormattingMenuItems=function(e){_.isEmpty(this.conditionalFormattingOptions)||e.getMetadata(this.schema)&&!a.hasGroupByItems(this.visual.query)&&(this.menuItems.push(this.createSeparatorMenuItem()),this.addSetConditionalFormattingMenuItem(),this.addRemoveConditionalFormattingMenuItem())},p.prototype.addSetConditionalFormattingMenuItem=function(){if(!_.isEmpty(this.conditionalFormattingOptions))for(var e=v(this.property),t=(e.text=this.localizationService.get("FieldWell_ConditionalFormatting"),this.menuItems.push(e),e.children=[]),i=0,r=this.conditionalFormattingOptions;i<r.length;i++){var n=r[i];t.push(this.createConditionalFormattingMenuItem(n.repetition.propertyDescriptor.displayName,4096,n))}},p.prototype.addRemoveConditionalFormattingMenuItem=function(){if(!_.isEmpty(this.conditionalFormattingOptions)){var e=v(this.property);if(e.text=this.localizationService.get("FieldWell_RemoveConditionalFormatting"),this.menuItems.push(e),_.some(this.conditionalFormattingOptions,(function(e){return null!=e.propertyDefinition}))){var t=e.children=[];t.push(this.createConditionalFormattingMenuItem(C.data.createDisplayNameGetter("All"),8192));for(var i=0,r=this.conditionalFormattingOptions;i<r.length;i++){var n=r[i],a=this.createConditionalFormattingMenuItem(n.repetition.propertyDescriptor.displayName,16384,n);a.disabled=null==n.propertyDefinition,t.push(a)}}else e.disabled=!0}},p.prototype.createConditionalFormattingMenuItem=function(e,t,i){var r=v(this.property);return r.key={action:t,conditionalFormattingOptions:i},r.text=C.data.getDisplayName(e,this.localizationService),r},p.prototype.addShowAllMenuItem=function(e){e=u.isMeasure(e);a.hasGroupByItems(this.visual.query)||this.dataRole.kind!==C.VisualDataRoleKind.Grouping&&(this.dataRole.kind!==C.VisualDataRoleKind.GroupingOrMeasure||e)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createShowAllMenuItem()))},p.prototype.addHierarchiesMenuItems=function(e){var t;_.isEmpty(e)||(t=_.head(e),(t=i.expandExpr(this.schema,t.expr.arg))instanceof Array&&t.length===e.length||this.bucket.supportsMultipleItems&&(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createRestoreHierarchyMenuItem())))},p.prototype.addShowValueAsMenuItem=function(e){_.isEmpty(this.property.hierarchyLevels)&&this.property.expr.getConceptualProperty(this.schema)&&(e=(e=this.schema.schema(e))&&e.capabilities.supportsScopedEval,!a.hasGroupByItems(this.visual.query)&&e&&this.dataRole.kind!==C.VisualDataRoleKind.Grouping&&(e=this.property.expr,e=this.showValueAsService.createShowValueAsMenuItems(e,this.schema,this.visual.visualType),_.isEmpty(e)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createShowValueAsMenuItem(e)))))},p.prototype.addQuickCalcMenuItem=function(e){!this.property.expr.getConceptualProperty(this.schema)||((e=this.schema.schema(e))&&e.capabilities.canEdit&&!e.isExtensionSchema||this.canAuthorReportMeasuresOnSchema(e))&&(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createQuickCalcMenuItem()))},p.prototype.canAuthorReportMeasuresOnSchema=function(e){return e.capabilities.isExtendable||e.isExtensionSchema},p.prototype.addSparklineMenuItem=function(e){this.featureSwitchService.featureSwitches.sparklines&&this.dataRole.supportsSparklines&&(e=this.schema.schema(e))&&e.capabilities.supportsSparklineData&&(this.menuItems.push(this.createSeparatorMenuItem()),(e=v(this.property)).key={action:2097152},e.text=this.localizationService.get("Sparkline_AddOption"),this.menuItems.push(e))},p.prototype.addEditSparklineMenuItem=function(){var e;this.featureSwitchService.featureSwitches.sparklines&&(this.menuItems.push(this.createSeparatorMenuItem()),(e=v(this.property)).key={action:4194304},e.text=this.localizationService.get("Sparkline_EditOption"),this.menuItems.push(e))},p.prototype.addVariationsMenuItems=function(e){var t=S.fromColumn(e),i=t.getConceptualProperty(this.schema);if(i){var r=i.column;if(r&&!_.isEmpty(r.variations)){for(var n=S.entity(e.schema,e.entity),e=this.createVariationMenuItem(i.displayName,t),a=[],o=0,s=r.variations;o<s.length;o++){var l=s[o];if(l.navigationProperty&&l.navigationProperty.targetEntity){var u=l.navigationProperty.targetEntity;if(this.dataRole.kind!==C.VisualDataRoleKind.Measure)for(var c=0,p=_.filter(u.hierarchies,(function(e){return!e.hidden}));c<p.length;c++){var h=p[c],d=S.hierarchy(S.propertyVariationSource(n,l.name,i.name),h.name);a.push(this.createVariationMenuItem(h.name,d))}for(var v=S.entity(n.schema,u.name),g=0,m=_.filter(u.properties,(function(e){return!e.hidden}));g<m.length;g++){var y=m[g],f=S.columnRef(v,y.name);a.push(this.createVariationMenuItem(y.displayName,f))}}}_.isEmpty(a)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(e),(t=this.menuItems).push.apply(t,a||[]))}}},p.prototype.addGroupsMenuItems=function(e){var t,i,r=this.schema.schema(e.schema);!1!==(r&&r.capabilities.canEdit&&r.capabilities.supportsGrouping)&&(r=this.featureSwitchService.featureSwitches.enableGroupAuthoring,t=[],i=this.property.expr.getConceptualProperty(this.schema),r&&(!n.canExprBeGrouped(this.schema,this.property.expr)||this.property.hierarchyLevels&&0<this.property.hierarchyLevels.length||t.push(this.createGroupsMenuItem()),n.isGroupOrBinColumn(e.entity,i,this.groupingDesignStateService)&&t.push(this.createEditGroupsMenuItem())),n.isClusteringColumn(e.entity,i,this.groupingDesignStateService)&&t.push(this.createEditClusteringMenuItem()),0<t.length&&(this.menuItems.push(this.createSeparatorMenuItem()),(r=this.menuItems).push.apply(r,t||[])))},p.prototype.createShowValueAsMenuItem=function(e){var t=v(this.property);t.key={action:16};return t.text=this.localizationService.get("FieldWell_ShowValueAs"),t.children=e,t},p.prototype.createQuickCalcMenuItem=function(){var e=v(this.property);e.key={action:64};return e.text=this.localizationService.get("QuickCalc_NewMeasure"),e},p.prototype.createGroupsMenuItem=function(){var e=v(this.property);return e.key={action:256},e.text=this.localizationService.get("ContextMenuItem_CreateGroups"),e},p.prototype.createEditGroupsMenuItem=function(){var e=v(this.property);return e.text=this.localizationService.get("ContextMenuItem_EditGroups"),e.key={action:512},e},p.prototype.createEditClusteringMenuItem=function(){var e=v(this.property);return e.text=this.localizationService.get("Clustering_EditClusters"),e.key={action:1024},e},p.prototype.createRestoreHierarchyMenuItem=function(){var e=v(this.property);return e.text=this.localizationService.get("FieldWell_RestoreHierarchy"),e.key={action:2048},e},p.prototype.createVariationMenuItem=function(e,t){var i=v(this.property);return i.text=e,i.key={action:128,variationExpr:t},i},p.prototype.createShowAllMenuItem=function(){var e=v(this.property);return e.key={action:8},e.text=this.localizationService.get("FieldWell_ShowAll"),e},p.prototype.createDeleteMenuItem=function(){var e=v(this.property);return e.key={action:1},e.text=this.localizationService.get("FieldWell_Remove"),e},p.prototype.createSeparatorMenuItem=function(){var e=v(this.property);return e.type=1,e},p.prototype.createRenameMenuItem=function(){var e=v(this.property);return e.key={action:32768},e.text=this.localizationService.get("FieldWell_RenameForThisVisual"),e},p.prototype.createParameterToColumn=function(){var e=v(this.property);return e.key={action:8388608},e.text=this.localizationService.get("FieldParameter_ConvertParameterToColumn"),e},p.prototype.createColumnToParameter=function(){var e=v(this.property);return e.key={action:16777216},e.text=this.localizationService.get("FieldParameter_ConvertColumnToParameter"),e},p.prototype.createMoveToBucketsMenuItem=function(){for(var e=[],t=0,i=this.buckets;t<i.length;t++){var r,n=i[t];this.bucket.equals(n)||((r=v(this.property)).text=n.displayName,r.key={action:262144,moveFieldBucketOptions:{role:n.role,targetIndex:n.properties?n.properties.length:0,displayName:n.displayName}},e.push(r))}return e},p.prototype.createMoveToGroupMenuItem=function(){var e=v(this.property);return e.key={action:524288},e.text=this.localizationService.get("ItemAction_MoveTo"),e.children=this.createMoveToBucketsMenuItem(),e},p.prototype.createMoveUpMenuItem=function(){var e=v(this.property),t=(e.text=this.localizationService.get("ItemAction_Move_Up"),{action:65536}),i=this.findFieldPropertyIndexInBucket();return i<=0?e.disabled=!0:(i=this.bucket.properties[i-1],t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0}),e.key=t,e},p.prototype.createMoveDownMenuItem=function(){var e=v(this.property),t=(e.text=this.localizationService.get("ItemAction_Move_Down"),{action:131072}),i=this.findFieldPropertyIndexInBucket();return i>=this.bucket.properties.length-1?e.disabled=!0:(i=this.bucket.properties[i+1],t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0}),e.key=t,e},p.prototype.createMoveToTopMenuItem=function(){var e=v(this.property),t=(e.text=this.localizationService.get("ItemAction_Move_Top"),{action:65536}),i=this.bucket.properties[0];return this.property.equals(i)?e.disabled=!0:t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0},e.key=t,e},p.prototype.createMoveToBottomMenuItem=function(){var e=v(this.property),t=(e.text=this.localizationService.get("ItemAction_Move_Bottom"),{action:131072}),i=this.bucket.properties[this.bucket.properties.length-1];return this.property.equals(i)?e.disabled=!0:t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0},e.key=t,e},p.prototype.findFieldPropertyIndexInBucket=function(){var t=this;return _.findIndex(this.bucket.properties,(function(e){return t.property.equals(e)}))},p.prototype.createMoveGroupMenuItem=function(){var e=v(this.property);return e.key={action:524288},e.text=this.localizationService.get("ItemAction_Move"),e.children=[this.createMoveUpMenuItem(),this.createMoveDownMenuItem(),this.createMoveToTopMenuItem(),this.createMoveToBottomMenuItem()],e},d=p,e.createDropDownItems=function(e,t,i,r,n,a,o,s,l,u,c,p){return{items:h.visit(e.expr,new d(e,t,i,r,n,a,o,s,l,u,c,p))}}})(powerbi=powerbi||{}),(function(e){!(function(e){var t,e=e.viewModels||(e.viewModels={});function i(e,t,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];this.kind=e,this.name=i.format(t,r)}function r(e){return t.call(this,void 0,"ShowValueAs_Calculation_None",e)||this}e.ShowValueAsCalculation=i,__extends(r,t=i),e.ShowValueAsNoCalculation=r,__extends(a,n=i);var n;function a(e){return n.call(this,0,"ShowValueAs_Calculation_PercentOfGrandTotal",e)||this}e.ShowValueAsPercentOfGrandTotalCalculation=a,__extends(s,o=i);var o;function s(e,t,i){e=o.call(this,1,"ShowValueAs_Calculation_PercentOfRoleTotal",e,i)||this;return e.roles=t,e}e.ShowValueAsPercentOfRoleTotalCalculation=s})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(h){var s,S,a,l,o,b,t,E,e,i;function r(e,t,i){var r=!0,n=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&i.isFavoritePublicCustomVisual(e.name),a=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&e.favoriteId||n,n=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&!e.favoriteId&&!n,o=t&&t.featureSwitches.tenantOutOfBoxVisualsEnabled&&e.custom&&e.isOutOfBox,t=t&&t.featureSwitches.personalVisualizationPaneEnabled&&i.isUnpinnedVisual(e.name);return r=e.custom&&!o&&n||t&&!a?!1:r}function n(){this.sections=[],this.activeSection=S.VisualizationPaneSectionType.Fields,this.previousSection=S.VisualizationPaneSectionType.Fields,this.pagePaneSections=[],this.activePageSection=S.PagePaneSectionType.Fields,this.previousPageSection=S.PagePaneSectionType.Fields,this.isPaneExpanded=!1,this.isPaneVisible=!0,this.title="Format",this.icon="PBIFormat",this.visualPluginFilter=r,this.nonPersonalVisualizationPaneFilter=function(e,t,i){return!r(e,t,i)}}function c(e,t){return{contract:e,selected:!1,displayName:e.displayName,menuItems:S.ExplorationContainerViewModelFactory.createNavigationMenuItems(t)}}function u(e,t,i,r,n){return{isPaneVisible:n=void 0===n?!1:n,isPaneExpanded:r=void 0===r?!0:r,title:e,icon:t,closePaneLabel:i}}function p(){return{isPaneExpanded:!0,isPaneVisible:!0,title:"Data",icon:"PBIData"}}function d(){return new i}function v(e,t,i,r){var n=F(t,r=void 0===r?h.common.getLocalize():r);switch(e){case o.table.name:case o.tableEx.name:return{class:"table",title:n};case o.matrix.name:case o.pivotTable.name:return{class:"matrix",title:n};case o.scatterChart.name:return{class:"scatter",title:n};case o.barChart.name:return{class:"columnHoriz",title:n};case o.clusteredBarChart.name:return{class:"clusteredBarHoriz",title:n};case o.hundredPercentStackedBarChart.name:return{class:"column100Horiz",title:n};case o.ribbonChart.name:return{class:"ribbon",title:n};case o.columnChart.name:return{class:"columnVert",title:n};case o.clusteredColumnChart.name:return{class:"clusteredBarVert",title:n};case o.dataDotClusteredColumnComboChart.name:return{class:"dataDotClusteredColumnCombo",title:n};case o.dataDotStackedColumnComboChart.name:return{class:"dataDotStackedColumnCombo",title:n};case o.hundredPercentStackedColumnChart.name:return{class:"column100Vert",title:n};case o.realTimeLineChart.name:case o.lineChart.name:return{class:"line",title:n};case o.areaChart.name:return{class:"area",title:n};case o.stackedAreaChart.name:return{class:"stackedArea",title:n};case o.lineClusteredColumnComboChart.name:return{class:"lineClusteredColumnCombo",title:n};case o.lineStackedColumnComboChart.name:return{class:"lineStackedColumnCombo",title:n};case o.pieChart.name:return{class:"pie",title:n};case o.treemap.name:return{class:"tree",title:n};case o.sunburst.name:return{class:"sunburst",title:n};case o.map.name:return{class:"map",title:n};case o.filledMap.name:return{class:"filledMap",title:n};case o.azureMap.name:return{class:"azureMap",title:n};case o.shapeMap.name:return{class:"shapeMap",title:n};case o.funnel.name:return{class:"funnel",title:n};case o.gauge.name:return{class:"gauge",title:n};case o.multiRowCard.name:return{class:"card",title:n};case o.card.name:return{class:"calloutCard",title:n};case o.waterfallChart.name:return{class:"waterfall",title:n};case o.slicer.name:return{class:"slicerVert",title:n};case o.donutChart.name:return{class:"donut",title:n};case o.kpi.name:return{class:"kpi",title:n};case o.scriptVisual.name:return{class:"rScriptImageVisual",title:n};case o.pythonVisual.name:return{class:"pythonImageVisual",title:n};case o.debugVisual.name:return{class:"debugger",title:n};case o.textbox.name:return{class:"smartNarratives",title:n};case o.basicShape.name:case o.shape.name:case o.actionButton.name:case o.image.name:return{class:null,title:n};case o.keyDriversVisual.name:return{class:"keyDrivers",title:n};case o.qnaVisual.name:return{class:"qna",title:n};case o.decompositionTreeVisual.name:return{class:"decompositionTree",title:n};case o.scorecard.name:return{class:"scorecard",title:n};case o.rdlVisual.name:return{class:"rdlVisual",title:n};default:if(i&&i.isTrustedVisual(e)){var a=i.getVisualTypeOptions(e);if(a)return{class:a.class,title:a.titleKey?r.get(a.titleKey):e,watermarkKey:a.watermarkKey}}return}}function g(e,t,i){return v(e.name,e.titleKey,t,i)||{class:e.class,title:e.name}}function m(e,t,i,r,n,a){for(var o=[],s=0,l=e;s<l.length;s++){var u=l[s];r&&!r(u,t,i)||o.push(y(u,t,i,n,a))}return o}function y(e,t,i,r,n){var a=(n=void 0===n?h.common.getLocalize():n).get("AddToFavorites_ContextMenu"),o=n.get("RemoveFromFavorites_ContextMenu"),s=n.get("AboutVisualDialog_About"),l={plugin:e,enabled:!0,active:!1,menuItems:[]},r=g(e,r,n),n=(l.class=r.class,l.title=r.title,r.watermarkKey&&(e.watermarkKey=r.watermarkKey),t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&i.isFavoritePublicCustomVisual(e.name)),r=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&e.favoriteId||n,n=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&!e.favoriteId&&!n,u=t&&t.featureSwitches.tenantOutOfBoxVisualsEnabled&&e.custom&&e.isOutOfBox,c=t&&t.featureSwitches.personalVisualizationPaneEnabled&&i.isUnpinnedVisual(e.name),t=t&&t.featureSwitches.personalVisualizationPaneEnabled&&!i.isUnpinnedVisual(e.name),i=null,r=(e.custom&&r?i=f(o,4):e.custom&&!u&&n?i=f(a,3):c?i=f(a,7):e.custom&&!u||!t||(i=f(o,6)),i&&l.menuItems.push(i),e.custom&&(l.title=e.displayName||e.name.match(/([A-z\s]+)/g)[0]),f(s,5));return l.menuItems.push(r),l.tooltipConfig={tooltipTitle:l.title,tooltipShowOnFocus:!0},l}function f(e,t){return{text:e,hasGlyph:!1,labelClass:"visualContextMenu itemLabel",action:t,type:DropDownMenuItemType.Item,checked:!1,hrefTarget:jsCommon.DOMConstants.selfValue}}function C(o,s,l){l.hostServices={getFilters:function(e,t){return e.calculateVisualContainerFilter(o,s,l.contract,t)},getDataSourceVariables:function(){return o.dataSourceVariables},getVisualRelationshipFilterAction:function(e,t,i){return t.relationshipFilterAction(s,e,l.contract,i)},selectDataPoint:function(e,t,i,r,n,a){e.setFilterOnSelectData(o,t,s,l.contract,i,r,n,a)},setVisualRelationshipFilterAction:function(e,t,i,r){return r.setVisualRelationship(s,e,t,i)}}}function V(e,t,i,r){var n=new S.ExploreCanvas(t,i);if(t.visualContainers&&(n.visualContainers=l.extendWithId(_(t.visualContainers).map((function(e){return P(e,i,r)})).filter((function(e){return!!e})).value()),n.visualContainerGroups=1===i?__spreadArray([],n.visualContainers):x(t.visualContainerGroups,n.visualContainers,i,r),!_.isEmpty(n.visualContainers)))for(var a=0,o=n.visualContainers;a<o.length;a++)C(e,t,o[a]);return n}function x(e,i,r,n){for(var a=[],t=0,o=e;t<o.length;t++)!(function(t){var e;s.contracts.isVisualContainer(t)?(e=_.find(i,(function(e){return e.contract===t})))&&a.push(e):(e=w(t,x(t.children,i,r,n)))&&a.push(e)})(o[t]);return a}function w(e,t,i){if(e.layouts.withId(i=void 0===i?0:i)){for(var r=new S.VisualContainerGroup(e,i,t),n=0,a=t;n<a.length;n++)a[n].parentGroup=r;return r}}function P(e,t,i){void 0===t&&(t=0);var r=new a,n=e.layouts.withId(t);if(n)return n=n.position,r.position({y:n.y,x:n.x}),r.zIndex(n.z||0),r.viewport({height:n.height,width:n.width}),new S.VisualContainer(e,r,t,i)}function F(e,t){return void 0===t&&(t=h.common.getLocalize()),h.data.getDisplayName(e,t)}function A(e,t){var i=e.getDisplayName()?-1:1,r=t.getDisplayName()?-1:1;if(i!=r)return i-r;i=e.getDisplayName()||e.getRestatement()||"",r=t.getDisplayName()||t.getRestatement()||"";return i.localeCompare(r)}s=h.explore||(h.explore={}),S=s.viewModels||(s.viewModels={}),a=h.common.models.ApplyStyle,l=jsCommon.ArrayExtensions,o=h.visuals.plugins,b=h.data.SQExpr,t=jsCommon.StringExtensions,E=h.explore.util.VisualContainerUtils,S.isPersonalVisualizationPaneVisual=r,Object.defineProperty(n.prototype,"activeSectionIndex",{get:function(){var t=this,e=_.findIndex(this.sections,(function(e){return e.sectionType===t.activeSection}));return-1!==e?e:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"activePageSectionIndex",{get:function(){var t=this,e=_.findIndex(this.pagePaneSections,(function(e){return e.sectionType===t.activePageSection}));return-1!==e?e:0},enumerable:!1,configurable:!0}),i=n,S.VisualizationPaneViewModel=i,(e=S.ViewModelFactory||(S.ViewModelFactory={})).createExplorationContainer=function(){return{exploration:null,options:null,taskPane:p(),visualizationPane:d(),sectionStatus:{currentSectionNumber:-1,isEditing:!1},isNavPaneCollapsed:!0,performancePane:u("PerformanceAnalyzerPane_Title","PBIPerformanceAnalyzer","PerformanceAnalyzerPane_Close"),bookmarksPane:u("ExplorationBookmarksPane_Title","AudioBookmark","ExplorationBookmarksPane_Close"),canvasItemsPane:u("ExplorationCanvasItemsPane_Title","LaunchSelectionPane","ExplorationCanvasItemsPane_Close"),syncGroupPane:u("SyncGroupPane_Title","PBISyncSlicer"),insightsPane:u("Generic_Insights","PBIAnomalyExplain","InsightsPane_Close"),quickExplorePane:u("Summarize"),quickMeasuresPane:u("QuickMeasure","PBINewQuickMeasure","QuickMeasuresPane_Close"),buildSkittlePane:u("Skittles_Build_Title","PBIBuild",void 0,!1),chartElementsSkittlePane:u("Skittles_ChartElements_Title","PBIAddToChart",void 0,!1)}},e.convertSectionToViewModel=c,e.createExplorePane=u,e.createTaskPane=p,e.createVisualizationPane=d,e.createVisualTypesContainer=function(e){return{visuals:e}},e.getCustomVisualTypes=function(e){return m(_.filter(e,(function(e){return e.custom})))},e.getVisualTypeInfoByName=v,e.getVisualTypeInfo=g,e.getAvailableVisualTypes=m,e.getVisualType=y,e.convertExploration=function(e,t,i,r,n){var a=_.map(e.sections,(function(e){return c(e,n)})),o=e.sections;if(o&&0<o.length){var s=void 0!==i?i:0;if(s<o.length)for(var l=V(e,o[s],t,r),u=o.length-1;0<=u;--u)a[u].selected=u===s}return{contract:e,sections:a,exploreCanvas:l}},e.convertSectionToExploreCanvas=V,e.convertVisualContainerGroups=x,e.convertVisualContainerGroup=w,e.convertVisualContainerStandalone=P,e.convertVisualContainer=function(e,t,i,r){if(i=P(i,r))return C(e,t,i),i},e.getDisplayName=F,e.createFilterPane=function(e,t){return{isVisualVisible:!1,reportFilters:(t=void 0===t?!0:t)?[]:null,pageFilters:[],drillthroughFilters:[],visualFilters:[],activeFilterPane:void 0,addFilterLabel:e.get("FieldDropZone_AddFields"),addDrillthroughFilterLabel:e.get("FieldDropZone_DrillthroughLink_Watermark")}},e.createVisualFilters=function(e,t,r,i,n,a,o,s,l){for(var u=(null==(u=t.filters)?void 0:u.filter((function(e){return null!=e})))||[],c=[],p={container:t,scopeType:0},h=E.getAutoVisualFilterContainers(t,a,r,s),a=E.getAutoCrossDrillVisualFilterContainers(e,t,o,r),d=function(e){return S.FilterViewModelFactory.convertFilterContainer(e,r,i,p,n,s,l,E.getVisualCapabilities(t,n),t.config.singleVisual)},v=0,g=u;v<g.length;v++)!(function(t){var e=d(t);if(c.push(e),h){if(t.expression&&!_.isEmpty(t.expression.validate(r,s)))return;var i=_.findIndex(h,(function(e){return b.equals(e.expression,t.expression)}));-1===i?0===t.howCreated&&(e.howCreated=t.howCreated=1):(1===t.howCreated&&(e.howCreated=t.howCreated=0),2!==t.howCreated&&h.splice(i,1))}})(g[v]);if(h=h||[],e=(e=a||[]).concat(h),_.isEmpty(p.container.filters)&&(p.container.filters=[]),(o=p.container.filters).push.apply(o,h||[]),e)for(var m=0,y=e;m<y.length;m++){var f=y[m],C=d(f);C.howCreated=f.howCreated,c.push(C)}return c.sort(A),c},e.createFilters=function(e,t,i,r,n,a,o,s){var l=[];if(e&&e.container&&e.container.filters){for(var u=0,c=e.container.filters;u<c.length;u++){var p=c[u];null!=s&&p.howCreated!==s||(p.name||(p.name=h.explore.FilterUtils.getNextFilterName(e.container.filters)),p=S.FilterViewModelFactory.convertFilterContainer(p,t,i,e,r,n,a,o,null),l.push(p))}l.sort(A)}return l},e.createUniqueId=function(e){return _.map(e,(function(e){return t.replaceAll(e,"-","\\-")})).join("-")},e.sortFilterByDisplayName=A,e.sortFilterByOrdinal=function(e,t){var i=void 0===e.contract.ordinal?1:-1,r=void 0===t.contract.ordinal?1:-1;return-1==i&&-1==r?e.contract.ordinal-t.contract.ordinal:i-r}})(powerbi=powerbi||{}),(function(r){var e;(function(e){var t;Object.defineProperty(i.prototype,"thickness",{get:function(){return i.Width},enumerable:!1,configurable:!0}),i.prototype.getNumericPaddingFromBorder=function(){return i.calculatePadding(this.radius)},i.prototype.getBorderStyle=function(){var e;if(this.visible)return e=r.common.utils.ColorUtility.applyTransparency(this.color,1),i.Width+"px "+i.Style+" "+e},i.prototype.getPaddingFromBorder=function(){var e=i.calculatePadding(this.radius);if(this.visible)return e+"px"},i.prototype.getBorderRadius=function(){if(this.visible)return(this.radius||r.visuals.VisualBorderUtil.DefaultRadius)+"px"};function i(e){e&&(this.color=e.color.solid.color,this.visible=e.show,this.radius=e.radius)}e.VisualBorder=i,(t=e.VisualBorder||(e.VisualBorder={})).Width=1,t.Style="solid",t.DefaultPadding=0,t.paddingMultiple=Math.sin(Math.PI/180*45),t.calculatePadding=function(e){return Math.ceil(e-e*t.paddingMultiple)}})((e=r.explore||(r.explore={})).viewModels||(e.viewModels={}))})(powerbi=powerbi||{}),(function(o){var s;(function(e){var t=o.common.models.ApplyStyle,i=s.util.CanvasVisualsUtility,r=o.explore.constants.ExploreCanvasConstants,n=o.explore.util.VisualContainerUtils;function a(e,t,i){this.contract=e,this.currentCanvasLayout=t,this.children=i,this.uiScale=r.DefaultCanvasUiScale}function l(e){return!!e.children}a.prototype.setSelected=function(e){this.isSelected=e},Object.defineProperty(a.prototype,"id",{get:function(){return this.contract.id},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isHidden",{get:function(){return this.contract.isHidden},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"position",{get:function(){var e=this.currentCanvasLayout;return this.contract.layouts.withId(e).position},set:function(e){var t=this.currentCanvasLayout;this.contract.layouts.withId(t).position=e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isPositioned",{get:function(){var e=this.position;return 0!==e.width&&0!==e.height},enumerable:!1,configurable:!0}),a.prototype.startResize=function(){this.originalPosition=this.position;for(var e=0,t=this.children;e<t.length;e++)t[e].startResize()},a.prototype.getScaledPosition=function(){return this.scaledPosition||this.convertToScaledPosition(this.position)},a.prototype.convertToScaledPosition=function(e){return i.convertToScaledPosition(e,this.uiScale,!0)},a.prototype.updateViewportForUserResize=function(e){e=this.convertToScaledPosition(__assign(__assign({},e),{x:0,y:0}));this.updateStyle(e)},a.prototype.updateViewState=function(){this.scaledPosition=this.convertToScaledPosition(this.position);var e=o.Prototype.inherit(this.scaledPosition);this.updateStyle(e),this.setTooltip()},a.prototype.updateStyle=function(e){this.applyStyle||(this.applyStyle=new t);e=n.getVisualStyleAttributes(e,void 0,this.background&&this.background.colorRGB,this.border&&this.border.getBorderStyle(),this.border&&this.border.getBorderRadius(),this.border&&this.border.getPaddingFromBorder());this.applyStyle.addAttributes(e),this.applyStyle.apply()},a.prototype.setTooltip=function(){var e;this.tooltip=null==(e=null==(e=null==(e=this.contract.evaluatedObjects)?void 0:e.general)?void 0:e.altText)?void 0:e.toString()},a.prototype.clone=function(){var e=new a(this.contract,this.currentCanvasLayout,this.children);return _.assign(e,this)},e.VisualContainerGroup=a,e.traverseVisualContainerGroups=function e(t,i,r){for(var n=r&&r.visibleOnly,a=0,o=t;a<o.length;a++){var s=o[a];n&&s.isHidden||(i(s),l(s)&&e(s.children,i,r))}},e.isVisualContainerGroup=l,e.isVisualContainer=function(e){return!e.children}})((s=o.explore||(o.explore={})).viewModels||(s.viewModels={}))})(powerbi=powerbi||{}),(function(c){var y,f,p,o,i,a,s,l,h,d,n,r,u,v,g,m,C,S,b,e,E,V;function x(e,t,i,r){e=V.call(this,e,{footerStyle:null,headerBackgroundStyle:null,headerForegroundStyle:null,headerItemContainerStyle:null,popOutBarSubtitle:"",popOutBarTitle:"",position:null,style:t,titleStyle:null,visualViewportStyle:null})||this;return e.uiScale=n.DefaultCanvasUiScale,e.currentCanvasLayout=i,e.currentEditMode=0,e.visualTitleWrapped=[],e.currentZone=r,e.servicesState=f.Uninitialized,e}y=c.explore||(c.explore={}),p=y.viewModels||(y.viewModels={}),o=c.common.models.ApplyStyle,i=jsCommon.BrowserUtils,a=jsCommon.Color,s=c.visuals.ColorHelper,l=jsCommon.CssConstants,h=c.data.DataViewObjectDescriptors,d=y.util.DetailVisualUtils,n=c.explore.constants.ExploreCanvasConstants,r=c.a11y.util.FocusUtility,u=c.visuals.FontProperties,v=jsCommon.KeyUtils,g=c.TextMeasurementService,m=c.explore.util.VisualContainerUtils,C=y.contracts.VisualLink,S=y.contracts.VisualTitle,b=jsCommon.WordBreaker,e={key:void 0,defaultValue:!0,forceVisible:((e={})[1]=!0,e)},E={visualInformationButton:__assign(__assign({},e),{key:"showVisualInformationButton"}),visualWarningButton:__assign(__assign({},e),{key:"showVisualWarningButton"}),visualErrorButton:__assign(__assign({},e),{key:"showVisualErrorButton"}),drillRoleSelector:__assign(__assign({},e),{key:"showDrillRoleSelector"}),drillUpButton:__assign(__assign({},e),{key:"showDrillUpButton"}),drillToggleButton:__assign(__assign({},e),{key:"showDrillToggleButton"}),drillDownLevelButton:__assign(__assign({},e),{key:"showDrillDownLevelButton"}),drillDownExpandButton:__assign(__assign({},e),{key:"showDrillDownExpandButton"}),pinButton:__assign(__assign({},e),{key:"showPinButton"}),filterRestatementButton:__assign(__assign({},e),{key:"showFilterRestatementButton"}),focusModeButton:__assign(__assign({},e),{key:"showFocusModeButton"}),copyVisualImageButton:__assign(__assign({},e),{key:"showCopyVisualImageButton"}),seeDataLayoutToggleButton:__assign(__assign({},e),{key:"showSeeDataLayoutToggleButton"}),optionsMenu:__assign(__assign({},e),{key:"showOptionsMenu"}),commentButton:__assign(__assign({},e),{key:"showCommentButton"}),tooltipButton:{key:"showTooltipButton",defaultValue:!1},personalizeVisualButton:__assign(__assign({},e),{key:"showPersonalizeVisualButton"})},(e=f=f||{})[e.Uninitialized=0]="Uninitialized",e[e.Initialized=1]="Initialized",V=p.ViewModel,__extends(x,V),x.prototype.resolveDataAppliedEvent=function(){this.visual.dataAppliedEvent&&this.visual.dataAppliedEvent.resolve()},x.prototype.getRunningVisual=function(){return this.runningVisual},Object.defineProperty(x.prototype,"errorInfo",{get:function(){return this.runningVisual&&this.runningVisual.getErrorInfo()},set:function(e){var t=this.getRunningVisual();t&&t.setErrorInfo(e)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"visualPausedWarning",{get:function(){return this.visualPausedWarningModel},set:function(e){this.visualPausedWarningModel=e;var t=this.getRunningVisual();t&&t.setHasPendingChanges(void 0!==e)},enumerable:!1,configurable:!0}),x.prototype.setThemeCollection=function(e){this.themeCollection=e,this.runningVisual&&this.runningVisual.setThemeCollection(e),this.runningDetailVisual&&this.runningDetailVisual.setThemeCollection(e)},x.prototype.startResize=function(){this.originalPosition=this.position},x.prototype.getVisualType=function(){return m.getVisualType(this.contract)},x.getVisualBodyOffset=function(e,t){return x.useStylableHeader(t)||e.canShowVisualContainerHeaderInset()?{top:0,height:0,width:0,left:0}:{top:this.VisualContainerHeaderHeight,height:-this.VisualContainerHeaderHeight,width:0,left:0}},Object.defineProperty(x.prototype,"id",{get:function(){return this.contract.id},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"position",{get:function(){var e=this.currentCanvasLayout;return this.contract.layouts.withId(e).position},set:function(e){var t=this.currentCanvasLayout;this.contract.layouts.withId(t).position=e},enumerable:!1,configurable:!0}),x.prototype.getScaledPosition=function(e){return this.convertToScaledPosition(this.position,e=void 0===e?!0:e)},Object.defineProperty(x.prototype,"editMode",{get:function(){return this.currentEditMode},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"headerMaxLines",{get:function(){return this.isTitleWrappingEnabled?3:1},enumerable:!1,configurable:!0}),x.prototype.setEditMode=function(e){this.currentEditMode=e,m.updateVisual(this.runningVisual,this.runningVisual.getViewport(),c.VisualUpdateType.ViewMode,this.visualHostServices,this.editMode)},Object.defineProperty(x.prototype,"isPositioned",{get:function(){var e=this.position;return 0!==e.width&&0!==e.height},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"isPoppedOut",{get:function(){var e=this.contract.visibility;return null!=e&&0!==e&&4!==e},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"bringToFront",{get:function(){var e=this.contract.config.singleVisual.evaluatedObjects;return!e||!e.general||!e.general.keepLayerOrder},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"isHidden",{get:function(){return y.contracts.VisualContainer.isHidden(this.contract.config.singleVisual)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"isTitleWrappingEnabled",{get:function(){return this.visualTitle&&!!this.visualTitle.titleWrap},enumerable:!1,configurable:!0}),x.prototype.visualTitleVisible=function(){var e=this.contract.config.singleVisual,t=e.evaluatedObjects&&e.evaluatedObjects.title,i=t&&t.text,e=this.visualPlugin&&this.visualPlugin.capabilities(e.visualType),r=!1;return(t&&i||this.visualTitle&&this.visualTitle.text)&&(r=!0),!S.isHidden(t,e&&e.suppressDefaultTitle)&&e&&(!e.suppressDefaultTitle||e.suppressDefaultTitle&&i)&&""!==i&&r&&!this.isPoppedOut},x.prototype.supportsKeyboardNavigation=function(){var e=this.contract.config.singleVisual,e=this.visualPlugin&&this.visualPlugin.capabilities(e.visualType);return e&&e.supportsKeyboardFocus},x.prototype.setServices=function(e,t,i,r,n,a,o,s,l,u,c,p,h,d,v,g,m){this.visualHostServices=y.helpers.VisualHostInsideZoneAdapter.wrapHostServices(e,p),this.visualAdapterHostServices=m,this.visualPlugin=t,this.visualPluginOps=i,this.viewModeState=r,this.formFactor=n,this.visibility=a,this.runningVisuals=o,this.explorationCapabilities=g,this.visualAuthoring=l,this.filterGenerator=u,this.themeService=c,this.showClientWarnings=h,this.sortServices=d,this.selectionServices=v,this.servicesState=f.Initialized},x.prototype.setSelected=function(e){this.isSelected=e},x.prototype.handleKeyDown=function(e){switch(function(e){switch(e.keyCode){case 122:return e.altKey&&e.shiftKey?0:void 0;case 70:return i.isCtrlOrMeta(e)?1:void 0}}(e)){case 0:this.visibility.set(this.contract,8);break;case 1:this.toggleVisualSearch(e)}if(this.shouldHandleKeydown(e)){if(this.isTextboxVisual())return(t=this.getTextboxVisual())&&t.focus();if(this.isContractQnaVisual()){var t=this.getQnaVisual();if(t)return t.focus()}}},x.prototype.toggleVisualSearch=function(e){var t;this.contract&&this.contract.config&&this.contract.config.singleVisual&&(t=this.contract.config.singleVisual.visualType,(t=this.visualPlugin&&this.visualPlugin.capabilities(t))&&this.filterGenerator.tryGetSelfFilterEnabledProperty(t)&&(this.visualAuthoring.toggleSlicerVisualSearch(this.contract,this.filterGenerator,this.visualPlugin),e.preventDefault(),e.stopPropagation()))},x.prototype.shouldHandleKeydown=function(e){if(!this.runningVisual)return!1;if(0===this.viewModeState.getMode())return!1;var t=e.keyCode;if(v.isArrowKey(t)||v.isNudgeModifierKey(t))return!1;if(27===t||9===t||18===t||13===t||i.isCtrlOrMeta(e))return!1;t=this.contract.toolbar&&this.contract.toolbar.element;return!t||!r.isFocusInTree(t)},x.prototype.setVisualTitle=function(e){var t="",i="";(this.visualTitle=e)&&(e.titleComponents&&e.titleComponents.title?t=e.titleComponents.title:e.text&&(t=e.text),e.titleComponents&&e.titleComponents.subtitle&&(i=e.titleComponents.subtitle)),this.readOnlyState.popOutBarTitle=t,this.readOnlyState.popOutBarSubtitle=i},x.prototype.setTooltip=function(){var e=m.getVisualType(this.contract),t=this.getVisualLinkTypeLabel(e)||"",i=null==(i=null==(i=this.visualPlugin)?void 0:i.capabilities(e))?void 0:i.ariaRole,r=this.visualPlugin&&this.visualPlugin.getPlugin(e),r=(r&&(n=(n=this.ariaMetadata&&this.ariaMetadata.subtitleDisplayNameGetter)?" "+p.ViewModelFactory.getDisplayName(n):"",e=p.ViewModelFactory.getVisualType(r).title+n),this.visualTitle),n=void 0!==(null==r?void 0:r.text)&&r.text+" "||"",r=this.contract.config.singleVisual,r=r.evaluatedObjects&&r.evaluatedObjects.general&&r.evaluatedObjects.general.altText?" "+r.evaluatedObjects.general.altText:"";this.tooltip=""+n+t+e+r,this.ariaLabel=""+n+t+r,this.ariaRole="group",this.ariaRoleDescription=null!=i?i:e,"table"===this.ariaRoleDescription.trim().toLowerCase()&&(this.ariaRoleDescription="")},x.prototype.getVisualLinkTypeLabel=function(e){e=this.visualPlugin&&this.visualPlugin.capabilities(e);if(e&&e.supportsVisualLink){var t,e=this.contract.config.singleVisual,e=e.evaluatedObjects&&e.evaluatedObjects.visualLink;if(e&&e.show)return t=C.getType(e),e=_.find(C.Type.members(),(function(e){return e.value===t})).displayName,p.ViewModelFactory.getDisplayName(e)+" "}},x.prototype.setHeaderTooltip=function(){var e=this.contract.config.singleVisual,t=e.evaluatedObjects&&e.evaluatedObjects.visualHeader,e=e.evaluatedObjects&&e.evaluatedObjects.visualHeaderTooltip;t&&t.showTooltipButton&&e?this.headerTooltip=e:this.headerTooltip=void 0},x.prototype.redrawVisual=function(){this.runningVisual&&m.updateVisual(this.runningVisual,this.runningVisual.getViewport(),c.VisualUpdateType.Resize,this.visualHostServices,this.editMode)},x.prototype.updateVisualViewportForUserResize=function(e){var t=this.themeService&&this.themeService.getVisualStyle(this.themeCollection),i=this.runningVisual,r=(this.enableVisualScaling?(e.width/=this.uiScale.x,this.visualBorder&&(e.width-=2*this.visualBorder.thickness),this.useStylableHeader()||(e.height-=x.VisualContainerHeaderHeight),e.height/=this.uiScale.y,this.visualBorder&&(e.height-=2*this.visualBorder.thickness)):this.useStylableHeader()||(e.height-=x.VisualContainerHeaderHeight),this.isFooterVisible&&this.isFooterVisible()&&(e.height-=x.VisualContainerFooterHeight),this.getVisualViewport(e.width,e.height,1,t)),i=(i&&(this.viewportResized=!0,m.updateVisual(i,r,c.VisualUpdateType.Resize,this.visualHostServices,this.editMode,1)),this.hasDetailVisual()&&m.updateVisual(this.runningDetailVisual,r,c.VisualUpdateType.Resize,this.visualHostServices,this.editMode,1),this.applyVisualBodyStyle(this.readOnlyState,e),this.applyFooterStyle(this.readOnlyState,e.width),this.position),r=this.overridePosition||this.convertToScaledPosition(i);this.applyTitleStyle(this.readOnlyState,r.width,t)},x.prototype.shouldUseCache=function(){return m.shouldUseQueryCache(this.contract,this.options.disableQueryCacheUpdates)},x.prototype.adjustForVisualContainerHeader=function(e,t,i){this.formFactor&&this.formFactor.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()||(i&&(e.y+=t),e.height-=t)},x.prototype.convertToScaledPosition=function(e,t){void 0===t&&(t=!0);var i=this.viewModeState&&this.viewModeState.getConfig().displayOptions.disablePixelValueRounding,e=y.util.CanvasVisualsUtility.convertToScaledPosition(e,this.uiScale,!i);return this.adjustForVisualContainerHeader(e,this.useStylableHeader()?0:-x.VisualContainerHeaderHeight,t),e},x.prototype.reset=function(){var e=this.visual;e&&(e.data=void 0,e.dataTransforms=void 0,e.hostServices=c.visuals.defaultVisualHostServices,e.visualAdapterHostServices={getNextDataSegment:function(){return new c.Promise(function(e,t){return t(new Error("Visual reset"))})},startProgressBar:_.noop,stopProgressBar:_.noop}),this.runningVisuals&&this.runningVisuals.removeVisual(this.contract),this.runningVisual=void 0,this.showClientWarnings=void 0,this.visualHostServices=void 0,this.visualAdapterHostServices=void 0},x.prototype.updateViewStateCore=function(e){var t,i,r,n,a,o,s,l,u;this.servicesState===f.Initialized&&(o=(o=this.viewModeState&&this.viewModeState.getConfig())&&o.displayOptions,t=this.themeService&&this.themeService.getVisualStyle(this.themeCollection),i=this.contract,r=this.position,n=this.overridePosition||this.convertToScaledPosition(r),a=c.Prototype.inherit(n),u=!this.useStylableHeader()||this.isPoppedOut,this.enableVisualScaling?this.overridePosition?(u&&(a.height-=x.VisualContainerHeaderHeight),a.height/=this.uiScale.y,a.width/=this.uiScale.x):(a=c.Prototype.inherit(r),this.formFactor&&this.formFactor.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()&&u&&(a.height-=x.VisualContainerHeaderHeight/this.uiScale.y)):u&&(a.height-=x.VisualContainerHeaderHeight),this.isFooterVisible&&this.isFooterVisible()&&(a.height-=x.VisualContainerFooterHeight),!this.isPoppedOut||o&&o.hideInFocusBar||(u=p.VisualContainer.PopOutBarHeight,this.enableVisualScaling&&(u/=this.uiScale.y),a.height-=u),o=this.getVisualViewport(a.width,a.height,this.uiScale.x,t),u=i.config.singleVisual,e.isFilterVisual=!1,u&&(this.showWatermark=!1,this.canPin=!0,s=u.visualType,(l=this.visualPlugin&&this.visualPlugin.capabilities(s))&&(e.isFilterVisual=null!=h.findFilterOutput(l.objects)),u.query?(u=u.query.defn)&&(u=u.orderBy(),e.actualSortDirection=u&&u.length?u[0].direction:void 0):this.visualPluginOps&&this.visualPluginOps.isQueryVisual(s)&&"debugVisual"!==s&&(this.canPin=!1,this.viewModeState&&l?this.showWatermark=!(l.supportsLandingPage&&(1===this.viewModeState.getMode()||l.supportsEmptyDataView)):this.showWatermark=!0),this.updateVisualDefinition(o),!this.visual||this.runningVisuals.getVisual(this.contract)&&this.runningVisual||(this.runningVisual=m.wrapRunningVisual(this.visual,this.visualHostServices,this.editMode,this.contract.config.singleVisual,this.hostServices,this.filterGenerator,this.showClientWarnings,this.sortServices,this.selectionServices),this.runningVisuals.setVisual(this.contract,this.runningVisual)),this.hasDetailVisual()?e.detailVisual||(u=d.getDetailVisualViewport(o,this.contract.detailVisualLayout),this.showVisualCalcEditor()&&(u=d.takeOutSpaceFromViewport(u,33,0)),e.detailVisual={parentContract:this.contract,visual:{viewport:u,themeCollection:this.themeCollection,allowInvalidDataView:!0,hostServices:null,visualName:this.contract.name+"-detail"},hasData:!1},this.runningDetailVisual||(this.runningDetailVisual=m.wrapRunningVisual(e.detailVisual.visual,this.visualHostServices,this.editMode,this.contract.config.singleVisual,this.hostServices,this.filterGenerator,this.showClientWarnings))):(e.detailVisual=null,this.runningDetailVisual=void 0),this.setViewport(e,o)),e.position=__assign(__assign({},n),{z:null!=this.zIndexOverride?this.zIndexOverride:r.z||0,angle:r.angle||0}),this.applyTitleStyle(e,n.width,t),this.applyVisualBodyStyle(e,a),this.applyFooterStyle(e,a.width),this.applyHeaderStyle(e),this.setHeaderItemVisibility(e),this.setTooltip(),this.setHeaderTooltip(),i&&i.postProcessing&&this.configureInitializationSpinner(i.postProcessing))},x.prototype.isHeaderItemVisible=function(e){return!this.readOnlyState.itemVisibility||this.readOnlyState.itemVisibility[e]},x.prototype.isDeprecationWarningVisible=function(){return 1===this.viewModeState.getMode()&&void 0!==this.customVisualDeprecatedWarningInfo},x.prototype.isWarningVisible=function(){return this.isHeaderItemVisible("visualWarningButton")&&void 0!==this.warningInfo},x.prototype.isErrorVisible=function(){return this.isHeaderItemVisible("visualErrorButton")&&void 0!==this.transformWarningInfo},x.prototype.isInfoVisible=function(){return this.isHeaderItemVisible("visualInformationButton")&&void 0!==this.visualInfo},x.prototype.isInfoVersionsVisible=function(){return this.isHeaderItemVisible("visualInformationButton")&&void 0!==this.versionsInfo},x.prototype.isHeaderTooltipVisible=function(){return this.isHeaderItemVisible("tooltipButton")},x.prototype.isAnyIconVisible=function(){return this.isDeprecationWarningVisible()||this.isWarningVisible()||this.isErrorVisible()||this.isInfoVersionsVisible()||this.isInfoVisible()||this.isHeaderTooltipVisible()},x.prototype.anyHeaderItemVisible=function(e){if(e)for(var t=0,i=e;t<i.length;t++){var r=i[t];if(this.isHeaderItemVisible(r))return!0}return!1},x.prototype.isTextboxVisual=function(){return this.contract.config.singleVisual.visualType===c.visuals.plugins.textbox.name},x.prototype.getTextboxVisual=function(){return this.isTextboxVisual(),this.tryGetUnwrappedVisual()},x.prototype.isContractAnalysisVisual=function(){var e=this.contract.config.singleVisual.visualType;return this.visualPluginOps.isAnalysisVisual(e)},x.prototype.isDefinitionAnalysisVisual=function(){var e=this.visual&&this.visual.type;return this.visualPluginOps.isAnalysisVisual(e)},x.prototype.isContractQnaVisual=function(){var e=this.contract.config.singleVisual.visualType;return this.visualPluginOps.isQnaVisual(e)},x.prototype.getQnaVisual=function(){return this.isContractQnaVisual(),this.tryGetUnwrappedVisual()},x.prototype.isDefinitionQnaVisual=function(){var e=this.visual&&this.visual.type;return this.visualPluginOps.isQnaVisual(e)},x.prototype.setInitialLoadTelemetryParent=function(e){this.visual,this.visual.initialLoadActivity=e},x.prototype.tryGetUnwrappedVisual=function(){var e=null==(e=this.runningVisual)?void 0:e.getAdapter();return e?e.unwrap?e.unwrap():e:void 0},x.prototype.setHeaderItemVisibility=function(e){var t,i=(i=e.itemVisibility)||(e.itemVisibility={}),r=this.viewModeState&&this.viewModeState.getMode(),e=this.contract.config.singleVisual,n=this.useStylableHeader()?e.evaluatedObjects&&e.evaluatedObjects.visualHeader:void 0;for(t in E){var a=E[t],o=a.key,s=a.defaultValue,a=a.forceVisible,l=void 0;l=a&&void 0!==a[r]?a[r]:void 0!==(a=n&&n[o])?a:s,i[t]=l}},x.prototype.applyHeaderStyle=function(e){var t=this.contract.config.singleVisual,t=this.useStylableHeader()?t.evaluatedObjects&&t.evaluatedObjects.visualHeader:void 0;this.applyItemContainerStyle(e,t),this.applyHeaderBackgroundStyle(e,t),this.applyHeaderForegroundStyle(e,t)},x.prototype.applyItemContainerStyle=function(e,t){var i,r,n={"background-color":"","border-color":""};this.useStylableHeader()&&t&&(!t.background&&null==t.transparency&&null==t.border||(i=t.background&&t.background.solid?a.parseColorString(t.background.solid.color):{R:255,G:255,B:255},r=t.border&&t.border.solid?a.parseColorString(t.border.solid.color):i,null!=t.transparency?r.A=i.A=1-t.transparency/100:(null==i.A&&(i.A=1),null==r.A&&(r.A=1)),n["background-color"]=a.rgbString(i),n["border-color"]=a.rgbString(r))),e.headerItemContainerStyle||(e.headerItemContainerStyle=new o),e.headerItemContainerStyle.addAttributes(n),e.headerItemContainerStyle.apply()},x.prototype.applyHeaderBackgroundStyle=function(e,t){var i,r={"background-color":""};this.useStylableHeader()&&t&&(!t.background&&null==t.transparency||(i=t.background&&t.background.solid?a.parseColorString(t.background.solid.color):x.VisualHeaderBackgroundColor,null!=t.transparency?i.A=1-t.transparency/100:null==i.A&&(i.A=1-x.VisualHeaderTransparency/100),r["background-color"]=a.rgbString(i))),e.headerBackgroundStyle||(e.headerBackgroundStyle=new o),e.headerBackgroundStyle.addAttributes(r),e.headerBackgroundStyle.apply()},x.prototype.applyHeaderForegroundStyle=function(e,t){var i={color:""};this.useStylableHeader()&&t&&t.foreground&&t.foreground.solid&&(i.color=t.foreground.solid.color),e.headerForegroundStyle||(e.headerForegroundStyle=new o),e.headerForegroundStyle.addAttributes(i),e.headerForegroundStyle.apply()},x.prototype.applyVisualBodyStyle=function(e,t){e.visualViewportStyle||(e.visualViewportStyle=new o);var i=null==(i=this.themeService)?void 0:i.getVisualStyle(this.themeCollection),i=(null!=i&&i.isHighContrast&&this.visualDropShadow&&(this.visualDropShadow.color=s.getThemeColor(i,"foreground")),m.getVisualStyleAttributes(t,this.enableVisualScaling?this.uiScale.x:void 0,this.visualBackground&&this.visualBackground.colorRGB,this.visualBorder&&this.visualBorder.getBorderStyle(),this.visualBorder&&this.visualBorder.getBorderRadius(),this.visualBorder&&this.visualBorder.getPaddingFromBorder(),this.visualDropShadow&&this.visualDropShadow.getBoxShadow()));e.visualViewportStyle.addAttributes(i),e.visualViewportStyle.apply()},x.prototype.applyFooterStyle=function(e,t){var i,r;this.isFooterVisible&&this.isFooterVisible()&&(i={},e.footerStyle||(e.footerStyle=new o),r=this.enableVisualScaling?this.uiScale.x:1,i.transform="scale("+r+")",i.width=t+"px",e.footerStyle.addAttributes(i),e.footerStyle.apply())},x.prototype.applyTitleStyle=function(e,t,i){var r,n,a={};this.visualTitleVisible()?(a[l.visibilityProperty]=l.visibleValue,r=(r=this.contract.config.singleVisual).evaluatedObjects&&r.evaluatedObjects.title||{},i=this.getTitleFontProperties(r,i),a[l.fontSizeProperty]=i.size.pt+"pt"||"",a[l.fontFamilyProperty]=""+i.family||"",a[l.colorProperty]=""+i.color||"",a[l.textAlignProperty]=r.alignment||"",a[l.backgroundColorProperty]=r.background&&r.background.solid&&r.background.solid.color||"",n=this.isTitleWrappingEnabled?this.visualTitleWrapped.length:1,a[l.heightProperty]=n*m.getTitleHeight(i),this.insetHeaderSize?this.isTitleWrappingEnabled||(n=(t-this.insetHeaderSize.width)/this.uiScale.x,a[l.widthProperty]=n+"px"):a[l.widthProperty]="",a[l.fontWeightProperty]=r.bold?l.boldValue:"",a[l.fontStyleProperty]=r.italic?l.italicValue:"",a[l.textDecoration]=r.underline?l.underlineValue:""):a[l.visibilityProperty]=l.hiddenValue,e.titleStyle||(e.titleStyle=new o),e.titleStyle.addAttributes(a),e.titleStyle.apply()},x.prototype.updateVisualDefinition=function(e){var t,i=this.contract.config.singleVisual,r=i.visualType;this.visual?((t=this.visual).type!==i.visualType?(t.data=null,this.visualHostServices.onClearLicenseNotification()):this.showWatermark&&this.visualHostServices.onClearLicenseNotification(),t.visualName,this.contract.name,t.type=r,t.stylePresetName=i.evaluatedObjects&&i.evaluatedObjects.stylePreset&&i.evaluatedObjects.stylePreset.name,t.hostServices=this.visualHostServices,t.visualAdapterHostServices=this.visualAdapterHostServices,t.orderIndependentSelectorMatching=i.queryOptions&&i.queryOptions.keepProjectionOrder,this.visualPluginOps&&(this.visual.visualRequiresData=this.visualPluginOps.isQueryVisual(r)),this.visual.visualHasData=!!i.query,this.visual.currentZone=this.currentZone):this.visualHostServices&&(this.visual={viewport:e,type:r,visualName:this.contract.name,dataTransforms:{objects:i.objects},hostServices:this.visualHostServices,visualAdapterHostServices:this.visualAdapterHostServices,interactivityOptions:{dragDataPoint:!1,selection:!0,isVisualInteractive:!0},allowInvalidDataView:!0,visualPlugin:this.visualPlugin,themeCollection:this.themeCollection,orderIndependentSelectorMatching:i.queryOptions&&i.queryOptions.keepProjectionOrder},this.visualPluginOps&&(this.visual.visualRequiresData=this.visualPluginOps.isQueryVisual(r)),this.visual.visualHasData=!!i.query)},x.prototype.setViewport=function(e,t){this.runningVisual&&this.setVisualViewport(this.runningVisual,t),this.runningDetailVisual&&(t=d.getDetailVisualViewport(t,this.contract.detailVisualLayout),this.showVisualCalcEditor()&&(t=d.takeOutSpaceFromViewport(t,33,0)),this.setVisualViewport(this.runningDetailVisual,t))},x.prototype.setVisualViewport=function(e,t){var i,r,n;e&&t&&(i=this.viewportResized,this.viewportResized=void 0,n=this.enableVisualScaling?this.uiScale.x:1,!i&&(r=e.getViewport())&&r.height===t.height&&r.width===t.width&&r.scale===n||e.setViewport(__assign(__assign({},t),{scale:n}),i))},x.prototype.getVisualViewport=function(e,t,i,r){var n=0,a=(this.visualBorder&&this.visualBorder.visible&&(n=this.visualBorder.getNumericPaddingFromBorder()),this.isPaddingDisabled?2*n:p.VisualContainer.VisualContainerPaddingRight+p.VisualContainer.VisualContainerPaddingLeft+2*n),n=this.isPaddingDisabled?2*n:p.VisualContainer.VisualContainerPaddingTop+p.VisualContainer.VisualContainerPaddingBottom+2*n,o=0,s=0,e=e-a,r=(this.visualTitleVisible()&&(r=this.getTitleFontProperties(this.visualTitle,r),this.updateVisualTitleWrapping(e,r),o=m.getTitleHeight(r),o*=this.visualTitleWrapped.length||1),this.visualPausedWarning&&(s+=x.VisualBannerHeight),t-n-o-s),t=this.viewModeState&&this.viewModeState.getConfig().displayOptions.showDetailVisualOnFullScreen;return this.hasDetailVisual()&&!t&&(1===(this.contract.detailVisualLayout||1)?r=(r-n)/2:e=(e-a)/2),{width:Math.max(e,0),height:Math.max(r,0),scale:i}},x.prototype.getTitleFontProperties=function(e,t){var i=c.DataViewObject.getValue(e,"bold"),r=c.DataViewObject.getValue(e,"italic"),n=c.DataViewObject.getValue(e,"underline"),a={color:"fontColor",family:"fontFamily",size:"fontSize"},i=(i&&(a.bold="bold"),r&&(a.italic="italic"),n&&(a.underline="underline"),s.create(t));return c.visuals.FontProperties.createFromObjectOrStyle(e,a,i,t,void 0,y.util.VisualContainerUtils.DefaultTitleTextClass,y.util.VisualContainerUtils.DefaultTitleFontProperties)},x.prototype.updateVisualTitleWrapping=function(e,t){var i,r;this.visualTitle&&this.visualTitle.text&&(i=u.toTextProperties(t),(r=new o).addAttributes({width:e+"px"}),r.addAttributes({fontSize:t.size.px+"px"}),r.addAttributes({fontWeight:""+t.weight}),1===this.headerMaxLines?this.visualTitleWrapped=[{text:this.visualTitle.text.trim(),style:r}]:(t=b.splitByWidth(this.visualTitle.text,i,g.measureSvgTextWidth,e,this.headerMaxLines,null,!0),this.visualTitleWrapped=t.map((function(e){return{text:e.trim(),style:r}}))))},x.prototype.hasDetailVisual=function(){return this.showDetailVisual()||this.showVisualCalcEditor()},x.prototype.showDetailVisual=function(){return 2===this.contract.visibility||8===this.contract.visibility},x.prototype.showVisualCalcEditor=function(){return 16===this.contract.visibility},x.prototype.useStylableHeader=function(){return x.useStylableHeader(this.explorationCapabilities)},x.useStylableHeader=function(e){return e&&e.getCapabilities().visualContainerOptions.useStylableHeader},x.prototype.configureInitializationSpinner=function(e){var t=this;this.showInitializationSpinner=!0,e.catch((function(e){})).finally((function(){t.showInitializationSpinner=!1,t.contract.postProcessing=void 0}))},x.VisualContainerHeaderHeight=20,x.VisualContainerFooterHeight=34,x.VisualContainerPadding=5,x.VisualContainerPaddingTop=5,x.VisualContainerPaddingRight=5,x.VisualContainerPaddingBottom=5,x.VisualContainerPaddingLeft=5,x.PopOutBarHeight=40,x.HeaderInTitleScaleThreshold=.9,x.VisualBannerHeight=38,x.VisualBannerPaddingTopPopOutMode=3,x.VisualHeaderBackgroundColor={R:255,G:255,B:255},x.VisualHeaderTransparency=0,e=x,p.VisualContainer=e})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={}),(t=e.VisualizationPaneSectionType||(e.VisualizationPaneSectionType={}))[t.Fields=0]="Fields",t[t.Format=1]="Format",t[t.Analytics=2]="Analytics",(t=e.PagePaneSectionType||(e.PagePaneSectionType={}))[t.Fields=0]="Fields",t[t.Format=1]="Format"})(powerbi=powerbi||{}),(function(t){var i,e,r,n,a,o,s,p;function c(e,t,i,r,n,a,o,s,l,u){this.clipboardService=e,this.selectionService=t,this.viewModeState=i,this.undoRedoService=r,this.visualAuthoring=n,this.eventBridge=a,this.visibilityService=o,this.formFactor=s,this.layoutAuthoring=l,this.telemetryService=u,this.debouncedLogScanKeyEvent=_.debounce(this.logScanKeyEvent,c.DebounceWait)}i=t.explore||(t.explore={}),e=i.services||(i.services={}),r=t.explore.util.CanvasVisualsUtility,n=jsCommon.DOMConstants,a=jsCommon.FocusNavigationUtility,o=t.a11y.util.FocusUtility,s=i.services.selectionUtils,e.createCanvasKeyHandlerService=function(e,t,i,r,n,a,o,s,l,u,c){return new p(e,t,r,n,a,o,s,l,u,c)},c.prototype.getVisualInteractivityDisabled=function(){return this.visualInteractivityDisabled},c.prototype.setVisualInteractivityDisabled=function(e){this.visualInteractivityDisabled=!!e},c.prototype.onKeyDown=function(e,t){if(this.debouncedLogScanKeyEvent(e),this.isSaveEvent(e))return this.onSave(),this.preventStopAndReturnFalse(e);if(this.isClearEvent(e))return this.onClear(),this.preventStopAndReturnFalse(e);var i=this.formFactor.getCurrentLayoutCapabilities();if(0!==this.viewModeState.getMode()){if(this.isDeleteEvent(e)&&!this.isFocusedOnTextElement()&&!this.visibilityService.get())return i.canRemoveVisualFromLayout()?this.onRemoveFromLayout(e,t):i.canDelete()&&this.onDelete(e,t),this.preventStopAndReturnFalse(e);var r=e.which;if(this.isCtrlOrMeta(e)&&!this.isFocusedOnTextElement()){var n=!_.isEmpty(this.selectionService.getSelectedElements());switch(r){case 65:return this.onSelectAll(e,t),this.preventStopAndReturnFalse(e);case 67:return!i.canCutCopyPaste()||!n||(this.onCopy(e),this.preventStopAndReturnFalse(e));case 88:return!i.canCutCopyPaste()||!n||(this.onCut(e),this.preventStopAndReturnFalse(e));case 86:return i.canCutCopyPaste()&&this.onPaste(e),this.preventStopAndReturnFalse(e);case 89:return this.onRedo(),this.preventStopAndReturnFalse(e);case 90:return this.onUndo(),this.preventStopAndReturnFalse(e);case 191:return this.onShowQna(),this.preventStopAndReturnFalse(e);case 71:return e.shiftKey?this.onUnGroup():this.onGroup(),this.preventStopAndReturnFalse(e);case 77:return this.onMergeGroup(),this.preventStopAndReturnFalse(e)}}}return i.canPassUnhandledKeysToSelectedVisual()?this.allowSelectedVisualContainerToHandle(e,t):void 0},c.prototype.logScanKeyEvent=function(e){0!==this.viewModeState.getMode()||this.isFocusedOnTextElement()||e.ctrlKey||e.metaKey||e.altKey||!_.includes(n.scanModeKeys,e.keyCode)||this.telemetryService.logEvent(t.telemetry.EXScanModeKeyPressed)},c.prototype.isFocusedOnTextElement=function(){var e=document.activeElement;return a.isElementContentEditable(e)||a.isTextElement(e)},c.prototype.allowSelectedVisualContainerToHandle=function(e,t){if(!this.visualInteractivityDisabled&&o.isFocusInTree(".visualContainer")){var i=s.getSelectedVisual(this.selectionService);if(i){t=r.findVisualContainerViewModel(t.visualContainers,i);if(t)return t.handleKeyDown(e)}}},c.prototype.preventStopAndReturnFalse=function(e){return e&&(e.preventDefault(),e.stopPropagation()),!1},c.prototype.onUndo=function(){this.undoRedoService.undo()},c.prototype.onRedo=function(){this.undoRedoService.redo()},c.prototype.onCopy=function(e){this.canCopyOrCut()&&this.clipboardService.copy()},c.prototype.onCut=function(e){this.canCopyOrCut()&&this.clipboardService.cut()},c.prototype.onPaste=function(e){this.clipboardService.paste()},c.prototype.onRemoveFromLayout=function(e,t){this.layoutAuthoring.removeLayoutFromSelectedVisuals(t)},c.prototype.onDelete=function(e,t){var i=this;this.undoRedoService.register("CanvasKeyDelete",(function(){i.visualAuthoring.deleteSelectedVisuals(t)}))},c.prototype.onSelectAll=function(e,t){t=t.visualContainerGroups?_.map(t.visualContainerGroups,(function(e){return e.contract})):_.map(t.visualContainers,(function(e){return e.contract}));s.selectCanvasItems(t,this.selectionService)},c.prototype.onSave=function(){this.eventBridge.publishToChannel(e.events.saveKeyPressedEvent)},c.prototype.onClear=function(){this.eventBridge.publishToChannel(e.events.resetUserStateKeyPressedEvent)},c.prototype.onShowQna=function(){this.eventBridge.publishToChannel(e.events.addQnaContainer,{creationSource:7})},c.prototype.onGroup=function(){this.layoutAuthoring.groupCanvasItems(s.getSelectedCanvasItems(this.selectionService))},c.prototype.onUnGroup=function(){var t=this,e=s.getSelectedCanvasItems(this.selectionService);_.forEach(e,(function(e){e=i.contracts.isVisualContainerGroup(e)?e:e.parentGroup;e&&t.layoutAuthoring.ungroupCanvasItems(e)}))},c.prototype.onMergeGroup=function(){this.layoutAuthoring.canMergeCanvasItems()&&this.layoutAuthoring.mergeCanvasItemContainers(s.getSelectedCanvasItems(this.selectionService))},c.prototype.isSaveEvent=function(e){return this.isOnlyCtrlOrMeta(e)&&83===e.which},c.prototype.isDeleteEvent=function(e){return!e.ctrlKey&&46===e.which},c.prototype.canCopyOrCut=function(){return!this.visibilityService.get()},c.prototype.isClearEvent=function(e){return e.altKey&&e.shiftKey&&82===e.which},c.prototype.isCtrlOrMeta=function(e){var t=e.ctrlKey,i=e.metaKey;return e&&(t&&!i||!t&&i)},c.prototype.isOnlyCtrlOrMeta=function(e){return this.isCtrlOrMeta(e)&&!e.altKey&&!e.shiftKey},c.DebounceWait=100,p=c})(powerbi=powerbi||{}),(function(e){var t,s;function i(e,t,i,r,n,a){this.eventBridge=e,this.explorationNavigation=t,this.formFactorProvider=i,this.visibility=r,this.viewModeState=n,this.overlayService=a,this.displayAreaScale=1,this.wallpaperScale=1}e=e.explore||(e.explore={}),(t=e.services||(e.services={})).createCanvasScaleService=function(e,t,i,r,n,a,o){return new s(e,t,r,n,a,o)},i.prototype.setDisplayAreaScaleFactor=function(e){this.displayAreaScale=e,this.eventBridge.publishToChannel(t.events.canvasZoomScaleUpdated,e)},i.prototype.setWallpaperScaleFactor=function(e){this.wallpaperScale=e},i.prototype.getDisplayAreaScaleFactor=function(){return this.displayAreaScale},i.prototype.getWallpaperScaleFactor=function(){return this.wallpaperScale},i.prototype.getDisplayOption=function(){if(1===this.formFactorProvider.getCurrentLayout()&&1===this.viewModeState.getMode())return 3;if(null!=this.canvasZoom)return 3;if(!!this.visibility.get())return 0;if(null!=this.overrideDisplayOption)return this.overrideDisplayOption;var e=this.explorationNavigation.getCurrentSection();return e?e.size.displayOption:void 0},i.prototype.setDisplayOption=function(e){var t=this.explorationNavigation.getCurrentSection();t&&(this.canvasZoom=void 0,this.overlayService.hideAllDropdowns(),t.size.displayOption=e)},i.prototype.setCanvasZoom=function(e){this.overlayService.hideAllDropdowns(),this.canvasZoom=e},i.prototype.getCanvasZoom=function(){return this.canvasZoom},s=i})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).events||(e.events={})).visualCustomCommand={type:2,name:"visualCustomCommand"},e.preparePersonalVisuals={type:2,name:"preparePersonalVisuals"},e.copyVisualAsImage={type:2,name:"copyVisualAsImage"},e.VisualContainerAdded={type:2,name:"VisualContainerAdded"}})(powerbi=powerbi||{}),(function(e){var i;function t(e,t){var i=!t||t.featureSwitches.contentAuthoringUIEnabled,r=!!e&&!!e.isGuestUser,t=!!t&&t.featureSwitches.elevatedGuestsTenantEnabled,t=r&&!t,e=!(!e||void 0===e.userLicense)&&"Free"===e.userLicense();this.options={shouldSetFocus:!0,showAppBar:!0,showStatusBar:!1,showTaskPane:!0,showVisualizationPane:!0,showNavContentPane:!0,visualContainerOptions:{showMenu:!0,showPin:!0,showContextMenu:!0,disablePin:t||!i,disableQueryCacheUpdates:!1},showBackButtonOnAppBar:!1,disablePin:t||!i,disableSharePointEmbed:r,disableSecurePublishToWeb:r||!i,disableQRGeneration:r,disableSaveAs:t||e,disableSwitchMode:t||!i,disableAnalyzeInExcel:r,expandTaskPane:!0,expandVisualizationPane:!0,allowVisualContainerPreload:!1,allowNewLoadingExperience:!1,persistentUserStateEnabled:!1,persistentUserStateThrottlingEnabled:!1,defaultPersonalBookmarkEnabled:!1,disableEditVariables:!0,disableChangeDetectionDialog:!0,showCopyVisualImageButton:!1}}((e=e.explore||(e.explore={})).services||(e.services={})).createExplorationCapabilitiesService=function(e,t){return new i(e,t)},t.prototype.setCapabilities=function(e){_.merge(this.options,e)},t.prototype.getCapabilities=function(){return this.options},i=t})(powerbi=powerbi||{}),(function(e){var t;function i(e,t){this.emptySpaceMinWidth=e,this.emptySpaceMinHeight=t}((e=e.explore||(e.explore={})).services||(e.services={})).createLayoutInsertionHelper=function(){return new t(150,150)},i.prototype.getEmptySpaces=function(e,t){for(var i=this.getNonOverlapingRects(e,t),r=[],n=0,a=this.filterWithMinimumWidth(i);n<a.length;n++){var o=a[n],o=this.extendRect(o,i);o.height>=this.emptySpaceMinHeight&&r.push(o)}return r},i.prototype.extendRect=function(e,t){for(var i,r=!1,n=0,a=t;n<a.length;n++){var o,s,l,u,c=a[n];c!==e&&(s=o=!1,this.doIntersect(c,e)&&(o=c.y+c.height===e.y,s=c.y===e.y+e.height),c.width<e.width||(s?(l={x:e.x,y:e.y,width:e.width,height:e.height+c.height},(u=this.getIntersectingRectangle(l,c))&&u.width===l.width&&(r=!0,i=l)):o&&(l={x:e.x,y:c.y,width:e.width,height:e.height+c.height},(u=this.getIntersectingRectangle(l,c))&&u.width===l.width&&(r=!0,i=l))))}return r?this.extendRect(i,t):e},i.prototype.getIntersectingRectangle=function(e,t){var i=Math.max(e.x,t.x),r=Math.min(e.x+e.width,t.x+t.width),n=Math.max(e.y,t.y),e=Math.min(e.y+e.height,t.y+t.height);return i<=r&&n<=e?{x:i,y:n,width:r-i,height:e-n}:null},i.prototype.doIntersect=function(e,t){return!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y)},i.prototype.filterWithArea=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];0<n.width&&0<n.height&&t.push(n)}return t},i.prototype.filterWithMinimumWidth=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];n.width>=this.emptySpaceMinWidth&&t.push(n)}return t},i.prototype.splitRectangleOnIntersection=function(e,t){t=this.getIntersectingRectangle(e,t);return t?this.filterWithArea([{x:e.x,y:e.y,width:e.width,height:t.y-e.y},{x:e.x,y:t.y+t.height,width:e.width,height:e.y+e.height-(t.y+t.height)},{x:e.x,y:t.y,width:t.x-e.x,height:t.height},{x:t.x+t.width,y:t.y,width:e.x+e.width-(t.x+t.width),height:t.height}]):[e]},i.prototype.getNonOverlapingRects=function(e,t){if(!t.length)return[];for(var i=[e],r=0,n=t;r<n.length;r++){for(var a=n[r],o=[],s=0,l=i;s<l.length;s++)var u=l[s],o=o.concat(this.splitRectangleOnIntersection(u,a));i=o}return i},t=i})(powerbi=powerbi||{}),(function(d){var v,e,a,o,n,g,s,m,y,u;function l(e,t,i,r,n,a,o,s,l){this.conceptualSchemaProxy=e,this.displayNameService=t,this.dataProxy=i,this.resourcePackagesService=r,this.visualQueryGenerator=n,this.visualPlugin=a,this.visualPluginOps=o,this.visualCapabilitiesService=s,this.featureSwitchService=l}v=d.explore||(d.explore={}),e=v.services||(v.services={}),a=jsCommon.ArrayExtensions,o=d.data.QueryProjectionsByRole,n=d.visualHost.utils.ResourcePackageUtils,g=d.visualHost.ThemeUtils,s=jsCommon.Trace,m=d.data.dsr.transformDataQueryToSemanticQueryDataShapeCommand,y=v.util.VisualContainerUtils,e.canPinVisualType=function(e,t,i,r){return null!=r&&null!=e.getPlugin(r)&&!i.hasFilterCapabilities(r)&&r!==d.visuals.plugins.basicShape.name&&r!==d.visuals.plugins.pageNavigator.name&&r!==d.visuals.plugins.bookmarkNavigator.name&&!t.isAnalysisVisual(r)&&!t.isQnaVisual(r)},e.createPinVisualService=function(e,t,i,r,n,a,o,s,l){return new u(e,t,i,n,a,o,s,l,r)},l.prototype.getPinData=function(e,t,i,r,n,a,o,s,l,u){var c,p,h=e.config.singleVisual,u=(o?(c=o.options.query.command,n=(s=y.describeForPinning(this.displayNameService,s,h.query,h.columnProperties,this.visualPlugin.capabilities(h.visualType),this.featureSwitchService.featureSwitches,n?n.filterMetadata:null)).queryMetadata,p=_.clone(e),u&&0<(u=(!!o.filterContext&&!!o.filterContext.dataFilters&&o.filterContext.dataFilters.map((function(e){return e.filter}))||[]).concat(!!o.filterContext&&o.filterContext.highlightFilters||[])).length&&(p.filters=u.map((function(e){return v.FilterUtils.deriveFromSQFilters(e.from(),e.where(),null)})).reduce((function(e,t){return e.concat(t)}))),c={dataTransforms:o.transforms,dataViewSource:a?a.dataViewSource:null,elements:s.visualElements,query:c,queryMetadata:n,themeCollection:g.cloneThemeCollection(r),tileLayoutType:t,visualContainer:p},d.data.DataViewObjectDefinitions.getValue(e.config.singleVisual.vcObjects,{objectName:"title",propertyName:"text"},void 0)||this.setPinDataHeadings(a,n,c)):c={dataViewSource:{data:void 0},themeCollection:g.cloneThemeCollection(r),tileLayoutType:t,visualContainer:e},d.explore.dataReaderPlugins.getExplorationDataReaderDataSource(i)),o=u&&u.getModelExtensions(),s=u&&u.getDataSourceVariables();return o&&(c.modelExtensions=o),s&&(c.dataSourceVariables=s),this.addResourcePackageIdsToPinData(h.visualType,c,l)},l.prototype.setPinDataHeadings=function(e,t,i){e=e&&e.dataViewSource&&e.dataViewSource.data.descriptor;if(e)var e=new d.data.dsr.QueryDescription(t,e),r=e.getMeasureRestatements(),n=e.getFilterRestatements(),a=e.getGroupRestatements();else{for(var o=[],s=[],l=0,u=t.Select;l<u.length;l++){var c=u[l];3===c.Type||1===c.Type?o.push(c.Restatement):4!==c.Type&&2048!==c.Type||s.push(c.Restatement)}0<s.length&&(a=s),0<o.length&&(r=o)}r?i.tileHeading=this.joinList(r):a&&(i.tileHeading=this.joinList(a)),n&&(i.tileFilterDetails=this.joinList(n)),r&&a&&(i.tileSubDisplay=d.common.getLocalize().format("TileHeadings_By",[this.joinList(a)]))},l.prototype.joinList=function(e){return e.join(d.common.getLocalize().get("ListJoin_Separator"))},l.prototype.pinVisualContainer=function(e,t,i,r,n,a){var o=this;this.getPinDataAsync(e,t,i,r,n,a).then((function(e){o.handler&&o.handler.pinVisual(e)}),(function(){}))},l.prototype.getPinDataAsync=function(s,l,u,c,p,h){return __awaiter(this,void 0,d.Promise,(function(){var t,i,r,n,a,o;return __generator(this,(function(e){switch(e.label){case 0:return t=l.config.singleVisual,i=t.visualType,r=i===d.visuals.plugins.image.name?1:0,[4,this.conceptualSchemaProxy.get(s)];case 1:return(n=e.sent(),this.visualQueryGenerator.shouldExecute(t,s)&&(a=d.common.GridLayoutConstants.getDefaultGridItemViewport(d.common.GridLayoutConstants.getMediumLandscapeGridItem()),a=this.visualQueryGenerator.execute({config:t,dataSources:s,schema:n,additionalFilters:u,dataWindow:a,ignoreViewportForCache:!0,allowClientSideFilters:!1})),a)?(o=a.options.query.command,o=m(o),this.modifyPinnedVisualDataShapeBinding(o.Binding,t.query,n,i),[4,this.dataProxy.execute(a.options)]):[3,3];case 2:return(o=e.sent())&&o.dataReaderResult&&o.dataReaderResult.disallowPersisting,[2,this.getPinData(l,r,s,c,u,o,a,n,p,h)];case 3:return[2,this.getPinData(l,r,s,c,null,null,null,null,p)]}}))}))},l.prototype.canPinVisualType=function(e){return d.explore.services.canPinVisualType(this.visualPlugin,this.visualPluginOps,this.visualCapabilitiesService,e)},l.prototype.setHandler=function(e){this.handler=e},l.prototype.modifyPinnedVisualDataShapeBinding=function(e,t,i,r){var n;e&&(n=this.visualPlugin.capabilities(r),l.isTableOrMatrix(r)?(e.DataReduction||(e.DataReduction={}),e.DataReduction.Primary={Window:{Count:100}}):l.supportsScalarCategoryAxis(n)&&(r=t.projections,n=t.defn.select(),e.DataReduction&&(e.DataReduction.Primary&&e.DataReduction.Primary.BinnedLineSample||e.DataReduction.Intersection&&e.DataReduction.Intersection.BinnedLineSample)||r&&!_.isEmpty(n)&&(t=o.getRole(r,"Category"))&&!_.isEmpty(t.all())&&(r=t.getLastActiveQueryReference()||t.all()[0].queryRef,(t=a.findItemWithName(n,r))&&(n=t.expr.getMetadata(i))&&0===n.kind&&n.type.dateTime&&(e.DataReduction||(e.DataReduction={}),e.DataReduction.Primary={Bottom:{}}))))},l.prototype.addResourcePackageIdsToPinData=function(e,t,i){var r,n=[];return this.visualPlugin.isCustomVisual(e)&&(e=this.resourcePackagesService.getPackage(e))&&0<e.id&&n.push(e.id),i&&(r=t.themeCollection).customTheme&&this.addResourcePackageIdIfNeeded(i,r.customTheme.type,(function(e){return e.name===r.customTheme.name}),n),_.isEmpty(n)||(t.resourcePackageIds=_.uniq(n)),t},l.prototype.addResourcePackageIdIfNeeded=function(e,t,i,r){e=n.findResourcePackage(e,t);e&&null==e.id&&s.error("Resource package should have an ID"),e&&null!=e.id&&_.find(e.items,i)&&r.push(e.id)},l.supportsScalarCategoryAxis=function(e){return e.objects&&e.objects.categoryAxis&&e.objects.categoryAxis.properties&&void 0!==e.objects.categoryAxis.properties.axisType},l.isTableOrMatrix=function(e){var t=d.visuals.plugins;return e===t.table.name||e===t.matrix.name||e===t.tableEx.name||e===t.pivotTable.name},u=l})(powerbi=powerbi||{}),(function(l){var e,t,u,c,p,h,d,i,a;function r(e,t,i,r){this.localizationService=e,this.telemetryService=t,this.visualAuthoring=i,this.visualPlugin=r}e=l.explore||(l.explore={}),t=e.services||(e.services={}),u=l.data.FieldExprPattern,c=e.viewModels.ShowValueAsNoCalculation,p=e.viewModels.ShowValueAsPercentOfGrandTotalCalculation,h=e.viewModels.ShowValueAsPercentOfRoleTotalCalculation,d=l.data.SQExprConverter,i=l.data.SQExprUtils,t.createShowValueAsService=function(e,t,i,r,n){return new a(e,i,r,n)},r.prototype.createShowValueAsMenuItems=function(e,t,i){var r=u.getSchema(d.asFieldPattern(e));if(!t.schema(r).capabilities.supportsScopedEval)return[];var n=[];if(this.aggregateSupportsShowValueAs(e,t)){r=new c(l.common.getLocalize()),e=(n.push(this.showValueAsMenuItemBuilder(r)),new p(l.common.getLocalize())),t=(n.push(this.showValueAsMenuItemBuilder(e)),this.visualPlugin.capabilities(i)),r=t&&t.dataRoleTotals;if(!_.isEmpty(r))for(var a=0,o=r;a<o.length;a++){var s=o[a],s=new h(this.localizationService,s.roles,l.data.getDisplayName(s.displayName,this.localizationService));n.push(this.showValueAsMenuItemBuilder(s))}}return n},r.prototype.applyShowValueAs=function(t,i,r){return __awaiter(this,void 0,l.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.visualAuthoring.applyShowValueAs(t,i,r)];case 1:return e.sent()&&this.telemetryService.logEvent(l.telemetry.EXChangeQuickCalc,{original:this.showValueAsKindToTelemetryId(i.kind),target:this.showValueAsKindToTelemetryId(r.kind)}),[2]}}))}))},r.prototype.showValueAsMenuItemBuilder=function(e){var t={type:0};return t.key={action:32,showValueAs:e},t.text=e.name,t},r.prototype.aggregateSupportsShowValueAs=function(e,t){t=e.getMetadata(t);return t&&t.type&&t.type.numeric&&i.isMeasure(e)},r.prototype.showValueAsKindToTelemetryId=function(e){switch(e){case void 0:return"None";case 0:return"PercentOfGrandTotal";case 1:return"PercentOfRoleTotal"}},a=r})(powerbi=powerbi||{}),(function(e){var t,r,n,i;function a(e,t){this.visualContainer=e,this.visualPluginOps=t}t=(t=e.explore||(e.explore={})).services||(t.services={}),r=e.data.DataViewQueryEngine,n=e.explore.util.VisualContainerUtils,t.createVisualContainerDataSelectionService=function(e,t){return new i(e,t)},a.prototype.getSelectedValues=function(e,t){if(t&&e.valueDetails)return t=this.filterThroughValueDetails(e.valueDetails,e.metadata),this.amendIdentityToValueDetails(e,t);var t=n.getVisualType(this.visualContainer.contract),i=n.getVisualQuery(this.visualContainer.contract),t=this.visualPluginOps.dataViewKinds(t,i);return r.query(this.getDataViews(),e,t)},a.prototype.filterThroughValueDetails=function(e,t){return t?_.filter(e,(function(e){return _.includes(t,e.queryName)})):e},a.prototype.amendIdentityToValueDetails=function(e,t){for(var i=[],r=0,n=t;r<n.length;r++){var a=n[r];i.push({queryName:a.queryName,identity:a.identity||e.dataMap&&_.values(e.dataMap)[0][0],expr:a.expr,value:a.value,formattedValue:a.formattedValue})}return i},a.prototype.getDataViews=function(){var e=this.visualContainer&&this.visualContainer.getRunningVisual();return e&&e.getDataViews()},i=a,t.VisualContainerDataSelectionService=i})(powerbi=powerbi||{}),(function(X){!(function(i){var o=i.services||(i.services={});c=o.VisualContainerMenuCommand,__extends(t,c),t.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){return this.overlayService,this.undoRedo,this.visualAuthoring,t=L(this.visualContainer.name,this.contextActivityService,"ToggleSearch",this.source),this.visualAuthoring.toggleSlicerVisualSearch(this.visualContainer.contract,this.filterGenerator,this.visualPlugin),this.overlayService.hideAllDropdowns(),this.announceSelectionState(this.visualContainer.visualHostServices,this.isSearchOn),t.resolve(),[2]}))}))},t.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSearch&&c.prototype.isVisible.call(this)]}))}))},Object.defineProperty(t.prototype,"isSearchOn",{get:function(){var e=this.visualContainer.contract.config.singleVisual;if(!e||!e.objects)return!1;var t=i.util.VisualContainerUtils.getVisualCapabilities(this.visualContainer.contract,this.visualPlugin);if(!t)return!1;t=this.filterGenerator.tryGetSelfFilterEnabledProperty(t);if(!t)return!1;e=X.data.DataViewObjectDefinitions.getValue(e.objects,t,null);return e&&e.value||!1},enumerable:!1,configurable:!0});var c,e=t;function t(e,t,i,r,n,a,o,s,l,u){u=c.call(this,"Slicer_SearchBox_Text",void 0,"itemIcon glyphicon pbi-glyph-search glyph-small",u&&u.search)||this;return u.visualContainer=e,u.filterGenerator=t,u.overlayService=i,u.undoRedo=r,u.visualAuthoring=n,u.visualPlugin=a,u.menuOptions=o,u.contextActivityService=s,u.source=l,u.selected=u.isSearchOn,u}o.ToggleSearchCommand=t,h=o.VisualContainerMenuCommand,__extends(r,h),r.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t,i,r,n,a;return __generator(this,(function(e){switch(e.label){case 0:this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.overlayService,t=L(this.visualContainer.name,this.contextActivityService,"ExportVisualData",this.source),i=this.visualContainer.getRunningVisual(),r=this.visualContainer.visualTitle,r=null!=r?r.text:"",n=this.dataSources.get(),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,this.conceptualSchemaProxy.get(n)];case 2:return a=e.sent(),this.eventBridge.publishToChannel(o.events.exportVisualData,{visualData:{data:i.getData(),dataTransforms:i.getDataTransforms()},visualContainer:this.visualContainer.contract,visualTitle:r,additionalFilters:this.visualContainer.hostServices.getFilters(this.filterGenerator,a)}),[3,5];case 3:return e.sent(),[3,5];case 4:return this.overlayService.hideAllDropdowns(),t.resolve(),[7];case 5:return[2]}}))}))},r.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canExport&&h.prototype.isVisible.call(this)]}))}))},r.prototype.isDisabled=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,h.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.explorationSettings&&this.explorationSettings.exportDataMode&&2===this.explorationSettings.exportDataMode||this.menuOptions.exportDataDenied||this.featureSwitchService.featureSwitches.disableExportDataOnVisualError&&this.visualHasError()]}}))}))},r.prototype.visualHasError=function(){return!!this.visualContainer.errorInfo},r.prototype.getToolTip=function(t){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isDisabled()];case 1:return e.sent()?this.menuOptions.exportDataDenied?[2,t.get("ExportData_DeniedTooltip")]:this.visualHasError()?[2,t.get("VisualContainer_ExportDataDisabled_VisualError_Tooltip")]:[2,t.get("VisualContainer_ExportDataDisabled_Tooltip")]:[2,null]}}))}))};var h,e=r;function r(e,t,i,r,n,a,o,s,l,u,c,p){p=h.call(this,"ExportData_MenuItem",void 0,"itemIcon glyphicon pbi-glyph-export glyph-small",p&&p.exportData)||this;return p.visualContainer=e,p.conceptualSchemaProxy=t,p.dataSources=i,p.eventBridge=r,p.featureSwitchService=n,p.filterGenerator=a,p.overlayService=o,p.menuOptions=s,p.explorationSettings=l,p.contextActivityService=u,p.source=c,p}o.ExportVisualDataCommand=r,s=o.VisualContainerMenuCommand,__extends(n,s),n.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,t=L(this.visualContainer.name,this.contextActivityService,"AddCommentVisual",this.source),this.eventBridge.publishToChannel(o.events.addCommentVisual,{visualContainerId:this.visualContainer.id}),t.resolve(),[2]}))}))},n.prototype.isVisible=function(){return this.menuOptions.canAddComment&&s.prototype.isVisible.call(this)};var s,e=n;function n(e,t,i,r,n,a){a=s.call(this,"AddComment",void 0,"itemIcon glyphicon glyph-small pbi-glyph-comment",a&&a.addComment)||this;return a.visualContainer=e,a.eventBridge=t,a.menuOptions=i,a.contextActivityService=r,a.source=n,a}o.AddCommentVisualCommand=n,l=o.VisualContainerMenuCommand,__extends(a,l),a.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,t=L(this.visualContainer.name,this.contextActivityService,"EnterAdvancedEditMode",this.source),this.eventBridge.publishToChannel(o.events.editModeChanged,{editMode:1,visualContainer:this.visualContainer.contract}),this.overlayService.hideAllDropdowns(),t.resolve(),[2]}))}))},a.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canEdit&&l.prototype.isVisible.call(this)]}))}))};var l,e=a;function a(e,t,i,r,n,a,o){o=l.call(this,"Edit_ToolTip",void 0,"itemIcon glyphicon pbi-glyph-edit glyph-mini",o&&o.enterAdvancedEditMode)||this;return o.visualContainer=e,o.eventBridge=t,o.overlayService=i,o.menuOptions=r,o.contextActivityService=n,o.source=a,o}o.EnterAdvancedEditModeCommand=a,u=o.VisualContainerMenuCommand,__extends(p,u),p.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t,i=this;return __generator(this,(function(e){return this.eventBridge,this.undoRedo,t=L(this.visualContainer.name,this.contextActivityService,"DeleteVisualContainer",this.source),this.undoRedo.register("DeleteVisualContainer",(function(){i.eventBridge.publishToChannel(o.events.deleteVisualContainer,i.visualContainer.contract)})),t.resolve(),[2]}))}))},p.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canDelete&&u.prototype.isVisible.call(this)]}))}))};var u,e=p;function p(e,t,i,r,n,a,o){o=u.call(this,"Remove_visual",void 0,"itemIcon glyphicon pbi-glyph-close glyph-mini",o&&o.removeVisual)||this;return o.visualContainer=e,o.eventBridge=t,o.undoRedo=i,o.menuOptions=r,o.contextActivityService=n,o.source=a,o}o.DeleteVisualContainerCommand=p,d=o.VisualContainerMenuCommand,__extends(v,d),v.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,t=L(this.visualContainer.name,this.contextActivityService,"ClustersSpatial",this.source),this.eventBridge.publishToChannel(o.events.getClusters,{visualContainer:this.visualContainer.contract}),t.resolve(),[2]}))}))},v.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canCluster&&d.prototype.isVisible.call(this)]}))}))};var d,e=v;function v(e,t,i,r,n,a,o,s){e=d.call(this,e,void 0,t,s&&s.clusters)||this;return e.visualContainer=i,e.eventBridge=r,e.menuOptions=n,e.contextActivityService=a,e.source=o,e}o.ClustersSpatialClustersCommand=e,__extends(m,g=e);var g,e=m;function m(e,t,i,r,n,a){return g.call(this,"Visual_Cluster_FindGroups","itemIcon glyphicon pbi-glyph-scatter glyph-small",e,t,i,r,n,a)||this}o.GetClustersCommand=m,y=o.VisualContainerMenuCommand,__extends(f,y),f.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){return this.visibility,t=L(this.visualContainer.name,this.contextActivityService,"ToggleSpotlight",this.source),4===this.visualContainer.contract.visibility?this.visibility.clear():this.visibility.set(this.visualContainer.contract,4),this.announceSelectionState(this.visualContainer.visualHostServices,this.isSpotlightOn),t.resolve(),[2]}))}))},f.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSpotlight&&y.prototype.isVisible.call(this)]}))}))},Object.defineProperty(f.prototype,"isSpotlightOn",{get:function(){return 4===this.visualContainer.contract.visibility},enumerable:!1,configurable:!0});var y,e=f;function f(e,t,i,r,n,a){a=y.call(this,"Spotlight",void 0,"itemIcon glyphicon pbi-glyph-flashlight glyph-small",a&&a.spotlight)||this;return a.visualContainer=e,a.visibility=t,a.menuOptions=i,a.contextActivityService=r,a.source=n,a.selected=a.isSpotlightOn,a}o.ToggleSpotlightCommand=f,C=o.VisualContainerMenuCommand,__extends(S,C),S.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,this.visibility,t=L(this.visualContainer.name,this.contextActivityService,"ShareToTeamsVisual",this.source),this.visibility.set(this.visualContainer.contract,4),this.eventBridge.publishToChannel(o.events.shareToTeamsVisual),t.resolve(),[2]}))}))},S.prototype.isVisible=function(){return this.menuOptions.canShareToTeams&&C.prototype.isVisible.call(this)};var C,e=S;function S(e,t,i,r,n,a,o){o=C.call(this,"ChatInTeams",void 0,"itemIcon glyphicon glyph-small pbi-glyph-teamslogo",o&&o.shareToTeams)||this;return o.visualContainer=e,o.visibility=t,o.eventBridge=i,o.menuOptions=r,o.contextActivityService=n,o.source=a,o}o.ShareToTeamsVisualCommand=S,b=o.VisualContainerMenuCommand,__extends(E,b),E.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t,i;return __generator(this,(function(e){return this.eventBridge,t=L(this.visualContainer.name,this.contextActivityService,"Sort",this.source),this.overlayService.hideAllDropdowns(),i=this.getSortByField(),i={visualContainer:this.visualContainer.contract,sortableField:i,sortDirection:this.sortDirection,sortGroup:this.sortGroup},this.eventBridge.publishToChannel(o.events.toggleSortDirectionVisualContainer,i),t.resolve(),[2]}))}))},E.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSort&&b.prototype.isVisible.call(this)]}))}))},E.prototype.isDisabled=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,b.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||void 0===this.getSortByField()]}}))}))},Object.defineProperty(E.prototype,"activeSortableField",{get:function(){return _.find(this.sortGroup.fields,(function(e){return e.active}))},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"isHighlighted",{get:function(){return void 0!==this.activeSortableField&&this.activeSortableField.sortDirection===this.sortDirection},enumerable:!1,configurable:!0}),E.prototype.getSortByField=function(){if(this.sortGroup.fields)return 1===_.size(this.sortGroup.fields)?this.sortGroup.fields[0]:this.activeSortableField};var b,e=E;function E(e,t,i,r,n,a,o,s,l,u,c,p){e=b.call(this,e,void 0,t,c&&c.sort,void 0,void 0,p)||this;return e.sortDirection=i,e.visualContainer=r,e.eventBridge=n,e.overlayService=a,e.menuOptions=o,e.sortGroup=s,e.contextActivityService=l,e.source=u,e.selected=e.isHighlighted,e}o.SortAscendingDescendingCommand=e,__extends(w,V=e);var V,x=w;function w(e,t,i,r,n,a,o,s,l){return V.call(this,"Sort_Desc","itemIcon glyphicon pbi-glyph-ztoa glyph-small",2,e,t,i,r,n,a,o,s,l)||this}o.SortDescendingCommand=x,__extends(k,B=e);var B,R=k;function k(e,t,i,r,n,a,o,s){return B.call(this,"Sort_Asc","itemIcon glyphicon pbi-glyph-atoz glyph-small",1,e,t,i,r,n,a,o,s)||this}o.SortAscendingCommand=R,P=o.VisualContainerMenuCommand,__extends(F,P),F.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},F.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.menuOptions.canSort)?[4,P.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return t?[2,1<_.size(this.menuOptions.sortSetting.sortableFields)]:[2,!1]}}))}))},F.prototype.getChildren=function(){return __awaiter(this,void 0,X.Promise,(function(){var t,i,r,n=this;return __generator(this,(function(e){return t=this.menuOptions.sortSetting.sortableFields,i=1===this.visualContainer.readOnlyState.actualSortDirection?"Sort_Asc":"Sort_Desc",r=_.some(this.menuOptions.sortSetting.sortableFields,(function(e){return e.active})),[2,_.map(t,(function(e){return new M(n.visualContainer,e,r?i:void 0,n.eventBridge,n.overlayService,n.contextActivityService,n.source,n.displayOverride)}))]}))}))};var P,e=F;function F(e,t,i,r,n,a,o){var s=P.call(this,"MobileFooter_SortBy",void 0,void 0,o&&o.sort)||this;return s.visualContainer=e,s.eventBridge=t,s.overlayService=i,s.menuOptions=r,s.contextActivityService=n,s.source=a,s.displayOverride=o,s}o.SortByCommandCollection=F,A=o.VisualContainerMenuCommand,__extends(T,A),T.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},T.prototype.title=function(e){return e.format("Sort_Group",e.get(this.sortGroup.displayName))},T.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.menuOptions.canSort)?[4,A.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return t?[2,!0]:[2,!1]}}))}))},T.prototype.getChildren=function(){return __awaiter(this,void 0,X.Promise,(function(){var t,i,r,n,a;return __generator(this,(function(e){for(t=[],i=0,r=this.sortGroup.fields;i<r.length;i++)n=r[i],a=1===n.sortDirection?"Sort_Asc":"Sort_Desc",t.push(new M(this.visualContainer,n,a,this.eventBridge,this.overlayService,this.contextActivityService,this.source,this.displayOverride));return t.push(new x(this.visualContainer,this.eventBridge,this.overlayService,this.menuOptions,this.sortGroup,this.contextActivityService,this.source,this.displayOverride,1),new R(this.visualContainer,this.eventBridge,this.overlayService,this.menuOptions,this.sortGroup,this.contextActivityService,this.source,this.displayOverride)),[2,t]}))}))};var A,e=T;function T(e,t,i,r,n,a,o,s){var l=A.call(this,"Sort_Group"+n.displayName,void 0,void 0,s&&s.sort)||this;return l.visualContainer=e,l.eventBridge=t,l.overlayService=i,l.menuOptions=r,l.sortGroup=n,l.contextActivityService=a,l.source=o,l.displayOverride=s,l}o.GroupedSortByCommandCollection=T,D=o.VisualContainerMenuCommand,__extends(I,D),I.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t,i;return __generator(this,(function(e){return this.sortField,this.eventBridge,t=L(this.visualContainer.name,this.contextActivityService,"SortBy",this.source),this.overlayService.hideAllDropdowns(),i={sortableField:this.sortField,sortDirection:this.visualContainer.readOnlyState.actualSortDirection,visualContainer:this.visualContainer.contract},this.eventBridge.publishToChannel(o.events.toggleSortVisualContainer,i),t.resolve(),[2]}))}))},I.prototype.title=function(e){return this.sortField.displayName},I.prototype.getToolTip=function(t){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return this.sortDirectionKey?[2,this.sortField.displayName+", "+t.get(this.sortDirectionKey)]:[2,this.title(t)]}))}))};var D,M=I;function I(e,t,i,r,n,a,o,s){s=D.call(this,t.displayName,void 0,void 0,s&&s.sort)||this;return s.visualContainer=e,s.sortField=t,s.sortDirectionKey=i,s.eventBridge=r,s.overlayService=n,s.contextActivityService=a,s.source=o,s.selected=s.sortField.active,s}o.SortByCommand=M,O=o.VisualContainerMenuCommand,__extends(N,O),N.prototype.execute=function(){return __awaiter(this,void 0,X.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.telemetryService.logEvent(X.telemetry.EXGetInsightsMenuCommand,{visualType:i.util.VisualContainerUtils.getVisualType(this.visualContainer.contract),visualName:this.visualContainer.contract.name}),t=L(this.visualContainer.name,this.contextActivityService,"GetAutomatedInsights",this.source),[4,this.lazyScoped("automatedInsightsQuery")];case 1:return e.sent().showAutomatedInsights({entryPoint:"VisualOptionsMenu",queryOptions:{summarySelectionOptions:{visualsToSummarize:[this.visualContainer.contract]},updateProcessingState:!0},enforcePremiumLicensing:!0,viewOnlyNoteworthy:!1}),t.resolve(),[2]}}))}))},N.prototype.isVisible=function(){return __awaiter(this,void 0,X.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canGetInsights&&O.prototype.isVisible.call(this)]}))}))};var O,e=N;function N(e,t,i,r,n,a,o){o=O.call(this,"AutomatedInsights_AppBar_GetInsights",void 0,"itemIcon glyphicon pbi-glyph-insight glyph-small",o&&o.insightsAnalysis)||this;return o.visualContainer=e,o.menuOptions=t,o.lazyScoped=i,o.telemetryService=r,o.contextActivityService=n,o.source=a,o}function L(e,t,i,r){return t.createActivity({name:"VisualAction",visualName:e,data:{action:i,source:r}})}o.GetInsightsCommand=N})(X.explore||(X.explore={}))})(powerbi=powerbi||{}),(function(r){var e,n,t;function i(e){this.services=e,this.instanceId=void 0}e=(e=r.explore||(r.explore={})).services||(e.services={}),n={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"},i.initialize=function(e){i.initialized||(i.initialized=!0,r.visuals.valueFormatter.setLocaleOptions(i.createLocaleOptions(e)),r.visuals.ToolTipComponent.localizationOptions=i.createTooltipLocaleOptions(e),r.data.DataViewTransform.setLocalizationOptions(i.createDataViewTransformLocalizationOptions(e)))},i.createLocaleOptions=function(t){return{null:t.get("NullValue"),true:t.get("BooleanTrue"),false:t.get("BooleanFalse"),NaN:t.get("NaNValue"),infinity:t.get("InfinityValue"),negativeInfinity:t.get("NegativeInfinityValue"),beautify:function(e){return i.beautify(t,e)},describe:function(e){return i.describeUnit(t,e)},restatementComma:t.get("PowerBI_TwoStrings_SeperateWithCommaAndVisualSpace"),restatementCompoundAnd:t.get("FilterRestatement_CompoundAnd"),restatementCompoundOr:t.get("Generic_Or")}},i.createTooltipLocaleOptions=function(e){return{highlightedValueDisplayName:e.get(r.visuals.ToolTipComponent.highlightedValueDisplayNameResorceKey)}},i.createDataViewTransformLocalizationOptions=function(e){return{quarterPrefix:e.get(r.visuals.ForecastHelper.quarterHierarchyLevelPrefixResorceKey)}},i.prototype.getLocalizedString=function(e){for(var t,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];return(t=this.services.localizationService).format.apply(t,__spreadArray([e],i||[]))},i.prototype.requestFocus=function(e){jsCommon.FocusManager.focus(e)},i.prototype.alertScreenReader=function(e){},i.prototype.alertWithDebounce=function(e,t){this.services.screenReaderService&&this.services.screenReaderService.alertWithDebounce(e,t)},i.prototype.onDragStart=function(){},i.prototype.getVisualLinkProperties=function(){},i.prototype.canSelect=function(){return!1},i.prototype.onSelecting=function(){},i.prototype.onSelect=function(){},i.prototype.onSwitchFocusModeState=function(){},i.prototype.canExpandCollapse=function(e){return!!this.services.canExpandCollapse&&this.services.canExpandCollapse(e)},i.prototype.setNodeExpansionState=function(e){},i.prototype.setLevelExpansionState=function(e){},i.prototype.onContextMenu=function(){},i.prototype.loadMoreData=function(){},i.prototype.loadWindow=function(e){},i.prototype.setShouldDeferData=function(){},i.prototype.persistProperties=function(e){},i.prototype.onCustomSort=function(e){},i.prototype.getViewMode=function(){return 0},i.prototype.getEditMode=function(){return 0},i.prototype.setWarnings=function(e){},i.prototype.setToolbar=function(e){},i.prototype.shouldRetainSelection=function(){return!1},i.prototype.geocoder=function(){return this.services.geocoder},i.prototype.geolocation=function(){return this.services.geolocation},i.prototype.locale=function(){return r.common.getUnmappedCultureInfo()},i.prototype.promiseFactory=function(){return this.services.promiseFactory},i.prototype.ignoreDefaultFilter=function(){return!1},i.prototype.getIdentityDisplayNames=function(e){},i.prototype.setIdentityDisplayNames=function(e){},i.prototype.setFilterExpressionMetadata=function(){},i.prototype.getFilterExpressionMetadata=function(){},i.prototype.decompositionService=function(){},i.prototype.dropdown=function(){},i.prototype.tooltips=function(){return this.services.visualHostTooltipService},i.prototype.telemetry=function(){},i.prototype.authenticationService=function(){return this.services.authenticationService},i.prototype.localStorageService=function(){},i.prototype.eventService=function(){},i.prototype.licenseManagerService=function(){},i.prototype.drill=function(e){},i.prototype.loader=function(){return this.services.moduleLoader},i.prototype.getUIComponentFactory=function(){},i.prototype.applyJsonFilter=function(e,t,i,r){},i.prototype.applyIdentityFilter=function(e,t,i,r){},i.prototype.launchUrl=function(e){},i.prototype.refreshHostData=function(){},i.prototype.getJSONFilter=function(e,t){return this.promiseFactory().reject()},i.prototype.onHyperlinkClick=function(e,t){},i.prototype.visualTimeSynchronization=function(){},i.prototype.isVisualEnabled=function(){return this.promiseFactory().resolve(!0)},i.prototype.dataMultiSelectMode=function(){return 0},i.prototype.networkAvailability=function(){},i.prototype.downloadService=function(){},i.prototype.setAriaMetadata=function(e){},i.prototype.artifactService=function(){},i.prototype.getSectionsMetadata$=function(){},i.prototype.getBookmarksMetadata$=function(){},i.prototype.onNotifyLicense=function(e){this.services.onNotifyLicense&&this.services.onNotifyLicense(e)},i.prototype.onClearLicenseNotification=function(){this.services.onClearLicenseNotification&&this.services.onClearLicenseNotification()},i.prototype.onNotifyFeatureBlocked=function(e){this.services.onNotifyFeatureBlocked&&this.services.onNotifyFeatureBlocked(e)},i.prototype.getSubSelectionService=function(){},i.prototype.webAccessService=function(){},i.beautify=function(e,t){var i=n[t];return i?(r.visuals.valueFormatter.beautifyTrace(i),e.getOptional(i)||t):t},i.describeUnit=function(e,t){var i=-1===t?"Auto":t.toString(),r=e.getOptional("DisplayUnitSystem_E"+i+"_Title"),t=t<=0?"{0}":e.getOptional("DisplayUnitSystem_E"+i+"_LabelFormat");if(r||t)return{title:r,format:t}},t=i,e.VisualHostServices=t,e.createVisualHostServices=function(e){return new t(e)}})(powerbi=powerbi||{}),(function(g){var e,t,p,m,y,d;function f(e,t,i,r,n,a,o,s,l,u,c,p,h){this.featureSwitchService=e,this.visualPlugin=t,this.scriptVisuals=i,this.reportSettingsService=r,this.localizationService=n,this.trustedVisual=a,this.approvedResourceService=o,this.resourcePackageService=s,this.explorationCapabilities=l,this.managedCustomVisualsService=u,this.explorationNavigation=c,this.featureSwitchValuesLoader=p,this.embedModeService=h}e=g.explore||(g.explore={}),t=e.services||(e.services={}),p=g.visualHost.CustomVisualsUtils,m=g.data.DataViewObjectDefinitions,y=e.util.VisualContainerUtils,t.createVisualValidatorService=function(e,t,i,r,n,a,o,s,l,u,c,p,h){return new d(e,t,i,r,n,a,o,s,l,u,c,p,h)},f.prototype.shouldBlockVisualQuery=function(e){var t=this.explorationNavigation.getCurrentExploration(),t=t&&t.reportId,i=y.getVisualType(e),i=g.explore.util.ScriptVisualsUtil.getScriptVisualType(i),r=this.reportSettingsService.areScriptVisualsApproved();return!(!y.isScriptVisual(e,this.visualPlugin)||r&&!this.scriptVisuals.shouldBlockScriptVisual(i,t))},f.prototype.validate=function(h,d,v){return __awaiter(this,void 0,g.Promise,(function(){var t,i,r,n,a,o,s,l,u,c,p;return __generator(this,(function(e){switch(e.label){case 0:if(y.isScriptVisual(h,this.visualPlugin)){switch(t=y.getVisualType(h),t=g.explore.util.ScriptVisualsUtil.getScriptVisualType(t),o=r=void 0,t){case 0:r=this.scriptVisuals.getScriptVisualErrorDetails(0,v),o="ScriptVisualsNotEnabled";break;case 1:r=this.scriptVisuals.getScriptVisualErrorDetails(1,v),o="PythonVisualsNotEnabled"}if(r)return t=this.reportSettingsService.areScriptVisualsApproved(),[2,{details:r,code:t?"ScriptVisualError":o}]}return(t=y.getVisualType(h))?(i=this.visualPlugin.getPlugin(t))&&i.apiVersion&&!g.extensibility.getVisualApiVersions().some((function(e){return e.version===i.apiVersion}))?[2,{details:r={message:this.localizationService.get("CustomVisualApiVersionNotSupported"),displayableErrorInfo:[]},code:"CvApiVersionNotSupported"}]:this.trustedVisual.isTrustedVisual(t)?(p=this.trustedVisual.validate(t))?[2,{details:p,code:"TrustedVisualError"}]:this.visualPlugin.isCustomVisual(t)?[2,this.validateCustomVisual(t)]:[3,12]:[3,1]:[2];case 1:return this.visualPlugin.isCustomVisual(t)?[2,this.validateCustomVisual(t)]:[3,2];case 2:return this.visualPlugin.getPlugin(t)?[3,3]:[2,{details:r=f.buildErrorDetails(this.localizationService.get("VisualContainer_UnableToFindVisualMessage"),this.localizationService.get("VisualContainer_UnableToFindVisualKey"),this.localizationService.get("VisualContainer_UnableToFindVisualValue")),code:"UnsupportedVisual"}];case 3:return t!==g.visuals.plugins.keyDriversVisual.name?[3,4]:(o=p=void 0,n=_.some(d.schemas,(function(e){return e.capabilities.insights&&e.capabilities.insights.supportsKeyDrivers})),a=this.explorationCapabilities.getCapabilities().analysisVisuals,n&&a||(p=f.buildErrorDetails(this.localizationService.get("VisualContainer_AnalysisVisual_NotSupportedMessage"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_AnalysisVisual_NotSupportedValue")),o="AnalysisVisualNotSupported"),p?(p.source="User",[2,{details:p,code:o}]):[3,12]);case 4:return t!==g.visuals.plugins.qnaVisual.name?[3,5]:(s=this.featureSwitchService.featureSwitches.qnaVisual,n=_.some(d.schemas,(function(e){return e.capabilities&&e.capabilities.supportsQna})),a=this.explorationCapabilities.getCapabilities().qna,s&&n&&a?[3,12]:((p=f.buildErrorDetails(this.localizationService.get("Qna_NotAllowedForReport_QnaNotSupported"),this.localizationService.get("VisualContainer_QnaVisual_NotSupportedTitle"),this.localizationService.get("VisualContainer_QnaVisual_NotSupportedMessage"))).source="User",[2,{details:p,code:"QnaVisualNotSupported"}]));case 5:return t!==g.visuals.plugins.decompositionTreeVisual.name?[3,6]:(o=p=void 0,l=_.every(d.schemas,(function(e){return e.capabilities&&e.capabilities.supportsInstanceFilters})),u=_.some(d.schemas,(function(e){return e.isMultiDimensionalModel})),l&&!u||(p=f.buildErrorDetails(this.localizationService.get("VisualContainer_DecompositionTreeVisual_NotSupportedMessage"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_DecompositionTreeVisual_NotSupportedValue")),o="DecompositionTreeVisualNotSupported"),p?(p.source="User",[2,{details:p,code:o}]):[3,12]);case 6:return t!==g.visuals.plugins.azureMap.name?[3,7]:(s=this.featureSwitchService.featureSwitches.azureMapVisual,l=this.featureSwitchService.featureSwitches.azureMapEnabled,u=this.featureSwitchService.featureSwitches.azureMapPreviewEnabled,this.explorationCapabilities.getCapabilities().azureMaps?s&&(l||u)?[3,12]:((p=f.buildErrorDetails(this.localizationService.get("VisualContainer_AzureMapVisual_NotEnabledMessage"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_AzureMapVisual_NotEnabledValue"))).source="User",[2,{details:p,code:"AzureMapVisualNotEnabled"}]):((p=f.buildErrorDetails(this.localizationService.get("VisualContainer_AzureMapVisual_NotSupportedMessage"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_AnalysisVisual_NotSupportedValue"))).source="User",[2,{details:p,code:"AzureMapVisualNotSupported"}]));case 7:return t!==g.visuals.plugins.map.name?[3,9]:[4,this.validateMapAndFilledMap("MapVisualNotEnabled")];case 8:return[2,e.sent()];case 9:return t!==g.visuals.plugins.filledMap.name?[3,11]:[4,this.validateMapAndFilledMap("FilledMapVisualNotEnabled")];case 10:return[2,e.sent()];case 11:if(this.featureSwitchService.featureSwitches.deprecateOldVisuals&&(t===g.visuals.plugins.comboChart.name||t===g.visuals.plugins.dataDotChart.name||t===g.visuals.plugins.dataDotClusteredColumnComboChart.name||t===g.visuals.plugins.dataDotStackedColumnComboChart.name||t===g.visuals.plugins.sunburst.name))return(p=f.buildErrorDetails(this.localizationService.get("VisualContainer_DeprecatedVisual_Message"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_DeprecatedVisual_Value"))).source="PowerBI",[2,{details:p,code:"deprecateVisualScreamFS"}];if(t===g.visuals.plugins.textbox.name&&!this.featureSwitchService.featureSwitches.daxTransformEnabled&&(c=y.getSingleVisualConfig(h),c=m.getValue(c.objects,{objectName:"general",propertyName:"paragraphs"},void 0),_.some(c,(function(e){return _.some(e.textRuns,(function(e){return g.visuals.TextEvaluation.isTextRunConditional(e)||g.visuals.TextEvaluation.isTextRun(e)&&g.isValueRef(e.value)}))}))))return(p=f.buildErrorDetails(this.localizationService.get("VisualContainer_Summarization_NotSupportedMessage"),this.localizationService.get("Summarization_Warning_UnsupportedModel"),this.localizationService.get("Summarization_Error_AnalysisUnsupported"))).source="User",[2,{details:p,code:"TextboxVisualNotSupported"}];e.label=12;case 12:return[2]}}))}))},f.prototype.validateMapAndFilledMap=function(a){var o;return __awaiter(this,void 0,g.Promise,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return(t="VisualContainer_MapAndFilledMap_NotEnabledTenantMessage",i="VisualContainer_MapAndFilledMap_NotEnabledValue",this.featureSwitchValuesLoader)?[4,this.featureSwitchValuesLoader.ensureDynamicFeatureSwitchesLoaded()]:[3,2];case 1:e.sent()||(t=i="VisualContainer_MapAndFilledMap_NotEnabledNotSignedInMessage"),e.label=2;case 2:return n=this.featureSwitchService.featureSwitches.bingMapTenantSetting,r=null==(o=this.embedModeService)?void 0:o.isAppTokenEmbed(),r=this.featureSwitchService.featureSwitches.bingMapEnabled||r,n&&!r?((n=f.buildErrorDetails(this.localizationService.get(t),this.localizationService.get("VisualContainer_MapAndFilledMap_NotEnabledMessage"),this.localizationService.get(i))).source="User",[2,{details:n,code:a}]):[2]}}))}))},f.buildErrorDetails=function(e,t,i){return{message:e,displayableErrorInfo:[{errorInfoKey:t,errorInfoValue:i}]}},f.prototype.validateCustomVisual=function(c){return __awaiter(this,void 0,g.Promise,(function(){var t,i,r,n,a,o,s,l,u;return __generator(this,(function(e){switch(e.label){case 0:return(n=this.reportSettingsService&&this.reportSettingsService.areCustomVisualsDisabled(),a=this.reportSettingsService&&this.reportSettingsService.areUncertifiedVisualsDisabled(),o=this.featureSwitchService.featureSwitches.customVisualsTenantSwitch&&!this.featureSwitchService.featureSwitches.customVisualsTenantEnabled,this.featureSwitchService.featureSwitches.customVisuals)?[3,1]:(r=f.buildErrorDetails(this.localizationService.get("VisualContainer_CustomVisualDisabledMessage"),this.localizationService.get("VisualContainer_CustomVisualDisabledKey"),this.localizationService.get("VisualContainer_CustomVisualDisabledValue")),i="UnsupportedVisual",[3,3]);case 1:return l=(s=p).isCustomVisualTypeDisabled,u=[this.featureSwitchService,c,this.approvedResourceService,!0],[4,this.managedCustomVisualsService.isPublicManagedVisualByVisualType(c)];case 2:l.apply(s,u.concat([e.sent(),n,a]))?i=(n||o?((r=f.buildErrorDetails(this.localizationService.get("VisualContainer_CustomVisualDisabledByAdmin"),null,null)).errorType=1,r.helpLink="https://go.microsoft.com/fwlink/?linkid=2100000"):((r=f.buildErrorDetails(this.localizationService.get("VisualContainer_UncertifiedDisabledValue"),null,null)).errorType=1,r.helpLink="https://go.microsoft.com/fwlink/?linkid=2002010&clcid=0x409"),"CustomVisualsPermissionLocked"):p.isOrganizationalCustomVisual(c)&&!this.resourcePackageService.getPackage(c)?((r=f.buildErrorDetails(this.localizationService.get("CustomVisualsAreNotAvailable"),null,null)).errorType=1,r.helpLink="https://go.microsoft.com/fwlink/?LinkID=690865",i="CustomVisualAreNotAvailable"):this.resourcePackageService.getPackage(c)||(r=f.buildErrorDetails(this.localizationService.format("VisualContainer_ToSeeCustomVisual",[c]),null,null),i="CustomVisualNotFound"),e.label=3;case 3:return[2,t=i?{code:i,details:r}:t]}}))}))},d=f})(powerbi=powerbi||{}),(function(A){var T;(function(V){var x=A.ItemGroupingManager,w=A.explore.services.selectionUtils,P=A.visualHost.utils.ResourcePackageUtils;function e(){}function F(e){e.exploration.sections.length;var t=e.sectionStatus.currentSectionNumber;return t<0&&0<e.exploration.sections.length&&(t=0),e.exploration.sections[t]}e.createUndoRedoHandler=function(p,h,d,v,g,m,o,y,f,C,s,S,t,b,E){var i=this;return{takeSnapshot:function(e){var t=F(p).contract.name,i=A.explore.services.selectionUtils.getSelectedCanvasItems(h),r=[],i=(i&&(r=_.map(i,(function(e){return e.name}))),{withVisibility:!0,withTransientPages:!0,withTransientFilters:!0,cache:s}),n=g.getContext(),e=e&&null!=e.canvasLayout?e.canvasLayout:m&&m.getCurrentLayout(),a=o.serializeExploration(p.exploration.contract,i);return{contract:a,linguisticSchema:f.getSchema(p.exploration.contract.reportId),selectedSlide:t,selectedVisualsIndex:[],selectedCanvasItemsName:r,drillToDetailsState:n?n.toSnapshot(y):void 0,canvasLayout:e,getReferences:function(){var e=o.deserializeExploration(a,[],!0);return o.getReferencedStaticResources(e)}}},rollback:function(u){g.clearContext();var c=o.deserializeExploration(u.contract,[],!0),e=o.getReferencedStaticResources(c);t.restoreReferences(e).then((function(){return __awaiter(i,void 0,A.Promise,(function(){var t,i,r,n,a,o,s,l;return __generator(this,(function(e){switch(e.label){case 0:return v.featureSwitches.mobileAuthoringFormattingUI&&1===u.canvasLayout?[4,(function(i,r){return __awaiter(this,void 0,A.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,i.get("mobileVcObjectsProxy")];case 1:return(t=e.sent()).isSupported()?[2,t.wrap(r)]:[2]}}))}))})(b,c)]:[3,2];case 1:c=e.sent(),e.label=2;case 2:for(r in l=y.getCurrentExploration(),t=P.getStaticResources(l.resourcePackages),i=P.getStaticResources(c.resourcePackages),t)n=t[r],i[r]||V.ResourcePackageUtils.ensureResourcePackages(c).push(_.clone(n)),P.findResourcePackage(c.resourcePackages,n.type,n.name).items=_.map(n.items,(function(e){return _.clone(e)}));return S.removeAllCustomVisuals(),a=_.filter(c.resourcePackages,(function(e){return P.isCustomVisualResourcePackage(e)})),s=a,v.featureSwitches.consumePublicCvsWithoutRps&&c.publicCustomVisuals&&(o=(o=E.createPublicResourcePackagesByName(c.publicCustomVisuals)).filter((function(t){return!a.some((function(e){return e.name===t.name}))})),s=s.concat(o)),S.ensurePlugins(s).finally((function(){C.publishToChannel(T.services.events.preparePersonalVisuals)})),o=T.SectionUtils.findSectionIndexForSectionName(c,u.selectedSlide),p.sectionStatus.currentSectionNumber=o,p.exploration=T.viewModels.ViewModelFactory.convertExploration(c,u.canvasLayout,o),p.exploration.contract.themeCollection.highContrastTheme=l.themeCollection.highContrastTheme,p.exploration.contract.themeCollection.highContrastTheme||delete p.exploration.contract.themeCollection.highContrastTheme,f.setSchema(c.reportId,u.linguisticSchema),s=y.getCurrentSection(),l=F(p),y.loadExploration(p.exploration.contract),y.goto(l.contract,{updateUrl:s.name!==l.contract.name}),d.updateCrossDrillOfSectionOperation(l.contract),setTimeout((function(){var e=p.exploration.exploreCanvas.visualContainerGroups,t=[],i=u.selectedCanvasItemsName;if(0<i.length){for(var r=0,n=i;r<n.length;r++){var a=n[r],a=x.find(a,e);a&&t.push(a.contract)}w.selectCanvasItems(t,h),u.drillToDetailsState&&g.setContext(A.drillDetailsModuleFactory().snapshotToContext(u.drillToDetailsState,y))}else h.clearSelection();m.changeFormFactor(u.canvasLayout,p)}),0),[2]}}))}))}))}}},V.ExploreUndoRedoHandlerUtility=e})((T=A.explore||(A.explore={})).util||(T.util={}))})(powerbi=powerbi||{}),(function(e){var t,i,r,n;t=e.explore||(e.explore={}),i=t.viewModels||(t.viewModels={}),r=t.contracts.FilterType,n=e.data.RelativeFilterType,(i.RelativeFilterViewModelUtil||(i.RelativeFilterViewModelUtil={})).relativeFilterTypeToFilterType=function(e){switch(e){case n.Time:return r.RelativeTime;case n.Date:return r.RelativeDate;default:n.Unsupported;return null}}})(powerbi=powerbi||{}),(function(i){var e,a;function o(e,t){(t=void 0===t?!0:t)&&(e.stopPropagation(),e.preventDefault());t=e.dataTransfer.getData("pbi-tree-node");if(t){e=JSON.parse(t).fieldExpr;if(e)return i.data.services.SemanticQuerySerializer.deserializeExpr(e)}}function s(e,t){var e=e.getBoundingClientRect(),i=0;return e.top+e.height/2>t.pageY?i|=1:i|=4,e.left+e.width/2>t.pageX?i|=8:i|=2,i}function l(e,t){e&&!e.classList.contains(t)&&(e.classList.remove(a.Append.class),e.classList.remove(a.None.class),e.classList.remove(a.Prepend.class),e.classList.remove(a.Replace.class),e.classList.add(t))}function u(e){l(e.previousElementSibling,a.None.class),l(e,a.None.class),l(e.nextElementSibling,a.None.class)}e=(e=i.explore||(i.explore={})).helpers||(e.helpers={}),a=jsCommon.HighlightClasses,e.enableDropFromModernFieldList=function(i,r,n){i.addEventListener("drop",(function(e){var t=o(e);t&&r(e,t,s(i,e))})),i.addEventListener("dragover",(function(e){if(n){var t=i;switch(n(s(i,e))){case 0:l(t.previousElementSibling,a.None.class),l(t,a.None.class),l(t.nextElementSibling,a.None.class);break;case 2:l(t.previousElementSibling,a.Append.class),l(t,a.Prepend.class),l(t.nextElementSibling,a.None.class);break;case 3:l(t.previousElementSibling,a.None.class),l(t,a.Append.class),l(t.nextElementSibling,a.Prepend.class);break;case 1:l(t.previousElementSibling,a.None.class),l(t,a.Replace.class),l(t.nextElementSibling,a.None.class);break;default:u(t)}}e.preventDefault()})),n&&(i.addEventListener("dragleave",(function(){return u(i)})),i.addEventListener("dragexit",(function(){return u(i)})),i.addEventListener("dragend",(function(){return u(i)})))},e.getModernFieldListExpr=o})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).helpers||(e.helpers={})).VisualHostInsideZoneAdapter||(e.VisualHostInsideZoneAdapter={})).wrapHostServices=function(n,r){function a(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return r.run(e,n,t)}return{getLocalizedString:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return n.getLocalizedString.apply(n,__spreadArray([e],t||[]))},tooltips:function(){return n.tooltips()},getSectionsMetadata$:function(){return n.getSectionsMetadata$()},getBookmarksMetadata$:function(){return n.getBookmarksMetadata$()},getSubSelectionService:function(){return n.getSubSelectionService()},alertScreenReader:function(e){return a(n.alertScreenReader,e)},alertWithDebounce:function(e,t){return a(n.alertWithDebounce,e,t)},requestFocus:function(e){return a(n.requestFocus,e)},onDragStart:function(e){return a(n.onDragStart,e)},getVisualLinkProperties:function(){return a(n.getVisualLinkProperties)},canSelect:function(e){return a(n.canSelect,e)},onSelecting:function(e){return a(n.onSelecting,e)},onSelect:function(e){return a(n.onSelect,e)},onSwitchFocusModeState:function(e){return a(n.onSwitchFocusModeState,e)},canExpandCollapse:function(e){return a(n.canExpandCollapse,e)},setNodeExpansionState:function(e){return a(n.setNodeExpansionState,e)},setLevelExpansionState:function(e){return a(n.setLevelExpansionState,e)},onContextMenu:function(e){return a(n.onContextMenu,e)},loadMoreData:function(){return a(n.loadMoreData)},loadWindow:function(e){return a(n.loadWindow,e)},setShouldDeferData:function(e){return a(n.setShouldDeferData,e)},persistProperties:function(e,t){return a(n.persistProperties,e,t)},onCustomSort:function(e){return a(n.onCustomSort,e)},getViewMode:function(){return a(n.getViewMode)},getEditMode:function(){return a(n.getEditMode)},setWarnings:function(e){return a(n.setWarnings,e)},setToolbar:function(e,t){return a(n.setToolbar,e,t)},shouldRetainSelection:function(){return a(n.shouldRetainSelection)},geocoder:function(){return a(n.geocoder)},geolocation:function(){return a(n.geolocation)},locale:function(){return a(n.locale)},promiseFactory:function(){return a(n.promiseFactory)},ignoreDefaultFilter:function(){return a(n.ignoreDefaultFilter)},getIdentityDisplayNames:function(e){return a(n.getIdentityDisplayNames,e)},setIdentityDisplayNames:function(e){return a(n.setIdentityDisplayNames,e)},dropdown:function(){return a(n.dropdown)},telemetry:function(){return a(n.telemetry)},authenticationService:function(){return a(n.authenticationService)},localStorageService:function(){return a(n.localStorageService)},eventService:function(){return a(n.eventService)},licenseManagerService:function(){return a(n.licenseManagerService)},loader:function(){return a(n.loader)},getUIComponentFactory:function(){return a(n.getUIComponentFactory)},applyJsonFilter:function(e,t,i,r){return a(n.applyJsonFilter,e,t,i,r)},applyIdentityFilter:function(e,t,i,r){return a(n.applyIdentityFilter,e,t,i,r)},launchUrl:function(e){return a(n.launchUrl,e)},instanceId:n.instanceId,refreshHostData:function(){return a(n.refreshHostData)},decompositionService:function(){return a(n.decompositionService)},getJSONFilter:function(e,t){return a(n.getJSONFilter,e,t)},visualCapabilitiesChanged:function(){return a(n.visualCapabilitiesChanged)},onHyperlinkClick:function(e,t){return a(n.onHyperlinkClick,e,t)},visualTimeSynchronization:function(){return a(n.visualTimeSynchronization)},setFilterExpressionMetadata:function(e){return a(n.setFilterExpressionMetadata,e)},getFilterExpressionMetadata:function(){return a(n.getFilterExpressionMetadata)},isVisualEnabled:function(){return a(n.isVisualEnabled)},dataMultiSelectMode:function(){return a(n.dataMultiSelectMode)},networkAvailability:function(){return a(n.networkAvailability)},downloadService:function(){return a(n.downloadService)},setAriaMetadata:function(e){return a(n.setAriaMetadata,e)},artifactService:function(){return a(n.artifactService)},onNotifyLicense:function(e){return a(n.onNotifyLicense,e)},onClearLicenseNotification:function(){return a(n.onClearLicenseNotification)},onNotifyFeatureBlocked:function(e){return a(n.onNotifyFeatureBlocked,e)},webAccessService:function(){return a(n.webAccessService)},drill:function(e){return a(n.drill,e)}}}})(powerbi=powerbi||{}),(function(t){!(function(p){var e,n,o;function h(e,t,i){var r=n.call(this)||this;return r.schema=e,r.displayName=t,r.metadata=i,r.dataPoints=[],r.isExclude=!1,r}e=p.services||(p.services={}),o=t.visuals.valueFormatter,n=t.data.DefaultSQExprVisitor,__extends(h,n),h.prototype.visitNot=function(e){this.isExclude=!0,e.arg.accept(this)},h.prototype.visitOr=function(e){e.left.accept(this),e.right.accept(this)},h.prototype.visitIn=function(e){var t=this;if(!_.isEmpty(e.values)){for(var i=[],r=e.args,n=_.map(r,(function(e){return t.displayName.getDisplayName(e,t.schema,null,null,null,{includeVariationSource:!0})})),a=0,o=e.values;a<o.length;a++){var s=o[a],l=(r.length,s.length,n),u=_.map(s,(function(e){return e.value})),c=p.FilterUtils.findValuesInFilterCache(r,s,this.metadata);c&&(l=_.map(c.columns,(function(e){return t.displayName.getDisplayName(e,t.schema,null,null,null,{includeVariationSource:!0})})),u=c.values),i.push({columns:r,values:s,text:h.getDataPointText(l,u)})}(e=this.dataPoints).push.apply(e,i||[])}},h.getDataPointText=function(e,t){var i="";e.length,e.length,t.length;for(var r=0;r<e.length;r++){var n=t[r],a=e[r];i+=o.format(n)+" ("+a+") + "}return i=i.slice(0,i.length-3)},e.IncludeExcludeSQExprVisitor=h})(t.explore||(t.explore={}))})(powerbi=powerbi||{}),(function(m){m.drillDetailsModuleFactory=function(){var c=m,e=(c.common.contracts,c.data),t=c.explore,p=(t.contracts,t.services.events),i=t.util,r=jsCommon.ArrayExtensions,n=m.explore.FilterUtils,a=m.explore.services.selectionUtils,o=t.SectionUtils,h=e.SQExpr,d=jsCommon.Utility,v=i.VisualContainerUtils,s=(l.prototype.toSnapshot=function(e){var t,i=this;if(e.getCurrentSection()===this.targetSection)return e=e.getCurrentExploration(),t=o.findSectionIndexForSection(e,this.sourceSection),e=o.findSectionIndexForSection(e,this.targetSection),{sourceSectionIndex:t,sourceVisualIndex:_.findIndex(this.sourceSection.visualContainers,(function(e){return e===i.sourceVisualContainer})),targetSectionIndex:e,targetVisualIndex:_.findIndex(this.targetSection.visualContainers,(function(e){return e===i.targetVisualContainer}))}},l.fromSnapshot=function(e,t){var i,r,n;if(e)return n=t.getCurrentExploration(),i=n.sections[e.sourceSectionIndex],r=i.visualContainers[e.sourceVisualIndex],n=n.sections[e.targetSectionIndex],e=n.visualContainers[e.targetVisualIndex],t.getCurrentSection(),new l(i,r,n,e,0)},l);function l(e,t,i,r,n){this.sourceSection=e,this.sourceVisualContainer=t,this.targetSection=i,this.targetVisualContainer=r,this.navigationState=n}u.prototype.drillToDetails=function(i,r,e){var n=this;if(!_.isEmpty(i)){var t=_.head(i);if(t&&!_.isEmpty(t.metadata)){var a=v.getVisualQuery(r);if(a&&a.defn){if(_.isEmpty(t.dataMap)){if(!a.projections)return;var o,s=v.getDataRolesForVisual(r,this.visualPluginService),l=_(s).filter((function(e){return e.kind!==c.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value();for(o in a.projections)if(!_.isEmpty(a.projections[o])&&_.includes(l,o))return}var u=a.defn.select().withName(_.head(t.metadata));u&&h.isAggregation(u.expr)&&this.conceptualSchemaProxy.get(e).then((function(e){var t=n.visualAuthoringOperations.drillToDetails(d.generateGuid(),e,[u.expr],i,r);t&&(n.addCrossFilters(r,n.explorationNavigationService.getCurrentSection(),t,!1,e),n.drillToDetailsCore(i,r,t))}),(function(){return _.noop}))}}}},u.prototype.generateDetailsTable=function(e,t,i,r){e=this.mockVisualContainer(e),t=this.visualAuthoringOperations.drillToDetails(d.generateGuid(),t,i,null,e,r);if(t)return t.config.singleVisual},u.prototype.clear=function(){var e;this.drillToDetailsContext&&(this.drillToDetailsContext.navigationState,this.drillToDetailsContext.navigationState=1,e=o.findSectionIndexForSection(this.explorationNavigationService.getCurrentExploration(),this.drillToDetailsContext.sourceSection),this.eventBridge.publishToChannel(p.switchSection,{index:e}))},u.prototype.getContext=function(){return this.drillToDetailsContext},u.prototype.setContext=function(e){this.drillToDetailsContext,e.navigationState,this.drillToDetailsContext=e},u.prototype.clearContext=function(){this.drillToDetailsContext=null},u.prototype.hasContext=function(){return!!this.drillToDetailsContext},u.prototype.getDetailsTableTargetMeasures=function(e){var e=this.mockVisualContainer(e),t=v.getVisualQuery(e);if(t&&t.defn){e=v.getDataRolesForVisual(e,this.visualPluginService);if(!_.isEmpty(e)){for(var i=[],r=0,n=_(e).filter((function(e){return(e.kind===c.VisualDataRoleKind.Measure||e.kind===c.VisualDataRoleKind.GroupingOrMeasure)&&0!==e.joinPredicate})).map((function(e){return e.name})).value();r<n.length;r++){var a=n[r],a=t.projections[a];if(!_.isEmpty(a))for(var o=0,s=a.all();o<s.length;o++){var l=s[o],l=t.defn.select().withName(l.queryRef);if(l&&h.isAggregation(l.expr))return[l.expr];l&&h.isMeasure(l.expr)&&i.push(l.expr)}}return i}}},u.prototype.mockVisualContainer=function(e){e={name:d.generateGuid(),config:{singleVisual:e},layouts:r.createWithId(),filters:[]};return e.layouts.push({id:0,position:{x:0,y:0,width:0,height:0}}),e},u.prototype.onSectionChanged=function(){var e=this;if(this.drillToDetailsContext){this.explorationNavigationService.getCurrentSection();switch(this.drillToDetailsContext.navigationState){case 0:this.drillToDetailsContext.targetSection,window.setTimeout((function(){a.selectCanvasItem(e.drillToDetailsContext.targetVisualContainer,e.selectionService),e.visibility.set(e.drillToDetailsContext.targetVisualContainer,1)}),0);break;case 1:this.drillToDetailsContext.sourceSection;var t=this.explorationNavigationService.getCurrentExploration(),i=o.findSectionIndexForSection(t,this.drillToDetailsContext.targetSection),r=o.findSectionIndexForSection(t,this.drillToDetailsContext.sourceSection),n=this.drillToDetailsContext.sourceVisualContainer;this.drillToDetailsContext=null,this.eventBridge.publishToChannel(p.deleteSection,{targetSectionIndex:i}),window.setTimeout((function(){o.findSectionIndexForSection(e.explorationNavigationService.getCurrentExploration(),e.explorationNavigationService.getCurrentSection())===r&&a.selectCanvasItem(n,e.selectionService),e.undoRedo.clear()}),0)}}},u.prototype.onPopOutModeChanged=function(){!this.drillToDetailsContext||this.explorationNavigationService.getCurrentSection()!==this.drillToDetailsContext.sourceSection&&(this.drillToDetailsContext.targetSection,this.visibility.get()!==this.drillToDetailsContext.targetVisualContainer&&this.clear())},u.prototype.drillToDetailsCore=function(e,t,i){var r,n,a=this.explorationNavigationService.getCurrentSection();a&&(r=this.explorationNavigationService.getAllSections(),n=this.explorationSerializer.serializePage(a,1),n={name:"Drill to Details",displayName:"Drill to Details",filters:(n=this.explorationSerializer.deserializePage(n)).filters,size:n.size,visualContainers:[i],visualContainerGroups:[i],transient:!0},o.setUniqueNewSectionCanvasItemNames(n,r),this.drillToDetailsContext=new s(a,t,n,i,0),this.eventBridge.publishToChannel(p.insertSection,n))},u.prototype.addCrossFilters=function(e,t,i,r,n){t=this.filterGenerator.getVisualContainerCrossFilters(t,e,n);if(t.dataFilters)for(var a=0,o=t.dataFilters;a<o.length;a++){var s=o[a];this.addVisualFilters(i,s,n,!1)}if(r){t.highlightFilters;for(var l=0,u=t.highlightFilters;l<u.length;l++){s=u[l];this.addVisualFilters(i,s,n,!1)}}},u.prototype.addVisualFilters=function(e,t,i,r){t&&t.filter&&(t=n.convertFilterData(t,e.filters,0),n.add(e,t))};var g=u;function u(e,t,i,r,n,a,o,s,l,u){var c=this;this.conceptualSchemaProxy=e,this.visualAuthoringOperations=t,this.undoRedo=i,this.selectionService=r,this.explorationNavigationService=n,this.explorationSerializer=a,this.visibility=o,this.eventBridge=s,this.filterGenerator=l,this.visualPluginService=u,this.eventBridge.createChannelSubscriptionManager().subscribe(p.canvasChanged,(function(){return c.onSectionChanged()})).subscribe(p.visibilityChanged,(function(){return c.onPopOutModeChanged()})).subscribe(p.explorationUnloaded,(function(e,t){return c.clearContext()}))}return{create:function(e,t,i,r,n,a,o,s,l,u){return new g(e,u,r,n,a,t,o,s,l,i)},createContext:function(e,t,i,r,n){return new s(e,t,i,r,n)},snapshotToContext:s.fromSnapshot}}})(powerbi=powerbi||{}),(function(h){var d,i,t,n,r,l;function e(e,t,i,r,n,a,o,s){this.contextActivityService=e,this.eventBridge=t,this.selection=i,this.formFactor=r,this.telemetryService=n,this.explorationActivity=a,this.sectionsSubject=o,this.currentSectionSubject=s,this.history=[],this.sections$=o.asObservable(),this.currentSection$=s.asObservable(),a.registerExplorationNavigationService(this)}d=h.explore||(h.explore={}),i=d.services||(d.services={}),t=h.common.utils.IdUtility,n=contextActivity.isOpenReportActivity,r={updateUrl:!0,action:i.SectionNavigationAction.Unknown},i.createExplorationNavigationService=function(e,t,i,r,n,a,o,s){return new l(e,t,i,r,n,a,o,s)},e.prototype.registerExplorationViewModel=function(e){this.getViewModel=e},e.prototype.updateActiveSection=function(o){var s,l,e,t,i,r,u=this,c=this.getViewModel(),p=c.exploration.contract;0<=o.targetSectionIndex&&(o.targetSectionIndex,p.sections.length),!o.forceUpdate&&p.activeSectionIndex===o.targetSectionIndex||(s=null==o.clearSelection||o.clearSelection,l=-1<o.targetSectionIndex&&o.targetSectionIndex<p.sections.length,t=(e=this.exploration.sections[o.targetSectionIndex]).objectId,r=e.displayName,this.contextActivityService.upsertExplorationProperties({reportPageId:t,reportPageName:r}),o.parentContextActivity&&o.parentContextActivity.isRunning()&&(o.parentContextActivity.setProperty("reportPageId",t),o.parentContextActivity.setProperty("reportPageName",r)),this.changeReportPageActivity&&this.changeReportPageActivity.isRunning()&&this.changeReportPageActivity.cancel(),this.changeReportPageActivity&&this.changeReportPageActivity.isRunning()||(t={name:"Change Report Page"},o.parentContextActivity?n(o.parentContextActivity)&&o.parentContextActivity.isRunning()?this.changeReportPageActivity=o.parentContextActivity.createChildActivity(t):this.changeReportPageActivity=o.parentContextActivity:this.changeReportPageActivity=this.contextActivityService.createActivity(t)),i=d.util.VisualContainerUtils.getVisualTypesAndCountsFromSection(e),r=Object.keys(i).reduce((function(e,t){return"__hidden"!==t?e+i[t]:e}),0),this.changeReportPageActivity.isRunning()&&(this.changeReportPageActivity.setProperty("visualTypesAndCount",JSON.stringify(i)),this.changeReportPageActivity.setProperty("totalVisibleVisualCount",r)),o.parentContextActivity&&o.parentContextActivity.isRunning()&&(o.parentContextActivity.setProperty("visualTypesAndCount",JSON.stringify(i)),o.parentContextActivity.setProperty("totalVisibleVisualCount",r)),this.explorationActivity.changeSection((function(e){var t=u.getCurrentSection();if(o.suppressHistory||t&&!t.transient&&u.history.push({name:t.name}),l){u.selection&&!1!==s&&!_.isEmpty(u.selection.getSelectedElements())&&u.selection.clearSelection();var i=c.exploration.sections;if(!_.isEmpty(i))for(var r=i.length-1;0<=r;--r)i[r].selected=r===o.targetSectionIndex;c.sectionStatus.currentSectionNumber=o.targetSectionIndex;var n=p.sections[o.targetSectionIndex],a=null!==o.canvasLayout&&void 0!==o.canvasLayout?o.canvasLayout:u.formFactor.getCurrentLayout();c.exploration.exploreCanvas=d.viewModels.ViewModelFactory.convertSectionToExploreCanvas(p,n,a,o.currentZone),(null==o.clearCrossFilter||o.clearCrossFilter)&&t&&t.crossFilterSource&&(t.crossFilterSource.highlight=void 0),n&&((a=e.event.info).width=n.size.width,a.height=n.size.height,a.displayOption=n.size.displayOption),u.goto(n,{action:o.navigationAction,newReport:o.newReport,parentActivity:e,parentContextActivity:u.changeReportPageActivity,isInitialUpdateSection:o.isInitialUpdateSection})}}),(function(){return u.telemetryService.startChildActivity(o.parentActivity&&o.parentActivity.event,h.telemetry.EXUpdateActiveSection,{targetSectionIndex:o.targetSectionIndex,forceUpdate:o.forceUpdate,suppressHistory:o.suppressHistory,canvasLayout:o.canvasLayout,clearSelection:s,isCancelled:!1,sectionGuid:l&&p.sections[o.targetSectionIndex].objectId})}),this.changeReportPageActivity))},e.prototype.updateExplorationActiveSectionIndex=function(e){e.exploration,e.section;var t,i,r,n=e.exploration,a=h.explore.SectionUtils.findSectionIndexForSectionName(n,e.section);null!=a&&n&&n.sections&&n.sections[a].transient||(n.activeSectionIndex=a,e.suppressTelemetry||(t=(t=n.sections[a])?t.objectId:void 0,i=n.report?n.report.originalReportObjectId:void 0,r=n.report&&n.report.ownerInfo?n.report.ownerInfo.groupObjectId:void 0,this.telemetryService.logChildEvent(e.parentActivity&&e.parentActivity.event,h.telemetry.ExploreHostChangeReportPage,{reportId:n.reportId,reportGuid:e.reportGUID,sectionIndex:a,sectionGuid:t,groupObjectId:e.groupObjectId,isReadonlyGroup:e.isReadonlyGroup,permissions:e.reportPermissions,scrubUserInfo:e.scrubUserInfo,newReport:e.newReport,originalReportGuid:i,originalGroupObjectId:r})))},e.prototype.goto=function(e,t){this.updateSectionViewSession(),t&&t.parentContextActivity&&this.telemetryData&&(t.parentContextActivity.setProperty("reportPageViewSessionId",this.telemetryData.exsid),t.parentContextActivity.setProperty("isInitialUpdateSection",!!t.isInitialUpdateSection)),t=t?_.merge({},r,t):r,this.currentSection=e,this.currentSectionSubject.next(e),this.raiseEvent(),t.updateUrl&&(e={name:e.name,displayName:e.displayName,action:t.action,newReport:t.newReport,parentActivity:t.parentActivity,parentContextActivity:t.parentContextActivity,isInitialUpdateSection:t.isInitialUpdateSection},this.eventBridge.publishToChannel(i.events.sectionChanged,e))},e.prototype.back=function(e){var t,i;_.isEmpty(this.history)||(t=this.history.pop(),(i=_.findIndex(this.exploration.sections,(function(e){return e.name===t.name})))<0||this.updateActiveSection({targetSectionIndex:i,forceUpdate:!1,suppressHistory:!0,parentActivity:e}))},e.prototype.loadExploration=function(e,t){this.telemetryData=void 0,this.exploration=e,this.currentZone=e&&t,e&&e.sections&&0<=e.activeSectionIndex&&(t=e.sections[e.activeSectionIndex],this.currentSection=t,this.currentSectionSubject.next(t)),this.emitUpdatedSections(),this.raiseExplorationLoadedEvent(e)},e.prototype.startExplorationSession=function(e){e&&void 0===e.exid&&(e.exid=t.generateShortId(5)),this.telemetryData=e},e.prototype.updateExplorationTelemetryData=function(e){this.telemetryData||(this.telemetryData={}),_.assign(this.telemetryData,e)},e.prototype.getExplorationTelemetryData=function(){return this.telemetryData},e.prototype.getCurrentSection=function(){if(this.currentSection)return this.currentSection;var e=this.exploration;return e&&_.inRange(e.activeSectionIndex,0,e.sections.length)?e.sections[e.activeSectionIndex]:void 0},e.prototype.getSectionByName=function(t){return _.find(this.exploration.sections,(function(e){return e.name===t}))},e.prototype.getAllSections=function(){return this.exploration&&this.exploration.sections},e.prototype.getAllVisualContainers=function(i){return this.exploration&&this.exploration.sections?i?this.exploration.sections.reduce((function(e,t){return e.concat(t.visualContainers.filter((function(e){return e.config.singleVisual.visualType===i})))}),[]):this.exploration.sections.reduce((function(e,t){return e.concat(t.visualContainers)}),[]):[]},e.prototype.getCurrentExploration=function(){return this.exploration},e.prototype.getCurrentExploreCanvas=function(){return this.getViewModel,this.getViewModel().exploration.exploreCanvas},e.prototype.showExplorationMask=function(){this.getViewModel,this.getViewModel().showMask=!0},e.prototype.hideExplorationMask=function(){this.getViewModel,this.getViewModel().showMask=!1},e.prototype.getCurrentZone=function(){return this.currentZone},e.prototype.emitUpdatedSections=function(){this.sectionsSubject.next(this.getAllSections())},e.prototype.raiseEvent=function(){this.eventBridge.publishToChannel(i.events.canvasChanged)},e.prototype.raiseExplorationLoadedEvent=function(e){this.eventBridge.publishToChannel(i.events.explorationLoaded,e)},e.prototype.updateSectionViewSession=function(){var e;this.telemetryData&&(e=t.generateShortId(5),this.telemetryData.exsid=e,this.contextActivityService.upsertExplorationProperties({reportPageViewSessionId:e}))},l=e})(powerbi=powerbi||{}),(function(o){var e,n,s,k,a,l,u,c,p,h,d,v,g,m,y,f,C,S,b,E,V,x,w,P,F,A,T,D,M,I,O,N,L,X,H,G,j,U,z,W,B,R;function t(t,e,i,r){var n=this;this.asyncFeatureSwitchService=t,this.resourceLoader=e,this.promiseFactory=i,this.resourceLoader=e,this.promiseFactory=i,this.trustedConvertibleVisualTypes=[],this.customConvertibleVisualTypes=[],this.globalConvertibleVisualTypes=[],this.storage=new a,this.initBuiltInPlugins=this.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){return r=r||new R(t),n.getConvertibleCoreVisualTypeNames(e)})).then((function(e){for(var t in n.globalConvertibleVisualTypes=e,o.visuals.plugins)n.storage.loadPlugin(t,r.getPlugin(t))}))}function i(e,t,i){this.featureSwitchService=e,this.mapControlFactory=t,this.visualSandbox=i}e=(e=o.explore||(o.explore={})).services||(e.services={}),n=o.visuals.PivotTableOptions,s=o.visualHost.utils.ResourcePackageUtils,k=o.visuals.TableExOptions,a=o.visualHost.visualPluginServiceHelpers.VisualPluginStorage,l=o.visuals.createActionButton,u=o.visuals.createPivotTable,c=o.visuals.createTableEx,p=o.visuals.createMatrix,h=o.visuals.createTable,d=o.visuals.createAccessibleTable,v=o.visuals.createCard,g=o.visuals.createGauge,m=o.visuals.createDonutChart,y=o.visuals.createMultiRowCard,f=o.visuals.createFunnelChart,C=o.visuals.createMap,S=o.visuals.createAzureMap,b=o.visuals.createShapeMap,E=o.visuals.createTreemap,V=o.visuals.createSlicer,x=o.visuals.createTextbox,w=o.visuals.createScriptVisual,P=o.visuals.createKpi,F=o.visuals.createDecompositionTree,A=o.visuals.createShapeVisual,T=o.visuals.createSunburst,D=o.visuals.createCartesianChart,M=o.visuals.createWebColumnChartAnimator,I=o.visuals.createCartesianChartBehaviorFactory,O=o.visuals.createColumnChartWebBehaviorFactory,N=o.visuals.createDataDotChartWebBehaviorFactory,L=o.visuals.createLineChartWebBehaviorFactory,X=o.visuals.createScatterChartWebBehaviorFactory,H=o.visuals.createWaterfallChartWebBehaviorFactory,G=o.visuals.createAzureMapBehavior,j=o.visuals.createShapeMapBehavior,U=o.visuals.createTreeMapWebAnimator,z=o.visuals.createTreeMapWebBehavior,W=o.visuals.createSunburstBehavior,e.createExplorationVisualPluginService=function(e,t,i,r,n){return new B(e,i,t,new R(e,r,n))},t.prototype.getConvertibleCoreVisualTypeNames=function(e){var t=[o.visuals.plugins.barChart.name,o.visuals.plugins.columnChart.name,o.visuals.plugins.clusteredBarChart.name,o.visuals.plugins.clusteredColumnChart.name,o.visuals.plugins.hundredPercentStackedBarChart.name,o.visuals.plugins.hundredPercentStackedColumnChart.name,o.visuals.plugins.lineChart.name,o.visuals.plugins.areaChart.name,o.visuals.plugins.stackedAreaChart.name,o.visuals.plugins.lineStackedColumnComboChart.name,o.visuals.plugins.lineClusteredColumnComboChart.name,o.visuals.plugins.ribbonChart.name];e&&e.dataDotChartEnabled&&t.push.apply(t,[o.visuals.plugins.dataDotClusteredColumnComboChart.name,o.visuals.plugins.dataDotStackedColumnComboChart.name]),e&&e.histogram&&t.push(o.visuals.plugins.histogram.name),t.push.apply(t,[o.visuals.plugins.waterfallChart.name,o.visuals.plugins.funnel.name,o.visuals.plugins.scatterChart.name,o.visuals.plugins.pieChart.name,o.visuals.plugins.donutChart.name]),e&&e.sunburstVisualEnabled&&t.push(o.visuals.plugins.sunburst.name),t.push(o.visuals.plugins.treemap.name),t.push.apply(t,[o.visuals.plugins.map.name,o.visuals.plugins.filledMap.name]),e&&e.shapeMapVisualEnabled&&t.push(o.visuals.plugins.shapeMap.name),e&&e.azureMapVisual&&(e.azureMapEnabled||e.azureMapPreviewEnabled)&&t.push(o.visuals.plugins.azureMap.name),t.push.apply(t,[o.visuals.plugins.gauge.name,o.visuals.plugins.card.name,o.visuals.plugins.multiRowCard.name,o.visuals.plugins.kpi.name,o.visuals.plugins.slicer.name]),e&&e.pivotTableVisualEnabled?(t.push(o.visuals.plugins.tableEx.name),t.push(o.visuals.plugins.pivotTable.name)):(t.push(o.visuals.plugins.table.name),t.push(o.visuals.plugins.matrix.name)),e&&e.scriptVisualEnabled&&e.scriptVisualAuthoringEnabled&&(t.push(o.visuals.plugins.scriptVisual.name),t.push(o.visuals.plugins.pythonVisual.name)),e&&e.keyDrivers&&t.push(o.visuals.plugins.keyDriversVisual.name),t.push(o.visuals.plugins.decompositionTreeVisual.name),e&&e.qnaVisual&&t.push(o.visuals.plugins.qnaVisual.name),e&&e.daxTransformEnabled&&t.push(o.visuals.plugins.textbox.name),e&&e.scorecardVisual&&t.push(o.visuals.plugins.scorecard.name),e&&e.rdlNativeVisual&&t.push(o.visuals.plugins.rdlVisual.name);o.localStorageService.getData("VISUAL_DEVELOPER_MODE_ENABLED")&&t.push(o.visuals.plugins.debugVisual.name);e=this.promiseFactory.defer();return e.resolve(t),e.promise},t.prototype.getVisuals=function(){return this.storage.getLoadedPlugins()},t.prototype.getConvertibleVisuals=function(){for(var t=this,e=[],i=0,r=this.globalConvertibleVisualTypes;i<r.length;i++){var n=r[i];this.storage.hasPlugin(n)&&!_.includes(e,n)&&e.push(n)}for(var a=0,o=this.trustedConvertibleVisualTypes;a<o.length;a++){var s=o[a];this.storage.hasPlugin(s)&&!_.includes(e,s)&&e.push(s)}for(var l=0,u=this.customConvertibleVisualTypes;l<u.length;l++){var c=u[l];this.storage.hasPlugin(c)&&!_.includes(e,c)&&e.push(c)}return e.map((function(e){return t.storage.getLoadedPlugin(e)}))},t.prototype.getConvertibleVisualsAsync=function(){return __awaiter(this,void 0,o.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.ensureBuiltInPlugins()];case 1:return e.sent(),[2,this.getConvertibleVisuals()]}}))}))},t.prototype.ensureBuiltInPlugins=function(){return this.initBuiltInPlugins},t.prototype.ensureTrustedVisualPlugins=function(e){a.ensureTrustedVisualPlugins(this.storage,e);for(var t=0,i=e;t<i.length;t++){var r=i[t];this.addTrustedConvertibleVisualType(r.name)}},t.prototype.ensurePlugins=function(e,i){var r=this,n=(this.promiseFactory,[]);if(e&&e.length)for(var a=this,t=0,o=e;t<o.length;t++)!(function(e){var t;s.isCustomVisualResourcePackage(e)&&(t=a.ensurePlugin(e,i).then((function(){return r.addCustomConvertibleVisualType(e.name)})),n.push(t))})(o[t]);return this.promiseFactory.allSettled(n)},t.prototype.ensurePlugin=function(e,t){return a.ensurePlugin(this.storage,this.promiseFactory,this.resourceLoader,e,t)},t.prototype.addTrustedConvertibleVisualType=function(e){this.trustedConvertibleVisualTypes.indexOf(e)<0&&this.trustedConvertibleVisualTypes.push(e)},t.prototype.addCustomConvertibleVisualType=function(e){this.customConvertibleVisualTypes.indexOf(e)<0&&this.customConvertibleVisualTypes.push(e)},t.prototype.capabilities=function(e){e=this.getPlugin(e);return e?e.capabilities:void 0},t.prototype.removeAllCustomVisuals=function(){for(var e=0,t=this.customConvertibleVisualTypes;e<t.length;e++){var i=t[e];this.storage.unloadPlugin(i)}this.customConvertibleVisualTypes=[]},t.prototype.removePlugin=function(t){this.getPlugin(t)&&(this.storage.unloadPlugin(t),_.remove(this.customConvertibleVisualTypes,(function(e){return e===t})))},t.prototype.getTelemetryHostInformation=function(){return{name:"Exploration"}},t.prototype.isCustomVisual=function(e){return o.visualHost.utils.isCustomVisual(this.getPlugin(e),e)},t.prototype.isScriptVisual=function(e){return o.visualHost.utils.isScriptVisual(this.getPlugin(e))},t.prototype.isScriptVisualQueryable=function(e){return o.visualHost.utils.isScriptVisualQueryable(e,this.asyncFeatureSwitchService.featureSwitches)},t.prototype.isLightWeightRenderingVisual=function(e){return o.visualHost.utils.isLightWeightRenderingVisual(this.getPlugin(e))},t.prototype.getInteractivityOptions=function(){return{overflow:"hidden",isVisualInteractive:!0}},t.prototype.getCustomizeConvertTo=function(e,t){t=this.getPlugin(t);return t.getCustomizeConvertTo?t.getCustomizeConvertTo(e):void 0},t.prototype.loadPluginByNameIfAny=function(e){this.getPlugin(e)||(this.storage.hasPlugin(e)?this.storage.loadPlugin(e):o.visuals.plugins[e]&&this.storage.loadPlugin(e,o.visuals.plugins[e]))},t.prototype.getPlugin=function(e){return this.storage.getLoadedPlugin(e)},t.prototype.getStorage=function(){return this.storage},B=t,e.ExplorationVisualPluginService=B,i.prototype.getPlugin=function(e){var t=this,a=this.featureSwitchService.featureSwitches?_.clone(this.featureSwitchService.featureSwitches):{};switch(e){case o.visuals.plugins.barChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.barChart,(function(e){e=e.module;return e.createCartesianChart({chartType:6,isScrollable:!0,dataPointLassoSelect:!0,animator:e.createWebColumnChartAnimator(),tooltipsEnabled:!0,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:6,isScrollable:!0,dataPointLassoSelect:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),r.tooltipsEnabled=!0,i=I,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.card.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.card,(function(e){return e.module.createCard({isScrollable:!0,animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,interactivityEnabled:!0,featureSwitches:a})}),a,v?function(){return v({isScrollable:!0,animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,interactivityEnabled:!0,featureSwitches:a})}:void 0);case o.visuals.plugins.clusteredBarChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.clusteredBarChart,(function(e){e=e.module;return e.createCartesianChart({chartType:5,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:5,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,M()];case 1:return r.animator=e.sent(),i=I,[4,O()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.clusteredColumnChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.clusteredColumnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:3,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:3,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=I,[4,O()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.columnChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.columnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:4,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:4,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,M()];case 1:return r.animator=e.sent(),i=I,[4,O()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.dataDotClusteredColumnComboChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.dataDotClusteredColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:16,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createDataDotChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t=D,n={chartType:16,isScrollable:!0,tooltipsEnabled:!0},[4,M()];case 1:return n.animator=e.sent(),i=I,[4,O()];case 2:return r=[e.sent()],[4,N()];case 3:return[4,i.apply(void 0,[r.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.dataDotStackedColumnComboChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.dataDotStackedColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:17,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createDataDotChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t=D,n={chartType:17,isScrollable:!0,tooltipsEnabled:!0},[4,M()];case 1:return n.animator=e.sent(),i=I,[4,O()];case 2:return r=[e.sent()],[4,N()];case 3:return[4,i.apply(void 0,[r.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.donutChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.donutChart,(function(){return new o.visuals.DonutChart({animator:new o.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new o.visuals.DonutChartWebBehavior})}),a,m?function(){return m({animator:new o.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new o.visuals.DonutChartWebBehavior})}:void 0);case o.visuals.plugins.funnel.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.funnel,(function(){return new o.visuals.FunnelChart({animator:new o.visuals.WebFunnelAnimator,behavior:new o.visuals.FunnelWebBehavior,tooltipsEnabled:!0})}),a,f?function(){return f({animator:new o.visuals.WebFunnelAnimator,behavior:new o.visuals.FunnelWebBehavior,tooltipsEnabled:!0})}:void 0);case o.visuals.plugins.gauge.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.gauge,(function(e){return e.module.createGauge({animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,behavior:new o.visuals.GaugeBehavior},a)}),a,g?function(){return g({animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,behavior:new o.visuals.GaugeBehavior})}:void 0);case o.visuals.plugins.kpi.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.kpi,(function(){return new o.visuals.KPIStatusWithHistory({interactivityEnabled:!0},a)}),a,P?function(){return P({interactivityEnabled:!0})}:void 0);case o.visuals.plugins.hundredPercentStackedBarChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.hundredPercentStackedBarChart,(function(e){e=e.module;return e.createCartesianChart({chartType:7,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:7,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=I,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.hundredPercentStackedColumnChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.hundredPercentStackedColumnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:8,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:8,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=I,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.lineChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.lineChart,(function(e){e=e.module;return e.createCartesianChart({chartType:0,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:0,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator},i=I,[4,o.visuals.createLineChartWebBehaviorFactory()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.areaChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.areaChart,(function(e){e=e.module;return e.createCartesianChart({chartType:1,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:1,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator},i=I,[4,L()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.stackedAreaChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.stackedAreaChart,(function(e){e=e.module;return e.createCartesianChart({chartType:2,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:2,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator},i=I,[4,L()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.lineClusteredColumnComboChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.lineClusteredColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:14,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t=D,n={chartType:14,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=I,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return r=[e.sent()],[4,o.visuals.createLineChartWebBehaviorFactory()];case 3:return[4,i.apply(void 0,[r.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.lineStackedColumnComboChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.lineStackedColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:15,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t=D,n={chartType:15,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=I,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return r=[e.sent()],[4,o.visuals.createLineChartWebBehaviorFactory()];case 3:return[4,i.apply(void 0,[r.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.multiRowCard.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.multiRowCard,(function(){return new o.visuals.MultiRowCard({interactivityEnabled:!0,behavior:new o.visuals.MultiRowCardBehavior})}),a,y?function(){return y({interactivityEnabled:!0,behavior:new o.visuals.MultiRowCardBehavior})}:void 0);case o.visuals.plugins.pieChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.pieChart,(function(){return new o.visuals.DonutChart({sliceWidthRatio:0,animator:new o.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new o.visuals.DonutChartWebBehavior})}),a,m?function(){return m({sliceWidthRatio:0,animator:new o.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new o.visuals.DonutChartWebBehavior})}:void 0);case o.visuals.plugins.ribbonChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.ribbonChart,(function(e){e=e.module;return e.createCartesianChart({chartType:9,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:9,isScrollable:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=I,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.scatterChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.scatterChart,(function(e){e=e.module;return e.createCartesianChart({chartType:10,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createScatterChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:10,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator},i=I,[4,X()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.treemap.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.treemap,(function(e){e=e.module;return new e.Treemap({animator:e.webAnimator(),isScrollable:!0,behavior:e.webBehavior(),tooltipsEnabled:!0,cartesianConditionalFormatting:a.cartesianConditionalFormatting,dataPointLassoSelect:!0})}),a,E?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=E,i={},[4,U()];case 1:return i.animator=e.sent(),i.isScrollable=!0,[4,z()];case 2:return[2,t.apply(void 0,[(i.behavior=e.sent(),i.tooltipsEnabled=!0,i.cartesianConditionalFormatting=a.cartesianConditionalFormatting,i.dataPointLassoSelect=!0,i)])]}}))}))}:void 0);case o.visuals.plugins.filterSlicer.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.filterSlicer,(function(){return new o.visuals.Slicer({lockKeyboardNavigation:!1,featureSwitches:a})}),a,V?function(){return V({lockKeyboardNavigation:!1,featureSwitches:a})}:void 0);case o.visuals.plugins.accessibleTable.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.accessibleTable,(function(e){return new e.module.AccessibleTable}),a,d?function(){return d()}:void 0);case o.visuals.plugins.sunburst.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.sunburst,(function(e){e=e.module;return new e.Sunburst({isScrollable:!0,behavior:e.behavior()})}),a,T?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=T,i={isScrollable:!0},[4,W()];case 1:return[2,t.apply(void 0,[(i.behavior=e.sent(),i)])]}}))}))}:void 0);case o.visuals.plugins.waterfallChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.waterfallChart,(function(e){e=e.module;return e.createCartesianChart({chartType:13,isScrollable:!0,tooltipsEnabled:!0,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createWaterfallChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:13,isScrollable:!0,tooltipsEnabled:!0},i=I,[4,H()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.map.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.map,(function(){return new o.visuals.Map({behavior:new o.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,C?function(){return C({behavior:new o.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}:void 0);case o.visuals.plugins.filledMap.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.filledMap,(function(){return new o.visuals.Map({filledMap:!0,behavior:new o.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,filledMapDataLabelsEnabled:a&&a.filledMapDataLabelsEnabled,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,C?function(){return C({filledMap:!0,behavior:new o.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,filledMapDataLabelsEnabled:a&&a.filledMapDataLabelsEnabled,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}:void 0);case o.visuals.plugins.azureMap.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.azureMap,(function(e){e=e.module;return e.createAzureMap({behavior:e.createAzureMapBehavior(),tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,S?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=S,i={},[4,G()];case 1:return[2,t.apply(void 0,[(i.behavior=e.sent(),i.tooltipsEnabled=!0,i.isLegendScrollable=!0,i.mapControlFactory=this.mapControlFactory,i)])]}}))}))}:void 0);case o.visuals.plugins.shape.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.shape,(function(e){return e.module.createShape()}),a,A?function(){return A()}:void 0);case o.visuals.plugins.actionButton.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.actionButton,(function(e){return new e.module.ActionButton}),a,l?function(){return l()}:void 0);case o.visuals.plugins.shapeMap.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.shapeMap,(function(e){e=e.module;return new e.ShapeMap({behavior:new e.ShapeMapBehavior,tooltipsEnabled:!0})}),a,b?function(){return b({behavior:j(),tooltipsEnabled:!0})}:void 0);case o.visuals.plugins.slicer.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.slicer,(function(){return new o.visuals.Slicer({featureSwitches:a,preventVirtualKeyboardOnTheFirstTap:!0,isSlicer:!0})}),a,V?function(){return V({featureSwitches:a,preventVirtualKeyboardOnTheFirstTap:!0,isSlicer:!0})}:void 0);case o.visuals.plugins.matrix.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.matrix,(function(){return new o.visuals.Matrix({})}),a,p?function(){return p()}:void 0);case o.visuals.plugins.table.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.table,(function(){return new o.visuals.Table({})}),a,h?function(){return h()}:void 0);case o.visuals.plugins.pivotTable.name:var i=n.createDefaultConstructorOptions();return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.pivotTable,(function(){return new o.visuals.PivotTable(i,a)}),a,u?function(){return u(i,a)}:void 0);case o.visuals.plugins.tableEx.name:var r=k.createDefaultConstructorOptions();return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.tableEx,(function(){return new o.visuals.TableEx(r,a)}),a,c?function(){return c(r,a)}:void 0);case o.visuals.plugins.scriptVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.scriptVisual,(function(e){return new e.module.ScriptVisual}),a,w?function(){return w()}:void 0);case o.visuals.plugins.pythonVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.pythonVisual,(function(e){return new e.module.ScriptVisual}),a,w?function(){return w()}:void 0);case o.visuals.plugins.debugVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.debugVisual,(function(){return new o.visuals.system.DebugVisual(t.visualSandbox)}),a,void 0);case o.visuals.plugins.textbox.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.textbox,(function(e){return e.module.createTextbox({supportsNarrativeExpressions:a.daxTransformEnabled,supportsFormattingChangeIndication:a.mobileAuthoringFormattingUI})}),a,x?function(){return x({supportsNarrativeExpressions:a.daxTransformEnabled,supportsFormattingChangeIndication:a.mobileAuthoringFormattingUI})}:void 0);case o.visuals.plugins.keyDriversVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.keyDriversVisual,(function(e){return e.module.createAnalysisVisual()}),a,void 0);case o.visuals.plugins.decompositionTreeVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.decompositionTreeVisual,(function(e){return new e.module.DecompositionTree}),a,F?function(){return F()}:void 0);case o.visuals.plugins.qnaVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.qnaVisual,(function(e){return e.module.createQnaVisual()}),a,void 0);case o.visuals.plugins.histogram.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.histogram,(function(e){e=e.module;return e.createCartesianChart({chartType:19,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:19,isScrollable:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=I,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);default:return o.Prototype.inherit(o.visuals.plugins[e])}},R=i,e.ExplorationVisualPluginProvider=R})(powerbi=powerbi||{}),(function(d){d.visualSyncServiceModuleFactory=function(){var e=d.data,t=(i=d.explore).contracts,b=e.DataViewObjectDefinitions,E=e.DataViewObjectDescriptors.findFilterOutput,V=i.services.ExplorationState,o=e.SemanticFilter,s=e.SQExpr,i=e.SQExprRewriter,x=(t.VisualContainer,d.explore.util.VisualContainerUtils),u=(r.prototype.generateUniqueGroupName=function(e,t,i){var r=this.getVisualSyncField(t),n=r?this.displayNameService.getDisplayName(r,e,this.visualPlugin.capabilities(t.visualType)):"Group";_.isEmpty(n);for(var a=n,o=1;a in i;)a=n+o++;return a},r.prototype.syncFilterState=function(C,S){return __awaiter(this,void 0,d.Promise,(function(){var t,i,r,n,a,o,s,l,u,c,p,h,d,v,g,m,y,f;return __generator(this,(function(e){switch(e.label){case 0:return(t=C.config.singleVisual,this.canSyncVisual(t))?t.syncGroup?(i=this.getOtherSectionsInSyncGroup(t),_.isEmpty(i)?[2]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())]):[2]:[2];case 1:for(r=e.sent(),n=this.explorationStateManager.captureFilterState(t),S=S&&t.syncGroup.filterChanges,a=this.visualPlugin.capabilities(t.visualType),o={clearUnmatchedData:!1,suppressActiveSection:!0,suppressDisplay:!0,targetVisualNames:[]},s=E(a.objects),l=s&&b.getValue(n.objects.merge,s,null),u=[],c=0,p=i;c<p.length;c++)for(h=p[c],x.clearSectionQueryCaches(h.section),d=0,v=h.visualContainers;d<v.length;d++){if(g=v[d],m=S&&this.syncFilters(g,C.filters),y=n,l){if(f=b.getValue(g.config.singleVisual.objects,s,null),f=this.replaceSemanticFilterField(C.config.singleVisual.query.defn,l,g.config.singleVisual.query.defn,f,r),l&&!f){m&&this.visualAuthoringOperations.notifyVisualContainers([g]);continue}f!==l&&((y=V.cloneSingleVisual(y,this.visualPlugin,this.featureSwitchService)).cachedFilterDisplayItems=void 0,y.filterExpressionMetadata=void 0,b.setValue(y.objects.merge,s,null,f))}o.targetVisualNames.push(g.name),u.push({visual:g,state:y,impacted:m})}return _.isEmpty(u)||this.explorationStateManager.applyFilterState(u,r,o),[2]}}))}))},r.prototype.syncVisualFiltersState=function(e,t){void 0===t&&(t=!0),e.config;var i=e.config.singleVisual,r=[];if(this.canSyncVisual(i)&&i.syncGroup.filterChanges){for(var n=0,a=this.getOtherSectionsInSyncGroup(i);n<a.length;n++){var o=a[n];if(!_.isEmpty(o.visualContainers))for(var s=0,l=o.visualContainers;s<l.length;s++){var u=l[s];this.syncFilters(u,e.filters)&&r.push(u)}}t&&this.visualAuthoringOperations.notifyVisualContainers(r)}},r.prototype.syncFilters=function(e,t){var i=_.isEmpty(t);if(e.config.singleVisual.syncGroup.filterChanges){if(i&&!_.isEmpty(e.filters))return e.filters=[],!0;if(!i)return i=this.explorationSerializer.deserializeFilterCollection(this.explorationSerializer.serializeFilterCollection(t),[],!0),e.filters=i,!0}return!1},r.prototype.getVisualsAffectByFieldChanges=function(e){e=e.config.singleVisual;return this.canSyncVisual(e)&&e.syncGroup.fieldChanges?_.filter(this.getOtherVisualsInSyncGroup(e),(function(e){return e.config.singleVisual.syncGroup.fieldChanges})):[]},r.prototype.canSyncVisual=function(e){if(!e.syncGroup)return!1;e=this.visualPlugin.capabilities(e.visualType),e=e&&e.supportsSynchronizingFilterState;return e},r.prototype.getOtherVisualsInSyncGroup=function(e){return this.getVisualsInSectionsSyncGroup(this.getOtherSectionsInSyncGroup(e))},r.prototype.getVisualsInSectionsSyncGroup=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];t.push.apply(t,n.visualContainers||[])}return t},r.prototype.getOtherSectionsInSyncGroup=function(t){if(!t.syncGroup)return[];if(!t.syncGroup.groupName)return[];for(var e=[],i=0,r=this.explorationNavigation.getCurrentExploration().sections;i<r.length;i++){var n=r[i],a=_.filter(n.visualContainers,(function(e){e=e.config.singleVisual;return e!==t&&e.syncGroup&&e.syncGroup.groupName===t.syncGroup.groupName&&e.visualType===t.visualType}));_.isEmpty(a)||e.push({section:n,visualContainers:a})}return e},r.prototype.getVisualSyncField=function(e){e=e.query.defn.select();return 0===e.length?null:e[0].expr},r.prototype.replaceSemanticFilterField=function(e,t,i,r,n){if(!t)return t;e=e.select(),i=i.select();if(e.length===i.length){if(1<e.length)return _.differenceWith(e,i,(function(e,t){return s.equals(e.expr,t.expr)})).length?void 0:t;if(1===e.length){if(s.equals(e[0].expr,i[0].expr))return t;e=l.extract(t);if(e){if(!r){var a=t.conditions();if(1!==a.length)return;i=i[0].expr.getKeyColumns(n);if(1!==i.length)return;n=p.replaceCondition(a[0],e,i[0]);return o.fromSQExpr(n)}a=l.extract(r);if(a)return p.replace(t,e,a)}}}},r);function r(e,t,i,r,n,a,o,s,l){this.explorationStateManager=e,this.explorationNavigation=t,this.explorationSerializer=i,this.featureSwitchService=r,this.visualPlugin=n,this.conceptualSchemaProxy=a,this.dataSources=o,this.displayNameService=s,this.visualAuthoringOperations=l}__extends(a,n=i),a.extract=function(e){var t=new a;return e.rewrite(t),t.foundSingleField&&t.fieldExpr},a.prototype.visitHierarchyLevel=function(e){return this.setFieldExpr(e),e},a.prototype.visitColumnRef=function(e){return this.setFieldExpr(e),e},a.prototype.setFieldExpr=function(e){if(!this.fieldExpr)return this.fieldExpr=e,void(this.foundSingleField=!0);s.equals(this.fieldExpr,e)||(this.foundSingleField=!1)};var n,l=a;function a(){return n.call(this)||this}c=e.SQExprRewriter,__extends(h,c),h.replace=function(e,t,i){if(s.equals(t,i))return e;t=new h(t,i);return e.rewrite(t)},h.replaceCondition=function(e,t,i){if(s.equals(t,i))return e;t=new h(t,i);return e.accept(t)},h.prototype.visitColumnRef=function(e){if(s.equals(e,this.before))return this.after};var c,p=h;function h(e,t){var i=c.call(this)||this;return i.before=e,i.after=t,i}return{create:function(e,t,i,r,n,a,o,s,l){return new u(e,t,i,r,n,a,o,s,l)}}}})(powerbi=powerbi||{}),(function(c){var p,s,e,l,u,h,n;function d(i,r){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=i.get())?[4,r.get(t)]:[2];case 1:return[2,e.sent()]}}))}))}function v(e,t,i,r,n){void 0===n&&(n=!0),_.isEmpty(e)||(i=i.get(),r.addConfigToCategoricalFilters(e,t,i,n))}function g(t,e){var i=e.getCurrentExploration(),e=e.getCurrentSection();e&&(i=p.PodUtils.findPodForSectionName(i,e.name))&&!_.isEmpty(i.parameters)&&(e=_.find(i.parameters,(function(e){return e.boundFilter===t.contract.name})))&&t.updateIsLinkedAsAggregation(!!e.asAggregation)}function m(e,t){return 0===e?0:1!==e||t?1===e?2:2===e?3:-1:1}p=c.explore||(c.explore={}),s=p.util||(p.util={}),l=c.explore.services.events,u=c.explore.util.ScriptVisualsUtil,h=p.services.selectionUtils,n=jsCommon.StringExtensions,(e=s.FilterPaneUtil||(s.FilterPaneUtil={})).onFilterContainerChanged=function(t,e,i,r,n,a){var o;2===t.scope.scopeType&&s.VisualContainerUtils.clearExplorationQueryCaches(i),1===t.changeType||2===t.changeType&&!(function(e,t){for(var i=0,r=t;i<r.length;i++)if(r[i].contract===e)return 1;return})(t.filter,e)?(i=s.VisualContainerUtils.getVisualCapabilities(a,r.visualPlugin),g(i=p.viewModels.FilterViewModelFactory.convertFilterContainer(t.filter,n,r.displayNameService,t.scope,r.visualPlugin,r.aggrOps,r.localizationService,i,a&&a.config.singleVisual),r.explorationNavigation),0===t.scope.scopeType&&t.scope.container!==a||(e.push(i),v(e,n,r.dataSources,r.visualAuthoring))):0===t.changeType&&_.remove(e,(function(e){return e.contract===t.filter})),a=t,n=(i=r).explorationNavigation,e=n.getCurrentExploration(),n=n.getCurrentSection(),r=a.scope.scopeType,o=h.getSelectedVisual(i.selection),r=u.getScriptVisualIds(r,e,n,o,i.scriptVisuals),_.isEmpty(r)||(e=a.changeType.toString(),n=a.parentActivity&&a.parentActivity.event,i.telemetryService.logChildEvent(n,c.telemetry.EXFilterScriptVisual,{action:e,visualIds:JSON.stringify(r)}))},e.getFilterDisplayName=function(e,t,i,r,n,a,o,s,l){return e.displayName||p.viewModels.FilterViewModelFactory.convertFilterContainer(e,i,n,t,o,r,a,s,l).displayName},e.getPageScopeFilters=function(l,u){return __awaiter(this,void 0,c.Promise,(function(){var a,o,s;return __generator(this,(function(e){switch(e.label){case 0:return(a=l.explorationNavigation.getCurrentSection(),o=[],a)?[4,d(l.dataSources,l.conceptualSchemaProxy)]:[2,o];case 1:s=e.sent(),v(o=p.viewModels.ViewModelFactory.createFilters({scopeType:1,container:a},s,l.displayNameService,l.visualPlugin,l.aggrOps,l.localizationService,null,u),s,l.dataSources,l.visualAuthoring,!1);var t=o,i=l.explorationNavigation;if(!_.isEmpty(t))for(var r=0,n=t;r<n.length;r++)g(n[r],i);return[2,o]}}))}))},e.getConceptualSchema=d,e.addConfigToFilters=v,e.setDrillthroughMetadata=g,e.addFilterToScopeFromDrop=function(r,n,a,o,s,l,u){return __awaiter(this,void 0,c.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return s?(t={scopeType:r,container:n},i=o.get(),a?[4,l.addDrillthroughFilter(s,t,i)]:[3,2]):[2];case 1:return[2,e.sent()];case 2:return[4,l.addFilter(s,t,i,u)];case 3:return[2,e.sent()]}}))}))},e.removeFilter=function(t,e,i,r,n,a){var o=_.find(i.filters,(function(e){return e.name===t}));return!!o&&r.removeFilter(o,{scopeType:e,container:i},n,a)},e.updateCategoricalFiltersIfNeeded=function(e,t,i,r){if(!_.isEmpty(i)&&(10===r.changeType||1===r.changeType||2===r.changeType||0===r.changeType))for(var n=m(r.scope.scopeType,5===r.filter.howCreated),a=0,o=i;a<o.length;a++){var s=o[a];n<m(t,5===s.howCreated)||p.FilterUtils.isCategoricalFilter(s.contract.type)&&s.contract!==r.filter&&(s={filter:s.contract,changeType:4,scope:s.getFilterContainerScope(),parentActivity:r.parentActivity},e.eventBridge.publishToChannel(l.filterContainerChanged,s))}},e.shouldHideFilterBySearchInput=function(e,t,i){var r;return!(!t||/^\s*$/.test(t))&&(r=e.contract.displayName||e.displayName,_.isEmpty(r)&&(r=e.getRestatement()),!n.containsIgnoreCase(r,t))}})(powerbi=powerbi||{}),(function(S){var e,b;e=S.explore||(S.explore={}),((b=e.viewModels||(e.viewModels={})).FieldListViewModelDisplayFolderMerger||(b.FieldListViewModelDisplayFolderMerger={})).mergeDisplayFolders=function(e,i,t,r){var n=new b.FieldListViewModelMerger.VmListMerger(e.displayFolders),a=_.keyBy(e.displayFolders,(function(e){return e.name}));if(!_.isEmpty(t))for(var o=0,s=t;o<s.length;o++)for(var l=function(t){var e=i.indexOf(i.filter((function(e){return e.name===t.name}))[0]);0<=e?i[e]=(function i(r,e){if(e){for(var t=0,n=e.properties;t<n.length;t++){var a=n[t];r.properties.push(a)}for(var o=0,s=e.hierarchies;o<s.length;o++){var l=s[o];r.hierarchies.push(l)}for(var u=function(t){var e=r.displayFolders.indexOf(r.displayFolders.filter((function(e){return e.name===t.name}))[0]);0<=e?r.displayFolders[e]=i(r.displayFolders[e],t):r.displayFolders.push(t)},c=0,p=e.displayFolders;c<p.length;c++){var h=p[c];u(h)}}return r})(i[e],t):i=i.concat(t)},u=0,c=s[o].entity.displayFolders;u<c.length;u++)l(c[u]);if(!_.isEmpty(i))for(var p=0,h=i;p<h.length;p++){var d=h[p];n.add(function e(t,i,r,n,a){var o=n[r.name];if(o){o.contract=r;var s=new b.FieldListViewModelMerger.VmListMerger(o.children);if(r.properties)for(var n=_.filter(o.children,(function(e){return 1!==e.fieldType&&2!==e.fieldType})),l=_.keyBy(n,(function(e){return e.name})),u=0,c=r.properties;u<c.length;u++){var p=c[u],h=l[p.name];h||(p=_.head(t.findFields(p.name,o.schemaName))||_.head(t.findFields(p.name,S.explore.constants.ExplorationSchemaName))||_.head(t.findKpis(p.name,o.schemaName)),(h=p.clone()).parent=o),s.add(h)}if(r.hierarchies)for(var n=_.filter(o.children,(function(e){return 2===e.fieldType})),l=_.keyBy(n,(function(e){return e.name})),d=0,v=r.hierarchies;d<v.length;d++){var g=v[d],m=l[g.name];m||(g=_.head(t.findHierarchies(g.name,o.schemaName)),(m=g.clone()).parent=o),s.add(m)}if(r.displayFolders)for(var n=_.filter(o.children,(function(e){return 1===e.fieldType})),l=_.keyBy(n,(function(e){return e.name})),y=0,f=r.displayFolders;y<f.length;y++){var C=f[y];s.add(e(t,o,C,l,a))}o.children=s.merge();n=new b.FieldListViewModelMerger.VmAlphabeticalSorter;n.sortProperties(o.children)}else o=a.convertConceptualDisplayFolder(r,t.contractSchema,i,t);return o}(e,void 0,d,a,r))}e.displayFolders=n.merge(),(t=e.properties).push.apply(t,e.displayFolders||[])}})(powerbi=powerbi||{}),(function(e){var V,s,l,x,w;function t(e,t,i,r,n,a){this.factory=e,this.sorter=t,this.disableEditing=i,this.disableDragging=r,this.disableSelectionOnFocus=n,this.schemaChanges=a?a.changes:[]}function i(){}function r(e,t){this.vmLookup=this.getPropertiesDictionary(e),this.renames=this.getRenamesDictionary(e,t)}function n(e){this.oldItems=e,this.newItems=[]}e=e.explore||(e.explore={}),(e=(V=e.viewModels||(e.viewModels={})).FieldListViewModelMerger||(V.FieldListViewModelMerger={})).mergeModel=function(e,t,i,r,n,a,o){return new s(i,new l,n,a,o,r).mergeFieldList(e,t)},t.prototype.mergeFieldList=function(e,t){return e&&t||(e={schema:void 0,isLoaded:!1}),t&&_.some(t.schemas)&&(e.schema=this.mergeSchemas(e,t),e.isLoaded=!0),e},t.prototype.mergeSchemas=function(e,t){var i=e.schema;if(i){for(var r=V.FieldListViewModelUtils.getExtensions(t.schemas),e=V.FieldListViewModelUtils.sortExtensionSchemasAtEnd(t.schemas),n=(i.contract=_.find(e,(function(e){return!V.FieldListViewModelUtils.isExtension(e)})),new w(i.entities)),a=0,o=e;a<o.length;a++)for(var s=o[a],l=0,u=s.entities;l<u.length;l++){var c=u[l];V.FieldListViewModelUtils.isExtension(c)&&!V.FieldListViewModelUtils.isAbandoned(c)||(c=this.mergeEntity(i,s,c,r),s===i.contract&&n.add.apply(n,c||[]))}i.entities=n.merge(),this.sorter.sortEntities(i.entities)}else i=this.factory.createModel(t,this.disableEditing,this.disableDragging,this.disableSelectionOnFocus);return i},t.prototype.mergeEntity=function(e,t,i,r){var n=this.findEntityVm(e,i);if(n){n.contract=i,n.contractSchema=t;var a=new w(n.properties),o=new w(n.columnsAndMeasures),s=new w(n.hierarchies),l=new x(n,this.schemaChanges);if(!V.FieldListViewModelUtils.isExtension(i))for(var u=0,c=i.properties;u<c.length;u++){var p=c[u],h=this.mergePropertyMeasureOrKpi(n,t,p,l);a.add.apply(a,h||[]),o.add.apply(o,h||[])}for(var d=0,v=i.hierarchies;d<v.length;d++){var g=v[d],g=this.mergeHierarchy(n,t,g,l);a.add.apply(a,g||[]),s.add.apply(s,g||[])}var m=r.entities[V.FieldListViewModelUtils.getExtensionKey(t.name,i.name)];if(m)for(var y=0,f=m;y<f.length;y++)for(var C=f[y],S=0,b=C.entity.properties;S<b.length;S++){var p=b[S],E=this.mergeExtensionMeasure(n,C.schema,p,l);a.add.apply(a,E||[]),o.add.apply(o,E||[])}n.columnsAndMeasures=o.merge((function(e){return!e.parent})),n.hierarchies=s.merge((function(e){return!e.parent})),n.properties=a.merge((function(e){return!e.parent})),V.FieldListViewModelDisplayFolderMerger.mergeDisplayFolders(n,i.displayFolders,m,this.factory),this.sorter.sortProperties(n.properties),V.FieldListViewModelUtils.removeDuplicateProperties(n.properties,n.displayFolders),V.FieldListViewModelUtils.flattenFolders(n),V.FieldListViewModelUtils.updatePropertiesWithChildren(n)}else n=this.factory.convertConceptualEntity(i,t,e,r);return[n]},t.prototype.findEntityVm=function(e,t){var i=t.name,r=_.find(this.schemaChanges,(function(e){return e.entityRename&&e.entityRename.after===t.name})),r=(r&&(i=r.entityRename.before),e.findEntity(i));return r&&V.FieldListViewModelUtils.isAbandoned(r.contract)!==V.FieldListViewModelUtils.isAbandoned(t)?null:r},t.prototype.mergePropertyMeasureOrKpi=function(e,t,i,r){if(!V.FieldListViewModelUtils.isExtension(i))return(n=i).measure&&n.measure.kpi?this.mergeKpi(e,t,i,r):i.kpiValue?void 0:this.mergeProperty(e,t,i,r);var n},t.prototype.mergeProperty=function(e,t,i,r){r=r.findVms(t.name,i.name,0),r=_.filter(r,(function(e){return!e.isExtension}));if(_.isEmpty(r))r=[this.factory.convertConceptualProperty(i,t,e)];else for(var n=0,a=r;n<a.length;n++){for(var o=a[n],s=(o.contract=i,o.schema=t,new w(o.children)),l=0,u=V.FieldListViewModelUtils.getPropertyVariations(i);l<u.length;l++){var c=u[l];s.add(this.mergeVariationHierarchy(o,t,c))}o.children=s.merge()}return r},t.prototype.mergeVariationHierarchy=function(e,t,i){var r=_.find(e.children,(function(e){return e instanceof V.FieldListConceptualHierarchy&&e.variation===i.name}));return r?this.updateHierarchyVm(e.entity,r,i.defaultHierarchy,t):r=this.factory.convertConceptualVariationHierarchy(i,t,e),r},t.prototype.mergeExtensionMeasure=function(e,t,i,r){r=r.findVms(t.name,i.name,0),r=_.filter(r,(function(e){return e.isExtension}));return _.isEmpty(r)?r=[this.factory.convertConceptualExtensionMeasure(i,t,e)]:_.forEach(r,(function(e){e.contract=i,e.schema=t})),r},t.prototype.mergeKpi=function(e,t,i,r){r=r.findVms(t.name,i.name,4);if(_.isEmpty(r))r=[this.factory.convertConceptualKpi(i,t,e)];else for(var n=0,a=r;n<a.length;n++){var o=a[n],s=(o.contract=i,o.schema=t,new w(o.kpiMeasures));s.add(this.mergeKpiMeasure(t,o,i,2)),i.measure.kpi.goal&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.goal,1)),i.measure.kpi.status&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.status,0)),i.measure.kpi.trend&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.trend,3)),_.some(s,(function(e){return null===e}))?o.kpiMeasures=this.factory.convertConceptualKpi(i,t,e).kpiMeasures:o.kpiMeasures=s.merge()}return r},t.prototype.mergeKpiMeasure=function(e,t,i,r){t=_.find(t.kpiMeasures,(function(e){return e.kpiType===r}));return t?(t.contract=i,t.schema=e,t):null},t.prototype.mergeHierarchy=function(t,e,i,r){r=r.findVms(e.name,i.name,2);if(_.isEmpty(r)){var n=this.factory.convertConceptualHierarchy(i,e,t);_.some(this.schemaChanges,(function(e){return e.hierarchyCreate&&e.hierarchyCreate.entity===t.name&&e.hierarchyCreate.name===n.name}))&&(n.expanded=!0),r=[n]}else for(var a=0,o=r;a<o.length;a++){var s=o[a];this.updateHierarchyVm(t,s,i,e)}return r},t.prototype.updateHierarchyVm=function(e,t,i,r){t.contract=i,t.schema=r;for(var n=_.keyBy(t.hierarchyLevels,(function(e){return e.name})),a=new w(t.hierarchyLevels),o=0,s=i.levels;o<s.length;o++){var l=s[o],l=this.mergeHierarchyLevel(e,t,r,l,n);a.add(l)}t.hierarchyLevels=a.merge()},t.prototype.mergeHierarchyLevel=function(e,t,i,r,n){e=this.findHierarchyLevel(e,t,i,r,n);return e?(e.contract=r.column,e.hierarchyLevelContract=r,e.schema=i):e=this.factory.convertConceptualHierarchyLevel(r,i,t),e},t.prototype.findHierarchyLevel=function(t,i,e,r,n){var a=r.name,r=_.find(this.schemaChanges,(function(e){return e.hierarchyLevelRename&&e.hierarchyLevelRename.entity===t.contract.name&&e.hierarchyLevelRename.hierarchy===i.contract.name&&e.hierarchyLevelRename.after===a}));return n[a=r?r.hierarchyLevelRename.before:a]},s=t,i.prototype.sortEntities=function(e){},i.prototype.sortProperties=function(e){e&&e.sort((function(e,t){return V.FieldListViewModelUtils.compareAlphabeticallyIgnoreCase(e.displayName,t.displayName)}))},l=i,e.VmAlphabeticalSorter=l,r.prototype.findVms=function(e,t,i){e=this.getKey(e,t,i),t=this.renames[e]||e;return this.vmLookup[t]},r.prototype.getPropertiesDictionary=function(e){for(var t=this,i=_.clone(e.properties),r=0,n=e.columnsAndMeasures;r<n.length;r++){var a=n[r];i.push(a)}for(var o=0,s=e.hierarchies;o<s.length;o++){var l=s[o];i.push(l)}for(var u=0,c=e.displayFolders;u<c.length;u++){var p=c[u];i.push(p),i.push.apply(i,p.getAllChildren()||[])}i=_.uniq(i);return _.groupBy(i,(function(e){return t.getVmKey(e)}))},r.prototype.getRenamesDictionary=function(t,e){for(var i={},r=0,n=_.filter(e,(function(e){return e.propertyRename&&e.propertyRename.entity===t.name}));r<n.length;r++){var a=n[r],o=this.getFieldType(a.propertyRename.objectType),s=this.getKey(a.propertyRename.schema,a.propertyRename.before,o);i[this.getKey(a.propertyRename.schema,a.propertyRename.after,o)]=s}return i},r.prototype.getVmKey=function(e){return this.getKey(e.schemaName,e.name,e.fieldType)},r.prototype.getKey=function(e,t,i){return t+":"+i+(e?"|"+e:"")},r.prototype.getFieldType=function(e){switch(e){default:return 0;case"KPI":return 4;case"Hierarchy":return 2;case"Level":return 3}},x=r,n.prototype.add=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return!!t&&(t=_.filter(t,(function(e){return!!e})),(e=this.newItems).push.apply(e,t||[]),!0)},n.prototype.merge=function(e){e&&(this.newItems=_.filter(this.newItems,e));e=this.oldItems;return e?e.splice.apply(e,__spreadArray([0,e.length],this.newItems||[])):_.isEmpty(this.newItems)||(e=this.newItems),e},w=n,e.VmListMerger=w})(powerbi=powerbi||{}),(function(i){var s;(function(e){var a=i.common.utils.ColorUtility,o=i.explore.util.VisualDropShadowUtil;function t(e){e&&(this.visible=e.show,this.position=e.position,this.color=e.color.solid.color,this.preset=e.preset,this.transparency=e.transparency,this.shadowSpread=e.shadowSpread,this.shadowBlur=e.shadowBlur,this.angle=e.angle,this.shadowDistance=e.shadowDistance)}t.prototype.getBoxShadow=function(){if(this.visible){if(this.preset!==s.contracts.VisualDropShadow.CustomPreset){var e=o.getPresetSettings(this.preset,this.position);if(e)for(var t in e)this[t]=e[t]}var i=this.position===s.contracts.VisualDropShadow.InnerPosition?"inset ":"",r=a.convertTransparencyToOpacity(this.transparency),n=Math.PI/180*this.angle;return i+Math.cos(n)*this.shadowDistance+"px "+Math.sin(n)*this.shadowDistance+"px "+this.shadowBlur+"px "+this.shadowSpread+"px "+a.hexToRGBString(this.color,r)}return""},e.VisualDropShadow=t})((s=i.explore||(i.explore={})).viewModels||(s.viewModels={}))})(powerbi=powerbi||{});
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] = {});
marker.endEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
