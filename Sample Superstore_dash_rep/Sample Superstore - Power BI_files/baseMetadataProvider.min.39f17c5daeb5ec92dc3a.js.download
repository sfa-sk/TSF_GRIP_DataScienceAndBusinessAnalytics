var powerbi,__awaiter=this&&this.__awaiter||function(e,i,s,d){return new(s=s||Promise)(function(n,t){function a(e){try{o(d.next(e))}catch(e){t(e)}}function r(e){try{o(d.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,r)}o((d=d.apply(e,i||[])).next())})},__generator=this&&this.__generator||function(a,r){var o,i,s,d={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(o)throw new TypeError("Generator is already executing.");for(;d;)try{if(o=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return d.label++,{value:t[1],done:!1};case 5:d.label++,i=t[1],t=[0];continue;case 7:t=d.ops.pop(),d.trys.pop();continue;default:if(!(s=0<(s=d.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){d=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){d.label=t[1];break}if(6===t[0]&&d.label<s[1]){d.label=s[1],s=t;break}if(s&&d.label<s[2]){d.label=s[2],d.ops.push(t);break}s[2]&&d.ops.pop(),d.trys.pop();continue}t=r.call(a,d)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};function addOrUpdateQueryString(e,t,n){n=parseQueryString(n=void 0===n?window.location.search:n);return n[e]=t,rebuildQueryString(n)}function clearQueryString(e,t){t=parseQueryString(t=void 0===t?window.location.search:t);return delete t[e],rebuildQueryString(t)}function parseQueryString(e){var t={},e=e=void 0===e?window.location.search:e;if(e&&"?"===e.substr(0,1))for(var n=0,a=e.substr(1).split("&");n<a.length;n++){var r=a[n].split("="),o=r[0],r=r.slice(1).join("=");t[decodeURIComponent(o)]=decodeURIComponent(r)}return t}function rebuildQueryString(e){var t,n="",a=!0;for(t in e)a||(n+="&"),n+=encodeURIComponent(t)+"=",e[t]&&(n+=encodeURIComponent(e[t])),a=!1;return n=a?n:"?"+n}function setCookie(e,t,n,a,r){void 0===n&&(n="/"),void 0===a&&(a="none"),r||(r=new Date).setFullYear(r.getFullYear()+1),window&&window.document&&(window.document.cookie=e+" = "+t+";secure;path="+n+";expires="+r.toUTCString()+";samesite="+a)}function startBaseMetadataLogRequest(e,t,n){e={url:e,start:new Date,requestId:t};return window[n].push(e),e}function endBaseMetadataLogRequest(e,t,n,a,r,o,i){e.end=new Date,e.isError=t,e.code=n,e.errorMessage=a,e.parseStart=o,e.parseEnd=i,e.size=r}function getBaseMetadata(t){var n=window;return new Promise(function(e){n.clientAuthEnabled?n.signInPromise.then(function(){window.baseMetadataFromClient?getBaseMetadataInternal(!1,t).then(function(){e(!0)}).catch(function(){e(!0)}):e(!0)}):window.baseMetadataFromClient?getBaseMetadataInternal(!1,t).then(function(){e(!0)}).catch(function(){e(!0)}):e(!0)})}function getBaseMetadataInternal(M,C){return new Promise(function(m,y){var e=window.clusterUri,e=("/"===e.substring(e.length-1)?e:e+"/")+"metadata/bootstrap/base",t=M?window.baseMetadataRetryRequestId:window.baseMetadataRequestId,S=startBaseMetadataLogRequest(e,t,"getBaseMetadataInfo");try{var I=new XMLHttpRequest;I.open("GET",e,!0),I.setRequestHeader("Accept","application/json"),I.setRequestHeader("Authorization","Bearer "+window.powerBIAccessToken),I.setRequestHeader("ActivityId",window.telemetrySessionId),I.setRequestHeader("RequestId",t),I.setRequestHeader("X-PowerBI-Auto-License-Info","AutoLicenseAssignmentSupported"),null!==window.aadConsistencyHeaderScenarioId&&""!==window.aadConsistencyHeaderScenarioId&&I.setRequestHeader("ConsistencyLevel","Organization;ScenarioId="+window.aadConsistencyHeaderScenarioId),null!==powerbi.getQueryStringValue("redirectedFromSignup")&&I.setRequestHeader("X-PowerBI-RedirectedFromSignup","true"),I.onreadystatechange=function(){return __awaiter(this,void 0,void 0,function(){var a,r,o,i,s,d,u,c,w,g,l,f,p,h,b,v=this;return __generator(this,function(e){switch(e.label){case 0:if(e.trys.push([0,10,,11]),I.readyState===XMLHttpRequest.DONE){if(a=I.status,r=I.getAllResponseHeaders(),!(200<=a&&a<300||304===a))return[3,1];c=new Date,l=JSON.parse(I.responseText),w=new Date,window.powerbi,window.featureSwitches=l.clientFeatureSwitches,window.placeExpAssignmentContextOnPage&&(window.expAssignmentContext=l.expAssignmentContext),l&&l.branding&&l.branding.config&&(o=JSON.parse(l.branding.config),i={},Object.keys(o).forEach(function(e){var t=e[0].toLowerCase()+e.substring(1);i[t]=o[e]}),l.branding.config=i),window.placeBrandingInfoOnPage&&(window.brandInfo=l.branding),window.placeAutoLicenseAssignmentStateOnPage&&(g=void 0,!r||-1===r.indexOf("x-powerbi-auto-license-info")&&-1===r.indexOf("X-PowerBI-Auto-License-Info")||(g=I.getResponseHeader("x-powerbi-auto-license-info")),s=!1,g&&g.toLowerCase()==="AutoLicenseAssignmentSucceeded".toLowerCase()&&(t=-1!==C.href.indexOf("/teams"),n=function(e){for(var t=0,n=["iphone","ipad","android"];t<n.length;t++){var a=n[t];if(e.toLowerCase().includes(a))return!0}return!1}(window.navigator.userAgent),t&&n&&(C.href="/TeamsMobileAutoLicense?originalUrl="+encodeURIComponent(C.href)),s=!0),L()&&(L().hasAutoAssignedLicense=s),window.hasAutoAssignedLicense=s),(s=l.userSettings.preferredLanguage)&&0<s.length?(setCookie("PreferredLanguage",s),s.toLowerCase()!==R().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(p=C.origin+C.pathname,h=addOrUpdateQueryString("language",s,C.search),C.href=p+h)):""===s&&(setCookie("PreferredLanguage",s),window.navigator&&window.navigator.language&&window.navigator.language.toLowerCase()!==R().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(p=C.origin+C.pathname,h=addOrUpdateQueryString("language",window.navigator.language,C.search),C.href=p+h)),endBaseMetadataLogRequest(S,!1,a.toString(),void 0,I.responseText.length,c,w),m(l)}return[3,9];case 1:return(d="UserNotLicensed",u=void 0,!r||-1===r.indexOf("x-powerbi-error-info")&&-1===r.indexOf("X-PowerBI-Error-Info")||(u=I.getResponseHeader("x-powerbi-error-info")),0===a&&!u&&window.navigator&&(u="NavigatorOnLineProperty="+window.navigator.onLine),0===a||404===a||408===a||500<=a&&a<600)?M?[3,6]:0!==a?[3,2]:(setTimeout(function(){return __awaiter(v,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,getBaseMetadataInternal(!0,C)];case 1:return t=e.sent(),m(t),[3,3];case 2:return t=e.sent(),y(t),[3,3];case 3:return[2]}})})},1e3),[3,5]):[3,8];case 2:return e.trys.push([2,4,,5]),[4,getBaseMetadataInternal(!0,C)];case 3:return c=e.sent(),m(c),[3,5];case 4:return w=e.sent(),y(w),[3,5];case 5:return[3,7];case 6:endBaseMetadataLogRequest(S,!0,a.toString(),u,void 0,void 0,void 0),y(u),e.label=7;case 7:return[3,9];case 8:u&&u.toLowerCase()===d.toLowerCase()?(endBaseMetadataLogRequest(S,!0,a.toString(),u,void 0,void 0,void 0),g=void 0,(g=!r||-1===r.indexOf("x-powerbi-auto-license-info")&&-1===r.indexOf("X-PowerBI-Auto-License-Info")?g:I.getResponseHeader("x-powerbi-auto-license-info"))&&g.toLowerCase()==="AutoLicenseAssignmentDisabledByTenant".toLowerCase()?C.href="https://aka.ms/pbiAdHocSubscriptionNotAllowed":(l=window.staticPageRedirectInTeams,b=powerbi.getQueryStringValue("route"),f=-1!==C.href.indexOf("/teams/"),h=p=void 0,p=b&&0<b.length?(h=clearQueryString("route",C.search),C.origin+"/"+b):(h=C.search,C.origin+C.pathname),C.href=f&&l?"/StaticTeamsSignUp?originalUrl="+encodeURIComponent(C.href)+"&redirectUrl="+encodeURIComponent(p+h):"/SignupRedirect?ru="+p+h)):endBaseMetadataLogRequest(S,!0,a.toString(),u,void 0,void 0,void 0),y(u),e.label=9;case 9:return[3,11];case 10:return b=e.sent(),S.end||endBaseMetadataLogRequest(S,!0,a.toString(),b.message,void 0,void 0,void 0),y(b.message),[3,11];case 11:return[2]}var t,n})})},I.send()}catch(e){S.end||endBaseMetadataLogRequest(S,!0,"No status code",e.message,void 0,void 0,void 0),y(e.message)}function L(){return function(){var e=n();e.session||(e.session={});return e.session}().userInfo}function R(){return function(){var e=n();e.common||(e.common={});return e.common}().cultureInfo}function n(){return window.powerbi||(window.powerbi={}),window.powerbi}})}(powerbi||(powerbi={})).getQueryStringValue=function(e,t){for(var n=(t=t||window.location.search).substr(1).split("&"),a=0,r=n.length;a<r;++a){var o=n[a].split("=");if(o[0]===e)return decodeURIComponent(o[1])}return null};var baseMetadataWindow=window;baseMetadataWindow.getBaseMetadataInfo=[],baseMetadataWindow.deferBaseMetadataPromise?baseMetadataWindow.getBaseMetadata=getBaseMetadata:baseMetadataWindow.baseMetadataPromise=getBaseMetadata(window.location);