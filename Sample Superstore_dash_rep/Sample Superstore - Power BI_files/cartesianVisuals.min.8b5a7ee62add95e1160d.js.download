"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['cartesianVisuals.min.js'] || (this.parseTimeMarkers['cartesianVisuals.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('cartesianVisuals.min.js');var es6,powerbi,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,o,n,l){return new(n=n||Promise)(function(i,t){function a(e){try{s(l.next(e))}catch(e){t(e)}}function r(e){try{s(l.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,r)}s((l=l.apply(e,o||[])).next())})},__generator=this&&this.__generator||function(a,r){var s,o,n,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(s)throw new TypeError("Generator is already executing.");for(;l;)try{if(s=1,o&&(n=2&t[0]?o.return:t[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,t[1])).done)return n;switch(o=0,(t=n?[2&t[0],n.value]:t)[0]){case 0:case 1:n=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,o=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(n=0<(n=l.trys).length&&n[n.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!n||t[1]>n[0]&&t[1]<n[3])){l.label=t[1];break}if(6===t[0]&&l.label<n[1]){l.label=n[1],n=t;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(t);break}n[2]&&l.ops.pop(),l.trys.pop();continue}t=r.call(a,l)}catch(e){t=[6,e],o=0}finally{s=n=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__spreadArray=this&&this.__spreadArray||function(e,t){for(var i=0,a=t.length,r=e.length;i<a;i++,r++)e[r]=t[i];return e},__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(e){var l;((l=e.visuals||(e.visuals={})).CartesianViewModelAdapterUtils||(l.CartesianViewModelAdapterUtils={})).updatePlotResponsiveWarnings=function(e,t){var i,a=e.warningObjectCollection,r={},s=e.legendData,o=t.legendData;for(i in e.showIcon?(r.legend=new l.LegendNotRenderedWarning,r.categoryAxis=new l.AxisAndAxisLabelsNotRenderedWarning,r.valueAxis=new l.AxisAndAxisLabelsNotRenderedWarning):(s.show!==o.show?r.legend=new l.LegendNotRenderedWarning:s.position!==o.position?r.legend=new l.LegendLocationWarning:_.isEqual(s.fontProperties.size,o.fontProperties.size)||(r.legend=new l.LegendFontSizeWarning),s=e.axesData,o=t.axesData,s.categoryAxis.show!==o.categoryAxis.show?r.categoryAxis=new l.AxisAndAxisLabelsNotRenderedWarning:s.categoryAxis.showAxisTitle!==o.categoryAxis.showAxisTitle?r.categoryAxis=new l.AxisLabelsNotRenderedWarning:_.isEqual(s.categoryAxis.labelFontProperties.size,o.categoryAxis.labelFontProperties.size)&&_.isEqual(s.categoryAxis.titleFontProperties.size,o.categoryAxis.titleFontProperties.size)||(r.categoryAxis=new l.AxisFontSizeWarning),s.valueAxis.show!==o.valueAxis.show?r.valueAxis=new l.AxisAndAxisLabelsNotRenderedWarning:s.valueAxis.showAxisTitle!==o.valueAxis.showAxisTitle?r.valueAxis=new l.AxisLabelsNotRenderedWarning:_.isEqual(s.valueAxis.labelFontProperties.size,o.valueAxis.labelFontProperties.size)&&_.isEqual(s.valueAxis.titleFontProperties.size,o.valueAxis.titleFontProperties.size)||(r.valueAxis=new l.AxisFontSizeWarning),s=e.zoomData,o=t.zoomData,s.showOnCategoryAxis===o.showOnCategoryAxis&&s.showOnValueAxis===o.showOnValueAxis&&s.showOnValueSecAxis===o.showOnValueSecAxis||(r.zoom=new l.ZoomSlidersNotRenderedWarning)),r){var n=r[i];a.addForVisualObject(i,{selector:null,warnings:[n]})}}}(powerbi=powerbi||{}),function(e){var s,o;s=e.visuals||(e.visuals={}),o=s.Units.FontSize,s.cartesianLegacyResponsiveViewportsBreakpoints={legendWidth:76,legendHeight:58,axesTitleWidth:128,axesTitleHeight:58,axesHeight:58,axesMedWidth:128,axesWidth:76,maxWidthForMediumFont:180,maxWidthForSmallFont:128},(s.CartesianLegacyResponsiveApplier||(s.CartesianLegacyResponsiveApplier={})).applyLegacyResponsiveChanges=function(e,t){var i=e,a=(r=t).axesData,i=(i.height<=s.cartesianLegacyResponsiveViewportsBreakpoints.axesTitleHeight&&(a.x.showAxisTitle=!1,a.y.showAxisTitle=!1,a.y2.showAxisTitle=!1),i.width<=s.cartesianLegacyResponsiveViewportsBreakpoints.axesTitleWidth&&(a.y.showAxisTitle=!1,a.y2.showAxisTitle=!1),i.height<=s.cartesianLegacyResponsiveViewportsBreakpoints.axesHeight&&(a.x.show=!1),i.width<=s.cartesianLegacyResponsiveViewportsBreakpoints.axesWidth&&(a.y.show=!1,a.y2.show=!1),i.width<=s.cartesianLegacyResponsiveViewportsBreakpoints.axesMedWidth&&s.Legend.isLeftOrRight(r.legendData.position)&&(a.y.show=!1,a.y2.show=!1),i.width<=s.cartesianLegacyResponsiveViewportsBreakpoints.maxWidthForMediumFont&&(r={x:{tickLabels:s.CartesianChart.xAxisSmallFontSizeInPx,title:s.CartesianChart.xAxisSmallFontSizeInPx},y:{tickLabels:s.CartesianChart.yAxisMediumFontSizeInPx,title:s.CartesianChart.yAxisMediumFontSizeInPx},y2:{tickLabels:s.CartesianChart.yAxisMediumFontSizeInPx,title:s.CartesianChart.yAxisMediumFontSizeInPx}},i.width<=s.cartesianLegacyResponsiveViewportsBreakpoints.maxWidthForSmallFont&&(r.y.tickLabels=s.CartesianChart.yAxisSmallFontSizeInPx,r.y.title=s.CartesianChart.yAxisSmallFontSizeInPx,r.y2.tickLabels=s.CartesianChart.yAxisSmallFontSizeInPx,r.y2.title=s.CartesianChart.yAxisSmallFontSizeInPx),a.x.titleFontProperties=s.FontProperties.inherit(a.x.titleFontProperties,{size:o.createFromPx(r.x.title)}),a.y.titleFontProperties=s.FontProperties.inherit(a.y.titleFontProperties,{size:o.createFromPx(r.y.title)}),a.y2.titleFontProperties=s.FontProperties.inherit(a.y2.titleFontProperties,{size:o.createFromPx(r.y2.title)}),a.x.labelFontProperties=s.FontProperties.inherit(a.x.labelFontProperties,{size:o.createFromPx(r.x.tickLabels)}),a.y.labelFontProperties=s.FontProperties.inherit(a.y.labelFontProperties,{size:o.createFromPx(r.y.tickLabels)}),a.y2.labelFontProperties=s.FontProperties.inherit(a.y2.labelFontProperties,{size:o.createFromPx(r.y2.tickLabels)})),e),r=(a=t).legendData.position,e=i.width<=s.cartesianLegacyResponsiveViewportsBreakpoints.legendWidth&&s.Legend.isLeftOrRight(r),r=i.height<=s.cartesianLegacyResponsiveViewportsBreakpoints.legendHeight&&s.Legend.isTopOrBottom(r);(e||r)&&(a.legendData.show=!1),i.width<=s.cartesianLegacyResponsiveViewportsBreakpoints.maxWidthForMediumFont&&(e=a.legendData.fontProperties.size.pt,r=void 0,r=i.width<=s.cartesianLegacyResponsiveViewportsBreakpoints.maxWidthForSmallFont?Math.min(e,s.Legend.LegendSmallFontSmallViewportInPt):Math.min(e,s.Legend.LegendMediumFontSmallViewportInPt),a.legendData.fontProperties=s.FontProperties.inherit(a.legendData.fontProperties,{size:o.createFromPt(r)}))}}(powerbi=powerbi||{}),function(e){!function(o){function n(e){this.viewport=e.viewport,this.cartesianData=e.cartesianData,this.dataView=e.dataView,this.responsiveFontHelper=new o.ResponsiveCartesianFontHelper}o.cartesianResponsiveBreakpoints={legendPositionWidth:210,legendPositionHeight:100,legendHeight:70,legendWidth:80,xAxesHeight:100,yAxesTitleWidth:210,yAxesWidth:100,xAxesTitleHeight:145,yAxesZoomWidth:280,xAxesZoomHeight:150,iconWidth:50,iconHeight:50},n.prototype.getData=function(){var e=o.ViewModelAdapterUtils.getResponsiveVisualProperties(this.dataView,o.cartesianChartProps),t=e.responsive,e=e.responsiveLegacy,i=this.cartesianData;return i=t||e?this.applyResponsiveChanges(this.viewport,this.cartesianData,t,e):i},n.prototype.enumerateObjectInstances=function(e,t,i){"general"===e.objectName&&this.enumerateGeneral(t,this.dataView,i)},n.prototype.getResponsiveSlice=function(e,t,i){if(t)return t=o.cartesianChartProps.general,e=o.ViewModelAdapterUtils.getResponsiveVisualProperties(e,o.cartesianChartProps),{item:new o.builder.SimpleFormattingSliceBuilder({uidBuilder:new o.builder.FormattingSliceUidBuilder(new o.builder.FormattingGroupUidBuilder(new o.builder.FormattingCardUidBuilder("visualPlaceholderCard"),"visualPlaceholderGroup"),"responsive"),control:new o.builder.ToggleSwitchBuilder({descriptor:t.responsive,value:e.responsive}).build(),localize:i}).build(),revertToDefaultDescriptors:[t.responsive]}},n.prototype.enumerateGeneral=function(e,t,i){var a={selector:null,properties:{},objectName:"general"};i&&(i=o.ViewModelAdapterUtils.getResponsiveVisualProperties(t,o.cartesianChartProps),a.properties.responsive=i.responsive),e.pushInstance(a)},n.prototype.applyResponsiveChanges=function(e,t,i,a){var r=o.ViewModelAdapterUtils.cloneData(t),s=r.legendData.position;return i?(this.applyIconResponsiveChanges(e,r),this.applyLegendResponsiveChanges(e,s,r),this.applyAxesResponsiveChanges(e,r),this.applyZoomSliderResponsiveChanges(e,r),this.applyFontSizesChanges(e,r),n.applyScrollbarChanges(e,r)):a&&o.CartesianLegacyResponsiveApplier.applyLegacyResponsiveChanges(e,r),o.CartesianViewModelAdapterUtils.updatePlotResponsiveWarnings(r,t),r},n.prototype.applyIconResponsiveChanges=function(e,t){t.showIcon=e.height<=o.cartesianResponsiveBreakpoints.iconHeight||e.width<=o.cartesianResponsiveBreakpoints.iconWidth},n.prototype.applyLegendResponsiveChanges=function(e,t,i){(e.width<o.cartesianResponsiveBreakpoints.legendPositionWidth||e.height<o.cartesianResponsiveBreakpoints.legendPositionHeight)&&o.Legend.isLeftOrRight(t)&&(i.legendData.position=o.LegendPosition.Top),(e.height<o.cartesianResponsiveBreakpoints.legendHeight||e.width<o.cartesianResponsiveBreakpoints.legendWidth)&&(i.legendData.show=!1),i.legendData.useLargeArrowHitArea=!0},n.applyScrollbarChanges=function(e,t){t.scrollbarOptions=n.ScrollbarOptions},n.prototype.applyAxesResponsiveChanges=function(e,t){e.height<o.cartesianResponsiveBreakpoints.xAxesHeight&&(t.axesData.x.show=!1),e.width<o.cartesianResponsiveBreakpoints.yAxesTitleWidth&&(t.axesData.y.showAxisTitle=!1,t.axesData.y2.showAxisTitle=!1),e.width<o.cartesianResponsiveBreakpoints.yAxesWidth&&(t.axesData.y.show=!1,t.axesData.y2.show=!1),e.height<o.cartesianResponsiveBreakpoints.xAxesTitleHeight&&(t.axesData.x.showAxisTitle=!1)},n.prototype.applyZoomSliderResponsiveChanges=function(e,t){(e.height<o.cartesianResponsiveBreakpoints.xAxesZoomHeight||e.width<o.cartesianResponsiveBreakpoints.yAxesZoomWidth)&&(t.zoomData.showOnCategoryAxis=!1,t.zoomData.showOnValueAxis=!1,t.zoomData.showOnValueSecAxis=!1)},n.prototype.applyFontSizesChanges=function(e,t){t.legendData&&t.legendData.fontProperties&&(t.legendData.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.legendData.fontProperties));t=t.axesData;t.x.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.x.labelFontProperties),t.x.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.x.titleFontProperties),t.y.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.y.labelFontProperties),t.y.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.y.titleFontProperties),t.y2.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.y2.labelFontProperties),t.y2.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.y2.titleFontProperties)},n.ScrollbarOptions={scrollbarWidth:8,scrollbarRadius:4,scrollbarClass:"responsive"},o.CartesianViewModelAdapter=n}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(a){!function(g){var y=a.data.DataViewConcatenateCategoricalColumns;function e(e){this.staticUpdateOptions=e}e.prototype.create=function(e){return new t(this.staticUpdateOptions,e)},g.CartesianSmallMultipleUpdateFactory=e;i.prototype.apply=function(e,t){var i,a=this.staticUpdateOptions,r=a.layerInitDataOptions,a=a.updateGlobalAxesDomains,s=this.updateOptions,o=s.isSmallMultiples,n=s.reader,l=s.dataViews,c=s.updateOptions,s=s.requestedPerMultipleAxisDomains;if(o)for(var u=g.ComboChart.isComboChart(t)?n.convertComboFrame(e.index):[n.convertFrame(e.index)],d=void 0,h=0;h<u.length;h++){var p=u[h],p=y.concatenateCategoryColumnsForVisual(p.metadata,g.StandardObjectPropertyIdentifiers.formatString,g.cartesianRoleNames.category,p.categorical,!!d);d?p.categorical.categories=d:d=null==(i=p.categorical)?void 0:i.categories,u[h]=p}else u=l;e.hasInitializedData()||e.initData(r);t=__assign(__assign({},c),{dataViews:u,multipleInfo:o?this.buildMultipleInfo(e.index):void 0});e.update(t),s&&(s.categoryAxis||s.valueAxis||s.secondaryValueAxis)&&a(e.getAxesDomains(!0,s))},i.prototype.applySynchronizedAxes=function(e,t){this.updateOptions.isSmallMultiples;e.applySynchronizedDomains(t)},i.prototype.applyResize=function(e){e.resize(this.updateOptions.updateOptions.viewport)},i.prototype.buildMultipleInfo=function(e){this.updateOptions.isSmallMultiples,this.updateOptions.reader;var i,t=this.updateOptions.reader;if(t)return i=t.getFrameNode(e),t=t.getFrameSourceColumns().map(function(e,t){return{metadata:e,value:i.levelValues[t].value}}),{identity:i.identity,sources:t,isCoreMultiple:0===e}};var t=i;function i(e,t){this.staticUpdateOptions=e,this.updateOptions=t}function n(e,t,i,a,r,s,o){this.smallMultiples=e,this.index=t,this.featureSwitches=i,this.layers=a,this.type=r,this.interactivityService=s,this.getLayerInitOptions=o,this.state=0}g.CartesianSmallMultipleUpdate=t,n.create=function(e,t,i,a,r,s,o){return new n(e,t,i,r,s,a,o)},n.prototype.getDataPoint=function(){var t,e,i;return this.dataPoint||(t=this.multipleInfo,i=_.first(t.sources).metadata.queryName,e=t.sources.map(function(e){return g.buildValueDetailsForColumnValue(e.metadata,e.value,t.identity)}),i=(new g.SelectionIdBuilder).withColumnIdentity(t.identity,i,e).createSelectionId(),this.dataPoint={selected:!1,identity:i},this.interactivityService&&this.interactivityService.applySelectionStateToData([this.dataPoint])),this.dataPoint},n.prototype.getIndex=function(){return this.index},n.prototype.isSelected=function(){return this.getDataPoint().selected},n.prototype.getState=function(){return this.state},n.prototype.initRenderer=function(e){this.getState(),this.renderer=e;var t=this.getLayerInitOptions(e);this.layers.forEach(function(e){return e.initRenderer(t)}),this.state|=2},n.prototype.getRenderer=function(){return this.getState(),this.renderer},n.prototype.initData=function(i){this.getState(),this.layers.forEach(function(e){var t;return null==(t=e.initData)?void 0:t.call(e,i)}),this.style=i.style,this.state|=1},n.prototype.update=function(e){this.getState(),this.dataViews=e.dataViews,this.multipleInfo=e.multipleInfo,this.dataPoint=void 0,this.adapterFactory=e.adapterFactory;var t=this.layers;return this.responsiveData=void 0,this.data=g.CartesianChart.converter({layerStyle:this.style,chartType:this.type,dataViews:e.dataViews,categoryAxisTitleOnByDefault:e.categoryAxisTitleOnByDefault,valueAxisTitleOnByDefault:e.valueAxisTitleOnByDefault,layers:t,featureSwitches:this.featureSwitches,hasDataChanged:null!=e.operationKind,multipleInfo:e.multipleInfo}),this.data},n.prototype.isVisible=function(){return!!(2&this.state)},n.prototype.hasInitializedData=function(){return!!(1&this.state)},n.prototype.getMultipleInfo=function(){return this.multipleInfo},n.prototype.applySynchronizedDomains=function(e){var t,i,a,r,s,o=this.data&&this.data.axesData;e&&o&&(i=o.categoryAxis,a=o.valueAxis,o=o.secondaryValueAxis,r=e.categoryAxis,s=e.valueAxis,e=e.secondaryValueAxis,(t=function(e,t){e&&(t.includeDomains=t.includeDomains||[]).push(g.AxisHelper.createScalarDomainOptions(e,1))})(r,i),this.featureSwitches.smallMultiplesUnsharedAxes&&(!this.data.axesData.y.sharedAxis&&this.data.axesData.y.scaleToFit||!this.data.axesData.x.sharedAxis&&this.data.axesData.x.scaleToFit)||(t(s,a),t(e,o)))},n.prototype.resize=function(e){this.adapterFactory&&this.data&&(!1==!!this.smallMultiples||this.featureSwitches.smallMultiplesResponsive||!this.smallMultiples.isSmallMultiples()?(e=this.adapterFactory.createCartesianAdapter({cartesianData:this.data,dataView:this.dataViews[0],viewport:e,isCoreMultiple:!this.multipleInfo||this.multipleInfo.isCoreMultiple}),this.responsiveData=e.getData()):this.responsiveData=this.data)},n.prototype.getCapabilities=function(){var r={domainAggregateRoles:[],supportedDomainAggregates:void 0},s={domainAggregateRoles:[],supportedDomainAggregates:void 0},o={domainAggregateRoles:[],supportedDomainAggregates:void 0};return this.layers.forEach(function(e){function t(e,t){e&&e.domainAggregateRole&&(t.domainAggregateRoles.push(e.domainAggregateRole),void 0===t.supportedDomainAggregates?t.supportedDomainAggregates=e.supportedDomainAggregates:t.supportedDomainAggregates&=e.supportedDomainAggregates)}var e=e.getCartesianVisualCapabilities(),e=(e.axesCapabilities,e.axesCapabilities),i=e.categoryAxis,a=e.valueAxis,e=e.secondaryValueAxis;t(i,r),t(a,s),t(e,o)}),{axesCapabilities:{categoryAxis:_.isEmpty(r.domainAggregateRoles)?void 0:__assign(__assign({},r),{domainAggregateRoles:_.uniq(r.domainAggregateRoles)}),valueAxis:_.isEmpty(s.domainAggregateRoles)?void 0:__assign(__assign({},s),{domainAggregateRoles:_.uniq(s.domainAggregateRoles)}),secondaryValueAxis:_.isEmpty(o.domainAggregateRoles)?void 0:__assign(__assign({},o),{domainAggregateRoles:_.uniq(o.domainAggregateRoles)})}}},n.prototype.getAxesDomains=function(e,t){for(var i={},a=0;a<this.layers.length;a++){var r=this.layers[a];r.getAxesDomains&&((r=r.getAxesDomains(e,t)).categoryAxis&&(i.categoryAxis=g.AxisHelper.mergeDomains(i.categoryAxis||g.DefaultDomain,r.categoryAxis)),r.valueAxis&&(0<a&&g.ComboChart.isComboChart(this.type)?i.secondaryValueAxis=g.AxisHelper.mergeDomains(i.secondaryValueAxis||g.DefaultDomain,r.valueAxis):i.valueAxis=g.AxisHelper.mergeDomains(i.valueAxis||g.DefaultDomain,r.valueAxis)),r.secondaryValueAxis&&(i.secondaryValueAxis=g.AxisHelper.mergeDomains(i.secondaryValueAxis||g.DefaultDomain,r.secondaryValueAxis)))}return i},n.prototype.getData=function(){return this.responsiveData||this.data},n.prototype.clearSelection=function(){for(var e=0,t=this.layers.length;e<t;e++)this.layers[e].onClearSelection()},n.prototype.updateLayers=function(){this.layers.forEach(function(e){return e.render(!0)})},n.prototype.destroy=function(){this.renderer&&(this.getState(),this.renderer.destroy())},g.CartesianSmallMultiple=n}(a.visuals||(a.visuals={}))}(powerbi=powerbi||{}),function(c){!function(d){function e(e,t,i,a){this.type=e,this.featureSwitches=t,this.layerFactory=i,this.getLayerInitRendererOptions=a,this.multiples=[]}e.prototype.init=function(e,t){var i=this;this.rowLoadMoreDataHandler=new d.SimpleLoadMoreDataHandler(e.host),this.updateFactory=new d.CartesianSmallMultipleUpdateFactory({layerInitDataOptions:e,updateGlobalAxesDomains:function(e){return i.updateGlobalAxesDomains(e)}}),this.interactivityService=t,this.multiples=[]},e.prototype.getObjects=function(){return this.reader?this.reader.getObjects():void 0},e.prototype.getCoreMultiple=function(){return this.coreMultiple||(this.coreMultiple=d.CartesianSmallMultiple.create(this,0,this.featureSwitches,this.interactivityService,this.layerFactory(),this.type,this.getLayerInitRendererOptions)),this.coreMultiple},e.prototype.getShouldResetRowMultipleScrollPosition=function(){return this.shouldResetRowMultipleScrollPosition},e.prototype.get=function(e){if(this.isSmallMultiples(),!this.isSmallMultiples())return this.getCoreMultiple();if(this.multipleUpdate,!(i=this.multiples[e]))for(var t=this.multiples.length;t<=e;t++){this.multiples.length;var i=this.multiples[t]=d.CartesianSmallMultiple.create(this,t,this.featureSwitches,this.interactivityService,this.layerFactory(),this.type,this.getLayerInitRendererOptions),a=this.multipleUpdate;a.apply(i,this.type),this.isSmallMultiples()&&a.applySynchronizedAxes(i,this.axesDomains),a.applyResize(i)}return i},e.prototype.clear=function(){this.getMultiples(!0).forEach(function(e){return e.destroy()}),this.multiples=[],this.coreMultiple=void 0,this.axesDomains=void 0,this.shouldResetRowMultipleScrollPosition=void 0,this.multipleUpdate=void 0},e.prototype.resize=function(t){this.getMultiples(!0).forEach(function(e){return e.resize(t)})},e.prototype.update=function(e){var t,i=e.dataViews,a=(this.updateOptions=e,this.isSmallMultiples(i)),r=(this.shouldResetRowMultipleScrollPosition=!e.preserveScrollPosition,this.getCoreMultiple());a?(this.reader=d.DataViewMultipleReader.create(i[0],d.StandardObjectPropertyIdentifiers.formatString),this.updateFactory.create({dataViews:e.dataViews,isSmallMultiples:a,reader:this.reader,requestedPerMultipleAxisDomains:void 0,updateOptions:e}).apply(r,this.type),e.preserveScrollPosition||(this.lastUpdatedFrameIndex=0,this.axesDomains=void 0,this.requestPerMultipleAxisDomains=this.updateSynchronizedDomainsFromAggregates()),t=this.reader.getFrameCount(),this.rowLoadMoreDataHandler.updateDataView(e.dataViews[0])):(this.reader=void 0,this.lastUpdatedFrameIndex=0,this.axesDomains=void 0,t=1,this.rowLoadMoreDataHandler.updateDataView(void 0)),this.rowLoadMoreDataHandler.onLoadMoreDataCompleted(),this.multipleUpdate=this.updateFactory.create({dataViews:e.dataViews,isSmallMultiples:a,reader:this.reader,requestedPerMultipleAxisDomains:this.requestPerMultipleAxisDomains,updateOptions:e}),this.updateMultiples(t)},e.prototype.updateMultiples=function(e){for(var t=this,i=this.multiples,a=this.multipleUpdate,r=this.updateOptions.dataViews,s=this.isSmallMultiples(r),o=this.getCoreMultiple(),n=this.requestPerMultipleAxisDomains,l={startIndex:this.lastUpdatedFrameIndex,endIndex:e},c=l.startIndex;c<l.endIndex;c++){var u=s?i[c]:o;!u&&n&&(i.length,u=i[c]=d.CartesianSmallMultiple.create(this,c,this.featureSwitches,this.interactivityService,this.layerFactory(),this.type,this.getLayerInitRendererOptions)),u&&a.apply(u,this.type)}this.getMultiples(!0).forEach(function(e){e&&(s&&a.applySynchronizedAxes(e,t.axesDomains),a.applyResize(e))}),this.lastUpdatedFrameIndex=l.endIndex},e.prototype.updateSynchronizedDomainsFromAggregates=function(){var e,t=this.getCoreMultiple(),i=t.getCapabilities().axesCapabilities,a=i.categoryAxis,r=i.valueAxis,s=i.secondaryValueAxis,o={categoryAxis:!!(2&a.supportedDomainAggregates),valueAxis:!!(2&r.supportedDomainAggregates),secondaryValueAxis:!!(s&&2&s.supportedDomainAggregates)},a={categoryAxis:!!(1&a.supportedDomainAggregates),valueAxis:!!(1&r.supportedDomainAggregates),secondaryValueAxis:!!(s&&1&s.supportedDomainAggregates)},i=(!(o.categoryAxis||o.valueAxis||o.secondaryValueAxis)||(r=this.getTopLevelDomains(i))&&(e={categoryAxis:o.categoryAxis?r.categoryAxis:void 0,valueAxis:o.valueAxis?r.valueAxis:void 0,secondaryValueAxis:o.secondaryValueAxis?r.secondaryValueAxis:void 0}),this.axesDomains=e,null==(s=t.getData())?void 0:s.axesData),o=i&&this.featureSwitches.smallMultiplesUnsharedAxes&&!i.valueAxis.sharedAxis,r={categoryAxis:a.categoryAxis&&(!e||_.isEmpty(e.categoryAxis)),valueAxis:a.valueAxis&&(!e||_.isEmpty(e.valueAxis)||o),secondaryValueAxis:a.secondaryValueAxis&&(!e||_.isEmpty(e.secondaryValueAxis))};return _.every(r,function(e){return!e})?void 0:r},e.prototype.isSmallMultiples=function(e){return!(!e&&!this.updateOptions)&&(e=e||this.updateOptions.dataViews,d.CartesianChart.isSmallMultiples(e,this.featureSwitches.cartesianMultiples))},e.prototype.clearSelection=function(e){this.getMultiples(!0).forEach(function(e){return e.clearSelection()}),this.executeActionForMultiplesInRange(function(e){return e.updateLayers()},e,!1)},e.prototype.checkIfNoLabelsCanBeRendered=function(){return _.every(this.getMultiples(),function(e){return e.isVisible()&&e.getRenderer().noLabelsCanBeRendered})},e.prototype.scrollTo=function(t,e){this.executeActionForMultiplesInRange(function(e){return e.getRenderer().axesRenderer.scrollTo(t)},e,!1)},e.prototype.shouldScrollTo=function(t,e){return!!this.getValueForFirstMultipleInRange(function(e){return e.getRenderer().axesRenderer.shouldScrollTo(t)},e,!1)},e.prototype.scrollBy=function(t,e){this.executeActionForMultiplesInRange(function(e){return e.getRenderer().axesRenderer.scrollBy(t)},e,!1)},e.prototype.scrollDelta=function(t,e){this.executeActionForMultiplesInRange(function(e){return e.getRenderer().axesRenderer.scrollDelta(t)},e,!1)},e.prototype.clearRenderingTimeout=function(){this.getMultiples().forEach(function(e){return e.isVisible()&&e.getRenderer().axesRenderer.clearRenderingTimeout()})},e.prototype.updateScrollbarExtent=function(t,e){this.executeActionForMultiplesInRange(function(e){return e.getRenderer().axesRenderer.setExtent(t)},e,!1)},e.prototype.executeActionForMultiplesInRange=function(t,e,i){i=this.getMultiples(i,e);_.isEmpty(i)||i.forEach(function(e){return t(e)})},e.prototype.getValueForFirstMultipleInRange=function(e,t,i){i=this.getMultiples(i,t);if(!_.isEmpty(i))return e(i[0])},e.prototype.getFrameCount=function(){return this.isSmallMultiples()?this.reader.getFrameCount():1},e.prototype.updateGlobalAxesDomains=function(e){var t=this.axesDomains=this.axesDomains||{};e.categoryAxis&&(t.categoryAxis=d.AxisHelper.mergeDomains(t.categoryAxis||d.DefaultDomain,e.categoryAxis)),e.valueAxis&&(t.valueAxis=d.AxisHelper.mergeDomains(t.valueAxis||d.DefaultDomain,e.valueAxis)),e.secondaryValueAxis&&(t.secondaryValueAxis=d.AxisHelper.mergeDomains(t.secondaryValueAxis||d.DefaultDomain,e.secondaryValueAxis))},e.prototype.getTopLevelDomains=function(e){function t(e){var t,i=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t in e)for(var a=0,r=e[t];a<r.length;a++){var s=r[a],o=s.min,s=s.max;(_.isDate(o)||_.isNumber(o)&&isFinite(o))&&(_.isDate(s)||_.isNumber(s)&&isFinite(s))&&(n.featureSwitches.utcDates&&c.isDateWithEpochValue(o)&&c.isDateWithEpochValue(s)&&(o=o.epochTimeStamp,s=s.epochTimeStamp),i=d.AxisHelper.mergeDomains(i,[+o,+s]))}return i}var i,a,r,n=this,s=this.reader,o=e.categoryAxis,l=e.valueAxis,e=e.secondaryValueAxis;return 2&o.supportedDomainAggregates&&(i=(o=s.getTopLevelAggregates(o.domainAggregateRoles))?t(o):void 0),2&l.supportedDomainAggregates&&(a=(o=s.getTopLevelAggregates(l.domainAggregateRoles))?t(o):void 0),e&&2&e.supportedDomainAggregates&&(r=(l=e&&s.getTopLevelAggregates(e.domainAggregateRoles))?t(l):void 0),i||a||r?{categoryAxis:i,valueAxis:a,secondaryValueAxis:r}:void 0},e.prototype.getMultiples=function(e,t){void 0===e&&(e=!1);var i=[],a=this.isSmallMultiples();return a&&!e||(e=this.getCoreMultiple())&&i.push(e),a&&(e=this.multiples,t&&(e=e.slice(t.startIndex,Math.min(t.endIndex,e.length))),i.push.apply(i,e)),i},d.CartesianSmallMultiples=e}(c.visuals||(c.visuals={}))}(powerbi=powerbi||{}),function(H){!function(A){var o=A.AxisDataModel.AxesData,g=jsCommon.CssConstants,y=H.visuals.DataViewConcatenateUtil,c=H.data.DataViewRoleWildcard,p=H.visuals.DataViewObjectChangeHelper,e=H.visuals.LoadMoreDataStatus,l=H.visuals.OnObjectUtil,m=H.data.Selector,t=(A.INTERACTIVITY_RIGHT_MARGIN=6,A.DefaultDomain=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],A.MultiplesLayoutMinColumns=1,A.MultiplesLayoutMaxColumns=6,A.MultiplesLayoutMinRows=1,A.MultiplesLayoutMaxRows=6,A.MultiplesLayoutMinGridlinesWidth=1,A.MultiplesLayoutMaxGridlinesWidth=12,A.MultiplesSubheaderDefaults=function(){return{FontFamily:A.Font.Family.regular.css,FontPointSize:8,ColorName:"foregroundNeutralSecondary",TextClassName:"title",Vertical:0,Horizontal:0,Show:!0,TitleWrap:!1,bold:!1,italic:!1,underline:!1}},v.shouldYAxisBeCategorical=function(e){switch(e){case 6:case 5:case 7:return!0}return!1},v.isSmallMultiples=function(e,t){if(!t)return!1;if(_.size(e)<1)return!1;t=null==(t=null==(t=null==(t=null==(t=null==(t=e[0])?void 0:t.matrix)?void 0:t.rows)?void 0:t.levels)?void 0:t[0])?void 0:t.sources;return!(_.size(t)<1)&&(!_.isEmpty(e[0].matrix.rows.root.children)&&_.every(t,function(e){return H.data.DataRoleHelper.hasRole(e,A.cartesianRoleNames.rows)}))},v.prototype.init=function(e){var t=this,i=((this.visualInitOptions=e).featureSwitches&&!this.featureSwitches&&(this.featureSwitches=e.featureSwitches),e.element),a=(this.currentViewport=e.viewport,this.hostServices=e.host,this.eventManager=new jsCommon.BubblingEventManager(d3.select(i.get(0))),this.categoryLoadMoreDataHandler=new O(null,this.hostServices,v.LoadMoreThreshold),this.behaviorFactory&&(this.interactivityService=A.createInteractivityService(this.hostServices)),this.tooltipService=A.createTooltipService(e.host),this.visualInitOptions.style),r=H.Prototype.inherit(a),s=(r.colorPalette=H.Prototype.inherit(a.colorPalette),r.colorPalette.dataColors=new I(a.colorPalette.dataColors),this.layerStyle=r,o.createDefault(a)),a=(this.axisZoom=new A.AxisZoom(i,this.hostServices,this.axes.isScrollable&&!!e.interactivity,this.featureSwitches),this.axes.init({axesData:s,axisZoom:this.axisZoom,isYAxisCategorical:v.shouldYAxisBeCategorical(this.type),interactivityService:this.interactivityService}),this.legend=A.createLegend(i,e.interactivity&&e.interactivity.isInteractiveLegend,13!==this.type?this.interactivityService:void 0,this.axes.isScrollable,void 0,a,this.hostServices),H.Prototype.inherit(e));a.style=r,a.chartType=this.type,a.services={tooltips:this.tooltipService},this.multiples.init(a,this.interactivityService),this.layoutBuilder.init(e,this.tooltipService,this.legend,s,this.interactivityService,this.layerStyle,this.multiples.rowLoadMoreDataHandler,this.eventManager),this.layout=this.layoutBuilder.create(this.visualInitOptions.element),this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.featureSwitches.onObject&&(e=null!=(s=null==(a=null==(r=this.hostServices)?void 0:r.getSubSelectionService())?void 0:a.getRenderer())?s:A.SubSelectionRegionOutlineRenderer.createWithDefaultHost(),this.subSelectionHelper=A.HtmlSubSelectionHelper.createHtmlSubselectionHelper({hostElement:i.get(0),hostServices:this.hostServices,renderer:e,selectorCallback:function(e){return t.getSelectorsByColumnSubSelection(e)},customOutlineCallback:function(e){return t.getSubSelectionCustomOutlines(e)}}),this.interactivityService.setSubSelectionHelper(this.subSelectionHelper))},v.prototype.isPlayAxis=function(){if(!this.dataViews||!this.dataViews[0])return!1;var e=this.dataViews[0];return 10===this.type&&(this.hasAnimator||this.isMobileChart)&&H.data.DataRoleHelper.hasRoleInDataView(e,"Play")},v.prototype.hasBreakdownRole=function(){if(!this.dataViews||!this.dataViews[0])return!1;var e=this.dataViews[0];return 13===this.type&&H.data.DataRoleHelper.hasRoleInDataView(e,"Breakdown")},v.getDataBoundReferenceLines=function(e,t,i,a){var r=[],s=[];if(e)if(e.matrix&&e.matrix.valueSources){var o=e.matrix;if(o.valueSources&&s.push.apply(s,e.matrix.valueSources||[]),o.rows&&o.rows.levels)for(var n=0,l=o.rows.levels;n<l.length;n++){var c=l[n];s.push.apply(s,c.sources||[])}}else if(e.categorical&&e.categorical.values){o=_.head(e.categorical.values.grouped());if(o)for(var u=0,d=o.values;u<d.length;u++){var h=d[u];s.push(h.source)}}for(var p=0;p<s.length;p++){var g=s[p],y=A.ColorHelper.getDataColorByIndex(i,p,A.ForegroundColorName),m=H.DataViewObjects.getUserDefinedObjects(g.objects,"referenceLine"),f=v.getCartesianRoleKind(g,t);r.push.apply(r,A.ReferenceLineHelper.readDataView(m,y,"referenceLine",f,i,a,void 0,g)||[])}return r},v.getCartesianRoleKind=function(e,t){var i=e.roles;if(t.getAxisLocationForRole&&i)for(var a in i)if(i[a])return t.getAxisLocationForRole(a);return 1},v.converter=function(e){return(new A.CartesianChartConverter).convert(e)},v.prototype.updateInternal=function(h,p){return __awaiter(this,void 0,H.Promise,function(){var t,i,a,r,s,o,n,l,c,u,d;return __generator(this,function(e){switch(e.label){case 0:return(t=this.dataViews=h.dataViews,i=h.operationKind===H.VisualDataChangeOperationKind.Append||null!=h.resizeMode||h.formatMode,this.currentViewport=h.viewport,t)?(u=this.layerFactory.layerMetadata,c=_.some(u,function(e){return!!e.categoryAxisTitleOnByDefault}),u=_.some(u,function(e){return!!e.valueAxisTitleOnByDefault}),d=this.multiples.isSmallMultiples(t),(l=d&&t[0])?(n=l.metadata.objects,r=this.layerStyle,o=v.getMultiplesLayout(n,r),n=v.getMultiplesSubheader(n,r),r=o.columnCount,s=o.rowCount,this.viewModelAdapterFactory.setSmallMultiplesOptions({viewport:this.currentViewport,isSmallMultiples:d,columns:r,rows:s}),this.smallMultiplesViewModelAdapter=this.viewModelAdapterFactory.createSmallMultiplesAdapter({dataView:l,multiplesLayout:o,multiplesSubheader:n,viewport:this.currentViewport})):(this.viewModelAdapterFactory.setSmallMultiplesOptions({viewport:this.currentViewport,isSmallMultiples:d,columns:void 0,rows:void 0}),this.smallMultiplesViewModelAdapter=void 0),d!==this.multiples.isSmallMultiples()&&this.multiples.clear(),null!=p?(r=this.multiples.getCoreMultiple(),s=r.layers,_.isEmpty(t)||(l=v.getLayerDataViews(t),this.cartesianVisualCapabilities=v.getCartesianVisualCapabilities(s),d&&this.cartesianVisualCapabilities&&(this.cartesianVisualCapabilities.supportsHierarchicalCategoryAxis=!1),2===(a=this.categoryAxisRenderMode=v.getRenderMode(l,this.cartesianVisualCapabilities,this.featureSwitches.easierHierarchicalAxis))&&(t=t.map(function(e){return y.concatenateCategories(e,A.columnChartProps.general.formatString,A.cartesianRoleNames.category)}))),this.multiples.update({dataViews:t,operationKind:p,categoryAxisTitleOnByDefault:c,valueAxisTitleOnByDefault:u,viewport:this.currentViewport,adapterFactory:this.viewModelAdapterFactory,preserveScrollPosition:i}),this.cartesianData=this.originalCartesianData=r.getData()):(this.multiples.resize(this.currentViewport),this.cartesianData=this.multiples.getCoreMultiple().getData()),null==p&&this.cartesianData&&this.cartesianData.axesData?this.axes.updateResize(this.cartesianData.axesData,this.cartesianData.scrollbarOptions.scrollbarWidth):null!=p&&(_.isEmpty(t)||((o=t[0]).metadata&&(this.background={image:H.DataViewObjects.getValue(o.metadata.objects,A.scatterChartProps.plotArea.image),transparency:H.DataViewObjects.getValue(o.metadata.objects,A.scatterChartProps.plotArea.transparency,A.visualBackgroundHelper.getDefaultTransparency())}),this.categoryLoadMoreDataHandler.update(a,d),this.axes.update(o.categorical?o.categorical.categories:null,this.cartesianData.axesData,a,this.cartesianData.scrollbarOptions.scrollbarWidth)),this.categoryLoadMoreDataHandler.onLoadMoreDataCompleted()),this.cartesianData&&this.cartesianData.zoomData&&this.axisZoom.update({dataViews:t,zoomData:this.cartesianData.zoomData,hasSmallMultiples:d,hasScalarCategoryAxis:this.categoryAxisIsScalar().isScalar,hasYAxisCategorical:this.axes.isYAxisCategorical}),n=!this.hasSetData||h.suppressAnimations||d,[4,this.render(n,i,h.resizeMode)]):[2];case 1:return e.sent(),this.hasSetData=this.hasSetData||!_.isEmpty(t),this.updateWarnings(this.cartesianData.warningObjectCollection),l=h.type&H.VisualUpdateType.Data||h.type&H.VisualUpdateType.ResizeEnd||h.type&H.VisualUpdateType.FormattingSubSelectionChange,c=h.type&H.VisualUpdateType.FormattingSubSelectionChange,this.subSelectionHelper&&l&&(this.subSelectionHelper.updateOutlinesFromSubSelections(h.subSelections,!0),this.hostServices.alertScreenReader&&c&&(u=this.subSelectionHelper.getLabelsFromSubSelections(h.subSelections,["aria-label"]),(d=u.length&&u.join(" "))&&this.hostServices.alertScreenReader(d))),[2]}})})},v.getMultiplesLayout=function(e,t){var e=H.DataViewObjects.getObject(e,A.SmallMultiplesUtils.LayoutObjectName),i=e,a=v.getLayoutDefaults(t),t=A.ColorHelper.create(t),r=(i&&i.layoutType)===A.smallMultiplesLayout.auto?{layoutType:0,rowCount:a.rowCount,columnCount:a.columnCount}:{layoutType:1,rowCount:i&&i.rowCount||a.rowCount,columnCount:i&&i.columnCount||a.columnCount};return r.backgroundColor=t.getColorForPropertyNameWithDefaultColor(e,A.StandardObjectPropertyIdentifiers.smallMultiplesBackgroundColor.propertyName,a.backgroundColor,!0),r.backgroundTransparency=(i&&void 0!==i.backgroundTransparency?i:a).backgroundTransparency,r.gridLineType=i&&i.gridLineType||a.gridLineType,r.gridLineStyle=i&&i.gridLineStyle||a.gridLineStyle,r.gridLineColor=t.getColorForPropertyNameWithDefaultColor(e,A.StandardObjectPropertyIdentifiers.smallMultiplesGridLineColor.propertyName,a.gridLineColor),r.gridLineWidth=(i&&void 0!==i.gridLineWidth?i:a).gridLineWidth,v.applyPadding(r,i,a),r},v.getLayoutDefaults=function(e){var t={layoutType:0,rowCount:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultRowCount,columnCount:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultColumnCount,backgroundColor:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultBackgroundColor,backgroundTransparency:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultBackgroundTransparency,gridLineType:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultGridLineType,gridLineStyle:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultGridLineStyle,gridLineWidth:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultGridLineWidth,gridPadding:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultPadding,advancedPaddingOptions:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultAdvancedPaddingOptions,columnPaddingInner:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultPadding,columnPaddingOuter:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultPadding,rowPaddingInner:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultPadding,rowPaddingOuter:A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultPadding};return t.gridLineColor=A.ColorHelper.getThemeColor(e,A.SmallMultiplesUtils.SmallMultiplesDefaults.DefaultGridLineColorName),t},v.getCartesianVisualCapabilities=function(e){for(var t,i=0,a=e.length;i<a;i++){var r=e[i].getCartesianVisualCapabilities();t?t.supportsHierarchicalCategoryAxis=t.supportsHierarchicalCategoryAxis&&r.supportsHierarchicalCategoryAxis:t=H.Prototype.inherit(r)}return t},v.getRenderMode=function(e,t,i){for(var a=0,r=e;a<r.length;a++){var s,o=r[a];null!=o&&(o=new d(o,null==t?void 0:t.supportsHierarchicalCategoryAxis,i).getRenderModes(),s=s?_.intersection(s,o):o,_.isEmpty(s))}return _.head(s)},v.getCategoryValueType=function(e){_.isEmpty(e);e=_.find(e,function(e){return e.getCategoryValueType});if(e)return e.getCategoryValueType()},v.applyPadding=function(e,t,i){e.gridPadding=(t&&void 0!==t.gridPadding?t:i).gridPadding,e.advancedPaddingOptions=(t&&void 0!==t.advancedPaddingOptions?t:i).advancedPaddingOptions;var a=t&&t.advancedPaddingOptions,r={gridPadding:e.gridPadding,gridLineSettings:e.gridLineType};a&&void 0!==t.columnPaddingInner?e.columnPaddingInner=t.columnPaddingInner:e.columnPaddingInner=v.getPaddingFromGridPaddingAndDefaults(r,1),a&&void 0!==t.columnPaddingOuter?e.columnPaddingOuter=t.columnPaddingOuter:(r.defaultPadding=i.columnPaddingOuter,e.columnPaddingOuter=v.getPaddingFromGridPaddingAndDefaults(r,0)),a&&void 0!==t.rowPaddingInner?e.rowPaddingInner=t.rowPaddingInner:e.rowPaddingInner=v.getPaddingFromGridPaddingAndDefaults(r,2),a&&void 0!==t.rowPaddingOuter?e.rowPaddingOuter=t.rowPaddingOuter:(r.defaultPadding=i.rowPaddingOuter,e.rowPaddingOuter=v.getPaddingFromGridPaddingAndDefaults(r,0))},v.getPaddingFromGridPaddingAndDefaults=function(e,t){var i=e.gridPadding,a=e.gridLineSettings,r=e.defaultPadding;switch(t){case 0:return A.GridLayout.typeHasOuterGridLines(a)?i:r;case 1:return A.GridLayout.typeHasVerticalGridLines(a)?i:v.floatSafeHalf(i);case 2:return A.GridLayout.typeHasHorizontalGridLines(a)?i:v.floatSafeHalf(i)}},v.floatSafeHalf=function(e){return e%2==0?e/2:Math.ceil(e/2)},v.prototype.isSmallMultiples=function(){return v.isSmallMultiples(this.dataViews,this.featureSwitches.cartesianMultiples)},v.prototype.showLayoutCard=function(){return this.isSmallMultiples()},v.prototype.supportsResponsive=function(){return this.featureSwitches.smallMultiplesResponsive||!this.isSmallMultiples()},v.prototype.enumerateLayout=function(e){var t,i;this.showLayoutCard()&&(t={selector:null,properties:{},validValues:{rowCount:{numberRange:{min:A.MultiplesLayoutMinRows,max:A.MultiplesLayoutMaxRows}},columnCount:{numberRange:{min:A.MultiplesLayoutMinColumns,max:A.MultiplesLayoutMaxColumns}}},objectName:A.SmallMultiplesUtils.LayoutObjectName},0===(i=v.getMultiplesLayout(this.dataViews[0].metadata.objects,this.layerStyle)).layoutType?t.properties.layoutType=A.smallMultiplesLayout.auto:(t.properties.rowCount=i.rowCount,t.properties.columnCount=i.columnCount),e.pushInstance(t),t={selector:{data:[c.fromRoles([A.cartesianRoleNames.rows])]},properties:{backgroundColor:i.backgroundColor},propertyInstanceKind:{backgroundColor:3},altConstantValueSelector:null,objectName:A.SmallMultiplesUtils.LayoutObjectName},e.pushInstance(t,!1),t={selector:null,properties:{backgroundTransparency:i.backgroundTransparency,gridLineType:i.gridLineType},validValues:{gridLineWidth:{numberRange:{min:A.MultiplesLayoutMinGridlinesWidth,max:A.MultiplesLayoutMaxGridlinesWidth}}},objectName:A.SmallMultiplesUtils.LayoutObjectName},i.gridLineType!==A.gridLineType.none&&(t.properties.gridLineColor=i.gridLineColor,t.properties.gridLineWidth=i.gridLineWidth,t.properties.gridLineStyle=i.gridLineStyle),i.advancedPaddingOptions||(t.properties.gridPadding=i.gridPadding),t.properties.advancedPaddingOptions=i.advancedPaddingOptions,i.advancedPaddingOptions&&(t.properties.columnPaddingInner=i.columnPaddingInner,t.properties.columnPaddingOuter=i.columnPaddingOuter,t.properties.rowPaddingInner=i.rowPaddingInner,t.properties.rowPaddingOuter=i.rowPaddingOuter),e.pushInstance(t,!1))},v.prototype.showSmallMultiplesCard=function(){return this.isSmallMultiples()},v.prototype.getSmallMultiplesCard=function(){var a,r,s,o,n,e,l=this;if(9!==this.type&&10!==this.type&&13!==this.type)return a=function(e){return l.hostServices.getLocalizedString(e)},r=v.getMultiplesLayout(this.dataViews[0].metadata.objects,this.layerStyle),s=v.getMultiplesSubheader(this.dataViews[0].metadata.objects,this.layerStyle),o=A.StandardObjectIdentifiers.smallMultiplesLayout,n=A.StandardObjectIdentifiers.subheader,e=new A.builder.FormattingCardBuilder(new A.builder.FormattingCardUidBuilder("smallMultiples"),"Role_DisplayName_SmallMultiples",[o.rowCount,o.columnCount,o.gridPadding,o.advancedPaddingOptions,o.columnPaddingInner,o.columnPaddingOuter,o.rowPaddingInner,o.rowPaddingOuter,o.gridLineType,o.gridLineStyle,o.gridLineColor,o.gridLineWidth,o.backgroundColor,o.backgroundTransparency,n.show,n.fontFamily,n.fontSize,n.fontColor,n.underline,n.bold,n.italic,n.position,n.alignment,n.titleWrap],a),this.showSmallMultiplesCard()?(e.withDescription("Small_Multiples_Layout_Description").addGroup("layout",function(e){r.layoutType,e.withDisplayName("Small_Multiples_LayoutGroup").addSimpleSlice("rowCount",new A.builder.NumUpDownBuilder({descriptor:o.rowCount,value:r.rowCount,options:{minValue:{type:0,value:A.MultiplesLayoutMinRows},maxValue:{type:1,value:A.MultiplesLayoutMaxRows}}}).build()).addSimpleSlice("columnCount",new A.builder.NumUpDownBuilder({descriptor:o.columnCount,value:r.columnCount,options:{minValue:{type:0,value:A.MultiplesLayoutMinColumns},maxValue:{type:1,value:A.MultiplesLayoutMaxColumns}}}).build());var t=r.advancedPaddingOptions,i={minValue:{type:0,value:0},maxValue:{type:1,value:40}};e.addSimpleSlice("gridPadding",new A.builder.NumUpDownBuilder({descriptor:o.gridPadding,value:r.gridPadding,options:i}).build(),function(e){return e.withDisabled(t).withCustomDisplayName("Small_Multiples_All_Padding")}).addSimpleSlice("advancedPadding",new A.builder.ToggleSwitchBuilder({descriptor:o.advancedPaddingOptions,value:r.advancedPaddingOptions}).build(),function(e){return e.withCustomDisplayName("Small_Multiples_Customize_Padding")}),t&&e.addSimpleSlice("columnPaddingInner",new A.builder.SliderBuilder({descriptor:o.columnPaddingInner,value:r.columnPaddingInner,options:i,localize:a}).build()).addSimpleSlice("columnPaddingOuter",new A.builder.SliderBuilder({descriptor:o.columnPaddingOuter,value:r.columnPaddingOuter,options:i,localize:a}).build()).addSimpleSlice("rowPaddingInner",new A.builder.SliderBuilder({descriptor:o.rowPaddingInner,value:r.rowPaddingInner,options:i,localize:a}).build()).addSimpleSlice("rowPaddingOuter",new A.builder.SliderBuilder({descriptor:o.rowPaddingOuter,value:r.rowPaddingOuter,options:i,localize:a}).build())}),e.addGroup("border",function(e){var t=r.gridLineType!==A.gridLineType.none;e.withDisplayName("Visual_Border").addSimpleSlice("gridLineType",new A.builder.DropdownBuilder({descriptor:o.gridLineType,value:r.gridLineType}).build()).addSimpleSlice("gridLineStyle",new A.builder.DropdownBuilder({descriptor:o.gridLineStyle,value:r.gridLineStyle}).build(),function(e){return e.withDisabled(!t)}).addSimpleSlice("gridLineColor",new A.builder.ColorPickerBuilder({descriptor:o.gridLineColor,value:{value:r.gridLineColor}}).build(),function(e){return e.withDisabled(!t)}).addSimpleSlice("gridLineWidth",new A.builder.NumUpDownBuilder({descriptor:o.gridLineWidth,value:r.gridLineWidth,options:{minValue:{type:0,value:A.MultiplesLayoutMinGridlinesWidth},maxValue:{type:1,value:A.MultiplesLayoutMaxGridlinesWidth}}}).build(),function(e){return e.withDisabled(!t)})}),e.addGroup("title",function(e){e.withDisplayName("Title"),l.featureSwitches.smallMultiplesResponsive&&e.addTopLevelToggle("show",function(){return new A.builder.ToggleSwitchBuilder({descriptor:n.show,value:!!l.showSubheaderCard()&&s.show}).build()});var t=s.fontProperties,i=(new A.builder.FontControlBuilder).withFontFamily({descriptor:n.fontFamily,value:t.family}).withFontSizeProperties({descriptor:n.fontSize,value:t.size.pt}),i=(l.featureSwitches.enableBIU&&i.withBold({descriptor:n.bold,value:s.labelBold}).withItalic({descriptor:n.italic,value:s.labelItalic}).withUnderline({descriptor:n.underline,value:s.labelUnderline}),i.build());e.addSimpleSlice("position",function(){var e;switch(s.vertical){default:case 0:e=A.verticalPosition.top;break;case 1:e=A.verticalPosition.bottom}return new A.builder.DropdownBuilder({descriptor:n.position,value:e}).build()}).addCompositeSlice("font","Font",i).addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:__assign(__assign({},n.fontColor),{instanceKind:3,selector:{data:[c.fromRoles([A.cartesianRoleNames.rows])]},altConstantValueSelector:null}),value:{value:t.color}}).build()).addSimpleSlice("alignment",function(){var e;switch(s.horizontal){default:case 0:e=A.horizontalPosition.left;break;case 1:e=A.horizontalPosition.center;break;case 2:e=A.horizontalPosition.right}return new A.builder.AlignmentGroupBuilder({descriptor:n.alignment,value:e,mode:"horizontalAlignment"}).build()}),l.featureSwitches.smallMultiplesSubheaderFormatting&&e.addSimpleSlice("titleWrap",new A.builder.ToggleSwitchBuilder({descriptor:n.titleWrap,value:s.titleWrap}).build(),function(e){return e.withCustomDisplayName("TextWrap")})}),e.addGroup("background",function(e){e.withDisplayName("Visual_Background").addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:__assign(__assign({},o.backgroundColor),{selector:{data:[c.fromRoles([A.cartesianRoleNames.rows])]},altConstantValueSelector:null,instanceKind:3}),value:{value:r.backgroundColor},isNoFillItemSupported:!0}).build(),function(e){return e.withCustomDisplayName("Generic_Color")}).addSimpleSlice("transparency",new A.builder.SliderBuilder({descriptor:o.backgroundTransparency,value:r.backgroundTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:A.visualLocKeys.PercentLocKey},localize:a}).build(),function(e){return e.withCustomDisplayName("Transparency")})})):e.withDisabled(!0,"Visual_SmallMultipleCard_DisabledReason"),e.build()},v.getMultiplesSubheader=function(e,t){var e=H.DataViewObjects.getObject(e,"subheader"),i=A.MultiplesSubheaderDefaults(),a=A.ColorHelper.create(t),a=A.FontProperties.createFromObjectOrStyle(e,{family:"fontFamily",size:"fontSize",color:"fontColor",bold:"bold",italic:"italic",underline:"underline"},a,t,i.ColorName,i.TextClassName,{color:A.ColorHelper.getThemeColor(t,i.ColorName),size:A.Units.FontSize.createFromPt(i.FontPointSize),family:i.FontFamily,weight:g.normalValue,style:g.normalValue,textDecoration:g.noneValue}),t={top:0,bottom:2,left:5,right:0},r=a.size.px+t.top+t.bottom,s=i.Vertical,o=i.Horizontal,n=i.TitleWrap,i=i.Show,l=!1,c=!1,u=!1;if(e){switch(e.position){case A.verticalPosition.top:s=0;break;case A.verticalPosition.bottom:s=1}switch(e.alignment){case A.horizontalPosition.left:o=0;break;case A.horizontalPosition.center:o=1;break;case A.horizontalPosition.right:o=2}n=e.titleWrap,void 0!==e.show&&(i=e.show),void 0!==e.bold&&(l=e.bold),void 0!==e.italic&&(c=e.italic),void 0!==e.underline&&(u=e.underline)}return{fontProperties:a,show:i,height:r,margins:t,vertical:s,horizontal:o,titleWrap:n,labelBold:l,labelItalic:c,labelUnderline:u}},v.prototype.showSubheaderCard=function(){return this.isSmallMultiples()},v.prototype.enumerateSubheader=function(e){if(this.showSubheaderCard()){var t,i,a=v.getMultiplesSubheader(this.dataViews[0].metadata.objects,this.layerStyle);switch(a.horizontal){default:case 0:t=A.horizontalPosition.left;break;case 1:t=A.horizontalPosition.center;break;case 2:t=A.horizontalPosition.right}switch(a.vertical){default:case 0:i=A.verticalPosition.top;break;case 1:i=A.verticalPosition.bottom}var r={objectName:A.SmallMultiplesUtils.SubheaderObjectName,selector:null,properties:{}};this.featureSwitches.smallMultiplesResponsive&&(r.properties.show=a.show),r.properties.fontFamily=a.fontProperties.family,r.properties.fontSize=a.fontProperties.size.pt,e.pushInstance(r),r={objectName:A.SmallMultiplesUtils.SubheaderObjectName,selector:{data:[c.fromRoles([A.cartesianRoleNames.rows])]},properties:{fontColor:a.fontProperties.color},propertyInstanceKind:{fontColor:3},altConstantValueSelector:null},e.pushInstance(r,!1),r={objectName:A.SmallMultiplesUtils.SubheaderObjectName,selector:null,properties:{alignment:t,position:i}},this.featureSwitches.smallMultiplesSubheaderFormatting&&(r.properties.titleWrap=a.titleWrap),e.pushInstance(r,!1)}},v.getLayerDataViews=function(e){return _.isEmpty(e)?[]:_.filter(e,function(e){return!A.TrendLineHelper.isDataViewForRegression(e)&&!A.ForecastHelper.isDataViewForForecast(e)&&!A.AnomalyDetectionVisualPlugin.isDataViewForAnomalyDetection(e)})},v.prototype.render=function(t,i,a){return __awaiter(this,void 0,H.Promise,function(){return __generator(this,function(e){return[2,this.layout.render(this.multiples,this.currentViewport,this.categoryLoadMoreDataHandler,this.background,this.axisZoom,this.trimOrdinalDataOnOverflow,t,3===this.categoryAxisRenderMode,i,this.formatMode,this.subSelectionHelper,a)]})})},v.prototype.updateWarnings=function(e){if(!_.isEmpty(this.dataViews)){var t=this.dataViews,i=A.getInvalidValueWarnings(t,!1,!1,!1,["Tooltips"],!0);if(_.isEmpty(i)||e.add.apply(e,i||[]),this.axes.addWarnings(e),this.multiples.checkIfNoLabelsCanBeRendered()){var i={selector:null,warnings:[new A.DataLabelsNotRenderedWarning]};e.addForVisualObject("labels",i)}else{e.removeForVisualObject("labels");for(var a=0,r=null==(i=this.multiples.getCoreMultiple())?void 0:i.layers;a<r.length;a++){var s=r[a];s.addWarnings&&s.addWarnings(e)}}for(var o=[],n=null==(i=this.cartesianVisualCapabilities)?void 0:i.supportsHierarchicalCategoryAxis,l=0,c=t;l<c.length;l++){var u=c[l];new d(u,n,this.featureSwitches.easierHierarchicalAxis).addObjectWarnings(o)}_.isEmpty(o)||(i=this.cartesianData.warningObjectCollection).addForVisualObject.apply(i,__spreadArray(["categoryAxis"],o)),this.hostServices.setWarnings(this.cartesianData.warningObjectCollection.complete())}},v.prototype.update=function(i){return __awaiter(this,void 0,H.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return this.featureSwitches.onObject&&(t=this.multiples.isSmallMultiples(i.dataViews),this.formatMode&&t&&(this.subSelectionHelper.setFormatMode(!1),this.interactivityService.setFormatMode(!1),this.formatMode=!1),i.formatMode===this.formatMode||t||(this.subSelectionHelper.setFormatMode(i.formatMode),this.interactivityService.setFormatMode(i.formatMode),this.formatMode=i.formatMode)),null==i.resizeMode?[3,2]:[4,this.updateInternal(i)];case 1:return e.sent(),[3,4];case 2:return[4,this.updateInternal(i,null!=i.operationKind?i.operationKind:H.VisualDataChangeOperationKind.Create)];case 3:e.sent(),e.label=4;case 4:return[2]}})})},v.prototype.destroy=function(){this.multiples&&this.multiples.clear(),this.layout&&this.layout.destroy(),this.axisZoom&&(this.axisZoom.destroy(),this.axisZoom=void 0)},v.prototype.onViewModeChanged=function(e){this.layout.viewMode=e},v.prototype.scrollTo=function(e){var t=this.layout.getVisibleMultiples();this.multiples.scrollTo(e,t)},v.prototype.scrollRowsTo=function(e){this.layout.scrollRowsTo(e)},v.prototype.enumerateObjectInstances=function(e){var t=new A.ObjectEnumerationBuilder,i=this.getLayers();if(e.objectName===A.SmallMultiplesUtils.LayoutObjectName)this.enumerateLayout(t);else if("subheader"===e.objectName)this.enumerateSubheader(t);else if("legend"===e.objectName){if(!this.shouldShowLegendCard())return;for(var a={enumeration:t,legendData:this.originalCartesianData.legendData},r=0,s=i;r<s.length;r++)(o=s[r]).enumerateCustomLegend?o.enumerateCustomLegend(a):A.Legend.enumerate(a,this.featureSwitches)}else"categoryAxis"===e.objectName&&this.axes.hasCategoryAxis()?this.enumerateCategoryAxis(t):"valueAxis"===e.objectName?this.enumerateValueAxis(t):"y2Axis"===e.objectName?this.enumerateValueAxis(t,"y2Axis"):e.objectName===A.ReferenceLineHelper.xAxisRefLineObjectName?(c=this.categoryAxisIsScalar().isScalar,A.CartesianChartConverter.supportsStaticReferenceLines(this.dataViews,i)&&c&&(0===this.type&&this.featureSwitches.lineChartVerticalReferenceLine||0!==this.type&&this.featureSwitches.xAxisRefLineImprovements)&&(c=v.getCategoryValueType(i),this.enumerateReferenceLines(t,e.objectName,c))):e.objectName===A.ReferenceLineHelper.y1AxisRefLineObjectName?this.enumerateReferenceLines(t,e.objectName):"referenceLine"===e.objectName?A.CartesianChartConverter.supportsDataBoundReferenceLines(this.dataViews,i)&&this.enumerateReferenceLines(t,e.objectName):"trend"===e.objectName?A.CartesianChartConverter.supportsTrendLines(this.dataViews,i)&&A.TrendLineHelper.enumerateObjectInstances(t,this.originalCartesianData.trendLines,this.layerStyle):"plotArea"===e.objectName?A.visualBackgroundHelper.enumeratePlot(t,this.background):"zoom"===e.objectName&&this.axisZoom.enumerateObjectInstances(t);if("dataPoint"===e.objectName&&A.ComboChart.isComboChart(this.type))A.ComboChart.enumerateDataPoints(t,e,i);else for(var o,n=0,l=i;n<l.length;n++)(o=l[n]).enumerateObjectInstances&&o.enumerateObjectInstances(t,e);var c=this.supportsResponsive();return this.dataViews&&this.dataViews[0]&&(i=this.dataViews[0],this.viewModelAdapterFactory&&this.viewModelAdapterFactory.createCartesianAdapter({cartesianData:void 0,dataView:i,viewport:void 0,isCoreMultiple:void 0}).enumerateObjectInstances(e,t,c)),this.smallMultiplesViewModelAdapter&&this.smallMultiplesViewModelAdapter.enumerateObjectInstances(e,t,c),t.complete()},v.prototype.getSelectorsByColumnSubSelection=function(e){for(var t=0,i=this.getLayers();t<i.length;t++){var a=i[t];if(a.getSelectorsByColumnFromSubselectedElement)return a.getSelectorsByColumnFromSubselectedElement(e)}return{}},v.prototype.getSubSelectionCustomOutlines=function(e){for(var t=0,i=this.getLayers();t<i.length;t++){var a=i[t];if(a.getSubSelectionCustomOutlines)return a.getSubSelectionCustomOutlines(e)}return[]},v.prototype.getSubSelectionStyles=function(e){if(this.featureSwitches.onObject){var t,i=_.first(e).visualObjects;if(0<i.length){null!=(i=i[0])&&i.selectorsByColumn&&(t=m.normalizeSelector(m.convertSelectorsByColumnToSelector(i.selectorsByColumn)));var a=1===this.getLayers().length&&this.cartesianData.legendData.dataPoints.length<=1;switch(i.objectName){case"legend-title":case"x-axis-zoom-slider":case"y1-axis-zoom-slider":case"y2-axis-zoom-slider":return;case"legend-items":var r="legend-text";return l.getFontOnlyTextSubSelectionStyles("Visual-legend",r,r+"-fontselector",r+"-color",this.hostServices);case"data-labels":r="labels-applySettingsTo-series--values";return l.getNumericTextSubSelectionStyles("Visual-labels",a?void 0:r,r+"-font",r+"-color",r+"-precision",r+"-displayUnits",this.hostServices,a?void 0:t);case"horizontal-gridlines":r="gridlines-horizontal";return l.getShapeSubSelectionStyles("Visual-gridlines",r,r+"-color",this.hostServices,!0);case"vertical-gridlines":r="gridlines-vertical";return l.getShapeSubSelectionStyles("Visual-gridlines",r,r+"-color",this.hostServices,!0);case"series-labels":r="seriesLabels-applySettingsTo-series--values";return l.getFontOnlyTextSubSelectionStyles("Visual-seriesLabels",a?void 0:r,r+"-font",r+"-seriesColor",this.hostServices,a?void 0:t);case"total-labels":r="totals-values";return l.getFontOnlyTextSubSelectionStyles("Visual-totals",r,r+"-font",r+"-color",this.hostServices);case"x-axis-title":return A.CartesianChartOnObjectUtil.getAxisTitleSubSelectionStyles(!1,!this.axes.isYAxisCategorical,this.hostServices);case"y1-axis-title":return A.CartesianChartOnObjectUtil.getAxisTitleSubSelectionStyles(!1,this.axes.isYAxisCategorical,this.hostServices);case"y2-axis-title":return A.CartesianChartOnObjectUtil.getAxisTitleSubSelectionStyles(!0,this.axes.isYAxisCategorical,this.hostServices);case"x-axis-values":return A.CartesianChartOnObjectUtil.getAxisValuesSubSelectionStyles(!1,!this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);case"y1-axis-values":return A.CartesianChartOnObjectUtil.getAxisValuesSubSelectionStyles(!1,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);case"y2-axis-values":return A.CartesianChartOnObjectUtil.getAxisValuesSubSelectionStyles(!0,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);default:for(var s=0,o=this.getLayers();s<o.length;s++){var n=o[s];if(n.getSubSelectionStyles)return n.getSubSelectionStyles(e)}}}}},v.prototype.getSubSelectionShortcuts=function(e){if(this.featureSwitches.onObject){var t=_.first(e).visualObjects;if(0<t.length){var i,a=t[0],r=this.getLayers(),s=r.length<=1&&this.cartesianData.legendData.dataPoints.length<=1,o={key:"Delete",nextValue:!1};switch(s||_.isEmpty(a.selectorsByColumn)||(i=m.normalizeSelector(m.convertSelectorsByColumnToSelector(a.selectorsByColumn))),a.objectName){case"legend-title":var n="legend-title";return[{type:2,sourceUid:n,disabledLabel:this.hostServices.getLocalizedString("Delete"),keyboardShortcuts:[o]},{type:0,relatedResetSourceUids:[n]},{type:1,destinationUids:[{cardUid:"Visual-legend",groupUid:n}],label:this.hostServices.getLocalizedString("Format_Legend_Title")}];case"legend-items":return[{type:2,sourceUid:"Visual-legend",disabledLabel:this.hostServices.getLocalizedString("Delete"),keyboardShortcuts:[o]},{type:0,relatedResetSourceUids:["legend-title-showTitle","legend-text"]},{type:2,sourceUid:"legend-title",enabledLabel:this.hostServices.getLocalizedString("Format_AddLegendTitle")},{type:4,sortableField:{queryName:"",sortDirection:1},label:this.hostServices.getLocalizedString("Format_SortLegend"),key:"Legend"},{type:1,destinationUids:[{cardUid:"Visual-legend",groupUid:"legend-options"}],label:this.hostServices.getLocalizedString("Format_Legend")}];case"data-labels":return[{type:2,sourceUid:s?"Visual-labels":"labels-applySettingsTo-series--showSeries",disabledLabel:this.hostServices.getLocalizedString("Delete"),selector:i,keyboardShortcuts:[o]},{type:0,relatedResetSourceUids:["labels-applySettingsTo-series--values"]},{type:1,destinationUids:[{cardUid:"Visual-labels",groupUid:"labels-applySettingsTo-series--options"}],label:this.hostServices.getLocalizedString("Format_Data_Labels")}];case"horizontal-gridlines":n="gridlines-horizontal";return[{type:2,sourceUid:n,disabledLabel:this.hostServices.getLocalizedString("Delete"),keyboardShortcuts:[o]},{type:0,relatedResetSourceUids:[n]},{type:1,destinationUids:[{cardUid:"Visual-gridlines",groupUid:n}],label:this.hostServices.getLocalizedString("Format_Gridlines")}];case"vertical-gridlines":n="gridlines-vertical";return[{type:2,sourceUid:n,disabledLabel:this.hostServices.getLocalizedString("Delete"),keyboardShortcuts:[o]},{type:0,relatedResetSourceUids:[n]},{type:1,destinationUids:[{cardUid:"Visual-gridlines",groupUid:n}],label:this.hostServices.getLocalizedString("Format_Gridlines")}];case"series-labels":return[{type:2,sourceUid:s?"Visual-seriesLabels":"seriesLabels-applySettingsTo-series--showSeries",disabledLabel:this.hostServices.getLocalizedString("Delete"),selector:i,keyboardShortcuts:[o]},{type:0,relatedResetSourceUids:["seriesLabels-applySettingsTo-series--values"]},{type:1,destinationUids:[{cardUid:"Visual-seriesLabels",groupUid:"seriesLabels-applySettingsTo-series--options"}],label:this.hostServices.getLocalizedString("Format_Series_Labels")}];case"total-labels":n="totals-values";return[{type:2,sourceUid:"Visual-totals",disabledLabel:this.hostServices.getLocalizedString("Delete"),keyboardShortcuts:[o]},{type:0,relatedResetSourceUids:[n]},{type:1,destinationUids:[{cardUid:"Visual-totals",groupUid:n}],label:this.hostServices.getLocalizedString("Format_Total_Labels")}];case"x-axis-title":return A.CartesianChartOnObjectUtil.getAxisTitleSubSelectionShortcuts(!1,!this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);case"y1-axis-title":return A.CartesianChartOnObjectUtil.getAxisTitleSubSelectionShortcuts(!1,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);case"y2-axis-title":return A.CartesianChartOnObjectUtil.getAxisTitleSubSelectionShortcuts(!0,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);case"x-axis-values":return A.CartesianChartOnObjectUtil.getAxisValuesSubSelectionShortcuts(!1,!this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.categoryAxisIsScalar().supportedType,this.hostServices);case"y1-axis-values":return A.CartesianChartOnObjectUtil.getAxisValuesSubSelectionShortcuts(!1,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.categoryAxisIsScalar().supportedType,this.hostServices);case"y2-axis-values":return A.CartesianChartOnObjectUtil.getAxisValuesSubSelectionShortcuts(!0,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.categoryAxisIsScalar().supportedType,this.hostServices);case"x-axis-zoom-slider":case"y1-axis-zoom-slider":case"y2-axis-zoom-slider":var n="zoom-default",l=n+"-labels",c=n+"-tooltips",u="y2-axis-zoom-slider"===a.objectName,d="x-axis-zoom-slider"===a.objectName,h=n+"-";return[{type:2,sourceUid:h+=u?"valueSecAxis":!!d==!!this.axes.isYAxisCategorical?"valueAxis":"categoryAxis",disabledLabel:this.hostServices.getLocalizedString("Delete"),keyboardShortcuts:[o]},{type:0,relatedResetSourceUids:[l,c,n]},{type:2,sourceUid:l,enabledLabel:this.hostServices.getLocalizedString("Format_AddSliderLabels")},{type:2,sourceUid:c,enabledLabel:this.hostServices.getLocalizedString("Format_AddSliderTooltips")},{type:1,destinationUids:[{cardUid:"Visual-zoom",groupUid:n}],label:this.hostServices.getLocalizedString("Format_ZoomSlider")}];default:for(var p=0,g=r;p<g.length;p++){var y=g[p];if(y.getSubSelectionShortcuts)return y.getSubSelectionShortcuts(e)}}}}},v.prototype.getSubSelectables=function(e){for(var t=this.subSelectionHelper.getAllSubSelectables(e),i=0,a=this.getLayers();i<a.length;i++){var r=a[i];r.getDisambiguationSubSelectables&&t.push.apply(t,r.getDisambiguationSubSelectables(this.subSelectionHelper,e))}return t},v.prototype.getNextSubSelectable=function(e,t){return this.subSelectionHelper.getNextSubSelectable(e,t)},v.prototype.getFormattingModel=function(){for(var r=this,e=function(e){for(var t,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];return(t=r.hostServices).getLocalizedString.apply(t,__spreadArray([e],i))},t=!(13===this.type),i=new A.builder.FormattingModelBuilder(function(){return r.customizeFormattingCard(r.getCategoryAxisCard())},function(){return r.customizeFormattingCard(r.getValueAxisCard())},function(){return r.getSecondaryValueAxisCard()},function(){return r.getLegendCard()},function(){return r.getSmallMultiplesCard()},function(){return r.getGridlinesCard()},function(){return r.axisZoom.getZoomCard(t)}).build(),a=i&&i.cards?i.cards:[],s=this.getLayers(),o={categoryAxisData:this.originalCartesianData.axesData.categoryAxis},n=[],l=0,c=s;l<c.length;l++){var u=c[l];if(!u.getFormattingCards)return;n.push(u.getFormattingCards(o))}A.ComboChart.isComboChart(this.type)||n.length,A.ComboChart.isComboChart(this.type)?(s=A.ComboChart.sortComboChartFormattingCards(A.ComboChart.mergeFormattingCards(n,this.type,e),this.type,this.featureSwitches.comboChartError),a.push.apply(a,s)):1===n.length?a.push.apply(a,n[0].card):n.length;s=A.visualBackgroundHelper.getBackgroundCard(this.background,e);return s&&a.push(s),i},v.prototype.customizeFormattingCard=function(e){for(var t=e,i=0,a=this.getLayers();i<a.length;i++){var r=a[i];return t=r.customizeFormattingCard?r.customizeFormattingCard(e):t}},v.prototype.resolveFormattingPlaceholder=function(e){if(A.builder.isVisualFormattingSlicePlaceholder(e)){var t=e.name;if("responsive"===t)return this.getResponsiveSlice();for(var i=0,a=this.getLayers();i<a.length;i++){var r=a[i],r=r.resolveFormattingPlaceholder&&r.resolveFormattingPlaceholder(e);if(r)return r}}},v.prototype.getResponsiveSlice=function(){function e(e){return t.hostServices.getLocalizedString(e)}var t=this,i=this.supportsResponsive(),a=this.dataViews&&this.dataViews[0];if(a)return this.smallMultiplesViewModelAdapter?this.smallMultiplesViewModelAdapter.getResponsiveSlice(a,i,e):this.viewModelAdapterFactory?this.viewModelAdapterFactory.createCartesianAdapter({cartesianData:void 0,dataView:a,viewport:void 0,isCoreMultiple:void 0}).getResponsiveSlice(a,i,e):void 0},v.prototype.getCategoryAxisCard=function(){var a,s,o,r,e,n,l,t,i,c,u,d,h=this,p=this.axes;if(p.hasCategoryAxis())return a=function(e){return h.hostServices.getLocalizedString(e)},s=A.cartesianChartProps.categoryAxis,o=this.originalCartesianData.axesData.categoryAxis,r=p.isYAxisCategorical,e=r?"Visual_YAxis_Hyphen":"Visual_XAxis_Hyphen",e=new A.builder.FormattingCardBuilder(new A.builder.FormattingCardUidBuilder("categoryAxis"),e,[s.show,s.axisType,s.start,s.end,s.fontFamily,s.fontSize,s.bold,s.italic,s.underline,s.labelColor,s.labelDisplayUnits,s.labelPrecision,s.maxMarginFactor,s.position,s.showAxisTitle,s.titleText,s.axisStyle,s.titleFontFamily,s.titleFontSize,s.titleBold,s.titleItalic,s.titleUnderline,s.titleColor,s.concatenateLabels,s.show,s.invertAxis,s.axisScale,s.logAxisScale,s.switchAxisPosition],a),e.addTopLevelToggle("show",function(){return new A.builder.ToggleSwitchBuilder({descriptor:s.show,value:o.show}).build()}),i=this.categoryAxisIsScalar(),n=i.isScalar,i.supportedType===A.axisType.both&&e.addGroup("type",function(e){e.addSimpleSlice("type",new A.builder.DropdownBuilder({descriptor:s.axisType,value:n?A.axisType.scalar:A.axisType.categorical}).build())}),n&&e.addGroup("range",function(e){e.withDisplayName("Visual_Axis_Range");var t,i,a=_.filter(o.includeDomains,function(e){return _.includes(e.domainSources,10)}),a=A.AxisHelper.mergeScalarAxisDomains.apply(A.AxisHelper,a||[]),a=a&&a.domain||[void 0,void 0],r=a[0],a=a[1];p.isCategoryAxisDateTime()?(i=r&&H.FeatureSwitchedDate.fromTimeValue(h.featureSwitches.utcDates,r),t=a&&H.FeatureSwitchedDate.fromTimeValue(h.featureSwitches.utcDates,a),e.addSimpleSlice("min",new A.builder.DatePickerBuilder({descriptor:__assign(__assign({},s.start),{propertyTypes:{dateTime:!0},instanceKind:h.featureSwitches.expressionBasedFormatting?3:1}),value:i,placeholder:"",validators:{max:{type:1,value:t}}}).build(),function(e){return e.withCustomDisplayName("Visual_Gradient_MinValue")}).addSimpleSlice("max",new A.builder.DatePickerBuilder({descriptor:__assign(__assign({},s.end),{propertyTypes:{dateTime:!0},instanceKind:h.featureSwitches.expressionBasedFormatting?3:1}),value:t,placeholder:"",validators:{min:{type:0,value:i}}}).build(),function(e){return e.withCustomDisplayName("Visual_Gradient_MaxValue")})):e.addSimpleSlice("min",new A.builder.NumUpDownBuilder({descriptor:__assign(__assign({},s.start),{propertyTypes:{numeric:!0},instanceKind:h.featureSwitches.expressionBasedFormatting?3:1}),value:r,options:{maxValue:{type:1,value:a}}}).build(),function(e){return e.withCustomDisplayName("Visual_Gradient_MinValue")}).addSimpleSlice("max",new A.builder.NumUpDownBuilder({descriptor:__assign(__assign({},s.end),{propertyTypes:{numeric:!0},instanceKind:h.featureSwitches.expressionBasedFormatting?3:1}),value:a,options:{minValue:{type:0,value:r}}}).build(),function(e){return e.withCustomDisplayName("Visual_Gradient_MaxValue")}),h.featureSwitches.logAxisScale?e.addSimpleSlice("logAxisScale",new A.builder.ToggleSwitchBuilder({descriptor:s.logAxisScale,value:null!=(t=o.logAxisScale)?t:o.axisScale===A.axisScale.log}).build(),function(e){return e.withDisabled(!h.isLogAxisScaleAllowed(!1)).withCustomDescriptionIf(function(){return!h.isLogAxisScaleAllowed(!1)},"Visual_LogarithmicScaleDescription")}):(i=h.getAxisScaleOptions(!1),e.addSimpleSlice("axisType",new A.builder.DropdownBuilder({descriptor:s.axisScale,value:o.axisScale,filterValues:i}).build())),h.featureSwitches.invertAxis&&e.addSimpleSlice("invertAxis",new A.builder.ToggleSwitchBuilder({descriptor:s.invertAxis,value:o.invertAxis}).build(),function(e){return e.withCustomDisplayName("Visual_InvertRange")})}),l=o.labelFontProperties,t=o.titleFontProperties,i=(new A.builder.FontControlBuilder).withFontFamily({descriptor:s.fontFamily,value:l.family}).withFontSizeProperties({descriptor:s.fontSize,value:l.size.pt}),c=(new A.builder.FontControlBuilder).withFontFamily({descriptor:s.titleFontFamily,value:t.family}).withFontSizeProperties({descriptor:s.titleFontSize,value:t.size.pt}),this.featureSwitches.enableBIU&&(i.withBold({descriptor:s.bold,value:l.weight===g.boldValue}).withItalic({descriptor:s.italic,value:l.style===g.italicValue}).withUnderline({descriptor:s.underline,value:l.textDecoration===g.underlineValue}),c.withBold({descriptor:s.titleBold,value:t.weight===g.boldValue}).withItalic({descriptor:s.titleItalic,value:t.style===g.italicValue}).withUnderline({descriptor:s.titleUnderline,value:t.textDecoration===g.underlineValue})),u=i.build(),d=c.build(),e.addGroup(n?"valuesScalar":"values",function(e){var t,i;e.withDisplayName("Role_DisplayName_Values").addCompositeSlice("font","Font",u).addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:__assign(__assign({},s.labelColor),{instanceKind:h.featureSwitches.expressionBasedFormatting?3:1}),value:{value:l.color}}).build()),n?e.addSimpleSlice("displayUnits",new A.builder.DropdownBuilder({descriptor:s.labelDisplayUnits,value:o.labelDisplayUnits}).build(),function(e){return e.withAliasName("Decimal")}).addSimpleSlice("precision",new A.builder.NumUpDownBuilder({descriptor:s.labelPrecision,value:o.labelPrecision,options:{minValue:{type:0,value:0},maxValue:{type:1,value:A.DataLabelViewModel.MaxLabelPrecision}}}).build()):(i=r?"Visual_Max_AreaWidth":"Visual_Max_AreaHeight",e.addSimpleSlice(r?"maxAreaWidth":"maxAreaHeight",new A.builder.SliderBuilder({descriptor:s.maxMarginFactor,value:Math.round(100*o.maxMarginFactor),options:{minValue:{type:0,value:15},maxValue:{type:1,value:50},unitSymbol:A.visualLocKeys.PercentLocKey},localize:a}).build(),function(e){return e.withCustomDisplayName(i)})),r&&(h.featureSwitches.switchAxisPosition?e.addSimpleSlice("switchAxisPosition",new A.builder.ToggleSwitchBuilder({descriptor:s.switchAxisPosition,value:o.switchAxisPosition}).build(),function(e){return e.withCustomDisplayName("Visual_SwitchAxisPosition")}):e.addSimpleSlice("position",new A.builder.DropdownBuilder({descriptor:s.position,value:o.position}).build())),null!=(t=h.cartesianVisualCapabilities)&&t.supportsHierarchicalCategoryAxis&&!n&&e.addSimpleSlice("concatenateLabels",new A.builder.ToggleSwitchBuilder({descriptor:s.concatenateLabels,value:o.concatenateLabels}).build())}).addGroup("title",function(e){e.withDisplayName("Visual_Title").withInheritDisabled(!1).addTopLevelToggle("show",function(){return new A.builder.ToggleSwitchBuilder({descriptor:s.showAxisTitle,value:o.showAxisTitle}).build()}).addSimpleSlice("text",new A.builder.TextInputBuilder({descriptor:s.titleText,value:o.titleText,placeholder:""}).build(),function(e){return e.withCustomDisplayName("Visual_Title_Text")}).addSimpleSlice("style",function(){var e=p.categoryAxisHasUnitType?[A.axisStyle.showTitleOnly,A.axisStyle.showUnitOnly,A.axisStyle.showBoth]:[A.axisStyle.showTitleOnly];return new A.builder.DropdownBuilder({descriptor:s.axisStyle,value:o.axisStyle,filterValues:e}).build()}).addCompositeSlice("font","Font",d).addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:__assign(__assign({},s.titleColor),{instanceKind:h.featureSwitches.expressionBasedFormatting?3:1}),value:{value:t.color}}).build(),function(e){return e.withCustomDisplayName("Generic_Color")})}),e.build()},v.prototype.getValueAxisCard=function(){var a,r,s,t,i,o,e,n,l,c,u=this,d=null==(d=this.originalCartesianData)?void 0:d.axesData;if(d&&d.isValueAxisSet&&!d.isValueAxisDisabled&&9!==this.type)return a=this.axes,r=A.cartesianChartProps.valueAxis,s=this.originalCartesianData.axesData.valueAxis,d=(t=a.isYAxisCategorical)?"Visual_XAxis_Hyphen":"Visual_YAxis_Hyphen",d=new A.builder.FormattingCardBuilder(new A.builder.FormattingCardUidBuilder("valueAxis"),d,[r.show,r.start,r.end,r.axisScale,r.invertAxis,r.sharedAxis,r.scaleToFit,r.fontFamily,r.fontSize,r.bold,r.italic,r.underline,r.labelColor,r.labelDisplayUnits,r.labelPrecision,r.position,r.showAxisTitle,r.titleText,r.axisStyle,r.titleFontFamily,r.titleFontSize,r.titleBold,r.titleItalic,r.titleUnderline,r.titleColor,r.logAxisScale,r.switchAxisPosition],function(e){return u.hostServices.getLocalizedString(e)}),i=s.labelFontProperties,o=s.titleFontProperties,e=(new A.builder.FontControlBuilder).withFontFamily({descriptor:r.fontFamily,value:i.family}).withFontSizeProperties({descriptor:r.fontSize,value:i.size.pt}),n=(new A.builder.FontControlBuilder).withFontFamily({descriptor:r.titleFontFamily,value:o.family}).withFontSizeProperties({descriptor:r.titleFontSize,value:o.size.pt}),this.featureSwitches.enableBIU&&(e.withBold({descriptor:r.bold,value:s.labelBold}).withItalic({descriptor:r.italic,value:s.labelItalic}).withUnderline({descriptor:r.underline,value:s.labelUnderline}),n.withBold({descriptor:r.titleBold,value:s.titleBold}).withItalic({descriptor:r.titleItalic,value:s.titleItalic}).withUnderline({descriptor:r.titleUnderline,value:s.titleUnderline})),l=e.build(),c=n.build(),d.addTopLevelToggle("show",function(){return new A.builder.ToggleSwitchBuilder({descriptor:r.show,value:s.show}).build()}).addGroup("range",function(e){var t=_.filter(s.includeDomains,function(e){return _.includes(e.domainSources,10)}),t=A.AxisHelper.mergeScalarAxisDomains.apply(A.AxisHelper,t||[]),t=t&&t.domain||[void 0,void 0],i=t[0],t=t[1];e.withDisplayName("Visual_Axis_Range").withInheritDisabled(!1).addSimpleSlice("min",new A.builder.NumUpDownBuilder({descriptor:__assign(__assign({},r.start),{propertyTypes:{numeric:!0},instanceKind:u.featureSwitches.expressionBasedFormatting?3:1}),value:i,options:{maxValue:{type:1,value:t}}}).build(),function(e){return e.withCustomDisplayName("Visual_Gradient_MinValue")}).addSimpleSlice("max",new A.builder.NumUpDownBuilder({descriptor:__assign(__assign({},r.end),{propertyTypes:{numeric:!0},instanceKind:u.featureSwitches.expressionBasedFormatting?3:1}),value:t,options:{minValue:{type:0,value:i}}}).build(),function(e){return e.withCustomDisplayName("Visual_Gradient_MaxValue")}),13!==u.type&&(u.featureSwitches.logAxisScale?e.addSimpleSlice("logAxisScale",new A.builder.ToggleSwitchBuilder({descriptor:r.logAxisScale,value:s.logAxisScale}).build(),function(e){return e.withDisabled(!u.isLogAxisScaleAllowed(!0)).withCustomDescriptionIf(function(){return!u.isLogAxisScaleAllowed(!0)},"Visual_LogarithmicScaleDescription")}):(t=u.getAxisScaleOptions(!0),e.addSimpleSlice("axisType",new A.builder.DropdownBuilder({descriptor:r.axisScale,value:s.axisScale,filterValues:t}).build()))),u.featureSwitches.invertAxis&&e.addSimpleSlice("invertAxis",new A.builder.ToggleSwitchBuilder({descriptor:r.invertAxis,value:s.invertAxis}).build(),function(e){return e.withCustomDisplayName("Visual_InvertRange")}),u.isSmallMultiples()&&u.featureSwitches.smallMultiplesUnsharedAxes&&e.addSimpleSlice("sharedAxis",new A.builder.ToggleSwitchBuilder({descriptor:r.sharedAxis,value:s.sharedAxis}).build(),function(e){a.isYAxisCategorical&&e.withCustomDisplayName("Visual_Shared_XAxis")}).addSimpleSlice("scaleToFit",new A.builder.ToggleSwitchBuilder({descriptor:r.scaleToFit,value:s.scaleToFit}).build(),function(e){return e.withDisabled(s.sharedAxis)})}).addGroup("values",function(e){e.withDisplayName("Role_DisplayName_Values").addCompositeSlice("font","Font",l).addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:__assign(__assign({},r.labelColor),{instanceKind:u.featureSwitches.expressionBasedFormatting?3:1}),value:{value:i.color}}).build()),7!==u.type&&8!==u.type&&e.addSimpleSlice("displayUnits",new A.builder.DropdownBuilder({descriptor:r.labelDisplayUnits,value:s.labelDisplayUnits}).build(),function(e){return e.withAliasName("Decimal")}).addSimpleSlice("precision",new A.builder.NumUpDownBuilder({descriptor:r.labelPrecision,value:s.labelPrecision,options:{minValue:{type:0,value:0},maxValue:{type:1,value:A.DataLabelViewModel.MaxLabelPrecision}}}).build()),t||(u.featureSwitches.switchAxisPosition?e.addSimpleSlice("switchAxisPosition",new A.builder.ToggleSwitchBuilder({descriptor:r.switchAxisPosition,value:s.switchAxisPosition}).build(),function(e){return e.withCustomDisplayName("Visual_SwitchAxisPosition")}):e.addSimpleSlice("position",new A.builder.DropdownBuilder({descriptor:r.position,value:s.position}).build()))}).addGroup("title",function(e){e.withDisplayName("Visual_Title").withInheritDisabled(!1).addTopLevelToggle("show",function(){return new A.builder.ToggleSwitchBuilder({descriptor:r.showAxisTitle,value:s.showAxisTitle}).build()}).addSimpleSlice("text",new A.builder.TextInputBuilder({descriptor:r.titleText,value:s.titleText,placeholder:""}).build(),function(e){return e.withCustomDisplayName("Visual_Title_Text")}).addSimpleSlice("style",function(){var e=a.valueAxisHasUnitType?[A.axisStyle.showTitleOnly,A.axisStyle.showUnitOnly,A.axisStyle.showBoth]:[A.axisStyle.showTitleOnly];return new A.builder.DropdownBuilder({descriptor:r.axisStyle,value:s.axisStyle,filterValues:e}).build()}).addCompositeSlice("font","Font",c).addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:__assign(__assign({},r.titleColor),{instanceKind:u.featureSwitches.expressionBasedFormatting?3:1}),value:{value:o.color}}).build(),function(e){return e.withCustomDisplayName("Generic_Color")})}),d.build()},v.prototype.getSecondaryValueAxisCard=function(){var e,t,a,i,r,s,o,n,l,c,u,d,h=this,p=null==(p=this.originalCartesianData)?void 0:p.axesData;if(p&&p.isValueAxisSet&&!p.isValueAxisDisabled){switch(this.type){case 0:case 1:e=!0,t=A.cartesianChartProps.y2Axis.show,a=A.cartesianChartProps.y2Axis;break;case 14:case 15:case 16:case 17:e=!0,t=A.cartesianChartProps.valueAxis.secShow,a=A.cartesianChartProps.valueAxis;break;default:e=!1}if(e)return i=this.axes,r=this.originalCartesianData.axesData,s=r.y2,p=new A.builder.FormattingCardBuilder(new A.builder.FormattingCardUidBuilder("y2Axis"),"Visual_Y2Axis_Hyphen",__assign(__assign({},a),{alignZeros:A.cartesianChartProps.valueAxis.alignZeros}),function(e){return h.hostServices.getLocalizedString(e)}),o=s.labelFontProperties,n=s.titleFontProperties,l=(new A.builder.FontControlBuilder).withFontFamily({descriptor:a.secFontFamily,value:o.family}).withFontSizeProperties({descriptor:a.secFontSize,value:o.size.pt}),c=(new A.builder.FontControlBuilder).withFontFamily({descriptor:a.secTitleFontFamily,value:n.family}).withFontSizeProperties({descriptor:a.secTitleFontSize,value:n.size.pt}),this.featureSwitches.enableBIU&&(l.withBold({descriptor:a.secBold,value:s.labelBold}).withItalic({descriptor:a.secItalic,value:s.labelItalic}).withUnderline({descriptor:a.secUnderline,value:s.labelUnderline}),c.withBold({descriptor:a.secTitleBold,value:s.titleBold}).withItalic({descriptor:a.secTitleItalic,value:s.titleItalic}).withUnderline({descriptor:a.secTitleUnderline,value:s.titleUnderline})),u=l.build(),d=c.build(),p.addTopLevelToggle("show",function(){return new A.builder.ToggleSwitchBuilder({descriptor:t,value:s.show}).build()}).addGroup("range",function(e){var t=_.filter(s.includeDomains,function(e){return _.includes(e.domainSources,10)}),t=A.AxisHelper.mergeScalarAxisDomains.apply(A.AxisHelper,t||[]),t=t&&t.domain||[void 0,void 0],i=t[0],t=t[1];e.withDisplayName("Visual_Axis_Range").addSimpleSlice("min",new A.builder.NumUpDownBuilder({descriptor:__assign(__assign({},a.secStart),{instanceKind:h.featureSwitches.expressionBasedFormatting?3:1}),value:i,options:{maxValue:{type:1,value:t}}}).build(),function(e){return e.withCustomDisplayName("Visual_Gradient_MinValue")}).addSimpleSlice("max",new A.builder.NumUpDownBuilder({descriptor:__assign(__assign({},a.secEnd),{instanceKind:h.featureSwitches.expressionBasedFormatting?3:1}),value:t,options:{minValue:{type:0,value:i}}}).build(),function(e){return e.withCustomDisplayName("Visual_Gradient_MaxValue")}),h.featureSwitches.logAxisScale?e.addSimpleSlice("logAxisScale",new A.builder.ToggleSwitchBuilder({descriptor:a.secLogAxisScale,value:s.logAxisScale}).build(),function(e){return e.withDisabled(!h.isLogAxisScaleAllowed(!0,!0)).withCustomDescriptionIf(function(){return!h.isLogAxisScaleAllowed(!0,!0)},"Visual_LogarithmicScaleDescription")}):(t=h.getAxisScaleOptions(!0,!0),e.addSimpleSlice("axisType",new A.builder.DropdownBuilder({descriptor:a.secAxisScale,value:s.axisScale,filterValues:t}).build())),A.ComboChart.isComboChart(h.type)&&e.addSimpleSlice("alignZeroes",new A.builder.ToggleSwitchBuilder({descriptor:A.cartesianChartProps.valueAxis.alignZeros,value:r.valueAxis.alignZeros}).build())}).addGroup("values",function(e){e.withDisplayName("Role_DisplayName_Values").addCompositeSlice("font","Font",u).addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:a.secLabelColor,value:{value:o.color}}).build()),7!==h.type&&8!==h.type&&e.addSimpleSlice("displayUnits",new A.builder.DropdownBuilder({descriptor:a.secLabelDisplayUnits,value:s.labelDisplayUnits}).build(),function(e){return e.withAliasName("Decimal")}).addSimpleSlice("precision",new A.builder.NumUpDownBuilder({descriptor:a.secLabelPrecision,value:s.labelPrecision,options:{minValue:{type:0,value:0},maxValue:{type:1,value:A.DataLabelViewModel.MaxLabelPrecision}}}).build())}).addGroup("title",function(e){e.withDisplayName("Visual_Title").withInheritDisabled(!1).addTopLevelToggle("show",function(){return new A.builder.ToggleSwitchBuilder({descriptor:a.secShowAxisTitle,value:s.showAxisTitle}).build()}).addSimpleSlice("text",new A.builder.TextInputBuilder({descriptor:a.secTitleText,value:s.titleText,placeholder:""}).build(),function(e){return e.withCustomDisplayName("Visual_Title_Text")}).addSimpleSlice("style",function(){var e=i.valueAxisHasUnitType?[A.axisStyle.showTitleOnly,A.axisStyle.showUnitOnly,A.axisStyle.showBoth]:[A.axisStyle.showTitleOnly];return new A.builder.DropdownBuilder({descriptor:a.secAxisStyle,value:s.axisStyle,filterValues:e}).build()}).addCompositeSlice("font","Font",d).addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:a.secTitleColor,value:{value:n.color}}).build(),function(e){return e.withCustomDisplayName("Generic_Color")})}),p.build()}},v.prototype.getLegendCard=function(){for(var e={legendData:this.originalCartesianData.legendData},t=0,i=this.getLayers();t<i.length;t++){var a=i[t];a.customizeLegendFormattingModelOptions&&(e=a.customizeLegendFormattingModelOptions(e))}var r=this.featureSwitches.onObject?"Visual_LegendCard_DisabledReasonNew":14===this.type?"Visual_LegendCard_ComboLineClustered_DisabledReason":15===this.type?"Visual_LegendCard_ComboLineStacked_DisabledReason":"Visual_LegendCard_DisabledReason";return A.Legend.getLegendFormattingModel(e,this.hostServices,this.featureSwitches,!this.shouldShowLegendCard(),r)},v.prototype.getGridlinesCard=function(){var t,i,a,r,s=this,e=this.axes,o=e.hasCategoryAxis(),e=e.isYAxisCategorical,n=this.originalCartesianData.axesData,l=3===this.categoryAxisRenderMode,l=this.categoryAxisIsScalar().isScalar||l,o=(e?(t=A.cartesianChartProps.categoryAxis,i=n.categoryAxis,o&&(a=A.cartesianChartProps.valueAxis,9!==this.type&&(r=n.valueAxis))):(t=A.cartesianChartProps.valueAxis,9!==this.type&&(i=n.valueAxis),o&&13!==this.type&&(a=A.cartesianChartProps.categoryAxis,r=n.categoryAxis)),new A.builder.FormattingCardBuilder(new A.builder.FormattingCardUidBuilder("gridlines"),"Visual_Gridline_Show",[A.cartesianChartProps.categoryAxis.gridlineShow,A.cartesianChartProps.categoryAxis.gridlineStyle,A.cartesianChartProps.categoryAxis.gridlineColor,A.cartesianChartProps.categoryAxis.gridlineThickness,A.cartesianChartProps.valueAxis.gridlineShow,A.cartesianChartProps.valueAxis.gridlineStyle,A.cartesianChartProps.valueAxis.gridlineColor,A.cartesianChartProps.valueAxis.gridlineThickness],function(e){return s.hostServices.getLocalizedString(e)}));return 9!==this.type||l?((i&&!e||e&&l)&&o.addGroup("horizontal",function(e){return c(e,t,i,"Visual_LabelOrientation_Horizontal",s.featureSwitches)}),(r&&e||!e&&l)&&o.addGroup("vertical",function(e){return c(e,a,r,"Visual_LabelOrientation_Vertical",s.featureSwitches)})):o.withDisabled(!0,"Visual_Ribbon_Chart_Gridlines_DisabledReason"),o.build();function c(e,t,i,a,r){e.withDisplayName(a).addTopLevelToggle("show",function(){return new A.builder.ToggleSwitchBuilder({descriptor:t.gridlineShow,value:!!i.show&&i.gridlineShow}).build()},function(e){return e.withDisabled(!i.show)}).addSimpleSlice("style",new A.builder.DropdownBuilder({descriptor:t.gridlineStyle,value:i.gridlineStyle}).build(),function(e){return e.withCustomDisplayName("Style")}).addSimpleSlice("color",new A.builder.ColorPickerBuilder({descriptor:__assign(__assign({},t.gridlineColor),{instanceKind:r.expressionBasedFormatting?3:1}),value:{value:i.gridlineColor}}).build(),function(e){return e.withCustomDisplayName("Generic_Color")}).addSimpleSlice("width",new A.builder.NumUpDownBuilder({descriptor:t.gridlineThickness,value:i.gridlineThickness,options:{minValue:{type:0,value:1},maxValue:{type:1,value:4},unitSymbol:A.visualLocKeys.PixelUnitSymbol}}).build(),function(e){return e.withCustomDisplayName("Visual_General_Properties_Width")})}},v.prototype.getTelemetryInformation=function(){for(var e,t={},i=(this.isSmallMultiples()&&(e=v.getMultiplesLayout(this.dataViews[0].metadata.objects,this.layerStyle),t.smallMultiples={layout:{type:e.layoutType,rows:e.rowCount,columns:e.columnCount}}),this.getLayers()),a=0;a<i.length;a++){var r=i[a];!_.isFunction(r.getTelemetryInformation)||(r=r.getTelemetryInformation())&&(t[a.toString()]=r)}if(!_.isEmpty(t))return t},v.prototype.getLayers=function(){var e=this.multiples.getCoreMultiple();return 1&e.getState()?e.layers:[]},v.prototype.enumerateReferenceLines=function(e,t,i){var a=A.ColorHelper.getDataColorByIndex(this.layerStyle,0,A.ForegroundColorName),r=_.filter(this.originalCartesianData.referenceLines,function(e){return e.type===t});A.ReferenceLineHelper.enumerateObjectInstances(e,r,a,t,this.originalCartesianData.axesData.isValueAxisDisabled,i,this.featureSwitches)},v.prototype.shouldShowLegendCard=function(){var e,t=null==(e=this.multiples.getCoreMultiple())?void 0:e.layers,i=this.dataViews;if(this.cartesianData.legendData.isGradientLegend)return!0;if(t&&i)for(var a=t.length,r=0,s=0;s<a;s++){if(t[s].hasLegend())return!0;var o=i[s];if(o&&o.categorical&&o.categorical.values&&0<o.categorical.values.length&&1<++r)return!0}return!1},v.prototype.getAxisScaleOptions=function(e,t){void 0===t&&(t=!1);var i=this.axes.isYAxisCategorical,e=(e=void 0===e?!1:e)?i?0:t?2:1:i?1:0,t=[A.DEFAULT_AXIS_SCALE_TYPE];return this.axes.isLogScaleAllowed(e)&&t.push(A.axisScale.log),t},v.prototype.isLogAxisScaleAllowed=function(e,t){void 0===t&&(t=!1);var i=this.axes.isYAxisCategorical,e=(e=void 0===e?!1:e)?i?0:t?2:1:i?1:0;return this.axes.isLogScaleAllowed(e)},v.prototype.categoryAxisIsScalar=function(){var e=this.originalCartesianData.axesData.categoryAxis,t=3===this.categoryAxisRenderMode?A.axisType.categorical:A.axisType.both,i=!1,a=null==(a=this.multiples.getCoreMultiple())?void 0:a.layers;return{isScalar:i=t===A.axisType.both&&a&&a[0].getSupportedCategoryAxisType?(t=a[0].getSupportedCategoryAxisType())===A.axisType.scalar||(i=A.CartesianHelper.isScalar(t===A.axisType.both,e))&&(a&&a[0].getVisualCategoryAxisIsScalar?a[0].getVisualCategoryAxisIsScalar():0===this.categoryAxisRenderMode):i,supportedType:t}},v.prototype.enumerateCategoryAxis=function(e){var t,i,a,r,s,o,n,l,c=this;this.originalCartesianData&&this.originalCartesianData.axesData&&this.originalCartesianData.axesData.isCategoryAxisSet&&(t=this.originalCartesianData.axesData.categoryAxis,i=A.cartesianChartProps.categoryAxis,a=3===this.categoryAxisRenderMode,r=(o=this.categoryAxisIsScalar()).isScalar,o=o.supportedType,(s={selector:null,properties:{},objectName:"categoryAxis",validValues:{axisScale:this.getAxisScaleOptions(!1),axisStyle:this.axes.categoryAxisHasUnitType?[A.axisStyle.showTitleOnly,A.axisStyle.showUnitOnly,A.axisStyle.showBoth]:[A.axisStyle.showTitleOnly]},propertyTypes:{},propertyInstanceKind:{start:this.featureSwitches.expressionBasedFormatting?3:1,end:this.featureSwitches.expressionBasedFormatting?3:1,titleColor:this.featureSwitches.expressionBasedFormatting?3:1,gridlineColor:this.featureSwitches.expressionBasedFormatting?3:1,labelColor:this.featureSwitches.expressionBasedFormatting?3:1}}).properties[i.show.propertyName]=t.show,this.axes.isYAxisCategorical&&(this.featureSwitches.switchAxisPosition?s.properties[i.switchAxisPosition.propertyName]=t.switchAxisPosition:s.properties[i.position.propertyName]=t.position),o===A.axisType.both&&(s.properties[i.axisType.propertyName]=r?A.axisType.scalar:A.axisType.categorical),r&&(this.featureSwitches.logAxisScale&&this.isLogAxisScaleAllowed(!1)?s.properties[i.logAxisScale.propertyName]=null!=(o=t.logAxisScale)?o:t.axisScale===A.axisScale.log:s.properties[i.axisScale.propertyName]=t.axisScale,o=_.filter(t.includeDomains,function(e){return _.includes(e.domainSources,10)}),l=(o=(o=A.AxisHelper.mergeScalarAxisDomains.apply(A.AxisHelper,o||[]))&&o.domain||[void 0,void 0])[0],o=o[1],s.properties[i.start.propertyName]=l,s.properties[i.end.propertyName]=o,this.featureSwitches.invertAxis&&(s.properties[i.invertAxis.propertyName]=t.invertAxis)),s.properties[i.labelColor.propertyName]=A.AxisDataModel.toColorFill(t.labelFontProperties.color),s.properties[i.fontSize.propertyName]=t.labelFontProperties.size.pt,s.properties[i.fontFamily.propertyName]=t.labelFontProperties.family,this.featureSwitches.enableBIU&&(s.properties[i.bold.propertyName]=t.labelBold,s.properties[i.italic.propertyName]=t.labelItalic,s.properties[i.underline.propertyName]=t.labelUnderline),r&&(s.properties[i.labelDisplayUnits.propertyName]=t.labelDisplayUnits,s.properties[i.labelPrecision.propertyName]=t.labelPrecision,l={numberRange:{min:0,max:A.DataLabelViewModel.MaxLabelPrecision}},s.validValues[i.labelPrecision.propertyName]=l),this.axes.isCategoryAxisDateTime()?(s.propertyTypes[i.start.propertyName]={dateTime:!0},s.propertyTypes[i.end.propertyName]={dateTime:!0}):(s.propertyTypes[i.start.propertyName]={numeric:!0},s.propertyTypes[i.end.propertyName]={numeric:!0}),r||(s.properties[i.preferredCategoryWidth.propertyName]=t.preferredCategoryWidth,s.properties[i.maxMarginFactor.propertyName]=Math.round(100*t.maxMarginFactor),s.validValues[i.maxMarginFactor.propertyName]={numberRange:{min:15,max:50},unitSymbol:"Slider_Percent"},9!==this.type&&(n=t.innerPadding,s.properties[i.innerPadding.propertyName]=void 0!==n?Math.round(100*n):void 0,s.validValues[i.innerPadding.propertyName]={numberRange:{min:0,max:50},unitSymbol:"Slider_Percent"})),_.find([9,10],function(e){return e===c.type})||(n=t.innerPadding,s.properties[i.innerPadding.propertyName]=void 0!==n?Math.round(100*n):void 0,s.validValues[i.innerPadding.propertyName]={numberRange:{min:0,max:50},unitSymbol:"Slider_Percent"}),null!=(o=this.cartesianVisualCapabilities)&&o.supportsHierarchicalCategoryAxis&&!r&&(l=i.concatenateLabels.propertyName,s.properties[l]=t.concatenateLabels),s.properties[i.showAxisTitle.propertyName]=t.showAxisTitle,s.properties[i.showAxisTitle.propertyName]&&(s.properties[i.axisStyle.propertyName]=t.axisStyle,s.properties[i.titleColor.propertyName]=A.AxisDataModel.toColorFill(t.titleFontProperties.color),s.properties[i.titleText.propertyName]=t.titleText,s.properties[i.titleFontSize.propertyName]=t.titleFontProperties.size.pt,s.properties[i.titleFontFamily.propertyName]=t.titleFontProperties.family,this.featureSwitches.enableBIU&&(s.properties[i.titleBold.propertyName]=t.titleBold,s.properties[i.titleItalic.propertyName]=t.titleItalic,s.properties[i.titleUnderline.propertyName]=t.titleUnderline)),(r||a)&&(s.properties[i.gridlineShow.propertyName]=t.gridlineShow,t.gridlineShow&&(s.properties[i.gridlineColor.propertyName]=A.AxisDataModel.toColorFill(t.gridlineColor),s.properties[i.gridlineThickness.propertyName]=t.gridlineThickness,s.validValues.gridlineThickness=["1","2","3","4"],s.properties[i.gridlineStyle.propertyName]=t.gridlineStyle)),e.pushInstance(s))},v.prototype.enumerateValueAxis=function(e,t){var i,a,r,s,o,n;void 0===t&&(t="valueAxis"),this.originalCartesianData&&this.originalCartesianData.axesData&&this.originalCartesianData.axesData.isValueAxisSet&&!this.originalCartesianData.axesData.isValueAxisDisabled&&("y2Axis"===t&&2===this.type||(i={numberRange:{min:0,max:A.DataLabelViewModel.MaxLabelPrecision}},o=this.originalCartesianData.axesData.valueAxis,n="y2Axis"===t,a=A.cartesianChartProps.valueAxis,t={selector:null,properties:{},objectName:t,validValues:{axisScale:this.getAxisScaleOptions(!0),secAxisScale:this.getAxisScaleOptions(!0,!0),axisStyle:this.axes.valueAxisHasUnitType?[A.axisStyle.showTitleOnly,A.axisStyle.showUnitOnly,A.axisStyle.showBoth]:[A.axisStyle.showTitleOnly],secAxisStyle:this.axes.secondaryValueAxisHasUnitType?[A.axisStyle.showTitleOnly,A.axisStyle.showUnitOnly,A.axisStyle.showBoth]:[A.axisStyle.showTitleOnly]},propertyTypes:{},propertyInstanceKind:{start:this.featureSwitches.expressionBasedFormatting?3:1,end:this.featureSwitches.expressionBasedFormatting?3:1,titleColor:this.featureSwitches.expressionBasedFormatting?3:1,gridlineColor:this.featureSwitches.expressionBasedFormatting?3:1,labelColor:this.featureSwitches.expressionBasedFormatting?3:1,secStart:this.featureSwitches.expressionBasedFormatting?3:1,secEnd:this.featureSwitches.expressionBasedFormatting?3:1}},n||(t.properties[a.show.propertyName]=o.show,t.properties[a.axisLabel.propertyName]=o.axisLabel,this.axes.isYAxisCategorical||(this.featureSwitches.switchAxisPosition?t.properties[a.switchAxisPosition.propertyName]=o.switchAxisPosition:t.properties[a.position.propertyName]=o.position),this.featureSwitches.logAxisScale&&this.isLogAxisScaleAllowed(!0)?t.properties[a.logAxisScale.propertyName]=o.logAxisScale:t.properties[a.axisScale.propertyName]=o.axisScale,s=_.filter(o.includeDomains,function(e){return _.includes(e.domainSources,10)}),r=(s=(s=A.AxisHelper.mergeScalarAxisDomains.apply(A.AxisHelper,s||[]))&&s.domain||[void 0,void 0])[0],s=s[1],t.properties[a.start.propertyName]=r,t.properties[a.end.propertyName]=s,t.propertyTypes[a.start.propertyName]={numeric:!0},t.propertyTypes[a.end.propertyName]={numeric:!0},this.featureSwitches.invertAxis&&(t.properties[a.invertAxis.propertyName]=o.invertAxis),t.properties[a.labelColor.propertyName]=A.AxisDataModel.toColorFill(o.labelFontProperties.color),t.properties[a.fontSize.propertyName]=o.labelFontProperties.size.pt,t.properties[a.fontFamily.propertyName]=o.labelFontProperties.family,this.featureSwitches.enableBIU&&(t.properties[a.bold.propertyName]=o.labelBold,t.properties[a.italic.propertyName]=o.labelItalic,t.properties[a.underline.propertyName]=o.labelUnderline),7!==this.type&&8!==this.type&&(t.properties[a.labelDisplayUnits.propertyName]=o.labelDisplayUnits,t.properties[a.labelPrecision.propertyName]=o.labelPrecision,t.validValues[a.labelPrecision.propertyName]=i),this.featureSwitches.waterfallTotals&&13===this.type&&!this.hasBreakdownRole()&&(t.properties[a.totalsEnabled.propertyName]=o.totalsEnabled),t.properties[a.showAxisTitle.propertyName]=o.showAxisTitle,t.properties[a.showAxisTitle.propertyName]&&(t.properties[a.axisStyle.propertyName]=o.axisStyle,t.properties[a.titleColor.propertyName]=A.AxisDataModel.toColorFill(o.titleFontProperties.color),t.properties[a.titleText.propertyName]=o.titleText,t.properties[a.titleFontSize.propertyName]=o.titleFontProperties.size.pt,t.properties[a.titleFontFamily.propertyName]=o.titleFontProperties.family,this.featureSwitches.enableBIU&&(t.properties[a.titleBold.propertyName]=o.titleBold,t.properties[a.titleItalic.propertyName]=o.titleItalic,t.properties[a.titleUnderline.propertyName]=o.titleUnderline)),t.properties[a.gridlineShow.propertyName]=o.gridlineShow,o.gridlineShow&&(t.properties[a.gridlineColor.propertyName]=A.AxisDataModel.toColorFill(o.gridlineColor),t.properties[a.gridlineThickness.propertyName]=o.gridlineThickness,t.validValues.gridlineThickness=["1","2","3","4"],t.properties[a.gridlineStyle.propertyName]=o.gridlineStyle)),r=this.originalCartesianData.axesData.y2,n?t.properties[a.show.propertyName]=r.show:t.properties[a.secShow.propertyName]=r.show,(s=n||A.ComboChart.isComboChart(this.type)&&r.show)&&!n&&(t.properties[a.alignZeros.propertyName]=o.alignZeros,t.properties.secAxisLabel=""),n=_.filter(r.includeDomains,function(e){return _.includes(e.domainSources,10)}),o=(n=(o=A.AxisHelper.mergeScalarAxisDomains.apply(A.AxisHelper,n||[]))&&o.domain||[void 0,void 0])[0],n=n[1],t.properties[a.secStart.propertyName]=o,t.properties[a.secEnd.propertyName]=n,t.propertyTypes[a.secStart.propertyName]={numeric:!0},t.propertyTypes[a.secEnd.propertyName]={numeric:!0},s&&(this.featureSwitches.invertAxis&&(t.properties[a.secInvertAxis.propertyName]=r.invertAxis),this.featureSwitches.logAxisScale&&this.isLogAxisScaleAllowed(!0,!0)?t.properties[a.secLogAxisScale.propertyName]=r.logAxisScale:t.properties[a.secAxisScale.propertyName]=r.axisScale,t.properties[a.secLabelColor.propertyName]=A.AxisDataModel.toColorFill(r.labelFontProperties.color),t.properties[a.secFontSize.propertyName]=r.labelFontProperties.size.pt,t.properties[a.secFontFamily.propertyName]=r.labelFontProperties.family,this.featureSwitches.enableBIU&&(t.properties[a.secBold.propertyName]=r.labelBold,t.properties[a.secItalic.propertyName]=r.labelItalic,t.properties[a.secUnderline.propertyName]=r.labelUnderline),t.properties[a.secLabelDisplayUnits.propertyName]=r.labelDisplayUnits,t.properties[a.secLabelPrecision.propertyName]=r.labelPrecision,t.validValues[a.secLabelPrecision.propertyName]=i),t.properties[a.secShowAxisTitle.propertyName]=r.showAxisTitle,s&&t.properties[a.secShowAxisTitle.propertyName]&&(t.properties[a.secAxisStyle.propertyName]=r.axisStyle,t.properties[a.secTitleColor.propertyName]=A.AxisDataModel.toColorFill(r.titleFontProperties.color),t.properties[a.secTitleText.propertyName]=r.titleText,t.properties[a.secTitleFontSize.propertyName]=r.titleFontProperties.size.pt,this.featureSwitches.enableBIU&&(t.properties[a.secTitleBold.propertyName]=r.titleBold,t.properties[a.secTitleItalic.propertyName]=r.titleItalic,t.properties[a.secTitleUnderline.propertyName]=r.titleUnderline),t.properties[a.secTitleFontFamily.propertyName]=r.titleFontProperties.family),e.pushInstance(t)))},v.prototype.onClearSelection=function(){this.hasSetData&&this.multiples.clearSelection(this.layout.getVisibleMultiples())},v.prototype.onRestoreSelection=function(e){return!!this.interactivityService&&this.interactivityService.restoreSelection(e.selection)},v.prototype.createLayers=function(){return this.layerFactory.createLayers({type:this.type,interactivityService:this.interactivityService,isScrollable:this.axes.isScrollable,tooltipsEnabled:this.tooltipsEnabled,featureSwitches:this.featureSwitches})},v.prototype.getLayerRendererInitOptions=function(e){var t=this;return{animator:e.animator,svg:e.axesRenderer.getLayerContainer(),labelsContext:e.axesRenderer.getDataLabelContainers().foreground,cartesianHost:{updateLegend:function(e){return t.legend.drawLegend(e,t.currentViewport,3===t.categoryAxisRenderMode)},triggerRender:function(e){return t.render(e,!1)}},scaleDetector:this.featureSwitches.removeScaleDetector?void 0:this.layout.svgScaleDetector,eventManager:this.eventManager,useManagedTabIndex:this.useManagedTabIndex()}},v.prototype.useManagedTabIndex=function(){return this.isSmallMultiples()},v.prototype.onDataViewObjectChanged=function(e,t){if(!this.featureSwitches.onObject)return e;for(var i=__spreadArray([],e),a={objectName:"labels",propertyName:"showSeries"},r={objectName:"labels",propertyName:"show"},s={objectName:"labels",propertyName:"showByDefault"},o=[],n=0,l=this.dataViews;n<l.length;n++){var c=l[n];o.push(p.createTopLevelToggleTurnOffAction(p.DataViewObjectChangeType.Add,r,function(){return[{objectName:"labels",propertyName:"revertToDefault",propertyValue:void 0,propertyType:{bool:!0}}]},!0),p.createSeriesLevelToggleTurnOnAction(p.DataViewObjectChangeType.Add,a,H.DataViewObjects.getValue(c.metadata.objects,r),function(){return[__assign(__assign({},r),{propertyValue:!0,propertyType:{bool:!0}}),__assign(__assign({},s),{propertyValue:!1,propertyType:{bool:!0}})]},!0))}i.unshift.apply(i,p.changeDataViewObjectsBehavior(e,o));for(var u=0,d=this.getLayers();u<d.length;u++){var h=d[u];h.onDataViewObjectChanged&&i.unshift.apply(i,h.onDataViewObjectChanged(e,t))}return i},v.MinScalarRectThickness=2,v.LoadMoreThreshold=1,v.xAxisSmallFontSizeInPx=9,v.yAxisSmallFontSizeInPx=9,v.yAxisMediumFontSizeInPx=11,v);function v(e){var t=this,i=!1;this.trimOrdinalDataOnOverflow=!0,this.featureSwitches={},e&&(this.tooltipsEnabled=e.tooltipsEnabled,this.type=e.chartType,this.featureSwitches=e.featureSwitches||{},void 0!==e.trimOrdinalDataOnOverflow&&(this.trimOrdinalDataOnOverflow=e.trimOrdinalDataOnOverflow),e.isScrollable&&(i=e.isScrollable),e.behaviorFactory&&(this.behaviorFactory=e.behaviorFactory)),this.hasAnimator=!(null==e||!e.animator),this.axes=new A.CartesianAxes(i,a.ScrollbarWidth,this.trimOrdinalDataOnOverflow),this.viewModelAdapterFactory=new A.ResponsiveCartesianAdapterFactory(this.featureSwitches.smallMultiplesResponsive),this.layerFactory=new B(this.type,this.viewModelAdapterFactory),this.layoutBuilder=new A.CartesianChartLayoutBuilder(e,this.behaviorFactory,this.featureSwitches,this.axes,this.type,function(){return t.isPlayAxis()},i,function(){return t.smallMultiplesViewModelAdapter}),this.multiples=new A.CartesianSmallMultiples(this.type,this.featureSwitches,function(){return t.createLayers()},function(e){return t.getLayerRendererInitOptions(e)})}function i(){this.navigationLayers=[],this.currentNavigationLayerIndex=0}A.CartesianChart=t,i.prototype.updateScrollCallbacks=function(e){this.scrollCallbacks=e},i.prototype.clearNavigationLayers=function(){this.navigationLayers=[]},i.prototype.addNavigationLayer=function(e){this.navigationLayers.push(e)},i.prototype.getFirstElement=function(){this.currentNavigationLayerIndex=0;var e,t=this.navigationLayers[this.currentNavigationLayerIndex].getFirstElement();return{element:e=t?t.element||this.getNextDataPoint(t.targetCategoryIndex,t.targetSeriesIndex,A.DataDirection.NextSeries).element:e}},i.prototype.getNextDataPoint=function(e,t,i){e=this.composeLayerPointInfo(e,t);return this.getNextDataPointWithStartData(e,i,e)},i.prototype.getNextDataPointWithStartData=function(i,a,r){var s=this,o=i.categoryIndex,n=i.seriesIndex,l=this.navigationLayers[this.currentNavigationLayerIndex],c=l.getNextDataPoint(o,n,a),e=c.targetCategoryIndex,u=a===A.DataDirection.NextSeries||a===A.DataDirection.NextCategory,d=this.navigationLayers.length;if(1<d&&c.targetCategoryIndex!==o){var t=o,h=0,p=u?1:-1;do{switch(a){case A.DataDirection.NextSeries:case A.DataDirection.PreviousSeries:this.currentNavigationLayerIndex+=p,this.layerRollOverCheck(this.currentNavigationLayerIndex,d)?(this.currentNavigationLayerIndex=this.currentNavigationLayerIndex<0?d-1:0,l=this.navigationLayers[this.currentNavigationLayerIndex],c=l.getFirstElement(e,!u),t=e=_.isFinite(c.targetCategoryIndex)?c.targetCategoryIndex:e,h++):(l=this.navigationLayers[this.currentNavigationLayerIndex],c=l.getFirstElement(t,!u));break;case A.DataDirection.NextCategory:case A.DataDirection.PreviousCategory:h=d}}while(!c.element&&h<d&&(!this.layerRollOverCheck(this.currentNavigationLayerIndex+p,d)||h<d-1))}if(!c.element&&null!=e&&this.shouldScroll(e)){this.getPendingFocusElement=function(){if(s.getPendingFocusElement=void 0,a===A.DataDirection.NextSeries?s.currentNavigationLayerIndex=0:a===A.DataDirection.PreviousSeries&&(s.currentNavigationLayerIndex=d-1),l=s.navigationLayers[s.currentNavigationLayerIndex],!(c=l.getNextDataPoint(o,n,a)).element)for(var e=s.currentNavigationLayerIndex;s.currentNavigationLayerIndex++,s.currentNavigationLayerIndex>=s.navigationLayers.length&&(s.currentNavigationLayerIndex=0),!(c=s.navigationLayers[s.currentNavigationLayerIndex].getNextDataPoint(o,n,a)).element&&s.currentNavigationLayerIndex!==e;);var t;return s.shouldFindNextPoint(c,i,r,u)?(t=s.composeLayerPointInfo(c.targetCategoryIndex,c.targetSeriesIndex),s.getNextDataPointWithStartData(t,a,r).element):c.element};var g=e-o;g<0?this.scrollCallbacks.scrollTo(e):this.scrollCallbacks.scrollBy(g)}else if(this.shouldFindNextPoint(c,i,r,u))return g=this.composeLayerPointInfo(c.targetCategoryIndex,c.targetSeriesIndex),this.getNextDataPointWithStartData(g,a,r);return c},i.prototype.shouldScroll=function(e){return!!this.scrollCallbacks&&this.scrollCallbacks.shouldScrollTo(e)},i.prototype.layerRollOverCheck=function(e,t){return t<=e||e<0},i.prototype.composeLayerPointInfo=function(e,t){return{categoryIndex:e,seriesIndex:t,layerIndex:this.currentNavigationLayerIndex}},i.prototype.shouldFindNextPoint=function(e,t,i,a){if(e.element&&!e.noShape||null===e.targetCategoryIndex||null===e.targetSeriesIndex)return!1;var r=this.composeLayerPointInfo(e.targetCategoryIndex,e.targetSeriesIndex);switch(this.compareLayerPointInfo(i,r,a)){case 1:if(0<=this.compareLayerPointInfo(t,r,a)&&0<this.compareLayerPointInfo(i,t,a))return!1;break;case 0:return!1;case-1:if(0<this.compareLayerPointInfo(i,t,a))return!1;if(0<=this.compareLayerPointInfo(t,r,a))return!1}return!0},i.prototype.compareLayerPointInfo=function(e,t,i){return e.categoryIndex>t.categoryIndex?i?1:-1:e.categoryIndex<t.categoryIndex?i?-1:1:e.seriesIndex>t.seriesIndex?i?1:-1:e.seriesIndex<t.seriesIndex?i?-1:1:e.layerIndex>t.layerIndex?i?1:-1:e.layerIndex<t.layerIndex?i?-1:1:0},A.CartesianChartNavigationHelper=i;n.prototype.processDataView=function(e,t){var i,a,r,s,o;this.renderModes=[],e&&e.metadata&&e.categorical&&!_.isEmpty(e.categorical.categories)?(o=e.metadata,s=e.categorical.categories,i=_.head(s),a=A.ScalarUtils.getScalarKeys(i),r=A.CartesianHelper.hasCategoryHierarchy(e),i=A.ScalarUtils.shouldDrawScalar(o.objects,A.columnChartProps.categoryAxis.axisType,i.source.type,a,r),r?(a=n.areNonLeafLevelsFilteredToUniqueValue(s),r=H.DataViewObjects.getValue(o.objects,A.cartesianChartProps.categoryAxis.concatenateLabels,A.CartesianHelper.DefaultConcatenateLabelsValue),a&&r?this.renderModes.unshift(1):(s=n.isSortedByCategoryFirst(e),o=_.some(e.categorical.categories,function(e){return e.source&&e.source.identityExprs}),e=t&&!r&&o&&(s||a||this.easierHierarchicalAxis),this.renderModes.unshift(2),e&&this.renderModes.unshift(3),r||o||(this.warnings=[{selector:null,warnings:[new A.NoIdentityExprWarning]}]))):this.renderModes.unshift(1),i&&this.renderModes.unshift(0)):this.renderModes.push(2)},n.prototype.getRenderMode=function(){return _.head(this.renderModes)},n.prototype.getRenderModes=function(){return this.renderModes},n.prototype.addObjectWarnings=function(e){this.warnings&&e.push.apply(e,this.warnings||[])},n.isSortedByCategoryFirst=function(e){return!(!e||!e.categorical||_.isEmpty(e.categorical.categories)||!e.metadata||_.isEmpty(e.metadata.columns))&&_.every(e.categorical.categories,function(e,t){e=e.source;return e&&null!=e.sort&&e.sortOrder===t})},n.areNonLeafLevelsFilteredToUniqueValue=function(e){if(_.isEmpty(e))return!1;for(var t=e.length-1,i=0;i<t;i++){var a=e[i].source;if(!a||!H.DataViewObjects.getValue(a.objects,A.cartesianChartProps.filters.filteredToUniqueValue,!1))return!1}return!0};var d=n;function n(e,t,i){this.easierHierarchicalAxis=i,this.processDataView(e,t)}A.CartesianAxisRenderModeSelector=d;P.filterDataToViewport=function(e){if(e&&e.scrollScale){var t=e.scrollScale,i=e.mainAxisScale,a=A.AxisHelper.invertOrdinalScale(t,e.extent.start),r=a+e.visibleCategoryCount,p=t.domain().slice(a,r);if(!_.isEqual(p,i.domain())){if(p&&0<p.length){for(var s=0,o=e.layers;s<o.length;s++)o[s].setFilteredData(p[0],p[p.length-1]+1);i.domain(p);var g=e.axesLayout.axes,t=void 0,n=((t=e.axesLayout.isXScrollBarVisible?g.x:g.y1).axis.scale(i),t.scale(i),t.axis.ticks(p.length),t.axis.tickValues(p),A.SvgCartesianAxes.getTickFormatter(t.axis));if(t.values=_.map(p,function(e){return n(e)}),!_.isEmpty(g.xStack))for(var y=e.axesLayout.tickLabelMargins,m=A.CartesianAxes.getLeafHeight(y.xMax,y.stackHeight,g.xStack.length),l=0;l<g.xStack.length;l++)!function(e){var t=g.xStack[e],i=A.AxisHelper.getCategoryThickness(t.scale),a=t.values,r=P.setLabelsAtEdges(p,a);if(t.axis.ticks(p.length),t.axis.tickValues(p),t.axis.tickFormat(function(e){e=a[r[p.indexOf(e)]];return e===A.CartesianAxes.hierarchyPlaceholder?"":_.isString(e)?e:e+""}),0===e)return;for(var s=[],o=[],n=[],l=void 0,c=0;c<r.length;c++){var u,d=p[c],h=r[c];t.values[h]!==A.CartesianAxes.hierarchyPlaceholder?(null!=l&&(s[l]=A.CartesianAxes.getMaxCategoryWidth(u=d-l,i),o[l]=A.CartesianAxes.getHierarchyLineStyleInfo({levelIndex:e,stackHeight:y.stackHeight,leafHeight:m,categorySpanCount:u,categoryWidth:i})),n[d]=a[h],l=d):n[d]=A.CartesianAxes.hierarchyPlaceholder}null!=l&&(u=p[r.length-1]-l+1,s[l]=A.CartesianAxes.getMaxCategoryWidth(u,i),o[l]=A.CartesianAxes.getHierarchyLineStyleInfo({levelIndex:e,stackHeight:y.stackHeight,leafHeight:m,categorySpanCount:u,categoryWidth:i})),t.xLabelMaxWidths=s,t.lineStyleInfo=o,t.adjustedValues=n}(l)}return{startIndex:a,endIndex:r-1}}}},P.prototype.destroy=function(){this.scrollbar.remove()},P.prototype.render=function(e,t,i,a,r,s,o,n,l,c,u,d){var h=this,p=e.plotArea,g=(this.axisScale=null,e.isXScrollBarVisible||e.isYScrollBarVisible),y=A.CartesianChartConverter.isLineComboChart(l)?A.CartesianChartConverter.getMaximumSeriesSettings(t):A.CartesianChartConverter.getDefaultLineChartSeriesLabelSettings(),m=e.margin,f=!0;A.ComboChart.isComboChart(l)&&!c&&(f=!1);var v,S,x,b,C,w,D,l=e.viewport.width-(m.left+m.right),c=y.seriesPosition===A.labelSeriesPosition.right?m.left:m.left+this.getSeriesWidth(l,y,f);if((o||g)&&(D=(w=(C=this.cartesianAxes.isYAxisCategorical?(this.axisScale=e.axes.y1.scale,v=e.viewport.width,S=e.margin.top,D=e.axes.y1.categoryThickness,x=e.axes.y1.outerPaddingRatio,b=e.axes.y1.innerPaddingRatio,w=D*x,p.height):(this.axisScale=e.axes.x.scale,v=c,S=e.viewport.height,D=e.axes.x.categoryThickness,x=e.axes.x.outerPaddingRatio,b=e.axes.x.innerPaddingRatio,w=D*x,p.width),Math.max(1,H.Double.floorWithPrecision((C-2*w)/D))),C)),!g)return o&&(o.resetViewport(w),o.shouldLoadMoreData()&&o.loadMoreData()),this.scrollbar.remove(),void a(t,e,i,this.animateCategoryAxis,this.animateValueAxis,r);this.scrollScale=this.axisScale.copy(),this.scrollScale.range([0,D]).paddingInner(.1).paddingOuter(0),this.extentLength=this.scrollScale(w-1)+this.scrollScale.bandwidth(),this.scrollHandler=new L({visibleScale:this.axisScale,fullScale:this.scrollScale,onScroll:function(e){e=h.scrollScale(e);h.scrollbar.setExtent({start:e,end:null}),h.scrollbar.refreshExtentAndVisual()}}),this.axisScale.range([0,C]).paddingInner(b).paddingOuter(x),this.scrollbar.setOrientation(e.isXScrollBarVisible),this.scrollbar.setScale(this.scrollScale,n),this.scrollbar.scrollBarLength=D,this.scrollbar.setExtentLength(this.extentLength),s||this.scrollbar.setExtent({start:0,end:null}),this.renderVisualOptions={axesLayout:e,layers:t,categoryLoadMoreDataHandler:o,mainAxisScale:this.axisScale,renderDelegate:a,scrollScale:this.scrollScale,visibleCategoryCount:w,animateCategoryAxis:this.animateCategoryAxis,animateValueAxis:this.animateValueAxis};this.scrollbar.render(v,S,function(){return h.onRefreshVisual(function(e,t){return P.renderVisual(h.renderVisualOptions,e,t,r)})},u,d),s&&o?(m=o.viewportDataRange?o.viewportDataRange.startIndex:0,this.scrollTo(m)):P.renderVisual(this.renderVisualOptions,this.scrollbar.getExtent(),i,r)},P.prototype.getSeriesWidth=function(e,t,i){return t&&t.show&&i?t.seriesMaximumWidth/100*e:0},P.prototype.scrollDelta=function(e){this.scrollHandler.scrollDelta(e)},P.prototype.scrollTo=function(e){this.scrollHandler.scrollTo(e)},P.prototype.shouldScrollTo=function(e){if(!this.scrollHandler)return!1;var t=this.axisScale.domain();return!_.isEmpty(t)&&(e<t[0]||e>t[t.length-1])},P.prototype.setExtent=function(e){this.scrollbar.setExtent(e),this.scrollbar.refreshExtentAndVisual()},P.prototype.scrollBy=function(e){var t=this.axisScale.domain();_.isEmpty(t)||this.scrollHandler.scrollTo(t[0]+e)},P.prototype.clearRenderingTimeout=function(){this.scrollbar&&this.scrollbar.clearRenderingTimeout()},P.prototype.onRefreshVisual=function(e){e(this.scrollbar.getExtent(),!0)},P.setLabelsAtEdges=function(e,t){if(e.length<=1||t[e[0]]!==A.CartesianAxes.hierarchyPlaceholder)return e;var i=e[0],e=e.slice();if(i<t.length&&0<=i){for(;t[i]===A.CartesianAxes.hierarchyPlaceholder&&0<=i;i--);e[0]=i}return e},P.renderVisual=function(e,t,i,a){var r,t=P.filterDataToViewport({mainAxisScale:e.mainAxisScale,layers:e.layers,scrollScale:e.scrollScale,extent:t,visibleCategoryCount:e.visibleCategoryCount,axesLayout:e.axesLayout,animateCategoryAxis:e.animateCategoryAxis,animateValueAxis:e.animateValueAxis});t&&(e.categoryLoadMoreDataHandler&&((r=e.categoryLoadMoreDataHandler).viewportDataRange=t,r.shouldLoadMoreData()&&r.loadMoreData()),e.renderDelegate(e.layers,e.axesLayout,i,e.animateCategoryAxis,e.animateValueAxis,a))},P.ScrollbarWidth=10;var a=P;function P(e,t,i,a){this.cartesianAxes=e,this.scrollbar=t,this.animateCategoryAxis=i,this.animateValueAxis=a}A.ScrollableAxes=a;r.prototype.scrollDelta=function(e){_.isEmpty(this.visibleScale.domain())||(this.totalScrollDistance<0&&0<e||0<this.totalScrollDistance&&e<0?this.totalScrollDistance=e:this.totalScrollDistance+=e,e=r.getStepSize(this.visibleScale),Math.abs(this.totalScrollDistance)>=e?(this.extendScrollTimeout&&this.extendScrollTimeout.cancel(),e=this.getNewStartIndex(this.totalScrollDistance),this.scrollTo(e),this.totalScrollDistance=0):this.extendScrollTimeout())},r.prototype.scrollTo=function(e){e=this.clampIndex(e);this.onScroll(e)},r.getStepSize=function(e){var t=_.map(e.domain(),e);if(1<t.length)return t[1]-t[0];t=e.range();return t[1]-t[0]},r.prototype.getNewStartIndex=function(e){var t=0<=e,i=(e=t?e:-e,this.visibleScale),a=_.map(i.domain(),i),r=i.domain(),s=r[0],a=a[0]+e;return(t?1:-1)*(i.range()[1]<a?r.length:A.AxisHelper.invertOrdinalScale(i,a)-s)+s},r.prototype.clampIndex=function(e){var t=this.fullScale.domain(),i=_.head(t),t=_.last(t);return Math.max(i,Math.min(t,e))},r.prototype.onTimeout=function(){this.totalScrollDistance=0},r.defaultTimeoutMs=1e3;var L=r;function r(e){e.visibleScale,e.fullScale,e.onScroll,this.visibleScale=e.visibleScale,this.fullScale=e.fullScale,this.onScroll=e.onScroll;e=jsCommon.Utility.valueOrDefault(e.timeout,r.defaultTimeoutMs);this.extendScrollTimeout=_.debounce(this.onTimeout,e),this.totalScrollDistance=0}A.AxisScrollHandler=L;u.prototype.create=function(e,t){e=__assign(__assign({},e),{viewModelAdapterFactory:t&&{create:function(e){return t.createLayerAdapter(2,e)}}});return new A.ScatterChart(e)};var s=u;function u(){this.categoryAxisTitleOnByDefault=!0,this.valueAxisTitleOnByDefault=!0}f.prototype.create=function(e,t){e=__assign(__assign({},e),{viewModelAdapterFactory:t&&{create:function(e){return t.createLayerAdapter(3,e)}}});return new A.WaterfallChart(e)};var h=f;function f(){}x.prototype.create=function(e,t){return new A.DataDotChart(e)};var S=x;function x(){}C.prototype.create=function(e,t){e={interactivityService:e.interactivityService,isScrollable:e.isScrollable,tooltipsEnabled:e.tooltipsEnabled,featureSwitches:e.featureSwitches,chartType:this.type,viewModelAdapterFactory:t&&{create:function(e){return t.createLayerAdapter(5,e)}}};return new A.ColumnChart(e)};var b=C;function C(e){this.type=e}D.prototype.create=function(e,t){return new A.Histogram(e)};var w=D;function D(){}V.prototype.create=function(e,t){e={interactivityService:e.interactivityService,isScrollable:e.isScrollable,tooltipsEnabled:e.tooltipsEnabled,chartType:this.type,featureSwitches:e.featureSwitches,viewModelAdapterFactory:t&&{create:function(e){return t.createLayerAdapter(0,e)}}};return this.inComboChart&&(e.chartType=8|e.chartType),new A.LineChart(e)};var M=V;function V(e,t){this.type=e,this.inComboChart=t}T.prototype.create=function(e,t){return e.isScrollable=!1,new A.RealTimeLineChart(e)};var R=T;function T(){}F.prototype.createLayers=function(e){var t=this,i={isScrollable:null!=e.isScrollable&&e.isScrollable,interactivityService:e.interactivityService,tooltipsEnabled:e.tooltipsEnabled,featureSwitches:e.featureSwitches};return _.map(this.layerMetadata,function(e){return e.create(i,t.viewModelAdapterFactory)})},F.initLayerMetadata=function(e){var t=[];switch(e){case 1:t.push(new M(2,!1));break;case 0:t.push(new M(1,!1));break;case 2:t.push(new M(16,!1));break;case 18:t.push(new R);break;case 10:t.push(new s);break;case 13:t.push(new h);break;case 12:t.push(new S);break;case 4:t.push(new b(20));break;case 3:t.push(new b(12));break;case 8:t.push(new b(52));break;case 6:t.push(new b(18));break;case 5:t.push(new b(10));break;case 7:t.push(new b(50));break;case 9:t.push(new b(68));break;case 11:var i=F.getComboColumnType();t.push(new b(i)),t.push(new M(1,!0));break;case 14:t.push(new b(12)),t.push(new M(1,!0));break;case 15:t.push(new b(20)),t.push(new M(1,!0));break;case 16:t.push(new b(12)),t.push(new S);break;case 17:t.push(new b(20)),t.push(new S);break;case 19:t.push(new w)}return t},F.getComboColumnType=function(e){var t=12;if(e){var i=e.general;if(i){switch(i.visualType1){case"Column":t=12;break;case"ColumnStacked":t=20;break;default:i.visualType1}i.visualType2&&i.visualType2}}return t};var B=F;function F(e,t){this.viewModelAdapterFactory=t,this.layerMetadata=F.initLayerMetadata(e)}k.prototype.getAllColors=function(){return this.palette.getAllColors()},k.prototype.getColorScaleByKey=function(e){return this.setPreferredScale(e),this.preferredScale},k.prototype.getNewColorScale=function(){return this.preferredScale},k.prototype.getColorByIndex=function(e){return this.palette.getColorByIndex(e)},k.prototype.getSentimentColors=function(){return this.palette.getSentimentColors()},k.prototype.getGradientColors=function(){return this.palette.getGradientColors()},k.prototype.getBasePickerColors=function(){return this.palette.getBasePickerColors()},k.prototype.clearPreferredScale=function(){this.preferredScale=this.palette.getNewColorScale(),this.rotated=!1},k.prototype.rotateScale=function(){this.preferredScale=this.preferredScale.clone(),this.preferredScale.clearAndRotateScale(),this.rotated=!0},k.prototype.setPreferredScale=function(e){this.rotated||(this.preferredScale=this.palette.getColorScaleByKey(e))};var I=k;function k(e){this.palette=e,this.clearPreferredScale()}A.SharedColorPalette=I;N.prototype.update=function(e,t){this.enabled=!t&&0!==e},N.prototype.resetViewport=function(e){this.viewportDataRange={startIndex:0,endIndex:e}},N.prototype.setScale=function(e){e=e&&e.domain&&e.domain().length;e&&(this.loadMoreThresholdIndex=e-1-this.loadMoreThreshold)},N.prototype.isLoadingMoreData=function(){return this.loadingMoreData},N.prototype.onLoadMoreDataCompleted=function(){this.loadingMoreData=!1},N.prototype.shouldLoadMoreData=function(){var e=this.viewportDataRange;return!(!this.enabled||!e||this.isLoadingMoreData())&&e.endIndex>=this.loadMoreThresholdIndex},N.prototype.loadMoreData=function(){return this.shouldLoadMoreData(),this.isLoadingMoreData()?e.WaitingForData:(this.loadingMoreData=!0,this.hostServices.loadMoreData(),e.TriggeredLoadMore)};var O=N;function N(e,t,i){void 0===i&&(i=0),this.enabled=!1,this.loadMoreThreshold=i,this.hostServices=t,this.setScale(e)}A.CartesianCategoryLoadMoreDataHandler=O}(H.visuals||(H.visuals={}))}(powerbi=powerbi||{}),function(e){!function(u){var a=jsCommon.BrowserUtils,o={rectangle:{name:"rectangle",directionMode:0},centerBasedRectangle:{name:"centerBasedRectangle",directionMode:1},edgeBasedRectangle:{name:"edgeBasedRectangle",directionMode:2}};function e(e,t){this.behaviorFactories=e,this.featureSwitches=t}e.prototype.create=function(){var e=this.behaviorFactories.map(function(e){return e.create()});return new t(e,this.featureSwitches)},u.CartesianChartBehaviorFactory=e;c.prototype.bindEvents=function(e,t,i,a){for(var r,s,o=this.behaviors,n=0,l=o.length;n<l;n++)o[n].bindEvents(e.layerOptions[n],t,i,a);this.axesLayout=e.axesLayout,this.categorySubRangeCount=e.categorySubRangeCount,this.verticalCategoryAxis=e.verticalCategoryAxis,this.selectionHandler=t,a?e.clearCatcher.on("click",null):e.clearCatcher.on("click",function(){u.InteractivityUtils.handleClearSelection(t)}),i&&(r=i.dataPointNavigationManager,s=i.pointSourceKey,r.isEmpty(s)||this.registerFocusKeyHandler(e.root,e.layerOptions))},c.prototype.renderSelection=function(e){for(var t=0,i=this.behaviors;t<i.length;t++)i[t].renderSelection(e)},c.prototype.renderFocus=function(e){for(var t=0,i=this.behaviors;t<i.length;t++)i[t].renderFocus(e)},c.prototype.lassoSelectRect=function(e,t){var i=[],a=this.getLassoSelectDirectionMode(),r=this.getScaledRegion(t,a);if(void 0!==a){for(var s=0,o=this.behaviors;s<o.length;s++){var n,l=o[s];l.lassoSelectRectLayer&&l.getLassoSelectDirectionMode&&(n=l.getLassoSelectDirectionMode(),(n=c.getRectResultKeys(n)).length,n=r[n[0]],i.push.apply(i,l.lassoSelectRectLayer(n)))}u.InteractivityUtils.lassoSelectPoints(e,i,this.selectionHandler)}},c.prototype.getLassoSelectDirectionMode=function(){for(var i=[],e=0,t=this.behaviors;e<t.length;e++)!function(e){var t;e.getLassoSelectDirectionMode&&(t=e.getLassoSelectDirectionMode(),_.some(i,function(e){return e===t})||i.push(t))}(t[e]);if(0!==i.length)return 1===i.length?i[0]:3},c.getRectResultKeys=function(e){return 0===e?[o.rectangle.name]:1===e?[o.centerBasedRectangle.name]:2===e?[o.edgeBasedRectangle.name]:[o.centerBasedRectangle.name,o.edgeBasedRectangle.name]},c.prototype.getScaledRegion=function(e,t){for(var i={},a=0,r=c.getRectResultKeys(t);a<r.length;a++){var s=r[a];i[s]={dataSpace:this.getScaledRegionInternal(e,o[s].directionMode),pixelValue:e}}return i},c.prototype.getScaledRegionInternal=function(e,t){var i=e.left-this.axesLayout.margin.left,a=e.top-this.axesLayout.margin.top,r=e.right-this.axesLayout.margin.left,e=e.bottom-this.axesLayout.margin.top,s=2===t?this.categorySubRangeCount:void 0,o=0===t||this.verticalCategoryAxis?0:-1,n=0===t||this.verticalCategoryAxis?0:1,l=0!==t&&this.verticalCategoryAxis?-1:0,c=0!==t&&this.verticalCategoryAxis?1:0,i={left:this.axesLayout.axes.x.invertAxis?u.AxisHelper.invertScale(this.axesLayout.axes.x.scale,r,n,t,s):u.AxisHelper.invertScale(this.axesLayout.axes.x.scale,i,o,t,s),top:this.axesLayout.axes.y1.invertAxis?u.AxisHelper.invertScale(this.axesLayout.axes.y1.scale,e,c,t,s):u.AxisHelper.invertScale(this.axesLayout.axes.y1.scale,a,l,t,s),right:this.axesLayout.axes.x.invertAxis?u.AxisHelper.invertScale(this.axesLayout.axes.x.scale,i,o,t,s):u.AxisHelper.invertScale(this.axesLayout.axes.x.scale,r,n,t,s),bottom:this.axesLayout.axes.y1.invertAxis?u.AxisHelper.invertScale(this.axesLayout.axes.y1.scale,a,l,t,s):u.AxisHelper.invertScale(this.axesLayout.axes.y1.scale,e,c,t,s)};return this.axesLayout.axes.y2&&_.assign(i,{top2:this.axesLayout.axes.y2.invertAxis?u.AxisHelper.invertScale(this.axesLayout.axes.y2.scale,e,c,t,s):u.AxisHelper.invertScale(this.axesLayout.axes.y2.scale,a,l,t,s),bottom2:this.axesLayout.axes.y2.invertAxis?u.AxisHelper.invertScale(this.axesLayout.axes.y2.scale,a,l,t,s):u.AxisHelper.invertScale(this.axesLayout.axes.y2.scale,e,c,t,s)}),i},c.prototype.registerFocusKeyHandler=function(e,i){e.on("keydown.cartesian",function(){var e,t=d3.event;27===t.keyCode&&_.some(i,function(e){return $.contains(e.root.node(),t.target)})&&(t.preventDefault(),t.stopPropagation(),e=_.find(i,function(e){return $(e.root.node()).is(":tabbable")}),a.focus(e.root.node()))})};var t=c;function c(e,t){this.behaviors=e}u.CartesianChartBehavior=t}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(he){!function(ue){function de(){this.existingTooltips=[]}Object.defineProperty(de.prototype,"displayNames",{get:function(){var e;return this._displayNames||(e=this.options.hostServices,this._displayNames={negative:e.getLocalizedString("Visual_TotalTooltipNegative"),positive:e.getLocalizedString("Visual_TotalTooltipPositive"),net:e.getLocalizedString("Visual_TotalTooltipNet"),simple:e.getLocalizedString("Visual_Total")}),this._displayNames},enumerable:!1,configurable:!0}),de.prototype.convert=function(e){for(var t,i,a=(this.options=e).dataView,r=e.style,s=e.is100PercentStacked,s=void 0!==s&&s,o=e.isScalar,o=void 0!==o&&o,n=e.dataViewMetadata,n=void 0===n?null:n,l=e.multipleInfo,c=e.chartType,u=e.interactivityService,d=e.tooltipsEnabled,d=void 0===d||d,h=e.hostServices,p=e.ribbonChart,g=e.isCombo,y=e.buildCategories,e=e.supportsTotalLabels,m=ue.CartesianHelper.getCategoryAxisProperties(n,!1),f=ue.CartesianHelper.getPreferredCategoryWidth(m),v=ue.CartesianHelper.getReverseStackOrder(m),o=ue.CartesianHelper.isScalar(o,m),m=a.categorical,S=new O(a,r),y=ue.converterHelper.getPivotedCategories(m,ue.columnChartProps.general.formatString,y),x=y.categories,y=y.categoryFormatter,m=ue.CartesianHelper.getScalarKeyinfo(m,o).category.source,b=ue.ColumnChart.getDefaultColumnLabelSettings(r,g),C=(n&&n.objects&&(L=n.objects.labels,ue.DataLabelViewModel.updateLabelSettingsFromLabelsObjectWithLabelDensity(L,b,!ue.ColumnChart.isBar(c),r,g)),__assign(__assign({},b),{show:!1})),w=(e&&n&&n.objects&&((w=n.objects.totals)&&ue.DataLabelViewModel.updateLabelSettingsFromLabelsObject(w,C,!1,r,g)),this.totalLabelsSettings=C,p&&(t=ue.ColumnChart.getRibbonsUtils().getRibbonOptionsFromDataviewObjects(n,ue.columnChartProps,v)),S.getLegend()),D=w.legend.dataPoints,A=w.seriesSources,P=ue.ColumnChart.getDefaultLineChartSeriesLabelSettings(r),n=(n&&n.objects&&(L=n.objects.seriesLabels,ue.DataLabelViewModel.updateSeriesLabelSettingsFromLabelsObject(L,P,r,g),P.defaultSeriesWidth=P.defaultSeriesWidth?-1:null,P.seriesMaximumWidth=P.defaultSeriesWidth?-1:P.seriesMaximumWidth),this.createDataPoints({dataView:a,categories:x,legend:D,converterStrategy:S,defaultDataLabelsSettings:b,defaultSeriesSettings:P,totalLabelsSettings:C,is100PercentStacked:s,isScalar:o,isCombo:!!g,style:r,chartType:c,categoryMetadata:m,multipleInfo:l,tooltipsEnabled:d,ribbonChart:p,hostServices:h,ribbonOptions:t,supportsTotalLabels:e,reverseStackOrder:v})),L=n.series,M=(ue.canSupportOutsidePosition(c,L.length)?null!=b.position&&_.includes(ue.clusteredValidLabelPositionOptions,b.position)||(b.position=ue.labelPosition.auto):null!=b.position&&_.includes(ue.stackedValidLabelPositionOptions,b.position)||(b.position=ue.labelPosition.auto),[]),V=0,T=D.length;V<T;V++)M.push(A[V]);if(u){for(var F=0,I=L;F<I.length;F++){var k=I[F];u.applySelectionStateToData(k.data)}u.applySelectionStateToData(w.legend.dataPoints)}return r.isHighContrast&&(i={visible:!0,color:ue.ColorHelper.getThemeColor(r,ue.ForegroundColorName),width:ue.CartesianHelper.defaultLineStrokeWidth}),{categories:x,categoryIdentities:n.categoryIdentities,categoryFormatter:y,preferredCategoryWidth:f,series:L,totals:n.totals,hasPositive:n.hasPositive,hasNegative:n.hasNegative,hasNetPositive:n.hasNetPositive,hasNetNegative:n.hasNetNegative,hasY2Role:he.data.DataRoleHelper.hasRoleInDataView(a,"Y2"),valuesMetadata:M,legendData:w.legend,hasHighlights:n.hasHighlights,valuesMetadataBySeries:n.valuesMetadataBySeries,categoryMetadata:m,scalarCategoryAxis:o,dataLabelsSettings:b,seriesLabelSetings:P,totalLabelsSettings:C,hasDynamicSeries:n.hasDynamicSeries,isMultiMeasure:n.isMultiMeasure,ribbonChartData:p?{ribbonChartDataPoints:n.ribbonChartDataPoints,ribbonOptions:t}:void 0,strokeSettings:i,multipleIdentity:n.multipleIdentity}},de.prototype.createDataPoints=function(R){var n,oe=this,B=R.dataView,H=B.categorical,U=ue.columnChartProps.general.formatString,z=ue.cartesianRoleNames.y,j=he.data.createDataViewCategoricalReaderAdvanced(B,{staticSeriesRoleNames:[z],colorOptions:{valueRole:z,visualStyle:R.style},formatStringProp:U,errorRangeProp:ue.ErrorObjectProps.errorRange}),E=H&&H.values?H.values.grouped():void 0,W=R.categories.length,G=j.data.hasValues(z)?j.data.getSeriesCount():void 0,Y=[],X=[],K=R.chartType,p=ue.ColumnChart.isStacked(K,G);if(G<1||W<1)return{series:Y,totals:X,hasPositive:!1,hasNegative:!1,hasNetPositive:!1,hasNetNegative:!1,valuesMetadataBySeries:[],categoryIdentities:[],ribbonChartDataPoints:null,hasHighlights:!1,hasDynamicSeries:!1,isMultiMeasure:!1};for(var g,Z,q,e=H.categories,e=(R.categoryMetadata,_.isEmpty(e)?null:_.last(e).source),e=ue.AxisHelper.getCategoryValueType(e),ne=ue.AxisHelper.isDateTime(e),$=[],y=[],J=[],Q=[],ee=[],l=[],te=!(!H.values||!H.values.source),e=!te&&1<G,ie=R.multipleInfo,ae=(ie&&(Z=_.first(ie.sources).metadata.queryName,q=ie.sources.map(function(e){return ue.buildValueDetailsForColumnValue(e.metadata,e.value,ie.identity)}),g=(new ue.SelectionIdBuilder).withColumnIdentity(ie.identity,Z,q).createSelectionId()),!1),re=j.data.hasHighlights(),t=R.converterStrategy,i=0;i<G;i++){for(var m=[],f=[],a=0;a<W;a++){var v,r=t.getValueBySeriesAndCategory(i,a),s=t.getFormatStringBySeriesAndCategory(i,a);m[a]={value:r,formatString:s},re&&(s=t.getHighlightBySeriesAndCategory(i,a),v=t.getHighlightFormatStringBySeriesAndCategory(i,a),f[a]={value:s,formatString:v},0<=r&&0<=s&&he.Double.greaterOrEqualWithPrecision(r,s)||r<=0&&s<=0&&he.Double.lessOrEqualWithPrecision(r,s)||(ae=!0))}$.push(m),re&&y.push(f)}ae&&!ue.canSupportOutsidePosition(K,G)&&(re=ae=!1,$=y);for(var le=R.defaultDataLabelsSettings.fontProperties.color,ce=this.totalLabelsSettings.fontProperties.color,S=function(e){for(var P=e,L=null!=(n=se.options.featureSwitches)&&n.flipStackOrder&&R.reverseStackOrder?G-e-1:e,M=[],e=R.legend[P],V=void 0,t=void 0,i=((j.data.hasSeries()||R.isCombo)&&(a=void 0,i=(a=R.isCombo&&!j.data.hasSeries()?j.objects.getValueMetadataObjects(z,L):j.objects.getSeriesDataObjects(L))&&a.labels,a=a&&a.seriesLabels,(V=he.Prototype.inherit(R.defaultDataLabelsSettings)).show=R.defaultDataLabelsSettings.show&&(null==(n=R.defaultDataLabelsSettings.showByDefault)||n),i&&ue.DataLabelViewModel.updateLabelSettingsFromLabelsObjectWithLabelDensity(i,V,void 0,R.style,R.isCombo),(t=he.Prototype.inherit(R.defaultSeriesSettings)).show=R.defaultSeriesSettings.show&&(null==(n=R.defaultSeriesSettings.showByDefault)||n),a&&ue.DataLabelViewModel.updateSeriesLabelSettingsFromLabelsObject(a,t,R.style,R.isCombo)),e.color),a=j.columns.getValueColumnBySeries(L),T=Q[L]=j.columns.getValueMetadataColumn(z,L),t=t||R.defaultSeriesSettings,r=_.findIndex(Q,T),F=(-1!==r&&(l[r]?l[r].usedInSeriesIndices.push(L):l[r]={metadataColumn:T,usedInSeriesIndices:[L],valueSelector:(new ue.SelectionIdBuilder).withMeasure(T.queryName,a).createSelectionId()}),ue.UncertaintyHelper.convertErrorMetadata(p?{}:T.objects,R.style,i,L,__assign(__assign({},R.defaultDataLabelsSettings),{show:!1}),{isCombo:R.isCombo,hideBand:!0,valueAxisHorizontal:ue.ColumnChart.isBar(K),staticObjects:j.objects.getStaticObjects()})),I=F.hasUncertainty,r={displayName:e.label,key:"series"+L,index:L,data:M,identity:e.identity,color:i,labelSettings:V,uncertainty:F,type:T.type,seriesSettings:t},k=(Y.push(r),ue.GradientUtils.getGradientMeasureIndex(H)),O=ue.GradientUtils.getGradientValueColumn(H),N=ue.valueFormatter.getLocalizedString("Percentage"),s=function(s){var o=ue.AxisHelper.normalizeNonFiniteNumber($[L][s].value),n=$[L][s].formatString;if(null==o&&0<P)return"continue";var l=o,e=R.categories[s];if(ne&&null!=e&&!(e instanceof Date))return"continue";var c,t=void 0,t=e instanceof Date?he.FeatureSwitchedDate.getEpochTimeStamp(se.options.featureSwitches.utcDates,e):e;if(R.isScalar&&(null==t||isNaN(t)))return"continue";I&&(c=ue.UncertaintyHelper.convertCategoricalDataPoint(j.data,s,L,o));var u,d,h,p,i,e=void 0,g=R.is100PercentStacked,a=(g&&(e=ue.StackedUtil.getStackedMultiplier(_.map($,function(e){return _.map(e,function(e){return e.value})}),s)),o),r=(ee[L]||(ee[L]=[]),ee[L][s]=o<0),y=(e&&(o*=r?e.neg:e.pos),X[s]||(X[s]={positive:0,negative:0,net:0,categoryValue:t,categoryIndex:s,dynamicFormatString:n}),ue.DataLabelUtil.determineTotalLabelFillColor({defaultColor:ce,categoricalDataReader:j,categoryIndex:s,seriesIndex:P})),m=ue.DataLabelUtil.isAssignedColor(y)?y.color:le,f=(se.totalLabelsSettings.fontProperties=ue.DataLabelUtil.updateFontPropertiesColor(m,se.totalLabelsSettings.fontProperties),X[s].labelFill=y.color,Math.abs(o)),m=void 0,y=(r?(m=X[s].negative,isNaN(f)||(X[s].negative-=f,X[s].net-=f)):(isNaN(f)||(X[s].positive+=f,X[s].net+=f),m=X[s].positive),E&&E.length>L&&E[L].values?E[L]:null),v=_.isEmpty(H.categories)?null:H.categories[0],S=j.columns.getValueColumn(z,L),y=de.createIdentities(H,v,s,y,S,T,ie,Z,q),S=y.identity,y=y.identityKey,x=(J[s]||(J[s]=function(){return ue.CartesianHelper.getCategoryIdentity(s,v)}),j.colors.createBySeries(L,s)),b=0===k?null:O,C=void 0,w=void 0,D=void 0,e=(re&&(u=j.data.getHighlight(z,s,L),d=j.data.getHighlightFormatString(z,s,L),C=null!==(p=u)?(I&&(h=ue.UncertaintyHelper.convertCategoricalDataPoint(j.data,s,L,u,!0)),g&&(u*=0<u?e.pos:e.neg),Math.abs(u)):0,w=function(e,t,i,a,r){0<i?e-=a-r:(null===i||0===i)&&0<t&&(e-=a);return e}(m,o,u,f,C),D=ue.SelectionId.createWithHighlight(S)),R.tooltipsEnabled&&(i=new ue.LazyTooltipBuilder).withLazyValues(function(){var e,t,i=[],a=(!ie||(a=ue.TooltipBuilder.withMultipleColumnAndValues(ie.sources.map(function(e){return e.metadata}),ie.sources.map(function(e){return e.value}),!0,ue.FormattingStrategies.defaultFormatter(U)))&&i.push(a()),v&&(a=ue.CategoryLevelUtils.getCategoryLevels(B.categorical.categories,s,U),t=ue.CategoryLevelUtils.concatenateCategoryLevels(a),132===K&&(t=ue.Histogram.buildTooltipCategories(a,s,W)),i.push({displayName:t.displayName,value:t.value})),!te||v&&v.source===H.values.source||i.push({displayName:H.values.source.displayName,value:ue.converterHelper.formatFromMetadataColumn(E[L].name,H.values.source,U)}),function(e){return ue.converterHelper.formatFromMetadataColumn(e,T,U,!1,n)}),r=(null!=l&&(t=void 0,r=a(l),t=g?r+" ("+ue.valueFormatter.format(f,N)+")":r,r=F.tooltips,I&&!re&&r.show&&r.format===ue.errorFormat.range?(void 0!==(e=ue.UncertaintyHelper.getTooltipItems(c,o,F,a,R.hostServices,{overrideDisplayName:T.displayName}))&&e.length,_.isEmpty(e)?i.push({displayName:T.displayName,value:t}):i.push(e[0])):i.push({displayName:T.displayName,value:t})),re&&(a=function(e){return ue.converterHelper.formatFromMetadataColumn(e,T,U,!1,d)},(t=function(e,t,i,a,r,s,o){var n,l;null!=e&&null!=t&&(t=ue.valueFormatter.format(t,a),l=ue.converterHelper.formatFromMetadataColumn(e,r,s,!1,i),n=l+" ("+t+")");if(o)return n;return l}(p,u,d,N,T,U,g))&&(r=F.tooltips,I&&r.show&&r.format===ue.errorFormat.range?(void 0!==(e=ue.UncertaintyHelper.getTooltipItems(c,o,F,a,R.hostServices,{overrideDisplayName:ue.ToolTipComponent.localizationOptions.highlightedValueDisplayName}))&&e.length,_.isEmpty(e)?i.push({displayName:ue.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t}):i.push(e[0])):i.push({displayName:ue.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t}))),!I||F.tooltips.format===ue.errorFormat.range||(r=re?h:c)&&i.push.apply(i,ue.UncertaintyHelper.getTooltipItems(r,l,F,a,R.hostServices,{hideMarker:!0})),b&&null!=b.values[s]&&(t=he.DataViewObjects.getValue(null==(e=b.objects)?void 0:e[s],U),i.push({displayName:b.source.displayName,value:ue.converterHelper.formatFromMetadataColumn(b.values[s],b.source,U,!1,t)})),ue.TooltipBuilder.addTooltipMeasures(j,i,s,te?L:void 0,U),oe.getTotalTooltip(L,s,ee,X,Q,U));return r&&i.push(r),i}),Y[P]),e=e.labelSettings||R.defaultDataLabelsSettings,A=void 0,r=(ue.ColumnChart.isStacked(K,G)&&(A=function(e,t,i,a,r){for(var s=!(e&&t===i-1&&1!==i),o=t+1;o<i;o++){var n=ue.AxisHelper.normalizeNonFiniteNumber(r[o][a].value);if(null!==n&&((!e||0===t)&&0<n||e&&0!==t)){s=!1;break}}return s}(r,L,G,s,$)),ue.DataLabelUtil.determineDataLabelFillColor({defaultColor:le,seriesColor:null==V?void 0:V.fontProperties.color,categoricalDataReader:j,categoryIndex:s,seriesIndex:P})),a={categoryValue:t,value:o,position:m,valueAbsolute:f,valueOriginal:a,seriesIndex:P,labelSettings:e,uncertainty:c,categoryIndex:s,color:x,selected:!1,originalValue:o,originalPosition:m,originalValueAbsolute:f,identity:S,key:y,get tooltipInfo(){return i&&i.getTooltipItems()},get formattedTooltip(){return i&&i.getFormattedTooltipItems()},labelFill:r.color,labelFormatString:n||T.format,lastSeries:A,chartType:K};M.push(a),re&&(S={categoryValue:t,value:u,position:w,valueAbsolute:C,valueOriginal:p,seriesIndex:P,labelSettings:e,uncertainty:h,categoryIndex:s,color:x,selected:!1,highlight:!0,originalValue:o,originalPosition:m,originalValueAbsolute:f,drawThinner:ae,identity:D,key:D.getKey(),get tooltipInfo(){return i&&i.getTooltipItems()},get formattedTooltip(){return i&&i.getFormattedTooltipItems()},labelFormatString:d||T.format,labelFill:r.color,lastSeries:A,chartType:K},M.push(S))},o=0;o<W;o++)s(o)},se=this,o=0;o<G;o++)S(o);for(var c,x=!1,b=!1,u=!1,d=!1,C=0,w=X;C<w.length;C++){var h=w[C];h&&(x=x||0<h.positive,b=b||h.negative<0,u=u||0<h.net,d=d||h.net<0)}return this.hasNetPositive=u,this.hasNetNegative=d,1<G&&1<W&&R.ribbonChart&&(c=ue.ColumnChart.getRibbonsUtils().createRibbonChartDataPoints({dataView:B,columnSeries:Y,hasHighlights:re,hasDynamicSeries:te,ribbonChartDataPoints:c,categoryCount:W,formatStringProp:U,reader:j,hostServices:R.hostServices,ribbonOptions:R.ribbonOptions})),{series:Y,totals:X,hasPositive:x,hasNegative:b,hasNetPositive:u,hasNetNegative:d,valuesMetadataBySeries:l,categoryIdentities:J,ribbonChartDataPoints:c,hasHighlights:re,hasDynamicSeries:te,isMultiMeasure:e,multipleIdentity:g}},de.createIdentities=function(e,t,i,a,r,s,o,n,l){var c=e.originalCategories||[t],t=ue.SelectionIdBuilder.builder().withCategory(c,i,null==(c=null==t?void 0:t.source)?void 0:c.queryName,!0).withSeries(e.values,a,!0).withMeasure(s.queryName,r,i),c=(t=o?t.withColumnIdentity(o.identity,n,l):t).createSelectionId();return{identity:c,identityKey:c.getKey()}},de.prototype.getTotalTooltip=function(e,t,i,a,r,s){var o=this.options;if(o.tooltipsEnabled&&o.supportsTotalLabels&&this.totalLabelsSettings.show)return o=i[e][t],this.existingTooltips[t]||(this.existingTooltips[t]={}),this.totalLabelsSettings.showPositiveAndNegative?(this.existingTooltips[t][i=o?"negative":"positive"]||(this.existingTooltips[t][i]={displayName:this.displayNames[i],value:ue.converterHelper.formatFromMetadataColumn(a[t][i],r[e],s,!1)}),this.existingTooltips[t][i]):(this.existingTooltips[t].net||(this.existingTooltips[t].net={displayName:this.hasNetPositive&&this.hasNetNegative?this.displayNames.net:this.displayNames.simple,value:ue.converterHelper.formatFromMetadataColumn(a[t].net,r[e],s,!1)}),this.existingTooltips[t].net)},ue.ColumnChartConverter=de;e.prototype.getLegend=function(){var e=[],t=[],i=[],a=!1,r=this.reader;if(this.dataView&&this.dataView.values){for(var s=r.columns.getSeriesCount(ue.cartesianRoleNames.y),o=ue.columnChartProps.general.formatString,n=r.columns.hasDynamicSeries(),l=0;l<s;l++){var c=r.columns.getValueMetadataColumnBySeries(l),u=r.objects.getSeriesDataObjects(l);t.push(c),i.push(u);var u=(u=new ue.SelectionIdBuilder).withMeasure(c.queryName),u=(u=n?u.withSeries(r.columns.getSeriesValueColumns(),r.columns.getSeriesValueColumnGroup(l),!0):u).createSelectionId(),d=ue.converterHelper.getFormattedLegendLabel(c,this.dataView.values,o),h=r.colors.createBySeries(l);e.push({icon:ue.LegendIcon.Box,color:h,label:d,identity:u,selected:!1,index:l}),void 0!==c.groupName&&(a=!0)}var p=this.dataView.values,p=p&&p.source?p.source.displayName:""}var g=ue.Legend.getDefaultLegendData(this.visualStyle);return g.title=p,g.dataPoints=e,g.grouped=a,{legend:g,seriesSources:t,seriesObjects:i}},e.prototype.getValueBySeriesAndCategory=function(e,t){return this.reader.data.getValue("Y",t,e)},e.prototype.getHighlightBySeriesAndCategory=function(e,t){return this.reader.data.getHighlight("Y",t,e)},e.prototype.getFormatStringBySeriesAndCategory=function(e,t){return this.reader.data.getFormatString("Y",t,e)},e.prototype.getHighlightFormatStringBySeriesAndCategory=function(e,t){return this.reader.data.getHighlightFormatString("Y",t,e)};var O=e;function e(e,t){this.visualStyle=t,this.dataView=e&&e.categorical,this.reader=he.data.createDataViewCategoricalReaderAdvanced(e,{staticSeriesRoleNames:[ue.cartesianRoleNames.y],colorOptions:{valueRole:ue.cartesianRoleNames.y,visualStyle:t},formatStringProp:ue.columnChartProps.general.formatString})}ue.ColumnChartConverterHelper=O}(he.visuals||(he.visuals={}))}(powerbi=powerbi||{}),function(u){var m=u.visuals||(u.visuals={}),h=u.visuals.builder,e=jsCommon.CssConstants.createClassAndSelector,d=u.data.DataViewWildcard,i=jsCommon.DOMConstants,a=jsCommon.EnumExtensions,r=u.visuals.OnObjectUtil,n=m.shapes.Rect,p=u.data.Selector,g="Auto",s=(m.clusteredValidLabelPositionOptions=[g,m.labelPosition.outsideEnd,m.labelPosition.insideEnd,m.labelPosition.insideCenter,m.labelPosition.insideBase],m.stackedValidLabelPositionOptions=[g,m.labelPosition.insideCenter,m.labelPosition.insideEnd,m.labelPosition.insideBase],m.innerPaddingMin=0,m.innerPaddingMax=50,m.preferredCategoryWidthMin=20,m.preferredCategoryWidthMax=180,y.prototype.initData=function(e){this.currentViewport=e.viewport,this.element=e.element,this.hostService=e.host,this.interactivity=e.interactivity,this.isComboChart=m.ComboChart.isComboChart(e.chartType),this.style=e.style,this.tooltipService=e.services.tooltips,this.featureSwitches=e.featureSwitches,this.animationOptions=e.animation},y.prototype.initRenderer=function(e){var t;this.animator=e.animator,this.cartesianVisualHost=e.cartesianHost,this.svg=e.svg,this.svg.classed("columnChart",!0),this.unclippedGraphicsContext=this.svg.append("g").classed("columnChartUnclippedGraphicsContext",!0),this.mainGraphicsContext=this.unclippedGraphicsContext.append("svg").classed("mainGraphicsContext",!0),this.useManagedTabIndex=e.useManagedTabIndex,this.interactivityService&&(t=jsCommon.BrowserUtils.isInternetExplorerOrEdge(),this.mainGraphicsContext.attrs({"aria-label":this.hostService.getLocalizedString("Visual_Plot"),"data-automation-type":"mainGraphicsContext","aria-multiselectable":"true",role:"listbox"}).classed(m.SetFocusRingClassName,!t),e.useManagedTabIndex?(this.mainGraphicsContext.classed(m.managedTabIndexElement.class,!0),this.mainGraphicsContext.attr(i.skipChildrenFocusAttribute,!0)):this.mainGraphicsContext.attrs({tabindex:0,focusable:!0}))},y.prototype.getCategoryLayout=function(e,t,i,a,r){var s=y.isBar(this.chartType)?this.currentViewport.height-(this.margin.top+this.margin.bottom):this.currentViewport.width-(this.margin.left+this.margin.right),o=(s=Math.max(0,s),this.data?this.data.preferredCategoryWidth:null),n=this.data?this.data.categoryMetadata:void 0,n=m.AxisHelper.getCategoryValueType(n),l=this.getVisualCategoryAxisIsScalar(),n=m.AxisHelper.createDomain(this.data.series,n,l,[t.includeDomain]);return m.CartesianChartLayout.getLayout(this.data,{availableWidth:s,categoryCount:e,preferredCategoryWidth:o,domain:n,isScalar:l,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:i,outerPaddingRatio:a,innerPaddingRatio:r})},y.getDefaultColumnLabelSettings=function(e,t){void 0===t&&(t=!1);var i=m.DataLabelViewModel.getDefaultLabelSettings({style:e,textClassName:"smallLightLabel",noColor:!0});return i.position=null,i.labelDensity=m.DataLabelViewModel.defaultLabelDensity,i.labelOrientation=1,t?(i.enableBackground=!0,i.backgroundColor=m.ColorHelper.getThemeColor(e,m.BackgroundColorName),i.backgroundTransparency=m.DataLabelViewModel.defaultComboChartLabelBackgroundOpacity):i.enableBackground=!1,i},y.getDefaultLineChartSeriesLabelSettings=function(e){var t=m.ColorHelper.getThemeColor(e,m.DataLabelViewModel.DefaultLabelColorName),e=m.DataLabelViewModel.getDefaultLabelSettings({style:e,labelColor:t,textClassName:"smallLightLabel"}).fontProperties;return{show:!1,seriesColor:t,seriesPosition:m.labelSeriesPosition.right,fontProperties:e,seriesWordWrap:!1,seriesMaximumWidth:20,defaultSeriesWidth:20,showLabelPerSeries:!1,enableBackground:!1}},y.converter=function(e){return(new m.ColumnChartConverter).convert(e)},y.sliceSeries=function(e,t,i){void 0===i&&(i=0);var a=[];if(e&&0<e.length)for(var r=0,s=e.length;r<s;r++)(a[r]=u.Prototype.inherit(e[r])).data=e[r].data.filter(function(e){return e.categoryIndex>=i&&e.categoryIndex<t});return a},y.getInteractiveColumnChartDomElement=function(e){return e.children("svg").get(0)},y.prototype.setData=function(e,t){var i,a,r=y.isStacked100(this.chartType);this.data=this.originalData={categories:[],categoryFormatter:null,series:[],totals:[],valuesMetadata:[],legendData:null,hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,dataLabelsSettings:y.getDefaultColumnLabelSettings(this.style),seriesLabelSetings:y.getDefaultLineChartSeriesLabelSettings(this.style),hasDynamicSeries:!1,isMultiMeasure:!1},0<e.length&&((e=this.dataView=e[0])&&e.categorical&&(a=(a=e.categorical.categories)&&0<a.length?a[0].source:null,a=m.AxisHelper.getCategoryValueType(a),i=m.CartesianHelper.hasCategoryHierarchy(e),a=m.ScalarUtils.shouldDrawScalar(e.metadata?e.metadata.objects:null,m.columnChartProps.categoryAxis.axisType,a,void 0,i),this.data=this.originalData=y.converter({dataView:e,style:this.style,is100PercentStacked:r,isScalar:a,dataViewMetadata:e.metadata,multipleInfo:t,chartType:this.chartType,interactivityService:this.interactivityService,tooltipsEnabled:this.tooltipsEnabled,hostServices:this.hostService,ribbonChart:this.ribbonChart,isCombo:this.isComboChart,buildCategories:void 0,supportsTotalLabels:!t&&this.supportsTotalLabels(),featureSwitches:this.featureSwitches})))},y.getChartStrategy=function(e,t){switch(e){case 10:return new m.ClusteredBarChartStrategy;case 12:return new m.ClusteredColumnChartStrategy;case 18:return new(y.isStacked(e,t)?m.StackedBarChartStrategy:m.ClusteredBarChartStrategy);case 50:return new m.StackedBarChartStrategy;case 20:return new(y.isStacked(e,t)?m.StackedColumnChartStrategy:m.ClusteredColumnChartStrategy);default:return new m.StackedColumnChartStrategy}},y.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&1<this.data.series.length)},y.prototype.getSeriesSettings=function(){return u.Prototype.inherit(this.data).seriesLabelSetings},y.prototype.enumerateObjectInstances=function(e,t){var i;switch(t.objectName){case"dataPoint":this.dataView&&!m.GradientUtils.hasGradientRole(this.dataView.categorical)&&this.enumerateDataPoints(e);break;case"labels":this.enumerateDataLabels(e);break;case"seriesLabels":null!=(i=this.featureSwitches)&&i.lineChartSeriesLabels&&this.enumerateSeriesDataLabels(e);break;case"totals":this.supportsTotalLabels()&&this.enumerateTotalLabels(e);break;case"ribbonChart":y.getRibbonsUtils().enumerateRibbonChart(e,this.data.ribbonChartData,this.ribbonChart)}},y.prototype.getFormattingCards=function(e){var t=this;return{card:[function(){return t.ribbonChart?y.getRibbonsUtils().getRibbonChartCard(t.getRibbonDataPointFormattingOptions(e.categoryAxisData)):t.getDataPointCard(e.categoryAxisData)},function(){return t.getLabelsCard()},function(){return t.getTotalsCard()},function(){return t.getErrorBarsCard()}].reduce(function(e,t){t=t();return t&&e.push(t),e},[]),type:5}},y.prototype.getDataPointCard=function(a){var r=this;if(this.dataView&&!m.GradientUtils.hasGradientRole(this.dataView.categorical)){var s=function(e){return r.hostService.getLocalizedString(e)},o=this.originalData;if(o){var e,n=o.series.length;if(0!==n)return(e=new m.builder.FormattingCardBuilder(new m.builder.FormattingCardUidBuilder("bars"),y.isColumn(this.chartType)?"Role_DisplayName_Columns":"Visual_Bars_Title",[m.columnChartProps.dataPoint.fill,m.columnChartProps.dataPoint.showAllDataPoints,m.cartesianChartProps.categoryAxis.innerPadding,m.cartesianChartProps.categoryAxis.preferredCategoryWidth,m.cartesianChartProps.categoryAxis.reverseStackOrder],s)).addGroup("colors",function(e){var t,i;e.withDisplayName("Visual_Colors"),o.hasDynamicSeries||1<n||!o.categoryMetadata?(t=y.isStacked(r.chartType,n)||y.isStacked100(r.chartType),i={groupBuilder:e,dataPoints:o.series,seriesColorProps:m.columnChartProps.dataPoint,localize:s,featureSwitches:r.featureSwitches},u.colorEnumerationHelperModuleFactory().appendSeriesColorSlicesToGroup(i),r.featureSwitches&&r.featureSwitches.flipStackOrder&&t&&e.addSimpleSlice("Visual_ReverseStackOrder",new h.ToggleSwitchBuilder({descriptor:(r.isComboChart?m.comboChartObjectProps:m.cartesianChartProps).categoryAxis.reverseStackOrder,value:a.reverseStackOrder}).build())):(i={groupBuilder:e,colorProps:m.columnChartProps.dataPoint,featureSwitches:r.featureSwitches,hostService:r.hostService,options:{dataView:r.dataView,style:r.style,categories:_.map(o.series[0].data,function(e){var t,i=(i=null==(i=null==(t=o.categoryIdentities)?void 0:t[e.categoryIndex])?void 0:i.call(t))||e.identity;return{color:e.color,displayName:o.categoryFormatter.format(o.categories[e.categoryIndex]),identity:i}}),fillInstanceKind:3,multipleRole:o.multipleIdentity?m.columnRoleNames.rows:void 0}},u.colorEnumerationHelperModuleFactory().appendCategoryColorSlicesToGroup(i))}),this.getVisualCategoryAxisIsScalar()||e.addGroup("spacing",function(e){var t=a.innerPadding;e.withDisplayName("RibbonChart_SeriesGapWidth").addSimpleSlice("innerPadding",new m.builder.SliderBuilder({descriptor:m.cartesianChartProps.categoryAxis.innerPadding,value:void 0!==t?Math.round(100*t):void 0,options:{minValue:{type:0,value:m.innerPaddingMin},maxValue:{type:1,value:m.innerPaddingMax},unitSymbol:"Numeric_Pixel"},localize:s}).build()).addSimpleSlice("categoryWidth",new m.builder.NumUpDownBuilder({descriptor:m.cartesianChartProps.categoryAxis.preferredCategoryWidth,value:a.preferredCategoryWidth,options:{minValue:{type:0,value:m.preferredCategoryWidthMin},maxValue:{type:1,value:m.preferredCategoryWidthMax},unitSymbol:"Numeric_Pixel"}}).build())}),e.build()}}},y.prototype.getLabelsCard=function(){function s(e){return o.hostService.getLocalizedString(e)}var o=this,n=this.originalData,e=n.dataLabelsSettings,l=n.series.length,c=1<l||!n.categoryMetadata||this.isComboChart,t=n.dataLabelsSettings.position!==m.labelPosition.outsideEnd,u=v(this.chartType,n.series.length)?m.clusteredValidLabelPositionOptions:m.stackedValidLabelPositionOptions,i=(e.position&&u.indexOf(e.position)<0&&(e.position=g),__assign(__assign({},m.columnChartProps.labels),{position:m.columnChartProps.labels.labelPosition,precision:m.columnChartProps.labels.labelPrecision,displayUnits:m.columnChartProps.labels.labelDisplayUnits,labelBackgroundColor:m.columnChartProps.labels.backgroundColor,labelBackgroundTransparency:m.columnChartProps.labels.backgroundTransparency})),a=(y.isColumn(this.chartType)||delete i.labelOrientation,new m.builder.FormattingCardBuilder(new m.builder.FormattingCardUidBuilder("labels"),"Visual_DataPointsLabels",i,s)),r=this.getLabelSettingsOptions(void 0,e,null,c,u,t),d={cardBuilder:a,dataLabelsProps:i,featureSwitches:this.featureSwitches,includeAltConstantValueSelector:!0,hostServices:this.hostService,options:r,individualSelector:m.DataLabelViewModel.generateLabelIndividualSelector({featureSwitches:this.featureSwitches,hasCategories:null!=_.first(n.categories),hasDynamicSeries:n.hasDynamicSeries,hasSeriesSelector:!1})};return i.show&&a.addTopLevelToggle("show",function(){return new h.ToggleSwitchBuilder({descriptor:i.show,value:r.dataLabelsSettings.show}).build()}),a.addGroup("applySettingsTo",function(e){e.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(e){if(e.withDisplayName("Series"),e.addContainerItem("all",s("All"),function(e){return m.DataLabelViewModel.createDataLabelsFormattingContainers(d,e)}),c)for(var t=0;t<l;t++){var i=n.series[t],a=i.labelSettings||n.dataLabelsSettings,r=(a.position&&u.indexOf(a.position)<0&&(a.position=g),i.identity.getSelector()),a=o.getLabelSettingsOptions(void 0,a,r,void 0,u);d.includeAltConstantValueSelector=!1,d.selector=n.hasDynamicSeries?p.normalizeSelector(r):r,d.individualSelector=m.DataLabelViewModel.generateLabelIndividualSelector({featureSwitches:o.featureSwitches,hasCategories:null!=_.first(n.categories),hasDynamicSeries:n.hasDynamicSeries,hasSeriesSelector:!0}),d.options=a,d.displayDisabledSlices=((r={}).labelOverflow=!0,r),e.addContainerItem(i.displayName,i.displayName,function(e){return m.DataLabelViewModel.createDataLabelsFormattingContainers(d,e)})}})}),a.build()},y.prototype.getTotalsCard=function(){var t=this,e=this.originalData,i=e.totalLabelsSettings;if(i&&!y.isClustered(this.chartType)&&!this.ribbonChart&&!y.isStacked100(this.chartType)){var a=__assign(__assign({},m.columnChartProps.totals),{precision:m.columnChartProps.totals.labelPrecision,displayUnits:m.columnChartProps.totals.labelDisplayUnits}),r=new m.builder.FormattingCardBuilder(new m.builder.FormattingCardUidBuilder("totals"),"Visual_DataTotalLabels",a,function(e){return t.hostService.getLocalizedString(e)});if(!this.supportsTotalLabels())return s=!(!this.data||!this.data.multipleIdentity),r.withDisabled(!0,s?"Visual_Totals_DisabledReason_SmallMultiples":"Visual_Totals_DisabledReason"),r.addTopLevelToggle("show",function(){return new h.ToggleSwitchBuilder({descriptor:a.show,value:!1}).build()}),r.build();var s={cardBuilder:r,dataLabelsProps:a,featureSwitches:this.featureSwitches,hostServices:this.hostService,options:this.getTotalLabelSettingsOptions(void 0,i),individualSelector:m.DataLabelViewModel.generateLabelIndividualSelector({featureSwitches:this.featureSwitches,hasCategories:null!=_.first(e.categories),hasDynamicSeries:e.hasDynamicSeries,hasSeriesSelector:!1})};return m.DataLabelViewModel.getDataLabelsFormattingModel(s)}},y.prototype.getErrorBarsCard=function(){var n=this;if(this.featureSwitches&&this.featureSwitches.columnChartError&&this.featureSwitches.lineChartError&&!this.isStacked()&&!this.ribbonChart){var l,e,c=this.originalData;if(c&&c.series&&0!==c.series.length)return l=function(e){return n.hostService.getLocalizedString(e)},e=[(e=m.StandardObjectIdentifiers.error).enabled,e.errorRange,e.barShow,e.barMatchSeriesColor,e.barColor,e.barWidth,e.barBorderColor,e.barBorderSize,e.markerShape,e.markerSize,e.labelShow,e.labelFontFamily,e.labelFontSize,e.labelBold,e.labelItalic,e.labelUnderline,e.labelColor,e.labelMatchSeriesColor,e.labelFormat,e.labelBackground,e.labelBackgroundColor,e.labelBackgroundTransparency,e.showMarkerByDefault,e.tooltipShow,e.tooltipFormat],(e=new m.builder.FormattingCardBuilder(new m.builder.FormattingCardUidBuilder("errorBars"),"Visual_Error_Bars",e,l,!0,!0)).addGroup("applySettingsTo",function(e){e.withDisplayName("Apply_Settings_To").withCollapsible(!1),e.addContainer("measure",function(o){o.withDisplayName("Series");for(var e=0,t=c.valuesMetadataBySeries;e<t.length;e++)!function(e){var t,i,a,r,s=_.first(e.usedInSeriesIndices);null!=s&&(t=e.metadataColumn,s=c.series[s],i=__assign({},e.valueSelector.getSelector()),a=__assign(__assign({},i),{data:[d.create()],highlightMatching:1}),r={localize:l,uncertainty:s.uncertainty,targetMeasure:e.metadataColumn.expr,measureSelector:i,dataPointSelector:a,featureSwitches:n.featureSwitches,uncertaintyOptions:{isCombo:n.isComboChart,hideBand:!0}},o.addContainerItem(t.queryName,t.displayName,function(e){return m.UncertaintyHelper.getFormattingContainer(r,e)}))}(t[e])})}),e.build()}},y.prototype.getRibbonDataPointFormattingOptions=function(e){var t=this,a=this.originalData;if(a){var i=a.series.length;if(0!==i)return{localize:function(e){return t.hostService.getLocalizedString(e)},categoryAxisData:e,ribbonChartData:this.data.ribbonChartData,data:a,colorOptions:{groupBuilder:void 0,colorProps:m.columnChartProps.dataPoint,featureSwitches:this.featureSwitches,hostService:this.hostService,options:{dataView:this.dataView,style:this.style,categories:_.map(a.series[0].data,function(e){var t,i=(i=null==(i=null==(t=a.categoryIdentities)?void 0:t[e.categoryIndex])?void 0:i.call(t))||e.identity;return{color:e.color,displayName:a.categoryFormatter.format(a.categories[e.categoryIndex]),identity:i}}),fillInstanceKind:3,multipleRole:a.multipleIdentity?m.columnRoleNames.rows:void 0}}}}},y.prototype.getSubSelectionStyles=function(e){var t,i,e=_.first(e).visualObjects;if(0<e.length&&((e=e[0])&&e.selectorsByColumn&&(t=p.normalizeSelector(p.convertSelectorsByColumnToSelector(e.selectorsByColumn))),"columns"===e.objectName))return i=(e="bars-colors")+"-datapoint",1===this.data.series.length&&(i=e+"-defaultColor",t={data:[u.data.DataViewWildcard.create(1)]}),r.getShapeSubSelectionStyles("Visual-bars",e,i,this.hostService,!1,!0,t)},y.prototype.getSubSelectionShortcuts=function(e){e=_.first(e).visualObjects;if(0<e.length){var t,e=e[0],i=!this.showLabelPerSeries(),i=(i||_.isEmpty(e.selectorsByColumn)||(t=p.normalizeSelector(p.convertSelectorsByColumnToSelector(e.selectorsByColumn))),i?"Visual-labels":"labels-applySettingsTo-series--showSeries"),a=y.isBar(this.chartType);if("columns"===e.objectName)return a=[{type:1,destinationUids:[{cardUid:"Visual-bars",groupUid:e="bars-colors"}],label:this.hostService.getLocalizedString(a?"Format_Bars":"Format_Columns")}],this.supportsTotalLabels()&&a.unshift({type:2,sourceUid:"Visual-totals",enabledLabel:this.hostService.getLocalizedString("Format_AddTotalLabels")}),a.unshift({type:0,relatedResetSourceUids:[e]},{type:2,sourceUid:i,enabledLabel:this.hostService.getLocalizedString("Format_AddDataLabels"),selector:t}),a}},y.prototype.enumerateDataLabels=function(e){var t=this.originalData,i=t.dataLabelsSettings,a=t.series.length,r=1<a||!t.categoryMetadata||this.isComboChart,s=t.dataLabelsSettings.position!==m.labelPosition.outsideEnd,o=v(this.chartType,t.series.length)?m.clusteredValidLabelPositionOptions:m.stackedValidLabelPositionOptions;if(m.DataLabelViewModel.enumerateDataLabels(this.getLabelSettingsOptions(e,i,null,r,o,s),this.featureSwitches),r&&i.showLabelPerSeries)for(var n=0;n<a;n++){var l=t.series[n],c=l.labelSettings||t.dataLabelsSettings,u=l.identity.getSelector();t.hasDynamicSeries&&(u=p.normalizeSelector(u)),e.pushContainer({displayName:l.displayName}),m.DataLabelViewModel.enumerateDataLabels(this.getLabelSettingsOptions(e,c,u,void 0,o),this.featureSwitches),e.popContainer()}},y.prototype.showSeriesCard=function(){return!(this.isComboChart&&!this.data.hasY2Role)},y.prototype.enumerateSeriesDataLabels=function(e){var t,i;this.showSeriesCard()&&(t=this.originalData.seriesLabelSetings,i=this.showLabelPerSeries(),m.DataLabelViewModel.enumerateSeriesDataLabels(this.getSeriesLabelSettingsOptions(e,t,null,i),this.featureSwitches))},y.prototype.getLabelSettingsOptions=function(e,t,i,a,r,s){var o=!!i;return{enumeration:e,dataLabelsSettings:t,show:!0,position:!_.isEmpty(r),positionObject:r,labelOrientation:!y.isBar(this.chartType)&&!o,displayUnits:!y.isStacked100(this.chartType),precision:!0,selector:i,showAll:a,fontSize:!0,fontFamily:!0,labelDensity:this.data&&this.data.scalarCategoryAxis,labelOverflow:!o&&s,enableBackground:t.enableBackground,backgroundColor:t.backgroundColor,backgroundTransparency:t.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0}},y.prototype.getSeriesLabelSettingsOptions=function(e,t,i,a){return{enumeration:e,show:!0,seriesLabelsSettings:t,seriesColor:t.seriesColor,seriesPosition:t.seriesPosition,selector:i,enableBackground:t.enableBackground,backgroundColor:t.backgroundColor,backgroundTransparency:t.backgroundTransparency,style:this.style,fontProperties:t.fontProperties,seriesWordWrap:t.seriesWordWrap,seriesMaximumWidth:t.seriesMaximumWidth,defaultSeriesWidth:t.defaultSeriesWidth,showAll:a,fontSize:!0,fontFamily:!0,bold:!0,italic:!0,underline:!0}},y.prototype.showLabelPerSeries=function(){var e=this.originalData;return 1<e.series.length||!e.categoryMetadata||this.isComboChart},y.prototype.enumerateTotalLabels=function(e){var t=this.originalData.totalLabelsSettings;t&&m.DataLabelViewModel.enumerateDataLabels(this.getTotalLabelSettingsOptions(e,t),this.featureSwitches)},y.prototype.getTotalLabelSettingsOptions=function(e,t){return{enumeration:e,dataLabelsSettings:t,show:!0,displayUnits:!0,precision:!0,fontSize:!0,fontFamily:!0,showPositiveAndNegative:!0,enableBackground:t.enableBackground,backgroundColor:t.backgroundColor,backgroundTransparency:t.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0}},y.prototype.enumerateDataPoints=function(e){var t,a=this.originalData;!a||0!==(t=a.series.length)&&(a.hasDynamicSeries||1<t||!a.categoryMetadata?u.colorEnumerationHelperModuleFactory().enumerateSeriesDataColors({enumeration:e,dataPoints:a.series},this.featureSwitches):u.colorEnumerationHelperModuleFactory().enumerateCategoryDataColors({enumeration:e,dataView:this.dataView,style:this.style,categories:_.map(a.series[0].data,function(e){var t,i=(i=null==(i=null==(t=a.categoryIdentities)?void 0:t[e.categoryIndex])?void 0:i.call(t))||e.identity;return{color:e.color,displayName:a.categoryFormatter.format(a.categories[e.categoryIndex]),identity:i}}),fillInstanceKind:3,multipleRole:a.multipleIdentity?m.columnRoleNames.rows:void 0},this.featureSwitches))},y.prototype.getCategoryDomain=function(){var e=this.data;return e?m.AxisHelper.createDomain(e.series,e.categoryMetadata?e.categoryMetadata.type:u.ValueType.fromDescriptor({text:!0}),e.scalarCategoryAxis,void 0):void 0},y.prototype.calculateAxesProperties=function(e){this.currentViewport=e.viewport,this.viewModelAdapterFactory&&this.originalData&&(r=this.viewModelAdapter=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport}),this.data=r.getData());var t,i,a,r=this.data,s=this.margin=e.margin,o=this.ribbonChart?y.ribbonChartInnerPaddingRatio:e.innerPaddingRatio,n=r&&r.categories?r.categories.length:0,l=r?this.getCategoryLayout(n,e.categoryAxisOptions,e.trimOrdinalDataOnOverflow,e.outerPaddingRatio,o):this.getEmptyChartLayout(),r=this.adjustLayoutForScroll(r,n,e.trimOrdinalDataOnOverflow,l),n=y.isStacked100(this.chartType),c=(this.updateColumnChart(r,l,s),y.isBar(this.chartType)),u=c?(t=e.valueAxisOptions,e.categoryAxisOptions):(t=e.categoryAxisOptions,e.valueAxisOptions),d=this.strategy.createXAxis({is100Pct:n,forcedTickCount:e.forcedTickCount,includeXDomain:t.includeDomain,axisZoom:e.axisZoom,axisScaleType:t.scaleType,logAxisScale:t.logAxisScale,axisDisplayUnits:t.displayUnits,axisPrecision:t.precision,outerPaddingRatio:c?0:l.outerPaddingRatio,margin:s,innerPaddingRatio:o,invertAxis:t.invertAxis},this.featureSwitches),l=this.strategy.createYAxis({is100Pct:n,forcedTickCount:e.forcedTickCount,includeYDomain:u.includeDomain,axisZoom:e.axisZoom,axisScaleType:u.scaleType,logAxisScale:u.logAxisScale,axisDisplayUnits:u.displayUnits,axisPrecision:u.precision,outerPaddingRatio:c?l.outerPaddingRatio:0,margin:s,innerPaddingRatio:o,invertAxis:u.invertAxis},this.featureSwitches),h=r.dataLabelsSettings&&r.dataLabelsSettings.show,p=r.totalLabelsSettings&&r.totalLabelsSettings.show&&this.supportsTotalLabels(),h=h&&y.isClustered(this.chartType);return(p||h)&&(p=y.adjustDomainForLabels(c,r,d,l),c?(i=m.AxisHelper.createScalarDomainOptions(d.scale.domain(),0),a=m.AxisHelper.mergeScalarAxisDomains(m.AxisHelper.createScalarDomainOptions(p,0,[!0,!0]),t.includeDomain,i),d=this.strategy.createXAxis({is100Pct:n,forcedTickCount:e.forcedTickCount,includeXDomain:a,axisZoom:e.axisZoom,axisScaleType:t.scaleType,logAxisScale:t.logAxisScale,axisDisplayUnits:t.displayUnits,axisPrecision:t.precision,outerPaddingRatio:0,margin:s,innerPaddingRatio:o,skipAxisZoomUpdate:!0,invertAxis:t.invertAxis},this.featureSwitches)):(i=m.AxisHelper.createScalarDomainOptions(l.scale.domain(),0),a=m.AxisHelper.mergeScalarAxisDomains(m.AxisHelper.createScalarDomainOptions(p,0,[!0,!0]),u.includeDomain,i),l=this.strategy.createYAxis({is100Pct:n,forcedTickCount:e.forcedTickCount,includeYDomain:a,axisZoom:e.axisZoom,axisScaleType:u.scaleType,logAxisScale:u.logAxisScale,axisDisplayUnits:u.displayUnits,axisPrecision:u.precision,outerPaddingRatio:0,margin:s,innerPaddingRatio:o,skipAxisZoomUpdate:!0,invertAxis:u.invertAxis},this.featureSwitches))),[d,l]},y.prototype.setAxesLayout=function(e){this.currentViewport=e.layout.viewport,this.viewModelAdapterFactory&&this.originalData&&(t=this.viewModelAdapter=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport}),this.data=t.getData());var t=e.layout.axes,t=(this.xAxisProperties=t.x,this.yAxisProperties=t.y1,this.margin=e.layout.margin),i=this.data,a=this.xAxisProperties,r=(y.isBar(this.chartType)&&(a=this.yAxisProperties),i&&i.categories?i.categories.length:0),a=i?{categoryCount:_.isEmpty(a.categoryIdentities)?0:a.categoryIdentities.length,categoryThickness:a.categoryThickness,outerPaddingRatio:a.outerPaddingRatio,innerPaddingRatio:a.innerPaddingRatio,isScalar:this.getVisualCategoryAxisIsScalar()}:this.getEmptyChartLayout();this.data=this.adjustLayoutForScroll(i,r,e.trimOrdinalDataOnOverflow,a),this.updateColumnChart(this.data,a,t)},y.prototype.getAxesDomains=function(e,t){var i,a={},r=this.data;return r&&(t.categoryAxis&&r.scalarCategoryAxis&&((i=this.getCategoryDomain())&&(m.AxisHelper.assertScalarDomain(i),a.categoryAxis=[i[0],i[1]])),t.valueAxis&&(i=y.isStacked100(this.chartType),t=void 0,i=(t=this.isStacked()?[(i=m.StackedUtil.calcValueDomain(r.series,i)).min,i.max]:m.AxisHelper.createUncertaintyAwareValueDomain(r.series,e)||m.emptyDomain)[0],r=t[1],void 0!==i&&void 0!==r&&(a.valueAxis=[i,r]))),a},y.prototype.getEmptyChartLayout=function(){return{categoryCount:0,categoryThickness:m.CartesianHelper.MinOrdinalRectThickness,outerPaddingRatio:0,innerPaddingRatio:0,isScalar:!1}},y.prototype.updateColumnChart=function(e,t,i){var a=this.getPreferredPlotArea(t.isScalar,t.categoryCount,t.categoryThickness,t.outerPaddingRatio),a={height:a.height,width:a.width,duration:0,hostService:this.hostService,unclippedGraphicsContext:this.unclippedGraphicsContext,mainGraphicsContext:this.mainGraphicsContext,margin:this.margin,layout:t,animator:this.animator,interactivityService:this.interactivityService,viewportHeight:this.currentViewport.height-(i.top+i.bottom),viewportWidth:this.currentViewport.width-(i.left+i.right),is100Pct:y.isStacked100(this.chartType),isComboChart:this.isComboChart};this.strategy=y.getChartStrategy(this.chartType,this.data&&this.data.series.length),this.strategy.setData(e),this.applyInteractivity(a),this.strategy.setupVisualProps(a),this.strategy.setAxisProperties(this.xAxisProperties,this.yAxisProperties)},y.prototype.adjustLayoutForScroll=function(e,t,i,a){return this.scrolledData=void 0,e&&!a.isScalar&&!this.isScrollable&&i&&(i=Math.min(t,a.categoryCount))!==t&&((e=this.scrolledData=u.Prototype.inherit(e)).series=y.sliceSeries(e.series,i),e.categories=e.categories.slice(0,i),e.categoryIdentities&&(e.categoryIdentities=e.categoryIdentities.slice(0,i))),e},y.adjustDomainForLabels=function(e,t,i,a){var r,s,o,n,l,a=e?i:a,c=a.dataDomain;if(c&&null!=c[0]&&null!=c[1])return n=c[0].toString(),s=c[1].toString(),r=a.scale,o="",0<t.series.length&&0<t.series[0].data.length&&(o=t.series[0].data[0].labelFormatString),l=m.DataLabelViewModel.createColumnFormatterCacheManager(),i=m.DataLabelRenderer.getLabelUnitAndPrecisionForAxis(i,t.totalLabelsSettings),l=l.getOrCreate(o,t.totalLabelsSettings,i.units,t.totalLabelsSettings.precision),o=m.DataLabelRenderer.getLabelFormattedText(l.format(n)),i=m.DataLabelRenderer.getLabelFormattedText(l.format(s)),n=m.FontProperties.toTextProperties(t.totalLabelsSettings.fontProperties,o),l=m.FontProperties.toTextProperties(t.totalLabelsSettings.fontProperties,i),i=o=s=void 0,i=e?(s=u.TextMeasurementService.measureSvgTextWidth(n),o=u.TextMeasurementService.measureSvgTextWidth(l),a.invertAxis?-1:1):(s=u.TextMeasurementService.estimateSvgTextHeight(n),o=u.TextMeasurementService.estimateSvgTextHeight(l),a.invertAxis?1:-1),e=r(c[0])-i*(s+m.DataLabelViewModel.labelMargin),n=r(c[1])+i*(o+m.DataLabelViewModel.labelMargin),l=!1,[(t.totalLabelsSettings.showPositiveAndNegative?(l=t.hasPositive,t.hasNegative):(l=t.hasNetPositive,t.hasNetNegative))?r.invert(e):void 0,l?r.invert(n):void 0]},y.prototype.getPreferredPlotArea=function(e,t,i,a){var r={height:this.currentViewport.height-this.margin.top-this.margin.bottom,width:this.currentViewport.width-this.margin.left-this.margin.right};return this.isScrollable&&!e&&(e=m.CartesianChartLayout.getPreferredCategorySpan(t,i,a),y.isBar(this.chartType)?r.height=Math.max(e,r.height):r.width=Math.max(e,r.width)),r},y.prototype.applyInteractivity=function(e){var i=this,t=this.interactivity;t&&(t.dragDataPoint&&(e.onDragStart=function(e){e.identity&&i.hostService.onDragStart({event:d3.event,data:{data:e.identity.getSelector()}})}),t.isInteractiveLegend&&(e=function(){var e=d3.mouse(i.mainGraphicsContext.node()),t=e[0],e=e[1],t=i.strategy.getClosestColumnIndex(t,e);i.selectColumn(t)},t=y.getInteractiveColumnChartDomElement(this.element),this.svg.on("click",e),d3.select(t).on("click",e).style("touch-action","none"),e=d3.drag().on("drag",e),this.svg.call(e),d3.select(t).call(e)))},y.prototype.selectLastSelectedColumnOrDefault=function(e){void 0===e&&(e=!1);var t=void 0===this.lastInteractiveSelectedColumnIndex?m.CartesianHelper.findMaxCategoryIndex(this.data.series):this.lastInteractiveSelectedColumnIndex;this.selectColumn(t,e)},y.prototype.selectColumn=function(e,t){var i;!(t=void 0!==t&&t)&&this.lastInteractiveSelectedColumnIndex===e||(i=this.createInteractiveLegendDataPoints(e),this.strategy.selectColumn(e,this.lastInteractiveSelectedColumnIndex,t),this.cartesianVisualHost.updateLegend(i),this.lastInteractiveSelectedColumnIndex=e)},y.prototype.createInteractiveLegendDataPoints=function(e){var t=this.data,i=m.Legend.getDefaultLegendData(this.style);if(t&&!_.isEmpty(t.series)){for(var a=m.columnChartProps.general.formatString,r=[],s=t.categories&&t.categories[e],o=t.series,n=t.legendData&&t.legendData.dataPoints,l=new m.ColumnChartConverterHelper(this.dataView,this.style),c=0,u=o.length;c<u;c++){var d,h=l.getValueBySeriesAndCategory(c,e),p=t.valuesMetadata[c],g=m.converterHelper.getFormattedLegendLabel(p,this.dataView.categorical.values,a),y=void 0;y=1===o.length?(d=o[0]).data.length>e&&d.data[e].color:n.length>c&&n[c].color,r.push({color:y,icon:m.LegendIcon.Box,label:g,category:t.categoryFormatter?t.categoryFormatter.format(s):s,measure:m.valueFormatter.format(h,m.valueFormatter.getFormatString(p,a)),identity:m.SelectionId.createNull(),selected:!1,index:c})}i.dataPoints=r}return i},y.prototype.overrideXScale=function(e){this.xAxisProperties=e},y.prototype.render=function(e,t,i){var a,r,e=this.strategy.drawColumns(!e,this.style),s=this.data,o=this.margin,n=this.currentViewport,l=n.height-(o.top+o.bottom),n=n.width-(o.left+o.right),c=(this.mainGraphicsContext.attr("height",l).attr("width",n),this.tooltipsEnabled&&!i?(this.tooltipService.addTooltip(e.eventGroup,function(e){return e.data&&e.data.tooltipInfo},function(e){return e.data&&e.data.identity&&[e.data.identity]}),e.ribbonChartEventGroup&&this.tooltipService.addTooltip(e.ribbonChartEventGroup,function(e){return e.data&&e.data.tooltipInfo},function(){return[m.SelectionId.createNull()]})):(this.tooltipService.removeTooltips(e.eventGroup),e.ribbonChartEventGroup&&this.tooltipService.removeTooltips(e.ribbonChartEventGroup)),[]),o=this.strategy.getColumnWidth(),l=this.strategy.getCategoryWidth?this.strategy.getCategoryWidth():o,n=y.isBar(this.chartType);if(this.interactivityService){for(var u=0,d=s.series.length;u<d;u++)c=c.concat(s.series[u].data);a={datapoints:c,columnChartDrawInfo:e,hasHighlights:s.hasHighlights,root:this.mainGraphicsContext,showLabel:s.dataLabelsSettings.show,bandsTransparency:this.data.ribbonChartData?this.data.ribbonChartData.ribbonOptions.bandsTransparency:30,visualInstanceId:this.hostService.instanceId,hitTester:new f({dataPoints:c,isScalar:s.scalarCategoryAxis,hasCategories:!!s.categoryIdentities&&0<s.categoryIdentities.length,isBar:n,isClustered:y.isClustered(this.chartType),categoryAxisScale:this.strategy.getCategoryAxisScale(),columnWidth:o,categoryWidth:l,seriesLength:s.series.length}),useManagedTabIndex:this.useManagedTabIndex},r={navigationStrategy:1<s.series.length?m.DataPointNavigationStrategy.CategoryFirst:m.DataPointNavigationStrategy.CategoryOnly,helper:this}}return this.interactivity&&this.interactivity.isInteractiveLegend&&this.selectLastSelectedColumnOrDefault(!0),m.SVGUtil.flushAllD3TransitionsIfNeeded(this.animationOptions),{dataPoints:c,behaviorOptions:a,navigationOptions:r,labelDataPoints:[],labelDataPointGroups:e.labelDataPointGroups,labelsAreNumeric:!0,labelOrientation:s.dataLabelsSettings.labelOrientation,animateLabels:e.animateLabels,categorySubRangeCount:Math.round(l/o),verticalCategoryAxis:n}},y.prototype.getFirstElement=function(e,t){void 0===t&&(t=!1);var i=(this.scrolledData||this.data).series;if(_.isEmpty(i))return null;var a,r,e=null!=e?e:i[0].data[0].categoryIndex,s=t?this.findSeriesIndex(i.length-1,e,!1):this.findSeriesIndex(0,e,!0);return 0<=s?(a=this.data.series[s].data[e],r=this.getDataPointElement(s,e)):s=t?i.length-1:0,{element:r,targetCategoryIndex:e,targetSeriesIndex:s,noShape:a&&0===a.valueAbsolute}},y.prototype.getNextDataPoint=function(e,t,i){switch(i=!y.isBar(this.chartType)||this.getVisualCategoryAxisIsScalar()||i!==m.DataDirection.NextSeries&&i!==m.DataDirection.PreviousSeries?i:i===m.DataDirection.NextSeries?m.DataDirection.PreviousSeries:m.DataDirection.NextSeries){case m.DataDirection.NextCategory:e=this.findCategoryIndex(this.data.series[t].data,e,!0);break;case m.DataDirection.PreviousCategory:e=this.findCategoryIndex(this.data.series[t].data,e,!1);break;case m.DataDirection.NextSeries:(t=this.findSeriesIndex(t+1,e,!0))<0&&(e=this.loopIndex(e+1,this.data.categories.length),t=this.findSeriesIndex(0,e,!0));break;case m.DataDirection.PreviousSeries:(t=0<t?this.findSeriesIndex(t-1,e,!1):-1)<0&&(e=this.loopIndex(e-1,this.data.categories.length),t=this.findSeriesIndex(this.data.series.length-1,e,!1))}var a,r;if(0<=t&&0<=e)a=this.data.series[t].data[e],r=this.getDataPointElement(t,e);else if(e<0)switch(i){case m.DataDirection.NextCategory:e=this.loopIndex(e+1,this.data.categories.length);break;case m.DataDirection.PreviousCategory:e=this.loopIndex(e-1,this.data.categories.length)}else switch(i){case m.DataDirection.NextSeries:t=0;break;case m.DataDirection.PreviousSeries:t=this.data.series.length-1}return this.isInViewport(r)?{element:r,targetCategoryIndex:e,targetSeriesIndex:t,noShape:a&&0===a.valueAbsolute}:this.getNextDataPoint(e,t,i)},y.prototype.getSelectorsByColumnFromSubselectedElement=function(e){switch(d3.select(e).attr(m.SubSelectableObjectNameAttribute)){case"columns":var t=d3.select(e).datum().seriesIndex,i=this.data.series;if(!_.isEmpty(i)&&0<=t){i=i[t],i=null==(t=null==i?void 0:i.identity)?void 0:t.getSelectorsByColumn();if(i)return i}case"data-labels":case"series-labels":return m.DataLabelUtil.getLabelSeriesSelectorsByColumn(e,this.data.series);default:return{}}},y.prototype.isInViewport=function(e){if(!e)return!0;var e=e.getBBox(),t=this.currentViewport;return 0<e.y+e.height&&e.y<t.height&&0<e.x+e.width&&e.x<t.width},y.prototype.getDataPointElement=function(t,i){var e=y.isColumn(this.chartType)?".column":".bar";return this.mainGraphicsContext.selectAll(e).filter(function(e){return e.categoryIndex===i&&e.seriesIndex===t}).node()},y.prototype.findSeriesIndex=function(e,t,i){return(i?_.findIndex:_.findLastIndex)(this.data.series,function(e){return _.some(e.data,function(e){return e.categoryIndex===t&&null!=e.value})},e)},y.prototype.findCategoryIndex=function(e,t,i){var i=i?1:-1,a=_.findIndex(e,function(e){return e.categoryIndex===t});return a<0?a:e[a=this.loopIndex(a+i,e.length)].categoryIndex},y.prototype.loopIndex=function(e,t){return t<=e?0:e<0?t-1:e},y.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},y.prototype.getCategoryValueType=function(){return m.AxisHelper.getCategoryValueType(this.data.categoryMetadata)},y.prototype.getVisualCategoryAxisIsScalar=function(){return!!this.data&&this.data.scalarCategoryAxis},y.prototype.getSupportedCategoryAxisType=function(){var e=this.data?this.data.categoryMetadata:void 0,e=m.AxisHelper.getCategoryValueType(e);return m.AxisHelper.isOrdinal(e)?m.axisType.categorical:m.axisType.both},y.prototype.setFilteredData=function(e,t){var i=this.scrolledData=u.Prototype.inherit(this.data);return i.series=y.sliceSeries(i.series,t,e),i.categories=i.categories.slice(e,t),this.strategy.setData(i),i},y.prototype.supportsTotalLabels=function(){return!!(!this.data||!this.data.multipleIdentity)&&this.isStacked()&&!y.isStacked100(this.chartType)},y.prototype.supportsTrendLine=function(){if(this.data.multipleIdentity)return!1;var e=this.dataView,e=u.data.createDataViewCategoricalReader(e),t=this.getVisualCategoryAxisIsScalar();return 12===this.chartType&&t&&e.data.hasValues("Y")},y.prototype.supportsStaticReferenceLines=function(){return 68!==this.chartType},y.prototype.supportsValueAxis=function(){return 68!==this.chartType},y.prototype.isStacked=function(){return y.isStacked(this.chartType,this.data&&this.data.series.length)},y.isBar=function(e){return a.hasFlag(e,2)},y.isColumn=function(e){return a.hasFlag(e,4)},y.isClustered=function(e){return a.hasFlag(e,8)},y.isStacked=function(e,t){return a.hasFlag(e,16)&&(1!==t||y.isStacked100(e))},y.isStacked100=function(e){return a.hasFlag(e,48)},y.isRibbon=function(e){return a.hasFlag(e,64)},y.prototype.getCartesianVisualCapabilities=function(){var e=this.supportsValueAxis(),t=e&&!this.isStacked(),t={categoryAxis:{domainAggregateRole:m.columnRoleNames.category,supportedDomainAggregates:this.data&&this.data.scalarCategoryAxis?3:0},valueAxis:{domainAggregateRole:m.columnRoleNames.y,supportedDomainAggregates:t?3:1}};return{supportsHierarchicalCategoryAxis:y.isColumn(this.chartType),supportsValueAxis:e,axesCapabilities:t}},y.prototype.getStaticSeriesRole=function(){return"Y"},y.getRibbonsUtils=function(){return u.ribbonChartUtilsModuleFactory()},y.prototype.addWarnings=function(e){this.viewModelAdapter&&this.viewModelAdapter.addWarnings(e)},y.RibbonChartItemClasses=e("ribbonChartArea"),y.RibbonChartLayerClasses=e("ribbonChartLayer"),y.ribbonChartInnerPaddingRatio=.6,y);function y(e){var t=e.chartType;this.chartType=t,this.isScrollable=e.isScrollable,this.tooltipsEnabled=e.tooltipsEnabled,this.interactivityService=e.interactivityService,this.ribbonChart=68===this.chartType,this.viewModelAdapterFactory=e.viewModelAdapterFactory}m.ColumnChart=s,t.prototype.queryRegion=function(e){var t,i,a,r,s=this,o=[],e=e.dataSpace;return(this.isScalar||this.hasCategories&&!_.some([e.bottom,e.left,e.right,e.top],function(e){return void 0===e}))&&(r=this.isBar?(i=this.isScalar?(t=e.bottom.value,e.top.value):(t=this.getAdjustedCategoryIndex(e.top.value,e.top.seriesIndex,this.seriesLength),this.getAdjustedCategoryIndex(e.bottom.value,e.bottom.seriesIndex,this.seriesLength)),a=e.left.value,e.right.value):(i=this.isScalar?(t=e.left.value,e.right.value):(t=this.getAdjustedCategoryIndex(e.left.value,e.left.seriesIndex,this.seriesLength),this.getAdjustedCategoryIndex(e.right.value,e.right.seriesIndex,this.seriesLength)),a=e.bottom.value,e.top.value),o=_.filter(this.dataPoints,function(e){return 0!==e.valueAbsolute&&t<=i&&a<=r&&n.overlappingRange(t,i,s.getAreaCategoryBound(e,!1),s.getAreaCategoryBound(e,!0))&&n.overlappingRange(a,r,s.getAreaValueLowerBound(e),s.getAreaValueUpperBound(e))})),o},t.prototype.getAreaValueLowerBound=function(e){return this.isClustered?Math.min(0,e.value):e.position-e.valueAbsolute},t.prototype.getAreaValueUpperBound=function(e){return this.isClustered?Math.max(0,e.value):e.position},t.prototype.getAreaCategoryBound=function(e,t){var i,a;return this.isScalar?(t=(t=this.isBar?!t:t)?this.columnWidth:0,i=this.isClustered?e.seriesIndex:0,a=this.categoryAxisScale(e.categoryValue)-this.categoryWidth/2,m.AxisHelper.invertScale(this.categoryAxisScale,a+i*this.columnWidth+t,0,0,void 0).value):this.getAdjustedCategoryIndex(e.categoryIndex,e.seriesIndex,this.seriesLength)},t.prototype.getAdjustedCategoryIndex=function(e,t,i){return this.isClustered?e*i+t:e};var f=t;function t(e){e.columnWidth,e.categoryWidth,this.categoryAxisScale=e.categoryAxisScale,this.categoryWidth=e.categoryWidth,this.columnWidth=e.columnWidth,this.dataPoints=e.dataPoints,this.hasCategories=e.hasCategories,this.isBar=e.isBar,this.isClustered=e.isClustered,this.isScalar=e.isScalar,this.seriesLength=e.seriesLength}function v(e,t){return!s.isStacked(e,t)&&!s.isRibbon(e)}m.ColumnChartHitTester=f,m.canSupportOutsidePosition=v}(powerbi=powerbi||{}),function(e){var l,t;function i(e){return t.call(this,e)||this}l=e.visuals||(e.visuals={}),t=l.BaseAnimator,__extends(i,t),i.prototype.animate=function(e){var t={failed:!0,shapes:null},i=e.viewModel,a=this.previousViewModel;return i.categories.length*i.series.length>l.AnimatorCommon.MaxDataPointsToAnimate||a&&a.categories.length!==i.categories.length||(a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i),t},i.prototype.animateNormalToHighlighted=function(e){var t=e.viewModel,i=e.itemCS,a=e.layout,r=e.series.selectAll(i.selector).data(function(e){return e.data},function(e){return e.key}),s=e.interactivityService&&e.interactivityService.hasSelection(),o=t.hasHighlights,n=r.enter().append("rect").attr("class",function(e){return i.class.concat(e.highlight?" highlight":"")}).attrs(a.shapeLayoutWithoutHighlights).merge(r),a=(n.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return l.ColumnUtil.getFillOpacity(e.selected,e.highlight,s,o)}).transition().duration(this.animationDuration).attrs(a.shapeLayout),r.exit().remove(),l.ColumnUtil.drawUncertainty(t,e.isBar,e.mainGraphicsContext,e.valueAxisProps,e.layout,e.columnWidth,e.interactivityService));return{failed:!1,shapes:n,uncertaintyShapes:a}},i.prototype.animateHighlightedToHighlighted=function(e){return{failed:!1,shapes:this.animateDefaultShapes(e.viewModel,e.series,e.layout,e.itemCS,e.interactivityService&&e.interactivityService.hasSelection()),uncertaintyShapes:l.ColumnUtil.drawUncertainty(e.viewModel,e.isBar,e.mainGraphicsContext,e.valueAxisProps,e.layout,e.columnWidth,e.interactivityService)}},i.prototype.animateHighlightedToNormal=function(e){var t=e.itemCS,i=e.series.selectAll(t.selector).data(function(e){return e.data},function(e){return e.key}),a=e.interactivityService&&e.interactivityService.hasSelection(),r=i.enter().append("rect").attr("class",function(e){return t.class.concat(e.highlight?" highlight":"")}).merge(i),i=(r.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return l.ColumnUtil.getFillOpacity(e.selected,e.highlight,e.selected,!e.selected)}).transition().duration(this.animationDuration).attrs(e.layout.shapeLayout).transition().duration(0).style("fill-opacity",function(e){return l.ColumnUtil.getFillOpacity(e.selected,e.highlight,a,!1)}),i.exit().transition().duration(this.animationDuration).attrs(a?e.layout.zeroShapeLayout:e.layout.shapeLayoutWithoutHighlights).remove(),l.ColumnUtil.drawUncertainty(e.viewModel,e.isBar,e.mainGraphicsContext,e.valueAxisProps,e.layout,e.columnWidth,e.interactivityService));return{failed:!1,shapes:r,uncertaintyShapes:i}},i.prototype.animateDefaultShapes=function(t,e,i,a,r){var e=e.selectAll(a.selector).data(function(e){return e.data},function(e){return e.key}),s=e.enter().append("rect").attr("class",function(e){return a.class.concat(e.highlight?" highlight":"")}).merge(e);return s.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return l.ColumnUtil.getFillOpacity(e.selected,e.highlight,r,t.hasHighlights)}).transition().duration(this.animationDuration).attrs(i.shapeLayout),e.exit().remove(),s},l.WebColumnChartAnimator=i}(powerbi=powerbi||{}),function(e){!function(n){var l=jsCommon.BrowserUtils,c=jsCommon.DOMConstants.mouseClickEventName;function e(){}e.prototype.create=function(){return new t},n.ColumnChartWebBehaviorFactory=e;i.prototype.bindEvents=function(e,i,t,a){var r=this,s=(this.options=e,this.hitTester=e.hitTester,e.columnChartDrawInfo.eventGroup),o=e.root;a?(s&&(s.on(c,null),s.on("keydown.select",null),n.InteractivityUtils.removeStandardContextMenuHandler(s)),n.InteractivityUtils.removeStandardInteractivityHandlers(o)):(t&&(a=t.dataPointNavigationManager,t=t.pointSourceKey,a.isEmpty(t)||(n.InteractivityUtils.appendUseElementForFocus(o,e.visualInstanceId,t),n.InteractivityUtils.registerEnterPlotAreaHandler(o,a,t),n.InteractivityUtils.registerDataPointNavigationHandler(o,a,t),n.InteractivityUtils.registerClearCatcherShortcut(o,i))),s.on(c,function(){return r.handleSelection(i)}).on("keydown.select",function(){var e=d3.event.keyCode;32!==e&&13!==e||r.handleSelection(i)},!0),s.on("contextmenu",function(){var t,e=d3.event;l.isCtrlOrMeta(e)||(e.preventDefault(),n.EventBubblingUtil.markAsHandled(e),t=n.InteractivityUtils.getPositionOfLastInputEvent(),n.InteractivityUtils.tryToSelectD3Target(function(e){return i.handleContextMenu(e,t)}))}))},i.prototype.renderSelection=function(t){var e,i=this.options,a=i.columnChartDrawInfo;a.ribbonChartEventGroup&&(e=(100-i.bandsTransparency)/100,e=n.ColumnUtil.getFillOpacity(!1,!1,t,i.hasHighlights,e),a.ribbonChartEventGroup.style("fill-opacity",e).style("stroke-opacity",e)),a.shapesSelection.attr("aria-selected",function(e){return e.selected}).style("fill-opacity",function(e){return n.ColumnUtil.getFillOpacity(e.selected,e.highlight,t,i.hasHighlights)}).style("stroke-opacity",function(e){return n.ColumnUtil.getFillOpacity(e.selected,e.highlight,t,i.hasHighlights)}),a.uncertaintyShapes&&(null!=(e=a.uncertaintyShapes.bars)&&e.each(function(e){e.uncertainty.bar;d3.select(this).selectAll(n.ColumnUtil.UncertaintyBar.selector).style("fill-opacity",function(e){return t?n.ColumnUtil.getFillOpacity(e.selected,e.highlight,t,i.hasHighlights):null}).style("stroke-opacity",function(e){return t?n.ColumnUtil.getFillOpacity(e.selected,e.highlight,t,i.hasHighlights):null})}),null!=(e=a.uncertaintyShapes.markerPaths)&&e.style("opacity",t?n.ColumnUtil.getFillOpacity(!1,!0,t,i.hasHighlights):null),null!=(a=(e=a.uncertaintyShapes).updateActiveHighlightMarkers)&&a.call(e,t,i.hasHighlights))},i.prototype.renderFocus=function(e){var t=n.CurrentFocusDataPointId+"-"+this.options.visualInstanceId;this.options.root.select("#"+t).attr("id",null),e&&(e.setAttribute("id",t),(t=this.options.root.select("#"+t)).empty()||(t.attr("aria-label",function(e){return e.formattedTooltip}),l.focus(e)))},i.prototype.lassoSelectRectLayer=function(e){return this.hitTester.queryRegion(e)},i.prototype.getLassoSelectDirectionMode=function(){return 2},i.prototype.handleSelection=function(t){n.InteractivityUtils.tryToSelectD3Target(function(e){return n.InteractivityUtils.handleSelection(e,t)},!this.options.useManagedTabIndex)};var t=i;function i(){}n.ColumnChartWebBehavior=t}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(e){!function(y){function u(){}function d(){}u.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.hostService=e.hostService,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight},u.prototype.setData=function(e){this.data=e},u.prototype.setAxisProperties=function(e,t){this.xProps=e,this.yProps=t,e&&this.setSeriesOffsetScale(e.innerPaddingRatio)},u.prototype.createXAxis=function(e,t){var i=e.includeXDomain,a=e.axisScaleType,r=e.logAxisScale,s=e.axisDisplayUnits,o=e.axisPrecision,n=e.margin,l=this.width,c=y.AxisHelper.hasForcedDomain(i),l=y.ColumnUtil.getCategoryAxis(this.data,l,this.categoryLayout,!1,e.axisZoom,t,[i],a,r,s,o,n,c,e.innerPaddingRatio,e.invertAxis);return this.setSeriesOffsetScale(e.innerPaddingRatio),l},u.prototype.createYAxis=function(e,t){e.is100Pct;var i=e.forcedTickCount,a=e.includeYDomain,r=e.axisScaleType,s=e.logAxisScale,o=e.axisDisplayUnits,n=e.axisPrecision,l=e.outerPaddingRatio,c=e.margin,u=this.viewportHeight,d=y.AxisHelper.createUncertaintyAwareValueDomain(this.data.series)||y.emptyDomain,h=y.AxisHelper.getAxisFormatString(this.data.series),p=y.AxisHelper.mergeScalarAxisDomains(a,y.AxisHelper.createScalarDomainOptions(d,0)),d=y.AxisHelper.scaleShouldClamp(p&&p.domain,d),a=(a&&_.includes(a.domainSources,10)&&a.forced&&a.domain,y.AxisHelper.hasForcedDomain(p));return y.AxisHelper.createAxis({pixelSpan:u,dataDomain:p&&p.domain,axisZoom:e.axisZoom,zeroScalarDomain:[0,1],metaDataColumn:this.data.valuesMetadata,formatString:null!=h?h:y.valueFormatter.getFormatString(this.data.valuesMetadata[0],y.columnChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:i,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:r,logAxisScale:s,axisDisplayUnits:o,axisPrecision:n,shouldClamp:d,outerPaddingRatio:l,margin:c,preventNice:a,includeZero:y.AxisHelper.shouldIncludeZero(p),skipAxisZoomUpdate:e.skipAxisZoomUpdate,invertAxis:e.invertAxis,featureSwitches:t})},u.prototype.createLabelDataPoints=function(e){return y.ColumnUtil.createLabelDataPoints(this.data,this.layout,this.graphicsContext,this.yProps,!1,!0,e,this.yProps.invertAxis)},u.prototype.createUncertaintyLabels=function(e){return y.ColumnUtil.createUncertaintyLabels(this.data,this.layout,this.getColumnWidth(),this.yProps,!1,e,this.hostService)},u.prototype.getColumnWidth=function(){return this.getCategoryWidth()/this.data.series.length},u.prototype.getCategoryWidth=function(){return this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio)},u.prototype.getCategoryAxisScale=function(){return this.xProps.scale},u.prototype.drawColumns=function(e,t){var i,a,r,s=this.data,o=(this.columnsCenters=null,this.getCategoryWidth()),o={columnWidth:this.getColumnWidth(),categoryWidth:o,xScale:this.xProps.scale,yScale:this.yProps.scale,seriesOffsetScale:this.seriesOffsetScale,isScalar:this.categoryLayout.isScalar,margin:this.margin,invertAxis:this.yProps.invertAxis},n=this.layout=u.getLayout(s,o),l=s.dataLabelsSettings,c=[],l=(l&&l.show&&(c=this.createLabelDataPoints(t)),_.filter(s.series,function(e){return null==(e=e.uncertainty)?void 0:e.labels.show})),l=(_.isEmpty(l)||(c=c.concat(this.createUncertaintyLabels(t))),y.ColumnUtil.drawSeries(s,this.graphicsContext.mainGraphicsContext,o));return this.animator&&e&&(a=(i=this.animator.animate({viewModel:s,series:l,valueAxisProps:this.yProps,isBar:!1,columnWidth:this.getColumnWidth(),layout:n,itemCS:u.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}})).shapes,r=i.uncertaintyShapes),this.animator&&e&&!i.failed||(r=y.ColumnUtil.drawUncertainty(s,!1,this.graphicsContext.mainGraphicsContext,this.yProps,this.layout,this.getColumnWidth(),this.interactivityService),a=y.ColumnUtil.drawDefaultShapes(s,l,n,u.classes.item,!this.animator,this.interactivityService,this.hostService,!1)),y.ColumnUtil.applyInteractivity(a,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:a,uncertaintyShapes:r,viewport:{height:this.height,width:this.width},axisOptions:o,labelDataPointGroups:c,animateLabels:i&&!i.failed}},u.prototype.selectColumn=function(e,t,i){y.ColumnUtil.setSelectedColumnOpacity(this.graphicsContext.mainGraphicsContext,u.classes.item.selector,e,t,i),this.moveHandle(e)},u.prototype.getClosestColumnIndex=function(e,t){return y.ColumnUtil.getClosestColumnIndex(e,this.getColumnsCenters())},u.prototype.getColumnsCenters=function(){var t,e,i=this;return this.columnsCenters||(e=this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio),0<this.data.series.length&&(t=0,this.categoryLayout.isScalar||(t=e/2),e=this.data.series[0],this.columnsCenters=e.data.map(function(e){return i.xProps.scale(i.categoryLayout.isScalar?e.categoryValue:e.categoryIndex)+t}))),this.columnsCenters},u.prototype.setSeriesOffsetScale=function(e){var t=this.data.series.length,e=this.categoryLayout.categoryThickness*(1-e)/t;this.seriesOffsetScale=d3.scaleBand().domain(this.data.series.map(function(e){return e.index.toString()})).range([0,t*e])},u.prototype.moveHandle=function(e){var t,i=this.getColumnsCenters(),a=d3.select(".interactive-hover-line");a.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(a.node().parentNode)),!i||i.length<=1?this.columnSelectionLineHandle&&this.columnSelectionLineHandle.remove():(a=i[e],this.columnSelectionLineHandle?((t=this.columnSelectionLineHandle).select("line").attrs({x1:a,x2:a}),t.select("circle").attrs({cx:a})):((t=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g")).append("line").classed("interactive-hover-line",!0).attrs({x1:a,x2:a,y1:0,y2:this.height}),t.append("circle").attrs({cx:a,cy:this.height,r:"6px"}).classed("drag-handle",!0)))},u.getLayout=function(e,t){var i=t.columnWidth,a=.5*i,r=a/2,s=t.isScalar,o=t.xScale,n=t.yScale,l=t.seriesOffsetScale,c=t.invertAxis,u=n(0),d=0;return s&&(d=t.categoryWidth/2),{shapeLayout:{width:function(e){return e.drawThinner?a:i},x:function(e){return o(s?e.categoryValue:e.categoryIndex)+l(e.seriesIndex)-d+(e.drawThinner?r:0)},y:function(e){e=c?Math.min(0,e.value):Math.max(0,e.value);return u+y.AxisHelper.diffScaled(n,e,0)},height:function(e){return Math.abs(y.AxisHelper.diffScaled(n,0,e.value))}},shapeLayoutWithoutHighlights:{width:function(e){return i},x:function(e){return o(s?e.categoryValue:e.categoryIndex)+l(e.seriesIndex)-d},y:function(e){e=c?Math.min(0,e.originalValue):Math.max(0,e.originalValue);return u+y.AxisHelper.diffScaled(n,e,0)},height:function(e){return Math.abs(y.AxisHelper.diffScaled(n,0,e.originalValue))}},zeroShapeLayout:{width:function(e){return e.drawThinner?a:i},x:function(e){return o(s?e.categoryValue:e.categoryIndex)+l(e.seriesIndex)-d+(e.drawThinner?r:0)},y:function(e){return u},height:function(e){return 0}},uncertaintyLayout:{lower:function(e){e=e.uncertainty&&e.uncertainty.lower;if(null!=e)return n(e)},upper:function(e){e=e.uncertainty&&e.uncertainty.upper;if(null!=e)return n(e)}}}},u.classes={item:{class:"column",selector:".column"}},y.ClusteredColumnChartStrategy=u,d.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.hostService=e.hostService,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight},d.prototype.setData=function(e){this.data=e},d.prototype.setAxisProperties=function(e,t){this.xProps=e,(this.yProps=t)&&this.setSeriesOffsetScale(t.innerPaddingRatio)},d.prototype.createYAxis=function(e,t){var i=e.includeYDomain,a=e.axisScaleType,r=e.logAxisScale,s=e.axisDisplayUnits,o=e.axisPrecision,n=e.margin,l=this.height,c=y.AxisHelper.hasForcedDomain(i),l=y.ColumnUtil.getCategoryAxis(this.data,l,this.categoryLayout,!0,e.axisZoom,t,[i],a,r,s,o,n,c,e.innerPaddingRatio,e.invertAxis);return this.setSeriesOffsetScale(e.innerPaddingRatio),l},d.prototype.createXAxis=function(e,t){e.is100Pct;var i=e.forcedTickCount,a=e.includeXDomain,r=e.axisScaleType,s=e.logAxisScale,o=e.axisDisplayUnits,n=e.axisPrecision,l=e.outerPaddingRatio,c=e.margin,u=e.invertAxis,d=this.width,h=y.AxisHelper.createUncertaintyAwareValueDomain(this.data.series)||y.emptyDomain,p=y.AxisHelper.getAxisFormatString(this.data.series),a=y.AxisHelper.mergeScalarAxisDomains(a,y.AxisHelper.createScalarDomainOptions(h,0)),h=y.AxisHelper.scaleShouldClamp(a&&a.domain,h),g=y.AxisHelper.hasForcedDomain(a),d=y.AxisHelper.createAxis({pixelSpan:d,dataDomain:a&&a.domain,axisZoom:e.axisZoom,zeroScalarDomain:[0,1],metaDataColumn:this.data.valuesMetadata,formatString:null!=p?p:y.valueFormatter.getFormatString(this.data.valuesMetadata[0],y.columnChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!1,forcedTickCount:i,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:r,logAxisScale:s,axisDisplayUnits:o,axisPrecision:n,shouldClamp:h,outerPaddingRatio:l,margin:c,preventNice:g,includeZero:y.AxisHelper.shouldIncludeZero(a),skipAxisZoomUpdate:e.skipAxisZoomUpdate,invertAxis:u,featureSwitches:t});return d.axis.tickSizeInner(-this.viewportHeight).tickSizeOuter(0),d},d.prototype.createLabelDataPoints=function(e){return y.ColumnUtil.createLabelDataPoints(this.data,this.layout,this.graphicsContext,this.xProps,!0,!0,e,this.xProps.invertAxis)},d.prototype.createUncertaintyLabels=function(e){return y.ColumnUtil.createUncertaintyLabels(this.data,this.layout,this.getColumnWidth(),this.xProps,!0,e,this.hostService)},d.prototype.getColumnWidth=function(){return this.getCategoryWidth()/this.data.series.length},d.prototype.getCategoryWidth=function(){return this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio)},d.prototype.getCategoryAxisScale=function(){return this.yProps.scale},d.prototype.drawColumns=function(e,t){var i,a,r,s=this.data,o=(this.barsCenters=null,this.getCategoryWidth()),o={columnWidth:this.getColumnWidth(),categoryWidth:o,xScale:this.xProps.scale,yScale:this.yProps.scale,seriesOffsetScale:this.seriesOffsetScale,isScalar:this.categoryLayout.isScalar,margin:this.margin,invertAxis:this.xProps.invertAxis},n=this.layout=d.getLayout(s,o),l=s.dataLabelsSettings,c=[],l=(l&&l.show&&(c=this.createLabelDataPoints(t)),_.filter(s.series,function(e){return null==(e=e.uncertainty)?void 0:e.labels.show})),l=(_.isEmpty(l)||(c=c.concat(this.createUncertaintyLabels(t))),y.ColumnUtil.drawSeries(s,this.graphicsContext.mainGraphicsContext,o));return this.animator&&e&&(r=(i=this.animator.animate({viewModel:s,series:l,valueAxisProps:this.xProps,columnWidth:this.getColumnWidth(),isBar:!0,layout:n,itemCS:d.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}})).shapes),this.animator&&e&&!i.failed||(a=y.ColumnUtil.drawUncertainty(s,!0,this.graphicsContext.mainGraphicsContext,this.xProps,this.layout,this.getColumnWidth(),this.interactivityService),r=y.ColumnUtil.drawDefaultShapes(s,l,n,d.classes.item,!this.animator,this.interactivityService,this.hostService,!0)),y.ColumnUtil.applyInteractivity(r,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:r,uncertaintyShapes:a,viewport:{height:this.height,width:this.width},axisOptions:o,labelDataPointGroups:c,animateLabels:i&&!i.failed}},d.prototype.selectColumn=function(e,t,i){y.ColumnUtil.setSelectedColumnOpacity(this.graphicsContext.mainGraphicsContext,d.classes.item.selector,e,t,i),this.moveHandle(e)},d.prototype.getClosestColumnIndex=function(e,t){return y.ColumnUtil.getClosestColumnIndex(t,this.getBarsCenters())},d.prototype.getBarsCenters=function(){var t,e,i=this;return this.barsCenters||(e=this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio),0<this.data.series.length&&(t=0,this.categoryLayout.isScalar||(t=e/2),e=this.data.series[0],this.barsCenters=e.data.map(function(e){return i.yProps.scale(i.categoryLayout.isScalar?e.categoryValue:e.categoryIndex)+t}))),this.barsCenters},d.prototype.setSeriesOffsetScale=function(e){var t=this.data.series.length,e=this.categoryLayout.categoryThickness*(1-e)/t;this.seriesOffsetScale=d3.scaleBand().domain(this.data.series.map(function(e){return e.index.toString()})).range([0,t*e])},d.prototype.moveHandle=function(e){var t,i=this.getBarsCenters(),a=d3.select(".interactive-hover-line");a.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(a.node().parentNode)),!i||i.length<=1?this.columnSelectionLineHandle&&this.columnSelectionLineHandle.remove():(a=i[e],this.columnSelectionLineHandle?((t=this.columnSelectionLineHandle).select("line").attrs({y1:a,y2:a}),t.select("circle").attrs({cy:a})):((t=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g")).append("line").classed("interactive-hover-line",!0).attrs({x1:0,x2:this.width,y1:a,y2:a}),t.append("circle").attrs({cx:0,cy:a,r:"6px"}).classed("drag-handle",!0)))},d.getLayout=function(e,t){var i=t.columnWidth,a=.5*i,r=a/2,s=t.isScalar,o=t.xScale,n=t.yScale,l=t.seriesOffsetScale,c=t.invertAxis,u=o(0),d=0;return s&&(d=t.categoryWidth/2),{shapeLayout:{width:function(e){return Math.abs(y.AxisHelper.diffScaled(o,0,e.value))},x:function(e){e=c?Math.max(0,e.value):Math.min(0,e.value);return u+y.AxisHelper.diffScaled(o,e,0)},y:function(e){return n(s?e.categoryValue:e.categoryIndex)+l(e.seriesIndex)-d+(e.drawThinner?r:0)},height:function(e){return e.drawThinner?a:i}},shapeLayoutWithoutHighlights:{width:function(e){return Math.abs(y.AxisHelper.diffScaled(o,0,e.originalValue))},x:function(e){e=c?Math.max(0,e.originalValue):Math.min(0,e.originalValue);return u+y.AxisHelper.diffScaled(o,e,0)},y:function(e){return n(s?e.categoryValue:e.categoryIndex)+l(e.seriesIndex)-d},height:function(e){return i}},zeroShapeLayout:{width:function(e){return 0},x:function(e){e=c?Math.max(0,e.value):Math.min(0,e.value);return u+y.AxisHelper.diffScaled(o,e,0)},y:function(e){return n(s?e.categoryValue:e.categoryIndex)+l(e.seriesIndex)-d+(e.drawThinner?r:0)},height:function(e){return e.drawThinner?a:i}},uncertaintyLayout:{lower:function(e){e=e.uncertainty&&e.uncertainty.lower;if(null!=e)return o(e)},upper:function(e){e=e.uncertainty&&e.uncertainty.upper;if(null!=e)return o(e)}}}},d.classes={item:{class:"bar",selector:".bar"}},y.ClusteredBarChartStrategy=d}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(e){!function(m){function c(){}function u(){}c.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight},c.prototype.setData=function(e){this.data=e},c.prototype.setAxisProperties=function(e,t){this.xProps=e,this.yProps=t},c.prototype.createXAxis=function(e,t){var i=e.includeXDomain,a=e.axisScaleType,r=e.logAxisScale,s=e.axisDisplayUnits,o=e.axisPrecision,n=e.margin,l=this.width,c=m.AxisHelper.hasForcedDomain(i);return m.ColumnUtil.getCategoryAxis(this.data,l,this.categoryLayout,!1,e.axisZoom,t,[i],a,r,s,o,n,c,e.innerPaddingRatio,e.invertAxis)},c.prototype.createYAxis=function(e,t){var i=e.is100Pct,a=e.forcedTickCount,r=e.includeYDomain,s=e.axisScaleType,o=e.logAxisScale,n=e.axisDisplayUnits,l=e.axisPrecision,c=e.outerPaddingRatio,u=e.margin,d=this.viewportHeight,h=m.StackedUtil.calcValueDomain(this.data.series,i),p=m.AxisHelper.getAxisFormatString(this.data.series),h=[h.min,h.max],g=m.AxisHelper.mergeScalarAxisDomains(r,m.AxisHelper.createScalarDomainOptions(h,0)),h=m.AxisHelper.scaleShouldClamp(g&&g.domain,h),y=this.data.valuesMetadata[0],p=i?this.graphicsContext.hostService.getLocalizedString("Percentage"):null!=p?p:m.valueFormatter.getFormatString(y,m.columnChartProps.general.formatString),y=m.AxisHelper.hasForcedDomain(g);return m.AxisHelper.createAxis({pixelSpan:d,dataDomain:g&&g.domain,axisZoom:e.axisZoom,zeroScalarDomain:[0,1],metaDataColumn:this.data.valuesMetadata,formatString:p,outerPadding:0,outerPaddingRatio:c,isScalar:!0,isVertical:!0,forcedTickCount:a,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:s,logAxisScale:o,axisDisplayUnits:n,axisPrecision:l,is100Pct:i,shouldClamp:h,margin:u,preventNice:y,includeZero:m.AxisHelper.shouldIncludeZero(r),skipAxisZoomUpdate:e.skipAxisZoomUpdate,invertAxis:e.invertAxis,featureSwitches:t})},c.prototype.createLabelDataPoints=function(e){return m.ColumnUtil.createLabelDataPoints(this.data,this.layout,this.graphicsContext,this.yProps,!1,!1,e,this.yProps.invertAxis)},c.prototype.createTotalLabelDataPoints=function(e){var t=m.CartesianHelper.getFirstMetadataColumn(this.data.valuesMetadata),t=m.valueFormatter.getFormatString(t,m.columnChartProps.general.formatString);return m.ColumnUtil.createTotalLabelDataPoints(this.data,this.layout,this.graphicsContext,this.yProps,!1,e,t,this.yProps.invertAxis)},c.prototype.getColumnWidth=function(){return this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio)},c.prototype.getCategoryAxisScale=function(){return this.xProps.scale},c.prototype.drawColumns=function(e,t){var i,a,r=this.data,s=(this.columnsCenters=null,{columnWidth:this.getColumnWidth(),xScale:this.xProps.scale,yScale:this.yProps.scale,isScalar:this.categoryLayout.isScalar,margin:this.margin,invertAxis:this.yProps.invertAxis}),o=this.layout=c.getLayout(r,s),n=r.dataLabelsSettings,l=[],n=(n&&n.show&&(l=l.concat(this.createLabelDataPoints(t))),r.totalLabelsSettings),n=(n&&n.show&&!this.graphicsContext.is100Pct&&(l=l.concat(this.createTotalLabelDataPoints(t))),m.ColumnUtil.drawSeries(r,this.graphicsContext.mainGraphicsContext,s)),e=(this.animator&&e&&(a=(i=this.animator.animate({viewModel:r,series:n,layout:o,itemCS:c.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}})).shapes),this.animator&&e&&!i.failed||(m.ColumnUtil.drawUncertainty(r,!1,this.graphicsContext.mainGraphicsContext,void 0,void 0,void 0),a=m.ColumnUtil.drawDefaultShapes(r,n,o,c.classes.item,!this.animator,this.interactivityService,this.graphicsContext.hostService,!1)),this.data.ribbonChartData);return o=(n=e&&e.ribbonChartDataPoints?(r=m.ColumnChart.getRibbonsUtils().getRibbonChartAreaLayout(this.layout,e.ribbonChartDataPoints,!0),{graphicsContext:this.graphicsContext.mainGraphicsContext,layout:r,ribbonChartAreaSelector:m.ColumnChart.RibbonChartItemClasses,ribbonChartGroupSelector:m.ColumnChart.RibbonChartLayerClasses,isColumn:!0,colorBands:e.ribbonOptions.colorBands,bandsTransparency:e.ribbonOptions.bandsTransparency,showBorder:e.ribbonOptions.showBorder,style:t,interactivityService:this.interactivityService}):{graphicsContext:this.graphicsContext.mainGraphicsContext,layout:[],ribbonChartAreaSelector:m.ColumnChart.RibbonChartItemClasses,ribbonChartGroupSelector:m.ColumnChart.RibbonChartLayerClasses,isColumn:!0,colorBands:!1,bandsTransparency:c.defaultBandsTransparency,showBorder:!1,style:t,interactivityService:this.interactivityService},m.ColumnChart.getRibbonsUtils().drawRibbonChartAreaSmooth(n)),m.ColumnUtil.applyInteractivity(a,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,ribbonChartEventGroup:o,shapesSelection:a,viewport:{height:this.height,width:this.width},axisOptions:s,labelDataPointGroups:l,animateLabels:i&&!i.failed}},c.prototype.selectColumn=function(e,t,i){m.ColumnUtil.setSelectedColumnOpacity(this.graphicsContext.mainGraphicsContext,c.classes.item.selector,e,t,i),this.moveHandle(e)},c.prototype.getClosestColumnIndex=function(e,t){return m.ColumnUtil.getClosestColumnIndex(e,this.getColumnsCenters())},c.prototype.getColumnsCenters=function(){var t,e,i=this;return this.columnsCenters||(e=this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio),0<this.data.series.length&&(t=0,this.categoryLayout.isScalar||(t=e/2),e=this.data.series[0],this.columnsCenters=e.data.map(function(e){return i.xProps.scale(i.categoryLayout.isScalar?e.categoryValue:e.categoryIndex)+t}))),this.columnsCenters},c.prototype.moveHandle=function(e){var t,i=this.getColumnsCenters(),a=d3.select(".interactive-hover-line");a.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(a.node().parentNode)),!i||i.length<=1?this.columnSelectionLineHandle&&this.columnSelectionLineHandle.remove():(a=i[e],this.columnSelectionLineHandle?((t=this.columnSelectionLineHandle).select("line").attrs({x1:a,x2:a}),t.select("circle").attrs({cx:a})):((t=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g")).append("line").classed("interactive-hover-line",!0).attrs({x1:a,x2:a,y1:0,y2:this.height}),t.append("circle").attrs({cx:a,cy:this.height,r:"6px"}).classed("drag-handle",!0)))},c.getLayout=function(e,t){var i=t.columnWidth,a=t.isScalar,r=t.xScale,s=t.yScale,o=t.invertAxis,n=a?i/2:0;return{shapeLayout:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-n},y:function(e){return s(o?e.position-e.valueAbsolute:e.position)},height:function(e){return Math.abs(s(e.position-e.valueAbsolute)-s(e.position))}},shapeLayoutWithoutHighlights:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-n},y:function(e){return s(o?e.originalPosition-e.originalValueAbsolute:e.originalPosition)},height:function(e){return Math.abs(s(e.originalPosition-e.originalValueAbsolute)-s(e.originalPosition))}},zeroShapeLayout:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-n},y:function(e){return 0<=e.value?s(e.position-e.valueAbsolute):s(e.position)},height:function(e){return 0}}}},c.classes={item:{class:"column",selector:".column"},highlightItem:{class:"highlightColumn",selector:".highlightColumn"}},c.defaultBandsTransparency=30,m.StackedColumnChartStrategy=c,u.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.isComboChart=e.isComboChart},u.prototype.setData=function(e){this.data=e},u.prototype.setAxisProperties=function(e,t){this.xProps=e,this.yProps=t},u.prototype.createYAxis=function(e,t){var i=e.includeYDomain,a=e.axisScaleType,r=e.logAxisScale,s=e.axisDisplayUnits,o=e.axisPrecision,n=e.margin,l=this.height,c=m.AxisHelper.hasForcedDomain(i);return m.ColumnUtil.getCategoryAxis(this.data,l,this.categoryLayout,!0,e.axisZoom,t,[i],a,r,s,o,n,c,e.innerPaddingRatio,e.invertAxis)},u.prototype.createXAxis=function(e,t){var i=e.is100Pct,a=e.forcedTickCount,r=e.includeXDomain,s=e.axisScaleType,o=e.logAxisScale,n=e.axisDisplayUnits,l=e.axisPrecision,c=e.outerPaddingRatio,u=e.margin,d=this.width,h=m.StackedUtil.calcValueDomain(this.data.series,i),p=m.AxisHelper.getAxisFormatString(this.data.series),h=[h.min,h.max],r=m.AxisHelper.mergeScalarAxisDomains(r,m.AxisHelper.createScalarDomainOptions(h,0)),h=m.AxisHelper.scaleShouldClamp(r&&r.domain,h),g=this.data.valuesMetadata[0],p=i?this.graphicsContext.hostService.getLocalizedString("Percentage"):null!=p?p:m.valueFormatter.getFormatString(g,m.columnChartProps.general.formatString),g=m.AxisHelper.hasForcedDomain(r),d=m.AxisHelper.createAxis({pixelSpan:d,dataDomain:r&&r.domain,axisZoom:e.axisZoom,zeroScalarDomain:[0,1],metaDataColumn:this.data.valuesMetadata,formatString:p,outerPadding:0,outerPaddingRatio:c,isScalar:!0,isVertical:!1,forcedTickCount:a,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:s,logAxisScale:o,axisDisplayUnits:n,axisPrecision:l,is100Pct:i,shouldClamp:h,margin:u,preventNice:g,skipAxisZoomUpdate:e.skipAxisZoomUpdate,invertAxis:e.invertAxis,featureSwitches:t});return d.axis.tickSizeInner(-this.viewportHeight).tickSizeOuter(0),d},u.prototype.createLabelDataPoints=function(e){return m.ColumnUtil.createLabelDataPoints(this.data,this.layout,this.graphicsContext,this.xProps,!0,!1,e,this.xProps.invertAxis)},u.prototype.createTotalLabelDataPoints=function(e){var t=m.CartesianHelper.getFirstMetadataColumn(this.data.valuesMetadata),t=m.valueFormatter.getFormatString(t,m.columnChartProps.general.formatString);return m.ColumnUtil.createTotalLabelDataPoints(this.data,this.layout,this.graphicsContext,this.xProps,!0,e,t,this.xProps.invertAxis)},u.prototype.getColumnWidth=function(){return this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio)},u.prototype.getCategoryAxisScale=function(){return this.yProps.scale},u.prototype.drawColumns=function(e,t){var i,a,r=this.data,s=(this.barsCenters=null,{columnWidth:this.getColumnWidth(),xScale:this.xProps.scale,yScale:this.yProps.scale,isScalar:this.categoryLayout.isScalar,margin:this.margin,invertAxis:this.xProps.invertAxis}),o=this.layout=u.getLayout(r,s),n=r.dataLabelsSettings,l=[],n=(n&&n.show&&(l=l.concat(this.createLabelDataPoints(t))),r.totalLabelsSettings),n=(n&&n.show&&!this.graphicsContext.is100Pct&&(l=l.concat(this.createTotalLabelDataPoints(t))),m.ColumnUtil.drawSeries(r,this.graphicsContext.mainGraphicsContext,s));return this.animator&&e&&(a=(i=this.animator.animate({viewModel:r,series:n,layout:o,itemCS:u.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}})).shapes),this.animator&&e&&!i.failed||(m.ColumnUtil.drawUncertainty(r,!0,this.graphicsContext.mainGraphicsContext,void 0,void 0,void 0),a=m.ColumnUtil.drawDefaultShapes(r,n,o,u.classes.item,!this.animator,this.interactivityService,this.graphicsContext.hostService,!0)),m.ColumnUtil.applyInteractivity(a,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:a,viewport:{height:this.height,width:this.width},axisOptions:s,labelDataPointGroups:l,animateLabels:i&&!i.failed}},u.prototype.selectColumn=function(e,t,i){m.ColumnUtil.setSelectedColumnOpacity(this.graphicsContext.mainGraphicsContext,u.classes.item.selector,e,t,i),this.moveHandle(e)},u.prototype.getClosestColumnIndex=function(e,t){return m.ColumnUtil.getClosestColumnIndex(t,this.getBarsCenters())},u.prototype.getBarsCenters=function(){var t,e,i=this;return this.barsCenters||(e=this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio),0<this.data.series.length&&(t=0,this.categoryLayout.isScalar||(t=e/2),e=this.data.series[0],this.barsCenters=e.data.map(function(e){return i.yProps.scale(i.categoryLayout.isScalar?e.categoryValue:e.categoryIndex)+t}))),this.barsCenters},u.prototype.moveHandle=function(e){var t,i=this.getBarsCenters(),a=d3.select(".interactive-hover-line");a.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(a.node().parentNode)),!i||i.length<=1?this.columnSelectionLineHandle&&this.columnSelectionLineHandle.remove():(a=i[e],this.columnSelectionLineHandle?((t=this.columnSelectionLineHandle).select("line").attrs({y1:a,y2:a}),t.select("circle").attrs({cy:a})):((t=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g")).append("line").classed("interactive-hover-line",!0).attrs({x1:0,x2:this.width,y1:a,y2:a}),t.append("circle").classed("drag-handle",!0).attrs({cx:0,cy:a,r:"6px"})))},u.getLayout=function(e,t){var i=t.columnWidth,a=t.isScalar,r=t.xScale,s=t.yScale,o=t.invertAxis,n=a?i/2:0;return{shapeLayout:{width:function(e){return o?r(e.position-e.valueAbsolute)-r(e.position):r(e.position)-r(e.position-e.valueAbsolute)},x:function(e){return r(o?e.position:e.position-e.valueAbsolute)},y:function(e){return s(a?e.categoryValue:e.categoryIndex)-n},height:function(e){return i}},shapeLayoutWithoutHighlights:{width:function(e){return o?r(e.originalPosition-e.originalValueAbsolute)-r(e.originalPosition):r(e.originalPosition)-r(e.originalPosition-e.originalValueAbsolute)},x:function(e){return r(o?e.originalPosition:e.originalPosition-e.originalValueAbsolute)},y:function(e){return s(a?e.categoryValue:e.categoryIndex)-n},height:function(e){return i}},zeroShapeLayout:{width:function(e){return 0},x:function(e){return 0<=e.value?r(e.position-e.valueAbsolute):r(e.position)},y:function(e){return s(a?e.categoryValue:e.categoryIndex)-n},height:function(e){return i}}}},u.classes={item:{class:"bar",selector:".bar"},highlightItem:{class:"highlightBar",selector:".highlightBar"}},m.StackedBarChartStrategy=u}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(e){var f,x,b,v,C,S,t;function g(r,e,s,o,n,t){var t=(t===o?e:r).topLevelToggle,l=__assign(__assign({},r),{topLevelToggle:t}),c={};e.groups.forEach(function(e){return c[e.uid]=e}),r.groups.forEach(function(e,t){var i,a;x.isPlaceholder(e)||(i=c[e.uid])&&(a="errorBars"===r.uid,l.groups[t]=w(e,i,s,o,n,a),delete c[e.uid])});for(var i=0,a=e.groups;i<a.length;i++){var u=a[i];if(x.isPlaceholder(u))return;u=c[u.uid];u&&l.groups.push(u)}var t=_.unionWith(r.revertToDefaultDescriptors,e.revertToDefaultDescriptors,_.isEqual),d=f.comboChartObjectProps;return l.revertToDefaultDescriptors=t.filter(function(e){return d[e.objectName]&&d[e.objectName][e.propertyName]}),l}function w(e,t,i,a,r,s){var o=__assign({},t),n=e.slices,l=(n&&n.every(function(e){return!x.isPlaceholder(e)}),t.slices);return l&&l.every(function(e){return!x.isPlaceholder(e)}),o.slices=A(n,l,i,a,r),e.container&&t.container?o.container=function(e,t,i,a,r,s){var o=__assign({},t),n=(o.containerItems=[],__spreadArray([],e.containerItems)),l=__spreadArray([],t.containerItems);if(s)(s=o.containerItems).push.apply(s,__spreadArray(__spreadArray([],l),n));else{for(var c=void 0,u=(n[0].displayName,l[0].displayName,0<e.containerItems.length&&0<t.containerItems.length&&(c=function(e,t,a,r,s){var o=__assign(__assign({},t),{groups:[],slices:[]}),n={};t.groups.forEach(function(e){return n[e.uid]=e}),e.groups.forEach(function(e,t){var i=n[e.uid];i?(o.groups[t]=w(e,i,a,r,s),delete n[e.uid]):o.groups[t]=e});for(var i=0,l=t.groups;i<l.length;i++){var c=l[i];n[c.uid]&&o.groups.push(n[c.uid])}return o.slices=A(e.slices,t.slices,a,r,s),o}(n.shift(),l.shift(),i,a,r)),o.containerItems.push(c),[]),d=0,h=n;d<h.length;d++){var p=h[d];u.push({containerItem:p,layerType:i})}for(var g=0,y=l;g<y.length;g++){var m=y[g];u.push({containerItem:m,layerType:a})}for(var f=0,v=u;f<v.length;f++){var S=v[f];o.containerItems.push(function(e,t,s){var o=__assign({},t),i={};return t.groups.forEach(function(e){return i[b.getGroupUid(e.uid)]=e}),e.groups.length,t.groups.length,e.groups.forEach(function(e,a){var r,t=b.getGroupUid(e.uid);i[t]&&(r={},i[t].slices.forEach(function(e){return r[C.getGroupAndSliceUid(e.uid)]=e}),o.groups[a].slices=[],e.slices.forEach(function(e){var t,i;x.isPlaceholder(e)||(t=C.getGroupAndSliceUid(e.uid),(i=(i=r[t])||r[t.replace("__"+s+"__","")])&&("Dropdown"!==i.control.type||"Dropdown"!==e.control.type||P(i.control.properties,e.control.properties))?(i.displayName=e.displayName,o.groups[a].slices.push(i)):o.groups[a].slices.push(__assign(__assign({},e),{displayName:e.displayName,disabled:!0})))}))}),o}(c,S.containerItem,S.layerType))}}return o}(e.container,t.container,i,a,r,s):o.container=e.container||t.container,o}function D(e){return _.findIndex(e,function(e){return!x.isCompositeSlice(e)&&(t=e,i=f.comboChartObjectProps.labels.labelDensity,(t=e.control.properties.descriptor).objectName===i.objectName&&t.propertyName===i.propertyName);var t,i})}function A(e,t,s,i,o){var n=[],a=D(e),r=e[a],l=D(t),c=t[l],u=(r&&c&&(e=e.filter(function(e,t){return!x.isCompositeSlice(e)&&t!==a}),t=t.filter(function(e,t){return!x.isCompositeSlice(e)&&t!==l})),f.comboChartObjectProps),d={};t.forEach(function(e){L(e,u)&&(d[v.getSliceUid(e,!1)]=e)}),e.forEach(function(e){if(L(e,u)){var t=d[v.getSliceUid(e,!1)],i=e.displayName;if(function(e,t){if(t&&t.control.type===e.control.type&&function(e,t){if(x.isCompositeSlice(e)||x.isCompositeSlice(t))return 1;var i=e.control.properties.descriptor,a=t.control.properties.descriptor;if(_.isEqual(_.omit(a,["selector","instanceKind"]),_.omit(i,["selector","instanceKind"]))){if(S.equals(a.selector,i.selector))return 1;var r=void 0;if(null==a.selector&&(r=S.isWildcardSelector(i.selector)),r=null==i.selector?S.isWildcardSelector(a.selector):r)return function(e,t){e=e.control.properties.descriptor,t=t.control.properties.descriptor;e.instanceKind|=t.instanceKind,null!=e.selector||(e.selector=t.selector)}(e,t),1}return}(e,t))return"Dropdown"!==t.control.type||(t=t.control.properties,e=e.control.properties,!!P(t,e));return}(e,t)){if(x.isCompositeSlice(e)&&x.isCompositeSlice(t))for(var a in e.control.properties){var r=e.control.properties[a],a=t.control.properties[a];r&&a&&_.isEqual(r.descriptor,a.descriptor)&&(r.value=a.value)}else e.control.properties.value=t.control.properties.value;delete d[v.getSliceUid(t,!1)]}else i=M(e.uid,s,o);n.push(__assign(__assign({},e),{displayName:i}))}});for(var h=0,p=t;h<p.length;h++){var g,y=p[h],m=d[v.getSliceUid(y,!1)],y=y.uid+"__"+i+"__";m&&(g=M(m.uid,i,o),n.push(__assign(__assign({},m),{displayName:g,uid:y})))}return r&&c&&(e=c,t=n,c=o,(r=r).control.properties.value=e.control.properties.value,e=c("Visual_LabelDensity"),t.push(__assign(__assign({},r),{displayName:e}))),n}function i(e){return void 0===e.items}function P(e,t){return i(e)&&i(t)&&_.isEqual(e.filterValues,t.filterValues)}function L(e,t){var i;return x.isCompositeSlice(e)?!!(i=e.control.properties)&&Object.keys(i).every(function(e){e=i[e],e=null==e?void 0:e.descriptor;return!e||!!(e&&t[e.objectName]&&t[e.objectName][e.propertyName])}):!!((e=e.control.properties.descriptor)&&t[e.objectName]&&t[e.objectName][e.propertyName])}function r(e,t){if(0===t.length)return e;for(var i={},a=(e.forEach(function(e){return i[e.uid]=e}),[]),r=0,s=t;r<s.length;r++){var o=s[r];i[o]&&a.push(i[o])}return a}function M(e,t,i){return i("Visual_Slice_Placeholder_"+C.getSliceUid(e),function(e,t){switch(e){case 5:return t("DisplayName_QuickCalc_PercentOfColumnTotal");case 0:return t("Visual_Slice_PlaceholderChartType_Line")}}(t,i))}f=e.visuals||(e.visuals={}),x=e.visuals.builder,b=x.FormattingGroupUidBuilder,v=e.visuals.FormattingModelUtil,C=x.FormattingSliceUidBuilder,S=e.data.Selector,t=[[f.comboChartRoleNames.y,f.comboChartRoleNames.tooltips],[f.comboChartRoleNames.y2]],(e=f.ComboChart||(f.ComboChart={})).enumerateDataPoints=function(e,t,i){if(i){for(var a,r=i.length,s=0;s<r;s++){var o=i[s];o.enumerateObjectInstances&&(o instanceof f.ColumnChart?a=s:o.enumerateObjectInstances(e,t))}void 0!==a&&i[a].enumerateObjectInstances(e,t)}},e.isComboChart=function(e){return 11===e||14===e||15===e||16===e||17===e},e.getRoleGroups=function(){return t},e.mergeFormattingCards=function(e,t,i){if(0!==e.length){var a,r;switch(t){case 14:case 15:a=[5,0],r=5}if(0===(t=function(e,t){if(0===t.length)return;for(var i={},a=(e.forEach(function(e){return i[e.type]=e.card}),[]),r=0,s=t;r<s.length;r++)!function(t){i[t]&&i[t].forEach(function(e){return a.push({card:e,type:t})})}(s[r]);return a}(e,a)).length)return[];for(var s={},o=0,n=t;o<n.length;o++){var l=n[o],c=l.card;s[c.uid]?s[c.uid]={card:g(s[c.uid].card,c,s[c.uid].type,l.type,i,r),type:l.type}:s[c.uid]={card:c,type:l.type}}for(var u=[],d=0,h=_.values(s);d<h.length;d++){var p=h[d];u.push(p.card)}return u}},e.mergeFormattingCard=g,e.existsInProps=L,e.sortComboChartFormattingCards=function(e,t,i){var a=[];switch(t){case 14:case 15:a=["bars","lines","markers","labels","seriesLabels","totals"],i&&a.push("errorBars")}return r(e,a)},e.sortFormattingCards=r}(powerbi=powerbi||{}),function(f){!function(m){function y(e){this.isScrollable=e.isScrollable,this.interactivityService=e.interactivityService}y.prototype.initData=function(e){this.style=e.style,this.currentViewport=e.viewport,this.animationOptions=e.animation},y.prototype.initRenderer=function(e){this.svg=e.svg,this.svg.classed(y.ClassName,!0),this.mainGraphicsG=this.svg.append("g").classed("dataDotChartMainGraphicsContext",!0),this.mainGraphicsContext=this.mainGraphicsG.append("svg")},y.prototype.setData=function(e){this.data={series:{data:[]},hasHighlights:!1,hasDynamicSeries:!1},0<e.length&&((e=e[0])&&e.categorical&&(this.data=y.converter(e,m.valueFormatter.format(null),this.interactivityService)))},y.prototype.setFilteredData=function(e,t){var i=this.clippedData=f.Prototype.inherit(this.data);return i&&i.series&&i.series.data&&(i.series={data:i.series.data.slice(e,t),xCol:i.series.xCol,yCol:i.series.yCol}),i},y.prototype.calculateAxesProperties=function(e){var t,i=this,a=(this.currentViewport=e.viewport,this.margin=e.margin,this.clippedData=this.data),r=this.currentViewport,s=this.margin,o=a?a.series:null,n=o&&o.data&&0<o.data.length?[o]:[],l=o&&o.data?o.data.length:0,c=(a.hasHighlights&&(l/=2),r.width-(s.left+s.right)),r=r.height-(s.top+s.bottom),o=(y.hasDataPoint(o)&&(t=o.xCol,d=o.yCol),m.CartesianChartLayout.getLayout(null,{availableWidth:c,categoryCount:l,domain:null,isScalar:!1,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:e.trimOrdinalDataOnOverflow,outerPaddingRatio:e.outerPaddingRatio,innerPaddingRatio:e.innerPaddingRatio})),l=o.categoryThickness*o.outerPaddingRatio,a=(this.isScrollable||(this.clippedData=y.createClippedDataIfOverflowed(a,o.categoryCount)),this.getAxesDomains(!1,{valueAxis:!0})),u=e.valueAxisOptions,a=m.AxisHelper.mergeScalarAxisDomains(m.AxisHelper.createScalarDomainOptions(a.valueAxis,0),u.includeDomain),u=m.AxisHelper.hasForcedDomain(a),r=(this.yAxisProperties=m.AxisHelper.createAxis({pixelSpan:r,dataDomain:a&&a.domain,axisZoom:void 0,metaDataColumn:d,formatString:m.valueFormatter.getFormatString(d,y.formatStringProp),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,margin:s,preventNice:u,includeZero:!0}),this.xAxisProperties?this.xAxisProperties.axisType:f.ValueType.fromDescriptor({text:!0})),a=e.categoryAxisOptions.includeDomain,d=m.AxisHelper.createDomain(n,r,!1,[a]),u=m.AxisHelper.hasForcedDomain(a);return this.xAxisProperties=m.AxisHelper.createAxis({pixelSpan:c,dataDomain:d,axisZoom:void 0,metaDataColumn:t,formatString:m.valueFormatter.getFormatString(t,y.formatStringProp),outerPadding:l,isScalar:!1,isVertical:!1,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,categoryThickness:o.categoryThickness,getValueFn:function(e,t){return i.lookupXValue(e,t)},isCategoryAxis:!0,margin:s,preventNice:u,innerPaddingRatio:e.innerPaddingRatio}),[this.xAxisProperties,this.yAxisProperties]},y.prototype.getAxesDomains=function(e,t){var i={},a=this.clippedData||this.data;return a&&t.valueAxis&&(t=a.series&&!_.isEmpty(a.series.data)?[a.series]:[],i.valueAxis=m.AxisHelper.createValueDomain(t)),i},y.prototype.setAxesLayout=function(e){},y.createClippedDataIfOverflowed=function(e,t){t=e.hasHighlights?Math.min(e.series.data.length,2*t):Math.min(e.series.data.length,t);if(t>=e.series.data.length)return e;var i=f.Prototype.inherit(e);return i.series=f.Prototype.inherit(e.series),i.series.data=i.series.data.slice(0,t),i},y.hasDataPoint=function(e){return e&&e.data&&0<e.data.length},y.prototype.lookupXValue=function(e,t){var i=this.data;if(m.AxisHelper.isDateTime(t))return new Date(e);if(i&&i.series){t=i.series.data;if(t){i=t[e];if(i)return i.categoryValue}}return e},y.prototype.overrideXScale=function(e){this.xAxisProperties=e},y.prototype.render=function(e){var t,i,a,r,s,o,n,l,c,u,d,h,p,g=this;if(this.clippedData)return u=this.clippedData,t=u.series.data,i=u.hasHighlights,u=this.margin,c=this.currentViewport,l=c.width-(u.left+u.right),c=c.height-(u.top+u.bottom),a=this.xAxisProperties.scale,r=this.yAxisProperties.scale,s=this.xAxisProperties.categoryThickness*(1-this.xAxisProperties.innerPaddingRatio),o=s/2,u=this.style.colorPalette.dataColors.getNewColorScale().getColor(y.DotColorKey),n=!!this.interactivityService&&this.interactivityService.hasSelection(),this.mainGraphicsContext.attr("width",l).attr("height",c),l=this.mainGraphicsContext.selectAll(y.DotClassSelector).data(t,function(e){return e.identity.getKey()}),c=l.enter().append("circle").classed(y.DotClassName,!0).merge(l),c.styles({fill:u.value}).style("fill-opacity",function(e){return m.ColumnUtil.getFillOpacity(e.selected,e.highlight,n,i)}).classed("null-value",function(e){return null===e.value}).attrs({r:function(e){return o},cx:function(e){return a(e.categoryIndex)+o},cy:function(e){return r(e.value)}}),l.exit().remove(),u=this.mainGraphicsContext.selectAll(y.DotLabelClassSelector).data(t,function(e){return e.identity.getKey()}),d=u.enter().append("text").classed(y.DotLabelClassName,!0).attrs({"text-anchor":y.DotLabelTextAnchor,dy:y.DotLabelVerticalOffset}).merge(u),d.classed("null-value",function(e){return null===e.value}).classed("overflowed",!1).attrs({x:function(e){return a(e.categoryIndex)+o},y:function(e){return r(e.value)}}).text(function(e){return g.yAxisProperties.formatter.format(e.value)}),h=!1,d.each(function(){var e;h||$("<div>").addClass($(this).attr("class")).hasClass("null-value")||(e=f.TextMeasurementService.measureSvgTextElementWidth(this),s<e&&(d.classed("overflowed",!0),h=!0))}),u.exit().remove(),this.interactivityService&&(p={dots:c,dotLabels:d,datapoints:t}),m.SVGUtil.flushAllD3TransitionsIfNeeded(this.animationOptions,c,d),{dataPoints:t,behaviorOptions:p,labelDataPoints:[],labelsAreNumeric:!0,animateLabels:!1}},y.prototype.hasLegend=function(){return this.data&&this.data.hasDynamicSeries},y.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},y.converter=function(e,t,i){var e=e.categorical,a=e.categories&&0<e.categories.length?e.categories[0]:{source:void 0,values:[t],identity:void 0},r=null!=(t=e.originalCategories)?t:[a],t=m.AxisHelper.getCategoryValueType(a.source),s=m.AxisHelper.isDateTime(t),o=a.values;if(_.isEmpty(e.values))return{series:{data:[]},hasHighlights:!1,hasDynamicSeries:!1};for(var n=e.values[0],l=!!n.highlights,c=[],u=0,d=n.values.length;u<d;u++){a.identity&&a.identity.length;var h,p,g=new m.SelectionIdBuilder,y=(g=a.identity?g.withCategory(r,u,null==(y=null==a?void 0:a.source)?void 0:y.queryName,!0):g).withMeasure(n.source.queryName).createSelectionId(),g=o[u];(!s||null==g||g instanceof Date)&&(c.push({categoryValue:s&&g?g.getTime():g,value:n.values[u],categoryIndex:u,seriesIndex:0,selected:!1,identity:y,highlight:!1}),l&&(h=m.SelectionId.createWithHighlight(y),p=n.highlights[u],c.push({categoryValue:s&&g?g.getTime():g,value:p,categoryIndex:u,seriesIndex:0,selected:!1,identity:h,highlight:!0})))}return i&&i.applySelectionStateToData(c),{series:{xCol:a.source,yCol:n.source,data:c},hasHighlights:l,hasDynamicSeries:!0}},y.prototype.getCartesianVisualCapabilities=function(){return{supportsHierarchicalCategoryAxis:!1}},y.prototype.getStaticSeriesRole=function(){},y.formatStringProp={objectName:"general",propertyName:"formatString"},y.ClassName="dataDotChart",y.DotClassName="dot",y.DotClassSelector=".dot",y.DotColorKey="dataDot",y.DotLabelClassName="label",y.DotLabelClassSelector=".label",y.DotLabelVerticalOffset="0.4em",y.DotLabelTextAnchor="middle",m.DataDotChart=y}(f.visuals||(f.visuals={}))}(powerbi=powerbi||{}),function(e){!function(r){function e(){}e.prototype.create=function(){return new t},r.DataDotChartWebBehaviorFactory=e;i.prototype.bindEvents=function(e,t,i){var a=this.dots=e.dots,e=e.dotLabels;r.InteractivityUtils.registerStandardInteractivityHandlers(a,t),e&&r.InteractivityUtils.registerStandardInteractivityHandlers(e,t)},i.prototype.renderSelection=function(t){this.dots.style("fill-opacity",function(e){return r.ColumnUtil.getFillOpacity(e.selected,e.highlight,t,!1)})};var t=i;function i(){}r.DataDotChartWebBehavior=t}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(l){!function(c){var e=jsCommon.CssConstants.createClassAndSelector,t=l.data.DataViewTransform,u=c.histogramProps.general.formatString;function d(e){this.chartType=132,this.tooltipsEnabled=e.tooltipsEnabled,this.interactivityService=e.interactivityService}d.prototype.initData=function(e){this.style=e.style,this.currentViewport=e.viewport,this.hostService=e.host,this.tooltipService=e.services.tooltips,this.featureSwitches=e.featureSwitches},d.prototype.initRenderer=function(e){this.svg=e.svg,this.svg.classed("histogram",!0),this.unclippedGraphicsContext=this.svg.append("g").classed("histogramUnclippedGraphicsContext",!0),this.mainGraphicsContext=this.unclippedGraphicsContext.append("svg").classed("mainGraphicsContext",!0),this.interactivityService&&(e=jsCommon.BrowserUtils.isInternetExplorerOrEdge(),this.mainGraphicsContext.attrs({tabindex:0,focusable:!0,"aria-label":this.hostService.getLocalizedString("Visual_Plot")}).classed(c.SetFocusRingClassName,!e))},d.prototype.setData=function(e){this.data=this.originalData={categories:[],categoryFormatter:null,series:[],totals:[],valuesMetadata:[],hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!0,dataLabelsSettings:null,legendData:null,hasDynamicSeries:!0,isMultiMeasure:!1,binType:c.binType.numOfBins,binSize:d.DefaultBinSize,numberOfBins:d.DefaultBinCount},0<e.length&&((e=this.dataView=d.view)&&e.categorical&&(this.data=this.originalData=d.converter(e,this.style,e.metadata,this.featureSwitches,this.chartType,this.interactivityService,!0,this.hostService)))},d.prototype.calculateAxesProperties=function(e){this.margin=e.margin,this.currentViewport=e.viewport,this.viewModelAdapterFactory&&this.originalData&&(t=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport}),this.data=t.getData());var t=this.data,i=t.categories.length,a=this.getPreferredPlotArea(!0,i,c.CartesianHelper.MinOrdinalRectThickness,e.outerPaddingRatio),r=t?t.preferredCategoryWidth:null,i=c.CartesianChartLayout.getLayout(null,{availableWidth:a.width,categoryCount:i,preferredCategoryWidth:r,domain:null,isScalar:!0,isScrollable:!1,trimOrdinalDataOnOverflow:e.trimOrdinalDataOnOverflow,outerPaddingRatio:e.outerPaddingRatio,innerPaddingRatio:0}),r=d.getXAxisCreationOptions(t,a.width,i,e),t=d.getYAxisCreationOptions(t,a.height,e),a=this.xAxisProperties=c.AxisHelper.createAxis(r),e=this.yAxisProperties=c.AxisHelper.createAxis(t);return this.xAxisProperties.outerPaddingRatio=i.outerPaddingRatio,[a,e]},d.prototype.getAxesDomains=function(e,t){var i,a={},r=this.data;return r&&(t.categoryAxis&&(i=c.AxisHelper.getCategoryValueType(r.categoryMetadata,!0),(i=c.AxisHelper.createDomain(r.series,i,!0,[c.AxisHelper.createScalarDomainOptions(c.AxisHelper.createIntervalDomain(r.series),0,[!0,!0])]))&&(c.AxisHelper.assertScalarDomain(i),a.categoryAxis=i)),t.valueAxis&&(a.valueAxis=c.AxisHelper.createValueDomain(r.series))),a},d.prototype.setAxesLayout=function(e){},d.getXAxisCreationOptions=function(e,t,i,a){var r=a.categoryAxisOptions,s=c.AxisHelper.getCategoryValueType(e.categoryMetadata,!0),s=c.AxisHelper.createDomain(e.series,s,!0,[c.AxisHelper.createScalarDomainOptions(c.AxisHelper.createIntervalDomain(e.series),0,[!0,!0])]),o=i.categoryThickness,n=o*i.outerPaddingRatio,l=c.AxisHelper.hasForcedDomain(r.includeDomain);return{pixelSpan:t,dataDomain:s,axisZoom:void 0,metaDataColumn:e.categoryMetadata,formatString:c.valueFormatter.getFormatString(e.categoryMetadata,u),isScalar:!0,outerPadding:n,categoryThickness:o,forcedTickCount:a.forcedTickCount,isCategoryAxis:!0,axisDisplayUnits:r.displayUnits,axisPrecision:r.precision,outerPaddingRatio:i.outerPaddingRatio,preventNice:l,innerPaddingRatio:0}},d.prototype.getVisualCategoryAxisIsScalar=function(){return!0},d.getYAxisCreationOptions=function(e,t,i){var a=i.valueAxisOptions,r=c.AxisHelper.createValueDomain(e.series),r=c.AxisHelper.mergeScalarAxisDomains(c.AxisHelper.createScalarDomainOptions(r,0),a.includeDomain),s=c.AxisHelper.hasForcedDomain(r);return{pixelSpan:t,dataDomain:r&&r.domain,axisZoom:void 0,isScalar:!0,isVertical:!0,metaDataColumn:e.valuesMetadata,formatString:c.valueFormatter.getFormatString(e.valuesMetadata[0],u),outerPadding:0,forcedTickCount:i.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,axisDisplayUnits:a.displayUnits,axisPrecision:a.precision,outerPaddingRatio:0,preventNice:s}},d.prototype.getPreferredPlotArea=function(e,t,i,a){return c.CartesianChartLayout.getPreferredPlotArea(t,i,this.currentViewport,!1,e,this.margin,a)},d.prototype.overrideXScale=function(e){this.xAxisProperties=e},d.prototype.render=function(e){var t=this,i=this.data;if(i){var a=this.margin,r=this.currentViewport,s=r.height-(a.top+a.bottom),r=r.width-(a.left+a.right),a=i.series;this.mainGraphicsContext.attr("height",s).attr("width",r),this.mainGraphicsContext.selectAll(d.SeriesSelector.selector).remove();var r=this.mainGraphicsContext.selectAll(d.SeriesSelector.selector).data(a).enter().append("g").classed("bar",!0),a=r.selectAll(d.BinsSelector.selector).data(function(e){return e.data}),o=(a.enter().append("rect").classed(d.BinsSelector.class,!0).attr("x",function(e){return t.xAxisProperties.scale(e.categoryValue.min)}).attr("y",function(e){return t.yAxisProperties.scale(e.value)}).attr("height",function(e){return s-t.yAxisProperties.scale(e.value)}).attr("width",function(e){return t.xAxisProperties.scale(e.categoryValue.max)-t.xAxisProperties.scale(e.categoryValue.min)}).style("fill",function(e){return e.color}),a.exit().remove(),this.tooltipsEnabled&&this.tooltipService.addTooltip(r,function(e){return e.data&&e.data.tooltipInfo},function(e){return e.data&&e.data.identity&&[e.data.identity]}),[]);if(this.interactivityService)for(var n=0,l=i.series.length;n<l;n++)o=o.concat(i.series[n].data);return{dataPoints:o,behaviorOptions:void 0,navigationOptions:void 0,labelDataPoints:[],labelsAreNumeric:!0,labelOrientation:i.dataLabelsSettings.labelOrientation,animateLabels:!0}}},d.converter=function(e,t,i,a,r,s,o,n){t=c.ColumnChart.converter({dataView:e,style:t,is100PercentStacked:!1,isScalar:!0,dataViewMetadata:i=void 0===i?null:i,multipleInfo:void 0,chartType:r,interactivityService:s,tooltipsEnabled:o=void 0===o?!0:o,hostServices:n,ribbonChart:!1,isCombo:!1,buildCategories:d.buildCategories,supportsTotalLabels:!1,featureSwitches:a}),i=l.DataViewObjects.getValue(e.metadata.objects,c.histogramProps.binning.binType),r=l.DataViewObjects.getValue(e.metadata.objects,c.histogramProps.binning.binCount,d.DefaultBinCount),s=l.DataViewObjects.getValue(e.metadata.objects,c.histogramProps.binning.binSize,d.DefaultBinSize);return __assign(__assign({},t),{series:t.series,binType:i,numberOfBins:r,binSize:s})},d.buildCategories=function(e){e.categories,e.categories.length;for(var t=new Array,i=e.categories[0].values.length,a=0;a<i;a++)t.push({min:e.categories[0].values[a],max:e.categories[1].values[a]});return t},d.buildTooltipCategories=function(e,t,i){return e.length,(t+=1)===i?{displayName:_.first(e).displayName,value:"["+_.map(e,function(e){return e.value}).join(", ")+"]"}:{displayName:_.first(e).displayName,value:"["+_.map(e,function(e){return e.value}).join(", ")+")"}},d.prototype.enumerateObjectInstances=function(e,t){if(this.originalData)switch(t.objectName){case"dataPoint":this.enumerateDataPoints(e);break;case"binning":this.enumerateBinning(e,t.objectName)}},d.prototype.enumerateBinning=function(e,t){t={selector:null,properties:{binType:this.data.binType===c.binType.binSize?c.binType.binSize:c.binType.numOfBins},validValues:{},objectName:t};this.data.binType===c.binType.binSize?t.properties[c.histogramProps.binning.binSize.propertyName]=this.data.binSize:t.properties[c.histogramProps.binning.binCount.propertyName]=this.data.numberOfBins,e.pushInstance(t)},d.prototype.enumerateDataPoints=function(e){var t=this.originalData;t&&t.series&&0!==t.series.length&&l.colorEnumerationHelperModuleFactory().enumerateSeriesDataColors({enumeration:e,dataPoints:_.map(t.series,function(e){return{color:e.color,displayName:e.displayName,identity:e.identity}})},this.featureSwitches)},d.prototype.hasLegend=function(){return!0},d.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},d.prototype.getCartesianVisualCapabilities=function(){return{supportsHierarchicalCategoryAxis:!1,supportsValueAxis:!0}},d.prototype.getStaticSeriesRole=function(){return"Y"},d.BinsSelector=e("bin"),d.SeriesSelector=e("bar"),d.DefaultBinCount=5,d.DefaultBinSize=10,d.view={metadata:{columns:[{roles:{Y:!0},type:{numeric:!0},displayName:"Count of Commit",queryName:"CountNonNull(commits5.Commit)",expr:null,index:0,isMeasure:!0,aggregates:{minLocal:5158,maxLocal:15509}},{roles:{Category:!0},type:{integer:!0},format:"0",displayName:"HourOfDayBin",queryName:"commits5.HourOfDayBin",expr:null,sort:1,sortOrder:0,objects:{general:{formatString:"0"}},index:1,identityExprs:null},{roles:{Category:!0},type:{numeric:!0},format:"0",displayName:"Max of HourOfDay",queryName:"Sum(commits5.HourOfDay)",expr:null,objects:{general:{formatString:"0"}},index:2,isMeasure:!0,aggregates:{minLocal:3,maxLocal:23}}],objects:{categoryAxis:{axisType:"Categorical"},general:{formatString:"0"}}},categorical:{categories:[{source:{roles:{Category:!0},type:{integer:!0},format:"0",displayName:"HourOfDayBin",queryName:"commits5.HourOfDayBin",expr:null,sort:1,sortOrder:0,objects:{general:{formatString:"0"}},index:1,identityExprs:null},values:[0,4,8,12,16,20],identity:null,identityFields:null},{source:{roles:{Category:!0},type:{numeric:!0},format:"0",displayName:null,queryName:"query",expr:null,objects:{general:{formatString:"0"}},index:2,isMeasure:!0,aggregates:{minLocal:3,maxLocal:23}},values:[4,8,12,16,20,24]}],values:t.createValueColumns([{source:{roles:{Y:!0},type:{numeric:!0},displayName:"Count of Commit",queryName:"CountNonNull(commits5.Commit)",expr:null,index:0,isMeasure:!0,aggregates:{minLocal:5158,maxLocal:15509}},values:[5272,5427,11478,15509,12732,5158],highlights:[null,null,null,null,1662,2519]}])}},c.Histogram=d}(l.visuals||(l.visuals={}))}(powerbi=powerbi||{}),function(N){var ie=N.visuals||(N.visuals={}),C=N.visuals.AxisHelper,d=jsCommon.BrowserUtils,h=N.visuals.builder,ae=jsCommon.Color,e=jsCommon.CssConstants.createClassAndSelector,u=N.data.DataViewRoleWildcard,p=N.data.DataViewWildcard,s=jsCommon.DOMConstants,re=jsCommon.EnumExtensions,a=N.visuals.DataViewObjectChangeHelper,r=N.visuals.OnObjectUtil,g=N.data.Selector,y=N.data.Selector.normalizeSelector,o=(ie.horizontalLabelBackgroundPadding=4,se.getDefaultLineChartLabelSettings=function(e,t){void 0===t&&(t=!1);var i=ie.ColorHelper.getThemeColor(e,ie.DataLabelViewModel.DefaultLabelColorName),i=ie.DataLabelViewModel.getDefaultLabelSettings({style:e,labelColor:i,textClassName:"smallLightLabel"}).fontProperties,i={show:!1,showByDefault:!0,position:ie.labelPosition.auto,displayUnits:0,precision:ie.DataLabelViewModel.defaultLabelPrecision,fontProperties:i,labelDensity:ie.DataLabelViewModel.defaultLabelDensity};return t?(i.enableBackground=!0,i.backgroundColor=ie.ColorHelper.getThemeColor(e,ie.BackgroundColorName),i.backgroundTransparency=ie.DataLabelViewModel.defaultComboChartLabelBackgroundOpacity):i.enableBackground=!1,i.bold=!1,i.italic=!1,i.underline=!1,i},se.getDefaultLineChartSeriesLabelSettings=function(e){var t=ie.ColorHelper.getThemeColor(e,ie.DataLabelViewModel.DefaultLabelColorName),e=ie.DataLabelViewModel.getDefaultLabelSettings({style:e,labelColor:t,textClassName:"smallLightLabel"}).fontProperties;return{show:!1,seriesColor:t,seriesPosition:ie.labelSeriesPosition.right,fontProperties:e,seriesWordWrap:!1,seriesMaximumWidth:20,defaultSeriesWidth:20,showLabelPerSeries:!1,enableBackground:!1,bold:!1,italic:!1,underline:!1}},se.getDefaultLineChartSeriesWidthSettings=function(e,t){var i=1;if(t)for(var a=t.length,r=0;r<a;r++)var s=ie.DataLabelRenderer.LabelTextProperties,s={text:t[r],fontFamily:e.family,fontSize:jsCommon.PixelConverter.fromPoint(e.size.pt),fontWeight:s.fontWeight},s=N.TextMeasurementService.measureSvgTextWidth(s)+2*ie.horizontalLabelBackgroundPadding,i=i<s?s:i;return i},se.converter=function(e){return new ie.LineChartConverter(e).convert()},se.getInteractiveLineChartDomElement=function(e){return e.children("svg").get(0)},se.createStackedValueDomain=function(e){return 0===e.length?null:[d3.min(e,function(e){return d3.min(e.data,function(e){return e&&e.stackedValue})}),d3.max(e,function(e){return d3.max(e.data,function(e){return e&&e.stackedValue})})]},se.prototype.initData=function(e){this.options=e,this.style=e.style;var t=e.chartType;this.isComboChart=11===t||14===t||15===t,this.isAreaChart=1===t||2===t,this.element=e.element,this.currentViewport=e.viewport,this.isInteractiveChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.isInteractiveVisual=e.interactivity&&e.interactivity.isVisualInteractive,this.host=e.host},se.prototype.initRenderer=function(e){var t,i=this,a=(this.animator=e.animator,this.cartesianHost=e.cartesianHost,this.scaleDetector=e.scaleDetector,e.svg),a=(a.classed(se.ClassName,!0),this.mainGraphicsSVG=a.append("svg").classed(se.lineChartSVGClassName,!0)),r=(this.svgDefs=a.append("defs"),!this.isComboChart&&!this.isInteractiveChart),e=(this.tooltipService=new n(this.options.services.tooltips,a,r),this.mainGraphicsContext=a.append("g").attr("role","listbox").attr("aria-label",this.host.getLocalizedString("Visual_Plot")).attr("aria-live","polite").classed(se.MainGraphicsContextClassName,!0),this.interactivityService&&(this.isComboChart?this.mainGraphicsContext.attr(s.skipChildrenFocusAttribute,!0):(r=d.isInternetExplorerOrEdge(),e.useManagedTabIndex?(this.mainGraphicsContext.classed(ie.managedTabIndexElement.class,!0),this.mainGraphicsContext.attr(s.skipChildrenFocusAttribute,!0)):this.mainGraphicsContext.attr("tabindex",0).attr("focusable",!0),this.mainGraphicsContext.classed(ie.SetFocusRingClassName,!r))),this.hoverLineContext=a.append("g").classed("hover-line",!0),this.hoverLineContext.append(se.LineElementName).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0),this.hoverLine=this.hoverLineContext.select(se.LineElementName));this.isInteractiveChart&&e.classed("interactive",!0),e.style("opacity",ie.SVGUtil.AlmostZero),e.style("stroke",ie.ColorHelper.getThemeColor(this.style,"foregroundNeutralSecondary")),this.selectionCircles=[],this.xAxisProperties={axis:null,scale:null,axisType:null,formatter:null,graphicsContext:null,values:null,axisLabel:null,isCategoryAxis:!0},this.isInteractiveChart&&(t=se.getInteractiveLineChartDomElement(this.element),r=function(){i.lastDragMoveXPosition=d3.mouse(t)[0],i.deferDragMoveOperation()},a=d3.drag().on("drag",r),d3.select(t).style("touch-action","none").call(a).on("click",r)),this.markerRenderer=new ie.MarkerRenderer,this.anomalyNavigationHelper=new ie.AnomalyDetectionKeyboardNavigationHelper},se.prototype.setData=function(e,t){var i,a,r,s,o;this.data=this.originalData={series:[],dataLabelsSettings:se.getDefaultLineChartLabelSettings(this.style),seriesLabelSetings:se.getDefaultLineChartSeriesLabelSettings(this.style),hasDynamicSeries:!1,categories:[],categoryMetadata:void 0,valuesMetadata:[],categoryData:[],categoryIdentities:[],lineStyle:ie.LineStyle.getDefault(),binnedLineSamplingApplied:!1,legendMarkerRendering:null!=(s=this.featureSwitches)&&s.removeDefaultToCircleToggle?ie.legendMarkerRendering.markerCircleDefault:ie.legendMarkerRendering.markerOnly,matchLineColor:!1,defaultToCircle:null==(s=this.featureSwitches)||!s.removeDefaultToCircleToggle},this.focusedDatum=void 0,_.isEmpty(e)?this.dataView=void 0:(s=_.first(e),i=_.find(e,function(e){return ie.ForecastHelper.isDataViewForForecast(e)}),e=_.find(e,function(e){return ie.AnomalyDetectionVisualPlugin.isDataViewForAnomalyDetection(e)}),s&&s.categorical&&(o={text:!0},a=void 0,(r=(this.dataView=s).categorical.categories)&&!_.isEmpty(r)&&(r[0].source&&r[0].source.type&&(o=r[0].source.type),a=ie.ScalarUtils.getScalarKeys(r[0])),r=ie.CartesianHelper.hasCategoryHierarchy(s),o=ie.ScalarUtils.shouldDrawScalar(s.metadata?s.metadata.objects:null,ie.lineChartProps.categoryAxis.axisType,o,a,r),r=!(!(a=this.host&&this.host.tooltips())||!a.enabled()),a=this.tooltipsEnabled=this.tooltipsEnabledOnHost&&(!a||r),this.data=this.originalData=se.converter({dataView:s,style:this.style,isScalar:o,host:this.host,interactivityService:this.interactivityService,isComboChart:this.isComboChart,tooltipsEnabled:a,forecastDataView:i,anomalyDetectionDataView:e,shouldCalculateStacked:re.hasFlag(this.lineType,16),multipleInfo:t,supportsTotalLabels:!t&&this.supportsTotalLabels(),featureSwitches:this.featureSwitches}),r=this.previousCategoryIds,s=this.data.categoryIdentities,this.suppressAnimation=se.shouldSuppressAnimations(r,s),this.previousCategoryIds=s,o=_.find(this.data.series,function(e){return e.data[0]}),this.focusedDatum=o&&o.data[0]))},se.shouldSuppressAnimations=function(e,t){var i;if(null!=e&&!(e.length>ie.AnimatorCommon.MaxDataPointsToAnimate||t.length>ie.AnimatorCommon.MaxDataPointsToAnimate))if(i=!1,0===e.length)i=!0;else for(var a=0,r=Math.min(e.length,t.length);a<r;a++)if(!ie.SelectionId.isEqual(e[a],t[a])){i=!0;break}return i},se.prototype.getCategoryDomain=function(e){var t=se.getForecastDomain(e.forecastLines),t=t&&t.x,i=this.getCategoryValueType();return C.createDomain(e.series,i,e.isScalar,[C.createScalarDomainOptions(t,0)])},se.prototype.getAxesDomains=function(e,t){if(!this.data)return{};var i,a,r,s=this.data,o={},n=se.getForecastDomain(s.forecastLines);return t.categoryAxis&&s.isScalar&&((a=this.getCategoryDomain(s))&&(C.assertScalarDomain(a),i=a[0],a=a[1],void 0!==i&&void 0!==a&&(o.categoryAxis=[i,a]))),(t.valueAxis||t.secondaryValueAxis)&&(i=n&&n.y,a=this.lineType,t.valueAxis&&(n=se.getValueDataDomain(s,e,!1,a),r=(n=C.mergeDomains(i,n))[0],n=n[1],void 0!==r&&void 0!==n&&(o.valueAxis=[r,n])),t.secondaryValueAxis&&(r=se.getValueDataDomain(s,e,!0,a),t=(n=C.mergeDomains(i,r))[0],s=n[1],void 0!==t&&void 0!==s&&(o.secondaryValueAxis=[t,s]))),o},se.getValueDataDomain=function(e,t,i,a){e=se.getDataForValueAxis(e,i).seriesData;return re.hasFlag(a,16)?se.createStackedValueDomain(e):C.createUncertaintyAwareValueDomain(e,t)},se.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&(1<this.data.series.length||1<this.data.valuesMetadata.length))},se.prototype.setFilteredData=function(e,t){var i=t-e,a=this.scrolledData=N.Prototype.inherit(this.data);return a.series=se.sliceSeries(a.series,i,e),a.categories=a.categories.slice(e,t),a},se.prototype.getSeriesSettings=function(){return N.Prototype.inherit(this.data).seriesLabelSetings},se.getForecastDomain=function(e){if(!_.isEmpty(e)){for(var t=[],i=[],a=0,r=e;a<r.length;a++){var s=r[a];_.isEmpty(s.points)||(t.push.apply(t,_.map(s.points,function(e){return e.point.x})),i.push.apply(i,_.map(s.points,function(e){return e.point.y})),t.push.apply(t,_.map(s.points,function(e){return e.upperBound.x})),i.push.apply(i,_.map(s.points,function(e){return e.upperBound.y})),t.push.apply(t,_.map(s.points,function(e){return e.lowerBound.x})),i.push.apply(i,_.map(s.points,function(e){return e.lowerBound.y})))}return{x:[d3.min(t),d3.max(t)],y:[d3.min(i),d3.max(i)]}}},se.prototype.calculateAxesProperties=function(e){var t,i,a=this,r=e.viewport,s=(this.currentViewport=r,this.trimOrdinalDataOnOverflow=e.trimOrdinalDataOnOverflow,this.margin=e.margin,this.data),r=(this.viewModelAdapter&&this.originalData&&(s=(this.viewModelAdapter=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport})).getData()),e.margin),o=s.series&&0<s.series.length?s.series[0].data.length:0,n=this.getCategoryLayout(o,e,s),l=this.getPreferredPlotArea(n.isScalar,n.categoryCount,n.categoryThickness,n.outerPaddingRatio),o=(s=this.adjustLayoutForScroll(s,o,n),e.roleName),c=s.series,u=!1,d=this.data.valuesMetadata,h=(_.some(c,function(e){return e.isY2})&&(u=o===ie.LineChartRoles.Y2,c=(o=se.getDataForValueAxis(s,u)).seriesData,d=o.valuesMetadata),o=!_.isEmpty(s.series)&&s.series[0].xCol,c&&0<c.length&&(t=c[0].yCol),e.categoryAxisOptions),p=e.valueAxisOptions,g=this.getAxesDomains(!1,{categoryAxis:!0,valueAxis:!u,secondaryValueAxis:u}),y=C.createScalarDomainOptions(u?g.secondaryValueAxis:g.valueAxis,0),c=C.getAxisFormatString(c),m=C.mergeScalarAxisDomains(p.includeDomain,y),f=C.hasForcedDomain(m),v=this.axisShouldIncludeZero(),m=C.createAxis({pixelSpan:l.height,dataDomain:m&&m.domain,axisZoom:e.axisZoom,zeroScalarDomain:[-1,1],metaDataColumn:d,formatString:null!=c?c:ie.valueFormatter.getFormatString(t,ie.lineChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,isSecValueAxis:u||this.isComboChart,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:p.scaleType,logAxisScale:p.logAxisScale,axisDisplayUnits:p.displayUnits,axisPrecision:p.precision,shouldClamp:!1,outerPaddingRatio:0,margin:r,preventNice:f,invertAxis:p.invertAxis,featureSwitches:this.featureSwitches,includeZero:v}),f=s.totalLabelsSettings&&s.totalLabelsSettings.show,v=!1,S=0,x=!1,b=(m.dataDomain&&_.isNumber(m.dataDomain[0])&&_.isNumber(m.dataDomain[1])&&(v=f&&this.supportsTotalLabels(),S=se.getMaximumMarkerSize(s.series),x=_.some(s.anomalyDetections,function(e){return-1!==e.highestAnomalyPointIndex||-1!==e.lowestAnomalyPointIndex})),(v||S||x)&&(!!m.dataDomain&&_.isNumber(m.dataDomain[0])&&_.isNumber(m.dataDomain[1]),b=!(f=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]),v&&(v=se.adjustDomainForLabels(m,s)).adjusted&&(b=!0,v=v.domain,f=[Math.min(f[0],v[0]),Math.max(f[1],v[1])]),S&&(v=se.adjustDomainCommon(m,S)).adjusted&&(b=!0,S=v.domain,f=[Math.min(f[0],S[0]),Math.max(f[1],S[1])]),x&&(b=!0,v=ie.AnomalyDetectionVisualPlugin.adjustDomainForAnomalyMarkers(m.dataDomain,m.scale,s.anomalyDetections),f=[Math.min(f[0],v[0]),Math.max(f[1],v[1])]),b&&(S=C.mergeScalarAxisDomains(p.includeDomain,y,C.createScalarDomainOptions(f,0)),m=C.createAxis({pixelSpan:l.height,dataDomain:S&&S.domain,axisZoom:e.axisZoom,zeroScalarDomain:[-1,1],metaDataColumn:d,formatString:null!=c?c:ie.valueFormatter.getFormatString(t,ie.lineChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,isSecValueAxis:u||this.isComboChart,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:p.scaleType,logAxisScale:p.logAxisScale,axisDisplayUnits:p.displayUnits,axisPrecision:p.precision,shouldClamp:!1,outerPaddingRatio:0,margin:r,preventNice:!0,invertAxis:p.invertAxis,featureSwitches:this.featureSwitches}))),u?this.y2AxisProperties=m:this.yAxisProperties=m,v=s.isScalar?(i=(x=C.mergeScalarAxisDomains(C.createScalarDomainOptions(g.categoryAxis,0),h.includeDomain))&&x.domain,C.hasForcedDomain(x)):(i=this.getCategoryDomain(s),!1),C.createAxis({pixelSpan:l.width,dataDomain:i,axisZoom:e.axisZoom,zeroScalarDomain:[-1,1],metaDataColumn:o,formatString:ie.valueFormatter.getFormatString(o,ie.lineChartProps.general.formatString),outerPadding:s.isScalar?se.ScalarOuterPadding:0,isScalar:s.isScalar,isVertical:!1,forcedTickCount:e.forcedTickCount,maxTickCount:s.scalarKeyCount,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,t){return ie.CartesianHelper.lookupXValue(s,e,t,s.isScalar,a.featureSwitches)},categoryThickness:n.categoryThickness,isCategoryAxis:!0,scaleType:h.scaleType,logAxisScale:h.logAxisScale,axisDisplayUnits:h.displayUnits,axisPrecision:h.precision,outerPaddingRatio:n.outerPaddingRatio,margin:r,allowSingleScalarTick:s.isScalar,preventNice:v,invertAxis:!!s.isScalar&&h.invertAxis,featureSwitches:this.featureSwitches}));return this.interactivityService&&!this.data.isScalar&&(b.categoryIdentities=_.map(s.categoryIdentities,function(e){return function(){return e}})),[b,m]},se.prototype.getCategoryValueType=function(){var e=this.data.scalarMetadata||this.data.categoryMetadata;return C.getCategoryValueType(e)},se.getDataForValueAxis=function(e,t){var i=e.series,e=e.valuesMetadata,a=t?{roles:{Y2:!0}}:{roles:{Y:!0}};return{seriesData:_.filter(i,function(e){return e.isY2===t}),valuesMetadata:_.filter(e,a)}},se.prototype.adjustLayoutForScroll=function(e,t,i){return this.scrolledData=void 0,e&&!e.isScalar&&!this.isScrollable&&this.trimOrdinalDataOnOverflow&&t!==(t=Math.min(t,i.categoryCount))&&((e=this.scrolledData=N.Prototype.inherit(e)).series=se.sliceSeries(e.series,t),e.categories=e.categories.slice(0,t),e.categoryIdentities&&(e.categoryIdentities=e.categoryIdentities.slice(0,t))),e},se.prototype.setAxesLayout=function(e){var t=e.layout,i=(this.currentViewport=t.viewport,this.margin=t.margin,this.trimOrdinalDataOnOverflow=e.trimOrdinalDataOnOverflow,this.viewModelAdapter&&this.originalData&&(i=this.viewModelAdapter=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport}),this.data=i.getData()),this.data.series&&0<this.data.series.length?this.data.series[0].data.length:0),a=e.layout.axes.x,a=this.data?{categoryCount:_.isEmpty(a.values)?0:a.values.length,categoryThickness:a.categoryThickness,outerPaddingRatio:a.outerPaddingRatio,innerPaddingRatio:a.innerPaddingRatio,isScalar:this.getVisualCategoryAxisIsScalar()}:{categoryCount:0,categoryThickness:ie.CartesianHelper.MinOrdinalRectThickness,outerPaddingRatio:0,innerPaddingRatio:0,isScalar:!1};this.data=this.adjustLayoutForScroll(this.data,i,a),this.xAxisProperties=t.axes.x,2&e.axisType&&(this.isComboChart?this.yAxisProperties=t.axes.y2:this.y2AxisProperties=t.axes.y2),1&e.axisType&&(this.yAxisProperties=t.axes.y1)},se.adjustDomainForLabels=function(e,t){var i="",a=(0<t.series.length&&0<t.series[0].data.length&&(i=t.series[0].data[0].labelFormatString),ie.DataLabelViewModel.createColumnFormatterCacheManager()),r=ie.DataLabelRenderer.getLabelUnitAndPrecisionForAxis(e,t.totalLabelsSettings),a=a.getOrCreate(i,t.totalLabelsSettings,r.units,t.totalLabelsSettings.precision),i=e.dataDomain[0].toString(),r=ie.DataLabelRenderer.getLabelFormattedText(a.format(i)),a=ie.FontProperties.toTextProperties(t.totalLabelsSettings.fontProperties,r),i=N.TextMeasurementService.estimateSvgTextHeight(a)+ie.DataLabelViewModel.labelMargin;return se.adjustDomainCommon(e,i)},se.getMaximumMarkerSize=function(e){var t=0;return t=0<e.length?d3.max(e,function(e){return e.lineStyle.markerProperties.showMarker?e.lineStyle.markerProperties.size:0})*ie.MarkerRenderer.sizeRatio:t},se.adjustDomainCommon=function(e,t){var i=e.dataDomain,a=e.scale.domain(),e=e.scale,r=e(i[0])+t,i=e(i[1])-t,t=e.invert(r),r=e.invert(i);return C.adjustDomainWithConstantPixelDifference(a[0],a[1],t,r)},se.prototype.getCategoryLayout=function(e,t,i){if(!i)return{categoryCount:0,categoryThickness:ie.CartesianHelper.MinOrdinalRectThickness,outerPaddingRatio:t.outerPaddingRatio,innerPaddingRatio:t.innerPaddingRatio,isScalar:!1};var a=this.getAvailableWidth(),r=i?i.preferredCategoryWidth:null,s=i?i.categoryMetadata:void 0,s=C.getCategoryValueType(s),o=this.getVisualCategoryAxisIsScalar(),n=t.categoryAxisOptions,i=C.createDomain(i.series,s,o,[n.includeDomain]);return ie.CartesianChartLayout.getLayout(this.data,{availableWidth:a,categoryCount:e,preferredCategoryWidth:r,domain:i,isScalar:o,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:t.trimOrdinalDataOnOverflow,outerPaddingRatio:t.outerPaddingRatio,innerPaddingRatio:t.innerPaddingRatio})},se.prototype.getErrorBarsCard=function(){var n=this;if(null!=(e=this.featureSwitches)&&e.lineChartError&&!this.isAreaChart){var l,e,c=this.originalData;if(c&&c.series&&0!==c.series.length)return l=function(e){return n.host.getLocalizedString(e)},e=[(e=ie.StandardObjectIdentifiers.error).enabled,e.errorRange,e.barShow,e.barMatchSeriesColor,e.barColor,e.barWidth,e.barBorderColor,e.barBorderSize,e.shadeShow,e.shadeBandStyle,e.shadeColor,e.shadeMatchSeriesColor,e.shadeTransparency,e.labelShow,e.labelFontFamily,e.labelFontSize,e.labelBold,e.labelItalic,e.labelUnderline,e.labelColor,e.labelMatchSeriesColor,e.labelFormat,e.labelBackground,e.labelBackgroundColor,e.labelBackgroundTransparency,e.markerShape,e.markerSize,e.showMarkerByDefault,e.tooltipShow,e.tooltipFormat],(e=new ie.builder.FormattingCardBuilder(new ie.builder.FormattingCardUidBuilder("errorBars"),"Visual_Error_Bars",e,l,!0,!0)).addGroup("applySettingsTo",function(e){e.withDisplayName("Apply_Settings_To").withCollapsible(!1),e.addContainer("measure",function(o){o.withDisplayName("Series");for(var e=0,t=c.valuesMetadataBySeries;e<t.length;e++)!function(e){var t=_.first(e.usedInSeriesIndices);if(null!=t){var i=e.metadataColumn,t=c.series[t];if(null==t)return;var a=e.valueSelector.getSelector(),r=n.isComboChart?u.fromRoles([ie.LineChartRoles.Rows,ie.LineChartRoles.Category]):p.create(),r=__assign(__assign({},a),{data:[r],highlightMatching:1}),s={localize:l,uncertainty:t.uncertainty,targetMeasure:e.metadataColumn.expr,measureSelector:a,dataPointSelector:r,featureSwitches:n.featureSwitches};o.addContainerItem(i.queryName,i.displayName,function(e){return ie.UncertaintyHelper.getFormattingContainer(s,e)})}}(t[e])})}),e.build()}},se.prototype.getDataPointCard=function(a){var r,s,e,o,n,l,c=this,u=this.originalData;if(u&&u.series&&0!==u.series.length)return r=function(e){return c.host.getLocalizedString(e)},s=N.DataViewObjects.getValue(this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects,ie.lineChartObjectProps.lineStyles.showSeries,!0),e=[ie.lineChartObjectProps.lineStyles.lineStyle,ie.lineChartObjectProps.lineStyles.showSeries,ie.lineChartObjectProps.lineStyles.strokeWidth,ie.lineChartObjectProps.lineStyles.strokeLineJoin,ie.lineChartObjectProps.lineStyles.stepped,ie.lineChartObjectProps.dataPoint.fill,ie.lineChartObjectProps.dataPoint.showAllDataPoints,ie.lineChartObjectProps.dataPoint.defaultColor,ie.lineChartObjectProps.dataPoint.transparency,ie.cartesianChartProps.categoryAxis.preferredCategoryWidth,ie.comboChartObjectProps.lineStyles.shadeArea,ie.cartesianChartProps.categoryAxis.reverseStackOrder],e=new ie.builder.FormattingCardBuilder(new ie.builder.FormattingCardUidBuilder("lines"),"Visual_Lines",e,r),o={lineStyle:ie.lineChartObjectProps.lineStyles.lineStyle,strokeLineJoin:ie.lineChartObjectProps.lineStyles.strokeLineJoin,strokeWidth:ie.lineChartObjectProps.lineStyles.strokeWidth,stepped:ie.lineChartObjectProps.lineStyles.stepped,showSeries:ie.lineChartObjectProps.lineStyles.showSeries},n={styleProps:o,style:u.lineStyle,showSeries:!0,showSeriesValue:s},l=this.getValidDataPointIndices(u),e.addGroup("applySettingsTo",function(e){e.withDisplayName("Apply_Settings_To").withCollapsible(!1).withContainerDisabled(!s).addContainer("series",function(e){if(e.withDisplayName("Series"),e.addContainerItem("all",r("All"),function(e){var t;c.addDataPointGroupsToContainer(a,n,e,l),s||(t=[ie.lineChartObjectProps.lineStyles.lineStyle,ie.lineChartObjectProps.lineStyles.strokeWidth,ie.lineChartObjectProps.lineStyles.strokeLineJoin,ie.lineChartObjectProps.lineStyles.stepped,ie.lineChartObjectProps.lineStyles.showMarkerByDefault,ie.lineChartObjectProps.lineStyles.showMarker,ie.lineChartObjectProps.lineStyles.markerShape,ie.lineChartObjectProps.lineStyles.markerSize,ie.lineChartObjectProps.lineStyles.markerColor],e.addSimpleSlice("showSeriesLink",function(){return new h.SeriesDialogLinkBuilder({descriptor:ie.lineChartObjectProps.lineStyles.showSeries,value:function(){},ariaLabel:"Enable_This_Setting",type:"SeriesDialogLink",resetToDefaultDescriptors:t,warningIcon:!0}).build()},function(e){return e.withCustomDisplayName("Enable_This_Setting").withSuppressDisplayName(!0)}))}),1<u.series.length)for(var t=0,i=u.series;t<i.length;t++)!function(t){n={styleProps:o,style:t.lineStyle,selector:y(t.identity.getSelector())},e.addContainerItem(t.seriesName,t.seriesName,function(e){return c.addDataPointGroupsToContainer(a,n,e,l,t)})}(i[t])})}),this.getVisualCategoryAxisIsScalar()||e.addGroup("spacing",function(e){e.withDisplayName("RibbonChart_SeriesGapWidth").addSimpleSlice("categoryWidth",new ie.builder.NumUpDownBuilder({descriptor:ie.cartesianChartProps.categoryAxis.preferredCategoryWidth,value:a.preferredCategoryWidth,options:{minValue:{type:0,value:20},maxValue:{type:1,value:180},unitSymbol:"Numeric_Pixel"}}).build())}),e.build()},se.prototype.addDataPointGroupsToContainer=function(i,a,e,t,r){function s(e){return o.host.getLocalizedString(e)}var o=this,n=(ie.LineStyle.addLineStyleFormattingContainers(a,e),this.originalData),l=_.map(n.series,function(e){return{color:e.color,displayName:e.seriesName,identity:e.identity}}),t=(i.reverseStackOrder||l.reverse(),0<t.length&&se.chartTypeSupportsExplicitDots(n.isComboChart)),c=(e.addGroup("colors",function(e){e.withDisplayName("Visual_Colors");var t={groupBuilder:e,dataPoints:l,seriesColorProps:ie.lineChartObjectProps.dataPoint,localize:s,featureSwitches:o.featureSwitches},t=(r?(t=__assign(__assign({},t),{selector:a.selector}),N.colorEnumerationHelperModuleFactory().appendSeriesColorSlicesToGroup(t,a.selector)):N.colorEnumerationHelperModuleFactory().appendSeriesColorSlicesToGroup(t),o.originalData.series.length);(o.originalData.hasDynamicSeries||1<t)&&o.featureSwitches&&o.featureSwitches.flipStackOrder&&o.isStacked()&&e.addSimpleSlice("Visual_ReverseStackOrder",new h.ToggleSwitchBuilder({descriptor:ie.cartesianChartProps.categoryAxis.reverseStackOrder,value:i.reverseStackOrder}).build()),o.isComboChart&&(r?e.addSimpleSlice("shadearea",function(){return new h.ToggleSwitchBuilder({descriptor:__assign(__assign({},ie.comboChartObjectProps.lineStyles.shadeArea),{selector:r.identity.getSelector()}),value:r.lineStyle.shadeArea}).build()}):e.addSimpleSlice("shadearea",function(){return new h.ToggleSwitchBuilder({descriptor:ie.comboChartObjectProps.lineStyles.shadeArea,value:n.lineStyle.shadeArea}).build()}))}),this.isAreaChart&&se.areaTransparencyEnabled),u=n.areaTransparency;t&&c&&e.addGroup("shadeArea",function(e){e.withDisplayName("Visual_Shapes_ShadeArea").addSimpleSlice("transparency",h.SliderBuilder.getTransparencySliderBuilder({descriptor:ie.lineChartObjectProps.dataPoint.transparency,value:u,localize:s}).build(),function(e){return e.withDisabled(!!r)}),r&&e.withDisabled(!0,"")})},se.prototype.getMarkersCard=function(){var o,n,l,e,a=this,c=this.originalData;if(c&&c.series&&0!==c.series.length)return o=function(e){return a.host.getLocalizedString(e)},n=N.DataViewObjects.getValue(this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects,ie.lineChartObjectProps.lineStyles.showSeries,!0),l={showMarker:ie.lineChartObjectProps.lineStyles.showMarker,markerShape:ie.lineChartObjectProps.lineStyles.markerShape,markerSize:ie.lineChartObjectProps.lineStyles.markerSize,markerColor:ie.lineChartObjectProps.lineStyles.markerColor,showAllDataPoints:ie.lineChartObjectProps.dataPoint.showAllDataPoints,fill:ie.lineChartObjectProps.dataPoint.fill,showSeries:ie.lineChartObjectProps.lineStyles.showSeries},e=new ie.builder.FormattingCardBuilder(new ie.builder.FormattingCardUidBuilder("markers"),"Visual_Markers",l,o),e.addTopLevelToggle("showMarkerTopLevel",function(){return new h.ToggleSwitchBuilder({descriptor:__assign({},l.showMarker),value:c.lineStyle.markerProperties.showMarker}).build()}),e.addGroup("applySettingsTo",function(e){var t=a.getValidDataPointIndices(c),i=0<t.length&&se.chartTypeSupportsExplicitDots(c.isComboChart),r=i?a.getCategoryColorsOptions(c,t,e,i):void 0,s={styleProps:l,style:c.lineStyle,categoryColorsOptions:r};e.withContainerDisabled(!n).withDisplayName("Apply_Settings_To").withCollapsible(!1),e.addContainer("series",function(e){if(e.withDisplayName("Series"),e.addContainerItem("all",o("All"),function(e){var t;ie.MarkerProperties.addMarkersFormattingContainers(s,e),n||(t=[ie.lineChartObjectProps.lineStyles.lineStyle,ie.lineChartObjectProps.lineStyles.strokeWidth,ie.lineChartObjectProps.lineStyles.strokeLineJoin,ie.lineChartObjectProps.lineStyles.stepped,ie.lineChartObjectProps.lineStyles.showMarker,ie.lineChartObjectProps.lineStyles.showMarkerByDefault,ie.lineChartObjectProps.lineStyles.markerShape,ie.lineChartObjectProps.lineStyles.markerSize,ie.lineChartObjectProps.lineStyles.markerColor,ie.lineChartObjectProps.dataPoint.showAllDataPoints,ie.lineChartObjectProps.dataPoint.fill],e.addSimpleSlice("showSeriesLink",function(){return new h.SeriesDialogLinkBuilder({descriptor:ie.lineChartObjectProps.lineStyles.showSeries,value:function(){},ariaLabel:"Enable_This_Setting",type:"SeriesDialogLink",resetToDefaultDescriptors:t,warningIcon:!0}).build()},function(e){return e.withCustomDisplayName("Enable_This_Setting").withSuppressDisplayName(!0)}))}),1<c.series.length)for(var t=0,i=c.series;t<i.length;t++){var a=i[t];s={styleProps:l,style:a.lineStyle,categoryColorsOptions:r,selector:y(a.identity.getSelector())},e.addContainerItem(a.seriesName,a.seriesName,function(e){return ie.MarkerProperties.addMarkersFormattingContainers(s,e)})}})}),e.build()},se.prototype.getDataLabelsCard=function(){function s(e){return o.host.getLocalizedString(e)}var o=this,n=this.originalData,e=n.dataLabelsSettings,l=n.series.length,c=1<l||!n.categoryMetadata||this.isComboChart,u=[ie.labelPosition.auto,ie.labelPosition.above,ie.labelPosition.under],t=(this.isStacked()&&(u=[ie.labelPosition.auto,ie.labelPosition.insideCenter,ie.labelPosition.insideEnd]),e.position&&u.indexOf(e.position)<0&&(e.position=ie.labelPosition.auto),__assign(__assign({},ie.lineChartObjectProps.labels),{position:ie.lineChartObjectProps.labels.labelPosition,precision:ie.lineChartObjectProps.labels.labelPrecision,displayUnits:ie.lineChartObjectProps.labels.labelDisplayUnits,labelBackgroundColor:ie.lineChartObjectProps.labels.backgroundColor,labelBackgroundTransparency:ie.lineChartObjectProps.labels.backgroundTransparency})),i=new ie.builder.FormattingCardBuilder(new ie.builder.FormattingCardUidBuilder("labels"),"Visual_DataPointsLabels",t,s),a=this.getLabelSettingsOptions(void 0,e,null,c,u),d={cardBuilder:i,dataLabelsProps:t,featureSwitches:this.featureSwitches,hostServices:this.host,options:a,includeAltConstantValueSelector:!0,individualSelector:this.isComboChart?void 0:ie.DataLabelViewModel.generateLabelIndividualSelector({hasCategories:null!=_.first(n.categories),hasDynamicSeries:n.hasDynamicSeries,featureSwitches:this.featureSwitches,hasSeriesSelector:!1})};return i.withDescription("Visual_DataPointsLabelsDescription"),t.show&&i.addTopLevelToggle("show",function(){return new h.ToggleSwitchBuilder({descriptor:t.show,value:a.dataLabelsSettings.show}).build()}),i.addGroup("applySettingsTo",function(e){e.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(e){if(e.withDisplayName("Series"),e.addContainerItem("all",s("All"),function(e){return ie.DataLabelViewModel.createDataLabelsFormattingContainers(d,e)}),c)for(var t=0;t<l;t++){var i=n.series[t],a=i.labelSettings||n.dataLabelsSettings,r=(a.position&&u.indexOf(a.position)<0&&(a.position=ie.labelPosition.auto),i.identity.getSelector()),a=o.getLabelSettingsOptions(void 0,a,r,void 0,u);d.includeAltConstantValueSelector=!1,d.selector=n.hasDynamicSeries?g.normalizeSelector(r):r,d.individualSelector=ie.DataLabelViewModel.generateLabelIndividualSelector({hasCategories:null!=_.first(n.categories),hasDynamicSeries:n.hasDynamicSeries,featureSwitches:o.featureSwitches,hasSeriesSelector:!0}),d.options=a,e.addContainerItem(i.seriesName,i.seriesName,function(e){return ie.DataLabelViewModel.createDataLabelsFormattingContainers(d,e)})}})}),i.build()},se.prototype.getSeriesLabelsCard=function(){var s,e,o,n,l,t,i,a,c,u=this;if(this.showSeriesCard())return s=this.originalData,e=s.seriesLabelSetings,o=s.series.length,n=this.showLabelPerSeries(),l=function(e){return u.host.getLocalizedString(e)},t=__assign(__assign({},ie.lineChartObjectProps.seriesLabels),{show:{objectName:"seriesLabels",propertyName:"show"}}),i=new ie.builder.FormattingCardBuilder(new ie.builder.FormattingCardUidBuilder("seriesLabels"),"Visual_SeriesLabels",t,l),a=this.getSeriesLabelSettingsOptions(void 0,e,null,n),c={cardBuilder:i,seriesLabelsProps:t,featureSwitches:this.featureSwitches,hostServices:this.host,seriesOptions:a},i.withDescription("Visual_SeriesDescription"),t.show&&i.addTopLevelToggle("show",function(){return new h.ToggleSwitchBuilder({descriptor:t.show,value:a.seriesLabelsSettings.show}).build()}),i.addGroup("applySettingsTo",function(e){e.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(e){if(e.withDisplayName("Series"),e.addContainerItem("all",l("All"),function(e){return ie.DataLabelViewModel.createSeriesLabelsFormattingContainers(c,e)}),n)for(var t=0;t<o;t++){var i=s.series[t],a=i.seriesSettings||s.seriesLabelSetings,r=i.identity.getSelector(),a=u.getSeriesLabelSettingsOptions(void 0,a,r,void 0);c.selector=s.hasDynamicSeries?g.normalizeSelector(r):r,c.seriesOptions=a,e.addContainerItem(i.seriesName,i.seriesName,function(e){return ie.DataLabelViewModel.createSeriesLabelsFormattingContainers(c,e)})}})}),i.build()},se.prototype.getTotalsCard=function(){var t=this;if(this.supportsTotalLabels()){var e,i,a=this.originalData,r=a.totalLabelsSettings;if(r)return e=__assign(__assign({},ie.lineChartObjectProps.totals),{precision:ie.lineChartObjectProps.totals.labelPrecision,displayUnits:ie.lineChartObjectProps.totals.labelDisplayUnits}),(i=new ie.builder.FormattingCardBuilder(new ie.builder.FormattingCardUidBuilder("totals"),"Visual_DataTotalLabels",e,function(e){return t.host.getLocalizedString(e)})).withDescription("Visual_DataTotalLabelsDescription"),i={cardBuilder:i,dataLabelsProps:e,featureSwitches:this.featureSwitches,hostServices:this.host,options:this.getTotalLabelSettingsOptions(void 0,r),individualSelector:ie.DataLabelViewModel.generateLabelIndividualSelector({hasCategories:null!=_.first(a.categories),hasDynamicSeries:a.hasDynamicSeries,featureSwitches:this.featureSwitches,hasSeriesSelector:!1})},ie.DataLabelViewModel.getDataLabelsFormattingModel(i)}},se.prototype.getFormattingCards=function(e){var t=this;return{card:[function(){return t.getDataPointCard(e.categoryAxisData)},function(){return t.getMarkersCard()},function(){return t.getDataLabelsCard()},function(){return t.getSeriesLabelsCard()},function(){return t.getTotalsCard()},function(){return t.getErrorBarsCard()}].reduce(function(e,t){t=t();return t&&e.push(t),e},[]),type:0}},se.prototype.getDisambiguationSubSelectables=function(e,t){if(!this.data)return[];var i=[];if(void 0===t||3===t)for(var a=0,r=this.data.series;a<r.length;a++){var s,o=r[a];o.lineStyle.markerProperties.showMarker&&(s=null==(s=null==o?void 0:o.identity)?void 0:s.getSelectorsByColumn(),o=this.host.getLocalizedString("MiniToolbar_Markers",o.seriesName),i.push(e.createVisualSubSelectionForSingleObject({objectName:"markers",subSelectionType:3,displayName:o,showUI:!0,selectorsByColumn:s})))}return i},se.prototype.getSelectorsByColumnFromSubselectedElement=function(e){switch(d3.select(e).attr(ie.SubSelectableObjectNameAttribute)){case"area":case"lines":var t=d3.select(e).datum(),t=null==(t=null==t?void 0:t.identity)?void 0:t.getSelectorsByColumn();if(t)return t;case"data-labels":case"series-labels":return ie.DataLabelUtil.getLabelSeriesSelectorsByColumn(e,this.data.series);default:return{}}},se.prototype.getSubSelectionCustomOutlines=function(e){var t=e.visualObjects[0].objectName,i=e.visualObjects[0].selectorsByColumn;if("markers"===t){e=(null==(e=this.scrolledData)?void 0:e.series)||(null==(t=this.data)?void 0:t.series);if(e)for(var a=0,r=e;a<r.length;a++){var s=r[a],o=null==(o=s.identity)?void 0:o.getSelectorsByColumn();if(g.equalsSelectorsByColumn(o,i))return se.getMarkerOutlinesForSeries(s,this.buildViewModel(0),this.tooltipService.getTooltipOverlayElement()||this.mainGraphicsPositionRect)}}},se.prototype.getSubSelectionStyles=function(e){var t,e=_.first(e).visualObjects;if(0<e.length)switch((e=e[0])&&e.selectorsByColumn&&(t=g.normalizeSelector(g.convertSelectorsByColumnToSelector(e.selectorsByColumn))),e.objectName){case"lines":return t?{type:3,stroke:{reference:{cardUid:"Visual-lines",groupUid:"lines-applySettingsTo-series--colors",sliceUid:"lines-applySettingsTo-series--colors-datapoint",selector:t},label:this.host.getLocalizedString("Visual_Shape_Line")}}:void 0;case"area":return t?r.getShapeSubSelectionStyles("Visual-lines","lines-applySettingsTo-series--colors","lines-applySettingsTo-series--colors-datapoint",this.host,!1,!0,t):void 0;case"markers":if(!t)return;var i="markers-applySettingsTo-series--colors",a=1===this.data.series.length;return r.getShapeSubSelectionStyles("Visual-markers",a?void 0:i,i+"-markerColor",this.host,!1,!0,a?void 0:t);default:return}},se.prototype.getSubSelectionShortcuts=function(e){e=_.first(e).visualObjects;if(0<e.length){var t,e=e[0],i=!this.showLabelPerSeries(),a=(_.isEmpty(e.selectorsByColumn)||(t=g.normalizeSelector(g.convertSelectorsByColumnToSelector(e.selectorsByColumn))),{key:"Delete",nextValue:!1});switch(e.objectName){case"lines":case"area":if(!t)return;var r=i?"labels-topLevelToggle-show":"labels-applySettingsTo-series--showSeries",s=i?"Visual-markers":"markers-applySettingsTo-series--showMarker",o=i?"Visual-seriesLabels":"seriesLabels-applySettingsTo-series--showSeries";return[{type:0,relatedResetSourceUids:[r,i?"markers-topLevelToggle-showMarkerTopLevel":"markers-applySettingsTo-series--showMarker","lines-applySettingsTo-series--colors-datapoint"],selector:t},{type:2,sourceUid:r,enabledLabel:this.host.getLocalizedString("Format_AddDataLabels"),selector:t},{type:2,sourceUid:s,enabledLabel:this.host.getLocalizedString("Format_AddMarkers"),selector:t,keyboardShortcuts:[a]},{type:2,sourceUid:o,enabledLabel:this.host.getLocalizedString("Format_AddSeriesLabel"),selector:t},{type:1,destinationUids:[{cardUid:"Visual-lines"}],label:this.host.getLocalizedString("Format_Line")}];case"markers":if(!t)return;r=1===this.data.series.length;return[{type:2,sourceUid:i?"Visual-markers":"markers-applySettingsTo-series--showMarker",disabledLabel:this.host.getLocalizedString("Delete"),selector:r?void 0:t,keyboardShortcuts:[a]},{type:0,relatedResetSourceUids:["markers-applySettingsTo-series--colors-markerColor"],selector:r?void 0:t},{type:1,destinationUids:[{cardUid:"Visual-markers",groupUid:"markers-applySettingsTo-series--markers"}],label:this.host.getLocalizedString("Format_Markers")}];default:return}}},se.prototype.enumerateObjectInstances=function(e,t){var i,a=this.originalData;if(a)switch(t.objectName){case"dataPoint":this.enumerateDataPoints(e);break;case"labels":this.enumerateDataLabels(e);break;case"seriesLabels":null!=(i=this.featureSwitches)&&i.lineChartSeriesLabels&&this.enumerateSeriesDataLabels(e);break;case"totals":this.supportsTotalLabels()&&this.enumerateTotalLabels(e);break;case ie.lineChartProps.lineStyles.strokeLineJoin.objectName:se.enumerateLineStyles(e,a,this.dataView);break;case ie.ForecastHelper.forecastObjectName:this.supportsForecast()&&(i=void 0,_.isEmpty(a.anomalyDetections)||(i=this.host.getLocalizedString("Visual_AnomalyDetection_WarningMessage_NoWithForecast")),ie.ForecastHelper.enumerateObjectInstances(e,a.forecastLines,this.style,i));break;case ie.AnomalyDetectionObjectConstants.capabilityObjectName:this.supportsAnomalyDetection()&&(i=a.isScalar,ie.AnomalyDetectionVisualPlugin.enumerateAnomalyObjectInstances(this.host,this.data,this.dataView,e,a.anomalyDetections,this.style,i,t.selectors))}},se.prototype.enumerateDataPoints=function(e){var i=this.originalData;if(i&&i.series&&0!==i.series.length){N.colorEnumerationHelperModuleFactory().enumerateSeriesDataColors({enumeration:e,dataPoints:_.map(i.series,function(e){return{color:e.color,displayName:e.seriesName,identity:e.identity}})},this.featureSwitches);var t=this.getValidDataPointIndices(i),a=0<t.length&&se.chartTypeSupportsExplicitDots(i.isComboChart);if(a){for(var r=[],s=0,o=t;s<o.length;s++){var n=o[s],n=ie.CategoryLevelUtils.concatenateCategoryLevels(i.categoryData[n.categoryIndex].hierarchyCategoryLevels);r.push(n.value)}N.colorEnumerationHelperModuleFactory().enumerateCategoryDataColors({enumeration:e,dataView:this.dataView,style:this.style,categories:_.map(t,function(e,t){return{color:i.series[e.seriesIndex].data[e.dataPointIndex].pointColor,displayName:r[t],identity:i.categoryIdentities[e.categoryIndex]}}),fillInstanceKind:i.hasDynamicSeries?1:3,noDefaultFillColor:a,multipleRole:i.multipleIdentity?ie.LineChartRoles.Rows:void 0,supportDataPointTransparency:this.isAreaChart&&se.areaTransparencyEnabled,dataPointTransparency:i.areaTransparency},this.featureSwitches)}}},se.prototype.enumerateDataLabels=function(e){var t=this.originalData,i=t.dataLabelsSettings,a=t.series.length,r=this.showLabelPerSeries(),s=[ie.labelPosition.auto,ie.labelPosition.above,ie.labelPosition.under];if(this.isStacked()&&(s=[ie.labelPosition.auto,ie.labelPosition.insideCenter,ie.labelPosition.insideEnd],i.position&&s.indexOf(i.position)<0&&(i.position=ie.labelPosition.auto)),ie.DataLabelViewModel.enumerateDataLabels(this.getLabelSettingsOptions(e,i,null,r,s),this.featureSwitches),r&&i.showLabelPerSeries)for(var o=0;o<a;o++){var n=t.series[o],l=n.labelSettings||t.dataLabelsSettings,n=(e.pushContainer({displayName:n.seriesName}),n.identity.getSelector());t.hasDynamicSeries&&(n=g.normalizeSelector(n)),ie.DataLabelViewModel.enumerateDataLabels(this.getLabelSettingsOptions(e,l,n,void 0,s),this.featureSwitches),e.popContainer()}},se.prototype.showSeriesCard=function(){return!(this.isComboChart&&!this.data.hasY2Role)},se.prototype.enumerateSeriesDataLabels=function(e){if(this.showSeriesCard()){var t=this.originalData,i=t.seriesLabelSetings,a=t.series.length,r=this.showLabelPerSeries();if(ie.DataLabelViewModel.enumerateSeriesDataLabels(this.getSeriesLabelSettingsOptions(e,i,null,r),this.featureSwitches),r&&i.showLabelPerSeries)for(var s=0;s<a;s++){var o=t.series[s],n=o.seriesSettings||t.seriesLabelSetings,o=(e.pushContainer({displayName:o.seriesName}),o.identity.getSelector());t.hasDynamicSeries&&(o=g.normalizeSelector(o)),ie.DataLabelViewModel.enumerateSeriesDataLabels(this.getSeriesLabelSettingsOptions(e,n,o,void 0),this.featureSwitches),e.popContainer()}}},se.prototype.enumerateTotalLabels=function(e){var t=this.originalData.totalLabelsSettings;t&&ie.DataLabelViewModel.enumerateDataLabels(this.getTotalLabelSettingsOptions(e,t),this.featureSwitches)},se.enumerateLineStyles=function(e,t,i){var a;if(1<t.series.length&&(a=N.DataViewObjects.getValue(i&&i.metadata&&i.metadata.objects,ie.lineChartProps.lineStyles.showSeries,!1)),ie.LineStyle.enumerate({enumeration:e,style:t.lineStyle,showSeries:a}),a)for(var r=0,s=t.series.length;r<s;r++){var o=t.series[r];e.pushContainer({displayName:o.seriesName}),ie.LineStyle.enumerate({enumeration:e,style:o.lineStyle,selector:o.identity.getSelector()}),e.popContainer()}},se.prototype.supportsTotalLabels=function(){return!!(!this.data||!this.data.multipleIdentity)&&this.isStacked()},se.prototype.supportsTrendLine=function(){if(this.data.multipleIdentity)return!1;var e=this.getVisualCategoryAxisIsScalar(),t=this.haveY2Data()&&!this.isComboChart;return!re.hasFlag(this.lineType,16)&&e&&this.data.hasValues&&!t},se.prototype.supportsStaticReferenceLines=function(){return this.getVisualCategoryAxisIsScalar()},se.prototype.supportsForecast=function(){if(this.data.multipleIdentity)return!1;var e=this.getVisualCategoryAxisIsScalar();return!re.hasFlag(this.lineType,16)&&e&&this.data.hasValues&&1===this.data.series.length&&!this.hasLegend()},se.prototype.supportsAnomalyDetection=function(){return!this.data.multipleIdentity&&(this.options.featureSwitches.daxTransformEnabled&&!re.hasFlag(this.lineType,16)&&this.data.hasValues)},se.prototype.isStacked=function(){return re.hasFlag(this.lineType,16)},se.prototype.shouldSuppressAnimation=function(){return!!this.suppressAnimation},se.prototype.showLabelPerSeries=function(){var e=this.originalData;return 1<e.series.length||!e.categoryMetadata||this.isComboChart},se.prototype.getLabelSettingsOptions=function(e,t,i,a,r){return{enumeration:e,dataLabelsSettings:t,show:!0,position:!0,positionObject:r,displayUnits:!0,precision:!0,selector:i,showAll:a,fontSize:!0,fontFamily:!0,labelDensity:this.data.isScalar,enableBackground:t.enableBackground,backgroundColor:t.backgroundColor,backgroundTransparency:t.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0}},se.prototype.getSeriesLabelSettingsOptions=function(e,t,i,a){return{enumeration:e,show:!0,seriesLabelsSettings:t,seriesColor:t.seriesColor,seriesPosition:t.seriesPosition,selector:i,enableBackground:t.enableBackground,backgroundColor:t.backgroundColor,backgroundTransparency:t.backgroundTransparency,style:this.style,fontProperties:t.fontProperties,seriesWordWrap:t.seriesWordWrap,seriesMaximumWidth:t.seriesMaximumWidth,defaultSeriesWidth:t.defaultSeriesWidth,showAll:a,fontSize:!0,fontFamily:!0,bold:!0,italic:!0,underline:!0}},se.prototype.getTotalLabelSettingsOptions=function(e,t){return{enumeration:e,dataLabelsSettings:t,show:!0,displayUnits:!0,precision:!0,fontSize:!0,fontFamily:!0,enableBackground:t.enableBackground,backgroundColor:t.backgroundColor,backgroundTransparency:t.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0}},se.prototype.overrideXScale=function(e){this.xAxisProperties=e},se.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},se.prototype.render=function(e,t,i){var a,r=this,s=ie.AnimatorCommon.GetAnimationDuration(this.animator,e),s=(this.suppressAnimation&&(s=0),this.buildViewModel(s)),o=this.tooltipService.getTooltipOverlayElement(),n=(this.mainGraphicsPositionRect=this.mainGraphicsSVG.selectAll(se.PositionRectSelector.selector).data(function(e){return!o&&i?[e]:[]}).join("rect").attrs({x:0,width:0,height:0}).style("pointer-events","none").classed(se.PositionRectSelector.class,!0),{hoverLine:this.hoverLine,hoverLineContext:this.hoverLineContext,mainGraphicsContext:this.mainGraphicsContext,svgDefs:this.svgDefs,mainGraphicsSVG:this.mainGraphicsSVG,mainGraphicsPositionOverlay:o||this.mainGraphicsPositionRect}),l=(ie.AnomalyDetectionCartesianRenderer.render(this.data.anomalyDetections,n.mainGraphicsSVG,s.xAxisProperties.scale,s.yAxisProperties.scale,s.currentViewport,s.animationDuration,this.host,this.isInteractiveVisual),se.hasAnomalies(this.data)?this.data.anomalyDetections[0].anomalies:[]);return this.anomalyNavigationHelper.update(l,this.scrolledData,this.focusedDatum,function(e){return se.updateFocusElement(r.mainGraphicsContext,e,r.buildViewModel(0),r.host)},this.mainGraphicsContext),this.isInteractiveChart?(l=$.extend(n,{dragHandle:this.dragHandle,selectionCircles:this.selectionCircles}),a=se.renderOld(s,l,this.interactivityService,this,this,this.isInteractiveChart,e,this.markerRenderer,this.style),l.dragHandle&&(this.dragHandle=l.dragHandle)):a=se.renderNew({viewModel:s,renderContext:n,interactivityService:this.interactivityService,plotAreaHelper:this,tooltipService:this.tooltipService,tooltipInteractivity:this,markerRenderer:this.markerRenderer,style:this.style,host:this.host,anomalyNavigationHelper:this.anomalyNavigationHelper,formatMode:i}),this.interactivityService&&(a.navigationOptions={helper:this,navigationStrategy:s.data.isScalar?ie.DataPointNavigationStrategy.SeriesFirst:ie.DataPointNavigationStrategy.CategoryFirst}),ie.ForecastHelper.render(this.data.forecastLines,n.mainGraphicsSVG,s.xAxisProperties.scale,s.yAxisProperties.scale,s.currentViewport,s.animationDuration),ie.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),a},se.prototype.buildViewModel=function(e){return{currentViewport:this.currentViewport,data:this.scrolledData||this.data,allData:this.data,animationDuration:e,horizontalOffset:this.getXOfFirstCategory(),isComboChart:this.isComboChart,lineClassAndSelector:this.lineClassAndSelector,lineType:this.lineType,margin:this.margin,scale:this.featureSwitches.removeScaleDetector?void 0:this.scaleDetector.getScale(),tooltipsEnabled:this.tooltipsEnabled,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,y2AxisProperties:this.y2AxisProperties,focusedDatum:this.focusedDatum}},se.renderNew=function(s){var o=s.viewModel,n=s.renderContext,l=s.plotAreaHelper,a=s.tooltipService,R=s.tooltipInteractivity,t=s.viewModel.data,e=s.markerRenderer,i=s.style;if(t){for(var r=_.filter(t.series,function(e){return e.uncertainty&&e.uncertainty.renderUncertainty}),B=!_.isEmpty(r),c=[],H=0,U=o.data.series;H<U.length;H++){var u=U[H];c.push(u.lineStyle.markerProperties),B&&u.uncertainty&&(c.push(u.uncertainty.markers),u.uncertainty.markersFlipped&&c.push(u.uncertainty.markersFlipped))}e.ensureMarkers(s.renderContext.svgDefs,c);var d,h,z,p,j,E,W,G,Y,g,X,K,y=re.hasFlag(o.lineType,16),m=o.margin,f=o.currentViewport,Z=f.height-(m.top+m.bottom),f=f.width-(m.left+m.right),v=o.xAxisProperties.scale,S=o.yAxisProperties.scale,x=o.y2AxisProperties&&o.y2AxisProperties.scale,b=o.horizontalOffset,C=t.isScalar,m=t.seriesLabelSetings,w=(m&&m.show&&(w=m?100*m.defaultSeriesWidth/f:0,w=Math.min(Math.max(1,w),50),f-=(m?m.defaultSeriesWidth?w:m.seriesMaximumWidth:0)/100*f),o.focusedDatum),D=s.interactivityService&&s.interactivityService.hasSelection(),q=re.hasFlag(o.lineType,2)||re.hasFlag(o.lineType,16),A=q||t.lineStyle.shadeArea||_.some(t.series,function(e){return e.lineStyle.shadeArea}),P=o.animationDuration,L=((t.categories.length*t.series.length>ie.AnimatorCommon.MaxDataPointsToAnimate||e.shouldDisableAnimations()&&_.some(c,function(e){return e.showMarker})||A)&&(P=0),function(e){return v(se.getXValue(e,C))+b}),M=y?(d=function(e){return S(e.stackedValue-e.value)},function(e){return S(e.stackedValue)}):(d=function(e){return(e.isY2?x:S)(0)},function(e){return(e.isY2?x:S)(e.value)}),V=(A&&(h=se.getAreaGenerator(L,d,M),z=se.getAreaGenerator(L,d,M).curve(d3.curveStep)),se.getLineGenerator(L,M)),T=se.getLineGenerator(L,M).curve(d3.curveStep),F=(re.hasFlag(o.lineType,4)&&(V.curve(d3.curveBasis),h&&h.curve(d3.curveBasis)),se.hasAnomalies(t)?s.host.getLocalizedString("Visual_Plot")+" "+s.host.getLocalizedString("Visual_Plot_ScreenReader_NavigateToAnomalies"):s.host.getLocalizedString("Visual_Plot")),F=(n.mainGraphicsContext.attr("aria-label",F),n.mainGraphicsSVG.attr("height",Z).attr("width",f),A?(p=(F=n.mainGraphicsContext.selectAll(se.CategoryAreaSelector.selector).data(_.filter(t.series,function(e){return q||e.lineStyle&&e.lineStyle.shadeArea}),function(e){return e.identity.getKey()})).enter().append(se.PathElementName).classed(se.CategoryAreaSelector.class,!0).merge(F).style("fill",function(e){return e.areaColor}).style("fill-opacity",function(e){return D&&!e.selected?se.AreaTransparencyReductionFactor*(1-t.areaTransparency/100):1-t.areaTransparency/100}).classed(ie.HtmlSubSelectableClass,!0).attr(ie.SubSelectableObjectNameAttribute,"area").attr(ie.SubSelectableTypeAttribute,3).each(function(a){var t=this;ie.HtmlSubSelectionHelper.setDataForElement(t,{getDisplayName:function(){var e=d3.select(t).datum().seriesName;return s.host.getLocalizedString("MiniToolbar_Shape",e)},getRegionOutlines:function(){var t=d(a.data[0]),e=a.data.map(function(e){return{x:L(e),y:M(e)}}),i=[];e.forEach(function(e){return i.unshift({x:e.x,y:t})});return[{id:"area",outlines:[{type:2,points:__spreadArray(__spreadArray([],e),i)}]}]}})}),s.formatMode&&p.style("pointer-events","auto"),P?p.transition().ease(d3.easeLinear).duration(P).attr("d",function(e){return(e.lineStyle.stepped?z:h)(e.data)}):p.attr("d",function(e){return(e.lineStyle.stepped?z:h)(e.data)}),p.order(),F.exit().remove()):p=n.mainGraphicsContext.selectAll(se.CategoryAreaSelector.selector).remove(),B?(F=n.mainGraphicsContext.selectAll(se.UncertaintySelector.selector).data([1]).join("g").attr("class",se.UncertaintySelector.class),j=d3.area().x(L).y0(function(e){return null!=e.uncertainty.lower?(e.isY2?x:S)(e.uncertainty.lower):M(e)}).y1(function(e){return null!=e.uncertainty.upper?(e.isY2?x:S)(e.uncertainty.upper):M(e)}).defined(function(e){return e&&e.uncertainty&&(null!=e.uncertainty.upper||null!=e.uncertainty.lower)}),E=d3.line().x(L).y(function(e){return(e.isY2?x:S)(e.uncertainty.lower)}).defined(function(e){return e&&e.uncertainty&&null!=e.uncertainty.lower}),W=d3.line().x(L).y(function(e){return(e.isY2?x:S)(e.uncertainty.upper)}).defined(function(e){return e&&e.uncertainty&&null!=e.uncertainty.upper}),G=function(e,t){return ie.ColumnUtil.getFillOpacity(e.selected,!1,D,D,ae.convertTransparencyToOpacity(t))},F.selectAll(se.UncertaintyAreas.selector).data(_.filter(r,function(e){return e.uncertainty.band.show}),function(e){return e.identity.getKey()}).join("g").attr("class",se.UncertaintyAreas.class).order().each(function(e){var t,i,a,r;null==e||_.isEmpty(e.data)||(t=e.uncertainty.band,i=d3.select(this),a=_.filter(e.data,function(e){return!!e}),r=t.bandStyle!==ie.confidenceBandStyle.line?["0"]:[],i.selectAll(se.UncertaintyArea.selector).data(r,function(e){return e}).join("path").attr("class",se.UncertaintyArea.class).style("fill",t.color).style("fill-opacity",G(e,t.transparency)).attr("d",j(a)),r=t.bandStyle!==ie.confidenceBandStyle.fill?["0"]:[],i.selectAll(se.UncertaintyLines.selector).data(r,function(e){return e}).join("g").attr("class",se.UncertaintyLines.class).style("stroke",t.color).style("stroke-opacity",G(e,t.transparency)).style("stroke-width",2).selectAll(se.UncertaintyLine.selector).data(["upper","lower"],function(e){return e}).join("path").attr("class",se.UncertaintyLine.class).attr("d",function(e){return("upper"===e?W:E)(a)}))}),F.selectAll(se.UncertaintyBars.selector).data(_.filter(r,function(e){return e.uncertainty.bar.show}),function(e){return e.identity.getKey()}).join("g").attr("class",se.UncertaintyBars.class).style("fill",function(e){return e.uncertainty.bar.color}).style("stroke",function(e){return e.uncertainty.bar.borderColor}).style("stroke-width",function(e){return e.uncertainty.bar.borderWidth}).order().each(function(e){var t;null==e||_.isEmpty(e.data)||(t=e.uncertainty.bar,e=_.filter(e.data,function(e){return!!e}),d3.select(this).selectAll(se.UncertaintyBar.selector).data(e,function(e){return e.identity.getKey()}).join("path").attr("class",se.UncertaintyBar.class).attr("transform",function(e){return"translate("+L(e)+", "+(e.isY2?x:S)(e.value)+")"}).attr("d",function(e){return d3.symbol().type(ie.UncertaintyHelper.errorBarSymbol(e,t,e.isY2?x:S)).size(10)()}))}),Y=S.range()[1]>S.range()[0],I=F.selectAll(se.UncertaintyMarkers.selector).data(_.filter(r,function(e){return e.uncertainty.markers.showMarker}),function(e){return e.identity.getKey()}).join("g").attr("class",se.UncertaintyMarkers.class).style("stroke-opacity",0).style("stroke-width",2).order().selectAll(se.UncertaintyMarker.selector).data(function(t){return _.map(["upper","lower"],function(e){return{seriesData:t,type:e}})}).join("path").attr("class",se.UncertaintyMarker.class).style("stroke-width","inherit").attr("d",function(e){return("upper"===e.type&&!Y||"lower"===e.type&&Y?W:E)(e.seriesData.data)}),e.renderUncertaintyMarkers(I),g=[se.UncertaintyAreas,se.UncertaintyBars,se.UncertaintyMarkers],(I=F.selectAll(_.map(g,function(e){return e.selector}).join(", ")).nodes()).sort(function(e,t){for(var i=0,a=0,r=g.length;a<r;a++)i=(i+=Number(d3.select(e).classed(g[a].class))*a)-Number(d3.select(t).classed(g[a].class))*a;return i}),d3.selectAll(I).order()):n.mainGraphicsContext.selectAll(se.UncertaintySelector.selector).remove(),n.mainGraphicsContext.selectAll(o.lineClassAndSelector.selector).data(t.series,function(e){return e.identity.getKey()})),I=F.enter().append(se.PathElementName).classed(o.lineClassAndSelector.class,!0).merge(F),I=(I.style("stroke",function(e){return e.color}).style("stroke-opacity",function(e){return ie.ColumnUtil.getFillOpacity(e.selected,!1,D,D)}).style("stroke-width",function(e){return i.isHighContrast?ie.CartesianHelper.defaultLineStrokeWidth:e.lineStyle.strokeWidth}).style("stroke-linejoin",function(e){return e.lineStyle.lineJoin}).style("stroke-dasharray",function(e){return ie.LineStyle.getStrokeDashArrayFromLineStyle(e.lineStyle.style)}),P?I.transition().ease(d3.easeLinear).duration(P).attr("d",function(e){return(e.lineStyle.stepped?T:V)(e.data)}):I.attr("d",function(e){return(e.lineStyle.stepped?T:V)(e.data)}),I.order(),F.exit().remove(),n.mainGraphicsContext.selectAll(se.MarkerLineClassSelector.selector).data(_.filter(t.series,function(e){return e.lineStyle.markerProperties.showMarker}),function(e){return e.identity.getKey()})),F=I.enter().append(se.PathElementName).classed(se.MarkerLineClassSelector.class,!0).style("stroke","#ffffff").style("stroke-width",ie.CartesianHelper.defaultLineStrokeWidth).style("stroke-opacity",0).merge(I),e=(P?k=F.transition().ease(d3.easeLinear).duration(P).attr("d",function(e){return V(e.data)}).style("opacity",function(e){return ie.ColumnUtil.getFillOpacity(e.selected,!1,D,!1)}).style("pointer-events","none"):F.attr("d",function(e){return V(e.data)}).style("opacity",function(e){return ie.ColumnUtil.getFillOpacity(e.selected,!1,D,!1)}).style("pointer-events","none"),F.order(),e.renderMarkers(k||F),I.exit().remove(),n.mainGraphicsContext.selectAll(se.InteractivityLineClassSelector.selector).data(_.filter(t.series,function(e){return se.getLeftmostPathPointFromSeriesData(e)}),function(e){return e.identity.getKey()})),k=e.enter().append(se.PathElementName).classed(se.InteractivityLineClassSelector.class,!0).style("stroke-width",se.interactivityStrokeWidth).style("stroke-linejoin",ie.strokeLineJoin.round).attr(ie.SubSelectableObjectNameAttribute,"lines").attr(ie.SubSelectableAltObjectNameAttribute,"markers").attr(ie.SubSelectableTypeAttribute,3).classed(ie.HtmlSubSelectableClass,!A).merge(e),F=(k.attr("d",function(e){if(!C){var t=se.getLeftmostPathPointFromSeriesData(e);if(t){var i=_.findIndex(e.data,function(e){return e&&e.categoryIndex===t.categoryIndex});if(0<i&&i<e.data.length)return i=e.data.slice(i),(e.lineStyle.stepped?T:V)(i)}}return(e.lineStyle.stepped?T:V)(e.data)}),e.exit().remove(),k.order(),k.each(function(){var a=this;ie.HtmlSubSelectionHelper.setDataForElement(a,{getDisplayName:function(){var e=d3.select(a).datum();return s.host.getLocalizedString("MiniToolbar_Line",e.seriesName)},getRegionOutlines:function(){var e=d3.select(a).datum(),t=s.renderContext,i=s.viewModel;return se.getMarkerOutlinesForSeries(e,i,t.mainGraphicsPositionOverlay)}})}),n.mainGraphicsContext.selectAll(se.CategorySelector.selector).data(t.series,function(e){return e.identity.getKey()})),I=F.enter().append("g").classed(se.CategorySelector.class,!0).merge(F),A=(F.exit().remove(),F.order(),I.selectAll(se.CategoryValuePoint.selector).data(function(i){return i.data.filter(function(e,t){return se.shouldDrawCircle(i,t)})},function(e){return e.key})),e=A.enter().append(se.CircleElementName).classed(se.CategoryValuePoint.class,!0).classed(ie.HtmlSubSelectableClass,!0).attr(ie.SubSelectableObjectNameAttribute,"lines").attr(ie.SubSelectableAltObjectNameAttribute,"markers").attr(ie.SubSelectableTypeAttribute,3).merge(A),F=(e.style("fill",function(){return d3.select(this.parentNode).datum().color}).style("fill-opacity",function(){var e=d3.select(this.parentNode).datum();return e.lineStyle.markerProperties.showMarker?0:ie.ColumnUtil.getFillOpacity(e.selected,!1,D,!1)}),P?e.transition().duration(P).attrs({cx:function(e,t){return v(se.getXValue(e,C))+b},cy:function(e,t){return e.isY2?x(e.value):S(y?e.stackedValue:e.value)},r:t.lineStyle.strokeWidth/2+se.CircleRadiusExtra}):e.attrs({cx:function(e,t){return v(se.getXValue(e,C))+b},cy:function(e,t){return e.isY2?x(e.value):S(y?e.stackedValue:e.value)},r:t.lineStyle.strokeWidth/2+se.CircleRadiusExtra}),A.exit().remove(),e.each(function(){var i=d3.select(this.parentNode).datum();ie.HtmlSubSelectionHelper.setDataForElement(this,{getDisplayName:function(){return s.host.getLocalizedString("MiniToolbar_Line",i.seriesName)},getRegionOutlines:function(){var e=s.renderContext,t=s.viewModel;return se.getMarkerOutlinesForSeries(i,t,e.mainGraphicsPositionOverlay)}})}),I.selectAll(se.CategoryPointSelector.selector).data(function(e){return se.chartTypeSupportsExplicitDots(o.isComboChart)?_.filter(e.data,function(e){return e&&null!=e.pointColor}):[]},function(e){return e.key})),A=F.enter().append(se.CircleElementName).classed(se.CategoryPointSelector.class,!0).style("pointer-events","none").merge(F),I=(A.style("fill",function(e){return e.pointColor}),P?A.transition().duration(P).attrs({cx:function(e){return v(se.getXValue(e,C))+b},cy:function(e,t){return e.isY2?x(e.value):S(y?e.stackedValue:e.value)},r:t.lineStyle.strokeWidth/2+se.PointRadiusExtra}):A.attrs({cx:function(e){return v(se.getXValue(e,C))+b},cy:function(e,t){return e.isY2?x(e.value):S(y?e.stackedValue:e.value)},r:t.lineStyle.strokeWidth/2+se.PointRadiusExtra}),F.exit().remove(),A.order(),0<t.series.length&&(n.mainGraphicsContext.selectAll(se.SelectedMarkerLineClassSelector.selector).data([0]).enter().append("g").attr("class",se.SelectedMarkerLineClassSelector.class),(X=this.renderSelectedPointsGenerator(n.mainGraphicsContext,o))(D)),s.interactivityService&&(K=this.updateFocusElement(n.mainGraphicsContext,w,o,s.host)),t.dataLabelsSettings),P=[],F=[],I=(I&&I.show&&(P=P.concat(this.createLabelDataPoints(o,i))),m&&m.show&&(w=m.seriesPosition===ie.labelSeriesPosition.right?1:0,F=F.concat(this.createSeriesLabelDataPoints(o,i,w?f:0,w))),t.totalLabelsSettings);I&&I.show&&y&&(P=P.concat(this.createTotalLabelDataPoints(o,i)));_.map(_.filter(r,function(e){return e.uncertainty.labels.show}),function(e){return e.uncertainty.labels})&&(P=P.concat(this.createUncertaintyLabels(o,i,s.host)));var O,m={width:f,height:Z,interactivityLines:k,dots:e,explicitDots:A,isComboChart:o.isComboChart,binnedLineSamplingApplied:t.binnedLineSamplingApplied,hasDynamicSeries:t.hasDynamicSeries},w=(a.removeTooltips(m,R),o.tooltipsEnabled&&!s.formatMode&&a.applyTooltips(m,l,R),n.mainGraphicsContext.selectAll(_.map(se.RenderOrderableElements,function(e){return e.selector}).join(", ")).nodes()),$=(w.sort(function(e,t){for(var i=0,a=0;a<se.RenderOrderableElements.length;a++)i=(i+=Number(d3.select(e).classed(se.RenderOrderableElements[a].class))*a)-Number(d3.select(t).classed(se.RenderOrderableElements[a].class))*a;return i}),d3.selectAll(w).order(),[]);if(s.interactivityService){for(var N=[],J=0,Q=o.allData.series;J<Q.length;J++){var u=Q[J],ee=($.push(u),_.filter(u.data,function(e){return e}));N.push.apply(N,ee||[])}O=[],se.hasAnomalies(t)&&(I=_.filter(t.anomalyDetections[0].anomalies,function(e){return e.isAnomaly}),O.push.apply(O,I||[]));var r=n.mainGraphicsSVG.selectAll(ie.AnomalyDetectionCartesianRenderer.anomalyPointClassSelector.selector),te={interactivityLines:k,root:n.mainGraphicsContext,focusMarker:K,selectedMarkersCallback:X,dots:e,areas:p,tooltipOverlay:a.getTooltipOverlayElement(),showHoverline:a.usingHoverLine,getCategoryIndex:function(e,t,i){return i=i&&!a.usingHoverLine,l.getCategoryIndexFromSeriesAndPointX(e,t,i)},categoryIdentities:t.categoryIdentities,hitTester:new oe({dataPoints:N,isComboChart:o.isComboChart,isScalar:C,hasCategories:0<t.categoryIdentities.length}),onSelecting:s.host.onSelecting,anomalies:r,anomalyNavigationHelper:s.anomalyNavigationHelper,areaTransparency:t.areaTransparency,onLineSubSelection:function(e,t,i,a,r){se.onLineSubSelection(e,t,i,a,l,s.host,o,n.mainGraphicsSVG,r)},onDotSubSelection:function(e,t,i,a){se.onDotSubSelection(e,t,i,s.host,a)}}}return{dataPoints:N?__spreadArray(__spreadArray([],$),N):void 0,behaviorOptions:te,labelDataPoints:[],labelsAreNumeric:!0,labelDataPointGroups:P,labelDataPointSeriesGroups:F,animateLabels:!1,anomalies:O}}},se.hasAnomalies=function(e){return _.some(e.anomalyDetections,function(e){return!_.isEmpty(e.anomaliesCategoryIndex)})},se.isAnomaly=function(e){return e.isAnomaly},se.getAreaGenerator=function(e,t,i){return d3.area().x(e).y0(t).y1(i).defined(function(e){return e&&null!==e.value})},se.getLineGenerator=function(e,t){return d3.line().x(e).y(t).defined(function(e){return e&&null!==e.value})},se.renderSelectedPointsGenerator=function(o,n){var e=n.data,l=e.series,c=e.isScalar,u=re.hasFlag(n.lineType,16),d=n.horizontalOffset,h=n.xAxisProperties.scale,p=n.yAxisProperties.scale,g=n.y2AxisProperties&&n.y2AxisProperties.scale,y=o.selectAll(se.SelectedMarkerLineClassSelector.selector);return function(i){var e=_.flatten(_.map(l,function(e){return _.filter(e.data,function(e){return e&&e.selected&&null!==e.value})})),t=y.selectAll(se.PathElementName).data(e,function(e){return e.key}),a=_.map(e,function(e){return e.seriesIndex}),e=t.enter().append(se.PathElementName).attr("pointer-events","none").merge(t),t=(e.attr("d",function(e){return e.lineStyle.markerProperties.showMarker?ie.Markers.getPathWithRadius(e.lineStyle.markerProperties.shape,e.lineStyle.markerProperties.size*ie.MarkerRenderer.sizeRatio):ie.Markers.getPathWithRadius(ie.markerShape.circle,e.lineStyle.strokeWidth/2+se.TooltipCircleRadiusExtra)}).attr("transform",function(e){return"translate("+(h(se.getXValue(e,c))+d)+","+(e.isY2?g(e.value):p(u?e.stackedValue:e.value))+")"}).style("stroke-width",function(e){return ie.Markers.getStrokeWidth(e.lineStyle.markerProperties.shape)}).style("stroke-opacity",1).style("stroke",function(e){return e.lineStyle.markerProperties.color}).style("fill",function(e){return e.lineStyle.markerProperties.color}),t.exit().remove(),o.selectAll(n.lineClassAndSelector.selector)),r=[];t.each(function(e,t){r[t]=e.selected,e.selected=-1<a.indexOf(e.lineIndex)}).style("stroke-opacity",function(e,t){return ie.ColumnUtil.getFillOpacity(e.selected,!1,i,i&&!r[t])});function s(e,t){return ie.ColumnUtil.getFillOpacity(e.selected||-1<a.indexOf(e.lineIndex),!1,i,i&&!r[e.lineIndex],null!=t?ae.convertTransparencyToOpacity(t):void 0)}o.selectAll(se.MarkerLineClassSelector.selector).style("opacity",function(e){return ie.ColumnUtil.getFillOpacity(!1,!1,i,!1)});t=o.select(se.UncertaintySelector.selector);return t.selectAll(se.UncertaintyAreas.selector).each(function(e){var t=e.uncertainty.band.transparency,i=d3.select(this);i.selectAll(se.UncertaintyArea.selector).style("fill-opacity",s(e,t)),i.selectAll(se.UncertaintyLines.selector).style("stroke-opacity",s(e,t))}),t.selectAll(se.UncertaintyBars.selector).style("fill-opacity",function(e){return s(e)}).style("stroke-opacity",function(e){return s(e)}),t.selectAll(se.UncertaintyMarker.selector).style("opacity",function(e){return s(e.seriesData)}),e}},se.updateFocusElement=function(e,t,r,s){var i=r.xAxisProperties.scale,a=r.yAxisProperties.scale,o=r.y2AxisProperties&&r.y2AxisProperties.scale,n=r.data.isScalar,l=r.horizontalOffset,c=re.hasFlag(r.lineType,16),u=d.isInternetExplorerOrEdge(),e=e.selectAll(se.FocusElementSelector.selector).data(t?[t]:[]),t=e.enter().append(se.CircleElementName).attr("class",se.FocusElementSelector.class).attr("tabindex",0).attr("focusable",!0).attr("role","option").classed(ie.SetFocusRingClassName,!u).merge(e);return t.attr("aria-label",function(t){var e,i,a;return se.isAnomaly(t)?s.getLocalizedString("Anomaly_ScreenReader_Hint"):(a=t,e=!1,se.hasAnomalies(r.data)&&(i=r.data.anomalyDetections[0].anomaliesCategoryIndex,e=_.some(i,function(e){return e===t.categoryIndex})),i=ie.tooltipUtils.formatTooltipInfo(a.tooltipInfo),(a=a.uncertainty)&&(a.upperTooltip&&(i+=" "+ie.tooltipUtils.formatTooltipInfo([a.upperTooltip])),a.lowerTooltip&&(i+=" "+ie.tooltipUtils.formatTooltipInfo([a.lowerTooltip]))),e&&(i+=" "+s.getLocalizedString("AnomalyPoint_ScreenReader_Hint")),i)}).attr("cx",function(e){return i(se.getXValue(e,n))+l||0}).attr("cy",function(e){var t;return se.isAnomaly(e)?(t=r.data.anomalyDetections[0].markerShapeSize,ie.AnomalyDetectionCartesianRenderer.getAnomalyYPosition(e,a,t)):(t=e).isY2?o(t.value):a(c?t.stackedValue:t.value)}).attr("r",function(e){var t;return se.isAnomaly(e)?(t=r.data.anomalyDetections[0].markerShapeSize,ie.AnomalyDetectionCartesianRenderer.getAnomalySize(t)):(t=e.lineStyle.markerProperties).showMarker?t.size*ie.MarkerRenderer.sizeRatio:e.lineStyle.strokeWidth/2+se.TooltipCircleRadiusExtra}).style("fill","none"),e.exit().remove(),t},se.getMarkerXPositionCalc=function(e,t,i,a){t=t(se.getXValue(e,i.data.isScalar));return se.convertSvgXToClientX(t,i.horizontalOffset,i.currentViewport.scale,a)},se.getMarkerXPosition=function(e,t,i,a){var r=t.xAxisProperties.scale,i=i.node().getBoundingClientRect().left,e=_.find(e.data,function(e){return e&&e.categoryIndex===a});return Math.floor(se.getMarkerXPositionCalc(e,r,t,i))},se.getMarkerOutlinesForSeries=function(e,t,i){var a=e.data,i=i.node().getBoundingClientRect(),r=i.left,s=i.top,i=null==(i=_.first(e.data))?void 0:i.isY2,o=t.currentViewport,n=t.data,l=t.xAxisProperties,c=t.yAxisProperties,u=l.scale,d=(i?t.y2AxisProperties:c).scale,h=o.scale,l=n.lineStyle.markerProperties.size*h,p=Math.max(l+1.2*l,10)*h,g=(p%2==0&&++p,[]),y=1;a.length*p>o.width&&(i=ie.DataLabelRenderer.getNumberOfLabelsToRender(o.width,50,4,p),y=Math.floor(a.length/i));for(var m=0;m<a.length;m+=y){var f=a[m];f&&g.push({x:Math.floor(se.getMarkerXPositionCalc(f,u,t,r)-p/2),y:Math.floor(se.convertSvgYToClientY(d(f.value),h,s)-p/2),width:p,height:p,type:0})}return[{id:e.key,outlines:g}]},se.onLineSubSelection=function(e,t,i,a,r,s,o,n,l){var c,u=ie.InteractivityUtils.getPositionOfLastInputEvent(),r=r.getCategoryIndexFromSeriesAndPointX(e,t,!0),t=se.getMarkerXPosition(e,o,n,r),n=null==(o=e.identity)?void 0:o.getSelectorsByColumn(),r=e.lineStyle.markerProperties.showMarker&&Math.abs(t-u.x)<=e.lineStyle.markerProperties.size/2?(c="markers",s.getLocalizedString("MiniToolbar_Markers",e.seriesName)):(c="lines",s.getLocalizedString("MiniToolbar_Line",e.seriesName)),o={x:a.clientX,y:a.clientY},t=i.createVisualSubSelectionForSingleObject({objectName:c,subSelectionType:3,displayName:r,showUI:l,selectorsByColumn:n,selectionOrigin:o});i.subSelect(t)},se.onDotSubSelection=function(e,t,i,a,r){var s,o=null==(o=e.identity)?void 0:o.getSelectorsByColumn(),a=e.lineStyle.markerProperties.showMarker?(s="markers",a.getLocalizedString("MiniToolbar_Markers",e.seriesName)):(s="lines",a.getLocalizedString("MiniToolbar_Line",e.seriesName)),e={x:i.clientX,y:i.clientY},i=t.createVisualSubSelectionForSingleObject({objectName:s,subSelectionType:3,displayName:a,showUI:r,selectorsByColumn:o,selectionOrigin:e});t.subSelect(i)},se.prototype.getFirstElement=function(t,e){var i,a;return void 0===e&&(e=!1),null!=t?((i=e?_.findLast:_.find)(this.data.series,function(e){return a=i(e.data,function(e){return e&&e.categoryIndex===t&&null!=e.value})}),a&&this.scrolledData&&-1===this.scrolledData.categories.indexOf(a.categoryValue)?{element:null,targetCategoryIndex:a.categoryIndex,targetSeriesIndex:a.seriesIndex}:a?(this.focusedDatum=a,{element:se.updateFocusElement(this.mainGraphicsContext,a,this.buildViewModel(0),this.host).node(),targetCategoryIndex:t,targetSeriesIndex:a.seriesIndex}):(e=e?this.data.series.length-1:0,{element:null,targetCategoryIndex:t,targetSeriesIndex:e})):{element:this.mainGraphicsContext.select(se.FocusElementSelector.selector).node()}},se.prototype.getNextDataPoint=function(t,e,i){var a,r,s=this.focusedDatum;switch(i){case ie.DataDirection.NextCategory:case ie.DataDirection.PreviousCategory:var o,n=this.data.series[e];s=n?(n=n.data,o=_.findIndex(n,function(e){return e&&e.categoryIndex===t}),this.pickNextAvailableIndex(n,o,e,i)):void 0;break;case ie.DataDirection.NextSeries:case ie.DataDirection.PreviousSeries:n=_.map(this.data.series,function(e){return _.find(e.data,function(e){return e&&e.categoryIndex===t})});s=this.pickNextAvailableIndex(n,e,t,i)}return s?this.scrolledData&&-1===this.scrolledData.categories.indexOf(s.categoryValue)?{element:null,targetCategoryIndex:s.categoryIndex,targetSeriesIndex:s.seriesIndex}:(this.focusedDatum=s,{element:se.updateFocusElement(this.mainGraphicsContext,s,this.buildViewModel(0),this.host).node(),targetCategoryIndex:s.categoryIndex,targetSeriesIndex:s.seriesIndex}):(a=i===ie.DataDirection.NextSeries||i===ie.DataDirection.NextCategory?1:-1,r=this.data.categories.length,t=this.incrementIndex(t,a,r),r=e,i!==ie.DataDirection.NextSeries&&i!==ie.DataDirection.PreviousSeries||(r=a<0?this.data.series.length-1:0),{element:null,targetCategoryIndex:t,targetSeriesIndex:r})},se.prototype.pickNextAvailableIndex=function(e,t,i,a){var r=a===ie.DataDirection.NextCategory||a===ie.DataDirection.PreviousCategory?this.rollToNextSeries:this.rollToNextCategory,s=a===ie.DataDirection.NextSeries||a===ie.DataDirection.NextCategory?1:-1,o=t;do{if((o+=s)>=e.length||o<0)return r.call(this,i,a)}while(o!==t&&(!e[o]||null==e[o].value));return e[o]},se.prototype.rollToNextSeries=function(e,t){t!==ie.DataDirection.PreviousCategory&&ie.DataDirection.NextCategory;var i=t===ie.DataDirection.PreviousCategory?-1:1,t=t===ie.DataDirection.PreviousCategory?_.findLast:_.find,a=this.data.series.length;return e=this.incrementIndex(e,i,a),t(this.data.series[e].data,function(e){return e&&null!=e.value})},se.prototype.rollToNextCategory=function(t,e){e!==ie.DataDirection.PreviousSeries&&ie.DataDirection.NextSeries;var i=e===ie.DataDirection.PreviousSeries?-1:1,e=e===ie.DataDirection.PreviousSeries?_.findLast:_.find,a=this.data.categories.length,i=(t=this.incrementIndex(t,i,a),_.map(this.data.series,function(e){return _.find(e.data,function(e){return e&&e.categoryIndex===t})}));return e(i,function(e){return e&&null!=e.value})||e(i,function(e){return!!e})},se.prototype.incrementIndex=function(e,t,i){return i<=(e+=t)?e=0:e<0&&(e=i-1),e},se.renderOld=function(e,t,i,a,r,s,o,n,l){var c=this,u=e.data;if(u){for(var d,h=e.margin,p=e.currentViewport,g=p.height-(h.top+h.bottom),y=e.xAxisProperties.scale,m=e.yAxisProperties.scale,f=e.y2AxisProperties&&e.y2AxisProperties.scale,v=u.isScalar,S=e.animationDuration,x=(n.shouldDisableAnimations()&&(S=0),p.width-(h.left+h.right)),p=p.height-(h.top+h.bottom),b=i&&i.hasSelection(),C=function(e){return(e.isY2?f:m)(e.value)},w=re.hasFlag(e.lineType,16)||re.hasFlag(e.lineType,2),h=w||u.lineStyle.shadeArea||_.some(u.series,function(e){return e.lineStyle.shadeArea}),D=(h&&(d=d3.area().x(function(e){return y(se.getXValue(e,v))}).y0(g).y1(C).defined(function(e){return null!==e.value})),d3.line().x(function(e){return y(se.getXValue(e,v))}).y(C).defined(function(e){return!!e&&null!==e.value})),i=(re.hasFlag(e.lineType,4)&&(D.curve(d3.curveBasis),d&&d.curve(d3.curveBasis)),e.horizontalOffset),x=(t.mainGraphicsContext.attr("transform",ie.SVGUtil.translate(i,0)),t.mainGraphicsSVG.attr("height",p).attr("width",x),t.hoverLineContext.attr("transform",ie.SVGUtil.translate(i,0)),h?((g=t.mainGraphicsContext.selectAll(se.CategoryAreaSelector.selector).data(_.filter(u.series,function(e){return w||e.lineStyle&&e.lineStyle.shadeArea}),function(e){return e.identity.getKey()})).enter().append("g").classed(se.CategoryAreaSelector.class,!0).append(se.PathElementName),t.mainGraphicsContext.selectAll(se.CategoryAreaSelector.selector).select(se.PathElementName).transition().ease(d3.easeLinear).duration(S).attr("d",function(e){return d(e.data)}).style("fill",function(e){return e.areaColor}).style("fill-opacity",function(e){return b&&!e.selected?c.AreaTransparencyReductionFactor*(1-u.areaTransparency/100):1-u.areaTransparency/100}),g.exit().remove()):t.mainGraphicsContext.selectAll(se.CategoryAreaSelector.selector).remove(),t.mainGraphicsContext.selectAll(se.CategorySelector.selector).data(u.series,function(e){return e.identity.getKey()})),i=x.enter().append("g").classed(se.CategorySelector.class,!0),h=(i.append(se.PathElementName),i.selectAll(se.CategoryValuePoint.selector).data(function(e){return e.data}).enter().append(se.CircleElementName).classed(se.CategoryValuePoint.class,!0),i.merge(x)),A=(x.exit().remove(),s&&!t.dragHandle&&(g=p,t.dragHandle=t.hoverLineContext.append("circle").attr("cx",0).attr("cy",g).attr("r","6px").classed("drag-handle",!0)),h.data().length);t.selectionCircles.length<A;){var P=t.hoverLineContext.append(se.CircleElementName).classed(se.CircleClassName,!0).attr("r",u.lineStyle.strokeWidth/2+se.CircleRadiusExtra).style("opacity",0);t.selectionCircles.push(P)}for(;t.selectionCircles.length>A;)t.selectionCircles.pop().remove();var L,M,V,i=t.mainGraphicsContext.selectAll(se.CategorySelector.selector),p=(i.select(se.PathElementName).classed(e.lineClassAndSelector.class,!0).style("stroke",function(e){return e.color}).style("stroke-opacity",function(e){return ie.ColumnUtil.getFillOpacity(e.selected,!1,b,b)}).style("stroke-width",u.lineStyle.strokeWidth).style("stroke-linejoin",u.lineStyle.lineJoin).transition().ease(d3.easeLinear).duration(S).attr("d",function(e){return D(e.data)}),n.ensureMarkers(t.svgDefs,_.map(e.data.series,function(e){return e.lineStyle.markerProperties})),t.mainGraphicsContext.selectAll(se.MarkerLineClassSelector.selector).data(_.filter(u.series,function(e){return e.lineStyle.markerProperties.showMarker}),function(e){return e.identity.getKey()})),g=p.enter().append(se.PathElementName).classed(se.MarkerLineClassSelector.class,!0).style("stroke","#ffffff").style("stroke-width",ie.CartesianHelper.defaultLineStrokeWidth).style("stroke-opacity",0).merge(p).transition().ease(d3.easeLinear).duration(S).attr("d",function(e){return D(e.data)}).style("opacity",function(e){return ie.ColumnUtil.getFillOpacity(e.selected,!1,b,!1)}).style("pointer-events","none"),T=(n.renderMarkers(g),p.exit().remove(),this),h=i.selectAll(se.CategoryValuePoint.selector),n=h.style("fill",function(){return d3.select(this.parentNode).datum().color}).style("fill-opacity",function(){var e=d3.select(this.parentNode).datum();return ie.ColumnUtil.getFillOpacity(e.selected,!1,b,!1)}).transition().duration(S).attrs({cx:function(e,t){var i=d3.select(this.parentNode).datum();return T.shouldDrawCircle(i,t)?y(T.getXValue(e,v)):0},cy:function(e,t){var i=d3.select(this.parentNode).datum();return T.shouldDrawCircle(i,t)?C(e):0},r:function(e,t){var i=d3.select(this.parentNode).datum();return T.shouldDrawCircle(i,t)?u.lineStyle.strokeWidth/2+se.CircleRadiusExtra:0}}),F=(s&&se.hasDataPoint(u.series)&&(L=h.size(),M=0,n.on("end",function(){++M===L&&r.selectColumn(ie.CartesianHelper.findMaxCategoryIndex(u.series),!0)})),null);if(u.dataLabelsSettings.show)for(var F=[],I=0,k=u.series.length;I<k;I++)Array.prototype.push.apply(F,u.series[I].data);return x.exit().remove(),u.dataLabelsSettings.show&&(V=se.createLabelDataPoints(e,l)),null==F?null:{dataPoints:F,behaviorOptions:null,labelDataPoints:null,labelsAreNumeric:null,labelDataPointGroups:V,animateLabels:!o}}},se.getLeftmostPathPointFromSeriesData=function(e,a){return(a?_.findLast:_.find)(e.data,function(e,t,i){i=a?i[t-1]:i[t+1];return null!=e&&null!=e.value&&null!=i&&null!=i.value})},se.getSeriesTooltipInfo=function(e,t){var i;if(!e)return null;var a=e.dataPoints;if(_.isEmpty(a))return null;var r="#000000",s=!_.isEmpty(a)&&a[0].seriesDisplayName,o=[],n=[],l=0,c=e.legendMarkerRendering,u=c!==ie.legendMarkerRendering.markerOnly&&c!==ie.legendMarkerRendering.markerCircleDefault,d=a[0].additionalTooltipItems;if(a.every(function(e){return _.isEqual(e.additionalTooltipItems,d)})){for(var h in a){var p,g=a[h];if(10<=l)break;null!=g.value&&(p=g.measure,null!=(i=g.uncertaintyTooltipItems)&&i.rangeTooltip&&(p=g.uncertaintyTooltipItems.rangeTooltip.value),o.push({header:g.category,subheader:g.multiple,color:g.color,displayName:g.seriesName||g.measureDisplayName,value:p,markerShape:g.markerShape,lineStyle:u?g.lineStyle:void 0,lineColor:g.lineColor}),n.push(+h),l++)}if(e.hasUncertainty&&(o=se.augmentTooltipInfoWithUncertainty(o,a,n,t)),!_.isEmpty(d))for(var y=0,m=d;y<m.length;y++){var f=m[y];if(10<=l)break;o.push({color:r,displayName:f.displayName,value:f.value,opacity:"0",markerShape:ie.markerShape.none}),l++}}else for(var v=0,S=a;v<S.length;v++){g=S[v];if(10<=l)break;if(null!=g.value&&(s&&(o.push({header:g.category,subheader:g.multiple,displayName:g.seriesDisplayName,value:g.seriesName,markerShape:g.markerShape,lineStyle:u?g.lineStyle:void 0,lineColor:g.lineColor}),l++),o.push({header:g.category,subheader:g.multiple,color:g.color,displayName:g.measureDisplayName,value:g.measure,markerShape:g.markerShape,lineStyle:u?g.lineStyle:void 0,lineColor:g.lineColor}),l++,!_.isEmpty(g.additionalTooltipItems)))for(var x=0,b=g.additionalTooltipItems;x<b.length;x++){f=b[x];if(10<=l)break;o.push({header:g.category,subheader:g.multiple,color:r,displayName:f.displayName,value:f.value,opacity:"0",markerShape:ie.markerShape.none}),l++}}if(!_.isEmpty(e.additionalTooltipItems))for(var C=0,w=e.additionalTooltipItems;C<w.length;C++){f=w[C];if(10<=l)break;o.push({header:a[0].category,subheader:a[0].multiple,color:r,displayName:f.displayName,value:f.value,opacity:"0",markerShape:ie.markerShape.none}),l++}return 0===o.length?null:o},se.augmentTooltipInfoWithUncertainty=function(e,t,i,a){e.length,i.length;for(var r,s=[],o=1/0,n=-1,l=0,c=i.length;l<c;l++)(h=t[i[l]]).uncertaintyTooltipItems&&(h.isY2?(r=Math.abs(h.value-a.y2.point))<a.y2.threshold?s.push(l):r<o&&(o=r,n=l):((r=Math.abs(h.value-a.y.point))<a.y.threshold&&s.push(l),r<o&&(o=r,n=l)));for(var u=[],l=0,c=i.length;l<c;l++){var d,h=t[i[l]],p=e[l];_.includes(s,l)||n===l?((d=h.uncertaintyTooltipItems).upperTooltip&&u.push(__assign({header:h.category,subheader:h.multiple},d.upperTooltip)),u.push(p),d.lowerTooltip&&u.push(d.lowerTooltip)):u.push(p)}return u},se.prototype.getTooltipInfoForPoint=function(e,t){var i,a=e.data,r=this.getCategoryIndexFromSeriesAndPointX(a,t,!0,e.context);if(i=a&&a.data&&a.data.length?_.find(a.data,function(e){return e&&e.categoryIndex===r}):i)return i.tooltipInfo},se.isDataPointData=function(e){return e&&null!=e.categoryIndex},se.isForecastPoint=function(e){return e&&null!=e.points},se.prototype.getCategoryIndexFromTooltipEvent=function(e,t){e=e.data;if(!se.isForecastPoint(e))return se.isDataPointData(e)?e.categoryIndex:this.getCategoryIndexFromSeriesAndPointX(e,t,!1)},se.prototype.getCategoryIndexFromSeriesAndPointX=function(e,t,i,a){var r=0,s=this.data.categoryData,o=this.xAxisProperties.scale;return e&&!_.isEmpty(e.data)&&this.xAxisProperties&&(t=this.adjustPathXCoordinate(t,a),a=this.data.isScalar&&o.range()[1]<o.range()[0],(a=se.getLeftmostPathPointFromSeriesData(e,a))&&(r=o(se.getXValue(a,this.data.isScalar))+this.getXOfFirstCategory()),i&&(s=_.map(e.data,function(e){return ie.CartesianHelper.extractCategoryFromDataPoint(e)}))),se.findCategoryIndex({pointX:t,offsetX:r,categoryData:s,currentViewport:this.currentViewport,scaleDetector:this.scaleDetector,scale:o,categoryThickness:this.xAxisProperties.categoryThickness,isScalar:this.data.isScalar},this.featureSwitches)},se.prototype.getYValueFromTooltipEvent=function(e,t){var i,a=null==(a=this.yAxisProperties)?void 0:a.scale,r=null==(r=this.y2AxisProperties)?void 0:r.scale,s=this.currentViewport.scale,s=(N.Double.equalWithPrecision(s,1,1e-5)||(e/=s),t.classList.contains(se.TooltipOverlaySelector.class)||t.classList.contains(se.lineChartSVGClassName)||(e+=t.getBBox().y),{});return a&&(i=a.domain(),s.y={point:a.invert(e),threshold:.1*(i[1]-i[0])}),r&&(i=r.domain(),s.y2={point:r.invert(e),threshold:.1*(i[1]-i[0])}),s},se.prototype.getVisualCategoryAxisIsScalar=function(){return!!this.data&&this.data.isScalar},se.prototype.getSupportedCategoryAxisType=function(){var t,e=!1,i=this.dataView&&this.dataView.categorical?this.dataView.categorical.categories:void 0;return(e=_.isEmpty(i)?e:i.some(function(e){if(e.source&&e.source.type)return t=e.source.type,e=ie.ScalarUtils.getScalarKeys(e),!C.isOrdinal(t)||e&&!_.isEmpty(e.values)}))?ie.axisType.both:ie.axisType.categorical},se.prototype.getPreferredPlotArea=function(e,t,i,a){return ie.CartesianChartLayout.getPreferredPlotArea(t,i,this.currentViewport,this.isScrollable,e,this.margin,a=void 0===a?0:a)},se.prototype.getAvailableWidth=function(){var e=this.currentViewport.width-(this.margin.left+this.margin.right);return Math.max(0,e)},se.prototype.getAvailableHeight=function(){var e=this.currentViewport.height-(this.margin.top+this.margin.bottom);return Math.max(0,e)},se.sliceSeries=function(e,t,i){void 0===i&&(i=0);var a=[];if(e&&0<e.length)for(var r=0,s=e.length;r<s;r++){for(var o=e[r],n=(a[r]=N.Prototype.inherit(o),[]),l=i,c=i+t;l<c;l++)n.push(o.data[l]);a[r].data=n}return a},se.prototype.getXOfFirstCategory=function(){if(!this.data.isScalar){var e=this.xAxisProperties.scale;if(ie.D3Helper.isScaleBand(e))return e.bandwidth()/2}return 0},se.hasDataPoint=function(e){if(0!==e.length)for(var t=0,i=e.length;t<i;t++)if(0<e[t].data.length)return!0;return!1},se.getXValue=function(e,t){return t?e.categoryValue:e.categoryIndex},se.shouldDrawCircle=function(e,t){var i=e.data[t];if(null==i||null===i.value)return!1;i=e.data[t-1],i=null==i||null===i.value,e=e.data[t+1],t=null==e||null===e.value;return i&&t},se.prototype.getHoverLineDataForCategory=function(e){var t,i=this.getChartX(e)+this.getXOfFirstCategory(),e=this.createTooltipData(e);if(e)return t=e.dataPoints,0<e.dataPoints.length&&this.setHoverLineForTooltip(i),this.setDotsForTooltip(i,t,this.data.lineStyle.strokeWidth/2+se.TooltipCircleRadiusExtra),e},se.prototype.getHoverLineIdentities=function(t,e){var i,a=null==(a=null==(a=this.data)?void 0:a.categoryIdentities)?void 0:a[t],r=null==(r=null==(r=this.data)?void 0:r.multiplesCategoryIdentities)?void 0:r[t],s=[],e=_.find(null!=e?e:[],function(e){return(null==e?void 0:e.categoryIndex)===t}),e=null==e?void 0:e.identity;return e&&(r.exclude=((i={})[1]=!0,i),a.exclude=((i={})[1]=!0,i),e.exclude=((i={})[0]=!0,i),s.push(e)),(r||a)&&s.push(null!=r?r:a),s},se.prototype.setHoverLineForTooltip=function(e){this.hoverLine.attr("x1",e=e||0).attr("x2",e).attr("y1",0).attr("y2",this.getAvailableHeight()).style("opacity",1)},se.prototype.clearHoverLine=function(){this.hoverLine.style("opacity",ie.SVGUtil.AlmostZero),this.hoverLineContext.selectAll(se.HoverLineCircleDot.selector).remove()},se.prototype.setDotsForTooltip=function(e,t,i){var a=this;void 0===i&&(i=3);var r=re.hasFlag(this.lineType,16)?function(e){return a.yAxisProperties.scale(e.stackedValue)}:function(e){return(e.isY2?a.y2AxisProperties:a.yAxisProperties).scale(e.value)},t=this.hoverLineContext.selectAll(se.HoverLineCircleDot.selector).data(_.filter(t,function(e){return e.showDot}));t.enter().append(se.CircleElementName).classed(se.HoverLineCircleDot.class,!0).merge(t).filter(function(e){return null!=e.value}).attr("fill",function(e){return e.color}).attr("r",i).attr("cx",e).attr("cy",r),t.exit().remove()},se.prototype.selectColumn=function(e,t){!(t=void 0!==t&&t)&&this.lastInteractiveSelectedColumnIndex===e||(this.lastInteractiveSelectedColumnIndex=e,t=this.getChartX(e),this.setHoverLine(t,e),(t=this.createLegendDataPoints(e))&&this.cartesianHost.updateLegend(t))},se.prototype.setHoverLine=function(r,s){this.hoverLine.attr("x1",r).attr("x2",r).attr("y1",0).attr("y2",this.getAvailableHeight()).style("opacity",1);var o=this;this.mainGraphicsContext.selectAll(se.CategorySelector.selector).selectAll(se.PathElementName).each(function(e){var t=this,i=e.color,a=o.selectionCircles[e.lineIndex];a&&a.attrs({cx:r,cy:function(){var e=d3.select(t).node();return o.getPosition(r,e).y}}).styles({opacity:function(){return _.some(e.data,function(e){return!!e&&e.categoryIndex===s})?1:0},fill:i}),o.dragHandle&&o.dragHandle.attr("cx",r)})},se.prototype.getChartX=function(e){var t=0,e=(this.data.isScalar?0<=e&&e<this.data.categoryData.length&&(t=Math.max(0,this.xAxisProperties.scale(this.data.categoryData[e].categoryValue))):t=Math.max(0,this.xAxisProperties.scale(e)),Math.max.apply(Math,N.visuals.AxisHelper.extent(this.xAxisProperties.scale))),t=Math.min(t,e);return isNaN(t)?0:t},se.findCategoryIndex=function(e,t){var i=e.pointX,a=e.offsetX,r=e.categoryData,s=e.scale,t=t.removeScaleDetector?e.currentViewport.scale:e.scaleDetector.getScale().x,t=(N.Double.equalWithPrecision(t,1,1e-5)||(i/=t),a&&(i+=a),N.visuals.AxisHelper.invertScale(s,i,0,0,void 0).value);if(e.isScalar)return 0<=(a=C.findClosestXAxisIndex(t,r,s))?r[a].categoryIndex:-1;if(r[t]&&!r[t].hasData){for(var o=-1,n=t;0<n&&-1===o&&r[--n].hasData;)o=n;for(var l=-1,c=t,u=r.length-1;c<u&&-1===l&&r[++c].hasData;)l=c;var a=Math.abs(o-t),d=Math.abs(l-t);a<d?t=o:d<a?t=l:a===d&&(t=s(t)+e.categoryThickness/2<i?l:o)}return t},se.prototype.getPosition=function(e,t,i,a){for(var r,s,o=0,n=t.getTotalLength();r=t.getPointAtLength(s=o+n>>1),ie.SVGUtil.ensureValidSVGPoint(r),i&&(r.x=i(r.x)),a&&(r.y=a(r.y)),s!==n&&s!==o||r.x===e;)if(r.x>e)n=s;else{if(!(r.x<e))break;o=s}return r},se.prototype.findSubSelectedAreaIndex=function(e,t,i,a){for(var r,s=Number.MAX_VALUE,i=i.node().getBoundingClientRect(),o=i.left,n=i.top,l=0;l<t.length;l++){var c=t[l],c=this.getPosition(e.x,c,function(e){return se.convertSvgXToClientX(e,a.horizontalOffset,a.currentViewport.scale,o)},function(e){return se.convertSvgYToClientY(e,a.currentViewport.scale,n)}).y,c=e.y-c;-4<=c&&(c=Math.abs(c))<s&&(s=c,r=l)}return r},se.convertSvgXToClientX=function(e,t,i,a){return(e+t)*i+a},se.convertSvgYToClientY=function(e,t,i){return e*t+i},se.prototype.createTooltipData=function(e){var t=this.data;if(t&&0!==t.series.length&&t.categories&&t.categoryData){for(var i,a=[],r=(t.categoryData.length,t.categories.length,t.categoryData[e]),s=!1,o=t.multipleDisplayName,n=ie.lineChartProps.general.formatString,l=0,c=t.series;l<c.length;l++){var u,d,h=(g=c[l]).data,p=void 0;this.data.isScalar?r&&(p=h.filter(function(e){return e.categoryValue===r.categoryValue})[0]):p=h[e],null!=(f=p&&p.value)&&(h=ie.CategoryLevelUtils.concatenateCategoryLevels(r.hierarchyCategoryLevels),u=g.lineStyle.markerProperties,d=this.getDefaultMarkerShape(t.defaultToCircle),v={color:ie.Markers.resolveMarkerColor(u,g.color,t.legendMarkerRendering,t.matchLineColor),category:h.value,multiple:o,measureDisplayName:g.seriesName,measure:ie.valueFormatter.format(f,p.labelFormatString||ie.valueFormatter.getFormatString(g.yCol,n)),value:f,stackedValue:p.stackedValue,uncertaintyTooltipItems:p.uncertainty,showDot:!u.showMarker,markerShape:ie.Markers.resolveMarkerShape(u,t.legendMarkerRendering,d),lineStyle:g.lineStyle.style,lineColor:g.color,isY2:p.isY2},s=s||!!p.uncertainty,t.hasDynamicSeries?(v.seriesDisplayName=t.seriesDisplayName,v.seriesName=g.seriesName,v.additionalTooltipItems=p.additionalTooltipItems):i=i||p.additionalTooltipItems,a.push(v))}if(!_.isEmpty(t.forecastLines)&&r)for(var g=_.head(t.series),y=0,m=t.forecastLines;y<m.length;y++){var f,v,S=m[y],x=_(S.points).filter(function(e){return e.point.x===r.categoryValue}).first();null!=(f=x&&x.point.y)&&(v={color:S.lineColor.solid.color,category:ie.CategoryLevelUtils.concatenateCategoryLevels(r.hierarchyCategoryLevels).value,multiple:o,measureDisplayName:S.displayName,measure:ie.valueFormatter.format(f,ie.valueFormatter.getFormatString(g.yCol,n)),value:f,stackedValue:void 0,additionalTooltipItems:[{displayName:this.host.getLocalizedString("Visual_Confidence_Band_Upper"),value:ie.valueFormatter.format(x.upperBound.y,ie.valueFormatter.getFormatString(g.yCol,n))},{displayName:this.host.getLocalizedString("Visual_Confidence_Band_Lower"),value:ie.valueFormatter.format(x.lowerBound.y,ie.valueFormatter.getFormatString(g.yCol,n))}],showDot:!0,markerShape:ie.markerShape.circle,lineStyle:void 0,lineColor:void 0},a.push(v))}return{dataPoints:a,additionalTooltipItems:i,legendMarkerRendering:t.legendMarkerRendering,hasUncertainty:s}}},se.prototype.createLegendDataPoints=function(e){var t=this.data;if(t&&t.series&&!(t.series.length<1)){for(var i,a=[],r=t.categoryData[e],s=(this.isInteractiveChart&&r&&(this.data.isScalar?(i=r.categoryValue,C.isDateTime(this.xAxisProperties.axisType)&&(i=N.FeatureSwitchedDate.fromTimeValue(this.featureSwitches.utcDates,i))):i=ie.CartesianHelper.lookupXValue(this.data,e,this.xAxisProperties.axisType,this.data.isScalar,this.featureSwitches)),ie.lineChartProps.general.formatString),o=0,n=t.series.length;o<n;o++){var l=t.series[o],c=l.data,u=void 0;if(this.isInteractiveChart){var d=void 0;if(this.data.isScalar){if(r)for(var h=r.categoryValue,p=0,g=c;p<g.length;p++){var y=g[p];if(y.categoryValue===h){d=y;break}}}else d=c[e];u=d&&d.value}c=ie.converterHelper.getFormattedLegendLabel(l.yCol,this.dataView.categorical.values,s);a.push({color:l.color,icon:ie.LegendIcon.Line,label:c,category:ie.valueFormatter.format(i,ie.valueFormatter.getFormatString(l.xCol,s)),measure:ie.valueFormatter.format(u,ie.valueFormatter.getFormatString(l.yCol,s)),identity:l.identity,selected:l.selected,index:o})}var m=this.dataView&&this.dataView.categorical?this.dataView.categorical.values:null,m=m&&m.source?m.source.displayName:"",f=ie.Legend.getDefaultLegendData(this.style);return f.title=m,f.dataPoints=a,f.grouped=t.hasDynamicSeries,f}},se.createLabelDataPoints=function(m,f){for(var v,S,x=m.xAxisProperties.scale,b=m.yAxisProperties.scale,C=m.y2AxisProperties&&m.y2AxisProperties.scale,e=m.data,c=e.series,u=e.dataLabelsSettings,w=ie.DataLabelViewModel.createColumnFormatterCacheManager(),D=re.hasFlag(m.lineType,16),d=[],A=e.isScalar,t=function(e,t){S=c[e];var g=100===(v=S.labelSettings||u).labelDensity,i=ie.DataLabelRenderer.getNumberOfLabelsToRender(m.currentViewport.width,v.labelDensity,h.minimumLabelsToRender,ie.MinMaxLabelDataPointSorter.estimatedLabelWidth),i=!g&&A?i:S.data.length;if(!v.show)return d[e]={labelDataPoints:[],maxNumberOfLabels:0},"continue";var a=S.isY2?m.y2AxisProperties:m.yAxisProperties,y=ie.DataLabelRenderer.getLabelUnitAndPrecisionForAxis(a,v),r=S.data,s=[];if(!_.isEmpty(r))for(var o=0,n=r.length;o<n;o++){var l=r[o];null!=l&&null!=l.value&&(l=function(e,t,i){var a=t.labelFormatString,a=w.getOrCreate(a,v,y.units,y.getPrecision(!!a,e.type)),a=ie.DataLabelRenderer.getLabelFormattedText(a.format(t.value)),r=v.fontProperties,s=ie.FontProperties.toTextProperties(r,a),o=N.TextMeasurementService.measureSvgTextWidth(s)+ie.DataLabelViewModel.LabelDensityPadding,s=N.TextMeasurementService.estimateSvgTextHeight(s,!0),n=!1,l=m.horizontalOffset,c=e.isY2?C:b,u=null!=(u=t.labelFill)?u:r.color;if(D){var d=Math.max(t.stackedValue-t.value,c.domain()[0]),h=m.currentViewport.width,p=void 0;switch(v&&v.position){case ie.labelPosition.insideCenter:p=[1];break;case ie.labelPosition.insideEnd:p=[4];break;default:ie.labelPosition.auto;p=se.validStackedLabelPositions}h={rect:{left:x(se.getXValue(t,A))+l-h/2,top:c(Math.max(t.stackedValue,t.stackedValue-t.value)),width:h,height:Math.abs(c(t.stackedValue)-c(d))},orientation:0<=t.value?1:2,validPositions:p},n=!0}else{d=e.lineStyle.markerProperties,p=void 0;switch(v&&v.position){case ie.labelPosition.above:p=[1];break;case ie.labelPosition.under:p=[2];break;default:ie.labelPosition.auto;p=g?[1]:se.getValidLabelPositions(S,i)}h={point:{x:x(se.getXValue(t,A))+l,y:c(t.value)},radius:d.showMarker?d.size:0,validPositions:p}}return{isPreferred:!1,text:a,textSize:{width:o,height:s},outsideFill:null!=u?u:ie.ColorHelper.getThemeColor(f,ie.DataLabelViewModel.DefaultLabelColorName),insideFill:u&&D?u:ie.ColorHelper.getThemeColor(f,ie.DataLabelViewModel.DefaultInsideLabelColorName),parentType:n?1:0,parentShape:h,fontProperties:r,identity:t.identity,key:t.key,hasBackground:v.enableBackground,backgroundColor:v.backgroundColor,backgroundTransparency:v.backgroundTransparency}}(S,l,o),s.push(l))}d[e]={labelDataPoints:s,maxNumberOfLabels:i}},h=this,i=0,a=c.length;i<a;i++)t(i);return new ie.MinMaxLabelDataPointSorter({unsortedLabelDataPointGroups:d,series:c,viewport:m.currentViewport,yScale:b,y2Scale:C}).getSortedDataLabels()},se.createSeriesLabelDataPoints=function(e,v,S,x){for(var b,C,t=e.xAxisProperties.scale,w=e.yAxisProperties.scale,D=e.y2AxisProperties&&e.y2AxisProperties.scale,i=e.data,A=i.series,P=i.seriesLabelSetings,a=e.margin,L=e.currentViewport,M=re.hasFlag(e.lineType,16),V=[],T=i.isScalar,F=N.TextMeasurementService.estimateSvgTextHeight(ie.DataLabelRenderer.LabelTextProperties),I=L.width-(a.left+a.right),k=t.domain()[0],O=t.domain()[1],r=function(e,t){var l=(C=A[e]).isY2?D:w,i=l.domain()[0],a=l.domain()[1];if(!(b=C.seriesSettings||P)||!b.show)return V[e]={labelDataPoints:[],maxNumberOfLabels:0},"continue";function r(e,t){var i=e.seriesName,a=b.fontProperties,r=ie.FontProperties.toTextProperties(a,i),s=N.TextMeasurementService.measureSvgTextWidth(r),o=N.TextMeasurementService.estimateSvgTextHeight(r,!0),e=e.lineStyle.markerProperties,n=[512],e=(t.value,{point:{x:S,y:l(M?t.stackedValue:t.value)},radius:e.showMarker?e.size:0,validPositions:n}),n=!1;return d&&(n=1<ie.DataLabelRenderer.checkWordBreak(i,r,u,L.height-(c+F+h),void 0,!0,!0).length),{isPreferred:!1,text:i,textSize:{width:s,height:o},outsideFill:b.seriesColor||ie.ColorHelper.getThemeColor(v,ie.DataLabelViewModel.DefaultLabelColorName),insideFill:b.seriesColor&&M?b.seriesColor:ie.ColorHelper.getThemeColor(v,ie.DataLabelViewModel.DefaultInsideLabelColorName),parentType:0,parentShape:e,fontProperties:a,identity:t.identity,key:t.key,wordBreak:n,hasBackground:b.enableBackground,backgroundColor:b.backgroundColor,backgroundTransparency:b.backgroundTransparency}}var c=b?b.fontProperties.size.px:0,u=b?b.seriesMaximumWidth/100*I:0,d=!!b&&!!b.seriesWordWrap,h=(L.height-F-c)/2,s=C.data,o=[],n=0,p=s.length;if(!_.isEmpty(s)&&C.seriesName){var g=x?_.last(_.compact(s)):_.first(_.compact(s));if(T){for(n=0;n<p;n++){var y=s[n];if(null!=y&&null!=y.value&&y){y=se.getXValue(y,T);if(x?O<y:k<y){var m,f,y=-1;x&&0<=n-1?y=n-1:x||(y=n),0<=y&&(null!=(y=s[y])&&(i<=(m=M?y.stackedValue:y.value)&&m<=a)&&(f=r(C,y),o.push(f)));break}}}g&&n===s.length&&null!=(m=M?g.stackedValue:g.value)&&(i<=m&&m<=a)&&(f=r(C,g),o.push(f))}else g&&null!=(m=M?g.stackedValue:g.value)&&(i<=m&&m<=a)&&(f=r(C,g),o.push(f))}V[e]={labelDataPoints:o,maxNumberOfLabels:1}},s=0,o=A.length;s<o;s++)r(s);return V},se.createTotalLabelDataPoints=function(e,t){for(var i,a,r,s,o,n,l,c=ie.CartesianHelper.getFirstMetadataColumn(e.data.valuesMetadata),u=ie.valueFormatter.getFormatString(c,ie.columnChartProps.general.formatString),d=e.xAxisProperties.scale,h=e.yAxisProperties.scale,p=e.data,g=ie.DataLabelViewModel.createColumnFormatterCacheManager(),c=[],y=p.totalLabelsSettings,m=p.isScalar,f=e.horizontalOffset,v=e.yAxisProperties,S=ie.DataLabelRenderer.getLabelUnitAndPrecisionForAxis(v,y),x=[],b=0;b<p.totals.length;b++){var C,w=p.totals[b];!w||0!==(w=w.net)&&(w=w,i=b,l=C=n=s=o=s=r=a=void 0,i=p.totals[i],a=g.getOrCreate(i.dynamicFormatString||u,y,S.units,y.precision),a=ie.DataLabelRenderer.getLabelFormattedText(a.format(w)),r=y.fontProperties,s=ie.FontProperties.toTextProperties(r,a),o=N.TextMeasurementService.measureSvgTextWidth(s),s=N.TextMeasurementService.estimateSvgTextHeight(s,!0),n=null!=(n=i.labelFill)?n:r.color,C=0<w?i.positive:i.negative,i={value:C,stackedValue:C,categoryIndex:i.categoryIndex,categoryValue:i.categoryValue,labelSettings:void 0,key:void 0,identity:void 0,lineStyle:void 0,seriesIndex:void 0,selected:!1},l=e.currentViewport.width,C={isPreferred:!(i={left:d(se.getXValue(i,m))+f-l/2,top:h(C),width:l,height:0}),text:a,textSize:{width:o,height:s},outsideFill:null!=n?n:ie.ColorHelper.getThemeColor(t,ie.DataLabelViewModel.DefaultLabelColorName),insideFill:null!=n?n:ie.ColorHelper.getThemeColor(t,ie.DataLabelViewModel.DefaultInsideLabelColorName),parentType:1,parentShape:{rect:i,orientation:0<=w?1:2,validPositions:[16]},identity:void 0,fontProperties:r,hasBackground:y.enableBackground,backgroundColor:y.backgroundColor,backgroundTransparency:y.backgroundTransparency},x.push(C))}return c.push({labelDataPoints:x,maxNumberOfLabels:2*p.totals.length}),c},se.createUncertaintyLabels=function(n,p,g){for(var y,m,e=n.data,l=e.series,f=ie.DataLabelViewModel.createColumnFormatterCacheManager(),v=n.xAxisProperties.scale,S=e.isScalar,x=n.horizontalOffset,c=[],t=function(e,t){var i=(y=l[e]).uncertainty;if(!i||!i.renderUncertainty||!i.labels.show)return c[e]={labelDataPoints:[],maxNumberOfLabels:0},"continue";m=i.labels;for(var i=y.isY2?n.y2AxisProperties:n.yAxisProperties,u=ie.DataLabelRenderer.getLabelUnitAndPrecisionForAxis(i,m),d=i.scale,h=m.fontProperties,a=[],r=0,s=y.data;r<s.length;r++){var o=s[r];null!=o&&null!=o.value&&null!=o.uncertainty&&(o=function(e){for(var t=[],i=ie.UncertaintyHelper.formatUncertaintyByErrorFormat(e.value,e.uncertainty,m.errorFormat),a=[i.lower,i.upper],r=0;r<2;r++){var s,o,n=a[r],l=1===r,c=l?e.uncertainty.upper:e.uncertainty.lower;null!=c&&(s=void 0,s=m.errorFormat===ie.errorFormat.relativePercentage?ie.UncertaintyHelper.formatUncertaintyRelativePercentage(n,g):(o=e.labelFormatString,o=f.getOrCreate(o,m,u.units,u.getPrecision(!!o,y.type)),ie.DataLabelRenderer.getLabelFormattedText(o.format(n))),o=ie.FontProperties.toTextProperties(h,s),n={isPreferred:!1,text:s,textSize:{width:N.TextMeasurementService.measureSvgTextWidth(o)+ie.DataLabelViewModel.LabelDensityPadding,height:N.TextMeasurementService.estimateSvgTextHeight(o,!0)},outsideFill:h.color||ie.ColorHelper.getThemeColor(p,ie.DataLabelViewModel.DefaultLabelColorName),insideFill:h.color||ie.ColorHelper.getThemeColor(p,ie.DataLabelViewModel.DefaultInsideLabelColorName),parentType:0,parentShape:{point:{x:v(se.getXValue(e,S))+x,y:d(c)},radius:0,validPositions:[l?1:2]},identity:void 0,fontProperties:h,hasBackground:m.enableBackground,backgroundColor:m.backgroundColor,backgroundTransparency:m.backgroundTransparency},t.push(n))}return t}(o),_.isEmpty(o)||a.push.apply(a,o))}c[e]={labelDataPoints:a,maxNumberOfLabels:100}},i=0,a=l.length;i<a;i++)t(i);return c},se.prototype.axisShouldIncludeZero=function(){var e;return null!=(null==(e=null==(e=null==(e=null==(e=this.dataView)?void 0:e.metadata)?void 0:e.objects)?void 0:e.categoryAxis)?void 0:e.reverseStackOrder)&&this.isStacked()},se.prototype.adjustPathXCoordinate=function(e,t){return jsCommon.BrowserUtils.isFirefox()&&null!=t&&(this.pathXAdjustment=this.getPathXAdjustmentForFirefox(t)),jsCommon.BrowserUtils.isInternetExplorerOrEdge()&&(this.pathXAdjustment=se.interactivityStrokeWidth/2),t=this.featureSwitches.removeScaleDetector?this.currentViewport.scale:this.scaleDetector.getScale().x,N.Double.equalWithPrecision(t,1,1e-5)?e-=this.pathXAdjustment:e-=this.pathXAdjustment*t,e},se.prototype.getPathXAdjustmentForFirefox=function(e){var t,i=e.getBoundingClientRect(),e=ie.SVGUtil.tryGetBBox(e);if(0<e.height&&0<e.width)return t=this.featureSwitches.removeScaleDetector?this.currentViewport.scale:this.scaleDetector.getScale().x,(i.width/t-e.width)/2},se.getValidLabelPositions=function(e,t){var e=e.data,i=e.length,a=e[t].value,r=e[t-1]&&e[t-1].value,e=e[t+1]&&e[t+1].value,s=1,o=1;if(null==r?s=0:a<r?s=3:r<a&&(s=2),null===e?o=0:a<e?o=3:e<a&&(o=2),0===t)return 3!==o?[1,2]:[2,1];if(t===i-1)return 3!==s?[1,2]:[2,1];switch(s){case 0:switch(o){case 0:return[1,2,8,4];case 1:return[1,2,4,8];case 3:return[2,1,4,8];case 2:return[1,2,4,8]}case 1:switch(o){case 0:case 1:return[1,2,8,4];case 3:return[2,1,8,4];case 2:return[1,2,8,4]}case 3:switch(o){case 0:return[2,1,8,4];case 1:return[2,1,4,8];case 3:return[2,1,8,4];case 2:return[1,2,8,4]}case 2:switch(o){case 0:return[1,2,8,4];case 1:return[1,2,4,8];case 3:case 2:return[1,2,8,4]}}},se.prototype.getCartesianVisualCapabilities=function(){var e=this.data,t=e&&!e.hasDynamicSeries&&this.hasSingleSeriesPerValueAxis(e),t=!re.hasFlag(this.lineType,16)||t;return{supportsHierarchicalCategoryAxis:!0,axesCapabilities:{categoryAxis:{domainAggregateRole:ie.LineChartRoles.Category,supportedDomainAggregates:e&&e.isScalar?e.scalarKeyCount?1:3:0},valueAxis:{domainAggregateRole:ie.LineChartRoles.Y,supportedDomainAggregates:t?3:1},secondaryValueAxis:this.haveY2Data()||this.isComboChart?{domainAggregateRole:ie.LineChartRoles.Y2,supportedDomainAggregates:t?3:1}:void 0}}},se.prototype.hasSingleSeriesPerValueAxis=function(e){if(!e||_.isEmpty(e.valuesMetadata))return!1;for(var t=!1,i=!1,a=0,r=e.valuesMetadata;a<r.length;a++){var s,o=r[a].roles;for(s in o)if(o[s]){if(s===ie.LineChartRoles.Y){if(t)return!1;t=!0}if(s===ie.LineChartRoles.Y2){if(i)return!1;i=!0}}}return!0},se.prototype.getStaticSeriesRole=function(){return this.isComboChart?ie.LineChartRoles.Y2:ie.LineChartRoles.Y},se.prototype.haveY2Data=function(){return this.data&&this.data.series&&_.some(this.data.series,function(e){return e&&e.isY2})},se.prototype.calculateCustomLegend=function(){if(!this.dataView)return ie.Legend.getDefaultLegendData(this.style);var e=this.data,t=this.getDefaultMarkerShape(e.defaultToCircle);return ie.Legend.buildSeriesLegendData({dataView:this.dataView,allowLegendWithNoSeries:this.isComboChart,showByDefault:!0,staticSeriesRoleNames:this.isComboChart?["Y2"]:["Y","Y2"],style:this.style,ignoreDefaultColor:this.isComboChart,ignoreDefaultCategoryColor:!0,lineAndMarkerOptions:{renderLineStyle:!0,legendMarkerRendering:e.legendMarkerRendering,matchSeriesColor:e.matchLineColor,defaultMarkerShape:t},featureSwitches:this.featureSwitches})},se.prototype.enumerateCustomLegend=function(e){e=__assign(__assign({},this.customizeLegendFormattingModelOptions(e)),{enumeration:e.enumeration});ie.Legend.enumerate(e,this.featureSwitches)},se.prototype.customizeLegendFormattingModelOptions=function(e){var t=this.originalData,i=t.legendMarkerRendering,a=this.featureSwitches.removeDefaultToCircleToggle&&i===ie.legendMarkerRendering.markerCircleDefault;return __assign(__assign({},e),{legendMarkerRendering:i,matchLineColor:i===ie.legendMarkerRendering.markerOnly||a?t.matchLineColor:void 0,defaultToCircle:i===ie.legendMarkerRendering.markerOnly?t.defaultToCircle:void 0})},se.prototype.addWarnings=function(e){this.viewModelAdapter&&this.viewModelAdapter.addWarnings(e)},se.chartTypeSupportsExplicitDots=function(e){return!e},se.prototype.getTelemetryInformation=function(){var e,t={};if(_.isEmpty(null==(e=this.data)?void 0:e.anomalyDetections)||(t.AnomalyDetections=!0),!_.isEmpty(t))return t},se.prototype.getDefaultMarkerShape=function(e){return!this.featureSwitches.removeDefaultToCircleToggle&&e?ie.markerShape.circle:ie.markerShape.longDash},se.prototype.getValidDataPointIndices=function(a){for(var r=[],e=0,t=a.categoryData;e<t.length;e++)!function(t){if(t&&a.categoryIdentities[t.categoryIndex])for(var e=0;e<a.series.length;e++){var i=_.findIndex(a.series[e].data,function(e){return e.categoryIndex===t.categoryIndex});if(0<=i){r.push({categoryIndex:t.categoryIndex,seriesIndex:e,dataPointIndex:i});break}}}(t[e]);return r},se.prototype.getCategoryColorsOptions=function(i,e,t,a){var r=e.map(function(e){return ie.CategoryLevelUtils.concatenateCategoryLevels(i.categoryData[e.categoryIndex].hierarchyCategoryLevels).value});return{colorProps:{showAllDataPoints:ie.lineChartObjectProps.dataPoint.showAllDataPoints,fill:ie.lineChartObjectProps.dataPoint.fill},featureSwitches:this.featureSwitches,groupBuilder:t,hostService:this.host,options:{dataView:this.dataView,style:this.style,categories:_.map(e,function(e,t){return{color:i.series[e.seriesIndex].data[e.dataPointIndex].pointColor,displayName:r[t],identity:i.categoryIdentities[e.categoryIndex]}}),fillInstanceKind:i.hasDynamicSeries?1:3,noDefaultFillColor:a,multipleRole:i.multipleIdentity?ie.LineChartRoles.Rows:void 0}}},se.prototype.onDataViewObjectChanged=function(e){if(!this.featureSwitches.onObject)return e;var t={objectName:"seriesLabels",propertyName:"show"},i=[a.createTopLevelToggleTurnOffAction(a.DataViewObjectChangeType.Add,ie.lineChartProps.lineStyles.showMarker,function(){return[{objectName:"lineStyles",propertyName:"revertToDefault",propertyValue:void 0,propertyType:{bool:!0}}]}),a.createSeriesLevelToggleTurnOnAction(a.DataViewObjectChangeType.Add,ie.lineChartProps.lineStyles.showMarker,this.data.lineStyle.markerProperties.showMarker,function(){return[__assign(__assign({},ie.lineChartProps.lineStyles.showMarkerByDefault),{propertyValue:!1,propertyType:{bool:!0}}),__assign(__assign({},ie.lineChartProps.lineStyles.showMarker),{propertyValue:!0,propertyType:{bool:!0}})]}),a.createTopLevelToggleTurnOffAction(a.DataViewObjectChangeType.Add,t,function(){return[{objectName:"seriesLabels",propertyName:"revertToDefault",propertyValue:void 0,propertyType:{bool:!0}}]}),a.createSeriesLevelToggleTurnOnAction(a.DataViewObjectChangeType.Add,t,this.data.seriesLabelSetings.show,function(){return[__assign(__assign({},ie.lineChartProps.seriesLabels.showByDefault),{propertyValue:!1,propertyType:{bool:!0}}),__assign(__assign({},t),{propertyValue:!0,propertyType:{bool:!0}})]})];return a.changeDataViewObjectsBehavior(e,i)},se.ClassName="lineChart",se.MainGraphicsContextClassName="mainGraphicsContext",se.lineChartSVGClassName="lineChartSVG",se.CategorySelector=e("cat"),se.CategoryValuePoint=e("dot"),se.CategoryPointSelector=e("point"),se.CategoryAreaSelector=e("catArea"),se.HoverLineCircleDot=e("circle-item"),se.UncertaintySelector=e("uncertainty"),se.UncertaintyAreas=e("uncertainty-areas"),se.UncertaintyArea=e("uncertainty-area"),se.UncertaintyLines=e("uncertainty-lines"),se.UncertaintyLine=e("uncertainty-line"),se.UncertaintyBars=e("uncertainty-bars"),se.UncertaintyBar=e("uncertainty-bar"),se.UncertaintyMarkers=e("uncertainty-markers"),se.UncertaintyMarker=e("uncertainty-marker"),se.LineClassSelector=e("line"),se.MarkerLineClassSelector=e("marker-line"),se.InteractivityLineClassSelector=e("interactivity-line"),se.TooltipOverlaySelector=e("tooltip-overlay"),se.SelectedMarkerLineClassSelector=e("selected-markers"),se.FocusElementSelector=e("focus-element"),se.PositionRectSelector=e("position-rect"),se.RenderOrderableElements=[se.CategoryAreaSelector,se.UncertaintySelector,se.LineClassSelector,se.MarkerLineClassSelector,se.InteractivityLineClassSelector,se.CategorySelector,se.SelectedMarkerLineClassSelector,se.FocusElementSelector],se.PointRadiusExtra=4,se.CircleRadiusExtra=3,se.TooltipCircleRadiusExtra=2,se.PathElementName="path",se.CircleElementName="circle",se.CircleClassName="selection-circle",se.LineElementName="line",se.ScalarOuterPadding=10,se.interactivityStrokeWidth=10,se.minimumLabelsToRender=4,se.DefaultAreaTransparency=60,se.AreaTransparencyReductionFactor=.4,se.defaultLineStrokeWidth=2,se.validStackedLabelPositions=[1,4],se);function se(e){var t=this;this.pathXAdjustment=0,this.deferDragMoveOperation=jsCommon.DeferUtility.deferUntilNextFrame(function(){var e;t.lastDragMoveXPosition&&t.data&&t.margin&&(e=se.findCategoryIndex({pointX:t.lastDragMoveXPosition-t.margin.left,offsetX:0,categoryData:t.data.categoryData,currentViewport:t.currentViewport,scaleDetector:t.scaleDetector,scale:t.xAxisProperties.scale,categoryThickness:t.xAxisProperties.categoryThickness,isScalar:t.data.isScalar},t.featureSwitches),t.selectColumn(e),t.lastDragMoveXPosition=void 0)}),this.isScrollable=e.isScrollable||!1,this.tooltipsEnabledOnHost=e.tooltipsEnabled,this.lineType=e.chartType||1,this.interactivityService=e.interactivityService,this.lineClassAndSelector=se.LineClassSelector,this.featureSwitches=e.featureSwitches,this.viewModelAdapterFactory=e.viewModelAdapterFactory,se.areaTransparencyEnabled=e.featureSwitches.areaChartTransparency}ie.LineChart=o,Object.defineProperty(l.prototype,"usingHoverLine",{get:function(){return this.showHoverLine},enumerable:!1,configurable:!0}),l.prototype.getTooltipOverlayElement=function(){return this.tooltipOverlay},l.prototype.applyTooltips=function(e,t,i){!this.tooltipOverlay||e.binnedLineSamplingApplied&&e.hasDynamicSeries?this.applyPointTooltip(e,t,i):(e.isComboChart,this.applyHoverLineTooltip(e,t,i))},l.prototype.removeTooltips=function(e,t){this.removePointTooltip(e),this.removeHoverLineTooltip(t)},l.prototype.applyHoverLineTooltip=function(e,a,r){this.tooltipOverlay,this.tooltipOverlay&&(this.showHoverLine||this.removePointTooltip(e),this.tooltipOverlay.attrs({x:0,width:e.width,height:e.height}),this.tooltipService.addTooltip(this.mainGraphicsSVG,function(e){var t,i=e.elementCoordinates[0],i=a.getCategoryIndexFromTooltipEvent(e,i),i=r.getHoverLineDataForCategory(i);return i&&i.hasUncertainty&&(t=e.elementCoordinates[1],t=a.getYValueFromTooltipEvent(t,e.context)),o.getSeriesTooltipInfo(i,t)},function(e){return l.getCategoryIdentityForHoverLineTooltipEvent(a,r,e)},!0),this.mainGraphicsSVG.on("mouseout.hoverline",function(){return r.clearHoverLine()}),this.mainGraphicsSVG.on("touchmove.hoverline",function(){return r.clearHoverLine()}),this.showHoverLine=!0)},l.prototype.removeHoverLineTooltip=function(e){e.clearHoverLine(),this.tooltipService.removeTooltips(this.mainGraphicsSVG),this.mainGraphicsSVG.on(".hoverline",null),this.showHoverLine=!1},l.prototype.applyPointTooltip=function(e,i,t){this.showHoverLine&&this.removeHoverLineTooltip(t);var a=e.isComboChart?function(e){return l.getCategoryIdentityForHoverLineTooltipEvent(i,t,e)}:function(e){return e.data&&[e.data.identity]};e.interactivityLines,this.tooltipService.addTooltip(e.interactivityLines,function(e){var t=e.elementCoordinates[0];return i.getTooltipInfoForPoint(e,t)},a,!0),e.dots,this.tooltipService.addTooltip(e.dots,function(e){return e.data&&e.data.tooltipInfo},a,!0),e.explicitDots&&this.tooltipService.addTooltip(e.explicitDots,function(e){return e.data&&e.data.tooltipInfo},function(e){return e.data&&[e.data.identity]},!0),this.showHoverLine=!1},l.prototype.removePointTooltip=function(e){e.interactivityLines&&this.tooltipService.removeTooltips(e.interactivityLines),e.dots&&this.tooltipService.removeTooltips(e.dots),e.explicitDots&&this.tooltipService.removeTooltips(e.explicitDots)},l.getCategoryIdentityForHoverLineTooltipEvent=function(e,t,i){if(i){if(i.data&&o.isForecastPoint(i.data))return null;var a=i.elementCoordinates[0],e=e.getCategoryIndexFromTooltipEvent(i,a);return t.getHoverLineIdentities(e,null==(a=i.data)?void 0:a.data)}};var n=l;function l(e,t,i){this.tooltipService=e,this.mainGraphicsSVG=t,i&&(this.tooltipOverlay=t.append("rect").classed(o.TooltipOverlaySelector.class,!0)),this.showHoverLine=!1}t.prototype.queryRegion=function(e){var t=this,i=[],a=e.dataSpace;return i=this.isScalar||this.hasCategories&&void 0!==a.left&&void 0!==a.right?_.filter(this.dataPoints,function(e){return N.Double.lessOrEqualWithPrecision(a.left.value,t.isScalar?e.categoryValue:e.categoryIndex)&&N.Double.lessOrEqualWithPrecision(t.isScalar?e.categoryValue:e.categoryIndex,a.right.value)&&N.Double.lessOrEqualWithPrecision(t.getBottom(a,e),e.value)&&N.Double.lessOrEqualWithPrecision(e.value,t.getTop(a,e))}):i},t.prototype.getBottom=function(e,t){return(t.isY2||this.isComboChart&&e.bottom2?e.bottom2:e.bottom).value},t.prototype.getTop=function(e,t){return(t.isY2||this.isComboChart&&e.top2?e.top2:e.top).value};var oe=t;function t(e){this.dataPoints=e.dataPoints,this.isComboChart=e.isComboChart,this.isScalar=e.isScalar,this.hasCategories=e.hasCategories}ie.LineChartHitTester=oe}(powerbi=powerbi||{}),function(e){!function(p){var g=jsCommon.BrowserUtils,n=jsCommon.DOMConstants.KeyDictionary,y=jsCommon.DOMConstants.mouseClickEventName;function e(){}e.prototype.create=function(){return new t},p.LineChartWebBehaviorFactory=e;m.prototype.bindEvents=function(n,l,e,t){function c(e){return a.getPointX(e)}var a=this,i=n.focusMarker,r=n.interactivityLines,s=n.root,o=n.showHoverline,u=n.tooltipOverlay,d=this.dots=n.dots,h=(this.areas=n.areas,n.onSelecting);this.anomalies=n.anomalies,this.areaTransparency=n.areaTransparency,this.anomalyNavigationHelper=n.anomalyNavigationHelper,this.selectedMarkersCallback=n.selectedMarkersCallback,this.hitTester=n.hitTester;t?(this.unbindEventsFormatMode(n),r.on(y,function(e){f(n,c(this),e,l.getSubSelectionHelper(),!1)}),r.on("contextmenu",function(e){f(n,c(this),e,l.getSubSelectionHelper(),!0)}),d.on(y,function(){var e=d3.select(this.parentNode).datum();v(n,e,l.getSubSelectionHelper(),!1)}),d.on("contextmenu",function(){var e=d3.select(this.parentNode).datum();v(n,e,l.getSubSelectionHelper(),!0)})):(r.on(y,function(e,t){var i,a,r,s;i=n,a=l,r=c(this),e=e,s=i.getCategoryIndex(e,r,!0),(r=_.find(e.data,function(e){return e&&e.categoryIndex===s}))?p.InteractivityUtils.handleSelection(r,a):(r={selected:e.selected,identity:e.identity,specificIdentity:i.categoryIdentities[s]},p.InteractivityUtils.handleSelection(r,a))}),r.on("contextmenu",function(e,t){var i,a,r,s,o;i=n,a=l,r=c(this),e=e,o=d3.event,g.isCtrlOrMeta(o)||(o.preventDefault(),p.EventBubblingUtil.markAsHandled(o),o=p.InteractivityUtils.getPositionOfLastInputEvent(),s=i.getCategoryIndex(e,r,!0),(r=_.find(e.data,function(e){return e&&e.categoryIndex===s}))?a.handleContextMenu(r,o):a.handleContextMenu({selected:e.selected,identity:e.identity,specificIdentity:i.categoryIdentities[s]},o))}),p.InteractivityUtils.registerStandardInteractivityHandlers(d,l),p.InteractivityUtils.registerClearCatcherShortcut(s,l),i&&(i.on(y,function(e){e=p.InteractivityUtils.isSelectableDataPointContainer(e)?e.data:e;p.InteractivityUtils.handleSelection(e,l)}),i.on("keydown.select",function(t){var e=d3.event,i=e.keyCode;32!==i&&13!==i||(m.isAnomaly(t)?(i=a.anomalies.filter(function(e){return e.isAnomaly&&e===t}),p.AnomalyDetectionCartesianRenderer.handleSelectedAnomaly(i.node(),t,h)):(i=p.InteractivityUtils.isSelectableDataPointContainer(t)?t.data:t,p.InteractivityUtils.handleSelection(i,l)),e.preventDefault(),e.stopPropagation())},!0),p.InteractivityUtils.registerStandardContextMenuHandler(i,l)),u&&o&&(u.style("pointer-events","all"),_.isEmpty(n.categoryIdentities)?u.on(y,function(){g.isCtrlOrMeta(d3.event)||l.handleClearSelection()}):(u.on(y,function(){var e=n.getCategoryIndex(void 0,c(this),!1),e={selected:!1,identity:void 0,specificIdentity:n.categoryIdentities[e]};p.InteractivityUtils.handleSelection(e,l)}),u.on("contextmenu",function(){var e,t=d3.event;g.isCtrlOrMeta(t)||(t.preventDefault(),p.EventBubblingUtil.markAsHandled(t),t=p.InteractivityUtils.getPositionOfLastInputEvent(),e=n.getCategoryIndex(void 0,c(this),!1),l.handleContextMenu({selected:!1,identity:void 0,specificIdentity:n.categoryIdentities[e]},t))})))),e&&(t=e.dataPointNavigationManager,r=e.pointSourceKey,t.isEmpty(r)||("0"!==s.attr("tabindex")&&!s.classed(p.managedTabIndexElement.class)||this.registerEnterPlotAreaHandler(s,t,r),i&&this.registerDataPointNavigationHandler(i,t,r)))},m.prototype.unbindEventsFormatMode=function(e){var t=e.dots,i=e.focusMarker,e=e.tooltipOverlay;i&&(i.on(y,null),i.on("keydown.select",null),p.InteractivityUtils.removeStandardContextMenuHandler(i)),e&&(e.style("pointer-events","none"),p.InteractivityUtils.removeStandardSelectionHandler(e)),p.InteractivityUtils.removeStandardInteractivityHandlers(t)},m.prototype.registerEnterPlotAreaHandler=function(a,r,s){var o=this;a.on("keydown.enterPlotArea",function(){var e,t=d3.event,i=t.keyCode;i===n.F1&&t.ctrlKey?(t.preventDefault(),t.stopPropagation(),(e=o.anomalyNavigationHelper.getFirstElement(0))&&o.renderFocus(e.element)):13===i?(t.preventDefault(),t.stopPropagation(),r.goToFirstElement(s)):27===i&&t.target!==a.node()&&(t.preventDefault(),t.stopPropagation(),e=a.node(),o.renderFocus(e))})},m.prototype.registerDataPointNavigationHandler=function(e,r,s){var o=this;e.on("keydown.dataPoint",function(e){var i=d3.event,a=i.keyCode;(9===a||37===a||39===a||38===a||40===a||a===n.F1&&g.isCtrlOrMeta(i))&&p.InteractivityUtils.tryToSelectD3Target(function(e){i.preventDefault(),i.stopPropagation();var t,e=p.InteractivityUtils.isNavigableDataPointContainer(e)?e.data:e;m.isAnomaly(e)?o.handleAnomalyKeyDownEvent(e.categoryIndex,e.seriesIndex,a,g.isCtrlOrMeta(i),r,s):a===n.F1&&g.isCtrlOrMeta(i)?(t=o.anomalyNavigationHelper.getFirstElement(e.categoryIndex))&&o.renderFocus(t.element):r.handleKeyDownEvent(s,e.categoryIndex,e.seriesIndex,a,i.shiftKey)},void 0)},!0)},m.isAnomaly=function(e){return e.isAnomaly},m.prototype.handleAnomalyKeyDownEvent=function(e,t,i,a,r,s){var o;switch(i){case 37:return o=this.anomalyNavigationHelper.getNextDataPoint(e,t,p.DataDirection.PreviousCategory),void this.renderFocus(o.element);case 39:return o=this.anomalyNavigationHelper.getNextDataPoint(e,t,p.DataDirection.NextCategory),void this.renderFocus(o.element);case n.F1:return void(a&&(0<e?r.handleKeyDownEvent(s,e-1,t,39,!1):r.goToFirstElement(s)));default:return}},m.prototype.renderSelection=function(t){var i=this;this.dots.style("fill-opacity",function(e){return e.lineStyle.markerProperties.showMarker?0:p.ColumnUtil.getFillOpacity(e.selected,!1,t,!1)}),this.areas&&this.areas.style("fill-opacity",function(e){return t&&!e.selected?p.LineChart.AreaTransparencyReductionFactor*(1-i.areaTransparency/100):1-i.areaTransparency/100}),this.selectedMarkersCallback&&this.selectedMarkersCallback(t)},m.prototype.renderFocus=function(e){e&&g.focus(e)},m.prototype.lassoSelectRectLayer=function(e){return this.hitTester.queryRegion(e)},m.prototype.getLassoSelectDirectionMode=function(){return 1},m.prototype.getPointX=function(e){for(var t,i=d3.event;t=i.sourceEvent;)i=t;var a=e.getBoundingClientRect();return i.clientX-a.left-e.clientLeft};var t=m;function m(){}function f(e,t,i,a,r){var s=d3.event;e.onLineSubSelection(i,t,a,s,r),p.EventBubblingUtil.markAsHandled(s)}function v(e,t,i,a){var r=d3.event;e.onDotSubSelection(t,i,r,a),p.EventBubblingUtil.markAsHandled(r)}p.LineChartWebBehavior=t}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(x){!function(v){var e=jsCommon.CssConstants.createClassAndSelector,n=x.data.createDataViewScopeIdentity,i=x.data.DataViewConcatenateCategoricalColumns,l=x.data.ScopeIdentityExtractor;function c(e){e&&(this.interactivityService=e.interactivityService)}c.prototype.initData=function(e){this.style=e.style,this.element=e.element,this.host=e.host,this.featureSwitches=e.featureSwitches,this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend},c.prototype.initRenderer=function(e){var t=this;this.rendererInitialized,this.svg=e.svg,this.interactivityService&&(this.playControl=new a(this.element,function(e){return t.moveToFrameAndRender(e)},this.isMobileChart),this.playControl.onPlay(function(){return t.play()})),this.rendererInitialized=!0},c.prototype.isRendererInitialized=function(){return this.rendererInitialized},c.prototype.setData=function(e,t){if(e){if(this.ridiculousFlagForPersistProperties&&e.metadata)return this.ridiculousFlagForPersistProperties=!1,this.playData;e.matrix||e.categorical?this.playData=u.converter(e,t,this.style):this.playData=u.getDefaultPlayData()}else this.playData=u.getDefaultPlayData();return this.lastViewport=void 0,this.playData},c.prototype.render=function(e,t,i,a){var r,s=this.playData,o=!this.lastViewport||this.lastViewport.height!==i.height||this.lastViewport.width!==i.width;if(this.lastViewport=i,o&&this.stop(),s)return t={data:this.playData,viewModel:t,viewport:i},this.interactivityService&&(r=s.currentViewModel,this.interactivityService.applySelectionStateToData(r.dataPoints)),this.updateCallout(i,a),this.playControl&&o&&this.playControl.rebuild(s,i,this.playControlWidth),r=s.allViewModels.map(function(e){return e.dataPoints}),{allDataPoints:_.flatten(r),viewModel:t}},c.prototype.updateCallout=function(e,t){var i=this.playData,a=i.frameData,i=i.currentFrameIndex,r=e.height,s=r-t.top-t.bottom,e=e.width,t=e-t.left-t.right,o=0,r=Math.min(r,1.3*e),e=Math.max(12,Math.round(r/7)),e=Math.min(e,70),r=[],s=(i<a.length&&0<=i&&(a={fontSize:jsCommon.PixelConverter.toString(e),text:a[i].text||"",fontFamily:v.Font.Family.regular.css},(o=x.TextMeasurementService.estimateSvgTextHeight(a)-x.TextMeasurementService.estimateSvgTextBaselineDelta(a))<s&&(i=t-2*c.calloutOffsetMultiplier*o,r=[x.TextMeasurementService.getTailoredTextOrDefault(a,i)])),this.svg.selectAll(c.PlayCallout.selector).data(r));s.enter().append("text").classed(c.PlayCallout.class,!0).merge(s).text(function(e){return e}).attrs({x:t-c.calloutOffsetMultiplier*o,y:function(){return o}}).styles({"font-size":e+"px","text-anchor":"end"}),s.exit().remove()},c.prototype.play=function(){var e,t=this.playData;this.isPlaying?this.stop():this.playControl&&(this.isPlaying=!0,this.playControl.play(),null!=(e=this.playControl.getCurrentIndex())&&((e=Math.round(e))>=t.allViewModels.length-1?t.currentFrameIndex=-1:t.currentFrameIndex=e-1,this.playNextFrame(t)))},c.prototype.playNextFrame=function(e,t,i){var a,r,s=this;this.isPlaying?(a=e.currentFrameIndex+1,null!=t&&null!=i&&(a=Math.abs(i-t+1),t=a),a<e.allViewModels.length&&-1<a?((r=this.host.tooltips())&&r.hide({immediately:!0,isTouchEvent:!1}),e.currentFrameIndex=a,e.currentViewModel=e.allViewModels[a],this.renderDelegate(e.currentViewModel),this.playControl.setFrame(a),a<e.allViewModels.length&&window.setTimeout(function(){s.playNextFrame(e,t,i)},u.FrameStepDuration)):this.stop()):this.stop()},c.prototype.stop=function(){this.playControl&&this.playControl.pause(),this.isPlaying=!1},c.prototype.remove=function(){this.playControl&&this.playControl.remove(),d3.selectAll(c.PlayCallout.selector).remove()},c.prototype.setRenderFunction=function(e){this.renderDelegate=e},c.prototype.getCartesianExtents=function(e,t){return this.playData&&!_.isEmpty(this.playData.allViewModels)&&!_.isEmpty(this.playData.frameData)&&u.getMinMaxForAllFrames(this.playData,t)||e},c.prototype.setPlayControlPosition=function(e){var t;this.playControl&&((t=this.playControl.getContainer()).css("left",e.left?e.left+"px":""),t.css("top",e.top?e.top+"px":""),t.css("width",e.width?e.width+"px":""),this.playControlWidth=e.width)},c.prototype.moveToFrameAndRender=function(e){var t=this.playData;this.isPlaying=!0,t&&0<=e&&e<t.allViewModels.length&&e!==t.currentFrameIndex&&(t.currentFrameIndex=e,e=t.allViewModels[e],t.currentViewModel=e,this.renderDelegate(e)),this.isPlaying=!1},c.prototype.isCurrentlyPlaying=function(){return this.isPlaying},c.prototype.enumerateDataPoints=function(e,t,i,a){var r=_.filter(i.metadata.columns,function(e){return e.roles[v.scatterRoleNames.category]}),s=0<r.length&&r[r.length-1].queryName,r=_.filter(i.metadata.columns,function(e){return e.roles[v.scatterRoleNames.series]}),o=0<r.length&&r[0].queryName;t.hasDynamicSeries?x.colorEnumerationHelperModuleFactory().enumerateSeriesDataColors({enumeration:e,dataPoints:_.map(t.dataPoints,function(e){return{color:e.fill,displayName:t.dataPointSeries[e.seriesIndex].name,identity:new v.SelectionId({data:__spreadArray([],e.identity.getSelectorsByColumn().dataMap[o]||[])},!1)}})},this.featureSwitches):x.colorEnumerationHelperModuleFactory().enumerateCategoryDataColors({enumeration:e,dataView:i,style:a,categories:_.map(t.dataPoints,function(e){var t=e.identity.getSelectorsByColumn().dataMap[s],t=l.getKeyValuePairs(t[0].expr);return{color:e.fill,displayName:e.formattedCategory.getValue(),identity:new v.SelectionId({data:__spreadArray([x.data.DataViewRoleWildcard.fromRoles([v.scatterRoleNames.play])],_.map(t,function(e){return n(e)}))},!1)}}),fillInstanceKind:3},this.featureSwitches)},c.PlayCallout=e("play-callout"),c.calloutOffsetMultiplier=.3,v.PlayAxis=c;d.prototype.getContainer=function(){return this.playAxisContainer},d.prototype.remove=function(){this.playAxisContainer&&this.playAxisContainer.remove()},d.prototype.pause=function(){this.playButton.removeClass("pause").addClass("play")},d.prototype.play=function(){this.playButton.removeClass("play").addClass("pause")},d.prototype.getCurrentIndex=function(){if(this.noUiSlider)return Number(this.noUiSlider.get())},d.prototype.onPlay=function(e){this.playButtonCircle.off("click"),this.playButtonCircle.on("click",e)},d.prototype.setFrame=function(e){this.noUiSlider.set([e])},d.prototype.rebuild=function(e,t,i){var a=this,r=(this.noUiSlider&&this.noUiSlider.destroy(),e.labelData),i=d.calucalateSliderSize(r,i),s=this.getContainer(),s=(i.marginLeft>d.SliderMarginLeft&&(s.css("padding-left",i.marginLeft-d.SliderMarginLeft+"px"),s.css("box-sizing","border-box")),this.updateSliderControl(e,i.width)),e=d.adjustWidthRegardingLastItem(r,s,i.width);this.slider.css("width",e+"px"),this.noUiSlider.on("slide",function(){var e=a.getCurrentIndex();a.renderDelegate(e)}),this.noUiSlider.on("update",function(){return $(".noUi-target").removeClass("noUi-state-tap")})},d.prototype.updateSliderControl=function(i,e){var t=i.labelData,a=this.slider.get(0),r=i.frameData.length,s={start:r<=1?1:i.currentFrameIndex,step:1,range:{min:0,max:r<=1?1:r-1},animationDuration:u.FrameStepDuration},o=null,n=0;return 1<r&&(n=(e=d.createPipsFilterFn(i,e,t)).skipStep,o={mode:"steps",density:Math.ceil(100/r),format:{to:function(e){return i.frameData[e].escapedText},from:function(t){return _.findIndex(i.frameData,function(e){return e.escapedText===t})}},filter:e.filter}),s.pips=o,noUiSlider.create(a,s),this.noUiSlider=a.noUiSlider,n},d.createPipsFilterFn=function(e,t,i){var a=_.max(_.map(i.labelInfo,function(e){return e.labelWidth})),r=1,s=1,a=a/(1<e.frameData.length?t/(e.frameData.length-1):t);1.25<a?(s=Math.ceil(a),r=2):(1<a||i.anyWordBreaks)&&(r=2);return{filter:function(e,t){return e%s==0?r:0},skipStep:s}},d.adjustWidthRegardingLastItem=function(e,t,i){if(_.isEmpty(e.labelInfo)||e.labelInfo.length<=1)return i;var a=e.labelInfo.length,t=Math.floor((a-1)/t)*t,e=e.labelInfo[t].labelWidth/2-(i+d.SliderMarginRight-i/a*(1+t));return 0<e?i-(e=(a=d.SliderMaxMargin-d.SliderMarginRight)<e?a:e):i},d.prototype.createSliderDOM=function(e){this.playAxisContainer=$('<div class="play-axis-container"></div>').appendTo(e).css("height",d.PlayControlHeight+"px"),this.playButtonCircle=$('<div class="button-container"></div>').appendTo(this.playAxisContainer),this.isMobileChart&&this.playButtonCircle.addClass("mobile-button-container"),this.playButton=$('<div class="play"></div>').appendTo(this.playButtonCircle),this.slider=$('<div class="sliders"></div>').attr("drag-resize-disabled","true").attr("rtl",("rtl"===document.dir).toString()).appendTo(this.playAxisContainer)},d.calucalateSliderSize=function(e,t){var i=0,e=(!_.isEmpty(e.labelInfo)&&1<e.labelInfo.length&&(i=_.head(e.labelInfo).labelWidth/2),Math.max(i,d.SliderMarginLeft)),e=Math.min(d.SliderMaxMargin,e);return{width:Math.max(t-e-d.SliderMarginRight,1),marginLeft:e}},d.SliderMarginLeft=44,d.SliderMarginRight=20,d.SliderMaxMargin=100,d.PlayControlHeight=80;var u,t,a=d;function d(e,t,i){this.isMobileChart=i,this.createSliderDOM(e),this.renderDelegate=t}function S(e,t){t=t.convertFrame(e);return i.concatenateCategoryColumnsForVisual(t.metadata,v.StandardObjectPropertyIdentifiers.formatString,v.cartesianRoleNames.category,t.categorical)}(e=u=v.PlayChart||(v.PlayChart={})).FrameStepDuration=800,t=750,e.AnimationEase="linear",e.ClassName="playChart",e.getFrameAnimationDuration=function(){return t},e.setFrameAnimationDuration=function(e){t=e},e.convertFrame=S,e.converter=function(e,t,i){var a=e.metadata,a=(v.DataLabelViewModel.getDefaultPointLabelSettings(i,"smallLightLabel"),i={},(a=a)&&a.objects&&(a=a.objects,i.currentFrameIndex=x.DataViewObjects.getValue(a,v.scatterChartProps.currentFrameIndex.index,null)),i),r=[],s=[],o=v.DataViewMultipleReader.create(e,v.StandardObjectPropertyIdentifiers.formatString),i=o.getFrameCount(),n=o.getSubtotals();if(o.hasFrames()){var l,c,e=o.getFrameSourceColumns(),u=e&&e[0],e=v.valueFormatter.getFormatString(u,v.scatterChartProps.general.formatString),d=void 0;d=u.type.numeric?(c=null==(c=o.getFrameNode(i-1))?void 0:c.value,l=null==(l=o.getFrameNode(0))?void 0:l.value,c=Math.abs(c-l),v.valueFormatter.create({format:e,value:c,value2:0,columnType:u.type})):v.valueFormatter.createDefaultFormatter(e,!0);for(var h=0,p=i;h<p;h++){var g,y,m,f=o.getFrameNode(h);f.isSubtotal||(g=d.format(f.value),y=$("<div></div>").text(g).html(),s.push({escapedText:y,text:g}),m=t(S(h,o),{label:y,column:u,identity:f.identity,value:f.value,formattedValue:g},n),r.push(m))}}else m=t(S(0,o),void 0,n),r.push(m);return a.currentFrameIndex=s.length-1,{allViewModels:r,currentViewModel:m,frameData:s,currentFrameIndex:a.currentFrameIndex,labelData:function(e,t){for(var i={fontFamily:v.Font.Family.regular.css,fontSize:jsCommon.PixelConverter.toString(14)},a=[],r=!1,s=0,o=e;s<o.length;s++){var n=o[s],l=jsCommon.WordBreaker.getMaxWordWidth(n.escapedText,x.TextMeasurementService.measureSvgTextWidth,i);r=r||jsCommon.WordBreaker.hasBreakers(n.escapedText)||-1<n.escapedText.indexOf("-"),a.push({label:n.escapedText,labelWidth:l})}return{labelInfo:a,anyWordBreaks:r,labelFieldName:t&&t.displayName}}(s,u)}},e.getDefaultPlayData=function(){return{frameData:[],allViewModels:[],currentFrameIndex:0,currentViewModel:void 0,labelData:{anyWordBreaks:!1,labelInfo:[]}}},e.getMinMaxForAllFrames=function(e,t){var i={},a=!1;if(e.allViewModels&&0<e.allViewModels.length)for(var r=0,s=e.allViewModels.length;r<s;r++){var o=e.allViewModels[r];_.isEmpty(o.dataPoints)||(a=!0,o=t(o),i={minY:d3.min([o.minY,i.minY]),maxY:d3.max([o.maxY,i.maxY]),minX:d3.min([o.minX,i.minX]),maxX:d3.max([o.maxX,i.maxX]),formatStringX:o.formatStringX||i.formatStringX,formatStringY:o.formatStringY||i.formatStringY})}return a?i:null},e.isDataViewPlayable=function(e,t){return void 0===t&&(t="Play"),(e=e.matrix&&e.matrix.rows&&e.matrix.rows.levels&&e.matrix.rows.levels[0]&&e.matrix.rows.levels[0].sources&&e.matrix.rows.levels[0].sources[0]&&e.matrix.rows.levels[0].sources[0].roles)&&e[t]},e.renderTraceLines=function(e,t,i){e=_.filter(e,function(e){return e.selected}),e=_.uniqBy(e,function(e){return e.identity.getKey()}),t.render(e,i)}}(x.visuals||(x.visuals={}))}(powerbi=powerbi||{}),function(s){!function(u){function t(e){this.maxDataValue=Number.MIN_VALUE,this.newDataInterval=0,this.duration=3e5,this.featureSwitches=e.featureSwitches}t.prototype.initData=function(e){this.style=e.style,this.currentViewport=e.viewport,this.data={series:[],dataLabelsSettings:u.LineChart.getDefaultLineChartLabelSettings(this.style),hasDynamicSeries:!1,categories:[],categoryMetadata:void 0,valuesMetadata:[],categoryData:[],lineStyle:u.LineStyle.getDefault()}},t.prototype.initRenderer=function(e){this.animator=e.animator;e=e.svg,e.classed("realTimeLineChart",!0).classed("cartesianChart",!0),e=this.mainGraphicsSVG=e.append("svg");e.classed("mainGraphicsSVG",!0),this.mainGraphicsContext=e.append("g").classed("mainGraphicsContext",!0)},t.prototype.setData=function(e){var t,i;this.data||(this.data={series:[],dataLabelsSettings:u.LineChart.getDefaultLineChartLabelSettings(this.style),hasDynamicSeries:!1,categories:[],categoryMetadata:void 0,valuesMetadata:[],categoryData:[],lineStyle:u.LineStyle.getDefault()}),_.isEmpty(e)||(e=_.head(e)).categorical&&((t=u.CartesianHelper.getCategoryAxisProperties(e.metadata).duration)&&(this.duration=t),t=e.categorical,this.removeOldData(),t=t.categories,i=s.ValueType.fromDescriptor({text:!0}),t&&0<t.length&&t[0].source&&t[0].source.type&&(i=t[0].source.type),t=u.ScalarUtils.canHaveScalarAxis(e.metadata?e.metadata.objects:null,u.lineChartProps.categoryAxis.axisType,i),i=u.LineChart.converter({dataView:e,style:this.style,isScalar:t,featureSwitches:this.featureSwitches}),this.mergeNewData(i),this.removeOldData(this.newDataInterval))},t.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||!_.isEmpty(this.data.series))},t.prototype.calculateAxesProperties=function(e){return this.currentViewport=e.viewport,this.margin=e.margin,this.newAxisData&&(this.axisData=this.newAxisData),this.newAxisData=this.createAxisData(e),this.axisData||(this.axisData=this.newAxisData),[this.xAxisProperties,this.yAxisProperties]},t.prototype.getAxesDomains=function(e,t){var i,a={},r=this.data;return r&&(i=this.truncateSeries(),_.isEmpty(i)||(t.categoryAxis&&(r=u.AxisHelper.createDomain(i,r.categoryMetadata?r.categoryMetadata.type:s.ValueType.fromDescriptor({text:!0}),!0,[u.AxisHelper.createScalarDomainOptions([this.getMinData()+this.newDataInterval,void 0],0,[!0,void 0])]))&&(u.AxisHelper.assertScalarDomain(r),a.categoryAxis=r),t.valueAxis&&(a.valueAxis=u.AxisHelper.createValueDomain(i)))),a},t.prototype.setAxesLayout=function(e){},t.prototype.overrideXScale=function(e){this.xAxisProperties=e},t.prototype.render=function(e,t){if(!this.containsEmptySeries())return this.renderLines(),this.animator&&this.animator.refreshLastUpdate(),{dataPoints:[],behaviorOptions:{},labelDataPoints:[],labelsAreNumeric:!0,labelDataPointGroups:[],animateLabels:!1}},t.prototype.onClearSelection=function(){},t.prototype.createAxisData=function(e){var t,i,a,r,s,o,n,l=this,c=this.data;if(c)return this.containsEmptySeries()||(t=c.series[0].yCol),i=this.getAxesDomains(!1,{categoryAxis:!0,valueAxis:!0}),n=e.viewport,a=n.width,r=u.AxisHelper.hasForcedDomain(e.categoryAxisOptions.includeDomain),r=this.xAxisProperties=u.AxisHelper.createAxis({pixelSpan:a,dataDomain:i.categoryAxis,axisZoom:void 0,metaDataColumn:c.categoryMetadata,formatString:u.valueFormatter.getFormatString(c.categoryMetadata,u.columnChartProps.general.formatString),outerPadding:10,isCategoryAxis:!0,isScalar:!0,isVertical:!1,categoryThickness:null,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,t){return u.CartesianHelper.lookupXValue(c,e,t,!0,l.featureSwitches)},scaleType:u.axisScale.linear,logAxisScale:!1,margin:e.margin,preventNice:r,featureSwitches:this.featureSwitches}),s=this.margin,o=u.AxisHelper.hasForcedDomain(e.valueAxisOptions.includeDomain),n=this.yAxisProperties=u.AxisHelper.createAxis({pixelSpan:n.height-s.top-s.bottom,dataDomain:i.valueAxis,axisZoom:void 0,metaDataColumn:t,formatString:u.valueFormatter.getFormatString(t,u.columnChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:u.axisScale.linear,logAxisScale:!1,margin:e.margin,preventNice:o,featureSwitches:this.featureSwitches}),n.axis.tickSize(-a),{x:r,y1:n}},t.prototype.truncateSeries=function(){var a=this.getMinData(),e=this.data.series;return e?_.map(e,function(e,t){(e=s.Prototype.inherit(e)).data=s.Prototype.inherit(e.data);var i=0;return 0<_.findIndex(e.data,function(e){return e&&e.categoryValue>=a})&&i++,e.data=e.data.slice(i),e}):[]},t.prototype.removeOldData=function(e){if(void 0===e&&(e=0),!this.containsEmptySeries()){for(var t=this.getMinData(e),e=this.data,i=0,a=e.series;i<a.length;i++){var r=a[i],s=_.findIndex(r.data,function(e){return e&&e.categoryValue>t});0<s&&(r.data=r.data.slice(s))}var o=_.findIndex(e.categoryData,function(e){return e&&e.categoryValue>t});0<o&&(e.categoryData=this.data.categoryData.slice(o),e.categories=this.data.categories.slice(o))}},t.prototype.mergeNewData=function(e){if(this.containsEmptySeries())return this.data=e,void(this.maxDataValue=this.getMaxData());this.data.series=t.mergeSeries(this.data.series,e.series,this.maxDataValue),t.mergeCategories(this.data,e,this.maxDataValue);e=this.getMaxData();this.newDataInterval=this.maxDataValue&&e?e-this.maxDataValue:0,this.maxDataValue=e},t.prototype.getMaxData=function(){for(var e=0,t=0,i=this.data.series;t<i.length;t++){var a=i[t];a.data.length&&(e=Math.max(_.last(a.data).categoryValue,e))}return e},t.prototype.getMinData=function(e){return this.maxDataValue-this.duration-1.5*(e=void 0===e?0:e)},t.prototype.renderLines=function(){var i=this.axisData.x.scale,a=this.axisData.y1.scale,e=this.currentViewport,t=this.margin,r=e.height-t.top-t.bottom,e=e.width-t.left-t.right,t=i(i.domain()[0]+this.newDataInterval)-i(i.domain()[0]),s=d3.line().x(function(e,t){return i(e.categoryValue)}).y(function(e,t){return a(e.value)}),r=(this.mainGraphicsSVG.attrs({x:0,height:r,width:e}),this.mainGraphicsContext.attr("transform",u.SVGUtil.translate(0,0)),this.mainGraphicsContext.selectAll(".line").data(this.data.series,function(e){return e.identity.getKey()}));r.enter().append("path").classed("line",!0).merge(r).style("stroke",function(e){return e.color}).attr("d",function(e){return s(e.data)}),r.exit().remove(),this.animator&&this.animator.animate({mainGraphicsContext:this.mainGraphicsContext,interactivityService:null,xTranslation:t})},t.prototype.containsEmptySeries=function(){return!this.data||_.isEmpty(this.data.series)},t.mergeCategories=function(e,t,i){var a=t.categories,a=_.findIndex(a,function(e){return e&&e.categoryValue>i});-1<a?(e.categories=e.categories.concat(t.categories.slice(a)),e.categoryData=e.categoryData.concat(t.categoryData.slice(a))):(e.categories=t.categories,e.categoryData=t.categoryData)},t.mergeSeries=function(e,t,i){for(var a=[],r=0,s=t;r<s.length;r++){var o=s[r],n=_.find(e,function(e){return e.identity.equals(o.identity)});if(n){a.push(n);for(var l=0,c=o.data;l<c.length;l++){var u=c[l];u.categoryValue>i&&n.data.push(u)}}else a.push(o)}return a},t.prototype.getCartesianVisualCapabilities=function(){return{supportsHierarchicalCategoryAxis:!1}},t.prototype.getStaticSeriesRole=function(){return"Y"},u.RealTimeLineChart=t}(s.visuals||(s.visuals={}))}(powerbi=powerbi||{}),function(e){var t,s=e.visuals||(e.visuals={});function i(e){e=t.call(this,e)||this;return e.lastUpdateTime=null,e}t=s.BaseAnimator,__extends(i,t),i.prototype.refreshLastUpdate=function(){this.lastUpdateTime=Date.now()},i.prototype.getDuration=function(){var e;return this.lastUpdateTime?(e=Math.min(Date.now()-this.lastUpdateTime,250),Math.max(this.animationDuration,e)):this.animationDuration},i.prototype.getEasing=function(){return s.D3Helper.easeCompat("linear")},i.prototype.animate=function(a){var e=a.mainGraphicsContext,t=this.getDuration();return e.transition().duration(t).ease(this.getEasing()).attrTween("transform",function(e,t,i){return function(e){return s.SVGUtil.translate(-a.xTranslation*e,0)}}),{failed:!1}},s.RealTimeLineChartAnimator=i,a=s.BaseAnimator,__extends(r,a),r.prototype.animate=function(e){var t={failed:!0,shapes:null},i=e.viewModel,a=this.previousViewModel;return i.categories.length*i.series.length>s.AnimatorCommon.MaxDataPointsToAnimate||(a&&(t=this.animateDefaultShapes(e.viewModel,e.series,e.layout,e.itemCS)),this.previousViewModel=i),t},r.prototype.getEasing=function(){return s.D3Helper.easeCompat("linear")},r.prototype.animateDefaultShapes=function(t,e,i,a){var e=e.selectAll(a.selector).data(function(e){return e.data},function(e){return e.key}),r=e.enter().append("rect").attr("class",function(e){return a.class.concat(e.highlight?" highlight":"")}).merge(e);return r.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return s.ColumnUtil.getFillOpacity(e.selected,e.highlight,!1,t.hasHighlights)}).transition().ease(this.getEasing()).duration(this.animationDuration).attrs(i.shapeLayout),e.exit().remove(),{failed:!1,shapes:r}};var a;function r(e){return a.call(this,e)||this}s.DashboardColumnChartAnimator=r}(powerbi=powerbi||{}),function(J){var Q;(Q=J.visuals||(J.visuals={})).scatterChartConverterModuleFactory=function(){var e=J.data,n=J.visuals,U=n.AxisHelper,l=n.cartesianChartProps,c=J.visuals.CartesianHelper,z=n.CategoricalLazyTooltipBuilder,b=J.visuals.ColorHelper,u=n.columnChartProps,C=e.DataRoleHelper,H=n.DataViewConcatenateUtil,j=J.DataViewObjects,E=n.ForegroundColorName,W=n.FormattingStrategies,w=n.GradientUtils,D=n.DataLabelViewModel,A=n.Legend,G=n.ScatterChart,Y=n.scatterChartProps,X=n.scatterRoleNames,K=n.SelectionIdBuilder,d=n.shapeUtil,Z=n.valueFormatter;function t(e,t,i,a){if(t.useMatrixDV){var r=e,s=t,o=i;if(!r||!r.matrix||0===_.size(r.matrix.valueSources)&&0===_.size(r.matrix.rows.levels))return;for(var n=s.interactivityService,l=D.getDefaultPointLabelSettings(s.style,"smallLightLabel"),c=T(r,l,!0,s.style),u=function(e,t){var i,a,r,e=e.matrix,s=e.valueSources,o=!1,n=!1,l=[_.findIndex(s,function(e){return C.hasRole(e,"X")})],c=_.findIndex(s,function(e){return C.hasRole(e,"Y")}),u=_.findIndex(s,function(e){return C.hasRole(e,"Size")}),d="",h="";0<=l[0]?(i=s[l[0]],d=i.displayName):(g=F(e.rows,X.x))&&(i=g.column,l=g.levelSourceIndices,d=i.displayName,o=!0);0<=c?(a=s[c],h=a.displayName):(g=F(e.rows,X.y))&&(a=g.column,c=g.levelSourceIndices[0],h=a.displayName,n=!0);0<=u&&(r=s[u]);var p,g=_.find(e.rows.levels,function(e){return!_.isEmpty(e.sources)&&C.hasRole(e.sources[0],X.series)});g?p=e.rows.root:(g=_.find(e.columns.levels,function(e){return!_.isEmpty(e.sources)&&C.hasRole(e.sources[0],X.series)}))&&(p=e.columns.root);var s=!1,y=!1;{var m;i&&(m=i.type,s=_.size(l)<=1&&!(!m.integer&&!m.numeric),y=t.categoryAxisType===J.visuals.axisType.categorical||!s)}(o||n)&&_.find(e.rows.levels,function(e){return C.hasRole(e.sources[0],X.category)});m=o?_.find(e.rows.levels,function(e){return C.hasRole(e.sources[0],X.x)}):n?_.find(e.rows.levels,function(e){return C.hasRole(e.sources[0],X.y)}):_.find(e.rows.levels,function(e){return C.hasRole(e.sources[0],X.category)});return{idx:{x:l,y:c,size:u},cols:{x:i,y:a,size:r},axesLabels:{x:d,y:h},xGroupMetadata:o?{isCategoricalAxis:y,isScalarType:s}:void 0,yGroupMetadata:n?{isCategoricalAxis:!1,isScalarType:!0}:void 0,seriesLevel:g,seriesNode:p,categoryLevel:m,treatNullsAsZero:{x:t.xValuesTreatNullsAsZero,y:t.yValuesTreatNullsAsZero}}}(r,c),d={min:Number.MAX_VALUE,max:Number.MIN_VALUE},h=((y=u.cols.size)&&y.aggregates&&(d={min:y.aggregates.minLocal||y.aggregates.min,max:y.aggregates.maxLocal||y.aggregates.max}),r.matrix.valueSources),p=[],g=0;g<h.length;g++)C.hasRole(h[g],"Tooltips")&&p.push(g);var y={colorHelper:b.create(s.style,Y.dataPoint.fill,c.defaultDataPointColor,c.fill),metadata:u,hasDynamicSeries:C.hasRoleInDataView(r,"Series"),tooltipsEnabled:s.tooltipsEnabled,sizeRange:d,dataLabelSettings:l,playFrameInfo:o,tooltipValuesIndices:p,gradientIndex:_.findIndex(h,function(e){return C.hasRole(e,"Gradient")}),objProps:c,categoryMap:{},categoryMapNextIndex:0,categoryIdentities:[]},o=function(e,t){var i=[],a=e.matrix;if(!a.rows.root||0===_.size(a.rows.root.children))return{series:i};var r,s=t.metadata,o=s.seriesLevel,n=s.categoryLevel,l=s.seriesNode,c=-1!==s.idx.size?a.valueSources[s.idx.size]:void 0;if(l){for(var u=0;u<l.children.length;u++){var d=l.children[u];if(!d.isSubtotal){for(var h=t.colorHelper.getColorForSeriesValue(d.objects,l.childIdentityFields,d.value,E),p=[],g=(_.size(o.sources),o.sources[0]),y=0,m=d.levelValues;y<m.length;y++){var f=m[y];p.push({expr:g.expr,formattedValue:Z.format(f.value,g.format),value:f.value,identity:d.identity})}var v=(new K).withColumnIdentity(d.identity,g.queryName,p).createSelectionId(),S=void 0,x=(S=t.objProps.markerShapeShowAllSeries?J.DataViewObjects.getValue(d.objects,Y.bubbles.markerShape,t.objProps.markerShape):t.objProps.markerShape,Z.format(d.value,J.DataViewObjects.getValue(g.objects,Y.general.formatString))),b={identityKey:d.identity&&d.identity.key||"",dataPoints:[],hasSize:!!c,fill:h,identity:v,markerShape:S,name:x},C=(i.push(b),{currentSeries:d,currentSeriesColor:h,seriesShape:S,seriesIndex:u});b.dataPoints=L(e,C,t),n||0!==_.size(b.dataPoints)||(v=M(void 0,g),x={category:d,categoryMetadataColumns:[g],categoryIdentityFields:d.childIdentityFields,currentSeries:d,currentSeriesMetadata:g,currentSeriesColor:h,categoryFormatter:v,valueColumnIds:$(t.metadata),seriesShape:S,currentSeriesIndex:u},(v=V(e,x,t))&&b.dataPoints.push(v))}}var w=e.matrix.rows.root.children;(D=_.find(w,function(e){return e.isSubtotal}))&&(r=P(s,D))}else{var D,A;n?(A=null!=c?c.queryName:"",h=t.colorHelper.getColorForMeasure(null,A,E),b={identityKey:"",dataPoints:[],hasSize:!!c,fill:h,markerShape:t.objProps.markerShape},i.push(b),C={currentSeries:a.rows.root,currentSeriesColor:h,seriesShape:t.objProps.markerShape},b.dataPoints=L(e,C,t),w=e.matrix.rows.root.children,(D=_.find(w,function(e){return e.isSubtotal}))&&(r=P(t.metadata,D))):(A=null!=c?c.queryName:"",h=t.colorHelper.getColorForMeasure(null,A,E),s={identityKey:"",dataPoints:[],hasSize:!!c,fill:h},i.push(s),C={currentSeries:a.rows.root,currentSeriesColor:h,seriesShape:t.objProps.markerShape},s.dataPoints=L(e,C,t),(w=t.metadata).xGroupMetadata||w.yGroupMetadata||(r=P(w,e.matrix.rows.root.children[0])))}return{series:i,xSubtotal:r&&r.xSubtotal,ySubtotal:r&&r.ySubtotal}}(r,y),m=_.reduce(o.series,function(e,t){return e.concat(t.dataPoints)},[]),r=(f=y.hasDynamicSeries?(r={dataView:r,colorHelper:y.colorHelper,style:s.style,formatStringProp:null,showByDefault:!0,markerShapePropIdentifier:Y.bubbles.markerShape,markerShowSeriesPropIdentifier:Y.bubbles.showSeries},(f=y.metadata.xGroupMetadata)&&f.isCategoricalAxis?A.buildFromFirstMatrixColumnLevel(r):A.buildFromFirstMatrixRowLevel(r)):A.getDefaultLegendData(s.style),n&&(n.applySelectionStateToData(m),n.applySelectionStateToData(f.dataPoints)),!!(u.xGroupMetadata||u.yGroupMetadata||u.categoryLevel));return{xCol:u.cols.x,yCol:u.cols.y,hasCategory:r,hasSize:!!u.cols.size,dataPoints:m,dataPointSeries:o.series,legendData:f,axesLabels:u.axesLabels,categoryIdentities:y.categoryIdentities,size:u.cols.size,sizeRange:d,dataLabelsSettings:l,hasDynamicSeries:y.hasDynamicSeries,fillPoint:c.fillPoint,fillPointStyle:c.fillPointStyle,colorBorder:c.colorBorder,colorByCategory:c.colorByCategory,multiplier:c.bubbleSizeMultiplier,xSubtotal:o.xSubtotal,ySubtotal:o.ySubtotal,plotAreaShadingSettings:c.plotAreaShadingSettings,ratioLineSettings:c.ratioLineSettings,markerShape:c.markerShape,dataVolume:c.dataVolume,xGroupMetadata:u.xGroupMetadata,yGroupMetadata:u.yGroupMetadata,treatNullsAsZero:u.treatNullsAsZero}}var f,v,S,x;if(e.categorical&&e.categorical.values)return s=e,n=t,r=i,m=a,f=J.data.createDataViewCategoricalReaderAdvanced(s,{colorOptions:{valueRole:"Size",visualStyle:n.style},formatStringProp:Y.general.formatString}),d=n.style,l=n.interactivityService,y=n.categoryAxisProperties,o=n.valueAxisProperties,c=s.categorical,u=w.getGradientValueColumn(c),e=c.categories&&0<c.categories.length?(v=c.categories[0].values,Z.create({format:Z.getFormatString(c.categories[0].source,Y.general.formatString),value:v[0],value2:v[v.length-1],columnType:f.data.getCategoryType("Category")})):(v=[null],Z.createDefaultFormatter(null)),i=!!(t=c.values).source,a=t.grouped(),t.source,S=function(e){var t,i,a,r=C.getMeasureIndexOfRole(e,"X"),s=C.getMeasureIndexOfRole(e,"Y"),o=C.getMeasureIndexOfRole(e,"Size"),n="",l="";e&&e.length&&(e=e[0],0<=r&&(t=e.values[r].source,n=e.values[r].source.displayName),0<=s&&(i=e.values[s].source,l=e.values[s].source.displayName),0<=o&&(a=e.values[o].source));return{idx:{x:[r],y:s,size:o},cols:{x:t,y:i,size:a},axesLabels:{x:n,y:l}}}(a),x=D.getDefaultPointLabelSettings(d,"smallLightLabel"),a=function(e,t){var i={};e&&e.forEach(function(e){e=G.getMeasureValue(t,e.values),e=U.getRangeForColumn(e);(null==i.min||i.min>e.min)&&(i.min=e.min),(null==i.max||i.max<e.max)&&(i.max=e.max)});return i}(a,S.idx.size),d=T(s,x,!1,d),t=function(p,g,e,y,m,f,v,S,x,b,C,w){var D,A=p.data.hasValues("X"),P=p.data.hasValues("Y"),L=y.categories;if(!A&&!P)return[];for(var t=[],i=e.idx,M=Y.general.formatString,V=g.source,a=g.grouped(),T=(_.size(i.x),_.isEmpty(L)?null:L[0]),r=p.objects.getStaticObjects(),s=j.getValue(r,Y.bubbles.markerShape,Q.markerShape.circle),F=$(e),I=0,o=a.length;I<o;I++)for(var k=a[I],n=k.values,O=G.getMeasureValue(_.first(i.x),n),N=G.getMeasureValue(i.y,n),R=G.getMeasureValue(i.size,n),n=void 0,B=(v&&(n=p.colors.createBySeries(I,void 0,E)),void 0),l=(B=p.data.hasSeries()&&j.getValue(r,Y.bubbles.showSeries,!0)?j.getValue(p.objects.getSeriesDataObjects(I),Y.bubbles.markerShape,s):s,p.identities.createForSeries(I,[X.size])),H={identityKey:k&&k.identity&&k.identity.key||"",dataPoints:[],hasSize:!(!R||!R.values),fill:n,identity:l,markerShape:B,name:v?Z.format(p.data.getSeriesName(I),p.objects.getSeriesFormatString()):void 0},c=(t.push(H),0),u=m.length;c<u;c++)!function(e){var t=m[e],i=A?U.normalizeNonFiniteNumber(p.data.getValue(X.x,e,I)):0,a=P?U.normalizeNonFiniteNumber(p.data.getValue(X.y,e,I)):0,r=A?p.data.getFormatString(X.x,e,I):void 0,s=P?p.data.getFormatString(X.y,e,I):void 0,o=U.normalizeNonFiniteNumber(p.data.getValue("Size",e,I));if(null==i||null==a)return;var n,l=void 0,l=b&&!v?p.colors.createByCategory(e,E):p.colors.createBySeries(I,e,E),c=void 0,u=null!=(D=y.originalCategories)?D:[T],u=K.builder().withCategory(u,e,null==(D=null==T?void 0:T.source)?void 0:D.queryName,!0).withSeries(g,k,!0).withMeasures(F),d=(C?(c=u.clone(),d={expr:C.column.expr,formattedValue:C.formattedValue,identity:C.identity,value:C.value},c.withColumnIdentity(C.identity,C.column.queryName,[d])):c=u,c.createSelectionId()),c=u?u.createSelectionId():d,h=new z(p.columns,M),u=(w&&(u=W.defaultFormatter(M),n=W.fallbackBasedOnType(M),h.withColumnValueByIndex(T,e,!0,u),v&&h.withColumnValue(V,k.name,void 0,!0,u),h.withColumnValueByIndex(O,e,!1,n).withColumnValueByIndex(N,e,!1,n).withColumnValueByIndex(R,e,!1,n).withColumnValueByIndex(x,e,!1,n),C&&h.withValue(C.column.displayName,C.label),h.withAllValuesForRole("Tooltips",e,I,!1,n)),{x:i,y:a,xFormatString:r,yFormatString:s,size:o,radius:{sizeMeasure:R,index:e},fill:l,formattedCategory:G.createLazyFormattedCategory(f,null!=L?t:k.name),selected:!1,identity:d,renderIdentity:c,tooltipInfo:function(){return h.getTooltipItems()},labelFill:S.fontProperties.color,markerShape:B,categoryIndex:e,seriesIndex:I});H.dataPoints.push(u)}(c);return t}(f,t,S,c,v,e,i,x,u,d.colorByCategory,r,n.tooltipsEnabled),c=_.reduce(t,function(e,t){return e.concat(t.dataPoints)},[]),v=i?A.buildSeriesLegendData({dataView:s,style:n.style,showByDefault:!0,simpleMarkerProp:Y.bubbles.markerShape}):A.getDefaultLegendData(),y&&null!==y.showAxisTitle&&!1===y.showAxisTitle&&(S.axesLabels.x=null),o&&null!==o.showAxisTitle&&!1===o.showAxisTitle&&(S.axesLabels.y=null),l&&(l.applySelectionStateToData(c),l.applySelectionStateToData(v.dataPoints)),e=f.data.hasCategories(),{xCol:S.cols.x,yCol:S.cols.y,hasCategory:e,hasSize:!!S.cols.size,dataPoints:c,dataPointSeries:t,legendData:v,axesLabels:S.axesLabels,size:S.cols.size,sizeRange:a,dataLabelsSettings:x,hasDynamicSeries:i,fillPoint:d.fillPoint,fillPointStyle:d.fillPointStyle,colorBorder:d.colorBorder,colorByCategory:d.colorByCategory,multiplier:d.bubbleSizeMultiplier,xSubtotal:m&&m[X.x],ySubtotal:m&&m[X.y],plotAreaShadingSettings:d.plotAreaShadingSettings,ratioLineSettings:d.ratioLineSettings,markerShape:d.markerShape,dataVolume:d.dataVolume}}function P(e,t){e.xGroupMetadata||e.yGroupMetadata;var i,a,r=e.idx.x,e=e.idx.y,r=(_.size(r),_.first(r));return{xSubtotal:i=-1!==r?U.normalizeNonFiniteNumber(t.values[r].value):i,ySubtotal:a=-1!==e?U.normalizeNonFiniteNumber(t.values[e].value):a}}function L(e,t,i){var a=[],r=t.currentSeries,s=i.metadata.seriesLevel?i.metadata.seriesLevel.sources[0]:void 0,o=$(i.metadata),n=function(e,t,i){var a,r,s=i.metadata.seriesLevel?i.metadata.seriesLevel.sources[0]:void 0,t=t.currentSeries,o=Z.createDefaultFormatter(null);i.metadata.xGroupMetadata&&i.metadata.xGroupMetadata.isCategoricalAxis?(i=e.matrix.rows,a=i.root.children,r=i.levels[0].sources,o=M(a[0],r[0])):t.children?(a=t.children,r=0<e.matrix.rows.levels.length?e.matrix.rows.levels[a[0].level].sources:void 0,s&&(o=M(a[0],r[0]))):s&&C.hasRole(s,"Category")&&(o=M((a=[t])[0],(r=[s])[0]));return{categories:a,categoryMetadataColumns:r,formatter:o}}(e,t,i);if(!_.isEmpty(n.categories))for(var l=0,c=n.categories;l<c.length;l++){var u=V(e,{category:c[l],categoryMetadataColumns:n.categoryMetadataColumns,categoryIdentityFields:r.childIdentityFields,currentSeries:r,currentSeriesMetadata:s,currentSeriesColor:t.currentSeriesColor,categoryFormatter:n.formatter,valueColumnIds:o,seriesShape:t.seriesShape,currentSeriesIndex:t.seriesIndex},i);u&&a.push(u)}return a}function M(e,t){var i;return e?(i=e.levelValues,Z.create({format:Z.getFormatString(t,Y.general.formatString),value:i[0],value2:i[_.size(e.values)-1],columnType:null})):Z.createDefaultFormatter(null)}function V(e,l,t){if(!l.category.isSubtotal){var i,a,r=t.metadata,e=e.matrix,s=r.idx.x,o=r.idx.y,n=r.idx.size,c=_.size(e.valueSources),u=r.xGroupMetadata,d=r.yGroupMetadata,h=_.first(s),p=0,g=Y.general.formatString,h=(u||-1===h||(p=U.normalizeNonFiniteNumber(l.category.values[h].value),p=r.treatNullsAsZero&&r.treatNullsAsZero.x&&null==p?0:p,i=j.getValue(l.category.values[h].objects,g)),null==p?null:[p]),p=(u&&(h=_.map(s,function(e){return l.category.levelValues[e].value})),0),y=r.xGroupMetadata&&r.xGroupMetadata.isCategoricalAxis;if(d||-1===o?d&&(p=l.category.levelValues[o].value):(D=q(y,l,c,o),p=U.normalizeNonFiniteNumber(l.category.values[D].value),p=r.treatNullsAsZero&&r.treatNullsAsZero.y&&null==p?0:p,a=j.getValue(l.category.values[D].objects,g)),null!=h&&null!=p){-1!==n&&(D=q(y,l,c,n),m=U.normalizeNonFiniteNumber(l.category.values[D].value),N=j.getValue(l.category.values[D].objects,g));var m,s=K.builder();if(!_.isEmpty(l.categoryMetadataColumns)){for(var o=_.last(l.categoryMetadataColumns),f=[],v=0,S=l.category.levelValues;v<S.length;v++){var x=S[v],b=l.categoryMetadataColumns[x.levelSourceIndex];f.push({expr:b.expr,formattedValue:Z.format(x.value,b.format),value:x.value,identity:l.category.identity})}s.withColumnIdentity(l.category.identity,o.queryName,f)}if(l.currentSeriesMetadata){for(var f=[],C=0,w=l.currentSeries.levelValues;C<w.length;C++){x=w[C];f.push({expr:l.currentSeriesMetadata.expr,formattedValue:Z.format(x.value,l.currentSeriesMetadata.format),value:x.value,identity:l.currentSeries.identity})}s.withColumnIdentity(l.currentSeries.identity,l.currentSeriesMetadata.queryName,f)}_.isEmpty(l.valueColumnIds)||s.withMeasures(l.valueColumnIds),t.playFrameInfo&&(L=t.playFrameInfo,V=s.clone(),f={expr:L.column.expr,formattedValue:L.formattedValue,identity:L.identity,value:L.value},s.withColumnIdentity(L.identity,L.column.queryName,[f]));var n=s.createSelectionId(),D=V?V.createSelectionId():n,o=t.sizeRange,s=(o.min>m&&(o.min=m),o.max<m&&(o.max=m),l.currentSeriesColor),A=(t.hasDynamicSeries||(t.objProps.colorByCategory?s=t.colorHelper.getColorForSeriesValue(l.category.objects,l.categoryIdentityFields,l.category.value,E):l.category.objects&&(V=null!=t.metadata.cols.size?t.metadata.cols.size.queryName:"",s=t.colorHelper.getColorForMeasure(l.category.objects,V,E))),W.defaultFormatter(g)),o=function(){var e=l.category.levelValues,t=l.currentSeries.value;return t=e?1<_.size(e)?H.concatenateValues(_.map(e,function(e,t){return A(e.value,l.categoryMetadataColumns[t])})):e[0].value:t},P=new J.visuals.LazyTooltipBuilder;if(t.tooltipsEnabled){var L,M=W.fallbackBasedOnType(g),V=l.category.levelValues,T=1<_.size(l.categoryMetadataColumns),d=(u||d||(T?P.withMultipleColumnAndValues(l.categoryMetadataColumns,_.map(V,function(e){return e.value}),!0,A):V&&P.withColumnValue(_.head(l.categoryMetadataColumns),V[0].value,void 0,!0,A)),t.hasDynamicSeries&&P.withColumnValue(l.currentSeriesMetadata,l.currentSeries.value,void 0,!0,A),u&&t.metadata.xGroupMetadata.isCategoricalAxis?P.withMultipleColumnAndValues(l.categoryMetadataColumns,h,!0,A):P.withColumnValue(r.cols.x,h[0],i,!1,M),P.withColumnValue(r.cols.y,p,a,!1,M).withColumnValue(r.cols.size,m,N,!1,M),t.gradientIndex),F=e.valueSources;0<=d&&(O=j.getValue(l.category.values[d].objects,g),P.withColumnValue(F[d],l.category.values[d].value,O,!1,M)),(L=t.playFrameInfo)&&P.withValue(L.column.displayName,L.label);for(var I=0,R=t.tooltipValuesIndices;I<R.length;I++){var k=R[I],O=j.getValue(l.category.values[k].objects,g),B=q(y,l,c,k);P.withColumnValue(F[k],l.category.values[B].value,O,!1,M)}}var T=1<_.size(h)?h.join(" "):h[0],V=y?T:o(),u=t.categoryMap,r=String(V),N=u[r];return void 0===N&&(u[r]=N=t.categoryMapNextIndex,t.categoryMapNextIndex=N+1,(e=t.categoryIdentities)&&(e[N]=function(){var e=K.builder();if(!_.isEmpty(l.categoryMetadataColumns))for(var t=0,i=l.categoryMetadataColumns;t<i.length;t++){for(var a=i[t],r=[],s=0,o=l.category.levelValues;s<o.length;s++){var n=o[s];r.push({expr:a.expr,formattedValue:Z.format(n.value,a.format),value:n.value,identity:l.category.identity})}e.withColumnIdentity(l.category.identity,a.queryName,r)}return e.withMeasures(l.valueColumnIds).createSelectionId()})),{x:T,y:p,size:m,radius:{sizeMeasure:null,index:-1,value:m},fill:s,xFormatString:i,yFormatString:a,formattedCategory:G.createLazyFormattedLazyValue(l.categoryFormatter,o),selected:!1,identity:n,renderIdentity:D,tooltipInfo:function(){return P.getTooltipItems()},labelFill:t.dataLabelSettings.fontProperties.color,markerShape:l.seriesShape,categoryIndex:N,seriesIndex:l.currentSeriesIndex||0}}}}function q(e,t,i,a){return e&&null!=t.currentSeriesIndex?t.currentSeriesIndex*i+a:a}function T(e,t,i,a){var r={},s=(e&&e.metadata&&e.metadata.objects&&(r=e.metadata.objects),{}),o=(s.defaultDataPointColor=J.DataViewObjects.getFillColor(r,u.dataPoint.defaultColor),s.fill=J.DataViewObjects.getFillColor(r,u.dataPoint.fill),r.categoryLabels),o=(o&&t&&D.updateLabelSettingsFromLabelsObject(o,t,void 0,a),!1),o=i?e&&w.hasGradientRoleInMatrix(e.matrix):e&&w.hasGradientRole(e.categorical),t=(s.fillPoint=J.DataViewObjects.getValue(r,Y.fillPoint.show,o),s.fillPointStyle=J.DataViewObjects.getValue(r,Y.fillPoint.style,n.fillStyle.fillOnly),s.colorBorder=J.DataViewObjects.getValue(r,Y.colorBorder.show,!1),s.colorByCategory=J.DataViewObjects.getValue(r,Y.colorByCategory.show,!1),s.bubbleSizeMultiplier=d.getBubbleSizeMultiplier(J.DataViewObjects.getValue(r,Y.bubbles.bubbleSize)),s.markerShape=J.DataViewObjects.getValue(r,Y.bubbles.markerShape,Q.markerShape.circle),s.markerShapeShowAllSeries=j.getValue(r,Y.bubbles.showSeries,!0),b.create(a)),i=(s.plotAreaShadingSettings={show:J.DataViewObjects.getValue(r,Y.plotAreaShading.show,G.DefaultPlotAreaShadingSettings.show),upperShadingColor:h(t,r,Y.plotAreaShading.upperShadingColor,G.DefaultPlotAreaShadingSettings.upperShadingColor),lowerShadingColor:h(t,r,Y.plotAreaShading.lowerShadingColor,G.DefaultPlotAreaShadingSettings.lowerShadingColor),transparency:J.DataViewObjects.getValue(r,Y.plotAreaShading.transparency,G.DefaultPlotAreaShadingSettings.transparency)},c.getDefaultScatterRatioLineSettings(a));return s.ratioLineSettings={show:J.DataViewObjects.getValue(r,Y.ratioLine.show,i.show),lineColor:h(t,r,Y.ratioLine.lineColor,i.lineColor),transparency:J.DataViewObjects.getValue(r,Y.ratioLine.transparency,i.transparency),style:J.DataViewObjects.getValue(r,Y.ratioLine.style,i.style)},s.dataVolume=J.DataViewObjects.getValue(r,Y.general.dataVolume,G.DefaultDataVolume),s.categoryAxisType=J.DataViewObjects.getValue(r,l.categoryAxis.axisType),s.xValuesTreatNullsAsZero=J.DataViewObjects.getValue(r,Y.categoryAxis.treatNullsAsZero,!1),s.yValuesTreatNullsAsZero=J.DataViewObjects.getValue(r,Y.valueAxis.treatNullsAsZero,!1),s}function h(e,t,i,a){return{solid:{color:e.getColorForPropertyWithDefaultColor(t,i,a?a.solid.color:void 0)}}}function F(e,t){for(var i=0,a=e.levels.length;i<a;i++){var r=e.levels[i],s=_.chain(r.sources).map(function(e,t){return{levelSource:e,index:t}}).filter(function(e){return C.hasRole(e.levelSource,t)}).map(function(e){return e.index}).value();if(!_.isEmpty(s))return{levelIndex:i,levelSourceIndices:s,column:r.sources[_.first(s)]}}}function $(e){var t=[],i=e.cols;return!e.xGroupMetadata&&i.x&&t.push(i.x.queryName),!e.yGroupMetadata&&i.y&&t.push(i.y.queryName),i.size&&t.push(i.size.queryName),t}return{scatterConverter:t}}}(powerbi=powerbi||{}),function(k){var r=k.visuals.D3Helper;k.scatterChartRendererModuleFactory=function(){var e=k.visuals,P=e.CartesianHelper,t=jsCommon.CssConstants.createClassAndSelector,d=k.visuals.DataDirection,o=e.LineStyle,L=e.PlayChart,M=e.ScatterChart,u=k.visuals.SetFocusRingClassName,V=e.SVGUtil,h=t("scatterMarker"),l=t("mainGraphicsContext"),p=t("scatterMarkerSeriesGroup"),n=t("plotAreaShadingLayer"),c=t("upperShadingArea"),g=t("lowerShadingArea"),y=t("ratioLineLayer"),m=t("ratioLine"),T=(f.prototype.init=function(e,t,i,a,r,s,o,n){this.axisGraphicsContext=e,this.mainGraphicsG=e.append("g").classed(l.class,!0),i&&(this.mainGraphicsBackgroundRect=this.mainGraphicsG.append("rect").classed("backgroundRect",!0).attrs({width:"100%",height:"100%"})),this.mainGraphicsContext=this.mainGraphicsG.append("svg"),this.tooltipsEnabled=a,this.tooltipService=r,this.eventManager=n,this.mainGraphicsContext.attr("stroke-width","1"),s&&(e=jsCommon.BrowserUtils.isInternetExplorerOrEdge(),this.mainGraphicsContext.attr("tabindex",0).attr("focusable","true").attr("aria-label",o.getLocalizedString("Visual_Plot")).classed(u,!e))},f.prototype.markersHaveChanged=function(e){var t=_.map(e.data.dataPointSeries,function(e){return e.markerShape}),i=this.previousMarkers;if(i)for(var a=0,r=Math.min(t.length,i.length);a<r;a++)if(t[a]!==i[a])return this.previousMarkers=t,!0;return this.previousMarkers=t,!1},f.prototype.render=function(e,t,i,a){var r=e.plotArea,s=jsCommon.BrowserUtils.isInternetExplorerOrEdge();return this.mainGraphicsContext.attrs({width:r.width,height:r.height}).classed(u,!s&&!!t),this.drawRatioLine(e,a),this.drawShadedBackground(e),r=e.suppressDataPointRendering?this.removeScatterMarkers():0<e.animationDuration&&!this.markersHaveChanged(e)?this.drawScatterMarkers(e,t):this.drawScatterMarkersNoAnimation(e,e.drawBubbles,t),e.drawBubbles&&r.order(),this.tooltipsEnabled&&this.tooltipService.addTooltip(this.mainGraphicsContext,function(e){return e.data&&e.data.tooltipInfo()},function(e){return e.data&&e.data.identity&&[e.data.identity]}),V.flushAllD3TransitionsIfNeeded(e.animationOptions),this.numSeries=e.data.dataPointSeries.length,this.scatterChartDataPoints=e.allData.dataPoints,{dataPointsSelection:r,eventGroup:this.mainGraphicsG,data:e.data,fillMarkers:e.fillMarkers,root:this.mainGraphicsContext,visualInstanceId:i.instanceId,eventManager:this.eventManager}},f.prototype.getNextDataPoint=function(t,i,e){var a=this.mainGraphicsContext.selectAll(h.selector),r=this.scatterChartDataPoints,s=t,o=i;switch(e){case d.PreviousCategory:case d.NextCategory:var n=e===d.PreviousCategory?-1:1,l=_.sortBy(_.filter(r,function(e){return e.seriesIndex===i}),"categoryIndex"),c=n+_.findIndex(l,function(e){return e.categoryIndex===t});c>=l.length||c<0?(u=this.rollToNextSeries(r,i,e),s=u[0],o=u[1]):s=l[c].categoryIndex;break;case d.PreviousSeries:case d.NextSeries:n=e===d.PreviousSeries?-1:1,l=_.sortBy(_.filter(r,function(e){return e.categoryIndex===t}),"seriesIndex");var u=n+_.findIndex(l,function(e){return e.seriesIndex===i}),o=u>=l.length||u<0?(c=this.rollToNextCategory(r,t,e),s=c[0],c[1]):l[u].seriesIndex}return{element:a.filter(function(e,t){return e.seriesIndex===o&&e.categoryIndex===s}).node(),targetCategoryIndex:s}},f.prototype.rollToNextSeries=function(e,t,i){i!==d.PreviousCategory&&d.NextCategory;for(var a,r=i===d.PreviousCategory?-1:1,i=i===d.PreviousCategory?_.last:_.first;_.isEmpty(a);)(t+=r)>=this.numSeries?t=0:t<0&&(t=this.numSeries-1),a=_.sortBy(_.filter(e,function(e){return e.seriesIndex===t}),function(e){return e.categoryIndex});return[i(a).categoryIndex,t]},f.prototype.rollToNextCategory=function(e,t,i){i!==d.PreviousSeries&&d.NextSeries;for(var a,r=d3.max(e,function(e){return e.categoryIndex})+1,s=i===d.PreviousSeries?-1:1,i=i===d.PreviousSeries?_.last:_.first;_.isEmpty(a);)r<=(t+=s)?t=0:t<0&&(t=r-1),a=_.sortBy(_.filter(e,function(e){return e.categoryIndex===t}),function(e){return e.seriesIndex});i=i(a).seriesIndex;return[t,i]},f.prototype.getFirstElement=function(){return{element:this.mainGraphicsContext.selectAll(h.selector).node()}},f.prototype.createTraceLineRenderer=function(e){return new i(e,this.mainGraphicsContext,this.tooltipsEnabled,this.tooltipService)},f.prototype.drawShadedBackground=function(e){var t,i,a,r=e.data.plotAreaShadingSettings||M.DefaultPlotAreaShadingSettings,s=this.axisGraphicsContext.select(n.selector);r.show&&e.supportsPlotAreaSymmetryShading?((s=s.empty()?this.axisGraphicsContext.insert("svg",":first-child").classed(n.class,!0).style("pointer-events","none"):s).attrs({height:e.plotArea.height,width:e.plotArea.width}),a=e.xAxisProperties.scale,e=e.yAxisProperties.scale,t=a.domain(),i=e.domain(),i=[{x:a((t=[Math.min(t[0],i[0]),Math.max(t[1],i[1])])[0]),y:e(t[0])},{x:a(t[1]),y:e(t[1])}],a=r.show?[[{x:i[0].x,y:i[0].y},{x:i[0].x,y:i[1].y}],[{x:i[1].x,y:i[1].y},{x:i[1].x,y:i[1].y}]]:[],this.drawArea(c,s,a,r.upperShadingColor,r.transparency),e=r.show?[[{x:i[0].x,y:i[0].y},{x:i[0].x,y:i[0].y}],[{x:i[1].x,y:i[0].y},{x:i[1].x,y:i[1].y}]]:[],this.drawArea(g,s,e,r.lowerShadingColor,r.transparency)):s.empty()||s.remove()},f.prototype.drawRatioLine=function(e,t){var i,a,r,s,o,n,l,t=e.data.ratioLineSettings||P.getDefaultScatterRatioLineSettings(t),c=this.axisGraphicsContext.select(y.selector);t.show?((c=c.empty()?this.axisGraphicsContext.append("svg").classed(y.class,!0):c).attrs({height:e.plotArea.height,width:e.plotArea.width}),i=e.xAxisProperties.scale,a=e.yAxisProperties.scale,r=i.domain(),s=a.domain(),o=e.data.xSubtotal,e=e.data.ySubtotal,l=[],t.show&&_.isFinite(o)&&_.isFinite(e)&&(0!==o&&0!==e?(n=e/o,l=[{x:i(r[0]),y:a(r[0]*n)},{x:i(r[1]),y:a(r[1]*n)}]):0!==e?l=[{x:i(0),y:a(s[0])},{x:i(0),y:a(s[1])}]:0!==o&&(l=[{x:i(r[0]),y:a(0)},{x:i(r[1]),y:a(0)}])),this.drawLine(m,c,l,t)):c.empty()||c.remove()},f.prototype.removeScatterMarkers=function(){return this.mainGraphicsContext.selectAll(p.selector).remove(),this.mainGraphicsContext.selectAll(h.selector)},f.getXOfFirstCategory=function(e){if(e.hasCategoricalAxis){e=e.xAxisProperties.scale;if(r.isScaleBand(e))return e.bandwidth()/2}return 0},f.prototype.drawScatterMarkers=function(i,e){var a=i.data,r=i.xAxisProperties.scale,s=i.yAxisProperties.scale,o=i.hasCategoricalAxis,n=f.getXOfFirstCategory(i),t=[{identityKey:"",dataPoints:a.dataPoints}],t=this.mainGraphicsContext.selectAll(p.selector).data(t,function(e){return e.identityKey}),l=t.enter().append("g").attrs({"aria-multiselectable":"true",role:"listbox"}).classed(p.class,!0).merge(t),t=(t.exit().remove(),l.selectAll(h.selector).data(function(e){return e.dataPoints},function(e){return e.renderIdentity.getKey()})),l=jsCommon.BrowserUtils.isInternetExplorerOrEdge(),l=t.enter().append("path").classed(h.class,!0).classed(u,!l&&!!e).style("opacity",0).attrs({transform:function(e){return V.translate(r(o?e.categoryIndex:e.x)+n,s(e.y))},tabindex:e?0:null,focusable:!!e||null,role:"option","aria-selected":function(e){return e.selected}}).merge(t);return l.styles({"stroke-opacity":function(e){return M.getMarkerStrokeOpacity(null!=e.size,a.colorBorder,i.hasSelection,e.selected)},stroke:function(e){return M.getStrokeFill(e,a.colorBorder)},fill:function(e){return e.fill},"fill-opacity":function(e){return M.getMarkerFillOpacity(null!=e.size,i.fillMarkers,i.hasSelection,e.selected)}}).transition().ease(i.easeType).duration(i.animationDuration).style("opacity",1).attrs({d:function(e){var t=P.getBubbleRadius(e.radius,a.sizeRange,i.plotArea,a.multiplier);return e.geometry=e.geometry||{},e.geometry.size=t,e.geometry.markerShape=a.markerShape,k.visuals.Markers.getPathWithRadius(e.markerShape,t)},transform:function(e){var t=r(o?e.categoryIndex:e.x)+n,i=s(e.y);return e.geometry=e.geometry||{},e.geometry.x=t,e.geometry.y=i,e.geometry.markerShape=a.markerShape,V.translate(t,i)}}),t.exit().transition().ease(i.easeType).duration(i.animationDuration).style("opacity",0).attr("r",0).remove(),l},f.prototype.drawScatterMarkersNoAnimation=function(s,e,i){var o=s.data,a=s.xAxisProperties.scale,n=s.yAxisProperties.scale,l=s.hasCategoricalAxis,c=f.getXOfFirstCategory(s),t=(e=e?(e=[{identityKey:"",dataPoints:o.dataPoints}],this.mainGraphicsContext.selectAll(p.selector).data(e,function(e){return e.identityKey})):this.mainGraphicsContext.selectAll(p.selector).data(o.dataPointSeries,function(e){return e.identityKey})).enter().append("g").attrs({"aria-multiselectable":"true",role:"listbox"}).classed(p.class,!0).merge(e);return e.exit().remove(),t.each(function(e){var r=M.getSeriesStyle(e.hasSize,o.colorBorder,s.hasSelection,s.fillMarkers,e.fill),t=d3.select(this),t=(v(this,r),t.selectAll(h.selector).data(e.dataPoints,function(e){return e.renderIdentity.getKey()})),e=(t.interrupt(),t.enter().append("path").classed(h.class,!0).merge(t)),t=(t.exit().remove(),e.each(function(e){var e=M.getMarkerStyle(e,o.colorBorder,s.hasSelection,s.fillMarkers),t=e,i=r;if(i)for(var a in t)t[a]===i[a]&&(t[a]=null);v(this,e)}),jsCommon.BrowserUtils.isInternetExplorerOrEdge());e.classed(u,!t&&!!i).attrs({d:function(e){var t=P.getBubbleRadius(e.radius,o.sizeRange,s.plotArea,o.multiplier);return e.geometry=e.geometry||{},e.geometry.size=t,e.geometry.markerShape=o.markerShape,k.visuals.Markers.getPathWithRadius(e.markerShape,t)},transform:function(e){var t=a(l?e.categoryIndex:e.x)+c,i=n(e.y);return e.geometry=e.geometry||{},e.geometry.x=t,e.geometry.y=i,e.geometry.markerShape=o.markerShape,V.translate(t,i)},tabindex:i?0:null,focusable:!!i||null,role:"option","aria-selected":function(e){return e.selected}}).style("opacity",null)}),this.mainGraphicsContext.selectAll(h.selector)},f.prototype.drawLine=function(e,t,i,a){var r={},s=(r.stroke=a.lineColor.solid.color,r["stroke-width"]=2,r["stroke-opacity"]=(100-a.transparency)/100,r["stroke-dasharray"]=o.getStrokeDashArrayFromLineStyle(a.style),r["stroke-linecap"]=o.getStrokeLineCapFromLineStyle(a.style),r.fill="none",r["stroke-width"]="3px",d3.line().x(function(e){return e.x}).y(function(e){return e.y})),a=t.selectAll(e.selector).data([i]);return a.enter().append("path").classed(e.class,!0).merge(a).attr("d",function(e){return s(e)}).styles(r),a.exit().remove(),t},f.prototype.drawArea=function(e,t,i,a,r){var s=d3.area().x0(function(e){return e[0].x}).y0(function(e){return e[0].y}).x1(function(e){return e[1].x}).y1(function(e){return e[1].y}),t=t.selectAll(e.selector).data([i]);t.enter().append("path").classed(e.class,!0).merge(t).attr("d",function(e){return s(e)}).styles({fill:a.solid.color,"fill-opacity":(100-r)/100}),t.exit().remove()},f);function f(){}var F=t("traceLine"),I=t("traceBubble"),i=(a.prototype.remove=function(){this.element.selectAll(F.selector).remove(),this.element.selectAll(I.selector).remove()},a.prototype.render=function(a,e){var t=this.viewModel,i=t.data.currentViewModel,r=t.viewModel,s=[];if(_.isEmpty(a)||r.suppressDataPointRendering)this.remove();else{for(var o=t.data.currentFrameIndex,n=[],l=0,c=a.length;l<c;l++){s[l]=[],n[l]=!1;for(var u=0,d=t.data.allViewModels.length;u<d&&u<=o;u++){var h=_.find(t.data.allViewModels[u].dataPoints,function(e,t){var i=a[l];return i.renderIdentity?e.renderIdentity.getKey()===i.renderIdentity.getKey():e.identity.getKey()===a[l].identity.getKey()});null!=h&&(h.frameIndex=u,s[l].push(h),u===o&&(n[l]=!0))}}for(var p=r.xAxisProperties.scale,g=r.yAxisProperties.scale,y=d3.line().x(function(e){return p(e.x)}).y(function(e){return g(e.y)}).defined(function(e){return null!==e.x&&null!==e.y}),m=this.element.selectAll(F.selector).data(a,function(e){return e.renderIdentity.getKey()}),f=m.enter().append("path").classed(F.class,!0).merge(m),v=[],S=[],x=!1,b=(f.each(function(e,t){var i=this.hasAttribute("d")?this.getTotalLength():0,a=(v.push(i),$("<svg><path></path></svg>")),a=$("path",a),t=(a.attr("d",y(s[t])),0<s[t].length?a.get()[0].getTotalLength():0);S.push(t),x=x||t<i}),x?e?f.transition().ease(d3.easeLinear).duration(L.getFrameAnimationDuration()).attr("stroke-dashoffset",function(e,t){return v[t]-S[t]}).transition().ease(d3.easeLinear).duration(1).delay(0).style("stroke",function(e){return M.getStrokeFill(e,!0)}).attrs({d:function(e,t){return y(s[t])},"stroke-dasharray":function(e,t){return S[t]+" "+S[t]},"stroke-dashoffset":0}):f.style("stroke",function(e){return M.getStrokeFill(e,!0)}).attrs({d:function(e,t){return y(s[t])},"stroke-dasharray":function(e,t){return S[t]+" "+S[t]},"stroke-dashoffset":0}):(f.style("stroke",function(e){return M.getStrokeFill(e,!0)}).attrs({d:function(e,t){return y(s[t])},"stroke-dasharray":function(e,t){return S[t]+" "+S[t]},"stroke-dashoffset":function(e,t){return S[t]-v[t]}}),(e?f.transition().ease(d3.easeLinear).duration(L.getFrameAnimationDuration()):f).attr("stroke-dashoffset",0)),m.exit().remove(),T.getXOfFirstCategory(r)),C=r.hasCategoricalAxis,w=[],D=0;D<s.length;D++)var A=s[D],A=n[D]?A.slice(0,A.length-1):A,w=w.concat(A);e=this.element.selectAll(I.selector).data(w,function(e){return e.renderIdentity.getKey()+e.x+e.y+e.size}),f=e.enter().append("path").style("opacity",0).classed(I.class,!0).merge(e);f.attrs({d:function(e){return k.visuals.Markers.getPathWithRadius(e.markerShape,P.getBubbleRadius(e.radius,r.data.sizeRange,r.plotArea,r.data.multiplier))},transform:function(e){return V.translate(p(C?e.categoryIndex:e.x)+b,g(e.y))}}).styles({"stroke-opacity":function(e){return M.getBubbleOpacity(e,!0)},stroke:function(e){return M.getStrokeFill(e,i.colorBorder)},fill:function(e){return e.fill},"fill-opacity":function(e){return null!=e.size?.2+e.frameIndex/o*.6:0}}).transition().ease(d3.easeLinear).duration(L.getFrameAnimationDuration()).style("opacity",1),e.exit().transition().ease(d3.easeLinear).duration(L.getFrameAnimationDuration()).style("opacity",0).remove(),this.tooltipsEnabled&&this.tooltipService.addTooltip(f,function(e){return e.data&&e.data.tooltipInfo()},function(e){return e.data&&e.data.identity&&[e.data.identity]}),f.sort(function(e,t){return t.size-e.size})}},a);function a(e,t,i,a){this.viewModel=e,this.element=t,this.tooltipsEnabled=i,this.tooltipService=a}function v(e,t){for(var i in t){var a=e.style[i],r=t[i];if(null==r){if(""===a)continue}else if((r=r.toString())===a)continue;e.style[i]=r}}return{create:function(){return new T}}}}(powerbi=powerbi||{}),function(w){!function(b){var g,C,a=jsCommon.Color;function y(e){e&&(this.tooltipsEnabled=e.tooltipsEnabled,this.interactivityService=e.interactivityService,this.playAxisDataColorsEnabled=e.featureSwitches.playAxisDataColors,this.viewModelAdapterFactory=e.viewModelAdapterFactory,this.isScrollable=e.isScrollable),this.renderer=w.scatterChartRendererModuleFactory().create()}y.prototype.initData=function(e){this.dataInitOptions=e,this.style=e.style,this.element=e.element,this.currentViewport=e.viewport,this.hostService=e.host,this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.tooltipService=e.services.tooltips,this.featureSwitches=e.featureSwitches,this.animationOptions=e.animation},y.prototype.initRenderer=function(e){this.animator=e.animator,this.colors=this.style.colorPalette.dataColors,this.cartesianVisualHost=e.cartesianHost;var t=this.svg=e.svg;t.classed(y.ClassName+" "+b.PlayChart.ClassName,!0),this.renderer.init(t,e.labelsContext,this.isMobileChart,this.tooltipsEnabled,this.tooltipService,this.interactivityService,this.hostService,e.eventManager),y.DefaultPlotAreaShadingSettings.upperShadingColor={solid:{color:b.ColorHelper.getDataColorByIndex(this.style,3)}},y.DefaultPlotAreaShadingSettings.lowerShadingColor={solid:{color:b.ColorHelper.getDataColorByIndex(this.style,5)}}},y.createLazyFormattedCategory=function(e,t){return new jsCommon.Lazy(function(){return e.format(t)})},y.createLazyFormattedLazyValue=function(e,t){return new jsCommon.Lazy(function(){return e.format(t())})},y.getMeasureValue=function(e,t){return 0<=e?t[e]:null},y.getDefaultData=function(e){return{xCol:void 0,yCol:void 0,hasCategory:void 0,dataPoints:[],dataPointSeries:[],legendData:b.Legend.getDefaultLegendData(e),axesLabels:{x:"",y:""},sizeRange:{min:void 0,max:void 0},dataLabelsSettings:b.DataLabelViewModel.getDefaultPointLabelSettings(e,"smallLightLabel"),hasDynamicSeries:!1,plotAreaShadingSettings:y.DefaultPlotAreaShadingSettings,ratioLineSettings:b.CartesianHelper.getDefaultScatterRatioLineSettings(e),markerShape:b.markerShape.circle,dataVolume:y.DefaultDataVolume,multiplier:b.shapeUtil.MinBubbleMultiplier}},y.prototype.renderAtFrame=function(e){this.data=this.originalData=e,this.viewModelAdapterFactory&&this.originalData&&(e=this.viewModelAdapter=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport}),this.data=e.getData()),this.cartesianVisualHost.triggerRender(!1)},y.prototype.setData=function(e){var a,r,t,i=this;this.data=y.getDefaultData(this.style),this.playAxis&&this.playAxis.isCurrentlyPlaying()&&this.playAxis.stop(),0<e.length?(e=e[0]||e[1])&&(this.categoryAxisProperties=b.CartesianHelper.getCategoryAxisProperties(e.metadata,!0),this.valueAxisProperties=b.CartesianHelper.getValueAxisProperties(e.metadata,!0),this.dataView=e,a={viewport:this.currentViewport,colors:this.colors,interactivityService:this.interactivityService,categoryAxisProperties:this.categoryAxisProperties,valueAxisProperties:this.valueAxisProperties,style:this.style,tooltipsEnabled:this.tooltipsEnabled,useMatrixDV:!0},r=b.scatterChartConverterModuleFactory(),b.PlayChart.isDataViewPlayable(e)?(this.playAxis||(this.playAxis=new b.PlayAxis({interactivityService:this.interactivityService,isScrollable:!1,featureSwitches:{}}),this.dataView&&b.PlayChart.isDataViewPlayable(this.dataView)&&(this.playAxis,this.playAxis.initData(this.dataInitOptions))),a.useMatrixDV=!1,t=this.playAxis.setData(e,function(e,t,i){return r.scatterConverter(e,a,t,i)}),this.mergeSizeRanges(t),this.data=t.currentViewModel,this.playAxis.setRenderFunction(function(e){return i.renderAtFrame(e)})):(this.playAxis&&(this.playAxis.remove(),this.playAxis=null),(t=r.scatterConverter(e,a))&&(this.data=t))):this.playAxis&&(this.playAxis.remove(),this.playAxis=null),this.originalData=this.data},y.prototype.mergeSizeRanges=function(e){if(e&&e.currentViewModel){for(var t=e.currentViewModel.sizeRange,i=0,a=e.allViewModels;i<a.length;i++){var r=a[i].sizeRange;null!=r.min&&(t.min=Math.min(t.min,r.min)),null!=r.max&&(t.max=Math.max(t.max,r.max))}for(var s=0,o=e.allViewModels;s<o.length;s++)o[s].sizeRange=t}},y.prototype.calculateCustomLegend=function(){return this.data&&this.data.legendData},y.prototype.hasLegend=function(){return this.data&&this.data.hasDynamicSeries},y.prototype.enumerateObjectInstances=function(e,t){var i=this.originalData;switch(t.objectName){case"colorByCategory":!i||i.hasDynamicSeries||e.pushInstance({objectName:"colorByCategory",selector:null,properties:{show:i.colorByCategory}});break;case"dataPoint":if(this.playAxisDataColorsEnabled&&this.playAxis&&this.dataView){if(!b.GradientUtils.hasGradientRoleInMatrix(this.dataView.matrix))return this.playAxis.enumerateDataPoints(e,this.data,this.dataView,this.style)}else if(!this.playAxis&&this.dataView&&!b.GradientUtils.hasGradientRoleInMatrix(this.dataView.matrix))return this.enumerateDataPoints(e);break;case"categoryAxis":e.pushInstance({selector:null,properties:{showAxisTitle:!this.categoryAxisProperties||null==this.categoryAxisProperties.showAxisTitle||this.categoryAxisProperties.showAxisTitle},objectName:"categoryAxis"}),i.xGroupMetadata||e.pushInstance({selector:null,properties:{treatNullsAsZero:!(!i.treatNullsAsZero||!i.treatNullsAsZero.x)},objectName:"categoryAxis"});break;case"valueAxis":e.pushInstance({selector:null,properties:{showAxisTitle:!this.valueAxisProperties||null==this.valueAxisProperties.showAxisTitle||this.valueAxisProperties.showAxisTitle},objectName:"valueAxis"}),i.yGroupMetadata||e.pushInstance({selector:null,properties:{treatNullsAsZero:!(!i.treatNullsAsZero||!i.treatNullsAsZero.y)},objectName:"valueAxis"});break;case"categoryLabels":if(this.isXAxisCategorical())return;this.data?b.DataLabelViewModel.enumerateCategoryLabels(e,i.dataLabelsSettings,!0,this.featureSwitches,void 0,void 0,this.style):b.DataLabelViewModel.enumerateCategoryLabels(e,null,!0,this.featureSwitches,void 0,void 0,this.style);break;case"fillPoint":if(i.hasSize)return;e.pushInstance({objectName:"fillPoint",selector:null,properties:{show:i.fillPoint}});break;case"colorBorder":i.hasSize&&e.pushInstance({objectName:"colorBorder",selector:null,properties:{show:i.colorBorder}});break;case"bubbles":y.enumerateBubbles(e,i,this.dataView);break;case"plotAreaShading":this.isPlotSymettryShadingSupported()?e.pushInstance({selector:null,objectName:"plotAreaShading",properties:{show:i.plotAreaShadingSettings.show,upperShadingColor:i.plotAreaShadingSettings.upperShadingColor,lowerShadingColor:i.plotAreaShadingSettings.lowerShadingColor,transparency:i.plotAreaShadingSettings.transparency}}):e.pushInstance({selector:null,objectName:"plotAreaShading",properties:{},disabledReason:this.hostService.getLocalizedString("Visual_Scatter_SymmetryShadingNotSupported")});break;case"ratioLine":i.xCol&&i.yCol&&i.xCol.isMeasure&&i.yCol.isMeasure&&e.pushInstance({selector:null,objectName:"ratioLine",properties:{show:i.ratioLineSettings.show,lineColor:i.ratioLineSettings.lineColor,transparency:i.ratioLineSettings.transparency,style:i.ratioLineSettings.style}});break;case"general":!i||this.playAxis||this.isXAxisCategorical()||e.pushInstance({selector:null,objectName:"general",properties:{dataVolume:i.dataVolume},validValues:{dataVolume:{numberRange:{min:y.DefaultDataVolume,max:y.MaximumDataVolume}}}})}},y.prototype.resolveFormattingPlaceholder=function(e){if(b.builder.isVisualFormattingSlicePlaceholder(e))return"dataVolume"!==e.name?void 0:this.getDataVolumeSlice()},y.prototype.getDataVolumeSlice=function(){var e,t=this,i=this.originalData;if(i&&!this.playAxis&&!this.isXAxisCategorical())return e=b.scatterChartProps.general,{item:new b.builder.SimpleFormattingSliceBuilder({uidBuilder:new b.builder.FormattingSliceUidBuilder(new b.builder.FormattingGroupUidBuilder(new b.builder.FormattingCardUidBuilder("visualPlaceholderCard"),"visualPlaceholderGroup"),"dataVolume"),control:new b.builder.NumUpDownBuilder({descriptor:e.dataVolume,value:i.dataVolume,options:{minValue:{type:0,value:y.DefaultDataVolume},maxValue:{type:1,value:y.MaximumDataVolume}}}).build(),localize:function(e){return t.hostService.getLocalizedString(e)}}).withCustomDisplayName("Visual_DataVolumeModern").build(),revertToDefaultDescriptors:[e.dataVolume]}},y.prototype.enumerateDataPoints=function(e){var t=this.originalData;t&&(t.hasDynamicSeries?w.colorEnumerationHelperModuleFactory().enumerateSeriesDataColors({enumeration:e,dataPoints:b.LegendData.toIEnumerableDataPoints(t.legendData)},this.featureSwitches):w.colorEnumerationHelperModuleFactory().enumerateCategoryDataColors({enumeration:e,dataView:this.dataView,style:this.style,categories:_.map(t.dataPoints,function(e){return{color:e.fill,displayName:e.formattedCategory.getValue(),identity:e.identity}}),fillInstanceKind:3},this.featureSwitches))},y.enumerateBubbles=function(e,t,i){1<t.dataPointSeries.length&&(a=w.DataViewObjects.getValue(i&&i.metadata&&i.metadata.objects,b.scatterChartProps.bubbles.showSeries,!1));var a,i={selector:null,properties:{bubbleSize:b.shapeUtil.invertBubbleSizeMultiplier(t.multiplier),markerShape:t.markerShape},validValues:{bubbleSize:{numberRange:{min:-30,max:100}},markerShape:[b.markerShape.circle,b.markerShape.square,b.markerShape.diamond,b.markerShape.triangle]},objectName:b.scatterChartProps.bubbles.markerShape.objectName};if(null!=a&&(i.properties[b.scatterChartProps.bubbles.showSeries.propertyName]=a),e.pushInstance(i),a)for(var r=0,s=t.dataPointSeries.length;r<s;r++){var o=t.dataPointSeries[r];e.pushContainer({displayName:o.name}),e.pushInstance({selector:w.data.Selector.normalizeSelector(o.identity.getSelector()),properties:{markerShape:o.markerShape},validValues:{markerShape:[b.markerShape.circle,b.markerShape.square,b.markerShape.diamond,b.markerShape.triangle]},objectName:b.scatterChartProps.bubbles.markerShape.objectName}),e.popContainer()}},y.prototype.getMarkersCard=function(t){var r,s,e,o,n=this,l=this.originalData;if(l&&l.dataPointSeries&&0!==l.dataPointSeries.length)return r=w.DataViewObjects.getValue(this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects,b.scatterChartProps.bubbles.showSeries,!0),s=function(e){return n.hostService.getLocalizedString(e)},e=[b.scatterChartObjectProps.bubbles.markerShape,b.scatterChartObjectProps.bubbles.bubbleSize,b.scatterChartObjectProps.bubbles.showSeries,b.scatterChartObjectProps.fillPoint.show,b.scatterChartObjectProps.fillPoint.style,b.scatterChartObjectProps.dataPoint.fill,b.scatterChartObjectProps.dataPoint.showAllDataPoints,b.scatterChartObjectProps.dataPoint.defaultColor,b.scatterChartObjectProps.colorByCategory.show,b.scatterChartObjectProps.categoryAxis.preferredCategoryWidth,b.scatterChartObjectProps.categoryAxis.innerPadding,b.scatterChartObjectProps.colorBorder.show],e=new b.builder.FormattingCardBuilder(new b.builder.FormattingCardUidBuilder("markers"),"Visual_Markers",e,s),o={styleProps:{markerShape:b.scatterChartObjectProps.bubbles.markerShape,markerSize:b.scatterChartObjectProps.bubbles.bubbleSize,fillPointShow:b.scatterChartObjectProps.fillPoint.show,fillPointStyle:b.scatterChartObjectProps.fillPoint.style,showSeries:b.scatterChartObjectProps.bubbles.showSeries,colorBorder:b.scatterChartObjectProps.colorBorder.show},style:{markerShape:l.markerShape,fillPointShow:l.fillPoint,fillPointStyle:l.fillPointStyle,markerSize:b.shapeUtil.invertBubbleSizeMultiplier(l.multiplier),showSeries:r,colorBorder:l.colorBorder},selector:null,hasSize:l.hasSize,showSeries:r},e.addGroup("applySettingsTo",function(e){e.withContainerDisabled(!r).withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(e){if(e.withDisplayName("Series"),e.addContainerItem("all",s("All"),function(e){var t;b.MarkerProperties.addScatterChartMarkersFormattingContainers(o,e,n.featureSwitches),r||(t=[b.scatterChartObjectProps.bubbles.markerShape],e.addSimpleSlice("showSeriesLink",function(){return new b.builder.SeriesDialogLinkBuilder({descriptor:b.scatterChartObjectProps.bubbles.showSeries,value:function(){},ariaLabel:"Enable_This_Setting",type:"SeriesDialogLink",resetToDefaultDescriptors:t,warningIcon:!0}).build()},function(e){return e.withCustomDisplayName("Enable_This_Setting").withSuppressDisplayName(!0)}))}),1<l.dataPointSeries.length)for(var t=0,i=l.dataPointSeries;t<i.length;t++){var a=i[t];o=__assign(__assign({},o),{style:__assign(__assign({},o.style),{markerShape:a.markerShape}),selector:w.data.Selector.normalizeSelector(a.identity.getSelector())}),e.addContainerItem(a.name,a.name,function(e){return b.MarkerProperties.addScatterChartMarkersFormattingContainers(o,e,n.featureSwitches)})}})}),e.addGroup("colors",function(e){var t;if(e.withDisplayName("Generic_Color"),l.hasDynamicSeries||e.addSimpleSlice("colorByCategory",new b.builder.ToggleSwitchBuilder({descriptor:__assign(__assign({},b.scatterChartObjectProps.colorByCategory.show),{selector:null}),value:l.colorByCategory}).build(),function(e){return e.withCustomDisplayName("Visual_ColorByCategory")}),l.hasDynamicSeries)return t={groupBuilder:e,dataPoints:b.LegendData.toIEnumerableDataPoints(l.legendData),seriesColorProps:b.scatterChartObjectProps.dataPoint,localize:s,featureSwitches:n.featureSwitches},w.colorEnumerationHelperModuleFactory().appendSeriesColorSlicesToGroup(t);t={groupBuilder:e,colorProps:b.columnChartProps.dataPoint,featureSwitches:n.featureSwitches,hostService:n.hostService,options:{dataView:n.dataView,style:n.style,categories:_.map(l.dataPoints,function(e){return{color:e.fill,displayName:e.formattedCategory.getValue(),identity:e.identity}}),fillInstanceKind:3}},w.colorEnumerationHelperModuleFactory().appendCategoryColorSlicesToGroup(t)}),this.isXAxisCategorical()&&e.addGroup("spacing",function(e){e.withDisplayName("RibbonChart_SeriesGapWidth").addSimpleSlice("innerPadding",new b.builder.SliderBuilder({descriptor:b.scatterChartObjectProps.categoryAxis.innerPadding,value:100*t.categoryAxisData.innerPadding,localize:s,options:{minValue:{type:0,value:0},maxValue:{type:1,value:50}}}).build()).addSimpleSlice("maxcategoryWidth",new b.builder.NumUpDownBuilder({descriptor:b.scatterChartObjectProps.categoryAxis.preferredCategoryWidth,value:Math.round(100*t.categoryAxisData.maxMarginFactor),options:{minValue:{type:0,value:20},maxValue:{type:1,value:180}}}).build(),function(e){return e.withCustomDisplayName("Visual_Max_CategoryWidth")})}),e.build()},y.prototype.getCategoryLabelsCard=function(){var e,t,i=this;if(!this.isXAxisCategorical())return e=b.scatterChartObjectProps.categoryLabels,e=__assign(__assign({},e),{fontFamily:e.fontFamily,fontSize:e.fontSize,show:e.show}),t=this.data?this.data.dataLabelsSettings:null,b.DataLabelViewModel.getCategoryLabelsCard({cardName:"Visual_CategoryLabel",dataLabelSettings:t,isShowCategory:void 0,localize:function(e){return i.hostService.getLocalizedString(e)},props:e,revertToDefaultProps:b.scatterChartObjectProps.categoryLabels,showBackground:!0,showValueColor:!0,style:this.style,featureSwitches:this.featureSwitches})},y.prototype.customizeFormattingCard=function(e){var t;return b.builder.isPlaceholder(e)||("categoryAxis"===e.uid&&(t=this.getCustomizedCategoryAxisCard(e)),"valueAxis"===e.uid&&(t=this.getCustomizedValueAxisCard(e))),t},y.prototype.getCustomizedCategoryAxisCard=function(e){var i=this,a=__spreadArray([],e.groups);return a.forEach(function(e,t){b.builder.isPlaceholder(e)||"categoryAxis-valuesScalar"===e.uid&&(a[t]=i.getNewValuesGroup(e,!0))}),__assign(__assign({},e),{revertToDefaultDescriptors:__spreadArray(__spreadArray([],e.revertToDefaultDescriptors),[b.scatterChartProps.categoryAxis.treatNullsAsZero]),groups:a})},y.prototype.getCustomizedValueAxisCard=function(e){var i=this,a=__spreadArray([],e.groups);return a.forEach(function(e,t){b.builder.isPlaceholder(e)||"valueAxis-values"===e.uid&&(a[t]=i.getNewValuesGroup(e,!1))}),__assign(__assign({},e),{revertToDefaultDescriptors:__spreadArray(__spreadArray([],e.revertToDefaultDescriptors),[b.scatterChartProps.valueAxis.treatNullsAsZero]),groups:a})},y.prototype.getNewValuesGroup=function(e,t){var i=__spreadArray([],e.slices),a=b.builder.FormattingUidBuilder.fromGroup(e),a=this.getShowBlankValuesSlice(a,t);return a&&i.push(a),__assign(__assign({},e),{slices:i})},y.prototype.getShowBlankValuesSlice=function(e,t){var i=this,a=this.originalData,r=t?a.xGroupMetadata:a.yGroupMetadata,s=(t?b.scatterChartProps.categoryAxis:b.scatterChartProps.valueAxis).treatNullsAsZero,t=t?!(!a.treatNullsAsZero||!a.treatNullsAsZero.x):!(!a.treatNullsAsZero||!a.treatNullsAsZero.y);if(!r)return a={type:"ToggleSwitch",properties:{descriptor:__assign(__assign({},s),{selector:null}),value:t}},new b.builder.SimpleFormattingSliceBuilder({control:a,localize:function(e){return i.hostService.getLocalizedString(e)},uidBuilder:e.withSlice("showblankvalues")}).build()},y.prototype.getFormattingCards=function(e){var t=this;return{card:[function(){return t.getMarkersCard(e)},function(){return t.getCategoryLabelsCard()}].reduce(function(e,t){t=t();return t&&e.push(t),e},[]),type:2}},y.prototype.supportsTrendLine=function(){var e=this.data;return!(!e||this.isXAxisCategorical()||this.playAxis)&&(!e.hasSize&&(e.hasCategory||e.hasDynamicSeries)&&!!e.xCol&&!!e.yCol)},y.prototype.supportsStaticReferenceLines=function(){return this.data&&!this.isXAxisCategorical()},y.prototype.getAxisLocationForRole=function(e){return"X"===e?0:1},y.getExtents=function(e){var t={},i=e.dataPoints;if(_.isEmpty(i))return{minY:0,maxY:0,formatStringY:void 0,minX:0,maxX:0,formatStringX:void 0};var a=!!e.xGroupMetadata,e=a&&e.xGroupMetadata.isCategoricalAxis;return e||(t.minX=d3.min(i,function(e){return e.x}),t.maxX=d3.max(i,function(e){return e.x}),t.formatStringX=_.first(i).xFormatString),a&&!e&&(i=_.filter(i,function(e){return null!=e.x})),t.minY=d3.min(i,function(e){return e.y}),t.maxY=d3.max(i,function(e){return e.y}),t.formatStringY=null==(a=_.first(i))?void 0:a.yFormatString,t},y.prototype.calculateAxesProperties=function(e){var t=this.currentViewport=e.viewport,i=(this.viewModelAdapterFactory&&this.originalData&&(a=this.viewModelAdapter=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport}),this.data=a.getData()),this.data),a=e.margin,r=(this.currentViewport=t,this.margin=a,t.width-(a.left+a.right)),t=t.height-(a.top+a.bottom),s={minY:0,maxY:10,formatStringY:void 0,formatStringX:void 0,minX:0,maxX:10},o=(this.playAxis?(s=this.playAxis.getCartesianExtents(s,y.getExtents),this.playAxisControlLayout=e.playAxisControlLayout):_.isEmpty(i.dataPoints)||(s=y.getExtents(i)),e.categoryAxisOptions),n=this.isXAxisCategorical(),l=this.getAxesDomains(!1,{categoryAxis:!n,valueAxis:!0}),r=(n?c=_.uniq(_.map(i.dataPoints,function(e){return e.categoryIndex})):(c=(u=b.AxisHelper.mergeScalarAxisDomains(o.includeDomain,b.AxisHelper.createScalarDomainOptions(l.categoryAxis,0)))&&u.domain,u=b.AxisHelper.hasForcedDomain(u)),{pixelSpan:r,dataDomain:c,axisZoom:e.axisZoom,zeroScalarDomain:[-1,1],metaDataColumn:i.xCol,formatString:s.formatStringX||b.valueFormatter.getFormatString(i.xCol,b.scatterChartProps.general.formatString),outerPadding:0,isScalar:!n,isVertical:!1,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!0,scaleType:o.scaleType,logAxisScale:o.logAxisScale,axisDisplayUnits:o.displayUnits,axisPrecision:o.precision,margin:a,preventNice:u,invertAxis:o.invertAxis,featureSwitches:this.featureSwitches}),o=(n&&(u=this.getCategoryLayout(c,e),r.outerPadding=u.outerPaddingRatio,r.categoryThickness=u.categoryThickness,r.innerPaddingRatio=u.innerPaddingRatio,r.outerPaddingRatio=u.outerPaddingRatio,r.getValueFn=function(t,e){return _.find(i.dataPoints,function(e){return e.categoryIndex===t}).formattedCategory.getValue()}),this.xAxisProperties=b.AxisHelper.createAxis(r),this.xAxisProperties.axis.tickSizeInner(-t).tickSizeOuter(0),this.xAxisProperties.axisLabel=this.data.axesLabels.x,n&&(this.xAxisProperties.categoryIdentities=i.categoryIdentities),e.valueAxisOptions),c=b.AxisHelper.mergeScalarAxisDomains(o.includeDomain,b.AxisHelper.createScalarDomainOptions(l.valueAxis,0)),u=b.AxisHelper.hasForcedDomain(c);return this.yAxisProperties=b.AxisHelper.createAxis({pixelSpan:t,dataDomain:c&&c.domain,axisZoom:e.axisZoom,zeroScalarDomain:[-1,1],metaDataColumn:i.yCol,formatString:s.formatStringY||b.valueFormatter.getFormatString(i.yCol,b.scatterChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:o.scaleType,logAxisScale:o.logAxisScale,axisDisplayUnits:o.displayUnits,axisPrecision:o.precision,margin:a,preventNice:u,invertAxis:o.invertAxis,featureSwitches:this.featureSwitches}),this.yAxisProperties.axisLabel=this.data.axesLabels.y,[this.xAxisProperties,this.yAxisProperties]},y.prototype.getAxesDomains=function(e,t){var i,a={},r=this.data;return r&&(i={minY:0,maxY:10,formatStringY:void 0,formatStringX:void 0,minX:0,maxX:10},this.playAxis?i=this.playAxis.getCartesianExtents(i,y.getExtents):_.isEmpty(r.dataPoints)||(i=y.getExtents(r)),t.categoryAxis&&!this.isXAxisCategorical()&&(a.categoryAxis=[i.minX,i.maxX]),t.valueAxis&&(a.valueAxis=[i.minY,i.maxY])),a},y.prototype.setAxesLayout=function(e){},y.prototype.getCategoryLayout=function(e,t){var i=this.data,a=this.currentViewport.width-(this.margin.left+this.margin.right),i=_.size(_.uniqBy(i.dataPoints,function(e){return e.categoryIndex})),r=b.CartesianHelper.getCategoryAxisProperties(this.dataView.metadata),r=b.CartesianHelper.getPreferredCategoryWidth(r),s=this.isXAxisCategorical();return b.CartesianChartLayout.getLayout(void 0,{availableWidth:a,categoryCount:i,preferredCategoryWidth:r,domain:e,isScalar:!s,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:t.trimOrdinalDataOnOverflow,outerPaddingRatio:t.outerPaddingRatio,innerPaddingRatio:t.innerPaddingRatio})},y.prototype.getPreferredPlotArea=function(e,t,i,a){return b.CartesianChartLayout.getPreferredPlotArea(t,i,this.currentViewport,this.isScrollable,e,this.margin,a=void 0===a?0:a)},y.prototype.setFilteredData=function(i,a){var e;this.isXAxisCategorical()&&((e=this.data=w.Prototype.inherit(this.originalData)).dataPoints=_.filter(e.dataPoints,function(e){return e.categoryIndex>=i&&e.categoryIndex<a}),e.dataPointSeries=_.map(e.dataPointSeries,function(e){var t=w.Prototype.inherit(e),e=_.filter(e.dataPoints,function(e){return e.categoryIndex>=i&&e.categoryIndex<a});return t.dataPoints=e,t}))},y.prototype.overrideXScale=function(e){this.xAxisProperties=e},y.prototype.shouldSuppressAnimation=function(){return this.data&&this.data.dataPoints&&this.data.dataPoints.length>y.NoAnimationThreshold},y.prototype.render=function(e,t){var i,a,r,s,o,n,l,c,u,d,h,p;if(this.data)return this.playAxis&&!this.playAxis.isRendererInitialized()&&this.playAxis.initRenderer({svg:this.svg}),i=this.data,a=this.margin,r=this.currentViewport,s=this.interactivityService&&this.interactivityService.hasSelection(),n={width:r.width-(a.left+a.right),height:r.height-(a.top+a.bottom)},l=b.AnimatorCommon.GetAnimationDuration(this.animator,e),this.playAxis&&this.playAxis.isCurrentlyPlaying()&&(this.isMobileChart||0<l)&&(l=b.PlayChart.getFrameAnimationDuration()),u=this.playAxis?d3.easeLinear:d3.easeCubicInOut,p=this.data.hasSize,c=this.featureSwitches.fillPointStyle?i.fillPointStyle===b.fillStyle.fillOnly:i.fillPoint,c=!p&&c,t=1===t&&i.dataPoints&&i.dataPoints.length>y.NoRenderResizeThreshold,o=this.isXAxisCategorical(),n={data:i,allData:this.originalData,drawBubbles:p,isPlay:!!this.playAxis,hasCategoricalAxis:o,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,plotArea:n,hasSelection:s,animationDuration:l,animationOptions:this.animationOptions,fillMarkers:c,easeType:u,suppressDataPointRendering:t,supportsPlotAreaSymmetryShading:this.isPlotSymettryShadingSupported()},p&&!o&&(l=i.dataPoints.sort(y.sortBubbles),n.data=w.Prototype.inherit(n.data),n.data.dataPoints=l),c=[],(i.dataLabelsSettings&&i.dataLabelsSettings.show||i.dataLabelsSettings.showCategory)&&(c=g.createLabelDataPoints(n,this.style)),u=this.renderer.render(n,this.interactivityService,this.hostService,this.style),u.hitTester=new m({dataPoints:u.data.dataPoints,margin:this.margin}),this.isMobileChart&&(u={data:u.data,dataPointsSelection:u.dataPointsSelection,eventGroup:u.eventGroup,root:u.root,host:this.cartesianVisualHost,mobileRoot:this.svg,visualDataInitOptions:this.dataInitOptions,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,background:d3.select(this.element.get(0)),visualInstanceId:u.visualInstanceId,eventManager:u.eventManager}),this.playAxis&&(this.playAxisControlLayout,this.playAxis.setPlayControlPosition(this.playAxisControlLayout),d=this.playAxis.render(e,n,r,a),this.interactivityService&&(t={traceLineRenderer:this.renderer.createTraceLineRenderer(d.viewModel)},s&&b.PlayChart.renderTraceLines(d.allDataPoints,t.traceLineRenderer,!e),u.playOptions=t)),this.interactivityService&&(p=b.DataPointNavigationStrategy.SeriesFirst,o?p=b.DataPointNavigationStrategy.CategoryFirst:this.data.hasDynamicSeries||(p=b.DataPointNavigationStrategy.CategoryOnly),h={navigationStrategy:p,helper:this.renderer}),{dataPoints:d?d.allDataPoints:i.dataPoints,behaviorOptions:u,navigationOptions:h,labelDataPoints:c,labelsAreNumeric:!1,animateLabels:!0}},y.getStrokeFill=function(e,t){return null!=e.size&&t&&(t=a.parseColorString(e.fill))?a.hexString(a.darken(t,y.StrokeDarkenColorValue)):e.fill},y.getMarkerFillOpacity=function(e,t,i,a){return e||t?i&&!a?y.DimmedBubbleOpacity:y.DefaultBubbleOpacity:0},y.getMarkerStrokeOpacity=function(e,t,i,a){return e&&t?1:i&&!a?y.DimmedBubbleOpacity:y.DefaultBubbleOpacity},y.getMarkerStrokeFill=function(e,t,i){return e&&t&&(e=a.parseColorString(i))?a.hexString(a.darken(e,y.StrokeDarkenColorValue)):i},y.getMarkerStyle=function(e,t,i,a){return{"stroke-opacity":y.getMarkerStrokeOpacity(null!=e.size,t,i,e.selected),stroke:y.getMarkerStrokeFill(null!=e.size,t,e.fill),fill:e.fill,"fill-opacity":y.getMarkerFillOpacity(null!=e.size,a,i,e.selected)}},y.getSeriesStyle=function(e,t,i,a,r){return{"stroke-opacity":y.getMarkerStrokeOpacity(e,t,i,!1),stroke:null,fill:r,"fill-opacity":y.getMarkerFillOpacity(e,a,i,!1)}},y.getBubbleOpacity=function(e,t){return t&&!e.selected?y.DimmedBubbleOpacity:y.DefaultBubbleOpacity},y.prototype.getCategoryValueType=function(){var e=this.data.xCol;return b.AxisHelper.getCategoryValueType(e)},y.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},y.prototype.getSupportedCategoryAxisType=function(){return this.data.xGroupMetadata?this.data.xGroupMetadata.isScalarType?b.axisType.both:b.axisType.categorical:b.axisType.scalar},y.prototype.getVisualCategoryAxisIsScalar=function(){return!this.isXAxisCategorical()},y.sortBubbles=function(e,t){if(e.radius.sizeMeasure){var i=t.radius.sizeMeasure.values[t.radius.index]-e.radius.sizeMeasure.values[e.radius.index];if(0!=i)return i}else if(null!=e.radius.value)return t.radius.value-e.radius.value;return t.identity.getKey().localeCompare(e.identity.getKey())},y.prototype.getCartesianVisualCapabilities=function(){return{supportsHierarchicalCategoryAxis:!1}},y.prototype.getStaticSeriesRole=function(){},y.prototype.addWarnings=function(e){this.viewModelAdapter&&this.viewModelAdapter.addWarnings(e)},y.prototype.isXAxisCategorical=function(){var e;return null==(e=null==(e=this.data)?void 0:e.xGroupMetadata)?void 0:e.isCategoricalAxis},y.prototype.isPlotSymettryShadingSupported=function(){var e;return this.featureSwitches.logAxisScale?!this.isXAxisCategorical()&&!0!==(null==(e=this.valueAxisProperties)?void 0:e.logAxisScale)&&(!1===(null==(e=this.categoryAxisProperties)?void 0:e.logAxisScale)||null==(null==(e=this.categoryAxisProperties)?void 0:e.logAxisScale)&&(null==(e=this.categoryAxisProperties)?void 0:e.axisScale)!==w.visuals.axisScale.log):!this.isXAxisCategorical()&&(null==(e=this.valueAxisProperties)?void 0:e.axisScale)!==w.visuals.axisScale.log&&(null==(e=this.categoryAxisProperties)?void 0:e.axisScale)!==w.visuals.axisScale.log},y.DefaultBubbleOpacity=.85,y.DimmedBubbleOpacity=.4,y.StrokeDarkenColorValue=63.75,y.ClassName="scatterChart",y.NoAnimationThreshold=1e3,y.NoRenderResizeThreshold=1e3,y.DefaultDataVolume=3500,y.MaximumDataVolume=1e4,y.DefaultPlotAreaShadingSettings={show:!1,upperShadingColor:null,lowerShadingColor:null,transparency:70},b.ScatterChart=y,g=g||{},C=[2,1,8,4,16,32,64,128],g.createLabelDataPoints=function(e,t){for(var i,a,r,s,o=e.xAxisProperties.scale,n=e.yAxisProperties.scale,l=e.data.sizeRange,c=e.data.multiplier,u=[],d=e.data.dataPoints,h=e.data.dataLabelsSettings,p=(a=(i=e).plotArea.width,r=i.plotArea.height,s=new b.Point(a/2,r/2),a=function(e,t){var i=[],e=e/4,t=t/4;return i.push(new b.Point(e,t)),i.push(new b.Point(3*e,t)),i.push(new b.Point(e,3*t)),i.push(new b.Point(3*e,3*t)),i}(a,r),function(e,t,i){for(var a=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],r=[],s=i.xAxisProperties.scale,o=i.yAxisProperties.scale,n=0,l=i.data.dataPoints;n<l.length;n++){var c=l[n],u=s(c.x),d=o(c.y),h=function(e,t,i){if(e>i.x&&t<=i.y)return 0;if(e<=i.x&&t<=i.y)return 1;return e<=i.x&&t>i.y?2:3}(u,d,e);i.drawBubbles?r[h]||(r[h]=c.identity):(u=function(e,t,i,a){return Math.sqrt((e-i)*(e-i)+(t-a)*(t-a))}(t[h].x,t[h].y,u,d))<a[h]&&(r[h]=c.identity,a[h]=u)}for(var p=[],g=0,y=r;g<y.length;g++){var m=y[g];m&&p.push(m.getKey())}return p}(s,a,i)),g=0,y=d;g<y.length;g++){var m=y[g],f=m.formattedCategory.getValue(),v=h.fontProperties,S=b.FontProperties.toTextProperties(v,f),x=w.TextMeasurementService.measureSvgTextWidth(S),S=w.TextMeasurementService.estimateSvgTextHeight(S);u.push({isPreferred:!!p&&function(e,t){for(var i=0,a=t;i<a.length;i++){var r=a[i];if(0===e.localeCompare(r))return!0}return!1}(m.identity.getKey(),p),text:f,textSize:{width:x,height:S},outsideFill:v.color||b.ColorHelper.getThemeColor(t,b.DataLabelViewModel.DefaultLabelColorName),insideFill:b.ColorHelper.getThemeColor(t,b.DataLabelViewModel.DefaultInsideLabelColorName),parentType:0,parentShape:{point:{x:o(m.x),y:n(m.y)},radius:b.CartesianHelper.getBubbleRadius(m.radius,l,e.plotArea,c),validPositions:C},identity:m.renderIdentity,fontProperties:v,hasBackground:h.enableBackground,backgroundColor:h.backgroundColor,backgroundTransparency:h.backgroundTransparency})}return u};e.prototype.queryRegion=function(e){var i=this,a=b.extractBoundingRectFromLasso(e,!1);return this.adjustPositionRelativeToRoot(a),_.filter(this.dataPoints,function(e){if(void 0===e.size)return i.isPointInRect(a,e.geometry);var t=void 0;switch(e.geometry.markerShape){case b.markerShape.circle:t=b.shapes.Polygon.circleRectangleOverlap(a,{x:e.geometry.x,y:e.geometry.y},e.geometry.size);break;case b.markerShape.square:t=i.isSquareMarkerIntersect(e.geometry,a);break;case b.markerShape.diamond:t=i.isDiamondMarkerIntersect(e.geometry,a);break;case b.markerShape.triangle:t=i.isTriangleMarkerIntersect(e.geometry,a);break;default:t=!1}return t})},e.prototype.isSquareMarkerIntersect=function(e,t){e={left:e.x-e.size,right:e.x+e.size,top:e.y-e.size,bottom:e.y+e.size};return b.shapes.Rect.overlappingRange(e.left,e.right,t.left,t.right)&&b.shapes.Rect.overlappingRange(e.top,e.bottom,t.top,t.bottom)},e.prototype.isDiamondMarkerIntersect=function(e,t){if(!this.isSquareMarkerIntersect(e,t))return!1;if(this.isPointInRect(t,e))return!0;for(var i=[{x:e.x-e.size,y:e.y},{x:e.x,y:e.y-e.size},{x:e.x+e.size,y:e.y},{x:e.x,y:e.y+e.size}],a=[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.right,y:t.bottom},{x:t.left,y:t.bottom}],r=[[a[0],a[1]],[a[1],a[2]],[a[3],a[2]],[a[0],a[3]]],s=0,o=[[i[0],i[1]],[i[1],i[2]],[i[0],i[3]],[i[3],i[2]]];s<o.length;s++)for(var n=o[s],l=0,c=r;l<c.length;l++){var u=c[l];if(b.shapes.Polygon.linesIntersect(n[0],n[1],u[0],u[1],!1))return!0}return this.isLassoInShape(e,t)},e.prototype.isPointInRect=function(e,t){return w.Double.lessOrEqualWithPrecision(e.left,t.x)&&w.Double.lessOrEqualWithPrecision(t.x,e.right)&&w.Double.lessOrEqualWithPrecision(e.top,t.y)&&w.Double.lessOrEqualWithPrecision(t.y,e.bottom)},e.prototype.isLassoInShape=function(e,t){e={left:e.x-e.size,right:e.x+e.size,top:e.y-e.size,bottom:e.y+e.size};return b.shapes.Rect.overlappingRange(t.left,t.right,e.left,e.right)&&b.shapes.Rect.overlappingRange(t.top,t.bottom,e.top,e.bottom)},e.prototype.isTriangleMarkerIntersect=function(e,t){if(!this.isSquareMarkerIntersect(e,t))return!1;if(this.isPointInRect(t,e))return!0;for(var i=[{x:e.x-e.size,y:e.y+e.size},{x:e.x,y:e.y-e.size},{x:e.x+e.size,y:e.y+e.size}],a=[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.right,y:t.bottom},{x:t.left,y:t.bottom}],r=[[a[0],a[1]],[a[1],a[2]],[a[3],a[2]],[a[0],a[3]]],s=0,o=[[i[0],i[1]],[i[1],i[2]],[i[0],i[2]]];s<o.length;s++)for(var n=o[s],l=0,c=r;l<c.length;l++){var u=c[l];if(b.shapes.Polygon.linesIntersect(n[0],n[1],u[0],u[1],!1))return!0}return this.isLassoInShape(e,t)},e.prototype.adjustPositionRelativeToRoot=function(e){e.left-=this.margin.left,e.top-=this.margin.top,e.right-=this.margin.left,e.bottom-=this.margin.top};var m=e;function e(e){this.dataPoints=e.dataPoints,this.margin=e.margin}b.ScatterChartHitTester=m}(w.visuals||(w.visuals={}))}(powerbi=powerbi||{}),function(e){!function(c){var a=jsCommon.BrowserUtils,e=jsCommon.CssConstants.createClassAndSelector,t=jsCommon.PerfTimer;function i(){}i.prototype.create=function(){return new r},c.ScatterChartWebBehaviorFactory=i;s.prototype.bindEvents=function(e,t,i){var a,r,s=this.bubbles=e.dataPointsSelection,o=e.data,n=e.eventGroup,o=(!this.playOptions||!this.playOptions.traceLineRenderer||e.playOptions&&e.playOptions.traceLineRenderer||this.playOptions.traceLineRenderer.remove(),this.playOptions=e.playOptions,this.shouldEnableFill=e.fillMarkers,this.colorBorder=o.colorBorder,this.hitTester=e.hitTester,this.rootSelection=e.root),l=this.visualInstanceId=e.visualInstanceId;i&&(a=i.dataPointNavigationManager,r=i.pointSourceKey),c.InteractivityUtils.appendUseElementForFocus(o,l,r),this.selectionHandler=t,n?c.InteractivityUtils.registerGroupInteractivityHandlers(e.eventManager,n,t):c.InteractivityUtils.registerStandardInteractivityHandlers(s,t),a&&!a.isEmpty(r)&&(c.InteractivityUtils.registerEnterPlotAreaHandler(o,a,r),c.InteractivityUtils.registerDataPointNavigationHandler(o,a,r),c.InteractivityUtils.registerClearCatcherShortcut(o,t))},s.prototype.renderSelection=function(t){var e,i,a=this.shouldEnableFill,r=this.colorBorder;this.bubbles.styles({"fill-opacity":function(e){return c.ScatterChart.getMarkerFillOpacity(null!=e.size,a,t,e.selected)},"stroke-opacity":function(e){return c.ScatterChart.getMarkerStrokeOpacity(null!=e.size,r,t,e.selected)}}),this.playOptions&&this.bubbles&&(e=this.bubbles.filter(function(e){return e.selected}).data(),i=this.playOptions.traceLineRenderer,e&&0<e.length&&null!=i?i.render(e,!0):i.remove())},s.prototype.renderFocus=function(e){var t,i=c.CurrentFocusDataPointId+"-"+this.visualInstanceId;this.rootSelection.select("#"+i).attr("id",null),e&&(this.bubbles.attr("aria-label",null),(t=d3.select(e).datum())&&e.setAttribute("aria-label",c.tooltipUtils.formatTooltipInfo(t.tooltipInfo())),e.setAttribute("id",i),a.focus(e))},s.prototype.lassoSelectRectLayer=function(e){return this.hitTester.queryRegion(e)},s.prototype.getLassoSelectDirectionMode=function(){return 1};var r=s;function s(){}function o(){}c.ScatterChartWebBehavior=r,o.prototype.create=function(){return new n},c.ScatterChartMobileBehaviorFactory=o;l.prototype.bindEvents=function(e,t,i){this.setOptions(e),e.visualDataInitOptions&&e.visualDataInitOptions.interactivity.isInteractiveLegend&&(this.makeDataPointsSelectable(e.dataPointsSelection),this.makeRootSelectable(e.mobileRoot),this.makeDragable(e.mobileRoot),this.disableDefaultTouchInteractions(e.mobileRoot),this.selectRoot())},l.prototype.renderSelection=function(e){},l.prototype.setSelectionHandler=function(e){},l.prototype.makeDataPointsSelectable=function(){for(var i=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var a=0,r=e.length;a<r;a++)e[a].on("click",function(e,t){i.select(t)})},l.prototype.makeRootSelectable=function(e){var i=this;e.on("click",function(e,t){i.selectRoot()})},l.prototype.makeDragable=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var a=0,r=e.length;a<r;a++){var s=e[a],o=d3.drag().on("drag",function(e){t.drag(0)}).on("end",function(e){t.drag(1)});s.call(o)}},l.prototype.disableDefaultTouchInteractions=function(e){e.style("touch-action","none")},l.prototype.setOptions=function(e){this.data=e.data,this.mainGraphicsContext=e.root,this.xAxisProperties=e.xAxisProperties,this.yAxisProperties=e.yAxisProperties,this.host=e.host},l.prototype.select=function(e){this.selectDotByIndex(e)},l.prototype.selectRoot=function(){var e=t.start("selectRoot");this.onClick(),e()},l.prototype.drag=function(e){switch(e){case 0:this.onDrag();break;case 1:this.onClick()}},l.prototype.onDrag=function(){var e=this.getMouseCoordinates(),e=(this.moveCrosshairToXY(e.x,e.y),this.findClosestDotIndex(e.x,e.y));this.selectDot(e),this.updateLegend(e)},l.prototype.onClick=function(){var e=this.getMouseCoordinates(),e=this.findClosestDotIndex(e.x,e.y);-1!==e&&this.selectDotByIndex(e)},l.prototype.getMouseCoordinates=function(){var e=this.mainGraphicsContext,t=0;a=(a=parseInt(e.attr("height"),10))||0;try{var i=d3.mouse(e.node()),t=i[0],a=i[1]}catch(e){}return{x:t,y:a}},l.prototype.selectDotByIndex=function(e){this.selectDot(e),this.moveCrosshairToIndexDot(e),this.updateLegend(e)},l.prototype.selectDot=function(a){var r=this,e=this.mainGraphicsContext;e.selectAll(l.ScatterMarker.selector).classed("selected",!1).classed("notSelected",!0),e.selectAll(l.ScatterMarker.selector).filter(function(e,t){var i=r.data.dataPoints,i=(i.length,i.length,i[a]);return e.x===i.x&&e.y===i.y}).classed("selected",!0).classed("notSelected",!1)},l.prototype.moveCrosshairToIndexDot=function(e){var t,i=this.data.dataPoints,a=this.mainGraphicsContext,r=(i.length,i.length,this.xAxisProperties.scale(i[e].x)),i=this.yAxisProperties.scale(i[e].y);null==this.crosshair?(e=+a.attr("width"),t=+a.attr("height"),this.crosshair=this.drawCrosshair(a,r,i,e,t),this.crosshairHorizontal=this.crosshair.select(l.Horizontal.selector),this.crosshairVertical=this.crosshair.select(l.Vertical.selector)):this.moveCrosshairToXY(r,i)},l.prototype.moveCrosshairToXY=function(e,t){this.crosshairHorizontal.attrs({y1:t,y2:t}),this.crosshairVertical.attrs({x1:e,x2:e})},l.prototype.drawCrosshair=function(e,t,i,a,r){e=e.append("g");return e.classed(l.CrosshairClassName,!0),e.append("line").classed(l.Horizontal.class,!0).attrs({x1:0,x2:a,y1:i,y2:i}),e.append("line").classed(l.Vertical.class,!0).attrs({x1:t,x2:t,y1:r,y2:0}),e},l.prototype.findClosestDotIndex=function(e,t){var i,a=-1,r=Number.MAX_VALUE,s=this.data.dataPoints,o=this.xAxisProperties.scale,n=this.yAxisProperties.scale;for(i in s){var l=s[i],c=o(l.x)-e,l=n(l.y)-t,c=c*c+l*l;(r===Number.MAX_VALUE||r&&c<r)&&(a=i,r=c)}return a},l.prototype.updateLegend=function(e){var t;null!=this.lastDotIndex&&this.lastDotIndex===e||(t=this.createLegendDataPoints(e),this.host.updateLegend(t),this.lastDotIndex=e)},l.prototype.createLegendDataPoints=function(e){var t=c.scatterChartProps.general.formatString,i=[],a=this.data,r=(a.dataPoints.length,a.dataPoints.length,a.dataPoints[e]),s=c.valueFormatter.format(null),o=s,n=a.legendData,n=(n.dataPoints,n.dataPoints),l=r.formattedCategory.getValue(),l=(l!==s?(o=l,null!=r&&null!=r.radius&&null!=r.radius.sizeMeasure&&(o+="; "+c.valueFormatter.format(r.radius.sizeMeasure.source.groupName))):null!=r.radius.sizeMeasure?o=c.valueFormatter.format(r.radius.sizeMeasure.source.groupName):0<n.length&&n.length>=e&&n[e].label!==s&&(o=n[e].label),null!=a.xCol&&i.push({category:o,color:r.fill,identity:c.SelectionIdBuilder.builder().withMeasure(a.xCol.queryName).createSelectionId(),selected:r.selected,icon:c.LegendIcon.Box,label:c.valueFormatter.format(this.data.axesLabels.x),measure:c.valueFormatter.format(r.x,c.valueFormatter.getFormatString(a.xCol,t)),iconOnlyOnLabel:!0,index:0}),null!=a.yCol&&i.push({category:o,color:r.fill,identity:c.SelectionIdBuilder.builder().withMeasure(a.yCol.queryName).createSelectionId(),selected:r.selected,icon:c.LegendIcon.Box,label:c.valueFormatter.format(a.axesLabels.y),measure:c.valueFormatter.format(r.y,c.valueFormatter.getFormatString(a.yCol,t)),iconOnlyOnLabel:!0,index:1}),null!=a.size&&i.push({category:o,color:r.fill,identity:c.SelectionIdBuilder.builder().withMeasure(a.size.queryName).createSelectionId(),selected:r.selected,icon:c.LegendIcon.Box,label:c.valueFormatter.format(a.size.displayName),measure:c.valueFormatter.format(r.radius.sizeMeasure&&r.radius.sizeMeasure.values[r.radius.index]||r.radius.value,c.valueFormatter.getFormatString(a.size,t)),iconOnlyOnLabel:!0,index:2}),c.Legend.getDefaultLegendData());return l.dataPoints=i,l},l.CrosshairClassName="crosshair",l.ScatterMarker=e("scatterMarker"),l.Horizontal=e("horizontal"),l.Vertical=e("vertical");var n=l;function l(){}c.ScatterChartMobileBehavior=n}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(I){!function(T){var d=T.builder,e=jsCommon.CssConstants.createClassAndSelector,t=T.labelPosition,y=jsCommon.Lazy,m=jsCommon.StringExtensions;function F(e){this.isScrollable=e.isScrollable,this.tooltipsEnabled=null==e.tooltipsEnabled||e.tooltipsEnabled,this.interactivityService=e.interactivityService,this.featureSwitch=e.featureSwitches,this.viewModelAdapterFactory=e.viewModelAdapterFactory}F.prototype.initData=function(e){this.style=e.style,this.currentViewport=e.viewport,this.hostServices=e.host,this.tooltipService=e.services.tooltips,this.animationOptions=e.animation},F.prototype.initRenderer=function(e){this.svg=e.svg,this.svg.classed(F.WaterfallClassName,!0),this.mainGraphicsSVG=this.svg.append("svg"),this.mainGraphicsContext=this.mainGraphicsSVG.append("g").classed(F.MainGraphicsContextClassName,!0),this.interactivityService&&(e=jsCommon.BrowserUtils.isInternetExplorerOrEdge(),this.mainGraphicsContext.attrs({tabindex:0,focusable:!0,role:"listbox","aria-multiselectable":!0,"aria-label":this.hostServices.getLocalizedString("Visual_Plot")}).classed(T.SetFocusRingClassName,!e))},F.converter=function(e){var t=e.dataView;if(t)return t.categorical?F.categoricalConverter(e):t.matrix?I.waterfallConverterModuleFactory().matrixConverter(e):void 0},F.categoricalConverter=function(e){var l,c,t,i=e.dataView,u=e.hostServices,d=e.dataLabelSettings,h=e.sentimentColors,a=e.interactivityService,p=e.tooltipsEnabled,g=F.formatStringProp,y=I.data.createDataViewCategoricalReaderAdvanced(i,{formatStringProp:g}),m=y.data,r=I.DataViewObjects.getValue(y.objects.getStaticObjects(),T.cartesianChartProps.valueAxis.totalsEnabled,F.DefaultTotalsEnabled),s=(m.hasValues("Breakdown")&&(r=F.DefaultTotalsEnabled),i.categorical.categories||[]),o=u.getLocalizedString(F.TotalLabel),n=F.createLegend(h,u,y.objects.getStaticObjects(),e.style,void 0,r),f={current:0,min:0,max:0,formatString:void 0},v=[],S=[],x=[],b=[];if(m.hasValues("Tooltips")&&(c=y.columns.getAllValueMetadataColumnsForRole("Tooltips",void 0)),m.hasValues("Y")){var C=(b=[y.columns.getValueMetadataColumn("Y")])[0].format;if(_.isEmpty(s))var w=m.getValue("Y",0),f={current:w,max:w,min:0,formatString:m.getFormatString("Y",0)};else{var D=s[0],A=D.source;(S=D.values.slice()).push(o);for(var P=null!=(w=i.categorical.originalCategories)?w:[D],L=d.fontProperties.color,M=0,V=m.getCategoryCount();M<V;M++)!function(e){var t=S[e],i=m.getValue("Y",e)||0,a=m.getFormatString("Y",e),r=(void 0!==a&&void 0===C&&(C=a),T.SelectionIdBuilder.builder().withCategory(P,e,null==(l=null==D?void 0:D.source)?void 0:l.queryName,!0).withMeasure(b[0].queryName,y.columns.getValueColumn("Y"),e).createSelectionId()),s=void 0,o=(p&&(s=F.createCategoryTooltip(A?[A]:null,b[0],[t],i,a,g),o=m.getAllValuesForRole("Tooltips",e),n=m.getAllFormatStringsForRole("Tooltips",e),o&&c&&F.appendTooltipMeasures(o,n,s,c,g,u)),T.DataLabelUtil.determineDataLabelFillColor({defaultColor:L,categoricalDataReader:y,categoryIndex:e})),n=T.DataLabelUtil.isAssignedColor(o)?o.color:L;d.fontProperties=T.DataLabelUtil.updateFontPropertiesColor(n,d.fontProperties),v.push(F.createDataPoint(i,f.current,h,t,e,r,s,o.color,a||C,0)),x[e]=function(){return T.CartesianHelper.getCategoryIdentity(e,D)},f=F.getNewPositionContext(f,i)}(M)}s=void 0,w=(p&&(s=F.createCategoryTooltip(A?[A]:null,b[0],[o],f.current,void 0,g)),T.SelectionId.createNull());r&&v.push(F.createDataPoint(f.current,0,h,o,m.getCategoryCount(),w,s,d.fontProperties.color,C,1,{text:!0}))}a&&a.applySelectionStateToData(v),e.style.isHighContrast&&(t={visible:!0,color:T.ColorHelper.getThemeColor(e.style,T.ForegroundColorName),width:T.CartesianHelper.defaultLineStrokeWidth});r=T.CartesianHelper.getCategoryAxisProperties(i.metadata,void 0),o=T.CartesianHelper.getPreferredCategoryWidth(r);return{series:[{data:v,type:!_.isEmpty(b)&&b[0].type}],categories:S,categoryIdentities:x,categoryMetadata:A,preferredCategoryWidth:o,valuesMetadata:b,legend:n,hasHighlights:!1,positionMin:f.min,positionMax:f.max,dataLabelsSettings:d,sentimentColors:h,strokeSettings:t}},F.createDataPoint=function(e,t,i,a,r,s,o,n,l,c,u){i=1===c||2===c?i.totalFill:3===c?i.otherFill:0<e?i.increaseFill:i.decreaseFill;return{value:e,position:t,color:i.solid.color,categoryValue:a,categoryIndex:r,identity:s,seriesIndex:0,selected:!1,highlight:!1,key:s.getKey(),tooltipInfo:o&&function(){return o.getTooltipItems()},labelFill:n,labelFormatString:l,type:I.ValueType.fromDescriptor(u),barType:c}},F.createCategoryTooltip=function(i,e,t,a,r,s){var o=new T.LazyTooltipBuilder;return _.isEmpty(i)||o.withLazyValue(new y(function(){return{displayName:_.map(i,function(e){return e.displayName}).join(" "),value:_.map(t,function(e,t){return T.converterHelper.formatFromMetadataColumn(e,i[t],s)}).join(" ")}})),null!=a&&e&&o.withLazyValue(new y(function(){return{displayName:e.displayName,value:T.converterHelper.formatFromMetadataColumn(a,e,s,!1,r)}})),o},F.appendTooltipMeasures=function(o,n,l,c,u,d,h,p,g){if(!_.isEmpty(o)&&!_.isEmpty(c))for(var e=0;e<o.length;e++)!function(e){var t,i,a,r,s;null!=o[e]&&c[e]&&(t=c[e].displayName,i=T.converterHelper.formatFromMetadataColumn(o[e],c[e],u,!1,null==n?void 0:n[e]),_.isEmpty(h)?l.withLazyValue(new y(function(){return{displayName:t,value:i}})):(a=o[e],r=h[e],_.isNumber(a)&&_.isNumber(r)?(t=m.format(d.getLocalizedString("Waterfall_BreakdownDifferenceTooltip"),t),i=F.createPercentTooltipValue(i,a,r),l.withLazyValue(new y(function(){return{displayName:t,value:i}}))):(null!=r&&(s=T.converterHelper.formatFromMetadataColumn(r,c[e],u,!1),l.withLazyValue(new y(function(){return{displayName:g+" "+t,value:s}}))),null!=a&&l.withLazyValue(new y(function(){return{displayName:p+" "+t,value:i}})))))}(e)},F.createPercentTooltipValue=function(e,t,i){if(!i)return e;t/=Math.abs(i),i=T.valueFormatter.getLocalizedString("Percentage");return e+" ("+T.valueFormatter.format(t,i)+")"},F.createLegend=function(e,t,i,a,r,s){var o=e.increaseFill.solid.color,n=e.decreaseFill.solid.color,l=e.totalFill.solid.color,e=e.otherFill.solid.color,c=t.getLocalizedString(F.TotalLabel),u=t.getLocalizedString(F.IncreaseLabel),d=t.getLocalizedString(F.DecreaseLabel),t=t.getLocalizedString(F.OtherLabel),u=[{label:u,color:o,icon:T.LegendIcon.Box,identity:T.SelectionIdBuilder.builder().withMeasure("increase").createSelectionId(),selected:!1,index:0},{label:d,color:n,icon:T.LegendIcon.Box,identity:T.SelectionIdBuilder.builder().withMeasure("decrease").createSelectionId(),selected:!1,index:1}];return s&&u.push({label:c,color:l,icon:T.LegendIcon.Box,identity:T.SelectionIdBuilder.builder().withMeasure("total").createSelectionId(),selected:!1,index:2}),r&&u.splice(2,0,{label:t,color:e,icon:T.LegendIcon.Box,identity:T.SelectionIdBuilder.builder().withMeasure("other").createSelectionId(),selected:!1,index:3}),T.LegendData.create(i,u,!0,"",!1,a)},F.getNewPositionContext=function(e,t){t=e.current+t;return{current:t,min:Math.min(e.min,t),max:Math.max(e.max,t)}},F.getDefaultWaterfallLabelSettings=function(e,t,i,a){void 0===t&&(t=!1);e=T.DataLabelViewModel.getDefaultLabelSettings({style:e,textClassName:"smallLightLabel",labelColor:i,fontSize:a}).fontProperties;return{show:t,labelOrientation:1,position:T.labelPosition.auto,displayUnits:0,precision:T.DataLabelViewModel.defaultLabelPrecision,fontProperties:e,enableBackground:!1,bold:!1,italic:!1,underline:!1}},F.doesDataLabelFitInShape=function(e,t,i){if(null==e||null===e.value)return!1;var a={text:i.labelText(e),fontFamily:T.DataLabelViewModel.LabelTextProperties.fontFamily,fontSize:T.DataLabelViewModel.LabelTextProperties.fontSize,fontWeight:T.DataLabelViewModel.LabelTextProperties.fontWeight};if(0<T.CartesianHelper.getRectTop(t.scale,e.position,e.value)-T.DataLabelViewModel.labelMargin)return!0;var r=I.TextMeasurementService.measureSvgTextWidth(a),a=I.TextMeasurementService.estimateSvgTextHeight(a),i=i.categoryWidth,t=Math.abs(T.AxisHelper.diffScaled(t.scale,Math.max(0,Math.abs(e.value)),0));return!(i<r||t<a)},F.prototype.setData=function(e){var t,i,a=this.getSentimentColorsFromObjects(null),r=F.DefaultBreakdowns,e=0<e.length?e[0]:void 0;this.data=this.originalData={series:[{data:[]}],categories:[],valuesMetadata:[],legend:T.Legend.getDefaultLegendData(this.style),hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,positionMax:0,positionMin:0,dataLabelsSettings:F.getDefaultWaterfallLabelSettings(this.style,!1,void 0),sentimentColors:a,axesLabels:{x:null,y:null},numberOfBreakdowns:r,totalBreakdownCategories:0},e&&((this.dataView=e).metadata&&e.metadata.objects&&((i=(t=e.metadata.objects).labels)&&T.DataLabelViewModel.updateLabelSettingsFromLabelsObject(i,this.data.dataLabelsSettings,!0,this.style),a=this.getSentimentColorsFromObjects(t),r=I.DataViewObjects.getValue(t,T.waterfallChartProps.breakdown.maxBreakdowns,F.DefaultBreakdowns)),(e.categorical||e.matrix)&&(this.data=this.originalData=F.converter({dataView:e,style:this.style,hostServices:this.hostServices,dataLabelSettings:this.data.dataLabelsSettings,sentimentColors:a,interactivityService:this.interactivityService,tooltipsEnabled:this.tooltipsEnabled,numberOfBreakdowns:r})))},F.prototype.getFormattingCards=function(e){var t=this;return{card:[function(){return t.getSentimentColorCard(e.categoryAxisData)},function(){return t.getBreakdownCard()},function(){return t.getLabelsCard()}].reduce(function(e,t){t=t();return t&&e.push(t),e},[]),type:3}},F.prototype.getSentimentColorCard=function(t){function i(e){return a.hostServices.getLocalizedString(e)}var a=this,r=T.waterfallChartPropsNew.sentimentColors,s=this.originalData,o=s.sentimentColors,n=T.waterfallChartPropsNew.valueAxis.totalsEnabled,e=T.waterfallChartPropsNew.categoryAxis,l=e.innerPadding,c=e.preferredCategoryWidth,u=this.yAxisProperties.totalsEnabled,e=new d.FormattingCardBuilder(new d.FormattingCardUidBuilder("sentimentColors"),"Role_DisplayName_Columns",__assign(__assign({},r),{totalsEnabledProp:n,innerPaddingProp:l,preferredCategoryWidthProp:c}),i);return e.addGroup("colors",function(e){e.withDisplayName("Visual_Colors").addSimpleSlice("increaseFill",function(){var e={value:o.increaseFill.solid.color};return new d.ColorPickerBuilder({descriptor:r.increaseFill,value:e}).build()}).addSimpleSlice("decreaseFill",function(){var e={value:o.decreaseFill.solid.color};return new d.ColorPickerBuilder({descriptor:r.decreaseFill,value:e}).build()}).addSimpleSlice("otherFill",function(){var e={value:o.otherFill.solid.color};return new d.ColorPickerBuilder({descriptor:r.otherFill,value:e}).build()},function(e){return e.withDisabled(!s.isBreakdown).withCustomDescription("Visual_Waterfall_Breakdown_OtherDescription")}),a.featureSwitch.waterfallTotals&&!s.isBreakdown&&e.addSimpleSlice("totalsEnabled",new d.ToggleSwitchBuilder({descriptor:n,value:u}).build(),function(e){return e.withCustomDisplayName("Visual_Axis_Total_Column")}),u&&e.addSimpleSlice("totalFill",function(){var e={value:o.totalFill.solid.color};return new d.ColorPickerBuilder({descriptor:r.totalFill,value:e}).build()})}),e.addGroup("spacing",function(e){e.withDisplayName("RibbonChart_SeriesGapWidth").addSimpleSlice("innerPadding",new d.SliderBuilder({descriptor:l,value:100*t.innerPadding,localize:i,options:{minValue:{type:0,value:0},maxValue:{type:1,value:50}}}).build()).addSimpleSlice("maxcategoryWidth",new d.SliderBuilder({descriptor:c,value:Math.round(100*t.maxMarginFactor),localize:i,options:{minValue:{type:0,value:20},maxValue:{type:1,value:180}}}).build(),function(e){return e.withCustomDisplayName("Visual_Max_CategoryWidth")})}),e.build()},F.prototype.getBreakdownCard=function(){function t(e){return i.hostServices.getLocalizedString(e)}var i=this,a=this.originalData,r=T.waterfallChartPropsNew.breakdown,e=new d.FormattingCardBuilder(new d.FormattingCardUidBuilder("breakdown"),"Visual_Waterfall_Breakdown",r,t);return a.isBreakdown?e.addGroup("breakdown",function(e){e.addSimpleSlice("maxBreakdowns",new d.SliderBuilder({descriptor:r.maxBreakdowns,value:a.numberOfBreakdowns,localize:t,options:{minValue:{type:0,value:F.MinimumBreakdowns},maxValue:{type:1,value:Math.min(F.MaximumBreakdowns,a.totalBreakdownCategories)}}}).build(),function(e){return e.withCustomDisplayName("Visual_Waterfall_MaximumBreakdown")})}):e.withDisabled(!0,"Visual_BreakdownCard_DisabledReason"),e.build()},F.prototype.getLabelsCard=function(){var t=this,e=T.waterfallChartPropsNew.labels,i=this.originalData,a=this.data.dataLabelsSettings,r={dataLabelsSettings:i.dataLabelsSettings,positionObject:F.validLabelPositionsOptions,show:!0,displayUnits:!0,precision:!0,fontSize:!0,fontFamily:!0,labelOrientation:!0,position:!0,enableBackground:a.enableBackground,backgroundColor:a.backgroundColor,backgroundTransparency:a.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0};a.position&&r.positionObject.indexOf(a.position)<0&&(a.position=F.AutoLabelPosition);a={cardBuilder:new d.FormattingCardBuilder(new d.FormattingCardUidBuilder("labels"),"Visual_DataPointsLabels",e,function(e){return t.hostServices.getLocalizedString(e)}),dataLabelsProps:e,featureSwitches:this.featureSwitch,hostServices:this.hostServices,options:r,individualSelector:T.DataLabelViewModel.generateLabelIndividualSelector({featureSwitches:this.featureSwitch,hasCategories:null!=_.first(i.categories),hasDynamicSeries:!1,hasSeriesSelector:!1})};return i.isBreakdown&&(i=null==(r=_.first(null==(e=_.first(i.series))?void 0:e.data))?void 0:r.identity.getSelector())&&(a.repetitionSelector={metadata:i.metadata}),T.DataLabelViewModel.getDataLabelsFormattingModel(a)},F.prototype.enumerateObjectInstances=function(e,t){var i=this.originalData;switch(t.objectName){case"sentimentColors":this.enumerateSentimentColors(e);break;case"labels":var a=this.data.dataLabelsSettings,a={enumeration:e,dataLabelsSettings:i.dataLabelsSettings,positionObject:F.validLabelPositionsOptions,show:!0,displayUnits:!0,precision:!0,fontSize:!0,fontFamily:!0,labelOrientation:!0,position:!0,enableBackground:a.enableBackground,backgroundColor:a.backgroundColor,backgroundTransparency:a.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0};T.DataLabelViewModel.enumerateDataLabels(a,this.featureSwitch);break;case T.waterfallChartProps.breakdown.maxBreakdowns.objectName:this.enumerateBreakdown(e)}},F.prototype.enumerateSentimentColors=function(e){var t=this.originalData,i=t.sentimentColors,a=this.yAxisProperties.totalsEnabled,r={increaseFill:i.increaseFill,decreaseFill:i.decreaseFill};t.isBreakdown&&(r.otherFill=i.otherFill),a&&(r.totalFill=i.totalFill),e.pushInstance({selector:null,properties:r,objectName:"sentimentColors"})},F.prototype.enumerateBreakdown=function(e){var t=this.originalData;t.isBreakdown&&e.pushInstance({selector:null,properties:{maxBreakdowns:t.numberOfBreakdowns},validValues:{maxBreakdowns:{numberRange:{min:F.MinimumBreakdowns,max:Math.min(F.MaximumBreakdowns,t.totalBreakdownCategories)}}},objectName:T.waterfallChartProps.breakdown.maxBreakdowns.objectName})},F.prototype.calculateCustomLegend=function(){return this.data.legend},F.prototype.hasLegend=function(){return!0},F.createClippedDataIfOverflowed=function(e,t){var i=e,a=e.series[0].data;return e&&t<a.length&&((i=I.Prototype.inherit(e)).series=[{data:a.slice(0,t)}],i.categories=e.categories.slice(0,t)),i},F.prototype.calculateAxesProperties=function(e){var t=this,i=(this.currentViewport=e.viewport,this.viewModelAdapterFactory&&this.originalData&&(i=this.viewModelAdapter=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport}),this.data=i.getData()),this.margin=e.margin,this.clippedData=this.data),a=i.series,r=i.categories.length,s=this.getPreferredPlotArea(!1,r,T.CartesianHelper.MinOrdinalRectThickness,e.outerPaddingRatio),o=i?i.preferredCategoryWidth:null,r=T.CartesianChartLayout.getLayout(null,{availableWidth:s.width,categoryCount:r,preferredCategoryWidth:o,domain:null,isScalar:!1,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:e.trimOrdinalDataOnOverflow,outerPaddingRatio:e.outerPaddingRatio,innerPaddingRatio:e.innerPaddingRatio}),o=(this.isScrollable||(i=this.clippedData=F.createClippedDataIfOverflowed(i,r.categoryCount)),this.getAxesDomains(!1,{valueAxis:!0})),n=F.getXAxisCreationOptions(i,s.width,r,e,this.featureSwitch),s=F.getYAxisCreationOptions(i,s.height,o.valueAxis,e,this.featureSwitch),o=this.xAxisProperties=T.AxisHelper.createAxis(n),l=this.yAxisProperties=T.AxisHelper.createAxis(s),n=(this.xAxisProperties.outerPaddingRatio=r.outerPaddingRatio,i.categoryIdentities&&(this.xAxisProperties.categoryIdentities=i.categoryIdentities),this.xAxisProperties.categoryThickness*(1-e.innerPaddingRatio)),c=T.DataLabelViewModel.createColumnFormatterCacheManager(),u=i.dataLabelsSettings,d=T.DataLabelRenderer.getLabelUnitAndPrecisionForAxis(l,u);return this.layout={categoryCount:r.categoryCount,categoryThickness:r.categoryThickness,isScalar:r.isScalar,outerPaddingRatio:r.outerPaddingRatio,categoryWidth:n,labelText:function(e){var t=a[e.seriesIndex].type,t=c.getOrCreate(e.labelFormatString,u,d.units,d.getPrecision(!!e.labelFormatString,t));return T.DataLabelViewModel.getLabelTailoredText({label:t.format(e.value)})},labelLayout:T.CartesianHelper.getLabelLayoutXYForWaterfall(o,n,l,s.dataDomain),filter:function(e){return F.doesDataLabelFitInShape(e,l,t.layout)},style:{fill:function(e){return e.isLabelInside?T.ColorHelper.getThemeColor(t.style,T.DataLabelViewModel.DefaultInsideLabelColorName):e.labelFill}}},[o,l]},F.prototype.getAxesDomains=function(e,t){var i={},a=this.clippedData||this.data;return a&&t.valueAxis&&(i.valueAxis=[a.positionMin,a.positionMax]),i},F.prototype.setAxesLayout=function(e){},F.lookupXValue=function(e,t,i,a){var r=e.series[0].data;return t===r.length-1?r[t].categoryValue:T.CartesianHelper.lookupXValue(e,t,r[t].type||i,!1,a)},F.getXAxisCreationOptions=function(i,e,t,a,r){var s=T.AxisHelper.getCategoryValueType(i.categoryMetadata),o=a.categoryAxisOptions,s=T.AxisHelper.createDomain(i.series,s,!1,[o.includeDomain]),n=t.categoryThickness,l=n*t.outerPaddingRatio,c=T.AxisHelper.hasForcedDomain(o.includeDomain);return{pixelSpan:e,dataDomain:s,axisZoom:void 0,metaDataColumn:i.categoryMetadata,formatString:T.valueFormatter.getFormatString(i.categoryMetadata,F.formatStringProp),isScalar:!1,outerPadding:l,categoryThickness:n,getValueFn:function(e,t){return F.lookupXValue(i,e,t,r)},forcedTickCount:a.forcedTickCount,isCategoryAxis:!0,axisDisplayUnits:o.displayUnits,axisPrecision:o.precision,outerPaddingRatio:t.outerPaddingRatio,preventNice:c,innerPaddingRatio:a.innerPaddingRatio,featureSwitches:r}},F.getYAxisCreationOptions=function(e,t,i,a,r){var s=a.valueAxisOptions,i=T.AxisHelper.mergeScalarAxisDomains(s.includeDomain,T.AxisHelper.createScalarDomainOptions(i,0)),o=T.AxisHelper.hasForcedDomain(i);return{pixelSpan:t,dataDomain:i&&i.domain,axisZoom:void 0,zeroScalarDomain:[0,1],isScalar:!0,isVertical:!0,metaDataColumn:e.valuesMetadata,formatString:T.valueFormatter.getFormatString(e.valuesMetadata[0],F.formatStringProp),outerPadding:0,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,axisDisplayUnits:s.displayUnits,axisPrecision:s.precision,outerPaddingRatio:0,preventNice:o,invertAxis:s.invertAxis,totalsEnabled:s.totalsEnabled,featureSwitches:r}},F.prototype.getPreferredPlotArea=function(e,t,i,a){return T.CartesianChartLayout.getPreferredPlotArea(t,i,this.currentViewport,this.isScrollable,e,this.margin,a)},F.prototype.getVisualCategoryAxisIsScalar=function(){return!1},F.prototype.overrideXScale=function(e){this.xAxisProperties=e},F.prototype.setFilteredData=function(e,t){var i=this.clippedData=I.Prototype.inherit(this.data);return i.series=[{data:i.series[0].data.slice(e,t)}],i.categories=i.categories.slice(e,t),i},F.prototype.createRects=function(e){var e=this.mainGraphicsContext.selectAll(F.CategoryValueClasses.selector).data(e,function(e){return e.key}),t=e.enter().append("rect").attr("class",function(e){return F.CategoryValueClasses.class.concat(e.highlight?"highlight":"")}).merge(e);return e.exit().remove(),t},F.prototype.createConnectors=function(e){var e=this.mainGraphicsContext.selectAll(F.WaterfallConnectorClasses.selector).data(e.slice(0,e.length-1),function(e){return e.key}),t=e.enter().append("line").classed(F.WaterfallConnectorClasses.class,!0).merge(e);return e.exit().remove(),t},F.prototype.render=function(e){var t,i,a=this,r=this.clippedData.series[0].data,s=this.createRects(r),r=this.createConnectors(r),o=this.clippedData.strokeSettings,n=(this.tooltipsEnabled&&this.tooltipService.addTooltip(s,function(e){return e.data&&e.data.tooltipInfo()},function(e){return e.data&&e.data.identity&&[e.data.identity]}),this.interactivityService&&this.interactivityService.hasSelection()),l=this.xAxisProperties.scale,c=this.yAxisProperties.scale,u=c.domain()[0],d=this.yAxisProperties.invertAxis,o=(this.mainGraphicsSVG.attr("height",this.getAvailableHeight()).attr("width",this.getAvailableWidth()),o&&o.visible&&this.mainGraphicsSVG.style("stroke",o.color).style("stroke-width",o.width),s.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return 1===e.barType?T.ColumnUtil.DefaultOpacity:T.ColumnUtil.getFillOpacity(e.selected,e.highlight,n,a.data.hasHighlights)}).attr("width",this.layout.categoryWidth).attr("x",function(e){return l(e.categoryIndex)}).attr("y",function(e){var t;return d?(t=0,t=e.position<u?Math.abs(c(u)-c(e.value)):Math.abs(c(e.position)-c(e.position+e.value)),T.CartesianHelper.getRectTop(c,e.position,e.value)-t):T.CartesianHelper.getRectTop(c,e.position,e.value)}).attr("height",function(e){return e.position<u?Math.abs(c(u)-c(e.value)):Math.abs(c(e.position)-c(e.position+e.value))}),this.interactivityService&&(o=jsCommon.BrowserUtils.isInternetExplorerOrEdge(),s.attrs({tabindex:0,focusable:!0,"aria-label":function(e){return T.tooltipUtils.formatTooltipInfo(e.tooltipInfo())},role:"option","aria-selected":function(e){return e.selected}}).classed(T.SetFocusRingClassName,!o)),r.style("stroke",T.ColorHelper.getThemeColor(this.style,F.DefaultWaterfallConnectorColorName)).attrs({x1:function(e){return l(e.categoryIndex)},y1:function(e){return c(e.position+e.value)},x2:function(e){return l(e.categoryIndex+1)+a.layout.categoryWidth},y2:function(e){return c(e.position+e.value)}}),this.data.dataLabelsSettings),r=[];return(o&&o.show||o.showCategory)&&(r=this.createLabelDataPoints()),this.interactivityService&&(i={navigationStrategy:T.DataPointNavigationStrategy.CategoryOnly,helper:this},t={root:this.mainGraphicsContext,bars:s,isBreakdown:this.data.isBreakdown}),T.SVGUtil.flushAllD3TransitionsIfNeeded(this.animationOptions),{dataPoints:this.data.series[0].data,behaviorOptions:t,navigationOptions:i,labelDataPoints:r,labelsAreNumeric:!0,labelOrientation:o.labelOrientation,animateLabels:!e}},F.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},F.prototype.getSupportedCategoryAxisType=function(){return T.axisType.categorical},F.prototype.getFirstElement=function(){if(_.isEmpty(this.clippedData.series)||_.isEmpty(this.clippedData.series[0].data))return{element:null};var e=this.clippedData.series[0].data[0].categoryIndex;return{element:this.getHTMLElementFromCategoryIndex(e)}},F.prototype.getNextDataPoint=function(e,t,i){var a,r=e;do{switch(i){case T.DataDirection.NextCategory:e+=1,((this.yAxisProperties.totalsEnabled||this.data.isBreakdown)&&e>=this.data.categories.length||!this.yAxisProperties.totalsEnabled&&!this.data.isBreakdown&&e>=this.data.categories.length-1)&&(e=0);break;case T.DataDirection.PreviousCategory:--e<0&&(e=this.yAxisProperties.totalsEnabled||this.data.isBreakdown?this.data.categories.length-1:this.data.categories.length-2);break;case T.DataDirection.NextSeries:case T.DataDirection.PreviousSeries:}}while((a=this.data.series[t].data[e])&&0===a.value&&r!==e);return{element:this.getHTMLElementFromCategoryIndex(e),targetCategoryIndex:e}},F.prototype.getHTMLElementFromCategoryIndex=function(t){return this.mainGraphicsContext.selectAll(F.CategoryValueClasses.selector).filter(function(e){return e.categoryIndex===t}).node()},F.prototype.getAvailableWidth=function(){return this.currentViewport.width-(this.margin.left+this.margin.right)},F.prototype.getAvailableHeight=function(){return this.currentViewport.height-(this.margin.top+this.margin.bottom)},F.prototype.getSentimentColorsFromObjects=function(e){var t=T.ColorHelper.create(this.style);return{increaseFill:{solid:{color:t.getColorForPropertyWithDefaultColor(e,T.waterfallChartProps.sentimentColors.increaseFill,T.ColorHelper.getSentimentColor(this.style,"good"))}},decreaseFill:{solid:{color:t.getColorForPropertyWithDefaultColor(e,T.waterfallChartProps.sentimentColors.decreaseFill,T.ColorHelper.getSentimentColor(this.style,"bad"))}},totalFill:{solid:{color:t.getColorForPropertyWithDefaultColor(e,T.waterfallChartProps.sentimentColors.totalFill,T.ColorHelper.getDataColorByIndex(this.style,0))}},otherFill:{solid:{color:t.getColorForPropertyWithDefaultColor(e,T.waterfallChartProps.sentimentColors.otherFill,T.ColorHelper.getSentimentColor(this.style,"neutral"))}}}},F.prototype.createLabelDataPoints=function(){for(var e=[],t=this.data,i=this.xAxisProperties.scale,a=this.yAxisProperties.scale,r=this.yAxisProperties.invertAxis,s=a(0),o=t.series,n=T.DataLabelViewModel.createColumnFormatterCacheManager(),l=t.dataLabelsSettings,c=T.DataLabelRenderer.getLabelUnitAndPrecisionForAxis(this.yAxisProperties,l),u=0,d=o;u<d.length;u++)for(var h=d[u],p=0,g=h.data;p<g.length;p++){var y=g[p],m={left:i(y.categoryIndex),top:r?T.CartesianHelper.getRectTopInverted(a,y.position,y.value):T.CartesianHelper.getRectTop(a,y.position,y.value),width:this.layout.categoryWidth,height:Math.abs(s-a(Math.abs(y.value)))},f=y.labelFormatString,f=n.getOrCreate(f,this.data.dataLabelsSettings,c.units,c.getPrecision(!!f,h.type)),f=T.DataLabelRenderer.getLabelFormattedText(f.format(y.value)),v=l.fontProperties,S=T.FontProperties.toTextProperties(v,f),x=I.TextMeasurementService.measureSvgTextWidth(S),S=I.TextMeasurementService.estimateSvgTextHeight(S,!0),b=this.getValidPositions(l.position,y.value);e.push({isPreferred:!0,text:f,textSize:{width:x,height:S},outsideFill:null!=(f=y.labelFill)?f:T.ColorHelper.getThemeColor(this.style,T.DataLabelViewModel.DefaultLabelColorName),insideFill:T.ColorHelper.getThemeColor(this.style,T.DataLabelViewModel.DefaultInsideLabelColorName),parentType:1,parentShape:{rect:m,orientation:0<=y.value?r?2:1:r?1:2,validPositions:b},fontProperties:v,identity:void 0,hasBackground:l.enableBackground,backgroundColor:l.backgroundColor,backgroundTransparency:l.backgroundTransparency})}return e},F.prototype.getValidPositions=function(e,t){if(0===t)return F.validZeroLabelPosition;switch(e){case T.labelPosition.insideEnd:return[4];case T.labelPosition.insideCenter:return[1];case T.labelPosition.insideBase:return[2];case T.labelPosition.outsideEnd:return[16];default:return F.validLabelPositionsAuto}},F.prototype.getCartesianVisualCapabilities=function(){return{supportsHierarchicalCategoryAxis:!1}},F.prototype.getStaticSeriesRole=function(){},F.prototype.addWarnings=function(e){this.viewModelAdapter&&this.viewModelAdapter.addWarnings(e)},F.formatStringProp={objectName:"general",propertyName:"formatString"},F.WaterfallClassName="waterfallChart",F.MainGraphicsContextClassName="mainGraphicsContext",F.IncreaseLabel="Increase",F.DecreaseLabel="Decrease",F.TotalLabel="Waterfall_TotalLabel",F.OtherLabel="Waterfall_OtherLabel",F.CategoryValueClasses=e("column"),F.WaterfallConnectorClasses=e("waterfall-connector"),F.AutoLabelPosition="Auto",F.DefaultWaterfallConnectorColorName="foregroundNeutralTertiary",F.MinimumBreakdowns=1,F.MaximumBreakdowns=20,F.DefaultBreakdowns=5,F.DefaultTotalsEnabled=!0,F.validLabelPositionsOptions=[F.AutoLabelPosition,t.outsideEnd,t.insideEnd,t.insideCenter,t.insideBase],F.validLabelPositionsAuto=[16,4,1,2],F.validZeroLabelPosition=[16,8],T.WaterfallChart=F}(I.visuals||(I.visuals={}))}(powerbi=powerbi||{}),function(e){!function(n){var l=jsCommon.BrowserUtils;function e(){}e.prototype.create=function(){return new t},n.WaterfallChartWebBehaviorFactory=e;i.prototype.bindEvents=function(a,r,e){var t,i,s=this,o=this.bars=a.bars;e&&(t=e.dataPointNavigationManager,e=e.pointSourceKey,t.isEmpty(e)||(i=a.root,n.InteractivityUtils.registerEnterPlotAreaHandler(i,t,e),n.InteractivityUtils.registerDataPointNavigationHandler(i,t,e),n.InteractivityUtils.registerClearCatcherShortcut(i,r))),o.on("click",function(e){return s.handleSelection(e,r,a.isBreakdown)}).on("keydown",function(e){var t=d3.event,i=t.keyCode;32!==i&&13!==i||(t.preventDefault(),t.stopPropagation(),s.handleSelection(e,r,a.isBreakdown))}),o.on("contextmenu",function(e){var t=d3.event;l.isCtrlOrMeta(t)||(t.preventDefault(),n.EventBubblingUtil.markAsHandled(t),1!==e.barType&&(t=n.InteractivityUtils.getPositionOfLastInputEvent(),r.handleContextMenu(e,t)))})},i.prototype.renderSelection=function(t){this.bars.attr("aria-selected",function(e){return e.selected}).style("fill-opacity",function(e){return 1===e.barType?n.ColumnUtil.DefaultOpacity:n.ColumnUtil.getFillOpacity(e.selected,e.highlight,t,!1)}).style("stroke-opacity",function(e){return 1===e.barType?n.ColumnUtil.DefaultOpacity:n.ColumnUtil.getFillOpacity(e.selected,e.highlight,t,!1)})},i.prototype.renderFocus=function(e){e&&l.focus(e)},i.prototype.handleSelection=function(e,t,i){var a,r;1!==e.barType&&(a=n.InteractivityUtils.getPositionOfLastInputEvent(),r=void 0,r=i?0:jsCommon.SelectionUtility.getMultiSelectMode(d3.event),t.handleSelection(e,r,a))};var t=i;function i(){}n.WaterfallChartWebBehavior=t}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),define("CartesianVisuals/cartesianModule",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createScatterChartMobileBehaviorFactory=t.createDashboardColumnChartAnimator=t.createRealTimeLineChartAnimator=t.createWaterfallChartWebBehaviorFactory=t.createScatterChartWebBehaviorFactory=t.createLineChartWebBehaviorFactory=t.createDataDotChartWebBehaviorFactory=t.createColumnChartWebBehaviorFactory=t.createCartesianChartBehaviorFactory=t.createWebColumnChartAnimator=t.createCartesianChart=void 0;var i=powerbi.visuals,a=i.CartesianChart,r=i.CartesianChartBehaviorFactory,s=i.ColumnChartWebBehaviorFactory,o=i.DashboardColumnChartAnimator,n=i.DataDotChartWebBehaviorFactory,l=i.LineChartWebBehaviorFactory,c=i.RealTimeLineChartAnimator,u=i.ScatterChartMobileBehaviorFactory,d=i.ScatterChartWebBehaviorFactory,h=i.WaterfallChartWebBehaviorFactory,p=i.WebColumnChartAnimator;t.createCartesianChart=function(e){return new a(e)},t.createWebColumnChartAnimator=function(e){return new p(e)},t.createCartesianChartBehaviorFactory=function(e,t){return new r(e,t)},t.createColumnChartWebBehaviorFactory=function(){return new s},t.createDataDotChartWebBehaviorFactory=function(){return new n},t.createLineChartWebBehaviorFactory=function(){return new l},t.createScatterChartWebBehaviorFactory=function(){return new d},t.createWaterfallChartWebBehaviorFactory=function(){return new h},t.createRealTimeLineChartAnimator=function(e){return new c(e)},t.createDashboardColumnChartAnimator=function(e){return new o(e)},t.createScatterChartMobileBehaviorFactory=function(){return new u}}),function(v){var S,e;function x(e,t){var i=[],a=[],r=[];return S.ReferenceLineHelper.gatherDomainExtents(e,i,a,r,t),[{min:d3.min(i),max:d3.max(i)},{min:d3.min(a),max:d3.max(a)},{min:d3.min(r),max:d3.max(r)}]}function b(e){var t=e.x,t={tickLabels:t.labelFontProperties,title:t.titleFontProperties},i=e.y,i={tickLabels:i.labelFontProperties,title:i.titleFontProperties},e=e.y2;return{x:t,y:i,y2:{tickLabels:e.labelFontProperties,title:e.titleFontProperties}}}function C(e,t){var i={x:e.x.showAxisTitle,y:e.y.showAxisTitle,y2:e.y2.showAxisTitle};return i=t?t.updateShowAxisTitles(i,e):i}S=v.visuals||(v.visuals={}),(e=S.CartesianAxesLayoutBuilder||(S.CartesianAxesLayoutBuilder={})).build=function(e){var t=e.axes,i=e.axisZoom,a=e.calculatePlotArea,r=e.data,s=e.interactivityOptions,o=e.layers,n=e.playAxesRect,l=e.referenceLines,c=e.trimOrdinalDataOnOverflow,u=e.type,d=e.viewport,h=e.featureSwitches,p=e.rotateXTickLabels90,e=e.forceMarginMin,g=v.Prototype.inherit(S.SvgCartesianAxes.AxisPadding),y=C(r,i),u=function(e,t){t=S.ComboChart.isComboChart(t);return S.CartesianChartLayout.shouldRenderAxis(e,t)}(r,u),r=b(r),m=(l=x(l,S.CartesianChart.getCategoryValueType(o)))[0],f=l[1],l=l[2],i=null==i?void 0:i.skipMergingValueAxisDomains();return t.negotiateAxes({layers:o,parentViewport:d,padding:g,playAxisControlLayout:n,showAxisTitles:y,shouldRenderAxis:u,axesFontProperties:r,interactivityRightMargin:(t=c,(o=s)&&o.isInteractiveLegend&&!t?S.INTERACTIVITY_RIGHT_MARGIN:0),calculatePlotArea:a,skipMergeValueAxes:i,ensureXDomain:m,ensureYDomain:f,ensureY2Domain:l,rotateXTickLabels90:p,featureSwitches:h,forceMarginMin:e})},e.getMinimumDomainExtents=x,e.getAxesFontProperties=b,e.showAxisTitles=C}(powerbi=powerbi||{}),function(t){!function(y){var m=t.visuals.controls.SvgScrollbar;function e(e){var t=(this.settings=e).axes,i=e.data,a=e.container,e=e.featureSwitches;this.svgAxes=new y.SvgCartesianAxes(t),this.svgAxes.init(a,i),this.navigationHelper=new y.CartesianChartNavigationHelper,this.featureSwitches=e}e.prototype.destroy=function(){this.scrollableAxes&&this.scrollableAxes.destroy(),this.svgScrollbar&&this.svgScrollbar.remove(),this.scrollableAxes=void 0,this.svgScrollbar=void 0},e.prototype.update=function(e,t){this.svgScrollbar&&this.svgScrollbar.updateScrollbarOptions(t),this.svgAxes.update(e)},e.prototype.render=function(e,t,a,i,r,s,o,n,l){var c,u,d,h,p=this,g=y.CartesianAxesLayoutBuilder.getAxesFontProperties(e);if(this.options=o,!l&&((l=y.CartesianAxesLayoutBuilder.build({data:e,interactivityOptions:this.settings.interactivity,referenceLines:i,type:this.settings.type,axes:this.settings.axes,layers:a,viewport:r,playAxesRect:o.playAxesRect,calculatePlotArea:this.settings.calculatePlotArea,trimOrdinalDataOnOverflow:o.trimOrdinalDataOnOverflow,axisZoom:t,rotateXTickLabels90:void 0,featureSwitches:this.featureSwitches})).plotArea.width<1||l.plotArea.height<1))return l;if(!this.settings.suppressBrush||!(r.height<1||r.width<1))return a.forEach(function(e,t){var i;0!==t&&l.axes.y2?i=2:(i=1)===a.length&&l.axes.y2&&(i|=2),e.setAxesLayout({layout:l,trimOrdinalDataOnOverflow:o.trimOrdinalDataOnOverflow,axisType:i})}),t&&t.render(l,e),i=l.axes.x.isCategoryAxis?l.axes.x:l.axes.y1,o.categoryLoadMoreDataHandler&&o.categoryLoadMoreDataHandler.setScale(i.scale),r=function(e,t,i,a,r){return p.renderAxes(e,t,i,o.animationDuration,o.ease,g,s,o.isHierarchicalAxis,n,o.formatMode,a,r)},t=o.supportsScrolling,(this.svgScrollbar||this.scrollableAxes)&&this.svgScrollbar&&this.scrollableAxes,t?(this.svgScrollbar||(c=(i=this.settings).container,u=i.onExtentUpdate,d=i.axes,h=i.animateCategoryAxis,i=i.animateValueAxis,this.svgScrollbar=new m({scrollbarWidth:y.ScrollableAxes.ScrollbarWidth,onExtentUpdate:u}),this.scrollableAxes=new y.ScrollableAxes(d,this.svgScrollbar,h,i),this.svgScrollbar.init(c)),this.scrollableAxes.render(l,a,o.suppressAnimations,r,o.isHierarchicalAxis,o.preserveScrollPosition,o.categoryLoadMoreDataHandler,this.settings.suppressBrush,this.settings.type,e.hasY2Role,o.formatMode,o.subSelectionHelper)):(this.svgScrollbar&&(this.svgScrollbar.remove(),this.scrollableAxes.destroy(),this.svgScrollbar=void 0,this.scrollableAxes=void 0),r(a,l,o.suppressAnimations,this.settings.animateCategoryAxis,this.settings.animateValueAxis,o.isHierarchicalAxis)),this.navigationHelper.updateScrollCallbacks(t?o.navigationScrollCallbacks:void 0),this.eventsBoundForAxesLayout!==l&&(this.bindScrollWheelEvents(l,this.settings.container,o.formatMode,o.subSelectionHelper),this.bindTouchEvents(l,this.settings.container,o.formatMode,o.subSelectionHelper),this.eventsBoundForAxesLayout=l),l},e.prototype.renderAxes=function(e,t,i,a,r,s,o,n,l,c,u,d){a=this.svgAxes.renderAxes({axesLayout:t,duration:a,axesFontProperties:s,animateCategoryAxis:u,animateValueAxis:d,easing:r,shouldRenderGridLinesOnly:this.options.shouldRenderGridLinesOnly,useManagedTabIndex:l,featureSwitches:this.featureSwitches,formatMode:c});a&&a.navigationOptions&&this.settings.behavior&&(s=a.navigationOptions,this.navigationHelper.clearNavigationLayers(),this.navigationHelper.addNavigationLayer(s.helper),d={isAxis:!0,navigationOptions:{helper:this.navigationHelper,navigationStrategy:s.navigationStrategy},pointSourceKey:"cartesian-axis"+(this.settings.multipleId||""),isHierarchicalAxis:n},this.navigationHelper.getPendingFocusElement&&(d.navigationOptions.focusElement=this.navigationHelper.getPendingFocusElement()),this.settings.interactivityService.bind(a.dataPoints,this.settings.behavior,a.behaviorOptions,d),this.settings.behavior.renderSelection(this.settings.interactivityService.hasSelection())),o(e,t,i,u,u,n)},e.prototype.getLayerContainer=function(){return this.svgAxes.getScrollableRegion()},e.prototype.getDataLabelContainers=function(){return this.svgAxes.getLabelsContainers()},e.prototype.getSeriesLabelContainers=function(){return this.svgAxes.getSeriesLabelsContainers()},e.prototype.setExtent=function(e){this.scrollableAxes&&this.scrollableAxes.setExtent(e)},e.prototype.scrollDelta=function(e){this.scrollableAxes&&this.scrollableAxes.scrollDelta(e)},e.prototype.scrollTo=function(e){this.scrollableAxes&&this.scrollableAxes.scrollTo(e)},e.prototype.shouldScrollTo=function(e){return!!this.scrollableAxes&&this.scrollableAxes.shouldScrollTo(e)},e.prototype.scrollBy=function(e){this.scrollableAxes&&this.scrollableAxes.scrollBy(e)},e.prototype.clearRenderingTimeout=function(){this.scrollableAxes&&this.scrollableAxes.clearRenderingTimeout()},e.prototype.bindTouchEvents=function(r,e,s,o){var n=this,l={x:0,y:0};this.settings.eventManager.on(e.node(),"touchstart",function(){var e;0===n.options.viewMode&&(r.isXScrollBarVisible||r.isYScrollBarVisible)&&(e=d3.event.changedTouches[0],l.x=e.pageX,l.y=e.pageY)}),this.settings.eventManager.on(e.node(),"touchmove",function(){var e,t,i,a=n.settings.hostServices&&n.settings.hostServices.tooltips();0!==n.options.viewMode||!r.isXScrollBarVisible&&!r.isYScrollBarVisible||a&&a.isTouchScreenOptimizedEnabled()&&a.visible()||(s&&null!=o&&o.onVisualScroll(),n.settings.tooltipService.hide(),e=(a=d3.event).changedTouches[0],i=l.x-e.pageX,t=l.y-e.pageY,i=r.isXScrollBarVisible?i:t,n.settings.onScroll?n.settings.onScroll(i):n.scrollableAxes&&n.scrollableAxes.scrollDelta(i),l.x=e.pageX,l.y=e.pageY,a.preventDefault())})},e.prototype.bindScrollWheelEvents=function(a,e,r,s){var o=this;this.settings.eventManager.on(e.node(),"wheel",function(){if(a.isXScrollBarVisible||a.isYScrollBarVisible){r&&null!=s&&s.onVisualScroll(),o.settings.tooltipService.hide();var e=d3.event,t=e.deltaX,i=e.deltaY,t=Math.abs(t)>Math.abs(i)?t:i;if(o.settings.onScroll){if(o.options.isSmallMultiples&&!e.shiftKey)return;o.settings.onScroll(t)}else o.scrollableAxes.scrollDelta(t);e.preventDefault()}})},y.CartesianAxesRenderer=e}(t.visuals||(t.visuals={}))}(powerbi=powerbi||{}),function(F){var I,k,O;function N(){}function a(i,e,t,a){var r=I.CartesianChart.getLayerDataViews(e);if(_.isEmpty(t))return!1;e=null==a?t:[t[a]];return _.every(e,function(e,t){return!r[t]||i(e)})}I=F.visuals||(F.visuals={}),k=I.AxisDataModel.AxesData,N.prototype.convert=function(e){for(var t=e.dataViews,i=e.layers,a=e.layerStyle,r=e.categoryAxisTitleOnByDefault,s=e.valueAxisTitleOnByDefault,o=e.chartType,n=e.hasDataChanged,l={scrollbarWidth:I.ScrollableAxes.ScrollbarWidth},c=[],u=[],d=I.CartesianChart.getLayerDataViews(t),h=_.filter(t,I.ForecastHelper.isDataViewForForecast),p=[],g=1<i.length&&!!(t[0]&&t[0].categorical&&t[0].categorical.values),y=a.colorPalette.dataColors,m=(y.clearPreferredScale(),_.filter(t,I.TrendLineHelper.isDataViewForRegression)),f=new I.VisualWarningBuilder,v=_.filter(t,I.AnomalyDetectionVisualPlugin.isDataViewForAnomalyDetection),S=0,x=i.length;S<x;S++){var b=d[S],C=i[S],w=b?[b]:[],w=(null!=h[S]&&w.push(h[S]),null!=v[S]&&w.push(v[S]),i[S].setData(w,e.multipleInfo),function(e,t,i,a,r){var s,o,n=0;e.calculateCustomLegend&&(s=e.calculateCustomLegend(),n=s?s.dataPoints.length:0);t&&n<=1&&(o=I.Legend.buildSeriesLegendData({dataView:t,showByDefault:!0,staticSeriesRoleNames:[e.getStaticSeriesRole()],style:i,allowLegendWithNoSeries:a},function(e){return 3===e||5===e||4===e||6===e||8===e||7===e||10===e}(r)));return!e.calculateCustomLegend||n<=1&&o&&o.isGradientLegend?o:s}(C,b,a,g,o));w&&p.push(w),u.push.apply(u,I.CartesianChart.getDataBoundReferenceLines(b,i[S],a,e.featureSwitches)||[]),!N.supportsTrendLines(t,i,S)||(C=m[S])&&(w=I.TrendLineHelper.readDataView(C,b,0<S,a),c.push.apply(c,w||[])),1<x&&y.rotateScale()}var D,A,P,L,M,V=1<p.length?I.Legend.mergeLegendData(p):1===p.length?p[0]:I.Legend.getDefaultLegendData(a),T=I.AxisZoom.converter(_.head(t));return _.isEmpty(t)?M=k.createDefault(a):(P=t[0],L=t[1],A=!1,(D=P.metadata)&&P.categorical&&!_.isEmpty(P.categorical.categories)&&(A=!!I.ScalarUtils.getScalarKeys(P.categorical.categories[0])),A=I.CartesianHelper.getCategoryAxisProperties(D,A||r),r=I.CartesianHelper.getValueAxisProperties(D,s),D=I.CartesianHelper.getValueAxisProperties(D,s,"y2Axis"),s=N.getDefaultLineChartSeriesLabelSettings(),r={valueAxisProperties:r,y2AxisProperties:D,categoryAxisProperties:A,isYCategorical:I.CartesianChart.shouldYAxisBeCategorical(o),isValueAxisDisabled:!N.supportsValueAxis(t,i),isScatter:10===o,isComboChart:I.ComboChart.isComboChart(o),style:a,hasY2Role:F.data.DataRoleHelper.hasRoleInDataView(P,"Y2")||L&&F.data.DataRoleHelper.hasRoleInDataView(L,"Y2"),forceShowY2:T.show&&T.showOnValueSecAxis||!_.isEmpty(e.multipleInfo)&&I.ComboChart.isComboChart(o),show:(N.isLineComboChart(o)?i[0].getSeriesSettings():s).show,seriesMaximumWidth:(N.isLineComboChart(o)?N.getMaximumSeriesSettings(i):s).seriesMaximumWidth,seriesPosition:(N.isLineComboChart(o)?i[0].getSeriesSettings():s).seriesPosition,isLineComboChart:N.isLineComboChart(o),defaultSeriesWidth:(N.isLineComboChart(o)?N.getMaximumSeriesSettings(i):s).defaultSeriesWidth},M=new k(r),n&&(D=t,A=u,P=a,L=i,s=e.chartType,r=e.featureSwitches,D&&0<D.length&&((n=D[0].metadata)&&(D=O.supportsStaticReferenceLines(D,L),A.push.apply(A,function(e,t,i,a,r){var s=I.ColorHelper.getDataColorByIndex(t,0,I.ForegroundColorName),o=[];i&&(i=F.DataViewObjects.getUserDefinedObjects(e.objects,I.ReferenceLineHelper.xAxisRefLineObjectName),o.push.apply(o,I.ReferenceLineHelper.readDataView(i,s,I.ReferenceLineHelper.xAxisRefLineObjectName,0,t,r,a,void 0)||[]));i=F.DataViewObjects.getUserDefinedObjects(e.objects,I.ReferenceLineHelper.y1AxisRefLineObjectName);return o.push.apply(o,I.ReferenceLineHelper.readDataView(i,s,I.ReferenceLineHelper.y1AxisRefLineObjectName,1,t,r)||[]),o}(n,P,D,s,r)||[]))))),{legendData:V,trendLines:c,referenceLines:u,axesData:M,warningObjectCollection:f,showIcon:!1,scrollbarOptions:l,zoomData:T}},N.getDefaultLineChartSeriesLabelSettings=function(){var e=I.DataLabelViewModel.getDefaultLabelSettings({labelColor:"#FFF",textClassName:"smallLightLabel"}).fontProperties;return{seriesColor:"#FFF",seriesPosition:I.labelSeriesPosition.right,fontProperties:e,seriesWordWrap:!1,seriesMaximumWidth:20,defaultSeriesWidth:20,showLabelPerSeries:!1,enableBackground:!1,show:!1}},N.isLineComboChart=function(e){return 0===e||11===e||14===e||15===e||1===e||2===e},N.getMaximumSeriesSettings=function(e){var t,i,a;return 1<e.length?(t=e[0].getSeriesSettings(),i=e[1].getSeriesSettings(),a=t.seriesMaximumWidth,i.seriesMaximumWidth<a?t:i):e[0].getSeriesSettings()},N.supportsTrendLines=function(e,t,i){return a(function(e){return e.supportsTrendLine&&e.supportsTrendLine()},e,t,i)},N.supportsValueAxis=function(e,t,i){return a(function(e){e=e.getCartesianVisualCapabilities().supportsValueAxis;return void 0===e||e},e,t,i)},N.supportsDataBoundReferenceLines=function(e,t,i){return a(function(e){return!e.isStacked||!e.isStacked()},e,t,i)},N.supportsStaticReferenceLines=function(e,t,i){return a(function(e){return!e.supportsStaticReferenceLines||e.supportsStaticReferenceLines()},e,t,i)},O=N,I.CartesianChartConverter=O}(powerbi=powerbi||{}),function(S){!function(l){function e(e,t,i,a,r,s,o,n){this.options=e,this.behaviorFactory=t,this.featureSwitches=i,this.axes=a,this.type=r,this.isPlayAxis=s,this.scrollOnRowsEnabled=o,this.adapterFactory=n}e.prototype.init=function(e,t,i,a,r,s,o,n){this.initOptions=e,this.tooltipService=t,this.legend=i,this.axesData=a,this.interactivityService=r,this.layerStyle=s,this.rowLoadMoreDataHandler=o,this.eventManager=n},e.prototype.create=function(e){var t=new i(this.options,this.behaviorFactory,this.featureSwitches,this.axes,this.type,this.isPlayAxis,this.axesData,this.scrollOnRowsEnabled,this.adapterFactory);return t.init(e,this.initOptions,this.tooltipService,this.legend,this.interactivityService,this.layerStyle,this.rowLoadMoreDataHandler,this.eventManager),t},l.CartesianChartLayoutBuilder=e;t.prototype.render=function(e,t){var i,a;this.shouldRender()&&(a=(i=this.data).position||l.LegendPosition.Top,this.legend.setPosition(a),1!==i.dataPoints.length||i.grouped||((i=S.Prototype.inherit(i)).dataPoints=[]),this.legend.drawLegend(i,this.viewport,e,t))},t.prototype.shouldRender=function(){return!(this.interactivity&&this.interactivity.isInteractiveLegend)},t.prototype.getMargin=function(){return this.legend.getMargins()},t.prototype.getPosition=function(){return this.legend.getPosition()},t.prototype.adjustChartArea=function(e){l.Legend.positionChartArea(e,this.legend)},t.prototype.isRenderedLeftOrRight=function(){return this.legend.isVisible()&&l.Legend.isLeftOrRight(this.legend.getPosition())};var r=t;function t(e,t,i,a){this.legend=e,this.data=t,this.viewport=i,this.interactivity=a}l.CartesianLegendRender=r;v.prototype.init=function(e,t,i,a,r,s,o,n){this.options=t,this.tooltipService=i,this.legend=a,this.interactivityService=r,this.layerStyle=s,this.element=e,this.rowLoadMoreDataHandler=o,this.eventManager=n,this.hostServices=t.host,this.gridContainer=$(document.createElement("div")).appendTo(this.element),this.gridContainer.addClass(v.GridContainerClassName),this.behavior=null==(i=this.behaviorFactory)?void 0:i.create(),this.visibilityHelper=S.responsiveVisualUtilModuleFactory().visibilityHelper(this.element,v.IconClassName);a=d3.select(this.element.get(0)),r=this.chartAreaSvg=a.append("svg");r.classed(v.ClassName,!0),r.attr("name",this.getCartesianChartName()),r.style("position","absolute"),this.featureSwitches.removeScaleDetector||(s=a.append("svg").styles({position:"absolute",visibility:"hidden"}),this.svgScaleDetector=new l.SVGScaleDetector(s)),this.behavior&&(this.clearCatcher=l.appendClearCatcher(r),this.axisBehavior=new l.AxisBehavior),this.viewMode=t.host.getViewMode()},v.prototype.getCartesianChartName=function(){switch(this.type){case 0:return this.hostServices.getLocalizedString("LineChart_ToolTip");case 1:return this.hostServices.getLocalizedString("AreaChart_ToolTip");case 2:return this.hostServices.getLocalizedString("StackedAreaChart_ToolTip");case 3:return this.hostServices.getLocalizedString("ClusteredColumnChart_ToolTip");case 4:return this.hostServices.getLocalizedString("ColumnChart_ToolTip");case 5:return this.hostServices.getLocalizedString("ClusteredBarChart_ToolTip");case 6:return this.hostServices.getLocalizedString("BarChart_ToolTip");case 7:return this.hostServices.getLocalizedString("HundredPercentStackedBarChart_ToolTip");case 8:return this.hostServices.getLocalizedString("HundredPercentStackedColumnChart_ToolTip");case 9:return this.hostServices.getLocalizedString("RibbonChart_ToolTip");case 10:return this.hostServices.getLocalizedString("ScatterChart_ToolTip");case 11:return this.hostServices.getLocalizedString("ComboChart_ToolTip");case 13:return this.hostServices.getLocalizedString("WaterfallChart_ToolTip");case 14:return this.hostServices.getLocalizedString("LineClusteredColumnComboChart_ToolTip");case 15:return this.hostServices.getLocalizedString("LineStackedColumnComboChart_ToolTip");case 16:return this.hostServices.getLocalizedString("DataDotClusteredColumnComboChart_ToolTip");case 17:return this.hostServices.getLocalizedString("DataDotStackedColumnComboChart_ToolTip");case 18:return this.hostServices.getLocalizedString("LineChart_ToolTip");case 19:return this.hostServices.getLocalizedString("Histogram_Tooltip")}return this.hostServices.getLocalizedString("Chart")},v.prototype.render=function(o,n,l,c,u,d,h,p,g,y,m,f){return __awaiter(this,void 0,S.Promise,function(){var t,i,a,r,s;return __generator(this,function(e){switch(e.label){case 0:return(this.cartesianSmallMultipleFactory=o,this.featureSwitches.removeScaleDetector||this.svgScaleDetector.recalculate(),this.viewportScale=n.scale,o.clearRenderingTimeout(),t=o.getCoreMultiple(),i=t.getData())?(this.axesData=i.axesData,this.formatMode=y,s=this.renderLegend(i.legendData,n,p,y),a=s[0],s=s[1],this.chartAreaViewport={height:n.height-a.height,width:n.width-a.width,scale:n.scale},r=u.renderContainers(this.chartAreaViewport,this.axesData,this.isPlayAxis()?v.PlayAxisBottomMargin:0,this.featureSwitches),this.legendRenderer.adjustChartArea(u.context),this.positionChartArea(a,s,this.isPlayAxis(),r),s=this.calculatePlayAxisControlLayout(this.chartAreaViewport,a,this.legendRenderer.getPosition(),r),o.isSmallMultiples()?[3,1]:(this.cartesianSmallMultiplesLayout&&(this.cartesianSmallMultiplesLayout.destroy(),this.cartesianSmallMultiplesLayout=void 0),this.setGridContainerVisibility(!1),2&t.getState()||t.initRenderer(this.buildPlotAreaLayout(!1)),this.renderMultiple({multiple:t,viewport:n,background:c,axisZoom:u,chartAreaViewport:this.chartAreaViewport,chartAreaMargins:this.chartAreaMargins,renderedViewport:this.renderedPlotArea,playAxisControlLayout:s,suppressAnimations:h,resizeMode:f,trimOrdinalDataOnOverflow:d,categoryLoadMoreDataHandler:l,isSharedAxis:!1,isHierarchicalAxis:p,preserveScrollPosition:g,supportsScrolling:!0,formatMode:y,subSelectionHelper:m}),[3,3])):[2];case 1:return this.setGridContainerVisibility(!0),this.adjustGridContainer(this.chartAreaViewport),this.cartesianSmallMultiplesLayout=this.cartesianSmallMultiplesLayout||this.createSmallMultiplesLayout(),[4,this.cartesianSmallMultiplesLayout.render({viewport:this.chartAreaViewport,axisRendererSettings:this.getAxisRendererSettings(this.chartAreaSvg,!0,!1),cartesianSmallMultipleFactory:o,axesData:this.axesData,animationSettings:this.getAnimationOptions(!0),background:c,playAxisControlLayout:s,suppressAnimations:!0,resizeMode:f,isHierarchicalAxis:p,trimOrdinalDataOnOverflow:d,categoryLoadMoreDataHandler:l,warnings:i.warningObjectCollection})];case 2:e.sent(),e.label=3;case 3:return[2]}})})},v.prototype.setGridContainerVisibility=function(e){this.gridContainer.css("display",e?"":"none")},v.prototype.scrollRowsTo=function(e){this.cartesianSmallMultiplesLayout,this.cartesianSmallMultiplesLayout.scrollRowsTo(e)},v.prototype.destroy=function(){this.cartesianSmallMultiplesLayout&&this.cartesianSmallMultiplesLayout.destroy()},v.prototype.positionChartArea=function(e,t,i,a){this.chartAreaMargins=v.getEmptyMargins(),l.Legend.isLeft(t)&&(this.chartAreaMargins.left=e.width),l.Legend.isTop(t)&&(this.chartAreaMargins.top=e.height),i&&(this.chartAreaViewport.height-=v.PlayAxisBottomMargin),a&&(this.chartAreaViewport.height-=a.top+a.bottom,this.chartAreaViewport.width-=a.left+a.right,this.chartAreaMargins.left=(this.chartAreaMargins.left||0)+a.left,this.chartAreaMargins.top=(this.chartAreaMargins.top||0)+a.top),this.chartAreaSvg.attrs({width:this.chartAreaViewport.width,height:this.chartAreaViewport.height}).styles({"margin-top":this.chartAreaMargins.top?this.chartAreaMargins.top+"px":null,"margin-left":this.chartAreaMargins.left?this.chartAreaMargins.left+"px":null})},v.prototype.createSmallMultiplesLayout=function(){var t=this;return new l.CartesianSmallMultipleLayout(this.gridContainer,this.interactivityService,this.featureSwitches,function(e){return t.hostServices.getLocalizedString(e)},this.rowLoadMoreDataHandler,this.scrollOnRowsEnabled,this.behaviorFactory,this.layerStyle,this.viewMode,this.buildPlotAreaLayout.bind(this),this.renderMultiple.bind(this),this.adapterFactory,this.hostServices.instanceId,this.eventManager)},v.prototype.adjustGridContainer=function(e){this.gridContainer.css({width:e.width,height:e.height}),this.legendRenderer.adjustChartArea(d3.select(this.gridContainer.get(0)))},v.prototype.getVisibleMultiples=function(){return this.cartesianSmallMultiplesLayout?this.cartesianSmallMultiplesLayout.getVisibleMultiples():{startIndex:0,endIndex:1}},v.prototype.renderMultiple=function(e){var t=this,i=this.cartesianSmallMultipleFactory.isSmallMultiples(),a={scrollTo:function(e){return t.scrollTo(e)},shouldScrollTo:function(e){return t.shouldScrollTo(e)},scrollBy:function(e){return t.scrollBy(e)}},i={background:e.background,axisZoom:e.axisZoom,labelAnimationOptions:this.getLabelAnimationOptions(e.suppressAnimations),axesAnimationOptions:this.getAnimationOptions(e.suppressAnimations),renderedPlotArea:e.renderedViewport,viewport:e.viewport,chartAreaViewport:e.chartAreaViewport,chartAreaMargins:e.chartAreaMargins,layerStyle:this.layerStyle,suppressAnimations:e.suppressAnimations,playAxisControlLayout:e.playAxisControlLayout,resizeMode:e.resizeMode,viewMode:this.viewMode,trimOrdinalDataOnOverflow:e.trimOrdinalDataOnOverflow,categoryLoadMoreDataHandler:e.categoryLoadMoreDataHandler,shouldRenderGridLinesOnly:!1,isSmallMultiples:i,multipleId:e.multiple.index.toString(),isHierarchicalAxis:e.isHierarchicalAxis,preserveScrollPosition:e.preserveScrollPosition,supportsScrolling:e.supportsScrolling,navigationScrollCallbacks:a,formatMode:e.formatMode,subSelectionHelper:e.subSelectionHelper},a=e.multiple.getData(),r=(e.isSharedAxis&&(r=this.axesData.valueAxis.show,v.adjustOptionsForSharedAxis(i,e.viewport,e.axesLayout,a,this.featureSwitches,r)),e.multiple.getRenderer());r.axesRenderer.update(a.axesData,a.scrollbarOptions),r.render(e.multiple.layers,a,e.renderedViewport,i,this.viewportScale),this.noLabelsCanBeRendered=r.noLabelsCanBeRendered,this.renderedPlotArea=r.renderedPlotArea},v.prototype.scrollTo=function(e){this.cartesianSmallMultipleFactory&&this.cartesianSmallMultipleFactory.isSmallMultiples()?this.cartesianSmallMultiplesLayout.scrollTo(e):this.cartesianSmallMultipleFactory.scrollTo(e,this.getVisibleMultiples())},v.prototype.shouldScrollTo=function(e){return this.cartesianSmallMultipleFactory&&this.cartesianSmallMultipleFactory.isSmallMultiples()?this.cartesianSmallMultiplesLayout.shouldScrollTo(e):this.cartesianSmallMultipleFactory.shouldScrollTo(e,this.getVisibleMultiples())},v.prototype.scrollBy=function(e){this.cartesianSmallMultipleFactory&&this.cartesianSmallMultipleFactory.isSmallMultiples()?this.cartesianSmallMultiplesLayout.scrollBy(e):this.cartesianSmallMultipleFactory.scrollBy(e,this.getVisibleMultiples())},v.prototype.getLabelAnimationOptions=function(e){e=this.getAnimationOptions(e);return{duration:this.isPlayAxis()?l.PlayChart.getFrameAnimationDuration():e.duration,ease:this.isPlayAxis()?l.D3Helper.easeCompat(l.PlayChart.AnimationEase):e.ease}},v.prototype.getAnimationOptions=function(e){return{ease:this.animator&&this.animator.getEasing(),duration:l.AnimatorCommon.GetAnimationDuration(this.animator,e)}},v.prototype.calculatePlotArea=function(e){if(this.cartesianSmallMultipleFactory&&this.cartesianSmallMultipleFactory.isSmallMultiples())return{width:(t=this.cartesianSmallMultiplesLayout.calculatePlotArea(e)).width,height:t.height,scale:e.viewport.scale};var t=e.viewport,i=e.axesMargins,a={width:t.width-(i.left+i.right),height:t.height-(i.top+i.bottom),scale:t.scale},t=t.width-(i.left+i.right),i=0,t=(null!=e.layerSeriesData.defaultSeriesWidth&&(t=100*e.layerSeriesData.defaultSeriesWidth/t,i=Math.min(Math.max(1,t),50),e.layerSeriesData.seriesMaximumWidth=i),e.layerSeriesData.seriesMaximumWidth/100);return e&&e.showSeriesLabels&&(a.width=a.width-t*a.width),a},v.adjustOptionsForSharedAxis=function(e,t,i,a,r,s){!r.smallMultiplesUnsharedAxes||a.axesData.y.sharedAxis&&a.axesData.x.sharedAxis?(i.shouldRenderAxis.x=!1,i.shouldRenderAxis.y=!1,i.shouldRenderAxis.y2=!1,i.margin=i.axesOverflow,e.shouldRenderGridLinesOnly=!0):e.shouldRenderGridLinesOnly=!s,i.viewport=t,e.axesLayout=i},v.getEmptyMargins=function(){return{top:0,bottom:0,left:0,right:0}},v.prototype.getAxisRendererSettings=function(e,t,i){var a=this,e={axes:this.axes,container:e,type:this.type,data:this.axesData,interactivity:this.options.interactivity,interactivityService:this.interactivityService,behavior:this.axisBehavior,animateCategoryAxis:this.animateCategoryAxis,animateValueAxis:this.animateValueAxis,calculatePlotArea:function(e){return a.calculatePlotArea(e)},hostServices:this.hostServices,tooltipService:this.tooltipService,eventManager:this.eventManager,featureSwitches:this.featureSwitches,formatMode:this.formatMode};return t&&(e.onScroll=function(e){return a.cartesianSmallMultiplesLayout.onScroll(e)},e.onExtentUpdate=function(e){return a.cartesianSmallMultiplesLayout.onExtentUpdate(e)},e.suppressBrush=i),e.data.useManagedTabIndex=!1,e},v.prototype.calculatePlayAxisControlLayout=function(e,t,i,a){var r;return this.isPlayAxis()&&(r=(null==a?void 0:a.left)||0,a=(null==a?void 0:a.bottom)||0,r={left:l.Legend.isLeft(i)?t.width:0,top:l.Legend.isTop(i)?t.height+e.height+a:e.height+a,height:v.PlayAxisBottomMargin,width:e.width+r}),r},v.addCartesianChartContainer=function(e,t){var e=d3.select(e.get(0)),i=e.select("svg"),e=(i.empty()&&((i=e.append("svg")).classed(v.ClassName,!0),i.style("position","absolute")),l.appendClearCatcher(i));return t&&i.attrs({width:t.width,height:t.height}),{element:i,clearCatcher:e}},v.prototype.renderLegend=function(e,t,i,a){return this.legendRenderer=new r(this.legend,e,t,this.options.interactivity),this.legendRenderer.render(i,a),[this.legendRenderer.getMargin(),this.legendRenderer.getPosition()]},v.prototype.buildPlotAreaLayout=function(e,t,i,a,r){var s=this.getAxisRendererSettings(t||this.chartAreaSvg,e,e&&this.isSharedAxis),s=new l.CartesianAxesRenderer(s);return new l.CartesianPlotAreaLayout(this.visibilityHelper,t||this.chartAreaSvg,s,a||this.element,this.type,this.hostServices,r||this.behavior,this.interactivityService,this.isLabelInteractivityEnabled,i||this.clearCatcher,this.animator,this.dataPointLassoSelect&&!e,this.viewportScale,this.featureSwitches)},v.shouldRenderAxis=function(e,t){return{x:e.x.show,y:e.y.show,y2:e.y2.show||t&&!1!==e.y2.show}},v.getPreferredPlotArea=function(e,t,i,a,r,s,o){i={height:i.height-(s=s||{top:0,right:0,bottom:0,left:0}).top-s.bottom,width:i.width-s.left-s.right};return!r&&a&&(s=v.getPreferredCategorySpan(e,t,o),i.width=Math.max(s,i.width)),i},v.getPreferredCategorySpan=function(e,t,i){return t*e+t*(i||0)*2},v.getLayout=function(e,t){var i=t.categoryCount,a=t.availableWidth,r=!!t.isScalar,s=!!t.isScrollable,e=v.getCategoryWidth(e?e.series:null,t),e=v.getCustomizedCategoryWidthInfo(e,t),o=e.categoryWidth,e=e.outerPaddingRatio,n=S.Double.floorWithPrecision((a-o*e*2)/o),n=Math.min(n,i);return r||n<i&&s||(e=Math.max(0,(a-o*n)/2/o),e=S.Double.equalWithPrecision(e,0)?0:e),{categoryCount:n=!r&&s?i:n,categoryThickness:o,outerPaddingRatio:e,innerPaddingRatio:t.innerPaddingRatio,isScalar:r}},v.getCustomizedCategoryWidthInfo=function(e,t){var i=e,a=t.categoryCount,r=t.availableWidth,s=t.isScalar,o=t.preferredCategoryWidth,t=t.outerPaddingRatio;return{categoryWidth:i=s||null==o||o<e?i:(s=Math.floor((r-o*t*2)/o))<=0?r/(1+2*t):s<a?(t=(r-o*s)/(2*o),o):Math.min(o,r),outerPaddingRatio:t}},v.getCategoryWidth=function(e,t){var i,a=t.categoryCount,r=t.availableWidth,s=t.domain,o=t.isScalar,n=t.trimOrdinalDataOnOverflow,t=t.outerPaddingRatio,s=(a<2?i=r*(1-t):o&&s&&1<s.length?(i=r*((e=v.getMinInterval(e))/(s[s.length-1]-s[0]+e*t*2)),i=Math.max(i,l.CartesianChart.MinScalarRectThickness)):(i=r/(a+2*t),n&&(i=Math.max(i,l.CartesianHelper.MinOrdinalRectThickness))),r/(3+2*t));return i=Math.min(i,s),!o&&3<=a&&n?Math.max(i,l.CartesianHelper.MinOrdinalRectThickness):i},v.getMinInterval=function(e){var t=Number.MAX_VALUE;if(0<e.length)for(var i=e[0].data.filter(function(e){return!e.highlight}),a=0,r=i.length-1;a<r;a++){var s=i[a+1].categoryValue,o=i[a].categoryValue;_.isNumber(s),_.isNumber(o),t=Math.min(t,Math.abs(s-o))}return t},v.ClassName="cartesianChart",v.IconClassName="cartesianChartResponsiveIcon",v.GridContainerClassName="cartesian-grid-container",v.PlayAxisBottomMargin=80;var i=v;function v(e,t,i,a,r,s,o,n,l){this.behaviorFactory=t,this.featureSwitches=i,this.axes=a,this.type=r,this.isPlayAxis=s,this.axesData=o,this.scrollOnRowsEnabled=n,this.adapterFactory=l,this.animateCategoryAxis=!1,this.animateValueAxis=!1,this.isSharedAxis=!0,e&&(this.viewMode=0,this.isLabelInteractivityEnabled=e.isLabelInteractivityEnabled,this.dataPointLassoSelect=this.featureSwitches.dataPointLassoSelect&&e.dataPointLassoSelect,this.animator=e.animator,this.animateCategoryAxis=e.animateCategoryAxis,this.animateValueAxis=e.animateValueAxis)}l.CartesianChartLayout=i}(S.visuals||(S.visuals={}))}(powerbi=powerbi||{}),function(e){var l,c,u,d,s;l=e.visuals||(e.visuals={}),s=e.visuals.OnObjectUtil,(e=l.CartesianChartOnObjectUtil||(l.CartesianChartOnObjectUtil={})).getAxisTitleSubSelectionStyles=function(e,t,i){var a=u(e,t),e=d(e,t,"title");return s.getFontOnlyTextSubSelectionStyles(a,e,e+"-font",e+"-color",i)},e.getAxisValuesSubSelectionStyles=function(e,t,i,a){var i=c(t,i),r=u(e,t),e=d(e,t,t&&i?"valuesScalar":"values");return s.getNumericTextSubSelectionStyles(r,e,e+"-font",e+"-color",e+"-precision",e+"-displayUnits",a)},e.getAxisTitleSubSelectionShortcuts=function(e,t,i,a){var r=u(e,t),s=d(e,t,"title"),o=[s],r=[{type:1,destinationUids:[{cardUid:r,groupUid:s}],label:a.getLocalizedString("Format_AxisTitle")}];return c(t,i)&&(o.push(i="zoom-default-"+(e?"valueSecAxis":t?"categoryAxis":"valueAxis")),r.unshift({type:2,sourceUid:i,relatedToggledSourceUids:["Visual-zoom"],enabledLabel:a.getLocalizedString("Format_AddZoomSlider")})),r.unshift({type:2,sourceUid:s,disabledLabel:a.getLocalizedString("Delete"),keyboardShortcuts:[{key:"Delete",nextValue:!1}]},{type:0,relatedResetSourceUids:o}),r},e.getAxisValuesSubSelectionShortcuts=function(e,t,i,a,r){var i=c(t,i),s=u(e,t),o=d(e,t,t&&i?"valuesScalar":"values"),n=[o],o=[{type:1,destinationUids:[{cardUid:s,groupUid:o}],label:r.getLocalizedString("Format_AxisValues")}],i=(i||o.unshift({type:4,sortableField:{queryName:"",sortDirection:1},label:r.getLocalizedString("Format_SortAxis"),key:"Category"}),t&&a===l.axisType.both&&(a=d(e,t,"type")+"-type",n.push(a),o.unshift({type:3,sourceUid:a,label:r.getLocalizedString("Format_Label_AxisType")})),i&&(n.push(a="zoom-default-"+(e?"valueSecAxis":t?"categoryAxis":"valueAxis")),o.unshift({type:2,sourceUid:a,relatedToggledSourceUids:["Visual-zoom"],enabledLabel:r.getLocalizedString("Format_AddZoomSlider")})),d(e,t,"title"));return n.push(i+"-show"),o.unshift({type:2,sourceUid:i,enabledLabel:r.getLocalizedString("Format_AddAxisTitle")}),o.unshift({type:2,sourceUid:s,disabledLabel:r.getLocalizedString("Delete"),keyboardShortcuts:[{key:"Delete",nextValue:!1}]},{type:0,relatedResetSourceUids:n}),o},c=function(e,t){return!e||t},u=function(e,t){return e?"Visual-y2Axis":t?"Visual-categoryAxis":"Visual-valueAxis"},d=function(e,t,i){return e?"y2Axis-"+i:t?"categoryAxis-"+i:"valueAxis-"+i}}(powerbi=powerbi||{}),function(v){!function(A){function e(e,t,i,a,r,s,o,n,l,c,u,d,h,p){this.visibilityHelper=e,this.chartAreaSvg=t,this.axesRenderer=i,this.element=a,this.type=r,this.hostServices=s,this.behavior=o,this.interactivityService=n,this.isLabelInteractivityEnabled=l,this.clearCatcher=c,this.animator=u,this.dataPointLassoSelect=d,this.initialViewportScale=h,this.featureSwitches=p,this.dataPointNavigationHelper=new A.CartesianChartNavigationHelper,this.dataPointLassoSelect&&(this.plotLassoManager=new A.PlotAreaLassoManager(!1),this.plotLassoManager.init([i.getLayerContainer(),c],t,this.hostServices,this.featureSwitches),this.lassoSelectionBehavior=new A.LassoSelectionBehavior(this.behavior),this.plotLassoManager.behaviors.push(this.lassoSelectionBehavior),this.plotLassoManager.setUiScale(this.initialViewportScale))}e.prototype.attachToElement=function(e,t){this.element=e;var i=this.chartAreaSvg;i.attrs({width:t.width,height:t.height}),i.node().parentElement!==e.get(0)&&e.append(i.node())},e.prototype.render=function(e,t,i,a,r){this.options=a,this.renderedPlotArea=i,this.cartesianData=t,this.layers=e,this.plotLassoManager&&this.plotLassoManager.setUiScale(r),this.cartesianData&&(this.cartesianData.showIcon?this.visibilityHelper.updateVisibility({showIcon:this.cartesianData.showIcon,viewport:this.options.viewport}):(this.visibilityHelper.updateVisibility({showIcon:this.cartesianData.showIcon}),this.renderCartesianChart()))},e.prototype.destroy=function(){this.axesRenderer.destroy(),this.chartAreaSvg.html(null),A.visualBackgroundHelper.removeBackgroundImage(this.element)},e.prototype.renderCartesianChart=function(){var a=this,r=this.options,e=!this.renderedPlotArea||this.renderedPlotArea.height!==r.chartAreaViewport.height||this.renderedPlotArea.width!==r.chartAreaViewport.width,e=(this.renderedPlotArea=r.chartAreaViewport,__assign(__assign({},r),{suppressAnimations:r.suppressAnimations||e,playAxesRect:r.playAxisControlLayout,animationDuration:r.axesAnimationOptions.duration,ease:r.axesAnimationOptions.ease,supportsScrolling:r.supportsScrolling,formatMode:r.formatMode,subSelectionHelper:r.subSelectionHelper}));this.axesRenderer.render(this.cartesianData.axesData,this.options.axisZoom,this.layers,this.cartesianData.referenceLines,this.options.chartAreaViewport,function(e,t,i){return a.renderPlotArea(e,t,i,r.resizeMode)},e,void 0,this.options.axesLayout),this.dataPointNavigationHelper.updateScrollCallbacks(r.supportsScrolling?r.navigationScrollCallbacks:void 0)},e.prototype.getPlotAreaRect=function(e){return{left:e.margin.left+this.options.chartAreaMargins.left,top:e.margin.top+this.options.chartAreaMargins.top,width:e.plotArea.width,height:e.plotArea.height}},e.prototype.renderBackgroundImage=function(e){A.visualBackgroundHelper.renderBackgroundImage(this.options.background,this.element,e)},e.prototype.renderPlotArea=function(e,t,i,a){i=i||_.some(e,function(e){return e.shouldSuppressAnimation&&e.shouldSuppressAnimation()});var r=this.getPlotAreaRect(t);this.renderBackgroundImage(r),this.renderReferenceLines(t),this.renderLayers(e,t,i,a),this.renderTrendLines(t)},e.prototype.renderTrendLines=function(e){var t=this.axesRenderer.getLayerContainer();A.TrendLineHelper.render(this.cartesianData.trendLines,t,e.axes,e.plotArea)},e.prototype.renderReferenceLines=function(e){e={graphicContext:this.axesRenderer.getLayerContainer(),axes:e.axes,viewport:e.plotArea,referenceLines:this.cartesianData.referenceLines};A.ReferenceLineHelper.render(e)},e.prototype.getReferenceLineLabels=function(e,t){e={axes:e,viewport:t,referenceLines:this.cartesianData.referenceLines,hostServices:this.hostServices,style:this.options.layerStyle};return A.ReferenceLineHelper.createLabelDataPoint(e)},e.prototype.renderDataLabels=function(e,t,i,a,r,s){var o,n,l,c,u,d,h=this.axesRenderer.getDataLabelContainers(),p=h.foreground,h=h.background,g=[];this.behavior?(o=(n=this.options).formatMode,n=n.labelAnimationOptions,c=this.animator,l=A.DataLabelRenderer.getDataLabelLayoutOptions(this.type),g=new v.LabelLayout(l).layout(e,i),u=void 0,u=c&&!a&&s?A.DataLabelRenderer.animateLabelsAndBackgrounds({labelContext:p,dataLabels:g,duration:n.duration,numeric:t,easeType:n.ease,backgroundContext:h}):A.DataLabelRenderer.drawLabelsAndBackgrounds({labelContext:p,dataLabels:g,numeric:t,backgroundContext:h}),l.allowLeaderLines&&(c=_.filter(g,function(e){return null!=e.leaderLinePoints&&!_.isEmpty(e.leaderLinePoints)&&null!=e.identity}),A.DataLabelRenderer.drawLabelLeaderLines(p,c,function(e){return e.identity.getKey()})),this.interactivityService&&(this.isLabelInteractivityEnabled||o)&&(a={labelItems:u},this.interactivityService.bind(g,new A.LabelsBehavior,a,{isLabels:!0,pointSourceKey:"data-labels",formatMode:o}))):(g=new v.LabelLayout({maximumOffset:A.DataLabelViewModel.maxLabelOffset,startingOffset:A.DataLabelViewModel.startingLabelOffset,attemptToMoveLabelsIntoViewport:!0}).layout(e,i),A.DataLabelRenderer.drawLabelsAndBackgrounds({labelContext:p,dataLabels:g,numeric:t,backgroundContext:h}));for(var y=0,m=e;y<m.length;y++){var f=m[y];if(!_.isEmpty(f.labelDataPoints)){d=!0;break}}return!_.isEmpty(g)||!d},e.prototype.renderSeriesLabels=function(e,t,i,a){var r,s=this.axesRenderer.getSeriesLabelContainers(),o=s.seriesForeground,s=s.seriesBackground,n=new v.LabelLayout({maximumOffset:A.DataLabelViewModel.maxLabelOffset,startingOffset:A.DataLabelViewModel.startingLabelOffset,attemptToMoveLabelsIntoViewport:!0}),l=!!i&&!!i.seriesWordWrap,c=i?i.fontProperties.size.px:0,n=n.layout(e,t),a=i?i.seriesMaximumWidth/100*a:0,i=i&&i.seriesPosition===A.labelSeriesPosition.right?1:0;A.DataLabelRenderer.drawSeriesLabelsAndBackgrounds({labelContext:o,dataLabels:n,backgroundContext:s,availableWidth:a,position:i,seriesWordWrap:l,plotArea:t,seriesFontSize:c});for(var u=0,d=e;u<d.length;u++){var h=d[u];if(!_.isEmpty(h.labelDataPoints)){r=!0;break}}return!_.isEmpty(n)||!r},e.prototype.renderLayers=function(e,t,i,a){for(var r,s,o,n=[],l=[],c=[],u=[],d=!0,h=t.axes,p=t.plotArea,g=(i=i||_.some(e,function(e){return e.shouldSuppressAnimation&&e.shouldSuppressAnimation()}),!0),y=0,m=e;y<m.length;y++){var f=m[y].render(i,a,this.options.formatMode);if(f){if(f.animateLabels||(g=!1),this.behavior&&(c=c.concat(f.dataPoints),u.push(f.behaviorOptions),f.navigationOptions&&(r?r.navigationOptions.navigationStrategy=A.DataPointNavigationStrategy.CategoryFirst:(r={pointSourceKey:"cartesian-layer "+(this.options.multipleId||""),navigationOptions:{navigationStrategy:f.navigationOptions.navigationStrategy,helper:this.dataPointNavigationHelper}},this.dataPointNavigationHelper.clearNavigationLayers()),r.isHierarchicalAxis=this.options.isHierarchicalAxis,this.dataPointNavigationHelper.addNavigationLayer(f.navigationOptions.helper))),f.labelDataPointGroups)for(var v=0,S=f.labelDataPointGroups;v<S.length;v++)(b=S[v])&&n.push({labelDataPoints:A.DataLabelRenderer.removeDuplicates(b.labelDataPoints||[]),maxNumberOfLabels:b.maxNumberOfLabels,labelOrientation:b.isTotal?1:f.labelOrientation});else{var x=f.labelDataPoints||[];n.push({labelDataPoints:A.DataLabelRenderer.removeDuplicates(x),maxNumberOfLabels:x.length,labelOrientation:f.labelOrientation})}if(f.labelDataPointSeriesGroups)for(var b,C=0,w=f.labelDataPointSeriesGroups;C<w.length;C++)(b=w[C])&&l.push({labelDataPoints:A.DataLabelRenderer.removeDuplicates(b.labelDataPoints||[]),maxNumberOfLabels:b.maxNumberOfLabels,labelOrientation:b.isTotal?1:f.labelOrientation});d=d&&f.labelsAreNumeric,this.lassoSelectionBehavior&&(void 0!==f.categorySubRangeCount&&(void 0===s?s=f.categorySubRangeCount:f.categorySubRangeCount),void 0!==f.verticalCategoryAxis&&(void 0===o?o=f.verticalCategoryAxis:f.verticalCategoryAxis))}}var h=this.getReferenceLineLabels(h,p),h=(_.isEmpty(h)||n.unshift({labelDataPoints:h,maxNumberOfLabels:h.length}),this.noLabelsCanBeRendered=!this.renderDataLabels(n,d,p,i,A.ComboChart.isComboChart(this.type),g),A.CartesianChartConverter.isLineComboChart(this.type)?A.CartesianChartConverter.getMaximumSeriesSettings(e):A.CartesianChartConverter.getDefaultLineChartSeriesLabelSettings()),e=t.viewport,D=t.margin,e=e.width-(D.left+D.right);this.noSeriesLabelsCanBeRendered=!this.renderSeriesLabels(l,p,h,e),this.dataPointNavigationHelper.getPendingFocusElement&&r&&(r.navigationOptions.focusElement=this.dataPointNavigationHelper.getPendingFocusElement()),this.interactivityService&&(D={layerOptions:u,clearCatcher:this.clearCatcher,root:this.chartAreaSvg,axesLayout:t,categorySubRangeCount:s,verticalCategoryAxis:o},this.interactivityService.bind(c,this.behavior,D,r))},A.CartesianPlotAreaLayout=e}(v.visuals||(v.visuals={}))}(powerbi=powerbi||{}),function(n){!function(p){function e(e){this.switchAxisPosition=e,this.unSyncedLayout=[],this.maxMargin={top:0,bottom:0,left:0,right:0},this.axesRenderersByPosition=((e={})[2]=[],e[0]=[],e[1]=[],e)}e.prototype.update=function(e,t,i,a,r,s,o,n){this.settings=e,this.coreMultiple=o,this.renderOptions=i,this.maxMargin={bottom:0,left:0,right:0,top:0},this.unSyncedLayout=[];var l=_.clone(this.getCoreMultipleData()),e=this.coreMultiple.layers;if(n.smallMultiplesUnsharedAxes&&!this.shouldShareAxis()){for(var c=0,u=t;c<u.length;c++){var d=u[c],h=d.getData(),d=d.layers,h=(h.axesData.x.showAxisTitle=!1,h.axesData.y.showAxisTitle=!1,h.axesData.y2.showAxisTitle=!1,l.axesData.y.sharedAxis||(h.axesData.x.show=!1),l.axesData.x.sharedAxis||(h.axesData.y.show=!1),p.CartesianAxesLayoutBuilder.build({data:h.axesData,interactivityOptions:this.settings.interactivity,referenceLines:h.referenceLines,type:this.settings.type,axes:this.settings.axes,layers:d,viewport:a,playAxesRect:this.renderOptions.playAxesRect,calculatePlotArea:this.settings.calculatePlotArea,trimOrdinalDataOnOverflow:this.renderOptions.trimOrdinalDataOnOverflow,axisZoom:void 0,rotateXTickLabels90:!0,featureSwitches:n}));this.unSyncedLayout.push(h),h.margin.left>=this.maxMargin.left&&(this.maxMargin.left=h.margin.left),h.margin.right>=this.maxMargin.right&&(this.maxMargin.right=h.margin.right),h.margin.top>=this.maxMargin.top&&(this.maxMargin.top=h.margin.top),h.margin.bottom>=this.maxMargin.bottom&&(this.maxMargin.bottom=h.margin.bottom)}(l=_.clone(t[0].getData())).axesData.x.showAxisTitle=this.getCoreMultipleData().axesData.x.showAxisTitle,l.axesData.y.showAxisTitle=this.getCoreMultipleData().axesData.y.showAxisTitle,l.axesData.y.sharedAxis||(l.axesData.x.show=this.getCoreMultipleData().axesData.x.show,l.axesData.y.show=!1,l.axesData.y2&&(l.axesData.y2.show=!1,l.axesData.y2.showAxisTitle=this.getCoreMultipleData().axesData.y.showAxisTitle)),l.axesData.x.sharedAxis||(l.axesData.x.show=!1,l.axesData.y.show=this.getCoreMultipleData().axesData.y.show)}return this.generateSharedAxisLayout(l,e,a,r,s,n),this.unSyncedLayout},e.prototype.generateSharedAxisLayout=function(e,t,i,a,r,s){s.smallMultiplesUnsharedAxes&&!this.shouldShareAxis()&&(o=__assign({},this.maxMargin));var o,e={data:e.axesData,interactivityOptions:this.settings.interactivity,referenceLines:e.referenceLines,type:this.settings.type,axes:this.settings.axes,layers:t,viewport:i,playAxesRect:this.renderOptions.playAxesRect,calculatePlotArea:this.settings.calculatePlotArea,trimOrdinalDataOnOverflow:this.renderOptions.trimOrdinalDataOnOverflow,axisZoom:void 0,rotateXTickLabels90:!0,featureSwitches:s,forceMarginMin:o};this.layout=p.CartesianAxesLayoutBuilder.build(e),this.clearUnusedRenderers(a,r,this.layout.shouldRenderAxis,this.layout)},e.prototype.getCoreMultipleData=function(){return this.coreMultiple.getData()},e.prototype.shouldShareAxis=function(){return this.getCoreMultipleData().axesData.x.sharedAxis&&this.getCoreMultipleData().axesData.y.sharedAxis},e.prototype.clearUnusedRenderers=function(e,t,i,a){e=i.x||a.isXScrollBarVisible?e:0,this.destroyUnusedRenderers(e,2);var e=i.y||a.isYScrollBarVisible?t:0,r=this.switchAxisPosition?this.settings.data.y.switchAxisPosition?p.yAxisPosition.right:p.yAxisPosition.left:this.settings.data.y.position,r=this.shouldRenderYAxis(0,r)?0:1,e=(this.destroyUnusedRenderers(e,r),i.y2||a.isYScrollBarVisible?t:0);this.destroyUnusedRenderers(e,0==r?1:0)},e.prototype.destroyUnusedRenderers=function(e,t){var i=this.axesRenderersByPosition[t];_.isEmpty(i)||i.length<=e||(i.slice(e,i.length).forEach(function(e){return e.destroy()}),this.axesRenderersByPosition[t]=i.slice(0,e))},e.prototype.calculateAxesLayout=function(e,t){return!e.smallMultiplesUnsharedAxes||this.shouldShareAxis()||void 0===t?this.calculateSynchronizedAxesLayout():void 0!==t?this.calculateUnSynchronizedAxesLayout(t):this.layout},e.prototype.calculateSynchronizedAxesLayout=function(){var e=_.cloneDeep(this.layout),t=(n.Prototype.copyPrototypeDeep(this.layout,e),e.axes);return t.x.scale=t.x.scale.copy(),t.y1.scale=t.y1.scale.copy(),t.y2&&(t.y2.scale=t.y2.scale.copy()),e},e.prototype.calculateUnSynchronizedAxesLayout=function(e){var t,i,a,r=_.cloneDeep(this.unSyncedLayout[e]),e=(n.Prototype.copyPrototypeDeep(this.unSyncedLayout[e],r),r.axes),s=r.plotArea=this.layout.plotArea,o=this.getCoreMultipleData().axesData;return o.y.sharedAxis||(r.axes.x.outerPadding=this.layout.axes.x.outerPadding,r.axes.x.outerPaddingRatio=this.layout.axes.x.outerPaddingRatio,r.axes.x.xLabelMaxWidth=this.layout.axes.x.xLabelMaxWidth,r.axes.x.categoryThickness=this.layout.axes.x.categoryThickness,r.isXScrollBarVisible=this.layout.isXScrollBarVisible,i=this.layout.axesOverflow.bottom+this.layout.axesOverflow.top-(r.axesOverflow.bottom+r.axesOverflow.top),a=r.axes.y1.scale,r.axes.y1.invertAxis?a.range([1,s.height+i-1]):a.range([s.height+i-1,1]),e.x.scale=this.layout.axes.x.scale.copy(),r.axes.y2&&(t=r.axes.y2.scale,r.axes.y1.invertAxis?t.range([1,s.height+i-1]):t.range([s.height+i-1,1])),r.margin.left=Math.max(this.maxMargin.left,r.margin.left),r.margin.right=Math.max(this.maxMargin.right,r.margin.right)),o.x.sharedAxis||(r.axes.y1.outerPadding=this.layout.axes.y1.outerPadding,r.axes.y1.outerPaddingRatio=this.layout.axes.y1.outerPaddingRatio,r.axes.y1.xLabelMaxWidth=this.layout.axes.y1.xLabelMaxWidth,r.axes.y1.categoryThickness=this.layout.axes.y1.categoryThickness,r.isYScrollBarVisible=this.layout.isYScrollBarVisible,t=this.layout.axesOverflow.left+this.layout.axesOverflow.right-(r.axesOverflow.left+r.axesOverflow.right),i=r.axes.x.scale,r.axes.x.invertAxis?i.range([s.width+t-1,1]):i.range([1,s.width+t-1]),o.x.show||(a=e.y1.scale).range([r.plotArea.height-1,1]),r.margin.bottom=Math.max(this.maxMargin.bottom,r.margin.bottom),r.margin.top=Math.max(this.maxMargin.top,r.margin.top)),r},e.prototype.renderAxes=function(e,t){var i,a,r,s;e.viewport.height<1||e.viewport.width<1||(r=p.CartesianChartLayout.addCartesianChartContainer(e.element,e.viewport),i=this.getCoreMultipleData(),a=__assign(__assign({},this.renderOptions),{supportsScrolling:this.shouldSupportScrolling(i,e.position),formatMode:this.settings.formatMode,subSelectionHelper:void 0}),r=this.getAxesRenderer(r.element,e.position,e.index,i),s=this.coreMultiple.layers,t=this.updateAxesLayoutByPosition(e.position,e.viewport,t),r.render(i.axesData,void 0,s,i.referenceLines,e.viewport,function(){},a,this.useManagedTabIndex(),t))},e.prototype.scrollDelta=function(t,e){this.updateScrollState(function(e){return e.scrollDelta(t)},e)},e.prototype.scrollTo=function(t,e){this.updateScrollState(function(e){return e.scrollTo(t)},e)},e.prototype.scrollBy=function(t,e){this.updateScrollState(function(e){return e.scrollBy(t)},e)},e.prototype.updateScrollbarExtent=function(t,e){this.updateScrollState(function(e){return e.setExtent(t)},e)},e.prototype.updateScrollState=function(i,a){var e=this.getCoreMultipleData(),r=this.getScrollablePosition(e),e=this.axesRenderersByPosition[r];2!==r&&_.isEmpty(a)||_.isEmpty(e)||e.forEach(function(e,t){2!==r&&(t<a.startIndex||t>a.endIndex)||i(e)})},e.prototype.updateAxesLayoutByPosition=function(e,t,i){var a=this.calculateAxesLayout(i),t=(a.viewport=this.adjustViewportForScroll(t,a.scrollHandleMargins),a.preferredPlotArea={width:0,height:0},this.getCoreMultipleData());if(2===e)return a.margin=this.getMarginByPosition(a.margin,e,a.axesOverflow),i.smallMultiplesUnsharedAxes?(!t.axesData.y.sharedAxis&&t.axesData.y.show&&(a.margin.left=this.layout.margin.left,a.shouldRenderAxis.y=!1),t.axesData.x.sharedAxis||(a.margin.bottom=this.layout.margin.bottom),this.shouldShareAxis()&&(a.shouldRenderAxis.y=!1)):a.shouldRenderAxis.y=!1,a.shouldRenderAxis.y2=!1,a.shouldRenderAxis.y=!1,a.axisLabels.y=null,a.axisLabels.y2=null,a.plotArea.height=0,a;i=this.switchAxisPosition?this.settings.data.y.switchAxisPosition?p.yAxisPosition.right:p.yAxisPosition.left:this.settings.data.y.position,t=this.shouldRenderYAxis(e,i);return a.plotArea.width=0,t?(a.margin=this.getMarginByPosition(a.margin,e,a.axesOverflow),a.axisLabels.x=null,a.axisLabels.y2=null,a.shouldRenderAxis.x=!1,a.shouldRenderAxis.y2=!1):(a.shouldRenderAxis.x=!1,a.shouldRenderAxis.y=!1,a.axisLabels.x=null,a.axisLabels.y=null,a.margin=this.getMarginByPosition(a.margin,e,a.axesOverflow)),a},e.prototype.destroy=function(){var i=this;this.executeActionByPosition(this.axesRenderersByPosition,function(e,t){_.isEmpty(e)||(e.forEach(function(e){return e.destroy()}),i.axesRenderersByPosition[t]=[])})},e.prototype.executeActionByPosition=function(e,t){for(var i in this.axesRenderersByPosition)t(e[i],i)},e.prototype.clearRenderingTimeout=function(){this.executeActionByPosition(this.axesRenderersByPosition,function(e){_.isEmpty(e)||e.forEach(function(e){return e.clearRenderingTimeout()})})},e.prototype.shouldRenderYAxis=function(e,t){return 0===e&&t===p.yAxisPosition.left||1===e&&t===p.yAxisPosition.right},e.prototype.getMarginByPosition=function(e,t,i){i=n.Prototype.inherit(i);return 2===t?(i.bottom=e.bottom,i.top=0):(i.left=0,(i.right=0)===t?i.left=e.left:1===t&&(i.right=e.right)),i},e.prototype.getScrollablePosition=function(e){var e=e.axesData,t=this.layout,i=!1;return(this.switchAxisPosition&&e.y&&e.y.switchAxisPosition||e.y&&e.y.position===p.yAxisPosition.right)&&(i=!0),t.isYScrollBarVisible?i?1:0:t.isXScrollBarVisible?2:void 0},e.prototype.shouldSupportScrolling=function(e,t){return this.getScrollablePosition(e)===t},e.prototype.getAxesRenderer=function(e,t,i,a){var r=$(e.node()),s=r.data("CartesianAxesRenderer");return s?s.update(a.axesData,a.scrollbarOptions):((a=n.Prototype.inherit(this.settings)).container=e,a.multipleId=""+i,a.behavior=new p.AxisBehavior,a.data.useManagedTabIndex=!0,this.axesRenderersByPosition[t][i]=s=new p.CartesianAxesRenderer(a),r.data("CartesianAxesRenderer",s)),s},e.prototype.adjustViewportForScroll=function(e,t){return t?{width:e.width-(t.left+t.right),height:e.height-(t.top+t.bottom),scale:e.scale}:e},e.prototype.useManagedTabIndex=function(){return this.renderOptions.isSmallMultiples},p.CartesianSharedAxisLayout=e}(n.visuals||(n.visuals={}))}(powerbi=powerbi||{}),function(w){!function(C){function g(e,t,i,a,r,s,o,n,l,c,u,d,h,p){this.interactivityService=t,this.featureSwitches=i,this.getLocalizedString=a,this.behaviorFactory=o,this.layerStyle=n,this.viewMode=l,this.buildPlotAreaLayout=c,this.renderMultiple=u,this.adapterFactory=d,this.visualInstanceId=h,this.isSharedAxis=!0,this.sharedAxisLayout=new C.CartesianSharedAxisLayout(i.switchAxisPosition),this.gridLayout=new C.GridLayout(e,function(){return r.loadMoreData()},s,t,p,"multiple"),this.visibilityHelper=w.responsiveVisualUtilModuleFactory().visibilityHelper(e,g.IconClassName)}g.prototype.render=function(t){var e,i,a=this,r=(this.clearRenderingTimeout(),t.cartesianSmallMultipleFactory),s=(this.options=t).cartesianSmallMultipleFactory,o=this.adapterFactory(),n=o.getMultiplesSubheader(t.warnings),o=this.multiplesLayout=o.getMultiplesLayout(t.warnings),l=o.showIcon;if(this.visibilityHelper.updateVisibility({showIcon:l,viewport:t.viewport}),!l)return l={type:o.gridLineType,settings:{color:o.gridLineColor,style:o.gridLineStyle,width:o.gridLineWidth}},i=this.featureSwitches,e=this.getCellPadding(o,i),i=this.getOuterPadding(o,i),o={categoryLoadMoreDataHandler:t.categoryLoadMoreDataHandler,playAxisControlLayout:t.playAxisControlLayout,trimOrdinalDataOnOverflow:t.trimOrdinalDataOnOverflow,suppressAnimations:t.suppressAnimations,resizeMode:t.resizeMode,rowCount:o.rowCount,columnCount:o.columnCount,getCellBackgroundColor:function(e){return a.getColorFromMultipleObjects(e,C.StandardObjectPropertyIdentifiers.smallMultiplesBackgroundColor,a.multiplesLayout.backgroundColor)},backgroundTransparency:o.backgroundTransparency,isHierarchicalAxis:t.isHierarchicalAxis,gridLineSettings:l,cellPadding:e,outerPadding:i},this.cellDimensions&&(this.cellDimensions.maxSubheaderHeight=void 0),this.renderGridLayout(r,t.viewport,function(e){return a.renderGridCell(s,e,t.background,t.playAxisControlLayout,t.suppressAnimations,t.resizeMode,t.trimOrdinalDataOnOverflow,t.categoryLoadMoreDataHandler,t.isHierarchicalAxis,!0)},function(e){return a.renderGridCellSubheader(e,s,n)},n,o,t.axisRendererSettings.axes.isYAxisCategorical)},g.prototype.clearRenderingTimeout=function(){this.sharedAxisLayout.clearRenderingTimeout(),this.gridLayout.clearRenderingTimeout()},g.prototype.destroy=function(){this.gridLayout.destroy(),this.sharedAxisLayout.destroy()},g.prototype.onScroll=function(e){this.sharedAxisLayout.scrollDelta(e,this.gridLayout.getScrollPosition()),this.options.cartesianSmallMultipleFactory.scrollDelta(e,this.getVisibleMultiples())},g.prototype.onExtentUpdate=function(e){this.sharedAxisLayout.updateScrollbarExtent(e,this.gridLayout.getScrollPosition()),this.options.cartesianSmallMultipleFactory.updateScrollbarExtent(e,this.getVisibleMultiples())},g.prototype.scrollTo=function(e){this.sharedAxisLayout.scrollTo(e,this.gridLayout.getScrollPosition()),this.options.cartesianSmallMultipleFactory.scrollTo(e,this.getVisibleMultiples())},g.prototype.shouldScrollTo=function(e){return this.options.cartesianSmallMultipleFactory.shouldScrollTo(e,this.getVisibleMultiples())},g.prototype.scrollBy=function(e){this.sharedAxisLayout.scrollBy(e,this.gridLayout.getScrollPosition()),this.options.cartesianSmallMultipleFactory.scrollBy(e,this.getVisibleMultiples())},g.prototype.getVisibleMultiples=function(){var e=this.options.cartesianSmallMultipleFactory.getFrameCount(),t=this.gridLayout.getScrollPosition();if(!t)return{startIndex:0,endIndex:0};var i=t.startIndex*this.multiplesLayout.columnCount,t=t.endIndex*this.multiplesLayout.columnCount;return{startIndex:i,endIndex:Math.min(t,e)}},g.prototype.calculatePlotArea=function(e){_.clone(e.axesMargins);var t=e.axesMargins,i=e.axesOverflow,a=e.titleMargins,a=C.CartesianAxes.adjustAxesMarginsForShared(t,a,e.scrollHandleMargins,e.willRenderAxis,null!=(a=this.featureSwitches)&&a.switchAxisPosition?this.options.axesData.y.switchAxisPosition:this.options.axesData.y.position===C.yAxisPosition.right,e.axes,C.CartesianAxesLayoutBuilder.showAxisTitles(this.options.axesData,void 0)),a=(this.gridLayout.updateHeaderMargins(a),this.adapterFactory()),a=a?a.getMultiplesSubheader(this.options.warnings):C.CartesianChart.getMultiplesSubheader(this.options.cartesianSmallMultipleFactory.getObjects(),this.layerStyle),r=(a.titleWrap&&(r=this.getFrameDisplayNames()),{titleWrap:a.titleWrap,subheaders:r,subheaderFontProperties:a.fontProperties,subheaderLineHeight:a.height,subheaderMargin:a.margins});return!this.featureSwitches.smallMultiplesUnsharedAxes||this.options.axesData.y.sharedAxis&&this.options.axesData.x.sharedAxis?this.cellDimensions=this.gridLayout.calculateCellDimensions(i,r,e):(a=__assign({},i),!this.options.axesData.y.sharedAxis&&this.sharedAxisLayout.getCoreMultipleData().axesData.valueAxis.show&&(a.left=Math.max(t.left,i.left),a.right=Math.max(t.right,i.right)),!this.options.axesData.x.sharedAxis&&this.sharedAxisLayout.getCoreMultipleData().axesData.valueAxis.show&&(a.bottom=Math.max(t.bottom,i.bottom),a.top=Math.max(t.top,i.top)),this.cellDimensions=this.gridLayout.calculateCellDimensions(a,r,e)),this.cellDimensions.plotAreaViewport},g.prototype.scrollRowsTo=function(e){this.gridLayout,this.gridLayout.scrollTo(e)},g.prototype.getCellPadding=function(e,t){return{top:e.rowPaddingInner,bottom:0,left:e.columnPaddingInner,right:0}},g.prototype.getOuterPadding=function(e,t){return{top:e.rowPaddingOuter,bottom:e.rowPaddingOuter,left:e.columnPaddingOuter,right:e.columnPaddingOuter}},g.prototype.getFrameDisplayNames=function(){var t=this.getLocalizedString("ListJoin_Separator"),e=this.options.cartesianSmallMultipleFactory.reader.getFrameDisplayNames();return e&&e.map(function(e){return e.join(t)})},g.prototype.renderGridLayout=function(y,m,f,v,S,x,b){return __awaiter(this,void 0,w.Promise,function(){var t,i,a,r,s,o,n,l,c,u,d,h,p,g=this;return __generator(this,function(e){return t=this.getAxesRenderOptions(x),i=y.getFrameCount(),a=y.getCoreMultiple(),p=y.getShouldResetRowMultipleScrollPosition(),r=x.rowCount,s=x.columnCount,o=x.getCellBackgroundColor,n=x.backgroundTransparency,l=x.cellPadding,c=x.outerPadding,u=S.height,d=S.margins,h=S.show,u=u+d.top+d.bottom,d={rowCount:r,columnCount:s,viewport:m,renderCell:function(t){return __awaiter(g,void 0,w.Promise,function(){return __generator(this,function(e){return f(t),[2,new w.Promise(function(e){return e()})]})})},renderCellSubheader:function(t){return __awaiter(g,void 0,w.Promise,function(){return __generator(this,function(e){return v(t),[2,new w.Promise(function(e){return e()})]})})},cellCount:i,headerMargins:C.CartesianChartLayout.getEmptyMargins(),renderHeader:function(){},subheaderShow:h,subheaderHeight:this.cellDimensions&&this.cellDimensions.maxSubheaderHeight||u,subheaderLineHeight:S.height,subheaderPosition:1!==S.vertical?0:1,shouldResetScrollPosition:p,cellPadding:l,outerPadding:c,scrollPadding:5,getCellBackgroundColor:o,backgroundTransparency:n,gridLineSettings:x.gridLineSettings,getAllCells:function(){return y.multiples},manageTabIndexOnRowHeaderFooter:b,boldedSubheaders:S.labelBold},this.isSharedAxis&&(this.gridLayout.update(d),h=Math.ceil(i/s),this.sharedAxisLayout.update(this.options.axisRendererSettings,y.multiples,t,m,s,Math.max(h,r),a,this.featureSwitches),d.renderHeader=function(e){return g.sharedAxisLayout.renderAxes(e,g.featureSwitches)},d.headerMargins=this.cellDimensions.headerMargins,d.subheaderHeight=this.cellDimensions&&this.cellDimensions.maxSubheaderHeight||u),this.gridLayout.update(d),p=_.map(y.multiples,function(e){return e.getDataPoint()}),[2,this.gridLayout.render(this.cellDimensions,p,"multiples",this.visualInstanceId)]})})},g.prototype.renderGridCellSubheader=function(e,t,i){var a=e.element,r=e.index,s=e.viewport;if(!_.isUndefined(r)){var o=1===i.horizontal?"center":2===i.horizontal?"right":"left",n=this.getSubheaderFontProperties(r,i.fontProperties),o=(a.css(C.FontProperties.toHTMLStyle(n)),a.css({padding:i.margins.top+"px "+i.margins.right+"px "+i.margins.bottom+"px "+i.margins.left+"px ","text-align":o}),this.getLocalizedString("ListJoin_Separator")),l=this.options.cartesianSmallMultipleFactory.reader.getDisplayNameForFrame(r),l=l&&l.join(""+o);if(a.attr("title",l),a.attr("id",this.visualInstanceId+"-"+r),a.empty(),i.titleWrap&&(this.cellDimensions&&this.cellDimensions.maxSubheaderHeight)>i.height+i.margins.top+i.margins.bottom)for(var o=C.FontProperties.toTextProperties(n),n=s.width,c=jsCommon.WordBreaker.splitByWidth(l,o,w.TextMeasurementService.measureSvgTextWidth,n,C.GridLayoutSubheaderMaxLines,null,!0),u=0;u<c.length;u++){var d=c[u],d=$("<div/>").text(d);u===c.length-1&&d.addClass("truncate"),a.append(d)}else a.text(l);this.interactivityService&&(s=t.get(r),o=a.closest(C.GridLayoutSelectors.Cell.selector),e.styleSubheader(o,s,i.labelBold))}},g.prototype.getSubheaderFontProperties=function(e,t){e=this.getColorFromMultipleObjects(e,{objectName:C.SmallMultiplesUtils.SubheaderObjectName,propertyName:"fontColor"});return null==e?t:C.FontProperties.inherit(t,{color:e})},g.prototype.getColorFromMultipleObjects=function(e,t,i){if(null!=e){e=null==(e=this.options.cartesianSmallMultipleFactory.reader.getFrameNode(e))?void 0:e.objects;if(e){e=w.DataViewObjects.getFillColor(e,t);if(e)return e}}return i},g.prototype.getAxesRenderOptions=function(e){var t=this,i={scrollTo:function(e){return t.scrollTo(e)},shouldScrollTo:function(e){return t.shouldScrollTo(e)},scrollBy:function(e){return t.scrollBy(e)}};return __assign(__assign({},e),{animationDuration:this.options.animationSettings.duration,ease:this.options.animationSettings.ease,playAxesRect:e.playAxisControlLayout,viewMode:this.viewMode,isSmallMultiples:!0,isHierarchicalAxis:e.isHierarchicalAxis,preserveScrollPosition:!0,navigationScrollCallbacks:i})},g.prototype.renderGridCell=function(e,t,i,a,r,s,o,n,l,c){var u,d,h,p=t.viewport,e=e.get(t.index);2&e.getState()?e.getRenderer().attachToElement(t.element,t.viewport):(h=(u=C.CartesianChartLayout.addCartesianChartContainer(t.element,p)).element,d=null==(d=this.behaviorFactory)?void 0:d.create(),e.initRenderer(this.buildPlotAreaLayout(!0,h,u.clearCatcher,t.element,d))),this.interactivityService&&(h=t.element.closest(C.GridLayoutSelectors.Cell.selector),t.bindDataToGridCell(h,e,"multiple")),this.renderMultiple({multiple:e,viewport:p,background:i,axisZoom:void 0,chartAreaViewport:p,chartAreaMargins:C.CartesianChartLayout.getEmptyMargins(),renderedViewport:p,playAxisControlLayout:a,suppressAnimations:r,resizeMode:s,trimOrdinalDataOnOverflow:o,categoryLoadMoreDataHandler:n,isSharedAxis:!0,isHierarchicalAxis:l,preserveScrollPosition:c,supportsScrolling:!0,axesLayout:this.sharedAxisLayout.calculateAxesLayout(this.featureSwitches,e.index)})},g.IconClassName="cartesianChartResponsiveIcon",C.CartesianSmallMultipleLayout=g}(w.visuals||(w.visuals={}))}(powerbi=powerbi||{}),function(m){!function(c){var F=m.data.createDataViewScopeIdentity,I=m.data.DataViewMatrixUtils,a=jsCommon.Lazy,k=m.data.SQExprBuilder,e=(t.prototype.ensureValueGroupAtSeriesIndex=function(e,t,i){var a;return e[t]||(a=this.getValueGroupName(i),i={identity:this.getSeriesIdentity(i),values:[],objects:this.getSeriesObjects(i),name:a},e[t]=i),e[t]},t);function t(){}__extends(r,i=e),r.prototype.setSource=function(e){e.source=this.matrix.columns.levels[0].sources[0]},r.prototype.getSeriesGroups=function(e,t){return e&&_.map(e,function(e){return _.isEmpty(e.children)?1:e.children.length})},r.prototype.getSeriesDataPoints=function(e){var t=this.matrix.columns.root;return _.filter(t.children,function(e){return!e.isSubtotal})},r.prototype.getValueGroupName=function(e){return e.value||e.levelValues&&e.levelValues[0].value},r.prototype.getSeriesObjects=function(e){return e.objects},r.prototype.getSeriesIdentity=function(e){return e.identity},r.prototype.getSeriesSourceColumn=function(e,t){return void 0===t&&(t=null),_.create(e,{groupName:t})},r.prototype.createValueColumnForMeasure=function(e,t,i,a,r){return t[r]||(e={identity:this.getSeriesIdentity(e),values:[],source:this.getSeriesSourceColumn(i,a),objects:void 0},t[r]=e),t[r]};var i,n=r;function r(e){var t=i.call(this)||this;return t.matrix=e,t}__extends(o,s=e),o.prototype.setSource=function(e){},o.prototype.getSeriesGroups=function(e,t){return t?[t]:[]},o.prototype.getSeriesDataPoints=function(e){return e},o.prototype.getValueGroupName=function(e){return e.displayName},o.prototype.getSeriesObjects=function(e){return e.objects},o.prototype.getSeriesIdentity=function(e){},o.prototype.getSeriesSourceColumn=function(e,t){return e},o.prototype.createValueColumnForMeasure=function(e,t,i,a,r){return t[r]||(e={identity:this.getSeriesIdentity(e),values:[],source:this.getSeriesSourceColumn(i,a),objects:[]},t[r]=e),t[r]};var s,l=o;function o(e){return s.call(this)||this}function u(e,t){var i=this,t=(this.sourceDataView=e,this.formatStringPropId=t,e&&e.metadata&&e.matrix,this.matrix=e.matrix,this.matrix.rows.root.children);this.hasRowChildren=!_.isEmpty(t),this.hasColChildren=!_.isEmpty(this.matrix.columns.root.children),this.hasSeries=this.hasColChildren&&!_.isEmpty(this.matrix.columns.levels)&&_.every(this.matrix.columns.levels[0].sources,function(e){return!e.isMeasure}),this.hasCategories=1<this.matrix.rows.levels.length&&this.hasRowChildren,this.objects=e.metadata.objects,this.frameCount=function(e){e=e.rows;return e.root.children?_.filter(e.root.children,function(e){return!e.isSubtotal}).length:0}(this.matrix),this._frameDisplayNames=new a(function(){return i.getDisplayNameFromAllFrames()})}u.create=function(e,t){return new u(e,t)},u.prototype.getObjects=function(){return this.objects},u.prototype.getFrameDisplayNames=function(){return this._frameDisplayNames.getValue()},u.prototype.hasFrames=function(){var e=this.matrix.rows;return this.matrix&&0<this.frameCount&&!_.isEmpty(e.levels)&&!!this.getFrameSourceColumns()},u.prototype.getFrameCount=function(){return this.frameCount},u.prototype.getFrameSourceColumns=function(){return this.matrix.rows.levels[0].sources},u.prototype.getFrameNode=function(e){return this.matrix.rows.root.children[e]},u.prototype.getValueSources=function(e){return e?(e=this.hasCategories?1:0,e=this.matrix.rows.levels[e],I.getScopedValueSources(e)):this.matrix.valueSources},u.prototype.buildCategoricals=function(e,P,L,t,i){var M=this,e=this.matrix.rows.root.children[e],V=(e.isSubtotal,[]),T=(i.forEach(function(e,t){return V[t]={shouldReadScopedValues:!e&&M.hasSeries}}),i.map(function(e){return new(M.hasSeries&&e?n:l)(M.matrix)}));V.forEach(function(e){e.allValueSources=M.getValueSources(e.shouldReadScopedValues)});for(var a=0;a<T.length;a++){var r=this.findUniqueFilteredValueSourcesAndIndices(V[a].allValueSources,t&&t[a]),s=r[0],r=r[1],s=(V[a].requiredValueSources=s,V[a].requiredValueSourcesIndices=r,T[a].setSource(P[a].values),T[a].getSeriesDataPoints(s)),s=(V[a].seriesNodes=s,T[a].getSeriesGroups(s,r.length));V[a].seriesGroups=s,V[a].valueGroups=Array(s.length)}for(var e=this.hasCategories?e.children:[e],o=(I.forEachLeafNode(e,function(t,e,i){if(!t.isSubtotal){if(M.hasCategories){var a=i,r=L;_.every(a,function(e){return 1===e.levelValues.length})&&a.length===r.length||1===a.length&&(a[0].levelValues.length,r.length);var s,o,n=_.last(a).objects,l=a[0];if(1<a.length){(o=new Array(a.length))[0]=l.levelValues[0].value;for(var c=l.identity.expr,u=1,d=a.length;u<d;u++)l=a[u],o[u]=l.levelValues[0].value,c=k.and(c,l.identity.expr);s=F(c)}else s=l.identity,o=_.map(l.levelValues,function(e){return e.value});for(var h=0,p=r.length;h<p;h++)r[h].identity.push(s),r[h].objects.push(n),r[h].values.push(o[h])}for(var g=V.map(function(e){return e.shouldReadScopedValues?I.getNodeScopedValues(t):t.values}),y=0;y<V.length;y++)for(var m=V[y],f=0;f<m.seriesGroups.length;f++){for(var v=m.seriesNodes&&m.seriesNodes[f],S=m.seriesGroups[f],x=T[y].ensureValueGroupAtSeriesIndex(m.valueGroups,f,v),b=[],C=0;C<S;C++){var w=f*S+C,D=T[y].createValueColumnForMeasure(v,P[y].values,m.requiredValueSources[m.shouldReadScopedValues?w:C],x.name,w),A=(M.hasSeries||(w=m.requiredValueSourcesIndices[w]),null==(A=null==g?void 0:g[y])?void 0:A[w]);_.isEmpty(m.requiredValueSources)||M.readValues(A,D,e),b.push(D)}x.values=b}}}),this.hasSeries&&this.hasCategories&&_.isEmpty(V.filter(function(e){return!_.isEmpty(e.requiredValueSources)}))),a=0;a<P.length;a++)m.data.DataViewTransform.setGrouped(P[a].values,V[a].valueGroups),_.isEmpty(V[a].requiredValueSources)&&(i[a]?o||(P[a].values=void 0):P[a]=void 0)},u.prototype.findUniqueFilteredValueSourcesAndIndices=function(i,a){if(_.isEmpty(i))return[[],[]];for(var r=[],s=[],o={},e=0;e<i.length;e++)!function(e){var t=i[e];!_.isEmpty(a)&&!_.some(a,function(e){return t.roles[e]})||o[t.queryName]||(r.push(e),s.push(t),o[t.queryName]=!0)}(e);return[s,r]},u.prototype.readCategories=function(){var e=this.matrix.rows;if(e.levels.length<=1||2===e.levels.length&&1<=e.levels[1].sources.length||2<=e.levels.length&&_.every(e.levels,function(e){return 1===e.sources.length}),this.hasCategories)return e=[],this.fillCategoriesMetadata(e),e},u.prototype.fillCategoriesMetadata=function(e){this.hasCategories;for(var t=this.matrix.rows.levels,i=1;i<t.length;i++)for(var a=0,r=t[i].sources;a<r.length;a++){var s=r[a];e.push({source:s,values:[],identity:[],objects:[]})}},u.prototype.convertComboFrame=function(e){var t=c.ComboChart.getRoleGroups();return this.convertFrameInternal(e,t)},u.prototype.createEmptyCategorical=function(e){var t;return(t=e.values).push.apply(t,(t=this.matrix.valueSources,(_.isEmpty(t)?[]:_.map(t,function(e){return{identity:void 0,values:[],source:e,objects:[]}}))||[])),{metadata:this.sourceDataView.metadata,categorical:e}},u.prototype.convertFrame=function(e){return this.convertFrameInternal(e)[0]},u.prototype.checkValueRolesInList=function(e,t){for(var i=0,a=t;i<a.length;i++){var r=function(t){if(_.some(e,function(e){return t.roles[e]}))return{value:!0}}(a[i]);if("object"==typeof r)return r.value}return!1},u.prototype.validateValueRoles=function(e){var t;_.isEmpty(e)||(this.checkValueRolesInList(e,this.matrix.valueSources),(t=this.getValueSources(!0))&&this.checkValueRolesInList(e,t))},u.prototype.isForColumnValues=function(e){var t=c.ComboChart.getRoleGroups()[0];return _.isEmpty(e)||0<_.intersection(e,t).length},u.prototype.convertFrameInternal=function(e,t){for(var i,a=this,r=[],s=this.matrix,o=[],n=(_.isEmpty(t)?o.push(!0):t.forEach(function(e){a.validateValueRoles(e),o.push(a.isForColumnValues(e))}),_.size(null==(i=null==s?void 0:s.rows)?void 0:i.levels),[]),l=_.isEmpty(t)?1:t.length,c=0;c<l;c++)n.push({categories:void 0,values:m.data.DataViewTransform.createValueColumns()});if(!this.hasCategories){for(var u=[],d=!0,c=0;c<n.length;c++)if(o[c]){if(!_.isEmpty(s.valueSources)&&this.hasRowChildren){d=!1;break}!this.hasSeries&&1!==n.length||(u[c]=this.createEmptyCategorical(n[c]))}else if(!_.isEmpty(this.getValueSources(this.hasSeries))){d=!1;break}if(d)return u}var h=this.readCategories();this.buildCategoricals(e,n,h,t,o);for(var p=0,g=n;p<g.length;p++){var y=g[p];y&&(y.categories=h,r.push({metadata:this.sourceDataView.metadata,categorical:y}))}return r},u.prototype.readValues=function(e,t,i){t.values||(t.values=[]),e?(t.values[i]=null==e.value?null:e.value,void 0!==e.highlight&&(t.highlights||(t.highlights=[]),t.highlights[i]=e.highlight),void 0!==e.objects&&(t.objects||(t.objects=[]),t.objects[i]=e.objects),void 0!==e.highlightObjects&&(t.highlightObjects||(t.highlightObjects=[]),t.highlightObjects[i]=e.highlightObjects)):t.values[i]=null},u.prototype.getDisplayNameFromAllFrames=function(){for(var e=new Array(this.frameCount),t=0;t<this.frameCount;t++){var i=this.getDisplayNameForFrame(t);e[t]=i}return e},u.prototype.getDisplayNameForFrame=function(e){var a=this,r=this.getFrameNode(e),e=this.getFrameSourceColumns(),s=new Array(e.length);return e.forEach(function(e,t){r.levelValues;var i=r.levelValues&&r.levelValues[t].value,e=new c.valueFormatter.VariantValueFormatter({column:e,formatStringPropId:a.formatStringPropId,nullsAreBlank:!0,trailingZeroes:!0});s[t]=e.format(i)}),s},u.prototype.getSubtotals=function(){var e=_.find(this.matrix.rows.root.children,function(e){return e.isSubtotal});if(e){for(var t=_.size(e.values),i=_.size(this.matrix.valueSources),a=t-i,r={},s=0;s<i;s++){var o,n=this.matrix.valueSources[s].roles,l=c.AxisHelper.normalizeNonFiniteNumber(e.values[a+s].value);for(o in n)r[o]=l}return r}},u.prototype.getTopLevelAggregates=function(e){for(var t={},i=0,a=this.sourceDataView.metadata.columns;i<a.length;i++){var r=a[i];if(r.roles&&r.aggregates)for(var s=0,o=e;s<o.length;s++){var n=o[s];r.roles[n]&&(t[n]=t[n]||[]).push(r.aggregates)}}return _.isEmpty(t)?void 0:t},c.DataViewMultipleReader=u}(m.visuals||(m.visuals={}))}(powerbi=powerbi||{}),function(e){((e=e.powerbi||(e.powerbi={})).visuals||(e.visuals={})).importCartesianChartsModule=function(){}}(es6=es6||{}),function(Re){!function(Ne){function e(e){this.options=e}e.prototype.convert=function(){var l,X,m,K,Z,q,f,v,S,$,J,Q,x,ee,P=this.options,e=this.options,L=e.dataView,c=e.style,te=e.interactivityService,ie=e.shouldCalculateStacked,M=e.isComboChart,b=e.forecastDataView,t=e.anomalyDetectionDataView,C=e.supportsTotalLabels,i=e.tooltipsEnabled,ae=void 0===i||i,V=e.featureSwitches,i=Ne.CartesianHelper.getCategoryAxisProperties(L.metadata),T=Ne.CartesianHelper.isScalar(P.isScalar,i),re=Ne.CartesianHelper.getReverseStackOrder(i),se=L.categorical,e=Ne.CartesianHelper.getScalarKeyinfo(se,T),F=e.category,I=e.useScalarKeys,oe=e.scalarKeys,k=(I&&((K=Re.Prototype.inherit(F.source)).type={dateTime:!0}),Ne.lineChartProps.general.formatString),e=Ne.AxisHelper.getCategoryValueType(F.source,T),O=Ne.AxisHelper.isDateTime(e),ne=F.values,N=[],le=[],ce=[],u=[],R=se.values,B=!(!R||!R.source),d=Ne.LineChart.getDefaultLineChartLabelSettings(c,P.isComboChart),ue=Ne.ColorHelper.create(c),H=this.options.multipleInfo,de=(H&&(Z=_.first(H.sources).metadata.queryName,q=H.sources.map(function(e){return Ne.buildValueDetailsForColumnValue(e.metadata,e.value,H.identity)}),f=(new Ne.SelectionIdBuilder).withColumnIdentity(H.identity,Z,q).createSelectionId(),v=Ne.FormattingStrategies.defaultFormatter(k),S=Ne.DataViewConcatenateUtil.concatenateValues(_.map(H.sources,function(e){return v(e.value,e.metadata)}))),!(H&&H.isCoreMultiple)),U=M?["Y2"]:["Y","Y2"],z=Re.data.createDataViewCategoricalReaderAdvanced(L,{staticSeriesRoleNames:U,colorOptions:{visualStyle:c,valueRole:U[0],ignoreDefaultColor:P.isComboChart,ignoreDefaultCategoryColor:!0},formatStringProp:k,errorRangeProp:Ne.ErrorObjectProps.errorRange}),e=(L.metadata&&L.metadata.objects&&(y=($=L.metadata.objects).labels,Ne.DataLabelViewModel.updateLabelSettingsFromLabelsObjectWithLabelDensity(y,d,void 0,c,M)),Re.DataViewObjects.getValue($,Ne.lineChartProps.lineStyles.showMarker,!1)),a=__assign(__assign({},d),{show:!1}),C=(C&&L.metadata&&L.metadata.objects&&((C=L.metadata.objects.totals)&&Ne.DataLabelViewModel.updateLabelSettingsFromLabelsObject(C,a,!1,c,M)),R&&(J=R.grouped()),ie&&(Q=R&&0<R.length?_.times(R[0].values.length,function(){return 0}):[]),!1),j=z.data,E=z.columns,he=j.hasCategories()?j.getCategoryCount():1,W=j.getSeriesCount(),pe=this.allocateSeriesColors(W,z),h=z.objects.getStaticObjects(),ge=Ne.LineStyle.readFromStaticObjects(h,e,c),e=Re.DataViewObjects.getValue(h,Ne.lineChartProps.dataPoint.transparency,Ne.LineChart.DefaultAreaTransparency),ye=E.getAllValueMetadataColumnsForRole(U[0]),me=(2===U.length&&(ye=__spreadArray(__spreadArray([],ye||[]),E.getAllValueMetadataColumnsForRole(U[1])||[])),[]),G=[],fe=[],ve=(t&&T&&!ie&&!M&&(ee=Ne.AnomalyDetectionVisualPlugin.readDataView(t,L,c,k)).length,this.getSeriesName(z,U,re)),Y=Ne.CartesianChartConverter.getDefaultLineChartSeriesLabelSettings();if(_.some(U,function(e){return j.hasValues(e)})){for(var Se=z.columns.getSeriesCount(U[0]),C=!0,xe=!1,be=(null==x&&(x=B?Ne.converterHelper.formatFromMetadataColumn(j.getSeriesDisplayName(),E.getSeriesMetadataColumn(),k):void 0),Y=Ne.LineChart.getDefaultLineChartSeriesLabelSettings(c),L.metadata&&L.metadata.objects&&(y=($=L.metadata.objects).seriesLabels,Ne.DataLabelViewModel.updateSeriesLabelSettingsFromLabelsObject(y,Y,c,M),t=Ne.LineChart.getDefaultLineChartSeriesWidthSettings(Y.fontProperties,ve),Y.defaultSeriesWidth=Y.defaultSeriesWidth?t:null,Y.seriesMaximumWidth=Y.defaultSeriesWidth?t:Y.seriesMaximumWidth),d.fontProperties.color),w=a.fontProperties.color,D=function(e){for(var p=null!=(l=Ce.options.featureSwitches)&&l.flipStackOrder&&re?W-e-1:e,e=(Se<=p&&(xe=!0),E.getValueColumnBySeries(p)),g=J&&J[p],y=fe[p]=e.source,m=[],t=y.queryName,t=Ne.SelectionIdBuilder.builder().withSeries(R,g,!0).withMeasure(t).createSelectionId(),f=t.getKey(),i=pe[p],v=void 0,a=void 0,r=((z.data.hasSeries()||M)&&(s=void 0,r=(s=M&&!z.data.hasSeries()?z.objects.getValueMetadataObjectsBySeries(p):z.objects.getSeriesDataObjects(p))&&s.labels,s=s&&s.seriesLabels,(v=Re.Prototype.inherit(d)).show=d.show&&(null==(l=d.showByDefault)||l),r&&Ne.DataLabelViewModel.updateLabelSettingsFromLabelsObjectWithLabelDensity(r,v,void 0,c,M),(a=Re.Prototype.inherit(Y)).show=Y.show&&(null==(l=Y.showByDefault)||l),s&&Ne.DataLabelViewModel.updateSeriesLabelSettingsFromLabelsObject(s,a,c,M)),y.objects),S=Ne.UncertaintyHelper.convertErrorMetadata(r,c,i,p,__assign(__assign({},d),{show:!1}),{isCombo:M,staticObjects:h}),x=S.hasUncertainty,b=v||d,s=a||Y,C=e.highlights&&0<e.highlights.length,r=Re.DataViewObjects.getValue($,Ne.lineChartProps.lineStyles.showSeries,!0),w=Ne.LineStyle.readFromSeriesObjects(z,ge,p,r,c),D=-1,a=_.get(ee,p),A=void 0,o=(a&&(A=new Ne.AnomalyDetectionVisualPlugin.AnomalyTooltipBuilder(P.host,a,y,k)),function(i){var e=ne[i],t=void 0,a=(t=I?(a=oe.values[i])&&a.min:e,Ne.AxisHelper.normalizeNonFiniteNumber(C?j.getHighlightBySeries(i,p):j.getValueBySeries(i,p))),r=C?j.getHighlightFormatStringBySeries(i,p):j.getFormatStringBySeries(i,p);if(T&&(null==t||null==a))return"continue";if(O&&null!=e&&!(e instanceof Date))return"continue";if(D++,null==a&&0<p)return"continue";function s(e){var t=(new Ne.SelectionIdBuilder).withCategory(d,i,null==(t=null==F?void 0:F.source)?void 0:t.queryName,!0);return B||1!==W||t.withMeasure(y.queryName),e&&H&&t.withColumnIdentity(H.identity,Z,q),t}var e=void 0,o=(x&&(e=Ne.UncertaintyHelper.convertCategoricalDataPoint(j,i,p,a)),void 0),n=void 0,l=void 0,c=(ae&&(o=[],H&&(c=new Ne.LazyTooltipBuilder,u=Ne.FormattingStrategies.defaultFormatter(k),c.withMultipleColumnAndValues(H.sources.map(function(e){return e.metadata}),H.sources.map(function(e){return e.value}),!0,u),o.push.apply(o,c.getTooltipItems())),F.source&&(l=Ne.CategoryLevelUtils.getCategoryLevels(L.categorical.categories,i,k),u=Ne.CategoryLevelUtils.concatenateCategoryLevels(l),o.push({displayName:u.displayName,value:u.value})),c=function(e){return Ne.converterHelper.formatFromMetadataColumn(e,y,k,!1,r)},!B||F.source&&F.source===R.source||o.push({displayName:R.source.displayName,value:Ne.converterHelper.formatFromMetadataColumn(J[p].name,R.source,k)}),null!=a&&(u=S.tooltips,x&&u.show&&u.format===Ne.errorFormat.range?(void 0!==(u=Ne.UncertaintyHelper.getTooltipItems(e,a,S,c,P.host,{overrideDisplayName:y.displayName}))&&u.length,_.isEmpty(u)?o.push({displayName:y.displayName,value:c(a)}):o.push(u[0])):o.push({displayName:y.displayName,value:c(a)})),x&&(M&&S.tooltips.format!==Ne.errorFormat.range?o.push.apply(o,Ne.UncertaintyHelper.getTooltipItems(e,a,S,c,P.host,{hideMarker:!0})):Ne.UncertaintyHelper.setTooltipItems(e,a,S,c,P.host)),Ne.TooltipBuilder.addTooltipMeasures(z,n=[],i,B?p:void 0,k),(u=null==A?void 0:A.getTooltipItems(i,r))&&n.push.apply(n,u),n=_.isEmpty(n)?void 0:n),new Ne.SelectionIdBuilder),u=E.getCategoryColumn("Category"),d=null!=(X=se.originalCategories)?X:[F],u=(j.hasCategories()&&(c=c.withCategory(d,i,null==(X=null==u?void 0:u.source)?void 0:X.queryName,!0)),B&&(c=c.withSeries(R,g,!0)),(c=H?c.withColumnIdentity(H.identity,Z,q):c).withMeasure(y.queryName,E.getValueColumn(xe?U[1]:U[0],p),i).createSelectionId()),c=F&&!_.isEmpty(F.identity)&&F.identity[i]?F.identity[i].key:i,h=(G[i]||(G[i]={positive:0,negative:0,net:0,categoryValue:Ce.convertCategoryValue(t,O,I,V),categoryIndex:i,dynamicFormatString:r}),Math.abs(a)),h=(isNaN(h)||(a<0?(G[i].net-=h,G[i].net<G[i].negative&&(G[i].negative=G[i].net)):(G[i].net+=h,G[i].net>G[i].positive&&(G[i].positive=G[i].net))),Ne.DataLabelUtil.determineDataLabelFillColor({defaultColor:be,seriesColor:null==v?void 0:v.fontProperties.color,categoricalDataReader:z,categoryIndex:i,seriesIndex:p})),t={categoryValue:Ce.convertCategoryValue(t,O,I,V),value:a,categoryIndex:i,seriesIndex:p,tooltipInfo:o,selected:!1,identity:u,key:JSON.stringify({series:f,category:c}),labelFill:h.color,labelFormatString:r||y.format,labelSettings:b,uncertainty:e,additionalTooltipItems:n,hierarchyCategoryLevels:l,lineStyle:w,isY2:xe},o=(ie&&(Q[i]+=a,t.stackedValue=Q[i]),Ne.lineChartProps.dataPoint.fill),u=F.objects&&F.objects[i];u&&ue.hasColorForProperty(u,o)&&(t.pointColor=ue.getColorForProperty(u,o,void 0)),m[D]=t,N[i]||(N[i]=Ne.CartesianHelper.extractCategoryFromDataPoint(t)),N[i]&&!N[i].hasData&&(N[i].hasData=null!=t.value);j.hasCategories()&&(le[i]||(c=s(!1),le[i]=c.createSelectionId()),ce[i]||(h=s(!0),ce[i]=h.createSelectionId()))}),n=0;n<he;n++)o(n);r=_.findIndex(ye,y),-1!==r&&(me[r]?me[r].usedInSeriesIndices.push(p):me[r]={metadataColumn:y,usedInSeriesIndices:[p],valueSelector:(new Ne.SelectionIdBuilder).withMeasure(y.queryName,e).createSelectionId()}),te&&te.applySelectionStateToData(_.filter(m,function(e){return null!=e})),a=c.isHighContrast?Ne.ColorHelper.getThemeColor(c,Ne.BackgroundColorName):i;(0<m.length||!de)&&u.push({seriesName:ve[p],key:f,lineIndex:p,color:i,areaColor:a,xCol:I?K:F.source,yCol:y,data:m,identity:t,selected:!1,uncertainty:S,labelSettings:v,seriesSettings:s,type:y.type,lineStyle:w,isY2:xe})},Ce=this,r=0;r<W;r++)D(r);if(ie&&P.host&&P.tooltipsEnabled&&a.show)for(var A=P.host.getLocalizedString("Visual_Total"),we=[],r=0;r<W;r++){var s=null!=(m=this.options.featureSwitches)&&m.flipStackOrder&&re?W-r-1:r;if(u[s])for(var De=u[s].data,Ae=fe[s],o=0;o<De.length;o++){var Pe,n=u[s].data[o];n&&(Pe=void 0,p=n.categoryIndex,n=Ne.DataLabelUtil.determineTotalLabelFillColor({defaultColor:w,categoricalDataReader:z,categoryIndex:p,seriesIndex:s}),G[p].labelFill=n.color,n=Ne.DataLabelUtil.isAssignedColor(n)?n.color:w,a.fontProperties=Ne.DataLabelUtil.updateFontPropertiesColor(n,a.fontProperties),we[p]||(we[p]={net:{displayName:A,value:Ne.converterHelper.formatFromMetadataColumn(G[p].net,Ae,k,!1)}}),Pe=we[p].net,u[s].data[o].tooltipInfo||(u[s].data[o].tooltipInfo=[]),u[s].data[o].tooltipInfo.push(Pe),u[s].data[o].additionalTooltipItems||(u[s].data[o].additionalTooltipItems=[]),u[s].data[o].additionalTooltipItems.push(Pe))}}}if(b&&T&&!ie&&!M)for(var Le=Ne.ForecastHelper.readDataView(b,L,c),Me=_.last(N),Ve=0,Te=Le;Ve<Te.length;Ve++)for(var Fe=Te[Ve],p=Me.categoryIndex,Ie=0,ke=Fe.points;Ie<ke.length;Ie++){var Oe,g=ke[Ie],_e=(g.point.x=this.convertCategoryValue(g.point.x,O,I,V),g.upperBound.x=this.convertCategoryValue(g.upperBound.x,O,I,V),g.lowerBound.x=this.convertCategoryValue(g.lowerBound.x,O,I,V),g.point.x);_e<=Me.categoryValue||(p++,Oe=Ne.CategoryLevelUtils.getCategoryLevels(L.categorical.categories,p,k),N[p]||(N[p]={categoryIndex:p,categoryValue:_e,hasData:null!=g.point.y,hierarchyCategoryLevels:Oe}),le[p]||(le[p]=null),ce[p]||(ce[p]=null))}var y=!1,t=L.metadata&&L.metadata.dataReduction,b=(t&&t.categorical&&(t.categorical.metadata&&t.categorical.metadata.binnedLineSample||t.categorical.categories&&t.categorical.categories.binnedLineSample||t.categorical.values&&t.categorical.values.binnedLineSample)&&(y=!0),i=Ne.CartesianHelper.getCategoryAxisProperties(L.metadata),Ne.CartesianHelper.getPreferredCategoryWidth(i));return te&&te.applySelectionStateToData(u),{series:u,totals:G,forecastLines:Le,anomalyDetections:ee,isScalar:T,dataLabelsSettings:d,totalLabelsSettings:a,seriesLabelSetings:Y,hasDynamicSeries:B,hasY2Role:Re.data.DataRoleHelper.hasRoleInDataView(L,"Y2"),categoryMetadata:F.source,valuesMetadata:ye,valuesMetadataBySeries:me,preferredCategoryWidth:b,scalarMetadata:K,scalarKeyCount:I?oe.values.length:void 0,categories:ne,categoryData:N,seriesDisplayName:x,hasValues:C,categoryIdentities:le,multiplesCategoryIdentities:ce,lineStyle:ge,binnedLineSamplingApplied:y,legendMarkerRendering:Re.DataViewObjects.getValue(h,Ne.lineChartProps.legend.legendMarkerRendering,null!=V&&V.removeDefaultToCircleToggle?Ne.legendMarkerRendering.markerCircleDefault:Ne.legendMarkerRendering.markerOnly),matchLineColor:Re.DataViewObjects.getValue(h,Ne.lineChartProps.legend.matchLineColor,!0),defaultToCircle:Re.DataViewObjects.getValue(h,Ne.lineChartProps.legend.defaultToCircle,!0),isComboChart:M,multipleIdentity:f,multipleDisplayName:S,areaTransparency:e}},e.prototype.allocateSeriesColors=function(e,t){for(var i=[],a=0;a<e;a++)i.push(t.colors.createBySeries(a,void 0,Ne.ForegroundColorName));return i},e.prototype.getSeriesName=function(e,t,i){for(var a=[],r=0,s=e.data.getSeriesCount();r<s;r++){var o=null!=(o=this.options.featureSwitches)&&o.flipStackOrder&&i?s-r-1:r;e.columns.hasDynamicSeries()?a[o]=Ne.valueFormatter.format(e.data.getSeriesName(o),e.objects.getSeriesFormatString(o)):e.columns.hasStaticSeries()?a[o]=e.data.getSeriesName(o):a[o]=e.data.getValueDisplayName(t[0])}return a},e.prototype.convertCategoryValue=function(e,t,i,a){return e&&(t||i)?Re.FeatureSwitchedDate.getEpochTimeStamp(a.utcDates,e):e},Ne.LineChartConverter=e}(Re.visuals||(Re.visuals={}))}(powerbi=powerbi||{}),function(e){(e.visuals||(e.visuals={})).initializeCartesianChartsFactoryES6=function(){e.visuals.setCreateCartesianChart(function(t){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createCartesianChart(t)})}),e.visuals.setCreateWebColumnChartAnimator(function(t){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createWebColumnChartAnimator(t)})}),e.visuals.setCreateRealTimeLineChartAnimator(function(t){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createRealTimeLineChartAnimator(t)})}),e.visuals.setCreateDashboardColumnChartAnimator(function(t){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createDashboardColumnChartAnimator(t)})}),e.visuals.setCreateCartesianChartBehaviorFactory(function(t,i){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createCartesianChartBehaviorFactory(t,i)})}),e.visuals.setCreateColumnChartWebBehaviorFactory(function(){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createColumnChartWebBehaviorFactory()})}),e.visuals.setCreateDataDotChartWebBehaviorFactory(function(){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createDataDotChartWebBehaviorFactory()})}),e.visuals.setCreateLineChartWebBehaviorFactory(function(){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createLineChartWebBehaviorFactory()})}),e.visuals.setCreateScatterChartWebBehaviorFactory(function(){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createScatterChartWebBehaviorFactory()})}),e.visuals.setCreateWaterfallChartWebBehaviorFactory(function(){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createWaterfallChartWebBehaviorFactory()})}),e.visuals.setCreateScatterChartMobileBehaviorFactory(function(){return es6.powerbi.visuals.importCartesianChartsModule().then(function(e){return e.createScatterChartMobileBehaviorFactory()})})}}(powerbi=powerbi||{}),function(Ve){Ve.waterfallConverterModuleFactory=function(){var r=Ve.data,d=Ve.visuals,ve=d.AxisHelper,Se=d.CartesianHelper,xe=d.ColorHelper,be=d.converterHelper,Ce=r.DataRoleHelper,we=d.ForegroundColorName,h=jsCommon.Lazy,De=Ve.visuals.SelectionId,Ae=r.Selector,s=r.SQExprBuilder,p=jsCommon.StringExtensions,Pe=Ve.visuals.WaterfallChart,Le=Ve.visuals.waterfallChartProps;function e(e){var R,B,t=e.dataView,s=e.hostServices,o=e.dataLabelSettings,n=e.sentimentColors,i=e.interactivityService,H=e.tooltipsEnabled,a=e.numberOfBreakdowns,r=t.matrix,l=!_.isEmpty(r.columns.levels)&&r.columns.levels[0].sources[0],c=!_.isEmpty(r.rows.levels)&&r.rows.levels[0].sources,U=_.findIndex(r.valueSources,function(e){return Ce.hasRole(e,"Y")}),u=r.valueSources[U],d=_.filter(r.valueSources,function(e){return Ce.hasRole(e,"Tooltips")}),h=[],p=[],g={current:0,min:0,max:0},z=0,y=null==(y=null==t?void 0:t.metadata)?void 0:y.objects,j=!0;if(l||(j=Ve.DataViewObjects.getValue(y,Le.valueAxis.totalsEnabled,!0)),l&&c&&u){Ce.hasRole(l,"Breakdown"),_.every(c,function(e){return Ce.hasRole(e,"Category")});var m=new Me(l,c,u),f=u.format,v=s.getLocalizedString("Waterfall_OtherLabel"),S=Pe.formatStringProp,x=r.rows.root.children,E=r.columns.root.children;if(!_.isEmpty(x)&&!_.isEmpty(E)){var W=x.length,G=E.length,Y=0,b=void 0,X=void 0,K=_.size(d)+1;0<W&&(z=_.size(x[0].values)/K-1);for(var a=Math.min(a,z),C=0;C<W;C++){for(var w=void 0,D=x[C],A=0<C?x[C-1]:void 0,Z=_.map(D.levelValues,function(e){return e.value}),P=_.map(Z,function(e,t){return be.formatFromMetadataColumn(e,c[t],S)}).join(" "),q=m.splitIdentity(D.identity.expr),$=[],J=_.size(D.values),L=0;L<J;L+=K){for(var M,Q=void 0,ee=void 0,te=void 0,ie=void 0,ae=[],re=[],V=0;V<K;V++)V===U?(M=D.values[L+V],Q=ve.normalizeNonFiniteNumber(M.value),te=Ve.DataViewObjects.getValue(M.objects,S),ie=Ve.DataViewObject.getFillColorByPropertyName(null==(M=M.objects)?void 0:M.labels,"color"),w=w||te,ee=A&&ve.normalizeNonFiniteNumber(A.values[L+V].value)):(ae.push(D.values[L+V].value),re.push(A&&A.values[L+V].value));var se={key:L,currentValue:Q,previousValue:ee,difference:(Q||0)-(ee||0),column:E[L/K],currentTooltipValues:ae,previousTooltipValues:re,formatString:te};null!=ie&&(se.labelColor=ie),$.push(se)}var oe,$=_.sortBy($,function(e){return-1*Math.abs(e.difference)}),T=_.chain($).filter(function(e){return!e.column.isSubtotal}).take(a).sortBy(function(e){return-1*e.difference}).value(),F=_.find($,function(e){return e.column.isSubtotal}),I=F.currentValue,k=F.previousValue;if(A){var O=_.sumBy(T,function(e){return e.currentValue}),ne=_.sumBy(T,function(e){return e.previousValue}),le=_.chain(T).map(function(e){return m.splitIdentity(e.column.identity.expr)}).flatten().value(),ce=a+1<G,N=0,ue=void 0,de=void 0;if(ce){var O=I-O,k=k-ne,N=O-k,ue=m.createBreakdownOtherIdentity(le,q,X);if(H){for(var de=m.createBreakdownTooltip(P,b,v,O,k,N,S,s),he=[],pe=[],ge=0;ge<F.currentTooltipValues.length;ge++)!function(t){var e=F.currentTooltipValues[t],i=F.previousTooltipValues[t];_.isNumber(e)&&_.isNumber(i)&&(e=e-_.sumBy(T,function(e){return e.currentTooltipValues[t]}),i=i-_.sumBy(T,function(e){return e.previousTooltipValues[t]}),he.push(e-i),pe.push(i))}(ge);Pe.appendTooltipMeasures(he,void 0,de,d,S,s,pe,P,b)}}for(var ye=!1,me=0,fe=T;me<fe.length;me++)!function(i){ce&&N>i.difference&&!ye&&(ye=!0,h.push(Pe.createDataPoint(N,g.current,n,v,Y++,ue,de,o.fontProperties.color,f||w,3,{text:!0})),p.push(v),g=Pe.getNewPositionContext(g,N));var e,t=be.formatFromMetadataColumn(i.column.value,l,S),a=m.splitIdentity(i.column.identity.expr),a=m.createBreakdownIdentity(q,X,a),r=void 0;H&&(r=m.createBreakdownTooltip(P,b,t,i.currentValue,i.previousValue,i.difference,S,s),e=_.map(i.currentTooltipValues,function(e,t){return _.isNumber(e)?e-i.previousTooltipValues[t]:e}),Pe.appendTooltipMeasures(e,void 0,r,d,S,s,i.previousTooltipValues,P,b)),h.push(Pe.createDataPoint(i.difference,g.current,n,t,Y++,a,r,null!=(R=i.labelColor)?R:o.fontProperties.color,i.formatString||f,0,{text:!0})),p.push(t),g=Pe.getNewPositionContext(g,i.difference)}(se=fe[me]);ce&&!ye&&(ye=!0,h.push(Pe.createDataPoint(N,g.current,n,v,Y++,ue,de,o.fontProperties.color,f||w,3,{text:!0})),p.push(v),g=Pe.getNewPositionContext(g,N))}j&&(le={dataMap:((ne={})[c[0].queryName]=[D.identity],ne),metadata:[u.queryName]},O=Ae.convertSelectorsByColumnToSelector(le),k=new De(O,!1,le),oe=void 0,H&&(oe=Pe.createCategoryTooltip(c,u,Z,I,void 0,S),Pe.appendTooltipMeasures(F.currentTooltipValues,void 0,oe,d,S,s)),h.push(Pe.createDataPoint(I,0,n,P,Y++,k,oe,o.fontProperties.color,f||w,2,{text:!0})),p.push(P)),0===C&&(g={current:I,max:I,min:I}),b=P,X=q}}}i&&i.applySelectionStateToData(h),e.style.isHighContrast&&(B={visible:!0,color:xe.getThemeColor(e.style,we),width:Se.defaultLineStrokeWidth});i=Se.getCategoryAxisProperties(t.metadata,void 0),t=Se.getPreferredCategoryWidth(i),i=_.map(h,function(e){return function(){return e.identity}});return{series:[{data:h,type:u&&u.type}],categories:p,categoryIdentities:i,categoryMetadata:c[0],preferredCategoryWidth:t,valuesMetadata:r.valueSources,legend:Pe.createLegend(n,s,y,e.style,!0,j),hasHighlights:!1,positionMin:g.min,positionMax:g.max,dataLabelsSettings:o,sentimentColors:n,isBreakdown:!0,numberOfBreakdowns:a,totalBreakdownCategories:z,strokeSettings:B}}t.prototype.splitIdentity=function(e){return r.ScopeIdentityExtractor.getKeyValuePairs(e)},t.prototype.createBreakdownIdentity=function(e,t,i){var a,t={dataMap:((a={})[this.breakdownMetadata.queryName]=[r.createDataViewScopeIdentity(s.inValues(__spreadArray(__spreadArray([],_.map(e,function(e){return e.left})),_.map(i,function(e){return e.left})),[__spreadArray(__spreadArray([],_.map(t,function(e){return e.right})),_.map(i,function(e){return e.right})),__spreadArray(__spreadArray([],_.map(e,function(e){return e.right})),_.map(i,function(e){return e.right}))]))],a),metadata:[this.valueMetadata.queryName]},e=Ae.convertSelectorsByColumnToSelector(t);return new De(e,!1,t)},t.prototype.createBreakdownOtherIdentity=function(e,t,i){var e={dataMap:((a={})[this.breakdownMetadata.queryName]=[r.createDataViewScopeIdentity(s.not(s.inValues([this.breakdownMetadata.expr],_.map(e,function(e){return[e.right]}))))],a),metadata:[this.valueMetadata.queryName]},a=(e.dataMap[this.categoryMetadata[0].queryName]=[r.createDataViewScopeIdentity(s.inValues(_.map(t,function(e){return e.left}),[_.map(i,function(e){return e.right}),_.map(t,function(e){return e.right})]))],Ae.convertSelectorsByColumnToSelector(e));return new De(a,!1,e)},t.prototype.createBreakdownTooltip=function(e,t,i,a,r,s,o,n){var l,c=this,u=new d.LazyTooltipBuilder;return this.breakdownMetadata&&u.withLazyValue(new h(function(){return{displayName:c.breakdownMetadata.displayName,value:be.formatFromMetadataColumn(i,c.breakdownMetadata,o)}})),this.valueMetadata&&(null!=r&&u.withLazyValue(new h(function(){return{displayName:t+" "+c.valueMetadata.displayName,value:be.formatFromMetadataColumn(r,c.valueMetadata,o,!1)}})),null!=a&&u.withLazyValue(new h(function(){return{displayName:e+" "+c.valueMetadata.displayName,value:be.formatFromMetadataColumn(a,c.valueMetadata,o,!1)}})),null!=s&&(l=be.formatFromMetadataColumn(s,this.valueMetadata,o,!1),l=Pe.createPercentTooltipValue(l,s,r),u.withLazyValue(new h(function(){return{displayName:p.format(n.getLocalizedString("Waterfall_BreakdownDifferenceTooltip"),c.valueMetadata.displayName),value:l}})))),u};var Me=t;function t(e,t,i){this.breakdownMetadata=e,this.categoryMetadata=t,this.valueMetadata=i}return{matrixConverter:e}}}(powerbi=powerbi||{}),function(e){!function(i){function e(e,t){switch(this.layerType=e){case 5:this.adapter=new i.ColumnChartLayerViewModelAdapter(t);break;case 0:this.adapter=new i.LineChartLayerViewModelAdapter(t);break;case 2:this.adapter=new i.ScatterChartLayerViewModelAdapter(t);break;case 3:this.adapter=new i.WaterfallChartLayerViewModelAdapter(t)}}e.prototype.getData=function(){return this.adapter.getData()},e.prototype.getCartesianChartLayerType=function(){return this.layerType},e.prototype.addWarnings=function(e){return this.adapter.addWarnings(e)},i.CartesianLayerViewModelAdapter=e}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(e){!function(i){function e(e){this.smallMultiplesResponsive=e}e.prototype.createCartesianAdapter=function(e){return this.isSmallMultiples()?new i.SmallMultiplesCartesianViewModelAdapter(e,this.smallMultiplesOptions,this.smallMultiplesResponsive):new i.CartesianViewModelAdapter(e)},e.prototype.createLayerAdapter=function(e,t){return this.isSmallMultiples()?new i.SmallMultiplesLayerViewModelAdapter(e,t,this.smallMultiplesResponsive):new i.CartesianLayerViewModelAdapter(e,t)},e.prototype.setSmallMultiplesOptions=function(e){this.smallMultiplesOptions=e},e.prototype.createSmallMultiplesAdapter=function(e){if(this.isSmallMultiples())return new i.SmallMultiplesViewModelAdapter(e,this.smallMultiplesResponsive)},e.prototype.isSmallMultiples=function(){return this.smallMultiplesOptions&&this.smallMultiplesOptions.isSmallMultiples},i.ResponsiveCartesianAdapterFactory=e}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(s){!function(t){function e(e){this.responsiveFontHelper=new t.ResponsiveCartesianFontHelper,this.originalData=e.data,this.dataView=e.dataView,this.viewport=e.viewport}e.prototype.getData=function(){var e=this.originalData,e=t.ViewModelAdapterUtils.shouldApplyResponsiveChanges(this.dataView,t.cartesianChartProps)?this.applyResponsiveChanges(this.viewport,e):e;return this.currentData=e},e.prototype.getCartesianChartLayerType=function(){return 5},e.prototype.addWarnings=function(e){var t,i=this.originalData,a=this.currentData;i&&a&&(t=this.responsiveFontHelper.getFontSizeSeriesLabelWarning(i,a),i=this.responsiveFontHelper.getFontSizeLabelWarning(i.totalLabelsSettings,a.totalLabelsSettings),t&&e.addForVisualObject("labels",t),i&&e.addForVisualObject("totals",i))},e.prototype.applyResponsiveChanges=function(e,t){t=s.Prototype.inherit(t);return this.applyDataLabelFontSizesChanges(e,t),this.applySeriesDataLabelFontSizeChanges(e,t),this.applyTotalLabelFontSizesChanges(e,t),t},e.prototype.applyDataLabelFontSizesChanges=function(e,t){t.dataLabelsSettings=s.Prototype.inherit(t.dataLabelsSettings),this.updateLabelSettings(e,t.dataLabelsSettings)},e.prototype.applySeriesDataLabelFontSizeChanges=function(e,t){for(var i,a=t.series=s.Prototype.inherit(t.series),r=0;r<a.length;r++)a[r].labelSettings&&((i=a[r]=s.Prototype.inherit(a[r])).labelSettings=s.Prototype.inherit(i.labelSettings),this.updateLabelSettings(e,i.labelSettings))},e.prototype.applyTotalLabelFontSizesChanges=function(e,t){t.totalLabelsSettings&&(t.totalLabelsSettings=s.Prototype.inherit(t.totalLabelsSettings),this.updateLabelSettings(e,t.totalLabelsSettings))},e.prototype.updateLabelSettings=function(e,t){var i=t.fontProperties;t.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.fontProperties),i!==t.fontProperties&&(t.labelOverflow=!0)},t.ColumnChartLayerViewModelAdapter=e}(s.visuals||(s.visuals={}))}(powerbi=powerbi||{}),function(s){!function(t){function e(e){this.responsiveFontHelper=new t.ResponsiveCartesianFontHelper,this.originalData=e.data,this.viewport=e.viewport,this.dataView=e.dataView}e.prototype.getData=function(){var e=this.originalData,e=t.ViewModelAdapterUtils.shouldApplyResponsiveChanges(this.dataView,t.cartesianChartProps)?this.applyResponsiveChanges(this.viewport,e):e;return this.currentData=e},e.prototype.getCartesianChartLayerType=function(){return 0},e.prototype.addWarnings=function(e){var t,i=this.originalData,a=this.currentData;i&&a&&(t=this.responsiveFontHelper.getFontSizeSeriesLabelWarning(i,a),i=this.responsiveFontHelper.getFontSizeLabelWarning(i.totalLabelsSettings,a.totalLabelsSettings),t&&e.addForVisualObject("labels",t),i&&e.addForVisualObject("totals",i))},e.prototype.applyResponsiveChanges=function(e,t){t=s.Prototype.inherit(t);return this.applyDataLabelFontSizesChanges(e,t),this.applySeriesDataLabelFontSizeChanges(e,t),this.applyTotalLabelFontSizesChanges(e,t),t},e.prototype.applyDataLabelFontSizesChanges=function(e,t){t.dataLabelsSettings=s.Prototype.inherit(t.dataLabelsSettings),this.updateLabelSettings(e,t.dataLabelsSettings)},e.prototype.applySeriesDataLabelFontSizeChanges=function(e,t){for(var i,a=t.series=s.Prototype.inherit(t.series),r=0;r<a.length;r++)a[r].labelSettings&&((i=a[r]=s.Prototype.inherit(a[r])).labelSettings=s.Prototype.inherit(i.labelSettings),this.updateLabelSettings(e,i.labelSettings))},e.prototype.applyTotalLabelFontSizesChanges=function(e,t){t.totalLabelsSettings&&(t.totalLabelsSettings=s.Prototype.inherit(t.totalLabelsSettings),this.updateLabelSettings(e,t.totalLabelsSettings))},e.prototype.updateLabelSettings=function(e,t){t.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.fontProperties)},t.LineChartLayerViewModelAdapter=e}(s.visuals||(s.visuals={}))}(powerbi=powerbi||{}),function(a){!function(t){function e(e){this.responsiveFontHelper=new t.ResponsiveCartesianFontHelper,this.originalData=e.data,this.viewport=e.viewport,this.dataView=e.dataView}e.prototype.getData=function(){var e=this.originalData,e=t.ViewModelAdapterUtils.shouldApplyResponsiveChanges(this.dataView,t.cartesianChartProps)?this.applyResponsiveChanges(this.viewport,e):e;return this.currentData=e},e.prototype.getCartesianChartLayerType=function(){return 2},e.prototype.addWarnings=function(e){var t=this.originalData,i=this.currentData;t&&i&&((t=this.responsiveFontHelper.getFontSizeLabelWarning(t.dataLabelsSettings,i.dataLabelsSettings))&&e.addForVisualObject("categoryLabels",t))},e.prototype.applyResponsiveChanges=function(e,t){t=a.Prototype.inherit(t);return this.applyDataLabelFontSizesChanges(e,t),t},e.prototype.applyDataLabelFontSizesChanges=function(e,t){t.dataLabelsSettings=a.Prototype.inherit(t.dataLabelsSettings);var i=t.dataLabelsSettings.fontProperties;t.dataLabelsSettings.fontProperties=this.responsiveFontHelper.adjustFontSize(e,i)},t.ScatterChartLayerViewModelAdapter=e}(a.visuals||(a.visuals={}))}(powerbi=powerbi||{}),function(a){!function(t){function e(e){this.responsiveFontHelper=new t.ResponsiveCartesianFontHelper,this.originalData=e.data,this.viewport=e.viewport,this.dataView=e.dataView}e.prototype.getData=function(){var e=this.originalData,e=t.ViewModelAdapterUtils.shouldApplyResponsiveChanges(this.dataView,t.cartesianChartProps)?this.applyResponsiveChanges(this.viewport,e):e;return this.currentData=e},e.prototype.getCartesianChartLayerType=function(){return 3},e.prototype.addWarnings=function(e){var t=this.originalData,i=this.currentData;t&&i&&((t=this.responsiveFontHelper.getFontSizeLabelWarning(t.dataLabelsSettings,i.dataLabelsSettings))&&e.addForVisualObject("labels",t))},e.prototype.applyResponsiveChanges=function(e,t){t=a.Prototype.inherit(t);return this.applyDataLabelFontSizesChanges(e,t),t},e.prototype.applyDataLabelFontSizesChanges=function(e,t){t.dataLabelsSettings=a.Prototype.inherit(t.dataLabelsSettings);var i=t.dataLabelsSettings.fontProperties;t.dataLabelsSettings.fontProperties=this.responsiveFontHelper.adjustFontSize(e,i)},t.WaterfallChartLayerViewModelAdapter=e}(a.visuals||(a.visuals={}))}(powerbi=powerbi||{}),function(e){!function(s){function r(e){var t=e.columns,e=e.rows;return{legendPositionHeight:120+30*e,legendPositionWidth:210+40*t,legendShowHeight:90+30*e,legendShowWidth:90+40*t,removeXAxisTitleHeight:165+30*e,removeXAxisHeight:120+30*e,removeYAxisTitleWidth:210+40*t,removeYAxisWidth:120+40*t}}function e(e,t,i){this.smallMultiplesOptions=t,this.smallMultiplesResponsive=i,this.cartesianData=e.cartesianData,this.dataView=e.dataView,this.isCoreMultiple=e.isCoreMultiple,this.responsiveFontHelper=new s.ResponsiveCartesianFontHelper}s.calculateSMCartesianAdapterBreakpoints=r,e.prototype.getData=function(){var e=this.cartesianData,t=this.smallMultiplesOptions.isSmallMultiples;return e=this.smallMultiplesResponsive&&t&&s.ViewModelAdapterUtils.getResponsiveVisualProperties(this.dataView,s.cartesianChartProps).responsive?this.applyResponsiveChanges(this.cartesianData,this.smallMultiplesOptions):e},e.prototype.enumerateObjectInstances=function(e,t,i){},e.prototype.getResponsiveSlice=function(e,t,i){},e.prototype.applyResponsiveChanges=function(e,t){var i=s.ViewModelAdapterUtils.cloneData(e),a=r(t),t=t.viewport;return this.applyAxesResponsiveChanges(a,t,i),this.applyLegendResponsiveChanges(a,t,i),this.applyFontSizeReponsiveChanges(t,i),this.isCoreMultiple&&s.CartesianViewModelAdapterUtils.updatePlotResponsiveWarnings(i,e),i},e.prototype.applyAxesResponsiveChanges=function(e,t,i){var a=t.height,t=t.width;a<e.removeXAxisTitleHeight&&(i.axesData.x.showAxisTitle=!1),a<e.removeXAxisHeight&&(i.axesData.x.show=!1,i.axesData.x.showAxisTitle=!1),t<e.removeYAxisTitleWidth&&(i.axesData.y.showAxisTitle=!1,i.axesData.y2.showAxisTitle=!1),t<e.removeYAxisWidth&&(i.axesData.y.show=!1,i.axesData.y2.show=!1,i.axesData.y.showAxisTitle=!1,i.axesData.y2.showAxisTitle=!1)},e.prototype.applyLegendResponsiveChanges=function(e,t,i){var a,r;i.legendData.show&&(a=t.height,t=t.width,r=i.legendData.position,(a<e.legendPositionHeight||t<e.legendPositionWidth)&&s.Legend.isLeftOrRight(r)&&(i.legendData.position=s.LegendPosition.Top),(a<e.legendShowHeight||t<e.legendShowWidth)&&(i.legendData.show=!1),i.legendData.useLargeArrowHitArea=!0)},e.prototype.applyFontSizeReponsiveChanges=function(e,t){t.legendData&&t.legendData.fontProperties&&(t.legendData.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.legendData.fontProperties));t=t.axesData;t.x.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.x.labelFontProperties),t.x.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.x.titleFontProperties),t.y.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.y.labelFontProperties),t.y.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.y.titleFontProperties),t.y2.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.y2.labelFontProperties),t.y2.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,t.y2.titleFontProperties)},s.SmallMultiplesCartesianViewModelAdapter=e}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(e){!function(e){function t(e,t,i){this.layerType=e,this.smallMultiplesResponsive=i,this.layerData=t.data}t.prototype.getData=function(){return this.smallMultiplesResponsive,this.layerData},t.prototype.getCartesianChartLayerType=function(){return this.layerType},t.prototype.addWarnings=function(e){},e.SmallMultiplesLayerViewModelAdapter=t}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{}),function(e){!function(n){function s(e,t,i){return e[0],e[1],t[0],t[1],d3.scaleLinear().range(t).domain(e).clamp(!0)(i)}function o(e){var t=e.rowCount,e=e.columnCount;return{showIconHeight:30*e,showIconWidth:40*t,showSubheaderHeight:80+50*t,gridlineRowUpperBreakpoint:120+52*t,gridlineRowLowerBreakpoint:120+32*t,gridlineColumnUpperBreakpoint:120+62*e,gridlineColumnLowerBreakpoint:120+42*e,removeGridLineHeight:32*t,removeGridLineWidth:42*e,paddingRowUpperBreakpoint:120+130*t,paddingRowLowerBreakpoint:120+30*t,paddingColumnUpperBreakpoint:120+140*e,paddingColumnLowerBreakpoint:120+40*e}}function e(e,t){this.smallMultiplesResponsive=t,this.multiplesLayout=e.multiplesLayout,this.multiplesSubheader=e.multiplesSubheader,this.dataView=e.dataView,this.viewport=e.viewport,this.responsiveFontHelper=new n.ResponsiveCartesianFontHelper}n.interpolateValueFromBreakpoints=s,n.calculateSmallMultiplesViewModelAdapterBreakpoints=o,e.prototype.getMultiplesLayout=function(e){var t=this.multiplesLayout;return t=this.smallMultiplesResponsive&&n.ViewModelAdapterUtils.getResponsiveVisualProperties(this.dataView,n.cartesianChartProps).responsive?this.applyResponsiveChanges(this.viewport,this.multiplesLayout,e):t},e.prototype.getMultiplesSubheader=function(e){var t=this.multiplesSubheader;return t=this.smallMultiplesResponsive&&n.ViewModelAdapterUtils.getResponsiveVisualProperties(this.dataView,n.cartesianChartProps).responsive?this.applySubheaderResponsiveChanges(this.viewport,t,e):t},e.prototype.enumerateObjectInstances=function(e,t,i){this.smallMultiplesResponsive&&i&&"general"===e.objectName&&this.enumerateGeneral(t,this.dataView)},e.prototype.enumerateGeneral=function(e,t){t={selector:null,properties:{responsive:n.ViewModelAdapterUtils.getResponsiveVisualProperties(t,n.cartesianChartProps).responsive},objectName:"general"};e.pushInstance(t)},e.prototype.getResponsiveSlice=function(e,t,i){if(t)return t=n.cartesianChartProps.general,e=n.ViewModelAdapterUtils.getResponsiveVisualProperties(e,n.cartesianChartProps),{item:new n.builder.SimpleFormattingSliceBuilder({uidBuilder:new n.builder.FormattingSliceUidBuilder(new n.builder.FormattingGroupUidBuilder(new n.builder.FormattingCardUidBuilder("visualPlaceholderCard"),"visualPlaceholderGroup"),"responsive"),control:new n.builder.ToggleSwitchBuilder({descriptor:t.responsive,value:e.responsive}).build(),localize:i}).build(),revertToDefaultDescriptors:[t.responsive]}},e.prototype.applyResponsiveChanges=function(e,t,i){var a=n.ViewModelAdapterUtils.cloneData(t),r=o(a);return this.applyIconResponsiveChanges(r,e,a),this.applyGridlinesResponsiveChanges(r,e,a),this.applyPaddingResponsiveChanges(r,e,a),this.updateResponsiveWarnings(a,t,i),a},e.prototype.applyIconResponsiveChanges=function(e,t,i){(t.height<e.showIconHeight||t.width<e.showIconWidth)&&(i.showIcon=!0)},e.prototype.applyGridlinesResponsiveChanges=function(e,t,i){var a=i.gridLineWidth,r=i.gridLineWidth;null!=i.gridLineWidth&&(t.height<e.removeGridLineHeight||t.width<e.removeGridLineWidth?i.gridLineWidth=0:t.height<=e.gridlineRowLowerBreakpoint||t.width<=e.gridlineColumnLowerBreakpoint?i.gridLineWidth=1:(t.height<e.gridlineRowUpperBreakpoint&&(r=Math.ceil(s([e.gridlineRowUpperBreakpoint,e.gridlineRowLowerBreakpoint],[i.gridLineWidth,1],t.height))),t.width<e.gridlineColumnUpperBreakpoint&&(a=Math.ceil(s([e.gridlineColumnUpperBreakpoint,e.gridlineColumnLowerBreakpoint],[i.gridLineWidth,1],t.width))),i.gridLineWidth=Math.min(a,r)))},e.prototype.applyPaddingResponsiveChanges=function(e,t,i){var a;!i.advancedPaddingOptions&&0===i.gridPadding||(t.height<e.paddingRowUpperBreakpoint&&(a=[e.paddingRowUpperBreakpoint,e.paddingRowLowerBreakpoint],i.rowPaddingOuter=i.rowPaddingOuter&&Math.ceil(s(a,[i.rowPaddingOuter,1],t.height)),i.rowPaddingInner=i.rowPaddingInner&&Math.ceil(s(a,[i.rowPaddingInner,1],t.height))),t.width<e.paddingColumnUpperBreakpoint&&(a=[e.paddingColumnUpperBreakpoint,e.paddingColumnLowerBreakpoint],i.columnPaddingOuter=i.columnPaddingOuter&&Math.ceil(s(a,[i.columnPaddingOuter,1],t.width)),i.columnPaddingInner=i.columnPaddingInner&&Math.ceil(s(a,[i.columnPaddingInner,1],t.width))))},e.prototype.applySubheaderResponsiveChanges=function(e,t,i){var a=n.ViewModelAdapterUtils.cloneData(t),r=o(this.multiplesLayout);return e.height<r.showSubheaderHeight&&(a.show=!1),a.show&&a.fontProperties&&(a.fontProperties=this.responsiveFontHelper.adjustFontSize(e,a.fontProperties),a.height=a.fontProperties.size.px+a.margins.top+a.margins.bottom),this.updateSubheaderResponsiveWarnings(a,t,i),a},e.prototype.updateResponsiveWarnings=function(e,t,i){var a,r=i,s={};for(a in e.showIcon?s.subheader=new n.SmallMultiplesSubheadersNotRenderedWarning:(e.rowPaddingInner===t.rowPaddingInner&&e.rowPaddingOuter===t.rowPaddingOuter&&e.columnPaddingInner===t.columnPaddingInner&&e.columnPaddingOuter===t.columnPaddingOuter||(s.smallMultiplesLayout=new n.SmallMultiplesPaddingSizeWarning),e.gridLineWidth!==t.gridLineWidth&&(s.smallMultiplesLayout=new n.SmallMultiplesGridlinesSizeWarning)),s){var o=s[a];r.addForVisualObject(a,{selector:null,warnings:[o]})}},e.prototype.updateSubheaderResponsiveWarnings=function(e,t,i){var a,r=i,s={};for(a in e.show!==t.show&&(s.subheader=new n.SmallMultiplesSubheadersNotRenderedWarning),_.isEqual(e.fontProperties.size,t.fontProperties.size)||(s.subheader=new n.SmallMultiplesSubheadersFontSizeWarning),s){var o=s[a];r.addForVisualObject(a,{selector:null,warnings:[o]})}},n.SmallMultiplesViewModelAdapter=e}(e.visuals||(e.visuals={}))}(powerbi=powerbi||{});
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['cartesianVisuals.min.js'] || (this.parseTimeMarkers['cartesianVisuals.min.js'] = {});
marker.endEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
